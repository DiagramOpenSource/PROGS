|FICHEROS;
   dscaz082 #0;
   dscaw062 #1,MANTE;
   dscaw063 #2,MANTE;

   dscam012 #11;
   dscam013 #12;
   dscam003 #13;
   dscam004 #14;
   dscam051 #15;
   dscam066 #16;
   dscam030 #17;
   dscam002 #18;
   dscaw049 #19;

   dscaw058 #20;
   dscam093 #21;
   dscam023 #22,MANTE;
   cacuent@ #100;
   dscaw013 #910;

   taglm01@ #1000;
|FIN;

|VARIABLES;
   nSwMarcados = 0;
   &eaFichClas = ""; &eaTipoClas = "";
   &eaMes = ""; &aInforme = "";
   &enEmpCartera = 0; &enEmpGestion = 0; &enDocum = 0; &HayConta = 0;
   &eaSerie = ""; &eaCliGest = ""; &nImporte = 0; &eaTipoOper = "";
   &eaUsuario = ""; &enImpAnt = 0;  &enImpAct = 0;  &eaDescr = "";
   &eaTipoReg = ""; &eaNumero = ""; &eaTipoOp = ""; &eaLlamada = "";
   &eaTipoRecibo = ""; &enNumDocum = 0; &eaMensRet = ""; &enSwError = 0; &eaTOperacion = "";
   &enBanco = 0; &Divisa = ""; &nDeci_Base = 0; &nDeci_Div = 0; &MaxDigit = 0;
   &Niv1 = 0; &Niv2 = 0; &Niv3 = 0; &Niv4 = 0; &Niv5 = 0; &Niv6 = 0;

   aCodEnl = "";
   aAlfa   = "";
   aAlfa1  = "";
   aCuenta = "";
   aParte1 = "";
   aParte2 = "";
   aLong   = "";

   nSwHay = 0;
   nSwEnt = 0;
   nHayImp = 0;
   nGastos   = 0;
   nLinea    = 0;
   nLong     = 0;
   nSwError  = 0;
   nSwConta  = 0;
   nNumSec   = 0;
   nError    = 0;
   nNuevo    = 0;
   nSw       = 0;
   nNumSel   = 0;
   nNumCar   = 0;
   nSwCobConf = 0;
   LinCob    = 0;
   UltNumero = 0;
   UltFecha  = @;

   fFecha = @;
   fFechaAb = @;
   fFechaRecl = @;

   Linea = 0;
   nCalc = 0;
   aSesion = "";

   nTotalRem = 0;
   nTotalVenc = 0;

   nSwBloq   = 0;
   fFechaHoy = @;
   &enFPago      = 0;
   &nCamFPago    = 0;
   &fFechaFac    = @;
   &fFecVto      = @;
   &eaCliente    = "";
   &enExistOblig = 0;

   nSwArtenvas  = 0;
|FIN;

|PROCESO RellenaLins;
   |SI nSwEnt ! 0;
      #dscam003#40 = #dscam013#16;
      |LEE 000#dscam003.=;
      |SI nSwEnt = 2;
         |SI #dscam003#98 = "S"; |ACABA; |FINSI;
         |SI #dscam012#22 ! "2";
            |SI #dscam003#47 = "N";
               |SI #dscam003#14 ! "L"; |ACABA; |FINSI;
            |SINO;
               |SI #dscam003#14 ! "e"; |ACABA; |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
      |SI nSwEnt = 3;
         |SI #dscam003#98 = "N"; |ACABA; |FINSI;
         |SI #dscam012#22 ! "2";
            |SI #dscam003#47 = "N";
               |SI #dscam003#14 ! "L"; |ACABA; |FINSI;
            |SINO;
               |SI #dscam003#14 ! "e"; |ACABA; |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
   |FINSI;

   nSwHay = 1;
   |SI #dscam012#22 = 1; |O #dscam012#22 = 2;
    |O #dscam012#22 = 5; |O #dscam012#22 = 6;
      #dscaz082#7 = "R";
   |SINO;
      #dscaz082#7 = "P";
   |FINSI;

   #dscam003#40 = #dscam013#16;
   |LEE 000#dscam003.=;
   Divisa = #dscam003#57; |HAZ TomaDecim;

   |SI #dscam003#14 = "I"; |ACABA; |FINSI;

   nTotalRem = nTotalRem + #dscam013#7;
   |SI #dscam013#6 > #dscam012#1;
      nTotalVenc = nTotalVenc + #dscam013#7;
   |FINSI;

   |DDEFECTO #dscaw062;
   #dscaw062#0 = #dscam013#1;
   #dscaw062#1 = #dscam013#16;
   #dscaw062#2 = #dscam003#32;
   #dscaw062#3 = #dscam003#6;
   #dscaw062#4 = #dscam013#6;
   #dscaw062#5 = #dscam013#7;
   #dscaw062#7 = #dscam012#8;
   #dscaw062#8 = #dscam003#72;
   #dscaw062#9 = #dscam003#70;
   #dscaw062#11 = #dscam012#22;
   |GRABA 020#dscaw062.n;

   |SI #dscam003#72 ! "    ";
      |SELECT #2#dscaw063;
      #dscaw063#8 = #dscam003#72;
      #dscaw063#9 = #dscam003#70;
      |LEE 000#dscaw063.=;
      |SI FSalida ! 0;
         |DDEFECTO #dscaw063;
         #dscaw063#0 = nLinea; nLinea = nLinea + 1;
         #dscaw063#8 = #dscam003#72;
         #dscaw063#9 = #dscam003#70;
         |GRABA 020#dscaw063.c;
      |FINSI;
      #dscaw063#1 = #dscam013#16;
      #dscaw063#2 = #dscam003#32;
      #dscaw063#3 = #dscam003#6;
      #dscaw063#4 = #dscam013#6;
      #dscaw063#5 = #dscam003#78;
      #dscaw063#7 = #dscam012#8;
      |GRABA 020#dscaw063.a;
   |FINSI;

   #dscam013#20 = "*"; |GRABA 020#dscam013.a;
|FPRC;

|DEFBUCLE RellenaLins;
   #dscam013#1;
   15;
   #dscaz082#0,001,"N";
   #dscaz082#0,999,"N";
   be;
   NULL,RellenaLins;
|FIN;

|PROCESO Reclamacion;
   |SI #dscam051#3 = "S";
      enEmpCartera = -1;     enEmpGestion = #dscam003#46;
      eaSerie = #dscam003#0; eaCliGest = #dscam003#32;
      |SI #dscam003#84 = "N";
         enBanco = #dscam012#2;
         eaTipoOper ="-6+4";
      |SINO;
         eaTipoOper ="+4";
      |FINSI;
      nImporte = #dscaw062#5; |HAZ BucleRiesgo;
   |FINSI;
   #dscam004#17 = #dscaw062#1;
   #dscam004#3 = 99;
   |LEE 000#dscam004.];
   |SI FSalida ! 0;
      |LEE 000#dscam004.u;
      |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
         LinCob = #dscam004#3 + 1;
         UltFecha = #dscam004#6; UltNumero = #dscam004#3;
      |SINO;
         LinCob = 1;
      |FINSI;
   |SINO;
      |SI #dscam004#17 = #dscaw062#1;
         LinCob = #dscam004#3 + 1;
         UltFecha = #dscam004#6; UltNumero = #dscam004#3;
      |SINO;
         |LEE 000#dscam004.a;
         |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
            LinCob = #dscam004#3 + 1;
            UltFecha = #dscam004#6; UltNumero = #dscam004#3;
         |SINO;
            LinCob = 1;
         |FINSI;
      |FINSI;
   |FINSI;
   |DDEFECTO #dscam004;
   #dscam004#0  = #dscam003#0;
   #dscam004#1  = #dscam003#1;
   #dscam004#2  = #dscam003#2;
   #dscam004#3  = LinCob;
   #dscam004#4  = aCuenta;
   #dscam004#5  = "RCE";
   #dscam004#6  = fFechaRecl;
   #dscam004#7  = #dscam003#23; #dscam004#25 = #dscam003#61;
   #dscam004#9  = #dscam013#7;  #dscam004#27 = #dscam013#7;
   #dscam004#14 = #dscaw062#10; #dscam004#31 = #dscaw062#10;
   aAlfa = "Recl.Remesa " + (("00000" + #dscam013#0) % -105) + " del banco " + (("000" + #dscam012#2) % -103);
   #dscam004#16 = aAlfa;
   #dscam004#17 = #dscam003#40; #dscam004#33 = 1;
   #dscam004#43 = nNumSec;
   |GRABA 020#dscam004.c;
   eaUsuario = Usuario % 0810;
   eaTipoReg = "CB";  eaNumero = (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
   eaDescr   = "CONF.RECLAMACION RECIBO (" + (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
   eaDescr   = eaDescr + ") DESDE ASISTENTE REMESAS";
   eaTipoOp  = "A";
   enImpAnt = #dscam003#64; enImpAct = #dscam003#64 - #dscam004#9;
   |HAZ GrabaAudit;
   #dscam003#38 = #dscam003#38 + #dscaw062#10; #dscam003#66 = #dscam003#66 + #dscaw062#10;
   #dscam003#23 = #dscam003#23 - #dscaw062#5;  #dscam003#61 = #dscam003#61 - #dscaw062#5;
   #dscam003#26 = "01.01.0000";
   #dscam003#30 = #dscam003#22 + #dscam003#24 + #dscam003#25 + #dscam003#38;
   #dscam003#30 = #dscam003#30 - (#dscam003#54 + #dscam003#55);
   #dscam003#64 = #dscam003#60 + #dscam003#62 + #dscam003#63 + #dscam003#66 + #dscam003#56;
   #dscam003#64 = #dscam003#64 - (#dscam003#67 + #dscam003#68);
   #dscam003#31 = #dscam003#30 - #dscam003#23; #dscam003#65 = #dscam003#64 - #dscam003#61;
   #dscam003#17 = 0; #dscam003#37 = 0; #dscam003#53 = "01.01.0000";
   ||(1) ABDON 20/05/2005 Tiquet 1254/572
   ||(1) SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
   ||(1)   #dscam003#14 = "T";
   ||(1)   #dscam003#15 = "Talon/Pagare reclamado";
   ||(1) SINO;
   |SI #dscam003#47 = "N";
      #dscam003#14 = "P";  || Pendiente de cobro
   |SINO;
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         #dscam003#14 = "p";  || Entrega pendiente cobro
      |SINO;
         #dscam003#14 = "e";  || Entrega pendiente de compensar
      |FINSI;
   |FINSI;
   #dscam003#15 = "Recibo reclamado";
   ||(1) FINSI;
   ||eaFichClas = "dscam003"; eaTipoClas = #dscam003#12; |HAZ CompruebaClas;
   |||SI eaTipoClas = "R"; |O eaTipoClas = "P";
   #dscam003#90 = "N";
   |||FINSI;
   |SI eaTipoClas = "A";
      ||#dscam003#90 = "N";
      #dscam003#29 = "N";
   |FINSI;
   #dscam003#84 = "N"; #dscam003#98 = "N";
   #dscam003#93 = "N";
   |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |SI #dscam051#1 = "S"; |Y HayConta = 1; |Y aCodEnl ! "    ";
      aAlfa = Usuario; |QBF aAlfa; aAlfa = "ac" + aAlfa;
      |NOME_DAT #910 aAlfa;
      |DELINDEX #dscaw013; |ABRE #dscaw013;
      |SUB_EJECUTA_NP "dscaz169.tab;INICIO";

      |SI nNumSec ! 0; |Y aSesion = "S";
         #dscaw013#15 = aCodEnl;      #dscaw013#0 = 1;
         #dscaw013#13 = "dscam004";   #dscaw013#14 = 43;
         #dscaw013#5 = #dscam004#43;  #dscaw013#6 = #dscam004#43;
         #dscaw013#11 = "N";          #dscaw013#12 = 10;
         |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
      |SINO;
         #dscaw013#15 = aCodEnl;      #dscaw013#0 = 1;
         #dscaw013#13 = "dscam004";   #dscaw013#14 = 17;
         #dscaw013#5 = #dscam004#17;  #dscaw013#6 = #dscam004#17;
         #dscaw013#11 = "N";          #dscaw013#12 = 10;
         |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
         #dscaw013#15 = aCodEnl;      #dscaw013#0 = 2
         #dscaw013#13 = "dscam004";   #dscaw013#14 = 5;
         #dscaw013#3 = "RCE";         #dscaw013#4 = "RCE";
         #dscaw013#11 = "A";          #dscaw013#12 = 3;
         |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
      |FINSI;
      aAlfa = "dscam033.tab;" + aCodEnl;
      |LIBERA #dscam004; |CIERRAT #dscam004;
      |LIBERA #dscam003; |CIERRAT #dscam003;
      |SUB_EJECUTA_NP aAlfa;
      |SUB_EJECUTA_NP "dscaz169.tab;FINAL";

      |ABRET #dscam003; |LEE 101#dscam003.=;
      |ABRET #dscam004; |LEE 101#dscam004.=;
   |FINSI;
   #dscam013#15 = "R"; |GRABA 020#dscam013.a;
   |BORRA 020#dscaw062.a;
   |SI #dscam003#72 ! "    ";
      |SELECT #2#dscaw063;
      #dscaw063#8 = #dscam003#72;
      #dscaw063#9 = #dscam003#70;
      |LEE 000#dscaw063.=;
      |SI FSalida = 0; |BORRA 020#dscaw063.a; |FINSI;
      |SELECT #1#dscaw063;
   |FINSI;
   |GRABA 020#dscam012.a;
|FPRC;

|PROCESO Accion;
      #dscam013#0 = #dscaz082#0;
      #dscam013#1 = #dscaw062#0;
      |LEE 101#dscam013.=;
      |SI FSalida = 0;
         |SI nSw = 1;        || Recibo rechazado
            |SI #dscam012#8 = "N";
               #dscam003#40 = #dscaw062#1;
               |LEE 101#dscam003.=;
               |SI FSalida = 0;
                  #dscam003#17 = 0; #dscam003#37 = 0;
                  #dscam003#53 = "01.01.0000";
                  #dscam003#14 = "P"; #dscam003#15 = "Pendiente de cobro";
                  #dscam003#26 = "01.01.0000";
                  |GRABA 020#dscam003.a; |LIBERA #dscam003;
               |FINSI;
               #dscam012#5  = #dscam012#5  - 1;
               #dscam012#10 = #dscam012#10 - #dscam013#7;
               #dscam012#11 = #dscam012#11 - #dscam012#6;
               #dscam012#12 = #dscam012#12 - #dscam013#10;
               |SI #dscam013#6 < #dscam012#1;
                  #dscam012#13 = #dscam012#13 - #dscam013#7;
               |FINSI;
               |SI #dscam012#10 = 0;
                  |BORRA 020#dscam012.a; |PTEC 807; nNuevo = 1;
               |SINO;
                  |GRABA 020#dscam012.a;
                  #dscaz082#2 = #dscam012#10; |PINTA #dscaz082#2;
                  #dscaz082#3 = #dscam012#11; |PINTA #dscaz082#3;
                  #dscaz082#4 = #dscam012#12; |PINTA #dscaz082#4;
                  #dscaz082#5 = #dscam012#13; |PINTA #dscaz082#5;
               |FINSI;
               |BORRA 020#dscam013.a; |BORRA 020#dscaw062.a;
               |SI #dscam003#72 ! "    ";
                  |SELECT #2#dscaw063;
                  #dscaw063#8 = #dscam003#72;
                  #dscaw063#9 = #dscam003#70;
                  |LEE 000#dscaw063.=;
                  |SI FSalida = 0; |BORRA 020#dscaw063.a; |FINSI;
                  |SELECT #1#dscaw063;
               |FINSI;
            |SINO;
               |MENAV "    Remesa ya abonada. Proceso cancelado";
            |FINSI;
         |FINSI;
         |SI nSw = 2;        || Peticion reclamacion
            |SI #dscam012#22 = "2";
               #dscam003#40 = #dscaw062#1;
               |LEE 101#dscam003.=;
               |SI FSalida = 0;
                  #dscam004#17 = #dscaw062#1;
                  #dscam004#3 = 99;
                  |LEE 000#dscam004.];
                  |SI FSalida ! 0;
                     |LEE 000#dscam004.u;
                     |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
                        LinCob = #dscam004#3 + 1;
                        UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                     |SINO;
                        LinCob = 1;
                     |FINSI;
                  |SINO;
                     |SI #dscam004#17 = #dscaw062#1;
                        LinCob = #dscam004#3 + 1;
                        UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                     |SINO;
                        |LEE 000#dscam004.a;
                        |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
                           LinCob = #dscam004#3 + 1;
                           UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                        |SINO;
                           LinCob = 1;
                        |FINSI;
                     |FINSI;
                  |FINSI;
                  |DDEFECTO #dscam004;
                  #dscam004#0  = #dscam003#0;
                  #dscam004#1  = #dscam003#1;
                  #dscam004#2  = #dscam003#2;
                  #dscam004#3  = LinCob;
                  #dscam004#4  = aCuenta;
                  |SI #dscam012#8 = "S";
                     #dscam004#5  = "PRC";
                     |SI nSwArtenvas = 1;    || Tiquet: 160/1037  Tiquet
                         fFechaRecl = ~;
                     |FINSI;
                  |SINO;
                     #dscam004#5  = "PRA";
                     fFechaRecl = ~;
                  |FINSI;
                  #dscam004#6  = fFechaRecl;
                  #dscam004#7  = #dscam003#23; #dscam004#25 = #dscam003#61;
                  #dscam004#9  = #dscam013#7;  #dscam004#27 = #dscam013#7;
                  #dscam004#14 = #dscaw062#10; #dscam004#31 = #dscaw062#10;
                  #dscam004#17 = #dscam003#40; #dscam004#33 = 1;
                  #dscam004#43 = nNumSec;
                  |GRABA 020#dscam004.c;
                  |HAZ Imprime;
                  #dscam003#98 = "S";
                  |GRABA 020#dscam003.a; |LIBERA #dscam003;
                  eaUsuario = Usuario % 0810;
                  eaTipoReg = "CB";  eaNumero = (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
                  eaDescr   = "PETICION RECLAMACION RECIBO (" + (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
                  eaDescr   = eaDescr + ") DESDE ASISTENTE REMESAS";
                  eaTipoOp  = "A";
                  enImpAnt = #dscam003#64; enImpAct = #dscam003#64 - #dscam004#9;
                  |HAZ GrabaAudit;
                  |SI #dscam051#1 = "S"; |Y HayConta = 1; |Y aCodEnl ! "    ";
                     |SI nNumSec = 0; |O aSesion ! "S";
                        aAlfa = Usuario; |QBF aAlfa; aAlfa = "ac" + aAlfa;
                        |NOME_DAT #910 aAlfa;
                        |DELINDEX #dscaw013; |ABRE #dscaw013;
                        |SUB_EJECUTA_NP "dscaz169.tab;INICIO";

                        #dscaw013#15 = aCodEnl;      #dscaw013#0 = 1;
                        #dscaw013#13 = "dscam004";   #dscaw013#14 = 17;
                        #dscaw013#5 = #dscam004#17;  #dscaw013#6 = #dscam004#17;
                        #dscaw013#11 = "N";          #dscaw013#12 = 10;
                        |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
                        #dscaw013#15 = aCodEnl;      #dscaw013#0 = 2
                        #dscaw013#13 = "dscam004";   #dscaw013#14 = 5;
                        |SI #dscam012#8 = "S";
                           #dscaw013#3 = "PRC";         #dscaw013#4 = "PRC";
                        |SINO;
                           #dscaw013#3 = "PRA";         #dscaw013#4 = "PRA";
                        |FINSI;
                        #dscaw013#11 = "A";          #dscaw013#12 = 3;
                        |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
                        aAlfa = "dscam033.tab;" + aCodEnl;
                        |LIBERA #dscam004; |CIERRAT #dscam004;
                        |LIBERA #dscam003; |CIERRAT #dscam003;
                        |SUB_EJECUTA_NP aAlfa;
                        |SUB_EJECUTA_NP "dscaz169.tab;FINAL";

                        |ABRET #dscam003; |LEE 101#dscam003.=;
                        |ABRET #dscam004; |LEE 101#dscam004.=;
                     |FINSI;
                  |FINSI;
                  |BORRA 020#dscaw062.a;
                  |SI #dscam003#72 ! "    ";
                     |SELECT #2#dscaw063;
                     #dscaw063#8 = #dscam003#72;
                     #dscaw063#9 = #dscam003#70;
                     |LEE 000#dscaw063.=;
                     |SI FSalida = 0; |BORRA 020#dscaw063.a; |FINSI;
                     |SELECT #1#dscaw063;
                  |FINSI;
                  |PTEC 808;
               |FINSI;
            |SINO;
               |SI #dscam012#8 = "S";
                  #dscam003#40 = #dscaw062#1;
                  |LEE 101#dscam003.=;
                  |SI FSalida = 0;
                     #dscam004#17 = #dscaw062#1;
                     #dscam004#3 = 99;
                     |LEE 000#dscam004.];
                     |SI FSalida ! 0;
                        |LEE 000#dscam004.u;
                        |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
                           LinCob = #dscam004#3 + 1;
                           UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                        |SINO;
                           LinCob = 1;
                        |FINSI;
                     |SINO;
                        |SI #dscam004#17 = #dscaw062#1;
                           LinCob = #dscam004#3 + 1;
                           UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                        |SINO;
                           |LEE 000#dscam004.a;
                           |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
                              LinCob = #dscam004#3 + 1;
                              UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                           |SINO;
                              LinCob = 1;
                           |FINSI;
                        |FINSI;
                     |FINSI;
                     |DDEFECTO #dscam004;
                     #dscam004#0  = #dscam003#0;
                     #dscam004#1  = #dscam003#1;
                     #dscam004#2  = #dscam003#2;
                     #dscam004#3  = LinCob;
                     #dscam004#4  = aCuenta;
                     #dscam004#5  = "PRC";
                     #dscam004#6  = fFechaRecl;
                     #dscam004#7  = #dscam003#23; #dscam004#25 = #dscam003#61;
                     #dscam004#9  = #dscam013#7;  #dscam004#27 = #dscam013#7;
                     #dscam004#14 = #dscaw062#10; #dscam004#31 = #dscaw062#10;
                     #dscam004#17 = #dscam003#40; #dscam004#33 = 1;
                     #dscam004#43 = nNumSec;
                     |GRABA 020#dscam004.c;

                     |HAZ Imprime;
                     #dscam003#98 = "S";
                     |GRABA 020#dscam003.a; |LIBERA #dscam003;

                     eaUsuario = Usuario % 0810;
                     eaTipoReg = "CB";  eaNumero = (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
                     eaDescr   = "PETICION RECLAMACION RECIBO (" + (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
                     eaDescr   = eaDescr + ") DESDE ASISTENTE REMESAS";
                     eaTipoOp  = "A";
                     enImpAnt = #dscam003#64; enImpAct = #dscam003#64 - #dscam004#9;
                     |HAZ GrabaAudit;

                     |SI #dscam051#1 = "S"; |Y HayConta = 1; |Y aCodEnl ! "    ";
                        aAlfa = Usuario; |QBF aAlfa; aAlfa = "ac" + aAlfa;
                        |NOME_DAT #910 aAlfa;
                        |SI nNumSec = 0; |O aSesion ! "S";
                           |DELINDEX #dscaw013; |ABRE #dscaw013;

                           |SUB_EJECUTA_NP "dscaz169.tab;INICIO";

                           #dscaw013#15 = aCodEnl;      #dscaw013#0 = 1;
                           #dscaw013#13 = "dscam004";   #dscaw013#14 = 17;
                           #dscaw013#5 = #dscam004#17;  #dscaw013#6 = #dscam004#17;
                           #dscaw013#11 = "N";          #dscaw013#12 = 10;
                           |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
                           #dscaw013#15 = aCodEnl;      #dscaw013#0 = 2
                           #dscaw013#13 = "dscam004";   #dscaw013#14 = 5;
                           #dscaw013#3 = "PRC";         #dscaw013#4 = "PRC";
                           #dscaw013#11 = "A";          #dscaw013#12 = 3;
                           |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
                           |CIERRA #dscaw013;

                           aAlfa = "dscam033.tab;" + aCodEnl;
                           |LIBERA #dscam004; |CIERRAT #dscam004;
                           |LIBERA #dscam003; |CIERRAT #dscam003;
                           |SUB_EJECUTA_NP aAlfa;

                           |SUB_EJECUTA_NP "dscaz169.tab;FINAL";

                           |ABRET #dscam003; |LEE 101#dscam003.=;
                           |ABRET #dscam004; |LEE 101#dscam004.=;
                           |DELINDEX #dscaw013;
                        |FINSI;
                     |FINSI;

                     |BORRA 020#dscaw062.a;
                     |SI #dscam003#72 ! "    ";
                        |SELECT #2#dscaw063;
                        #dscaw063#8 = #dscam003#72;
                        #dscaw063#9 = #dscam003#70;
                        |LEE 000#dscaw063.=;
                        |SI FSalida = 0; |BORRA 020#dscaw063.a; |FINSI;
                        |SELECT #1#dscaw063;
                     |FINSI;
                     |PTEC 808;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI nSw = 4;        || Confirmacion reclamacion
            |SI #dscam012#22 = "2";
               #dscam003#40 = #dscaw062#1;
               |LEE 020#dscam003.=;
               |SI FSalida = 0;
                  |SI #dscam003#98 = "S";
                     |SI #dscam003#47 = "S"; |ACABA; |FINSI;
                     |SI #dscam051#3 = "S"; |Y #dscam012#8 = "S";
                        enEmpCartera = -1;     enEmpGestion = #dscam003#46;
                        eaSerie = #dscam003#0; eaCliGest = #dscam003#32;
                        |SI #dscam003#84 = "N";
                           enBanco = #dscam012#2;
                           eaTipoOper ="-6+4";
                        |SINO;
                           eaTipoOper ="+4";
                        |FINSI;
                        nImporte = #dscaw062#5; |HAZ BucleRiesgo;
                     |FINSI;
                     #dscam004#17 = #dscaw062#1;
                     #dscam004#3 = 99;
                     |LEE 000#dscam004.];
                     |SI FSalida ! 0;
                        |LEE 000#dscam004.u;
                        |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
                           LinCob = #dscam004#3 + 1;
                           UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                        |SINO;
                           LinCob = 1;
                        |FINSI;
                     |SINO;
                        |SI #dscam004#17 = #dscaw062#1;
                           LinCob = #dscam004#3 + 1;
                           UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                        |SINO;
                           |LEE 000#dscam004.a;
                           |SI FSalida = 0; |Y #dscam004#17 = #dscaw062#1;
                              LinCob = #dscam004#3 + 1;
                              UltFecha = #dscam004#6; UltNumero = #dscam004#3;
                           |SINO;
                              LinCob = 1;
                           |FINSI;
                        |FINSI;
                     |FINSI;
                     |DDEFECTO #dscam004;
                     #dscam004#0  = #dscam003#0;
                     #dscam004#1  = #dscam003#1;
                     #dscam004#2  = #dscam003#2;
                     #dscam004#3  = LinCob;
                     #dscam004#4  = aCuenta;
                     |SI #dscam012#8 = "S";
                        #dscam004#5  = "RCE";
                        #dscam004#9  = #dscam013#7;  #dscam004#27 = #dscam013#7;
                        |SI nSwArtenvas = 1;
                             fFechaRecl = ~; || Tiquet: 160/1037
                        |FINSI;
                     |SINO;
                        #dscam004#5  = "RCA";
                        fFechaRecl = ~;
                     |FINSI;
                     #dscam004#6  = fFechaRecl;
                     #dscam004#7  = #dscam003#23; #dscam004#25 = #dscam003#61;
                     #dscam004#14 = #dscaw062#10; #dscam004#31 = #dscaw062#10;
                     aAlfa = "Recl.Remesa " + (("00000" + #dscam013#0) % -105) + " del banco " + (("000" + #dscam012#2) % -103);
                     #dscam004#16 = aAlfa;
                     #dscam004#17 = #dscam003#40; #dscam004#33 = 1;
                     #dscam004#43 = nNumSec;
                     |GRABA 020#dscam004.c;
                     eaUsuario = Usuario % 0810;
                     eaTipoReg = "CB";  eaNumero = (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
                     eaDescr   = "CONF.RECLAMACION RECIBO (" + (("000000000" + #dscam004#17) % -109) + "/" + (("000" + #dscam004#3) % -103);
                     eaDescr   = eaDescr + ") DESDE ASISTENTE REMESAS";
                     eaTipoOp  = "A";
                     enImpAnt = #dscam003#64; enImpAct = #dscam003#64 - #dscam004#9;
                     |HAZ GrabaAudit;
                     |SI nSwArtenvas = 1;
                          #dscam003#38 = #dscam003#38 + #dscaw062#10; #dscam003#66 = #dscam003#66 + #dscaw062#10;
                          || Tiquet: 160/1037
                          ||SI #dscam012#8 = "S";
                          ||   #dscam003#23 = #dscam003#23 - #dscaw062#5; #dscam003#61 = #dscam003#61 - #dscaw062#5;
                          ||FINSI;
                          #dscam003#30 = #dscam003#22 + #dscam003#24 + #dscam003#25 + #dscam003#38;
                          #dscam003#30 = #dscam003#30 - (#dscam003#54 + #dscam003#55);
                          #dscam003#64 = #dscam003#60 + #dscam003#62 + #dscam003#63 + #dscam003#66 + #dscam003#56;
                          #dscam003#64 = #dscam003#64 - (#dscam003#67 + #dscam003#68);
                          #dscam003#31 = #dscam003#30 - #dscam003#23; #dscam003#65 = #dscam003#64 - #dscam003#61;
                          #dscam003#17 = 0; #dscam003#37 = 0; #dscam003#53 = "01.01.0000";
                     |SINO;
                          #dscam003#38 = #dscam003#38 + #dscaw062#10; #dscam003#66 = #dscam003#66 + #dscaw062#10;
                          |SI #dscam012#8 = "S";
                             #dscam003#23 = #dscam003#23 - #dscaw062#5;  #dscam003#61 = #dscam003#61 - #dscaw062#5;
                          |FINSI;
                          #dscam003#30 = #dscam003#22 + #dscam003#24 + #dscam003#25 + #dscam003#38;
                          #dscam003#30 = #dscam003#30 - (#dscam003#54 + #dscam003#55);
                          #dscam003#64 = #dscam003#60 + #dscam003#62 + #dscam003#63 + #dscam003#66 + #dscam003#56;
                          #dscam003#64 = #dscam003#64 - (#dscam003#67 + #dscam003#68);
                          #dscam003#31 = #dscam003#30 - #dscam003#23; #dscam003#65 = #dscam003#64 - #dscam003#61;
                          #dscam003#17 = 0; #dscam003#37 = 0; #dscam003#53 = "01.01.0000";
                     |FINSI;
                     #dscam003#26 = "01.01.0000";

                     ||(1) ABDON 20/05/2005 Tiquet 1254/572
                     ||(1) SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
                     ||(1)   #dscam003#14 = "T";
                     ||(1)   #dscam003#15 = "Talon/Pagare reclamado";
                     ||(1) SINO;
                        #dscam003#14 = "P";
                        #dscam003#15 = "Recibo reclamado";
                     ||(1) FINSI;
                     ||eaFichClas = "dscam003"; eaTipoClas = #dscam003#12; |HAZ CompruebaClas;
                     |||SI eaTipoClas = "R"; |O eaTipoClas = "P";
                     #dscam003#90 = "N";
                     |||FINSI;
                     |SI eaTipoClas = "A";
                        ||#dscam003#90 = "N";
                        #dscam003#29 = "N";
                     |FINSI;
                     #dscam003#84 = "N"; #dscam003#98 = "N";
                     #dscam003#93 = "N";
                     |GRABA 020#dscam003.a; |LIBERA #dscam003;
                     |SI #dscam051#1 = "S"; |Y HayConta = 1; |Y aCodEnl ! "    ";
                        aAlfa = Usuario; |QBF aAlfa; aAlfa = "ac" + aAlfa;
                        |NOME_DAT #910 aAlfa;
                        |SI nNumSec = 0; |O aSesion ! "S";
                           |DELINDEX #dscaw013; |ABRE #dscaw013;
                           |SUB_EJECUTA_NP "dscaz169.tab;INICIO";

                           #dscaw013#15 = aCodEnl;      #dscaw013#0 = 1;
                           #dscaw013#13 = "dscam004";   #dscaw013#14 = 17;
                           #dscaw013#5 = #dscam004#17;  #dscaw013#6 = #dscam004#17;
                           #dscaw013#11 = "N";          #dscaw013#12 = 10;
                           |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
                           #dscaw013#15 = aCodEnl;      #dscaw013#0 = 2
                           #dscaw013#13 = "dscam004";   #dscaw013#14 = 5;
                           |SI #dscam012#8 = "S";
                              #dscaw013#3 = "RCE";         #dscaw013#4 = "RCE";
                           |SINO;
                              #dscaw013#3 = "RCA";         #dscaw013#4 = "RCA";
                           |FINSI;
                           #dscaw013#11 = "A";          #dscaw013#12 = 3;
                           |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
                           |CIERRA #dscaw013;

                           aAlfa = "dscam033.tab;" + aCodEnl;
                           |LIBERA #dscam004; |CIERRAT #dscam004;
                           |LIBERA #dscam003; |CIERRAT #dscam003;
                           |SUB_EJECUTA_NP aAlfa;
                           |SUB_EJECUTA_NP "dscaz169.tab;FINAL";

                           |ABRET #dscam003; |LEE 101#dscam003.=;
                           |ABRET #dscam004; |LEE 101#dscam004.=;
                           |DELINDEX #dscaw013;
                        |FINSI;
                     |FINSI;
                     #dscam013#15 = "R"; |GRABA 020#dscam013.a;
                     |BORRA 020#dscaw062.a;
                     |SI #dscam003#72 ! "    ";
                        |SELECT #2#dscaw063;
                        #dscaw063#8 = #dscam003#72;
                        #dscaw063#9 = #dscam003#70;
                        |LEE 000#dscaw063.=;
                        |SI FSalida = 0; |BORRA 020#dscaw063.a; |FINSI;
                        |SELECT #1#dscaw063;
                     |FINSI;
                     |GRABA 020#dscam012.a; |PTEC 808;
                  |SINO;
                     #dscam003#98 = "S";
                     |GRABA 020#dscam003.a; |LIBERA #dscam003;
                     nNumCar = nNumCar - 1;
                  |FINSI;
               |FINSI;
            |SINO;
               |SI #dscam012#8 = "S";
                  #dscam003#40 = #dscaw062#1;
                  |LEE 101#dscam003.=;
                  |SI FSalida = 0;
                     |SI #dscam003#98 = "S";
                        |HAZ Reclamacion; |PTEC 808;
                     |SINO;
                        #dscam003#98 = "S";
                        |GRABA 020#dscam003.a; |LIBERA #dscam003;
                        nNumCar = nNumCar - 1;
                     |FINSI;
                  |FINSI;
               |SINO;
                  |MENAV "    Remesa no abonada. Proceso cancelado";
               |FINSI;
            |FINSI;
         |FINSI;
         |LIBERA #dscam013;
      |FINSI;
|FPRC;

|DEFBUCLE Accion;
#dscaw062#1;
6;
001,"*";
999,"*";
;
NULL,Accion;
|FIN;

|PROCESO Abona;
      |SI #dscam012#23 = "N";
         nError = 1;
         |MENAV "    Remesa no emitida. Proceso cancelado.";
         |LIBERA #dscam012;
         |ERROR10; |ACABA;
      |FINSI;
      |SI #dscam012#8 = "S";
         nError = 2;
         |MENAV "    Remesa ya abonada. Proceso cancelado.";
         |LIBERA #dscam012;
         |ERROR10; |ACABA;
      |FINSI;

      #dscam013#0 = #dscaz082#0;
      #dscam013#1 = #dscaw062#0;
      |LEE 101#dscam013.=;
      |SI FSalida = 0;
         nSwCobConf = 0;
         #dscam003#40 = #dscam013#16;
         |LEE 000#dscam003.=;
         || Actualizo  el historico de cobros
         #dscam004#17 = #dscam013#16;
         #dscam004#3  = 99;
         |LEE 000#dscam004.];
         |SI FSalida ! 0;
            |LEE 000#dscam004.u;
            |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
               LinCob = #dscam004#3 + 1;
            |SINO;
               LinCob = 1;
            |FINSI;
         |SINO;
            |SI #dscam004#17 = #dscam013#16;
               LinCob = #dscam004#3 + 1;
            |SINO;
               |LEE 000#dscam004.a;
               |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
                  LinCob = #dscam004#3 + 1;
               |SINO;
                  LinCob = 1;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscam004#5 = "IMA";
            #dscaw062#7 = "S"; |GRABA 020#dscaw062.a;
            |LIBERA #dscam013; |ACABA;
         |FINSI;
         |SI #dscam004#5 = "EMR";
            |LEE 000#dscam004.a;
            |SI FSalida = 0; |Y #dscam004#5 = "CFR"; nSwCobConf = 1; |FINSI;
         |SINO;
            |SI #dscam004#5 = "CFR"; nSwCobConf = 1; |FINSI;
         |FINSI;

         |DDEFECTO #dscam004;
         #dscam004#17 = #dscam013#16;
         #dscam004#15 = #dscam013#2;
         #dscam004#0  = #dscam013#4;
         #dscam004#1  = #dscam013#3;
         #dscam004#2  = #dscam013#5;
         #dscam004#3  = LinCob;
         #dscam004#4  = #dscam012#14;
         #dscam004#5  = "REM";
         |SI fFechaAb = "01.01.0000";
            #dscam004#6  = #dscam012#1;
         |SINO;
            #dscam004#6  = fFechaAb;
         |FINSI;
         #dscam003#40 = #dscam013#16;
         |LEE 010#dscam003.=;
         |SI FSalida = 0;
            #dscam004#7  = #dscam003#23; #dscam004#25  = #dscam003#61;
         |FINSI;
         |SI #dscam012#22 = 6; |O #dscam012#22 = 7;
            #dscam004#8  = #dscam013#40; #dscam004#26  = #dscam013#40;
            #dscam004#23 = #dscam013#41; #dscam004#32  = #dscam013#41;
         |SINO;
            #dscam004#8  = #dscam013#22; #dscam004#26  = #dscam013#7;
         |FINSI;
         #dscam004#9  = 0;
         #dscam004#10 = 0;
         #dscam004#33 = #dscam003#59;
         #dscam004#43 = nNumSec;
         |GRABA 020#dscam004.n;
         #dscam013#17 = LinCob; |GRABA 020#dscam013.a;
         || Actualizo el riesgo de cliente
         |SI #dscam051#3 = "S"; |Y nSwCobConf = 0;
            enBanco = #dscam012#2;
            || enEmpCartera = #48#0; enEmpGestion = #dscam003#46;
            enEmpCartera = -1;       enEmpGestion = #dscam003#46;
            eaSerie = #dscam003#0;   eaCliGest = #dscam003#32;
            nImporte = #dscam013#7;
            |SI #dscam003#16 > 0;
               eaTipoOper = "+6-7";
            |SINO;
               eaTipoOper = "+6-4";
            |FINSI;
            |HAZ BucleRiesgo;
         |FINSI;
         || Actualizo el recibo
         #dscam003#40 = #dscam013#16;
         |LEE 101#dscam003.=;
         |SI FSalida = 0;
            |SI nSwArtenvas = 0;
                 #dscam066#0 = #dscam003#40;
                 |LEE 000#dscam066.=;
                 |SI FSalida = 0; |BORRA 020#dscam066.a; |FINSI;
                 |SI fFechaAb = "01.01.0000";
                     #dscam003#26 = #dscam012#1;
                 |SINO;
                     #dscam003#26 = fFechaAb;
                 |FINSI;
                 |SI #dscam012#22 = 6; |O #dscam012#22 = 7;
                    #dscam003#23 = #dscam003#23 + #dscam013#40; #dscam003#61 = #dscam003#61 + #dscam013#40;
                    #dscam003#55 = #dscam003#55 + #dscam013#41; #dscam003#68 = #dscam003#68 + #dscam013#41;
                 |SINO;
                    #dscam003#23 = #dscam003#23 + #dscam013#22; #dscam003#61 = #dscam003#61 + #dscam013#7;
                 |FINSI;
                 #dscam003#30 = #dscam003#22 + #dscam003#24 + #dscam003#25 + #dscam003#38;
                 #dscam003#30 = #dscam003#30 - (#dscam003#54 + #dscam003#55);
                 #dscam003#64 = #dscam003#60 + #dscam003#62 + #dscam003#63 + #dscam003#66 + #dscam003#56;
                 #dscam003#64 = #dscam003#64 - (#dscam003#67 + #dscam003#68);
                 aAlfa = #dscam003#31; |QBF aAlfa; nCalc = aAlfa;
                 #dscam003#31 = #dscam003#30 - #dscam003#23;
                 #dscam003#65 = #dscam003#64 - #dscam003#61;
                 |SI #dscam003#47 = "S"; |O #dscam003#69 ! " ";
                    |SI #dscam003#31 = 0;
                       #dscam003#14 = "e"; #dscam003#15 = "Pendiente de compensar";
                    |FINSI;
                 |SINO;
                    |SI #dscam003#31 = 0;
                       #dscam003#14 = "L"; #dscam003#15 = "Recibo liquidado";
                    |SINO;
                       #dscam003#14 = "C"; #dscam003#15 = "Parcialmente cobrado";
                    |FINSI;
                 |FINSI;
                 |GRABA 020#dscam003.a; |LIBERA #dscam003;
            |SINO; || la estandar......................
                #dscam066#0 = #dscam003#40;
                |LEE 000#dscam066.=;
                |SI FSalida = 0; |BORRA 020#dscam066.a; |FINSI;
                |SI #dscam012#22 = 6; |O #dscam012#22 = 7;
                    #dscam003#23 = #dscam003#23 + #dscam013#40; #dscam003#61 = #dscam003#61 + #dscam013#40;
                    #dscam003#55 = #dscam003#55 + #dscam013#41; #dscam003#68 = #dscam003#68 + #dscam013#41;
                |SINO;
                    |SI #dscam012#22 ! 2; |Y #dscam012#22 ! 4;
                        #dscam003#23 = #dscam003#23 + #dscam013#22; #dscam003#61 = #dscam003#61 + #dscam013#7;
                    |FINSI;
                |FINSI;
                #dscam003#30 = #dscam003#22 + #dscam003#24 + #dscam003#25 + #dscam003#38;
                #dscam003#30 = #dscam003#30 - (#dscam003#54 + #dscam003#55);
                #dscam003#64 = #dscam003#60 + #dscam003#62 + #dscam003#63 + #dscam003#66 + #dscam003#56;
                #dscam003#64 = #dscam003#64 - (#dscam003#67 + #dscam003#68);
                aAlfa = #dscam003#31; |QBF aAlfa; nCalc = aAlfa;
                #dscam003#31 = #dscam003#30 - #dscam003#23;
                #dscam003#65 = #dscam003#64 - #dscam003#61;
                |SI #dscam003#47 = "S"; |O #dscam003#69 ! " ";
                    |SI #dscam003#31 = 0;
                        #dscam003#14 = "e"; #dscam003#15 = "Pendiente de compensar";
                    |FINSI;
                |SINO;
                    |SI #dscam003#31 = 0;
                        #dscam003#14 = "L"; #dscam003#15 = "Recibo liquidado";
                    |SINO;
                        #dscam003#14 = "R"; #dscam003#15 = "Remesado";
                    |FINSI;
                |FINSI;
                |GRABA 020#dscam003.a; |LIBERA #dscam003;
            |FINSI;
         |FINSI;
         |LIBERA #dscam013;

         eaUsuario = Usuario % 0810;
         eaTipoReg = "RE";  eaNumero = (("00000" + #dscam013#0) % -105) + "/" + (("000" + #dscam013#1) % -103);
         eaDescr   = "ABONO REMESA (" + (("00000" + #dscam013#0) % -105) + "/" + (("000" + #dscam013#1) % -103);
         eaDescr   = eaDescr + ") DESDE ASISTENTE DE ABONO DE REMESAS";
         eaTipoOp  = "A";
         enImpAnt = #dscam003#64; enImpAct = #dscam003#64 + #dscam004#9;
         |HAZ GrabaAudit;
         eaCliente = #dscam003#32; |HAZ MiraBloqueoRiesgo;
      |FINSI;

      #dscaw062#7 = "S"; |GRABA 020#dscaw062.a;
|FPRC;

|DEFBUCLE Abona;
#dscaw062#1;
;
001;
999;
;
NULL,Abona;
|FIN;

|PROCESO PideRecl;
   aAlfa = #48#16; |QBF aAlfa;
   aAlfa1 = aAlfa + "def/cacuenta.mas"; |CARGA_DEF aAlfa1, cacuent@;
   |SI FSalida = 0;
      nSwConta = 1;
      aAlfa = aAlfa + "fich/" + (("00000" + #48#14) % -105) + #48#19 + "/";
      |PATH_DAT #100 aAlfa; |ABRE #cacuent@;
   |SINO;
      nSwConta = 0;
   |FINSI;

   #cacuent@#0 = #dscam012#14; |LEE 000#cacuent@.=;
   |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
   aCuenta = #cacuent@#0;

   |ABRE #dscam030;

   |PUSHV 1809 2371;
   |BLANCO 1809 2371;
   |CUADRO 1910 2370;
   aAlfa = " Datos de la reclamacion ";
   |ATRI R; |PINTA 1911 , aAlfa; |ATRI N;
   |PINTA 2011, " Cuenta                                                 ";
   |PINTA 2111, " C.Enlace                                Fecha          ";
   |SI PARAMETRO = "CFREC";
      |PINTA 2211, " Gastos reclamacion                                     ";
      |PINTA 2231, #dscaw062#10;
   |FINSI;
   |PINTA 2021, #cacuent@#0;  |PINTA 2034, #cacuent@#2;
   |SI #dscam051#1 = "S";
      |SI PARAMETRO = "RECLA"; #dscam030#0 = #dscam051#60; |FINSI;
      |SI PARAMETRO = "CFREC"; #dscam030#0 = #dscam051#44; |FINSI;
      |LEE 000#dscam030.=;
      |SI FSalida ! 0; |DDEFECTO #dscam030; |FINSI;
   |SINO;
      |DDEFECTO #dscam030;
   |FINSI;
   aCodEnl = #dscam030#0;

   |PINTA 2121, #dscam030#0;  |PINTA 2126, #dscam030#1;
   |PINTA 2158, #dscaw058#15;
   |ERROR;

|ET OtraCuenta;
   |MENSA "    <F2> Consulta de cuentas ";
   E_sup  = 12; E_inf  = "";
   aCuenta = 2021 ? 1;
   |SI FSalida = 0;
      aCuenta = aCuenta - ".";
      |PARA; |SI FSalida ! 0; |HACIENDO;
         nCalc = ((FSalida / 100) ! 0) + 99; aParte1 = aCuenta % nCalc; |QBF aParte1;
         nCalc = FSalida + 98;               aParte2 = aCuenta % nCalc; |QBF aParte2;
         aCuenta = aParte1 + aParte2; |QBF aCuenta;
         aLong = aCuenta % 0; nLong = aLong;
         nCalc = MaxDigit - nLong;
         aCuenta = aParte1 + ("0" * nCalc) + aParte2;
         aCuenta = aCuenta - ".";
      |SIGUE;
      |QBF aCuenta;
      aLong = aCuenta % 0; nLong = aLong;
      |DDEFECTO #cacuent@;
      #cacuent@#0 = aCuenta;
      |SI nLong = Niv1; #cacuent@#1 = 1; |FINSI;
      |SI nLong = Niv2; #cacuent@#1 = 2; |FINSI;
      |SI nLong = Niv3; #cacuent@#1 = 3; |FINSI;
      |SI nLong = Niv4; #cacuent@#1 = 4; |FINSI;
      |SI nLong = Niv5; #cacuent@#1 = 5; |FINSI;
      |SI nLong = Niv6; #cacuent@#1 = 6; |FINSI;
      |SI #cacuent@#1 = 0;
         |MENAV "    Cuenta fuera de nivel";
         |VETE OtraCuenta;
      |SINO;
         |LEE 000#cacuent@.=;
         |SI FSalida = 0;
            |PINTA 2021, #cacuent@#0;  |PINTA 2034, #cacuent@#2;
         |SINO;
            |MENAV "    Cuenta inexistente";
            |VETE OtraCuenta;
         |FINSI;
      |FINSI;
   |SINO;
      |SI FSalida = 10;
         aCuenta = aCuenta - ".";
         |PARA; |SI FSalida ! 0; |HACIENDO;
            nCalc = ((FSalida / 100) ! 0) + 99; aParte1 = aCuenta % nCalc; |QBF aParte1;
            nCalc = FSalida + 98;               aParte2 = aCuenta % nCalc; |QBF aParte2;
            aCuenta = aParte1 + aParte2; |QBF aCuenta;
            aLong = aCuenta % 0; nLong = aLong;
            nCalc = MaxDigit - nLong;
            aCuenta = aParte1 + ("0" * nCalc) + aParte2;
            aCuenta = aCuenta - ".";
         |SIGUE;
         #cacuent@#0 = aCuenta;
         #cacuent@#1 = 1;
         |LEE 000#cacuent@.];
         |CONSULTA_CLAVE #1#cacuent@;
         |SI FSalida = 0;
            aCuenta = #cacuent@#0;
            |PINTA 2021, #cacuent@#0;  |PINTA 2034, #cacuent@#2;
         |FINSI;
         |VETE OtraCuenta;
      |SINO;
         |MENSA "     ";
         nSwError = 1;
         aCuenta = ""; |VETE Final;
      |FINSI;
   |FINSI;
   |MENSA "     ";

|ET OtroEnlace;
   |SI #dscam051#61 = "S"; |Y #dscam051#1 = "S";
      |MENSA "    <F2> Consulta de enlaces ";
      E_sup = 4; E_inf = "";
      aCodEnl = 2121 ? 1;
      |SI FSalida = 0;
         #dscam030#0 = aCodEnl;
         |LEE 000#dscam030.=;
         |SI FSalida = 0;
            |PINTA 2121, #dscam030#0; |PINTA 2126, #dscam030#1;
         |SINO;
            |MENAV "    Enlace inexistente";
            |VETE OtroEnlace;
         |FINSI;
      |SINO;
         |SI FSalida = 2; |VETE OtraCuenta; |FINSI;
         |SI FSalida = 10;
            #dscam030#0 = aCodEnl;
            |LEE 000#dscam030.];
            |CONSULTA_CLAVE #1#dscam030;
            |SI FSalida = 0;
               aCodEnl = #dscam030#0;
               |PINTA 2121, #dscam030#0; |PINTA 2126, #dscam030#1;
            |FINSI;
            |VETE OtroEnlace;
         |SINO;
            |MENSA "     ";
            aCuenta = ""; aCodEnl = "";
            nSwError = 1;
            |VETE Final;
         |FINSI;
      |FINSI;
   |FINSI;

|ET OtraFecha;
   E_sup = 0; E_inf = 0; fFecha = ~;
   fFecha = 2158 ? 1;
   |SI FSalida = 0;
      |SI fFecha = "01.01.0000"; |O fFecha = "00.00.0000";
         |AVISO;
         |MENAV "    La fecha no puede estar vacia ";
         |VETE OtraFecha;
      |FINSI;
      fFechaRecl = fFecha;
   |SINO;
      |SI FSalida = 2;
         |SI #dscam051#61 = "S"; |Y #dscam051#1 = "S";
            |VETE OtroEnlace;
         |SINO;
            |VETE OtraCuenta;
         |FINSI;
      |FINSI;
      aCuenta = ""; aCodEnl = ""; fFecha = "";
      nSwError = 1;
      |VETE Final;
   |FINSI;

   |SI PARAMETRO = "CFREC";
|ET OtroGastos
      E_sup = 999999999.99; E_inf = 0;
      nGastos = 2231 ? 1;
      |SI FSalida ! 0;
         |SI FSalida = 2; |VETE OtraFecha; |FINSI;
         aCuenta = ""; aCodEnl = ""; fFecha = ""; nGastos = 0;
         nSwError = 1;
      |FINSI;
   |FINSI;

|ET Final;

   aSesion = #dscam030#8;
   |SI aSesion = "N"; aSesion = #dscam030#7; |FINSI;
   |CIERRA #dscam030;

   |SI nSwConta = 1;
      |CIERRA #cacuent@; |DESCARGA_DEF #cacuent@;
   |FINSI;

   |POPV;
|FPRC;

|PROCESO PideEnlace;
   |SI #dscam051#1  = "N"; aCodEnl = "    ";         |FINSI;
   |SI #dscam051#61 = "N"; aCodEnl = #dscam051#24;   |FINSI;

   |SI PARAMETRO = "ABONO";
      |PUSHV 1922 2357; |BLANCO 1922 2357;
      |CUADRO 2023 2356;
      |ATRI R; |PINTA 2024, " Introduzca una fecha y un enlace "; |ATRI N;
      |PINTA 2125, "Fecha abono : "; |PINTA 2139, #dscam012#1;
      |PINTA 2225, #dscam030#0; |PINTA 2230, #dscam030#1;
      |ET Otra1;
      fFechaAb = #dscam012#1;
      E_sup  = 10;
      E_inf  = "";
      fFechaAb = 2139 ? 2;
      |SI FSalida = 0;
         |PINTA 2139, fFechaAb;
      |SINO;
         fFechaAb = "01.01.0000"; aCodEnl = "";
         |POPV; |ACABA;
      |FINSI;
   |SINO;
      |PUSHV 2022 2357; |BLANCO 2022 2357;
      |CUADRO 2123 2356;
      |ATRI R; |PINTA 2024, " Introduzca un codigo de enlace "; |ATRI N;
   |FINSI;

   |SI HayConta = 1; |Y #dscam051#61 = "S"; |Y #dscam051#1 = "S";
      |MENSA "    <F2> Consulta enlaces ";
      |ABRE #dscam030; |DDEFECTO #dscam030;
      |SI PARAMETRO = "ABONO"; #dscam030#0 = #dscam051#24; |FINSI;
      |LEE 000#dscam030.=;
      |SI FSalida ! 0; |DDEFECTO #dscam030; |FINSI;
      aCodEnl = #dscam030#0;

   |ET OtraVez;
      |PINTA 2225, #dscam030#0; |PINTA 2230, #dscam030#1;
      E_sup = 4; E_inf = "";
      aCodEnl = 2225 ? 1;
      |SI FSalida = 0;
         #dscam030#0 = aCodEnl;
         |LEE 000#dscam030.=;
         |SI FSalida = 0;
            |PINTA 2225, #dscam030#0; |PINTA 2230, #dscam030#1;
         |SINO;
            |MENAV "    No se encuentra la ficha ";
            |DDEFECTO #dscam030; |VETE OtraVez;
         |FINSI;
      |SINO;
         |SI FSalida = 10;
            #dscam030#0 = aCodEnl;
            |LEE 000#dscam030.];
            |CONSULTA_CLAVE #1#dscam030;
            |SI FSalida = 0;
               aCodEnl = #dscam030#0;
            |FINSI;
            |VETE OtraVez;
         |SINO;
            fFechaAb = "01.01.0000"; aCodEnl = "";
         |FINSI;
      |FINSI;
      |CIERRA #dscam030;
      |MENSA "     ";
   |FINSI;
   |POPV;

   |CONFI "    NEs correcto ? ";
   |SI FSalida ! 0; fFechaAb = "01.01.0000"; aCodEnl = ""; |FINSI;
|FPRC;

|PROCESO Mes;
   eaMes = fFechaRecl; |QBF eaMes; eaMes = eaMes % 0402;

   |SI eaMes = "01"; eaMes = "Enero";      |FINSI;
   |SI eaMes = "02"; eaMes = "Febrero";    |FINSI;
   |SI eaMes = "03"; eaMes = "Marzo";      |FINSI;
   |SI eaMes = "04"; eaMes = "Abril";      |FINSI;
   |SI eaMes = "05"; eaMes = "Mayo";       |FINSI;
   |SI eaMes = "06"; eaMes = "Junio";      |FINSI;
   |SI eaMes = "07"; eaMes = "Julio";      |FINSI;
   |SI eaMes = "08"; eaMes = "Agosto";     |FINSI;
   |SI eaMes = "09"; eaMes = "Septiembre"; |FINSI;
   |SI eaMes = "10"; eaMes = "Octubre";    |FINSI;
   |SI eaMes = "11"; eaMes = "Noviembre";  |FINSI;
   |SI eaMes = "12"; eaMes = "Diciembre";  |FINSI;
|FPRC;

|PROCESO Imprime;
   #dscam003#40 = #dscaw062#1;
   |LEE 000#dscam003.=;
   |SI FSalida ! 0; |DDEFECTO #dscaw062; |FINSI;

   #dscam002#0 = #dscam012#16;
   #dscam002#1 = #dscam012#17;
   |LEE 000#dscam002.=;
   |SI FSalida ! 0; |DDEFECTO #dscam002; |FINSI;


   |DDEFECTO #dscaw049;
   #dscaw049#0 = #dscam012#0;
   #dscaw049#1 = #dscaw062#0;
   #dscaw049#2 = #dscam003#27;
   #dscaw049#3 = #dscam003#1;
   #dscaw049#4 = #dscam003#0;
   #dscaw049#5 = #dscam003#2;
   #dscaw049#6 = #dscam003#3;
   #dscaw049#7 = #dscam003#30;
   #dscaw049#8 = #dscam003#40;

   |PRINT; |PIEINF;
|FPRC;

|DEFBUCLE Imprime;
#dscaw062#1;
6;
001,"*";
999,"*";
;
NULL,Imprime;
|FIN;

|PROCESO MarcaRecs;
   #dscam003#40 = #dscaw062#9;
   |LEE 000#dscam003.=;
   |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;

   #dscaw062#6 = aAlfa; |GRABA 020#dscaw062.a;
   |SI aAlfa = "*";
      nNumSel = nNumSel + 1;
      |SI #dscam003#98 = "N"; nNumCar = nNumCar + 1; |FINSI;
   |SINO;
      nNumSel = nNumSel - 1;
      |SI #dscam003#98 = "N"; nNumCar = nNumCar - 1; |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE MarcaRecs;
#dscaw062#2;
;
#dscaw063#8, #dscaw063#9;
#dscaw063#8, #dscaw063#9;
;
NULL,MarcaRecs;
|FIN;

|PROCESO Marca1;
      #dscam003#40 = #dscaw062#1;
      |LEE 000#dscam003.=;
      |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;

      |SI #dscaz082#7 = "R";
         |SI #dscaw062#6 = " ";
            #dscaw062#6 = "*"; nNumSel = nNumSel + 1;
            |SI #dscam003#98 = "N"; nNumCar = nNumCar + 1; |FINSI;
         |SINO;
            #dscaw062#6 = " "; nNumSel = nNumSel - 1;
            |SI #dscam003#98 = "N"; nNumCar = nNumCar - 1; |FINSI;
         |FINSI;
         |GRABA 020#dscaw062.a;
      |SINO;
         |SI #dscaw063#6 = " ";
            #dscaw063#6 = "*";
         |SINO;
            #dscaw063#6 = " ";
         |FINSI;
         |GRABA 020#dscaw063.a;
         aAlfa = #dscaw063#6; |BUCLE MarcaRecs;
      |FINSI;
|FPRC;

|PROCESO Rechaza;
   nSw = 1;
   |SI nNumSel = 0;
      aAlfa = "    NEsta seguro de querer rechazar el recibo ? ";
   |SINO;
      aAlfa = "    NEsta seguro de querer rechazar los recibos ? ";
   |FINSI;
|FPRC;

|PROCESO Reclama;
      |SI #dscaw062#7 = "N"; |Y #dscaw062#11 ! 2;
         |MENAV "    La remesa no esta abonada. Proceso cancelado.";
         |ERROR; |ACABA;
      |FINSI;
      nSw = 2;
      |SI HayConta = 1; |Y #dscam051#1 = "S";
         |HAZ PideRecl;
         |SI fFecha = "01.01.0000"; |O aCuenta = "";
            |MENAV "    Proceso cancelado"; nSw = 0;
            |LIBERA #dscam012; |ACABA;
         |FINSI;
         || #dscaw062#10 = nGastos; |GRABA 020#dscaw062.a;
      |FINSI;
      |SI nNumSel = 0;
         aAlfa = "    NEsta seguro de querer reclamar el recibo ? ";
      |SINO;
         aAlfa = "    NEsta seguro de querer reclamar los recibos ? ";
      |FINSI;
|FPRC;

|PROCESO CfRecl;
      |SI #dscaw062#7 = "N"; |Y #dscaw062#11 ! 2;
         |MENAV "    La remesa no esta abonada. Proceso cancelado.";
         |ERROR; |ACABA;
      |FINSI;
      nSw = 4;
      |SI HayConta = 1; |Y #dscam051#1 = "S";
         |HAZ PideRecl;
         |SI fFecha = "01.01.0000"; |O aCuenta = "";
            |MENAV "    Proceso cancelado"; nSw = 0;
            |LIBERA #dscam012; |ACABA;
         |FINSI;
         |SI #dscaz082#7 = "R";
            #dscaw062#10 = nGastos; |GRABA 020#dscaw062.a;
         |SINO;
            #dscaw062#0 = 1;
            |LEE 000#dscaw062.];
            |PARA; |SI FSalida = 0; |HACIENDO;
               |SI #dscaw062#8 = #dscaw063#8; |Y #dscaw062#9 = #dscaw063#9;
                  #dscaw062#10 = nGastos; |GRABA 020#dscaw062.a;
                  |SAL;
               |FINSI;
            |SIGUE;
         |FINSI;
      |FINSI;
      |SI nNumSel = 0;
         aAlfa = "    NEsta seguro de querer confirmar la reclamacion del recibo ? ";
      |SINO;
         aAlfa = "    NEsta seguro de querer confirmar la reclamacion de los recibos ? ";
      |FINSI;
|FPRC;

|PROCESO LiberaMarca;
   #dscam013#20 = ""; |GRABA 020#dscam013.a;
|FPRC;

|DEFBUCLE LiberaMarca;
#dscam013#1;
;
#dscaz082#0, 001;
#dscaz082#0, 999;
be;
NULL, LiberaMarca;
|FIN;

|PROCESO Marcados;
     nSwMarcados = 0;
     |SI #dscaz082#7 = "R";
          |SALVA_DATOS #dscaw062;
          |SELECT #3#dscaw062;
          #dscaw062#6 = "*";
          #dscaw062#0 = 0;
          |LEE 000#dscaw062.];
          |SI FSalida = 0; |Y #dscaw062#6 = "*";
               nSwMarcados = 1;
          |FINSI;
          |REPON_DATOS #dscaw062;
          |SELECT #1#dscaw062;
          |LEE 000#dscaw062.=;
      |SINO;
          |SALVA_DATOS #dscaw063;
          |SELECT #3#dscaw063;
          #dscaw063#6 = "*";
          #dscaw063#0 = 0;
          |LEE 000#dscaw063.];
          |SI FSalida = 0; |Y #dscaw063#6 = "*";
               nSwMarcados = 1;
          |FINSI;
          |REPON_DATOS #dscaw063;
          |SELECT #1#dscaw063;
          |LEE 000#dscaw063.=;
     |FINSI;
     |SI nSwMarcados = 0;
          |MENAV "0000No existe ningn registro marcado...";
     |FINSI;
|FPRC;

|PROCESO Tipo11w062; |TIPO 11;
   |SI nSwEnt = 0;
      |MENSA "    <F2> Marcar, <F3> Rechazar, <F4> Reclamar, <F5> Abonar, <F6> Conf.Reclamado";
   |SINO;
      |SI nSwEnt = 1; |MENSA "    <F3> Abonar ";                      |FINSI;
      |SI nSwEnt = 2; |MENSA "    <F2> Marcar, <F3> Reclamar ";       |FINSI;
      |SI nSwEnt = 3; |MENSA "    <F2> Marcar, <F3> Conf.Reclamado "; |FINSI;
   |FINSI;

   nSw = 0;
   |SI FSalida = 10;
      |SI nSwEnt ! 1; |HAZ Marca1; |FINSI;
   |FINSI;

   |SI FSalida = 11;
      |SI nSwEnt ! 1;
          |HAZ Marcados;
          |SI nSwMarcados = 0; |ERROR; |ACABA; |FINSI;
      |FINSI;
      |SI nSwEnt = 0;
         |HAZ Rechaza;
         |PTEC 814; |PTEC 815;
      |FINSI;
      |SI nSwEnt = 1; nSw = 3;      |FINSI;
      |SI nSwEnt = 2;
          |HAZ Reclama;
          |PTEC 814; |PTEC 815;
      |FINSI;
      |SI nSwEnt = 3;
          |HAZ CfRecl;
          |PTEC 814; |PTEC 815;
      |FINSI;
   |FINSI;
   |SI FSalida = 12;
      |HAZ Marcados;
      |SI nSwMarcados = 0; |ERROR; |ACABA; |FINSI;
      |SI nSwEnt = 0; |HAZ Reclama; |FINSI;
   |FINSI;
   |SI FSalida = 13;
      |HAZ Marcados;
      |SI nSwMarcados = 0; |ERROR; |ACABA; |FINSI;
      |SI nSwEnt = 0;
         |SI #dscam012#22 = 1; |O #dscam012#22 = 3;
            |MENAV "    Las remesas al cobro son abonadas mediante el descuento";
            |ERROR;
         |FINSI;
         nSw = 3;
      |FINSI;
   |FINSI;
   |SI FSalida = 14;
      |HAZ Marcados;
      |SI nSwMarcados = 0; |ERROR; |ACABA; |FINSI;
      |SI nSwEnt = 0; |HAZ CfRecl; |FINSI;
   |FINSI;

   |SI nSw = 3;
      |SALVA_FICHA #dscaw062;
      |SI #dscam012#23 = "N";
         |MENAV "    Remesa no emitida. Proceso cancelado.";
         |REPON_FICHA #dscaw062; |ACABA;
      |FINSI;
      |SI #dscam012#8 = "S";
         |MENAV "    Remesa ya abonada. Proceso cancelado.";
         |REPON_FICHA #dscaw062; |ACABA;
      |FINSI;

      fFechaAb = #dscaz082#1;
      |HAZ PideEnlace;
      |SI aCodEnl = ""; |Y fFechaAb = "01.01.0000";
            |MENAV "    Proceso cancelado";
            |REPON_FICHA #dscaw062; |ACABA;
      |FINSI;

      |CONFI "    NEsta seguro que desea abonar la remesa ?";
      |SI FSalida ! 0;
         |REPON_FICHA #dscaw062; |ACABA;
      |FINSI;

      |BUCLE Abona;

      #dscam012#8 = "S"; |GRABA 020#dscam012.a;

      |SI HayConta = 1; |Y #dscam051#1 = "S";
         aAlfa = Usuario; |QBF aAlfa; aAlfa = "ac" + aAlfa;
         |NOME_DAT #910 aAlfa;
         |DELINDEX #dscaw013; |ABRE #dscaw013;
         |SUB_EJECUTA_NP "dscaz169.tab;INICIO";
         aAlfa = aCodEnl;
         |SI aAlfa = "    ";
            |ABRE #dscam093;
            #dscam093#0 = "A";
            |LEE 000#dscam093.=;
            |SI FSalida = 0;
               |SI #dscam012#22 = 1; aAlfa = #dscam093#1;  |FINSI;
               |SI #dscam012#22 = 2; aAlfa = #dscam093#3;  |FINSI;
               |SI #dscam012#22 = 3; aAlfa = #dscam093#5;  |FINSI;
               |SI #dscam012#22 = 4; aAlfa = #dscam093#7;  |FINSI;
               |SI #dscam012#22 = 5; aAlfa = #dscam093#9;  |FINSI;
               |SI #dscam012#22 = 6; aAlfa = #dscam093#11; |FINSI;
               |SI #dscam012#22 = 7; aAlfa = #dscam093#13; |FINSI;
            |FINSI;
            |CIERRA #dscam093;
            aCodEnl = aAlfa;
         |FINSI;

         |DDEFECTO #dscaw013;
         #dscaw013#0  = 1;            #dscaw013#15 = aCodEnl;
         #dscaw013#5  = #dscam013#0;  #dscaw013#6  = #dscam013#0;
         #dscaw013#11 = "N";          #dscaw013#12 = 5;
         #dscaw013#13 = "dscam013";   #dscaw013#14 = 0;
         |GRABA 020#dscaw013.n;

         |DDEFECTO #dscaw013;
         #dscaw013#0  = 2;            #dscaw013#15 = aCodEnl;
         #dscaw013#3  = "*";          #dscaw013#4  = "*";
         #dscaw013#11 = "A";          #dscaw013#12 = 1;
         #dscaw013#13 = "dscam013";   #dscaw013#14 = 20;
         |GRABA 020#dscaw013.n;

         |CIERRA #dscaw013;

         aAlfa = "dscam033.tab;" + aCodEnl + ",E" + fFechaAb;
         |LIBERA #dscam013; |CIERRAT #dscam013;
         |LIBERA #dscam012; |CIERRAT #dscam012;
         |SUB_EJECUTA_NP aAlfa;
         |SUB_EJECUTA_NP "dscaz169.tab;FINAL";

         |ABRET #dscam012; |LEE 101#dscam012.=;
         |ABRET #dscam013; |LEE 101#dscam013.=;

         |BUCLE LiberaMarca;
      |FINSI;
      |REPON_FICHA #dscaw062;
      |PONCONTROL 23, "si";
   |FINSI;
   |SI nSw = 1; |O nSw = 2; |O nSw = 4;
      |CONFI aAlfa;
      |SI FSalida ! 0;
         |MENAV "    Proceso cancelado";
         |ACABA;
      |FINSI;

      |SI nNumCar ! 0;
         nHayImp = 1;
      |SINO;
         nHayImp = 0;
      |FINSI;
      |SI nSw = 2; |Y nNumCar > 0;
         |HAZ Mes;
         |IMPRE 0;
         aInforme = "Carta reclamacion efectos"; |HAZ ObtenInforme;
         |SI aInforme = ""; aInforme = "dscaz066"; |FINSI;
         |INFOR aInforme;
      |FINSI;

      |SELECT #3#dscam004;
      |LEE 000#dscam004.u;
      |SI nNumSec [ #dscam004#43;
         nNumSec = #dscam004#43 + 1;
      |SINO;
         nNumSec = nNumSec + 1;
      |FINSI;
      |SELECT #1#dscam004;

      |SALVA_FICHA #dscaw062;
      |SI nNumSel ! 0;
         |BUCLE Accion;
         |SI nNumSec ! 0; |Y aSesion = "S";
            aAlfa = Usuario; |QBF aAlfa; aAlfa = "ac" + aAlfa;
            |NOME_DAT #910 aAlfa;
            |DELINDEX #dscaw013; |ABRE #dscaw013;
            |SUB_EJECUTA_NP "dscaz169.tab;INICIO";

            #dscaw013#15 = aCodEnl;      #dscaw013#0 = 1;
            #dscaw013#13 = "dscam004";   #dscaw013#14 = 43;
            #dscaw013#5  = nNumSec;      #dscaw013#6  = nNumSec;
            #dscaw013#11 = "N";          #dscaw013#12 = 10;
            |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
            |CIERRA #dscaw013;

            aAlfa = "dscam033.tab;" + aCodEnl;
            |LIBERA #dscam004; |CIERRAT #dscam004;
            |LIBERA #dscam003; |CIERRAT #dscam003;
            |SUB_EJECUTA_NP aAlfa;
            |SUB_EJECUTA_NP "dscaz169.tab;FINAL";

            |ABRET #dscam003; |LEE 101#dscam003.=;
            |ABRET #dscam004; |LEE 101#dscam004.=;

            |DELINDEX #dscaw013;
         |FINSI;
      |SINO;
         |HAZ Accion;
      |FINSI;
      |LEE 000#dscaw062.p; |REPON_FICHA #dscaw062;
      |SI nSw = 2; |Y nHayImp ! 0;
         |PIEINF; |FININF; |FINIMP;
         nHayImp = 0;
      |FINSI;
      |PONCONTROL 23, "si";
   |FINSI;
|FPRC;

|PROCESO Tipo5; |TIPO 5;
   |SI nSwEnt = 0;
      |MENSA "    <F2> Marcar, <F3> Rechazar, <F4> Reclamar, <F5> Abonar, <F6> Conf.Reclamado";
   |SINO;
      |SI nSwEnt = 1; |MENSA "    <F3> Abonar ";                      |FINSI;
      |SI nSwEnt = 2; |MENSA "    <F2> Marcar, <F3> Reclamar ";       |FINSI;
      |SI nSwEnt = 3; |MENSA "    <F2> Marcar, <F3> Conf.Reclamado "; |FINSI;
   |FINSI;
   |SI #dscaz082#7 = "R";
      #dscaw062#7 = "S"; |LINEAS_BI_ATRI #dscaw062#7,S,D,-1;
   |SINO;
      #dscaw063#7 = "S"; |LINEAS_BI_ATRI #dscaw063#7,S,D,-1;
   |FINSI;
|FPRC;

|RUTINA infw062;
   #dscaw062#0 = 1;
|FRUT;

|RUTINA supw062;
   #dscaw062#0 = 999;
|FRUT;

|RUTINA infw063;
   #dscaw063#0 = 1;
|FRUT;

|RUTINA supw063;
   #dscaw063#0 = 999;
|FRUT;

|PROGRAMA;
   |HAZ Tipo8;

   |HAZ EsArtenvas;
   |SI FSalida = 0;
      nSwArtenvas = 1;
   |SINO;
      nSwArtenvas = 0;
   |FINSI;

   |CLS; |CABEZA "sadlkfjsdlkjfa"; |PINPA #0#0;
   |SI PARAMETRO = "";      nSwEnt = 0; |FINSI;
   |SI PARAMETRO = "AB"; PARAMETRO = "ABONO"; |FINSI;
   |SI PARAMETRO = "ABONO"; nSwEnt = 1; |FINSI;
   |SI PARAMETRO = "RECLA"; nSwEnt = 2; |FINSI;
   |SI PARAMETRO = "CFREC"; nSwEnt = 3; |FINSI;

   nNuevo = 0;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   aAlfa = "tr" + Usuario; |QBF aAlfa;
   |NOME_DAT #0 aAlfa;
   aAlfa = "tl" + Usuario; |QBF aAlfa;
   |NOME_DAT #1 aAlfa;
   aAlfa = "tc" + Usuario; |QBF aAlfa;
   |NOME_DAT #2 aAlfa;

   |ABRET #dscam012;

|ET Otra;
   |PINPA #0#0; |PINDA #0#0;
   |SI PARAMETRO = "ABONO"; |CABEZA " Abono de remesas     "; |FINSI;
   |SI PARAMETRO = "RECLA"; |CABEZA " Peticion reclamacion "; |FINSI;
   |SI PARAMETRO = "CFREC"; |CABEZA " Confirm.reclamacion  "; |FINSI;
   |DELINDEX #dscaw062; |ABRE #dscaw062;
   |DELINDEX #dscaw063; |ABRE #dscaw063;
   |ABRE #dscam003; |ABRE #dscam002;
   |ENTLINEAL #1#dscaw062,1,7,21,1,infw062,supw062;

   |ENDATOS #1#0;
   |SI FSalida = 0;
      #dscam012#0 = #dscaz082#0;
      |LEE 101#dscam012.=;
      |SI nSwEnt = 1;
         |SI #dscam012#22 = 1; |O #dscam012#22 = 3;
            |MENAV "    Las remesas al cobro son abonadas mediante el descuento";
            |LIBERA #dscam012; |VETE Otra;
         |FINSI;
      |FINSI;

      #dscaz082#8 = #dscam012#2; #dscaz082#9 = #dscam012#3;
      nLinea = 1; nSwHay = 0;
      nTotalRem = 0; nTotalVenc = 0;
      |BUCLE RellenaLins;
      #dscaz082#2 = nTotalRem; #dscaz082#5 = nTotalVenc;
      |PINDA #0#0; nNumSel = 0; nNumCar = 0;
      |SI nSwHay = 0;
         |MENAV "    Seleccin vaca";
         |VETE Otra;
      |FINSI;

      |ABRE #dscam013; |ABRE #dscam066; |ABRE #dscam030;
      |ABRE #dscam003; |ABRE #dscam004; |ABRE #dscaz082;

      |SI #dscaz082#7 = "R";
         |ENTLINEAL #1#dscaw062,1,4,21,1,infw062,supw062;
      |SINO;
         |ENTLINEAL #1#dscaw063,1,4,21,1,infw063,supw063;
      |FINSI;

      |CIERRA #dscam003; |CIERRA #dscam004; |CIERRA #dscaz082;
      |CIERRA #dscam030; |CIERRA #dscam013; |CIERRA #dscam066;

      |DDEFECTO #dscaz082;
      |LIBERA #dscam012;
      |VETE Otra;
   |FINSI;

   |CIERRAT #dscam012;
   |CIERRA #dscam002; |CIERRA #dscaw063;
   |CIERRA #dscaw062; |CIERRA #dscam003;

   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tr" + Usuario + ".dat"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tr" + Usuario + ".ddx"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tr" + Usuario + ".ixx"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".dat"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".ddx"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".ixx"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".dat"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".ixx"; |FBORRA aAlfa;
   |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".ddx"; |FBORRA aAlfa;

   |HAZ Tipo9;
|FPRO;
