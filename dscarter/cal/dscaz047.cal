|FICHEROS;
   dscaz047 #0;

   dscam023 #1,MANTE;
   dscam024 #2;

   &agif024@ #3;
   &caclipr@ #4;
|FIN;

|VARIABLES;
   nUnaVez = 0; ||Variable para controlar que solo se hace una vez el infor-> Crystal

   &Fichero    = ""; &Tipo = ""; &Cmp = ""; &CmpNum = 0;
   &DirCliente = ""; &Cp   = ""; &PobCliente = ""; &ProvCliente = "";
   &Telefono   = ""; &Fax  = ""; &Movil      = ""; &PersCont    = "";

   &HayGestion = 0; &aInforme = "";

   Comodin = ""; Comodin1 = "";
   &TipoCliente = ""; &CodCliente = "";
   &DCampoG = 0;      &HCampoG = 0;
|FIN;

|PROCESO MiraCliente;
   |SI FSalida = 10;
      TipoCliente = "G";
      DCampoG = 0; HCampoG = 1;
      |HAZ ExisteCliente;
      #dscaz047#Campo# = CodCliente; |PINTA #dscaz047#Campo#;
   |FINSI;
|FPRC;

|PROCESO TiposRiesgo;
   |PRINT;
|FPRC;

|DEFBUCLE TiposRiesgo;
  #dscam024#1;
  ;
  #dscam023#0,01;
  #dscam023#0,99;
  ;
  NULL,TiposRiesgo;
|FIN;

|PROCESO Estado;
   aInforme = "Informe estado cliente"; |HAZ ObtenInforme;
   |SI Impresora = "CrystalReport";
     |SI nUnaVez = 1;
          FSalida = 0;
     |SINO;
          |INFOR aInforme;
          nUnaVez = 1;
     |FINSI;
   |SINO;
     |INFOR aInforme;
   |FINSI;
   |SI FSalida ! 0; |ACABA; |FINSI;
      Fichero = "Clientes"; Tipo = "G";
      Cmp = "Codigo Cliente"; |HAZ ObtenDato;
      #agif024@#CmpNum# = #dscam023#0;
      |LEE 000#agif024@.=;
      |SI FSalida = 0; |Y #agif024@#CmpNum# ! "      ";
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Direccion Cobro"; |HAZ ObtenDato;
         DirCliente  = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Codigo Postal Cobro"; |HAZ ObtenDato;
         Cp          = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Poblacion Cobro"; |HAZ ObtenDato;
         PobCliente  = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Provincia Cobro"; |HAZ ObtenDato;
         ProvCliente = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Telefono"; |HAZ ObtenDato;
         Telefono = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Fax"; |HAZ ObtenDato;
         Fax = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Movil"; |HAZ ObtenDato;
         Movil = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Persona Contacto"; |HAZ ObtenDato;
         PersCont = #agif024@#CmpNum#;
      |FINSI;
   |BUCLE TiposRiesgo;
   |PIEINF;
   |SI Impresora ! "CrystalReport";
     |FININF;
   |FINSI;
|FPRC;

|DEFBUCLE Estado;
  #dscam023#1;
  ;
  #dscaz047#0;
  #dscaz047#1;
  ;
  NULL,Estado;
|FIN;

|PROGRAMA;
   |HAZ Tipo8;

   |CLS;
   |CABEZA "Informe estado cliente";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |SI HayGestion = 1;
         Comodin = #48#17; |QBF Comodin;
         Comodin1 = ("00000" + #48#15) % -105;
         Comodin1 = Comodin + "fich/" + Comodin1 + "/";
         |PATH_DAT #3 Comodin1;
         |ABRE #agif024@;
      |SINO;
         Comodin = #48#16; |QBF Comodin;
         Comodin1 = (("00000" + #48#14) % -105) + #48#19;
         Comodin1 = Comodin + "fich/" + Comodin1 + "/";
         |PATH_DAT #4 Comodin1;
         |ABRE #caclipr@;
      |FINSI;

      |HAZ TomaDecim;
      |ABRE #dscam023; |ABRE #dscam024;
      |BUCLE Estado;
      |CIERRA #dscam023; |CIERRA #dscam024;
      |SI HayGestion = 1;
         |CIERRA #agif024@;
      |SINO;
         |CIERRA #caclipr@;
      |FINSI;
      |SI Impresora = "CrystalReport";
          |FININF;
      |FINSI;
      |FINIMP;
   |FINSI;

   |HAZ Tipo9;
|FPRO;
