|FICHEROS;

   dscam030 #1;
   dscaw013 #2,MANTE;

   dscam003 #10;
   dscam004 #11;

   dscam008 #12;
   dscam009 #13;

   dscam012 #14;
   dscam013 #15;

   dscam021 #16;
   dscam022 #17;

   dscam046 #18;
   dscam047 #19;

   dscam049 #20;
   dscam050 #21;

   prelava@ #501;
   prelavc@ #502;

   dscaz900 #900;

   Referen@ #1000;

   referen1@;
|FIN;

|VARIABLES;
   nBorrados = 0;
   aDef = "";
   &enNumRegs = 0;
   aFich  = "";
   aFichC = "";
   aAlfa  = "";
   aAlfa1 = "";
   aFichero = "";
   Comodin  = "";

   nCont    = 0;
   nCont1   = 0;
   nCalc    = 0;
   nComp    = 0;
   nSwHay   = 0;

   nClave   = 0;
   nNumRels = 0;

   aDCodigoCli = ""; aHCodigoCli = "";
   aDCuentaCli = ""; aHCuentaCli = "";
   aDNombreCli = ""; aHNombreCli = "";
   aDZona      = ""; aHZona      = "";
   aDSerie     = ""; aHSerie     = "";
   aDOper      = ""; aHOper      = "";
   aDMarca     = ""; aHMarca     = "";
   aDMarca1    = ""; aHMarca1    = "";
   nDNumeroAnt = 0;  nHNumeroAnt = 0;
   nDNumero    = 0;  nHNumero    = 0;
   nDNumero1   = 0;  nHNumero1   = 0;
   nDDocumto   = 0;  nHDocumto   = 0;
   nDLinea     = 0;  nHLinea     = 0;
   nDLineaAnt  = 0;  nHLineaAnt  = 0;
   nDLinea1    = 0;  nHLinea1    = 0;
   nDLibro     = 0;  nHLibro     = 0;
   nDImporte   = 0;  nHImporte   = 0;
   nDSecuen    = 0;  nHSecuen    = 0;
   nDRemesa    = 0;  nHRemesa    = 0;
   nDRemesaAnt = 0;  nHRemesaAnt = 0;
   aDDepart    = ""; aHDepart    = "";
   nDEmpresa   = 0;  nHEmpresa  = 0;
   aDEntidad   = ""; aHEntidad  = "";
   aDRepres    = ""; aHRepres   = "";
   aDNumPag    = ""; aHNumPag    = "";
   nDTRec      = 0;  nHTRec      = 0;
   nDBanco     = 0;  nHBanco     = 0;
   fDFecha     = @;  fHFecha     = @;
   fDFecha1    = @;  fHFecha1    = @;

   nDDocum     = 0;  nHDocum     = 0;
   nDLinDoc    = 0;  nHLinDoc    = 0;
|FIN;

|PROCESO FiltraLRV;
   aAlfa = "|NC"; aAlfa = #prelava@#aAlfa#;
   nCalc = aAlfa; nCalc = nCalc - 1;
   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
      #prelava@#nCont# = #dscam004#nCont#;
   |SIGUE;
   |GRABA 020#prelava@.n;
   enNumRegs = enNumRegs + 1;
   #dscaz900#2 = enNumRegs; |PINTA #dscaz900#2;
   nSwHay = 1;
|FPRC;

|DEFBUCLE LinRecV1;
#dscam004#1;
;
nDDocum, nDLinDoc;
nHDocum, nHLinDoc;
be;
NULL,FiltraLRV;
|FIN;

|DEFBUCLE LinRecV2;
#dscam004#2;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDLinea1;
nHLibro, aHSerie, nHNumero, nHLinea, nHLinea1;
;
NULL,FiltraLRV;
|FIN;

|DEFBUCLE LinRecV3;
#dscam004#3;
;
nDSecuen;
nHSecuen;
;
NULL,FiltraLRV;
|FIN;

|DEFBUCLE LinRecV4;
#dscam004#4;
;
aDOper, nDNumero;
aHOper, nHNumero;
;
NULL,FiltraLRV;
|FIN;

|DEFBUCLE LinRecV5;
#dscam004#5;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL,FiltraLRV;
|FIN;

|DEFBUCLE LinRecV6;
#dscam004#6;
;
aDSerie, nDNumero, fDFecha;
aHSerie, nHNumero, fHFecha;
;
NULL,FiltraLRV;
|FIN;

|DEFBUCLE LinRecV7;
#dscam004#7;
;
fDFecha, nDNumero;
fHFecha, nHNumero;
;
NULL,FiltraLRV;
|FIN;

|PROCESO FiltraCRV;
   nDNumeroAnt = nDNumero;  nHNumeroAnt = nHNumero;
   nDLineaAnt  = nDLinea;   nHLineaAnt  = nHLinea;
   nDDocum  = #dscam003#40; nHDocum  = #dscam003#40;
   nDLinDoc = 001;          nHLinDoc = 999;
   |BUCLE LinRecV1;
   nSwHay = 1;
|FPRC;

|DEFBUCLE CabRecV1;
#dscam003#1;
;
nDNumero;
nHNumero;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV2;
#dscam003#2;
;
fDFecha, nDNumero;
fHFecha, nHNumero;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV3;
#dscam003#3;
;
fDFecha, nDNumero;
fHFecha, nHNumero;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV4;
#dscam003#4;
;
aDCuentaCli, nDNumero;
aHCuentaCli, nHNumero;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV5;
#dscam003#5;
;
nDNumero, nDEmpresa;
nHNumero, nHEmpresa;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV6;
#dscam003#6;
;
nDLibro, aDSerie, nDNumero, nDLinea, aDMarca, nDDocumto;
nHLibro, aHSerie, nHNumero, nHLinea, aHMarca, nHDocumto;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV7;
#dscam003#7;
;
aDEntidad, aDNumPag, nDNumero;
aHEntidad, aHNumPag, nHNumero;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV8;
#dscam003#8;
;
nDNumero, nDNumero1;
nHNumero, nHNumero1;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV9;
#dscam003#9;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDNumero1;
nHLibro, aHSerie, nHNumero, nHLinea, nDNumero1;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV10;
#dscam003#10;
;
aDMarca, nDNumero, nDEmpresa, aDRepres, fDFecha;
aHMarca, nHNumero, nHEmpresa, aDRepres, fHFecha;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV11;
#dscam003#11;
;
aDCodigoCli, fDFecha, aDZona;
aHCodigoCli, fHFecha, aHZona;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV12;
#dscam003#12;
;
aDSerie, nDNumero, nDLinea, fDFecha, aDCuentaCli, aDCodigoCli;
aHSerie, nHNumero, nHLinea, fHFecha, aHCuentaCli, aHCodigoCli;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV13;
#dscam003#13;
;
nDNumero, nDNumero1;
nHNumero, nHNumero1;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV14;
#dscam003#14;
;
nDRemesa, aDEntidad, aDNumPag, nDNumero;
nHRemesa, aHEntidad, aHNumPag, nHNumero;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV15;
#dscam003#15;
;
aDCodigoCli, aDCuentaCli, aDMarca;
aHCodigoCli, aHCuentaCli, aHMarca;
;
NULL,FiltraCRV;
|FIN;

|DEFBUCLE CabRecV16;
#dscam003#16;
;
aDCodigoCli, aDCuentaCli, nDTRec, fDFecha, aDDepart, nDImporte;
aHCodigoCli, aHCuentaCli, nHTRec, fHFecha, aHDepart, nHImporte;
;
NULL,FiltraCRV;
|FIN;

|PROCESO FiltraLRC;
   aAlfa = "|NC"; aAlfa = #prelava@#aAlfa#;
   nCalc = aAlfa; nCalc = nCalc - 1;
   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
      #prelava@#nCont# = #dscam009#nCont#;
   |SIGUE;
   |GRABA 020#prelava@.n;
   enNumRegs = enNumRegs + 1;
   #dscaz900#2 = enNumRegs; |PINTA #dscaz900#2;
   nSwHay = 1;
|FPRC;

|DEFBUCLE LinRecC1;
#dscam009#1;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL, FiltraLRC;
|FIN;

|DEFBUCLE LinRecC2;
#dscam009#2;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDLinea1;
nHLibro, aHSerie, nHNumero, nHLinea, nHLinea1;
;
NULL, FiltraLRC;
|FIN;

|DEFBUCLE LinRecC3;
#dscam009#3;
;
nDSecuen;
nHSecuen;
;
NULL, FiltraLRC;
|FIN;

|PROCESO FiltraCRC;
   nDNumeroAnt = nDNumero;  nHNumeroAnt = nHNumero;
   nDLineaAnt  = nDLinea;   nHLineaAnt  = nHLinea;
   nDNumero = #dscam008#40; nHNumero = #dscam008#40;
   nDLinea  = 001;          nHLinea  = 999;
   |BUCLE LinRecC1;
   nDNumero = nDNumeroAnt;  nHNumero = nHNumeroAnt;
   nDLinea  = nDLineaAnt;   nHLinea  = nHLineaAnt;
|FPRC;

|DEFBUCLE CabRecC1;
#dscam008#1;
;
nDNumero;
nHNumero;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC2;
#dscam008#2;
;
nDLibro, aDSerie, nDNumero, nDLinea;
nHLibro, aHSerie, nHNumero, nHLinea;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC3;
#dscam008#3;
;
fDFecha, nDNumero;
fHFecha, nHNumero;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC4;
#dscam008#4;
;
fDFecha, nDNumero;
fHFecha, nHNumero;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC5;
#dscam008#5;
;
aDCuentaCli, nDNumero;
aHCuentaCli, nHNumero;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC6;
#dscam008#6;
;
aDCuentaCli, aDCodigoCli, fDFecha;
aHCuentaCli, aHCodigoCli, fHFecha;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC7;
#dscam008#7;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDNumero;
nHLibro, aHSerie, nHNumero, nHLinea, nHNumero;
;
NULL,FiltraCRC;
|FIN;

|DEFBUCLE CabRecC8;
#dscam008#8;
;
aDCodigoCli, aDCuentaCli, aDSerie, fDFecha;
aHCodigoCli, aHCuentaCli, aHSerie, fHFecha;
;
NULL,FiltraCRC;
|FIN;

|PROCESO FiltraRL;
   aAlfa = "|NC"; aAlfa = #prelava@#aAlfa#;
   nCalc = aAlfa; nCalc = nCalc - 1;
   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
      #prelava@#nCont# = #dscam013#nCont#;
   |SIGUE;
   |GRABA 020#prelava@.n;
   enNumRegs = enNumRegs + 1;
   #dscaz900#2 = enNumRegs; |PINTA #dscaz900#2;
   nSwHay = 1;
|FPRC;

|DEFBUCLE RemLin1;
#dscam013#1;
;
nDRemesa, nDLinea;
nHRemesa, nHLinea;
;
NULL,FiltraRL;
|FIN;

|DEFBUCLE RemLin2;
#dscam013#2;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL,FiltraRL;
|FIN;

|DEFBUCLE RemLin3;
#dscam013#3;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDNumero1;
nHLibro, aHSerie, nHNumero, nHLinea, nHNumero1;
;
NULL,FiltraRL;
|FIN;

|DEFBUCLE RemLin4;
#dscam013#4;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL,FiltraRL;
|FIN;

|DEFBUCLE RemLin5;
#dscam013#5;
;
aDMarca, nDNumero;
aHMarca, nHNumero;
;
NULL,FiltraRL;
|FIN;

|PROCESO FiltraRC;
   nDRemesaAnt = nDRemesa;  nHNumeroAnt = nHRemesa;
   nDLineaAnt  = nDLinea;   nHLineaAnt  = nHLinea;
   nDRemesa = #dscam012#0;  nHRemesa = #dscam012#0;
   nDLinea  = 001;          nHLinea  = 999;
   |BUCLE RemLin1;
   nDRemesa = nDNumeroAnt;  nHRemesa = nHNumeroAnt;
   nDLinea  = nDLineaAnt;   nHLinea  = nHLineaAnt;
|FPRC;

|DEFBUCLE RemCab1;
#dscam012#1;
;
nDRemesa;
nHRemesa;
;
NULL,FiltraRC;
|FIN;

|DEFBUCLE RemCab2;
#dscam012#2;
;
fDFecha, nDRemesa;
fHFecha, nHRemesa;
;
NULL,FiltraRC;
|FIN;

|DEFBUCLE RemCab3;
#dscam012#3;
;
fDFecha, nDRemesa, aDMarca, aDMarca1;
fHFecha, nHRemesa, aHMarca, aHMarca1;
;
NULL,FiltraRC;
|FIN;

|PROCESO FiltraPL;
   aAlfa = "|NC"; aAlfa = #prelava@#aAlfa#;
   nCalc = aAlfa; nCalc = nCalc - 1;
   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
      #prelava@#nCont# = #dscam022#nCont#;
   |SIGUE;
   |GRABA 020#prelava@.n;
   enNumRegs = enNumRegs + 1;
   #dscaz900#2 = enNumRegs; |PINTA #dscaz900#2;
   nSwHay = 1;
|FPRC;

|DEFBUCLE PagLin1;
#dscam022#1;
;
nDRemesa, nDLinea;
nHRemesa, nHLinea;
;
NULL,FiltraPL;
|FIN;

|DEFBUCLE PagLin2;
#dscam022#2;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL,FiltraPL;
|FIN;

|DEFBUCLE PagLin3;
#dscam022#3;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDNumero1;
nHLibro, aHSerie, nHNumero, nHLinea, nHNumero1;
;
NULL,FiltraPL;
|FIN;

|PROCESO FiltraPC;
   nDRemesaAnt = nDRemesa;  nHNumeroAnt = nHRemesa;
   nDLineaAnt  = nDLinea;   nHLineaAnt  = nHLinea;
   nDRemesa = #dscam021#0;  nHRemesa = #dscam021#0;
   nDLinea  = 001;          nHLinea  = 999;
   |BUCLE PagLin1;
   nDRemesa = nDNumeroAnt;  nHRemesa = nHNumeroAnt;
   nDLinea  = nDLineaAnt;   nHLinea  = nHLineaAnt;
|FPRC;

|DEFBUCLE PagCab1;
#dscam021#1;
;
nDRemesa;
nHRemesa;
;
NULL,FiltraPC;
|FIN;

|DEFBUCLE PagCab2;
#dscam021#2;
;
fDFecha, nDRemesa;
fHFecha, nHRemesa;
;
NULL,FiltraPC;
|FIN;

|DEFBUCLE PagCab3;
#dscam021#3;
;
fDFecha, nDRemesa, aDMarca, nDImporte;
fHFecha, nHRemesa, aHMarca, nHImporte;
;
NULL,FiltraPC;
|FIN;

|DEFBUCLE PagCab4;
#dscam021#4;
;
fDFecha, nDBanco, fDFecha1;
fHFecha, nHBanco, fHFecha1;
;
NULL,FiltraPC;
|FIN;

|PROCESO FiltraTL;
   aAlfa = "|NC"; aAlfa = #prelava@#aAlfa#;
   nCalc = aAlfa; nCalc = nCalc - 1;
   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
      #prelava@#nCont# = #dscam047#nCont#;
   |SIGUE;
   |GRABA 020#prelava@.n;
   enNumRegs = enNumRegs + 1;
   #dscaz900#2 = enNumRegs; |PINTA #dscaz900#2;
   nSwHay = 1;
|FPRC;

|DEFBUCLE TalLin1;
#dscam047#1;
;
nDRemesa, nDLinea;
nHRemesa, nHLinea;
;
NULL,FiltraTL;
|FIN;

|DEFBUCLE TalLin2;
#dscam047#2;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL,FiltraTL;
|FIN;

|DEFBUCLE TalLin3;
#dscam047#3;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDNumero1;
nHLibro, aHSerie, nHNumero, nHLinea, nHNumero1;
;
NULL,FiltraTL;
|FIN;

|PROCESO FiltraTC;
   nDRemesaAnt = nDRemesa;  nHNumeroAnt = nHRemesa;
   nDLineaAnt  = nDLinea;   nHLineaAnt  = nHLinea;
   nDRemesa = #dscam046#0;  nHRemesa = #dscam046#0;
   nDLinea  = 001;          nHLinea  = 999;
   |BUCLE TalLin1;
   nDRemesa = nDNumeroAnt;  nHRemesa = nHNumeroAnt;
   nDLinea  = nDLineaAnt;   nHLinea  = nHLineaAnt;
|FPRC;

|DEFBUCLE TalCab1;
#dscam046#1;
;
nDRemesa;
nHRemesa;
;
NULL,FiltraTC;
|FIN;

|DEFBUCLE TalCab2;
#dscam046#2;
;
fDFecha, nDRemesa;
fHFecha, nHRemesa;
;
NULL,FiltraTC;
|FIN;

|DEFBUCLE TalCab3;
#dscam046#3;
;
fDFecha, nDRemesa, aDMarca, nDImporte;
fHFecha, nHRemesa, aHMarca, nHImporte;
;
NULL,FiltraTC;
|FIN;

|DEFBUCLE TalCab4;
#dscam046#4;
;
nDBanco, fDFecha1;
nHBanco, fHFecha1;
;
NULL,FiltraTC;
|FIN;

|PROCESO FiltraCL;
   aAlfa = "|NC"; aAlfa = #prelava@#aAlfa#;
   nCalc = aAlfa; nCalc = nCalc - 1;
   |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
      #prelava@#nCont# = #dscam050#nCont#;
   |SIGUE;
   |GRABA 020#prelava@.n;
   enNumRegs = enNumRegs + 1;
   #dscaz900#2 = enNumRegs; |PINTA #dscaz900#2;
   nSwHay = 1;
|FPRC;

|DEFBUCLE ConLin1;
#dscam050#1;
;
nDRemesa, nDLinea;
nHRemesa, nHLinea;
;
NULL,FiltraCL;
|FIN;

|DEFBUCLE ConLin2;
#dscam050#2;
;
nDNumero, nDLinea;
nHNumero, nHLinea;
;
NULL,FiltraCL;
|FIN;

|DEFBUCLE ConLin3;
#dscam050#3;
;
nDLibro, aDSerie, nDNumero, nDLinea, nDNumero1;
nHLibro, aHSerie, nHNumero, nHLinea, nHNumero1;
;
NULL,FiltraCL;
|FIN;

|DEFBUCLE ConLin4;
#dscam050#4;
;
nDSecuen;
nHSecuen;
;
NULL,FiltraCL;
|FIN;

|DEFBUCLE ConLin5;
#dscam050#5;
;
nDRemesa, aDCuentaCli, aDNombreCli, fDFecha, aDMarca, nDLinea;
nHRemesa, aHCuentaCli, aHNombreCli, fHFecha, aHMarca, nHLinea;
;
NULL,FiltraCL;
|FIN;

|PROCESO FiltraCC;
   nDRemesaAnt = nDRemesa;  nHNumeroAnt = nHRemesa;
   nDLineaAnt  = nDLinea;   nHLineaAnt  = nHLinea;
   nDRemesa = #dscam049#0;  nHRemesa = #dscam049#0;
   nDLinea  = 001;          nHLinea  = 999;
   |BUCLE ConLin1;
   nDRemesa = nDNumeroAnt;  nHRemesa = nHNumeroAnt;
   nDLinea  = nDLineaAnt;   nHLinea  = nHLineaAnt;
|FPRC;

|DEFBUCLE ConCab1;
#dscam049#1;
;
nDRemesa;
nHRemesa;
;
NULL,FiltraCC;
|FIN;

|DEFBUCLE ConCab2;
#dscam049#2;
;
fDFecha, nDRemesa;
fHFecha, nHRemesa;
;
NULL,FiltraCC;
|FIN;

|DEFBUCLE ConCab3;
#dscam049#3;
;
fDFecha, nDRemesa, aDMarca, nDImporte;
fHFecha, nHRemesa, aHMarca, nHImporte;
;
NULL,FiltraCC;
|FIN;

|DEFBUCLE ConCab4;
#dscam049#4;
;
nDBanco, fDFecha1;
nHBanco, fHFecha1;
;
NULL,FiltraCC;
|FIN;

|PROCESO SacaClave;
   nClave = 999; nComp = 999;
   |DDEF aAlfa; |QBF aAlfa; aAlfa = aAlfa + #dscam030#9 + ".mas";
   |CARGA_DEF aAlfa,Referen@;
   |SI FSalida = 0;
      aAlfa = "|NK"; aAlfa = #Referen@#aAlfa#; nNumRels = aAlfa; nNumRels = nNumRels - 1;
      |PARA nCont = 0; |SI nCont [ nNumRels; |HACIENDO nCont = nCont + 1;
         nCont1 = 0;
         aAlfa = "|K" + (("000" + nCont) % -103); aAlfa = #Referen@#aAlfa#;
         aAlfa1 = aAlfa % 0103; aAlfa = aAlfa % 0499;
         |PARA; |SI aAlfa ! ""; |HACIENDO;
            nCont1 = nCont1 + 1;
            aAlfa1 = aAlfa % 0103; aAlfa = aAlfa % 0499; nCalc = aAlfa1;
            ||SI nCalc = #dscam030#9; ABDON
            |SI nCalc = #dscam030#10;
               |SI nCont1 [ nComp;
                  nClave = nCont + 1; nComp = nCont1;
               |FINSI;
            |FINSI;
         |SIGUE;
      |SIGUE;
      |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;

|PROCESO Prelavado;
   |DDEFECTO #dscaz900;
   |HORA aAlfa; |QBF aAlfa;
   |SI #dscam030#10 ! 999;
      #dscaz900#0 = aAlfa;
   |SINO;
      #dscaz900#0 = "";
      #dscaz900#1 = "";
      #dscaz900#2 = "DESACTIVADA";
   |FINSI;

   |PINPA #0#dscaz900; |PINDA #0#dscaz900;

   |SI #dscam030#10 = 999;
      |PINTA 1523, " Seleccionando ..."; |ACABA;
   |FINSI;

   enNumRegs = 0;

   |SI #dscam030#2 = "CB";
      aFich = "dscam004"; aFichC = "dscam003";
   |FINSI;
   |SI #dscam030#2 = "PG";
      aFich = "dscam009"; aFichC = "dscam008";
   |FINSI;
   |SI #dscam030#2 = "RM";
      aFich = "dscam013"; aFichC = "dscam012";
   |FINSI;
   |SI #dscam030#2 = "PA";
      aFich = "dscam022"; aFichC = "dscam021";
   |FINSI;
   |SI #dscam030#2 = "TA";
      aFich = "dscam047"; aFichC = "dscam046";
   |FINSI;
   |SI #dscam030#2 = "CF";
      aFich = "dscam050"; aFichC = "dscam049";
   |FINSI;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + aFich + ".mas";
   |CARGA_DEF aAlfa, prelava@;
   |SI FSalida ! 0;
      |PINTA 1523, " Seleccionando ...";
      |ACABA;
   |FINSI;

   |SI aFich ! aFichC;
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aFichC + ".mas";
      |CARGA_DEF aAlfa, prelavc@;
      |SI FSalida ! 0;
         |DESCARGA_DEF #prelava@;
         |PINTA 1523, " Seleccionando ...";
         |ACABA;
      |FINSI;
   |FINSI;

   aAlfa = "pl" + Usuario; |NOME_DAT #501#aAlfa#; |DELINDEX #501; |ABRE #501;
   |SI aFich ! aFichC;
      aAlfa = "pc" + Usuario; |NOME_DAT #502#aAlfa#; |DELINDEX #502; |ABRE #502;
   |FINSI;

   |SI #dscam030#9 = aFich;
      |HAZ SacaClave;
   |SINO;
      |SI #dscam030#9 = aFichC;
         |HAZ SacaClave;
      |FINSI;
   |FINSI;

   nSwHay   = 0;
   |SI nClave ! 999;
      aDCodigoCli = "      ";       aHCodigoCli = "zzzzzz";
      aDCuentaCli = "            "; aHCuentaCli = "zzzzzzzzzzzz";
      aDNombreCli = " " * 60;       aHNombreCli = "z" * 60;
      aDZona      = "     ";        aHZona      = "zzzzz";
      aDSerie     = "     ";        aHSerie     = "zzzzz";
      aDOper      = "   ";          aHOper      = "zzz";
      aDMarca     = " ";            aHMarca     = "z";
      aDMarca1    = " ";            aHMarca1    = "z";
      nDLibro     = 0;              nHLibro     = 99;
      nDLinea     = 1;              nHLinea     = 999;
      nDLinea1    = 1;              nHLinea1    = 999;
      nDLineaAnt  = 1;              nHLineaAnt  = 999;
      nDNumero    = 0;              nHNumero    = 999999999;
      nDRemesa    = 1;              nHRemesa    = 99999;
      nDRemesaAnt = 1;              nHRemesaAnt = 99999;
      nDSecuen    = 1;              nHSecuen    = 999999999;
      nDNumero1   = 1;              nHNumero1   = 999999;
      nDDocumto   = 1;              nHDocumto   = 999999999;
      nDNumeroAnt = 1;              nHNumeroAnt = 999999;
      nDImporte   = -999999999.9999;nHImporte   = 9999999999.9999;
      aDDepart    = "  ";           aHDepart    = "zz";
      nDEmpresa   = 0;              nHEmpresa   = 99999;
      aDEntidad   = "    ";         aHEntidad  = "zzzz";
      aDRepres    = "  ";           aHRepres   = "zz";
      aDNumPag    = "          ";   aHNumPag    = "zzzzzzzzzz";
      nDTRec      = 0;              nHTRec      = 99;
      nDBanco     = 0;              nHBanco     = 999;
      fDFecha     = "01.01.1900";   fHFecha     = "31.12.2999";
      fDFecha1    = "01.01.1900";   fHFecha1    = "31.12.2999";

      Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
      |NOME_DAT #dscaw013#Comodin#;

      |ABRE #dscaw013;
      |SELECT #3#dscaw013;
      #dscaw013#13 = #dscam030#9;
      #dscaw013#14 = #dscam030#10;
      |LEE 000#dscaw013.=;
      |PARA; |SI FSalida = 0;
                    |Y #dscaw013#13 = #dscam030#9;
                    |Y #dscaw013#14 = #dscam030#10; |HACIENDO;

               |SI #dscaw013#15 = #dscam030#0; |SAL; |FINSI;

         |LEE 000#dscaw013.s;
      |SIGUE;

      |SI #dscaw013#13 = #dscam030#9;
              |Y #dscaw013#14 = #dscam030#10;
              |Y #dscaw013#15 = #dscam030#0;
         |SI #dscam030#2 = "CB";
            |SI #dscaw013#13 = aFich;
               |SI nClave = 1;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#3; nHLinea  = #dscaw013#4; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDLinea1  = #dscaw013#5; nHLinea1  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; nDSecuen  = #dscaw013#5; nHSecuen  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; aDOper     = #dscaw013#3; aHOper     = #dscaw013#4; |FINSI;
                  |SI nComp = 2; nDNumero   = #dscaw013#5; nHNumero   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 5;
                  |SI nComp = 1; nDNumero   = #dscaw013#5; nHNumero   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea    = #dscaw013#5; nHLinea    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 6;
                  |SI nComp = 1; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 2; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 3; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
               |FINSI;
               |SI nClave = 7;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
               |FINSI;

               |SI nClave = 1; |BUCLE LinRecV1; |FINSI;
               |SI nClave = 2; |BUCLE LinRecV2; |FINSI;
               |SI nClave = 3; |BUCLE LinRecV3; |FINSI;
               |SI nClave = 4; |BUCLE LinRecV4; |FINSI;
               |SI nClave = 5; |BUCLE LinRecV5; |FINSI;
               |SI nClave = 6; |BUCLE LinRecV6; |FINSI;
               |SI nClave = 7; |BUCLE LinRecV7; |FINSI;
            |FINSI;

            |SI #dscam030#9 = aFichC;
               |SI nClave = 1;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 5;
                  |SI nComp = 1; nDNumero    = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDEmpresa   = #dscaw013#5; nHEmpresa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 6;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; aDMarca   = #dscaw013#3; aHMarca   = #dscaw013#4; |FINSI;
                  |SI nComp = 6; nDDocumto = #dscaw013#5; nHDocumto = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 7;
                  |SI nComp = 1; aDEntidad   = #dscaw013#3; aHEntidad   = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDNumPag    = #dscaw013#3; aHNumPag    = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 8;
                  |SI nComp = 1; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDNumero1   = #dscaw013#5; nHNumero1   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 9;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 10;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 11;
                  |SI nComp = 1; aDCodigoCli = #dscaw013#3; aHCodigoCli = #dscaw013#4; |FINSI;
                  |SI nComp = 2; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
                  |SI nComp = 3; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 12;
                  |SI nComp = 1; aDSerie     = #dscaw013#3; aHSerie     = #dscaw013#4; |FINSI;
                  |SI nComp = 2; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
                  |SI nComp = 3; nDLinea     = #dscaw013#5; nHLinea     = #dscaw013#6; |FINSI;
                  |SI nComp = 4; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
                  |SI nComp = 5; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 6; aDCodigoCli = #dscaw013#3; aHCodigoCli = #dscaw013#4; |FINSI;
               |FINSI;
               |SI nClave = 13;
                  |SI nComp = 1; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDNumero1   = #dscaw013#5; nHNumero1   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 14;
                  |SI nComp = 1; nDRemesa    = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDEntidad   = #dscaw013#3; aHEntidad = #dscaw013#4; |FINSI;
                  |SI nComp = 3; aDNumPag    = #dscaw013#3; aHNumPag  = #dscaw013#4; |FINSI;
                  |SI nComp = 4; nDNumero    = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 15;
                  |SI nComp = 1; aDCodigoCli = #dscaw013#3; aHCodigoCli = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 3; aDMarca     = #dscaw013#3; aHMarca     = #dscaw013#4; |FINSI;
               |FINSI;
               |SI nClave = 16;
                  |SI nComp = 1; aDCodigoCli = #dscaw013#3; aHCodigoCli = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDTRec      = #dscaw013#5; nHTRec      = #dscaw013#6; |FINSI;
               |FINSI;

               |SI nClave = 1;  |BUCLE CabRecV1;  |FINSI;
               |SI nClave = 2;  |BUCLE CabRecV2;  |FINSI;
               |SI nClave = 3;  |BUCLE CabRecV3;  |FINSI;
               |SI nClave = 4;  |BUCLE CabRecV4;  |FINSI;
               |SI nClave = 5;  |BUCLE CabRecV5;  |FINSI;
               |SI nClave = 6;  |BUCLE CabRecV6;  |FINSI;
               |SI nClave = 7;  |BUCLE CabRecV7;  |FINSI;
               |SI nClave = 8;  |BUCLE CabRecV8;  |FINSI;
               |SI nClave = 9;  |BUCLE CabRecV9;  |FINSI;
               |SI nClave = 10; |BUCLE CabRecV10; |FINSI;
               |SI nClave = 11; |BUCLE CabRecV11; |FINSI;
               |SI nClave = 12; |BUCLE CabRecV12; |FINSI;
               |SI nClave = 13; |BUCLE CabRecV13; |FINSI;
               |SI nClave = 14; |BUCLE CabRecV14; |FINSI;
               |SI nClave = 15; |BUCLE CabRecV15; |FINSI;
               |SI nClave = 16; |BUCLE CabRecV16; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscam030#2 = "PG";
            |SI #dscam030#9 = aFich;
               |SI nClave = 1;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDLibro   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDLinea1  = #dscaw013#5; nHLinea1  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
               |FINSI;

               |SI nClave = 1; |BUCLE LinRecC1; |FINSI;
               |SI nClave = 2; |BUCLE LinRecC2; |FINSI;
               |SI nClave = 3; |BUCLE LinRecC3; |FINSI;
            |FINSI;

            |SI #dscam030#9 = aFichC;
               |SI nClave = 1;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDLibro   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 5;
                  |SI nComp = 1; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 2; nDNumero    = #dscaw013#5; nHNumero    = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 6;
                  |SI nComp = 1; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDCodigoCli = #dscaw013#3; aHCodigoCli = #dscaw013#4; |FINSI;
                  |SI nComp = 3; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
               |FINSI;
               |SI nClave = 7;
                  |SI nComp = 1; nDLibro   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 8;
                  |SI nComp = 1; aDCodigoCli = #dscaw013#3; aHCodigoCli = #dscaw013#4; |FINSI;
                  |SI nComp = 2; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 3; aDSerie     = #dscaw013#3; aHSerie     = #dscaw013#4; |FINSI;
                  |SI nComp = 4; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
               |FINSI;

               |SI nClave = 1; |BUCLE CabRecC1; |FINSI;
               |SI nClave = 2; |BUCLE CabRecC2; |FINSI;
               |SI nClave = 3; |BUCLE CabRecC3; |FINSI;
               |SI nClave = 4; |BUCLE CabRecC4; |FINSI;
               |SI nClave = 5; |BUCLE CabRecC5; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscam030#2 = "RM";
            |SI #dscam030#9 = aFich;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa  = #dscaw013#3; nHRemesa  = #dscaw013#4; |FINSI;
                  |SI nComp = 2; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 5;
                  |SI nComp = 1; aDMarca   = #dscaw013#3; aHMarca   = #dscaw013#4; |FINSI;
                  |SI nComp = 2; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
               |FINSI;

               |SI nClave = 1; |BUCLE RemLin1; |FINSI;
               |SI nClave = 2; |BUCLE RemLin2; |FINSI;
               |SI nClave = 3; |BUCLE RemLin3; |FINSI;
               |SI nClave = 4; |BUCLE RemLin4; |FINSI;
               |SI nClave = 5; |BUCLE RemLin5; |FINSI;
            |FINSI;
            |SI #dscam030#9 = aFichC;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa  = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa  = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa  = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
                  |SI nComp = 3; aDMarca   = #dscaw013#3; aHMarca   = #dscaw013#4; |FINSI;
                  |SI nComp = 4; aDMarca1  = #dscaw013#3; aHMarca1  = #dscaw013#4; |FINSI;
               |FINSI;

               |SI nClave = 1; |BUCLE RemCab1; |FINSI;
               |SI nClave = 2; |BUCLE RemCab2; |FINSI;
               |SI nClave = 3; |BUCLE RemCab3; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscam030#2 = "PA";
            |SI #dscam030#9 = aFich;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 1; |BUCLE PagLin1; |FINSI;
               |SI nClave = 2; |BUCLE PagLin2; |FINSI;
               |SI nClave = 3; |BUCLE PagLin3; |FINSI;
            |FINSI;
            |SI #dscam030#9 = aFichC;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; fDFecha  = #dscaw013#7; fHFecha  = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa  = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
                  |SI nComp = 3; aDMarca   = #dscaw013#3; aHMarca   = #dscaw013#4; |FINSI;
                  |SI nComp = 4; nDImporte = #dscaw013#5; nHImporte = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDBanco   = #dscaw013#5; nHBanco   = #dscaw013#6; |FINSI;
                  |SI nComp = 3; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
               |FINSI;
               |SI nClave = 1; |BUCLE PagCab1; |FINSI;
               |SI nClave = 2; |BUCLE PagCab2; |FINSI;
               |SI nClave = 3; |BUCLE PagCab3; |FINSI;
               |SI nClave = 4; |BUCLE PagCab4; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscam030#2 = "TA";
            |SI #dscam030#9 = aFich;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 1; |BUCLE TalLin1; |FINSI;
               |SI nClave = 2; |BUCLE TalLin2; |FINSI;
               |SI nClave = 3; |BUCLE TalLin3; |FINSI;
            |FINSI;
            |SI #dscam030#9 = aFichC;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; fDFecha  = #dscaw013#7; fHFecha  = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa  = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
                  |SI nComp = 3; aDMarca   = #dscaw013#3; aHMarca   = #dscaw013#4; |FINSI;
                  |SI nComp = 4; nDImporte = #dscaw013#5; nHImporte = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; nDBanco   = #dscaw013#5; nHBanco   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
               |FINSI;
               |SI nClave = 1; |BUCLE TalCab1; |FINSI;
               |SI nClave = 2; |BUCLE TalCab2; |FINSI;
               |SI nClave = 3; |BUCLE TalCab3; |FINSI;
               |SI nClave = 4; |BUCLE TalCab4; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscam030#2 = "CF";
            |SI #dscam030#9 = aFich;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; nDNumero = #dscaw013#5; nHNumero = #dscaw013#6; |FINSI;
                  |SI nComp = 2; nDLinea  = #dscaw013#5; nHLinea  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; nDLibro   = #dscaw013#5; nHLibro   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDSerie   = #dscaw013#3; aHSerie   = #dscaw013#4; |FINSI;
                  |SI nComp = 3; nDNumero  = #dscaw013#5; nHNumero  = #dscaw013#6; |FINSI;
                  |SI nComp = 4; nDLinea   = #dscaw013#5; nHLinea   = #dscaw013#6; |FINSI;
                  |SI nComp = 5; nDNumero1 = #dscaw013#5; nHNumero1 = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; nDSecuen  = #dscaw013#5; nHSecuen  = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 5;
                  |SI nComp = 1; nDRemesa    = #dscaw013#5; nHRemesa    = #dscaw013#6; |FINSI;
                  |SI nComp = 2; aDCuentaCli = #dscaw013#3; aHCuentaCli = #dscaw013#4; |FINSI;
                  |SI nComp = 3; aDNombreCli = #dscaw013#3; aHNombreCli = #dscaw013#4; |FINSI;
                  |SI nComp = 4; fDFecha     = #dscaw013#7; fHFecha     = #dscaw013#8; |FINSI;
                  |SI nComp = 5; aDMarca     = #dscaw013#3; aHMarca     = #dscaw013#4; |FINSI;
                  |SI nComp = 6; nDLinea     = #dscaw013#5; nHLinea     = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 1; |BUCLE ConLin1; |FINSI;
               |SI nClave = 2; |BUCLE ConLin2; |FINSI;
               |SI nClave = 3; |BUCLE ConLin3; |FINSI;
               |SI nClave = 4; |BUCLE ConLin4; |FINSI;
               |SI nClave = 5; |BUCLE ConLin5; |FINSI;
            |FINSI;
            |SI #dscam030#9 = aFichC;
               |SI nClave = 1;
                  |SI nComp = 1; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 2;
                  |SI nComp = 1; fDFecha  = #dscaw013#7; fHFecha  = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa = #dscaw013#5; nHRemesa = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 3;
                  |SI nComp = 1; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
                  |SI nComp = 2; nDRemesa  = #dscaw013#5; nHRemesa  = #dscaw013#6; |FINSI;
                  |SI nComp = 3; aDMarca   = #dscaw013#3; aHMarca   = #dscaw013#4; |FINSI;
                  |SI nComp = 4; nDImporte = #dscaw013#5; nHImporte = #dscaw013#6; |FINSI;
               |FINSI;
               |SI nClave = 4;
                  |SI nComp = 1; nDBanco   = #dscaw013#5; nHBanco   = #dscaw013#6; |FINSI;
                  |SI nComp = 2; fDFecha   = #dscaw013#7; fHFecha   = #dscaw013#8; |FINSI;
               |FINSI;
               |SI nClave = 1; |BUCLE ConCab1; |FINSI;
               |SI nClave = 2; |BUCLE ConCab2; |FINSI;
               |SI nClave = 3; |BUCLE ConCab3; |FINSI;
               |SI nClave = 4; |BUCLE ConCab4; |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
      |CIERRA #dscaw013;
   |FINSI;

   |SI aFich ! aFichC;
      |CIERRA #prelavc@; |DESCARGA_DEF #prelavc@;
   |FINSI;
   |CIERRA #prelava@; |DESCARGA_DEF #prelava@;

   ||SI nClave ! 999; ABDON
   |SI nClave ! 999; |Y nSwHay = 1;
      |SI enNumRegs = 0; enNumRegs = -1; |FINSI;

      |SI #dscam030#2 = "CB";
         aAlfa = "pl" + Usuario; |NOME_DAT #dscam004#aAlfa#;
         aAlfa = "pc" + Usuario; |NOME_DAT #dscam003#aAlfa#;
      |FINSI;
      |SI #dscam030#2 = "PG";
         aAlfa = "pl" + Usuario; |NOME_DAT #dscam009#aAlfa#;
         aAlfa = "pc" + Usuario; |NOME_DAT #dscam008#aAlfa#;
      |FINSI;
      |SI #dscam030#2 = "RM";
         aAlfa = "pl" + Usuario; |NOME_DAT #dscam013#aAlfa#;
         aAlfa = "pc" + Usuario; |NOME_DAT #dscam012#aAlfa#;
      |FINSI;
      |SI #dscam030#2 = "PA";
         aAlfa = "pl" + Usuario; |NOME_DAT #dscam022#aAlfa#;
         aAlfa = "pc" + Usuario; |NOME_DAT #dscam021#aAlfa#;
      |FINSI;
      |SI #dscam030#2 = "TA";
         aAlfa = "pl" + Usuario; |NOME_DAT #dscam047#aAlfa#;
         aAlfa = "pc" + Usuario; |NOME_DAT #dscam046#aAlfa#;
      |FINSI;
      |SI #dscam030#2 = "CF";
         aAlfa = "pl" + Usuario; |NOME_DAT #dscam050#aAlfa#;
         aAlfa = "pc" + Usuario; |NOME_DAT #dscam047#aAlfa#;
      |FINSI;

   |FINSI;

   |HORA aAlfa; |QBF aAlfa;
   #dscaz900#1 = aAlfa; |PINTA #dscaz900#1;
   |PINTA 1523, " Seleccionando ...";
|FPRC;


|PROCESO PurgaCobros;
     nBorrados = 0;
     |DDEF aDef;
     aAlfa = "sq" + Usuario;
     aAlfa = aDef + aAlfa;
     |CARGA_DEF aAlfa, referen1@;
     |SI FSalida = 0;
          |ABRE #10;
          |ABRE #11;
          |ABRE #referen1@;
          |LEE 000#referen1@.p;
          |PARA; |SI FSalida = 0; |HACIENDO;
               #10#40 = #referen1@#17;
               |LEE 0000#10=;
               |SI FSalida ! 0;
                    || No exite el recibo, borro el cobro
                    #11#17 = #referen1@#17;
                    #11#3 = #referen1@#3;
                    |BORRA 020#11c;
                    |BORRA 020#referen1@.a;
                    nBorrados = nBorrados + 1;
               |FINSI;
               |LEE 000#referen1@.s;
          |SIGUE;
          |CIERRA #11;
          |CIERRA #10;
          |DESCARGA_DEF #referen1@;
     |FINSI;
     |SI nBorrados > 0;
          aAlfa = "0000Cobros borrados: " + nBorrados;
          |||MENAV aAlfa;
     |FINSI;
|FPRC;
