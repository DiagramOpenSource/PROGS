|FICHEROS;
   dscaz101 #0;

   dscam003 #10;
   dscaw074 #11;
   dscam023 #12,MANTE;
   dscam024 #13;

   dscam081 #20;
   dscam082 #21;

   dscam051 #30;
|FIN;

|VARIABLES;
   &eaTitOrden = "";
   &enSw       = 0;
   &enContLin  = 0;
   &TipoCliente = ""; &CodCliente = ""; &CtaCliente = "";
   &DCampoG = 0;      &HCampoG = 0;
   &DCampoC = 0;      &HCampoC = 0;

   nNumLins = 0;
   nLin     = 0;
   aAlfa    = "";
   fFecVto  = @;
   fFecEmi  = @;
   aCodCli  = "";
   nTipoRec = 0;
   nCalc    = 0;
   nAntSw   = 0;
   nSwMalpesa = 0;

   nPrimCli  = 1;
   nPrimTR   = 1;
   nPrimFEm  = 1;
   nPrimFVt  = 1;
|FIN;

|PROCESO MiraCuentas;
   |SI FSalida = 10;
      TipoCliente = "C"; DCampoC = 7; HCampoC = 8;
      |HAZ ExisteCliente;
      #dscaz101#Campo# = CodCliente; |PINTA #dscaz101#Campo#;
   |FINSI;
|FPRC;

|PROCESO MiraCliente;
   |SI FSalida = 10;
      TipoCliente = "G"; DCampoG = 0; HCampoG = 1;
      |HAZ ExisteCliente;
      #dscaz101#Campo# = CodCliente; |PINTA #dscaz101#Campo#;
   |FINSI;
|FPRC;

|PROCESO Comprueba;
   |SI Campo = 10;
      |SI #dscaz101#10 = "N";
         |C_M #dscaz101#11,1,"N"; #dscaz101#11 = "N"; |PINTA #dscaz101#11;
         |C_M #dscaz101#12,1,"N"; #dscaz101#12 = "N"; |PINTA #dscaz101#12;
      |SINO;
         #dscaz101#11 = "S"; |PINTA #dscaz101#11; |C_M #dscaz101#11,1,"S";
         #dscaz101#12 = "S"; |PINTA #dscaz101#12; |C_M #dscaz101#12,1,"S";
      |FINSI;
   |FINSI;
   |SI Campo = 13;
      |SI #dscaz101#13 = "N";
         |C_M #dscaz101#14,1,"N"; #dscaz101#14 = "N"; |PINTA #dscaz101#14;
         |C_M #dscaz101#15,1,"N"; #dscaz101#15 = "N"; |PINTA #dscaz101#15;
      |SINO;
         #dscaz101#14 = "S"; |PINTA #dscaz101#14; |C_M #dscaz101#14,1,"S";
         #dscaz101#15 = "S"; |PINTA #dscaz101#15; |C_M #dscaz101#15,1,"S";
      |FINSI;
   |FINSI;
   |SI Campo = 16;
      |SI #dscaz101#16 = "N";
         |C_M #dscaz101#17,1,"N"; #dscaz101#17 = "N"; |PINTA #dscaz101#17;
         |C_M #dscaz101#18,1,"N"; #dscaz101#18 = "N"; |PINTA #dscaz101#18;
         |C_M #dscaz101#19,1,"N"; #dscaz101#19 = "N"; |PINTA #dscaz101#19;
      |SINO;
         #dscaz101#17 = "S"; |PINTA #dscaz101#17; |C_M #dscaz101#17,1,"S";
         #dscaz101#18 = "S"; |PINTA #dscaz101#18; |C_M #dscaz101#18,1,"S";
         #dscaz101#19 = "S"; |PINTA #dscaz101#19; |C_M #dscaz101#19,1,"S";
      |FINSI;
   |FINSI;
   |SI Campo = 20;
      |SI #dscaz101#20 = "N";
         |C_M #dscaz101#21,1,"N"; #dscaz101#21 = "N"; |PINTA #dscaz101#21;
         |C_M #dscaz101#22,1,"N"; #dscaz101#22 = "N"; |PINTA #dscaz101#22;
      |SINO;
         #dscaz101#21 = "S"; |PINTA #dscaz101#21; |C_M #dscaz101#21,1,"S";
         #dscaz101#22 = "S"; |PINTA #dscaz101#22; |C_M #dscaz101#22,1,"S";
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO PintaAyuda; |TIPO 7;
   |PUSHV 1515 2380;
   |BLANCO 1515 2355;
   |CUADRO 1515 2354;
   |ATRI R;
   |PINTA 1716, " <1> Por cliente+tipo documento       ";
   |PINTA 1816, " <2> Por fecha emision+tipo documento ";
   |PINTA 1916, " <3> Por fecha vto+tipo documento     ";
   |PINTA 2016, " <4> Por tipo documento+cliente       ";
   |PINTA 2116, " <5> Por tipo documento+fecha emision ";
   |PINTA 2216, " <6> Por tipo documento+fecha vto     ";
   |ATRI N;
|FPRC;

|PROCESO BorraAyuda;
   |POPV;
   |SI #dscaz101#6 = 1;
      eaTitOrden = "cliente/tipo documento       ";
   |FINSI;
   |SI #dscaz101#6 = 2;
      eaTitOrden = "fecha emision/tipo documento ";
   |FINSI;
   |SI #dscaz101#6 = 3;
      eaTitOrden = "fecha vto/tipo documento     ";
   |FINSI;
   |SI #dscaz101#6 = 4;
      eaTitOrden = "tipo documento/cliente       ";
   |FINSI;
   |SI #dscaz101#6 = 5;
      eaTitOrden = "tipo documento/fecha emision ";
   |FINSI;
   |SI #dscaz101#6 = 6;
      eaTitOrden = "tipo documento/fecha vto     ";
   |FINSI;
   |ATRI I; |PINTA 1616, eaTitOrden; |ATRI N;
|FPRC;

|PROCESO AcumulaRiesgo;
   #dscaw074#23 = #dscaw074#23 + #dscam024#3;
   #dscaw074#24 = #dscaw074#24 + #dscam024#4;
   #dscaw074#25 = #dscaw074#25 + #dscam024#6;
   #dscaw074#26 = #dscaw074#26 + #dscam024#7;
   #dscaw074#28 = #dscam024#9;
|FPRC;

|DEFBUCLE AcumulaRiesgo;
#dscam024#1;
;
#dscam003#32, 01;
#dscam003#32, 99;
;
NULL, AcumulaRiesgo;
|FIN;

|PROCESO Recibos;
   #dscam023#0 = #dscam003#32;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   |SI #dscam003#14 = "L";                        |ACABA; |FINSI;
   |SI #dscam003#14 = "A"; |O #dscam003#14 = "D"; |ACABA; |FINSI;
   |SI #dscam003#69 ! " "; |O #dscam003#47 = "S"; |ACABA; |FINSI;

   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         |SI #dscam003#71 < #dscaz101#4; |O #dscam003#71 > #dscaz101#5; |ACABA; |FINSI;
      |SINO;
         |SI #dscam003#3 < #dscaz101#4; |O #dscam003#3 > #dscaz101#5; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   #dscam082#1 = #dscam003#12;
   |LEE 000#dscam082.=;
   |SI FSalida ! 0; |DDEFECTO #dscam082; |FINSI;

   #dscam081#0 = #dscam082#0;
   |LEE 000#dscam081.=;
   |SI FSalida ! 0; |DDEFECTO #dscam081; |FINSI;

   |SI #dscam081#2 = " "; |ACABA; |FINSI;

   |SI #dscam081#2 = "C";
      |SI #dscaz101#9 = "S";
         |SI #dscaz101#23 = "S";
            |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |Y #dscam003#14 ! "M"; |ACABA; |FINSI;
         |SINO;
            |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "R";
      |SI #dscaz101#10 = "S";
         |SI #dscaz101#11 = "N";
            |SI #dscam003#90 = "N"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz101#12 = "N";
            |SI #dscam003#90 = "S"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "P";
      |SI #dscaz101#13 = "S";
         |SI #dscaz101#14 = "N";
            |SI #dscam003#14 = "P"; |O #dscam003#14 = "I"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz101#15 = "N";
            |SI #dscam003#14 = "T"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "A";
      |SI #dscaz101#16 = "S";
         |SI #dscaz101#17 = "N";
            |SI #dscam003#28 = "S"; |Y #dscam003#29 = "N";
               |SI #dscam003#14 = "P"; |O #dscam003#14 = "I"; |ACABA; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscaz101#18 = "N";
            |SI #dscam003#14 = "V"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz101#19 = "N";
            |SI #dscam003#28 = "S"; |Y #dscam003#29 = "S"; |Y #dscam003#90 = "S"; |Y #dscam003#14 = "P"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "O";
      |SI #dscaz101#20 = "S";
         |SI #dscaz101#21 = "N";
            |SI #dscam003#14 = "P"; |Y #dscam003#90 = "N"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz101#16 = "N";
            |SI #dscam003#14 = "P"; |Y #dscam003#90 = "S"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;

   |DDEFECTO #dscaw074;
   #dscaw074#0  = #dscam003#40;
   #dscaw074#1  = #dscam003#0;
   #dscaw074#2  = #dscam003#1;
   #dscaw074#3  = #dscam003#4;
   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         #dscaw074#4  = #dscam003#71;
      |SINO;
         #dscaw074#4  = #dscam003#3;
      |FINSI;
   |SINO;
      #dscaw074#4  = #dscam003#3;
   |FINSI;
   #dscaw074#5  = #dscam003#31;
   #dscaw074#6  = #dscam003#12;
   #dscaw074#7  = #dscam082#2;
   #dscaw074#8  = #dscam003#14;
   #dscaw074#9  = #dscam003#72;
   #dscaw074#10 = #dscam003#70;
   #dscaw074#11 = #dscam081#2;
   #dscaw074#12 = #dscam081#0;
   #dscaw074#13 = #dscam081#1;
   #dscaw074#14 = #dscam003#32;
   #dscaw074#15 = #dscam003#6;
   #dscaw074#16 = #dscam003#15;
   #dscaw074#17 = #dscam003#90;
   #dscaw074#18 = #dscam003#91;
   #dscaw074#19 = #dscam003#92;
   #dscaw074#20 = #dscam003#75;
   #dscaw074#21 = #dscam003#76;
   #dscaw074#22 = #dscam003#77;

   |SI nSwMalpesa = 1;
      #dscam023#0 = #dscam003#32;
      |LEE 000#dscam023.=;
      |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

      |BUCLE AcumulaRiesgo;
      #dscaw074#27 = #dscam023#19;
   |FINSI;

   |GRABA 020#dscaw074.n;
|FPRC;

|DEFBUCLE Recibos;
#dscam003#15;
4,3,12;
#dscaz101#0, #dscaz101#7, " ", #dscaz101#2, #dscaz101#4, #dscaz101#24;
#dscaz101#1, #dscaz101#8, " ", #dscaz101#3, #dscaz101#5, #dscaz101#25;
;
NULL,Recibos;
|FIN;

|DEFBUCLE Recibosb;
#dscam003#15;
4,3,12;
#dscaz101#0, #dscaz101#7, " ", #dscaz101#2, "01.01.0000", #dscaz101#24;
#dscaz101#1, #dscaz101#8, " ", #dscaz101#3, "31.12.9999", #dscaz101#25;
;
NULL,Recibos;
|FIN;

|PROCESO Imprime;
   nCalc = enContLin + nLin;
   |SI nCalc ] nNumLins;
      nAntSw = enSw;
      |PARA; |SI enContLin < nNumLins; |HACIENDO enContLin = enContLin + 1;
          enSw = 11; |PRINT;
      |SIGUE;
      enContLin = 9;
      |PIEINF;
      |SI nAntSw = 0;
         |SI #dscaz101#6 = "1";
            |SI nSwMalpesa = 1;
               enSw = 1;  |PRINT; enContLin = enContLin + 4;
            |SINO;
               enSw = 1;  |PRINT; enContLin = enContLin + 2;
            |FINSI;
            enSw = 4;  |PRINT; enContLin = enContLin + 2;
            enSw = 10; |PRINT; enContLin = enContLin + 2
         |FINSI;
         |SI #dscaz101#6 = "2";
            enSw = 3;  |PRINT; enContLin = enContLin + 2;
            enSw = 4;  |PRINT; enContLin = enContLin + 2;
            enSw = 10; |PRINT; enContLin = enContLin + 2
         |FINSI;
         |SI #dscaz101#6 = "3";
            enSw = 2;  |PRINT; enContLin = enContLin + 2;
            enSw = 4;  |PRINT; enContLin = enContLin + 2;
            enSw = 10; |PRINT; enContLin = enContLin + 2
         |FINSI;
         |SI #dscaz101#6 = "4";
            enSw = 4;  |PRINT; enContLin = enContLin + 2;
            enSw = 1;  |PRINT; enContLin = enContLin + 2;
            enSw = 10; |PRINT; enContLin = enContLin + 2
         |FINSI;
         |SI #dscaz101#6 = "5";
            enSw = 4;  |PRINT; enContLin = enContLin + 2;
            enSw = 3;  |PRINT; enContLin = enContLin + 2;
            enSw = 10; |PRINT; enContLin = enContLin + 2
         |FINSI;
         |SI #dscaz101#6 = "6";
            enSw = 4;  |PRINT; enContLin = enContLin + 2;
            enSw = 2;  |PRINT; enContLin = enContLin + 2;
            enSw = 10; |PRINT; enContLin = enContLin + 2
         |FINSI;
      |FINSI;
      enSw = nAntSw;
   |FINSI;
   enContLin = enContLin + nLin; |PRINT;
|FPRC;

|PROCESO Listado;
   |SI #dscaz101#6 = 1;
      |SI nSwMalpesa = 0;
         |SI aCodCli ! #dscaw074#14;
            |SI nPrimCli = 1;
               nPrimCli = 0;
               nPrimTR  = 0;
            |SINO;
               enSw = 24; nLin = 2; |HAZ Imprime;
               enSw = 21; nLin = 2; |HAZ Imprime;
               enSw = 11; nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 1;   nLin = 2; |HAZ Imprime;
            enSw = 4;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            aCodCli = #dscaw074#14;
            nTipoRec = #dscaw074#12;
         |SINO;
            |SI nTipoRec ! #dscaw074#12;
               |SI nPrimTR = 1;
                  nPrimTR = 0;
               |SINO;
                  enSw = 24;  nLin = 2; |HAZ Imprime;
                  enSw = 11;  nLin = 1; |HAZ Imprime;
               |FINSI;
               enSw = 4;   nLin = 2; |HAZ Imprime;
               enSw = 10;  nLin = 2; |HAZ Imprime;
               nTipoRec = #dscaw074#12;
            |FINSI;
         |FINSI;
         enSw = 0;  nLin = 1; |HAZ Imprime;
      |SINO;
         |SI aCodCli ! #dscaw074#14;
            |SI nPrimCli = 1;
               nPrimCli = 0;
               nPrimTR  = 0;
            |SINO;
               enSw = 24; nLin = 2; |HAZ Imprime;
               enSw = 21; nLin = 2; |HAZ Imprime;
               enSw = 11; nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 1;   nLin = 4; |HAZ Imprime;
            enSw = 4;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            aCodCli = #dscaw074#14;
            nTipoRec = #dscaw074#12;
         |SINO;
            |SI nTipoRec ! #dscaw074#12;
               |SI nPrimTR = 1;
                  nPrimTR = 0;
               |SINO;
                  enSw = 24;  nLin = 2; |HAZ Imprime;
                  enSw = 11;  nLin = 1; |HAZ Imprime;
               |FINSI;
               enSw = 4;   nLin = 2; |HAZ Imprime;
               enSw = 10;  nLin = 2; |HAZ Imprime;
               nTipoRec = #dscaw074#12;
            |FINSI;
         |FINSI;
         enSw = 0;  nLin = 1; |HAZ Imprime;
      |FINSI;
   |FINSI;
   |SI #dscaz101#6 = 2;
      |SI fFecEmi ! #dscaw074#3;
         |SI nPrimFEm = 1;
            nPrimFEm = 0;
            nPrimTR  = 0;
         |SINO;
            enSw = 24;  nLin = 2; |HAZ Imprime;
            enSw = 23;  nLin = 2; |HAZ Imprime;
            enSw = 11;  nLin = 1; |HAZ Imprime;
         |FINSI;
         enSw = 3;   nLin = 2; |HAZ Imprime;
         enSw = 4;   nLin = 2; |HAZ Imprime;
         enSw = 10;  nLin = 2; |HAZ Imprime;
         fFecEmi = #dscaw074#3;
         nTipoRec = #dscaw074#12;
      |SINO;
         |SI nTipoRec ! #dscaw074#12;
            |SI nPrimTR = 1;
               nPrimTR = 0;
            |SINO;
               enSw = 24;  nLin = 2; |HAZ Imprime;
               enSw = 11;  nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 4;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            nTipoRec = #dscaw074#12;
         |FINSI;
      |FINSI;
      enSw = 0;  nLin = 1; |HAZ Imprime;
   |FINSI;
   |SI #dscaz101#6 = 3;
      |SI fFecVto ! #dscaw074#4;
         |SI nPrimFVt = 1;
            nPrimFVt = 0;
         |SINO;
            enSw = 24;  nLin = 2; |HAZ Imprime;
            enSw = 22;  nLin = 2; |HAZ Imprime;
            enSw = 11;  nLin = 1; |HAZ Imprime;
         |FINSI;
         enSw = 2;   nLin = 2; |HAZ Imprime;
         enSw = 4;   nLin = 2; |HAZ Imprime;
         enSw = 10;  nLin = 2; |HAZ Imprime;
         fFecVto = #dscaw074#4;
         nTipoRec = #dscaw074#12;
      |SINO;
         |SI nTipoRec ! #dscaw074#12;
            |SI nPrimTR = 1;
               nPrimTR = 0;
            |SINO;
               enSw = 24;  nLin = 2; |HAZ Imprime;
               enSw = 11;  nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 4;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            nTipoRec = #dscaw074#12;
         |FINSI;
      |FINSI;
      enSw = 0;  nLin = 1; |HAZ Imprime;
   |FINSI;
   |SI #dscaz101#6 = 4;
      |SI nTipoRec ! #dscaw074#12;
         |SI nPrimTR = 1;
            nPrimTR = 0;   nPrimCli = 0;
         |SINO;
            enSw = 21;  nLin = 2; |HAZ Imprime;
            enSw = 24;  nLin = 2; |HAZ Imprime;
            enSw = 11;  nLin = 1; |HAZ Imprime;
         |FINSI;
         enSw = 4;   nLin = 2; |HAZ Imprime;
         enSw = 1;   nLin = 2; |HAZ Imprime;
         enSw = 10;  nLin = 2; |HAZ Imprime;
         nTipoRec = #dscaw074#12;
         aCodCli = #dscaw074#14;
      |SINO;
         |SI aCodCli ! #dscaw074#14;
            |SI nPrimCli = 1;
               nPrimCli = 0;
            |SINO;
               enSw = 21;  nLin = 2; |HAZ Imprime;
               enSw = 11;  nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 1;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            aCodCli = #dscaw074#14;
         |FINSI;
      |FINSI;
      enSw = 0;  nLin = 1; |HAZ Imprime;
   |FINSI;
   |SI #dscaz101#6 = 5;
      |SI nTipoRec ! #dscaw074#12;
         |SI nPrimTR = 1;
            nPrimTR = 0; nPrimFEm = 0;
         |SINO;
            enSw = 23;  nLin = 2; |HAZ Imprime;
            enSw = 24;  nLin = 2; |HAZ Imprime;
            enSw = 11;  nLin = 1; |HAZ Imprime;
         |FINSI;
         enSw = 4;   nLin = 2; |HAZ Imprime;
         enSw = 3;   nLin = 2; |HAZ Imprime;
         enSw = 10;  nLin = 2; |HAZ Imprime;
         nTipoRec = #dscaw074#12;
         fFecEmi = #dscaw074#3;
      |SINO;
         |SI fFecEmi ! #dscaw074#3;
            |SI nPrimFEm = 1;
               nPrimFEm = 0;
            |SINO;
               enSw = 23;  nLin = 2; |HAZ Imprime;
               enSw = 11;  nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 3;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            fFecEmi = #dscaw074#3;
         |FINSI;
      |FINSI;
      enSw = 0;  nLin = 1; |HAZ Imprime;
   |FINSI;
   |SI #dscaz101#6 = 6;
      |SI nTipoRec ! #dscaw074#12;
         |SI nPrimTR = 1;
            nPrimTR = 0; nPrimFVt = 0;
         |SINO;
            enSw = 22;  nLin = 2; |HAZ Imprime;
            enSw = 24;  nLin = 2; |HAZ Imprime;
            enSw = 11;  nLin = 1; |HAZ Imprime;
         |FINSI;
         enSw = 4;   nLin = 2; |HAZ Imprime;
         enSw = 2;   nLin = 2; |HAZ Imprime;
         enSw = 10;  nLin = 2; |HAZ Imprime;
         nTipoRec = #dscaw074#12;
         fFecVto = #dscaw074#4;
      |SINO;
         |SI fFecVto ! #dscaw074#4;
            |SI nPrimFVt = 1;
               nPrimFVt = 0;
            |SINO;
               enSw = 22;  nLin = 2; |HAZ Imprime;
               enSw = 11;  nLin = 1; |HAZ Imprime;
            |FINSI;
            enSw = 2;   nLin = 2; |HAZ Imprime;
            enSw = 10;  nLin = 2; |HAZ Imprime;
            fFecVto = #dscaw074#4;
         |FINSI;
      |FINSI;
      enSw = 0;  nLin = 1; |HAZ Imprime;
   |FINSI;
|FPRC;

|DEFBUCLE Listado6;
#dscaw074#7;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|DEFBUCLE Listado5;
#dscaw074#6;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|DEFBUCLE Listado4;
#dscaw074#5;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|DEFBUCLE Listado3;
#dscaw074#4;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|DEFBUCLE Listado2;
#dscaw074#3;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|DEFBUCLE Listado1;
#dscaw074#2;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|PROGRAMA;
   |HAZ Tipo8;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |ABRE #dscam081; |ABRE #dscam082;
   |LEE 000#dscam081.p;
   |SI FSalida = 0;
      |LEE 000#dscam082.p;
      |SI FSalida ! 0;
         |MENAV "    Este listado solo se obtendra en caso de usar clasificaciones de tipos de recibo. Proceso cancelado.";
         |CIERRA #dscam081; |CIERRA #dscam082;
         |ACABA;
      |FINSI;
   |SINO;
      |MENAV "    Este listado solo se obtendra en caso de usar clasificaciones de tipos de recibo. Proceso cancelado.";
      |CIERRA #dscam081; |CIERRA #dscam082;
      |ACABA;
   |FINSI;
   |CIERRA #dscam081; |CIERRA #dscam082;

   |ABRE #0;
   |LEE 101#0=;
   |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
   #0#0 = "";
   |PDEFECTO #0, 1, 9;
   |PDEFECTO #0, 24, 26;

   |CLS;
   |CABEZA "Informe pendientes de cobro";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#0a; |LIBERA #0;

      enContLin = 9;
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |CIMPR 11; nNumLins = FSalida;
      |HAZ EsMalpesa;
      |SI FSalida = 0;
         nSwMalpesa = 1;
         |INFOR "dscay101";
      |SINO;
         nSwMalpesa = 0;
         |INFOR "dscaz101";
      |FINSI;
      |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

      aAlfa = "i1" + Usuario; |NOME_DAT #11 aAlfa;
      |DELINDEX #dscaw074; |ABRE #dscaw074;
      |ABRE #dscam081; |ABRE #dscam082; |SELECT #2#dscam082;
      |ABRE #dscam023;
      |SI #dscam051#104 = "S";
         |BUCLE Recibosb;
      |SINO;
         |BUCLE Recibos;
      |FINSI;
      |CIERRA #dscam023;

      eaTitOrden = "Ordenado por " + eaTitOrden;
      |SI #dscaz101#6 = 1;
         |BUCLE Listado1;
         enSw = 24;   nLin = 2; |HAZ Imprime;
         enSw = 21;   nLin = 2; |HAZ Imprime;
      |FINSI;
      |SI #dscaz101#6 = 2;
         |BUCLE Listado2;
         enSw = 24;   nLin = 2; |HAZ Imprime;
         enSw = 23;   nLin = 2; |HAZ Imprime;
      |FINSI;
      |SI #dscaz101#6 = 3;
         |BUCLE Listado3;
         enSw = 24;   nLin = 2; |HAZ Imprime;
         enSw = 22;   nLin = 2; |HAZ Imprime;
      |FINSI;
      |SI #dscaz101#6 = 4;
         |BUCLE Listado4;
         enSw = 21;   nLin = 2; |HAZ Imprime;
         enSw = 24;   nLin = 2; |HAZ Imprime;
      |FINSI;
      |SI #dscaz101#6 = 5;
         |BUCLE Listado5;
         enSw = 23;   nLin = 2; |HAZ Imprime;
         enSw = 24;   nLin = 2; |HAZ Imprime;
      |FINSI;
      |SI #dscaz101#6 = 6;
         |BUCLE Listado6;
         enSw = 22;   nLin = 2; |HAZ Imprime;
         enSw = 24;   nLin = 2; |HAZ Imprime;
      |FINSI;

      |CIERRA #dscam082;   |CIERRA #dscam081;
      |CIERRA #dscaw074;   |DELINDEX #dscaw074;

      |PIEINF; |FININF;
      |FINIMP;
   |FINSI;

   |CIERRA #0;

   |HAZ Tipo9;
|FPRO;
