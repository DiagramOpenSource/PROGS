|FICHEROS;
   dscaw007 #5,MANTE;
|FIN;

|VARIABLES;
   &TipoCliente = ""; &CodCliente = "";
   &enExistOblig = 0;
   &DCampoG = 0;  &HCampoG = 0;  &DCampoC = 0;  &HCampoC = 0;
   &HayGestion = 0; &HayConta   = 0;
   &MaxDigit = 0;

   Cont    = 0;
   Calc    = 0;
   nTecla  = 0;
   nParte1 = 0;
   nParte2 = 0;

   aParte1 = "";
   aParte2 = "";

   Comodin = "";
|FIN;

|PROCESO MensaAntes; |TIPO 7;
   |SI #dscaw007#31 = "G";
      |MENSA "    <F2> Consulta clientes";
   |SINO;
      |MENSA "    <F2> Consulta cuentas contables";
   |FINSI;
|FPRC;

|PROCESO MensaDespues;
   |SI #dscaw007#31 = "G";
      |SI Campo = 1; |O Campo = 2;  |BLIN 4; |FINSI;
   |SINO;
      |SI Campo = 32; |O Campo = 33; |BLIN 4; |FINSI;
   |FINSI;
|FPRC;

|PROCESO MiraCliente;
   TipoCliente = #dscaw007#31;
   enExistOblig = 1;
   CodCliente = #dscaw007#Campo#;

   DCampoG = Campo; HCampoG = Campo;
   DCampoC = Campo; HCampoC = Campo;
   |HAZ ExisteCliente;
   #dscaw007#Campo# = CodCliente; |PINTA #dscaw007#Campo#;
|FPRC;

|PROCESO Seleccion;
   |SI HayConta = 0; |Y #dscaw007#31 = "C";
      |MENAV "    La contabilidad no esta instalada";
      |ERROR; |ACABA;
   |FINSI;

   |SI HayGestion = 0; |Y #dscaw007#31 = "G";
      |MENAV "    La gestion comercial no esta instalada";
      |ERROR; |ACABA;
   |FINSI;

   |SI #dscaw007#31 = "C";
      |C_M #dscaw007#1,1,"N"; |C_V #dscaw007#1,1,"N";
      |C_M #dscaw007#2,1,"N"; |C_V #dscaw007#2,1,"N";
      |PARA Cont = 7; |SI Cont [ 30; |HACIENDO Cont = Cont + 1;
         |C_M #dscaw007#Cont#,1,"N"; |C_V #dscaw007#Cont#,1,"N";
      |SIGUE;
      |SI #dscaw007#0 = "S";
         |C_M #dscaw007#32,1,"S"; |C_V #dscaw007#32,1,"S";
         |C_M #dscaw007#33,1,"S"; |C_V #dscaw007#33,1,"S";
      |SINO;
         |C_M #dscaw007#32,1,"N"; |C_V #dscaw007#32,1,"S";
         |C_M #dscaw007#33,1,"N"; |C_V #dscaw007#33,1,"S";
      |FINSI;
      |PINTA #dscaw007#32; |PINTA #dscaw007#33;
      |PARA Cont = 34; |SI Cont [ 45; |HACIENDO Cont = Cont + 1;
         |SI #dscaw007#0 = "S";
            |C_M #dscaw007#Cont#,1,"N"; |C_V #dscaw007#Cont#,1,"S";
         |SINO;
            |C_M #dscaw007#Cont#,1,"S"; |C_V #dscaw007#Cont#,1,"S";
         |FINSI;
         |PINTA #dscaw007#Cont#;
      |SIGUE;
   |SINO;
      |C_M #dscaw007#32,1,"N"; |C_V #dscaw007#32,1,"N";
      |C_M #dscaw007#33,1,"N"; |C_V #dscaw007#33,1,"N";
      |PARA Cont = 34; |SI Cont [ 45; |HACIENDO Cont = Cont + 1;
         |C_M #dscaw007#Cont#,1,"N"; |C_V #dscaw007#Cont#,1,"N";
      |SIGUE;
      |SI #dscaw007#0 = "S";
         |C_M #dscaw007#1,1,"S"; |C_V #dscaw007#1,1,"S";
         |C_M #dscaw007#2,1,"S"; |C_V #dscaw007#2,1,"S";
      |SINO;
         |C_M #dscaw007#1,1,"N"; |C_V #dscaw007#1,1,"S";
         |C_M #dscaw007#2,1,"N"; |C_V #dscaw007#2,1,"S";
      |FINSI;
      |PINTA #dscaw007#1; |PINTA #dscaw007#2;
      |PARA Cont = 7; |SI Cont [ 30; |HACIENDO Cont = Cont + 1;
         |SI #dscaw007#0 = "S";
            |C_M #dscaw007#Cont#,1,"N"; |C_V #dscaw007#Cont#,1,"S";
         |SINO;
            |C_M #dscaw007#Cont#,1,"S"; |C_V #dscaw007#Cont#,1,"S";
         |FINSI;
         |PINTA #dscaw007#Cont#;
      |SIGUE;
   |FINSI;
   |PINPA #0#5;
   |PINDA #0#5;
|FPRC;

|PROCESO Cta; |TIPO 6;
   nTecla = FSalida;
   Comodin = #Fichero@#Campo#; |QBF Comodin;
   Comodin = Comodin - ".";

   |SI FSalida ! 0;
      nParte1 = (FSalida / 100) ! 0 + 99; aParte1 = Comodin % nParte1;
      nParte2 = FSalida + 98;            aParte2 = Comodin % nParte2;
      |PARA; |SI FSalida ! 0; |HACIENDO; aParte1 = aParte1 - "."; |SIGUE;
      FSalida = 1;
      |PARA; |SI FSalida ! 0; |HACIENDO; aParte2 = aParte2 - "."; |SIGUE;
      Comodin = aParte1 % 0; Calc = Comodin;
      Comodin = aParte2 % 0; Calc = Calc + Comodin;
      Calc = MaxDigit - Calc; Comodin = "0" * Calc;
      Comodin = aParte1 + Comodin + aParte2;
      #Fichero@#Campo# = Comodin; |PINTA #Fichero@#Campo#;
   |FINSI;
   FSalida = nTecla;
|FPRC;

|PROCESO ExistClient2;
   |SI FSalida = 2; |ACABA; |FINSI;
   |SI #dscaw007#0 = "S"; |ACABA; |FINSI;

   DCampoG = 7;  HCampoG = 30;
   DCampoC = 34; HCampoC = 45;

   TipoCliente = #dscaw007#31;
   CodCliente  = #dscaw007#Campo#;
   |HAZ ExisteCliente;
   |SI TipoCliente = "ERROR";
      |ERROR;
   |SINO;
      #dscaw007#Campo# = CodCliente;
      |PINTA #dscaw007#Campo#;
   |FINSI;
|FPRC;

|PROCESO RevisaCuentas;
   |PARA Cont = 34; |SI Cont [ 45; |HACIENDO Cont = Cont + 1;
      |SI Cont ! Campo;
         |SI #dscaw007#Cont# = #dscaw007#Campo#; |Y #dscaw007#Cont# ! "            ";
            |MENAV "    Cuenta repetida";
            |ERROR;
            |ACABA;
         |FINSI;
      |FINSI;
   |SIGUE;
|FPRC;
