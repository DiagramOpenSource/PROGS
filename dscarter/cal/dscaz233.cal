 Calculo realizado para Jamaica

|FICHEROS;
     dscaz233 #0;
     dscam003 #3;
     dscam004 #4;
     agifa010@ #10;
     agis0002@ #20;
     agifa024@ #24;
     agifa025@ #25;
     agifa324@ #324;
     dsm00003@ #30;
     agifa134@ #134;
     agifa133@ #133;
     agifa091@ #91;
     dscamrec;
     dscam081;
     dscam082;
     dscam014;
|FIN;

|VARIABLES;
     &eaTipo = "";
     nConta = 0;
     nHay = 0;
     aAlfa = "";
     aEmp = "";
     aPath = "";
|FIN;

|PROCESO Crea; |TIPO 0;
     |SI #0#2 = "S";
          #0#5 = "N"; |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO Borra; |TIPO 0;
     |SI #0#5 = "S";
          #0#2 = "N"; |PINTA #0#2;
     |FINSI;
|FPRC;

|PROCESO ReciACta;
     #agifa010@#52 = #4#0;
     #agifa010@#0 = #4#1;
     |LEE 000#agifa010@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa010@; |FINSI;

     #agifa024@#0 = #agifa010@#3;
     |LEE 000#agifa024@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa024@; |FINSI;

     #agifa025@#0 = #agifa010@#6;
     |LEE 000#agifa025@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa025@; |FINSI;

     #agifa324@#0 = #agifa010@#68;
     |LEE 000#agifa324@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa324@; |FINSI;

     #dsm00003@#0 = #agifa010@#3;
     #dsm00003@#1 = #agifa010@#84;
     |LEE 000#dsm00003@.=;
     |SI FSalida ! 0; |DDEFECTO #dsm00003@; |FINSI;

     |DDEFECTO #dscamrec;
     #dscamrec#1  = #agifa010@#52;
     #dscamrec#2  = #agifa010@#0;
     #dscamrec#3  = #agis0002@#18;
     #dscamrec#4  = #agis0002@#8;
     #dscamrec#5  = #agis0002@#7;
     #dscamrec#6  = #agis0002@#12;
     #dscamrec#7  = #agis0002@#3;
     #dscamrec#8  = #agis0002@#4;
     #dscamrec#9  = #agifa024@#32;
     #dscamrec#10 = #agifa024@#33;
     #dscamrec#11 = #agifa024@#31;
     #dscamrec#12 = #agifa024@#30;
     #dscamrec#13 = #agis0002@#22;
     #dscamrec#15 = #agis0002@#9;
     #dscamrec#16 = #agis0002@#15;
     #dscamrec#17 = #agis0002@#6;
     #dscamrec#18 = #agis0002@#2;
     #dscamrec#19 = #agifa025@#0;
     #dscamrec#20 = #agifa025@#1;
     #dscamrec#21 = #agifa024@#3;
     #dscamrec#22 = 0;
     #dscamrec#25 = #0#3;
     #dscamrec#27 = "V";
     #dscamrec#28 = "A";
     #dscamrec#29 = #agifa324@#0;
     #dscamrec#30 = #agifa324@#1;
     #dscamrec#31 = #agifa010@#74;
     #dscamrec#32 = #agifa010@#69;
     #dscamrec#33 = #agifa024@#203;
     #dscamrec#34 = 0;
     #dscamrec#35 = "A";
     #dscamrec#36 = #agis0002@#28;
     #dscamrec#37 = #agis0002@#31;
     #dscamrec#38 = #agis0002@#16;
     #dscamrec#39 = #agis0002@#10;
     #dscamrec#42 = #dsm00003@#1;
     #dscamrec#43 = #dsm00003@#10;
|FPRC;

|PROCESO Reci133;
     #agifa024@#0 = #agifa134@#2;
     |LEE 000#agifa024@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa024@; |FINSI;

     #agifa025@#0 = #agifa134@#7;
     |LEE 000#agifa025@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa025@; |FINSI;

     #agifa324@#0 = #agifa134@#58;
     |LEE 000#agifa324@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa324@; |FINSI;

     #dsm00003@#0 = #agifa134@#2;
     #dsm00003@#1 = #agifa134@#115;
     |LEE 000#dsm00003@.=;
     |SI FSalida ! 0; |DDEFECTO #dsm00003@; |FINSI;

     #agifa091@#0 = #agifa134@#11;
     |LEE 000#agifa091@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa091@; |FINSI;

     |DDEFECTO #dscamrec;
     #dscamrec#1  = #agifa133@#4; ||seri
     #dscamrec#2  = #agifa133@#0; ||Fac
     #dscamrec#3  = #agifa133@#1; ||Rec
     #dscamrec#4  = #agifa133@#3; ||F.Vto
     #dscamrec#5  = #agifa134@#1;
     #dscamrec#6  = #agifa134@#12;
     #dscamrec#7  = #agifa134@#3;
     #dscamrec#8  = #agifa134@#9;
     #dscamrec#9  = #agifa024@#32;
     #dscamrec#10 = #agifa024@#33;
     #dscamrec#11 = #agifa024@#31;
     #dscamrec#12 = #agifa024@#30;
     #dscamrec#13 = #agifa091@#69;            ||tipo recibo
     #dscamrec#15 = #agifa133@#2; || Importe
     #dscamrec#16 = #agifa024@#161;          || aAceptar
     #dscamrec#17 = "N";          || aceptado
     #dscamrec#18 = #agifa134@#2;
     #dscamrec#19 = #agifa134@#7;
     #dscamrec#20 = #agifa025@#1;
     #dscamrec#21 = #agifa024@#3;
     #dscamrec#22 = 0;
     #dscamrec#25 = #0#3;
     #dscamrec#27 = "V";
     #dscamrec#28 = "A";
     #dscamrec#29 = #agifa324@#0;
     #dscamrec#30 = #agifa324@#1;
     #dscamrec#31 = #agifa134@#59;
     #dscamrec#32 = #agifa134@#62;
     #dscamrec#33 = #agifa024@#203;
     #dscamrec#34 = 0;
     #dscamrec#35 = "";
     #dscamrec#36 = "";     || cuenta ingreso
     #dscamrec#37 = "";     || referencia
     #dscamrec#38 = "01.01.0000"; || f.cobro
     #dscamrec#39 = "S";
     #dscamrec#42 = #dsm00003@#1;
     #dscamrec#43 = #dsm00003@#10;
|FPRC;


|PROCESO Grabalo;
     #dscam082#1 = #dscamrec#13;
     |LEE 000#dscam082.=;
     |SI FSalida ! 0; |DDEFECTO #dscam082; |FINSI;

     #dscam081#0 = #dscam082#0;
     |LEE 000#dscam081.=;
     |SI FSalida ! 0; |DDEFECTO #dscam081; |FINSI;

     #dscam014#0 = #dscamrec#33;
     |LEE 000#dscam014.=;
     |SI FSalida ! 0; |DDEFECTO #dscam014; |FINSI;

     |DDEFECTO #3;
     #3#40 = #4#17;
     |GRABA 020#3.b;

     #3#69 = #dscamrec#35;                 || Tipo de A Cuenta
     #3#27 = #dscamrec#0;                  || Libro
     #3#0  = #dscamrec#1;                  || Serie
     #3#1  = #dscamrec#2;                  || Factura
     #3#2  = #dscamrec#3;                  || Recibo
     #3#99 = #dscamrec#4;
     #3#3  = #dscamrec#4;                  || Fecha de vencimiento
     #3#4  = #dscamrec#5;                  || Fecha de emision
     #3#5  = #dscamrec#6;                  || Cuenta de cliente
     #3#6  = #dscamrec#7;                  || Nombre de cliente
     #3#7  = #dscamrec#8;                  || Nombre banco
     #3#8  = #dscamrec#9;                  || Entidad
     #3#9  = #dscamrec#10;                 || Sucursal
     #3#10 = #dscamrec#11;                 || DC
     #3#11 = #dscamrec#12;                 || N§ de cuenta
     #3#12 = #dscamrec#13;                 || Tipo de recibo
     #3#35 = #dscamrec#45;                 || Situacion
     #3#36 = #dscamrec#46;                 || Descripcion situacion

     |SI #dscam081#2 = "A";
          #3#28 = "S";                       || A aceptar
     |SINO;
          #3#28 = "N";                       || A aceptar
     |FINSI;

     #3#13 = #dscamrec#14;                 || Departamento
     #3#26 = #dscamrec#38;                 || Fecha de cobro
     || #3#28 = #dscamrec#16;                 || A aceptar
     #3#29 = #dscamrec#17;                 || Aceptado
     #3#32 = #dscamrec#18;                 || Codigo cliente (GESTION)
     #3#33 = #dscamrec#19;                 || Representante
     #3#34 = #dscamrec#20;                 || Nombre representante
     #3#39 = #dscamrec#21;                 || Zona
     #3#44 = #dscamrec#23;                 || Empresa contable
     #3#45 = #dscamrec#24;                 || Periodo contable
     #3#46 = #dscamrec#25;                 || Empresa Gestion
     #3#47 = #dscamrec#26;                 || Recibo a cuenta S/N
     #3#48 = #dscamrec#39;                 || Recibo impreso S/N
     #3#51 = #dscamrec#33;                 || Banco Remesas

     #3#52 = #dscam014#1;                  || Nombre Banco Remesas
     #3#53 = "          ";                 || Fecha de remesa
     #3#57 = #dscamrec#29;                 || Divisa
     #3#58 = #dscamrec#30;                 || Nombre Divisa
     #3#59 = 1;                           || Cambio divisa en moneda base
     #3#22 = #dscamrec#15; ||Imp recibo DIV
     #3#60 = #dscamrec#15;

     #3#55 = #dscamrec#47; ||Imp Desprecio DIV
     #3#68 = #dscamrec#47;

     #3#30 = #3#22;  || Total DIV
     #3#64 = #3#60;

     #3#31 = #3#30 - #3#23 - #3#55; || Pdte DIV
     #3#65 = #3#64 - #3#61 - #3#68;

     #3#14 = "e";
     #3#15 = "Pendiente de compensar";

     #3#69 = #dscamrec#35;
     #3#85 = #dscamrec#37;
     #3#80 = #dscamrec#40;
     #3#81 = #dscamrec#41;
     #3#91 = #dscamrec#42;
     #3#92 = #dscamrec#43;
     |GRABA 020#3a;
     |LIBERA #3;
|FPRC;

|PROCESO CreaRecibo;
     |SI #4#5 = "RAC"; |O #4#5 = "REC";
          #agis0002@#30 = "A";
          #agis0002@#20 = #4#0;
          #agis0002@#17 = #4#1;
          #agis0002@#18 = #4#2;
          |LEE 000#agis0002@.=;
          |SI FSalida = 0;
               eaTipo = "E";
               |SI #0#2 = "S";
                    |SI #0#4 = "A"; |O #0#4 = "T";
                         |HAZ ReciACta;
                         |HAZ Grabalo;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          #agifa134@#49 = #4#0;
          #agifa134@#0 = #4#1;
          |LEE 000#agifa134@.=;
          |SI FSalida = 0;
               #agifa133@#4 = #4#0;
               #agifa133@#0 = #4#1;
               #agifa133@#1 = #4#2;
               |LEE 000#agifa133@.=;
               |SI FSalida = 0;
                    eaTipo = "F";
                    |SI #0#2 = "S";
                         |SI #0#4 = "F"; |O #0#4 = "T";
                              |HAZ Reci133;
                              |HAZ Grabalo;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO dscam004;
     #3#40 = #4#17;
     |LEE 000#3=;
     |SI FSalida ! 0;
          eaTipo = "N";
          |HAZ CreaRecibo;
          |SI #4#5 = "RAC"; |O #4#5 = "REC";
               |SI #0#4 = "A"; |O #0#4 = "T";
                   |PRINT;
                   |SI #0#5 = "S";
                        |BORRA 020#4a;
                   |FINSI;

                   nHay = 1;
               |FINSI;
          |SINO;
               |SI #0#4 = "F"; |O #0#4 = "T";
                   |PRINT;

                   |SI #0#5 = "S";
                        |BORRA 020#4a;
                   |FINSI;

                   nHay = 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dscam004;
     #4#7;
     ;
     #0#0, 000000001;
     #0#1, 999999999;
     be;
     NULL, dscam004;
|FIN;

|PROCESO T3; |TIPO 3;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "dscaz233";
          |SI FSalida = 0;

               |DBASS aPath;
               aAlfa = aPath + "dscomer9/def/agifa010"; |CARGA_DEF aAlfa, agifa010@;
               aAlfa = aPath + "dscomer9/def/agis0002"; |CARGA_DEF aAlfa, agis0002@;
               aAlfa = aPath + "dscomer9/def/agifa024"; |CARGA_DEF aAlfa, agifa024@;
               aAlfa = aPath + "dscomer9/def/agifa025"; |CARGA_DEF aAlfa, agifa025@;
               aAlfa = aPath + "dscomer9/def/agifa324"; |CARGA_DEF aAlfa, agifa324@;
               aAlfa = aPath + "dscomer9/def/dsm00003"; |CARGA_DEF aAlfa, dsm00003@;
               aAlfa = aPath + "dscomer9/def/agifa134"; |CARGA_DEF aAlfa, agifa134@;
               aAlfa = aPath + "dscomer9/def/agifa133"; |CARGA_DEF aAlfa, agifa133@;
               aAlfa = aPath + "dscomer9/def/agifa091"; |CARGA_DEF aAlfa, agifa091@;

               aEmp = ("00000" + #0#3) % -105;
               aAlfa = aPath + "dscomer9/fich/" + aEmp + "/";;
               |PATH_DAT #agifa010@#aAlfa#;
               |PATH_DAT #agis0002@#aAlfa#;
               |PATH_DAT #agifa024@#aAlfa#;
               |PATH_DAT #agifa025@#aAlfa#;
               |PATH_DAT #agifa324@#aAlfa#;
               |PATH_DAT #dsm00003@#aAlfa#;
               |PATH_DAT #agifa134@#aAlfa#;
               |PATH_DAT #agifa133@#aAlfa#;
               |PATH_DAT #agifa091@#aAlfa#;

               |ABRE #agifa010@;
               |ABRE #agis0002@;
               |ABRE #agifa024@;
               |ABRE #agifa025@;
               |ABRE #agifa324@;
               |ABRE #dsm00003@;
               |ABRE #agifa134@;
               |ABRE #agifa133@;
               |ABRE #agifa091@;


               |ABRE #3;
               |ABRE #dscam081;
               |ABRE #dscam082;
               |ABRE #dscam014;

               |BUCLE dscam004;

               |CIERRA #dscam014;
               |CIERRA #dscam082;
               |CIERRA #dscam081;
               |CIERRA #3;


               |CIERRA #agifa091@;
               |CIERRA #agifa133@;
               |CIERRA #agifa134@;
               |CIERRA #dsm00003@;
               |CIERRA #agifa324@;
               |CIERRA #agifa025@;
               |CIERRA #agifa024@;
               |CIERRA #agis0002@;
               |CIERRA #agifa010@;

               |DESCARGA_DEF #agifa091@;
               |DESCARGA_DEF #agifa133@;
               |DESCARGA_DEF #agifa134@;
               |DESCARGA_DEF #dsm00003@;
               |DESCARGA_DEF #agifa324@;
               |DESCARGA_DEF #agifa025@;
               |DESCARGA_DEF #agifa024@;
               |DESCARGA_DEF #agis0002@;
               |DESCARGA_DEF #agifa010@;

               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;

     |FINSI;

|FPRC;
