|FICHEROS;
     dscam067;
     dscam008;
     dscam009,MANTE;
|FIN;


|VARIABLES;
     &enHayAsto = 0;
     Clave1 = "";
     Clave2 = "";
     Clave3 = "";
     FEstado = 0;
     nDocEnt = 0;
     nDocRec = 0;
     nLinEnt = 0;
     nLinRec = 0;
     aAlfa = "";
|FIN;

|PROCESO CheqConta;
     enHayAsto = 0;
     |ABRE #dscam067;
     |SALVA_FICHA #dscam008;
     |SI #dscam009#5 = "PPA";
          #dscam067#0 = "PA";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "V";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2;
          Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "V";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "V";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;

          #dscam067#0 = "PA";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "E";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2;
          Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "E";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "E";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |SI #dscam009#5 = "CAC"; |O #dscam009#5 = "REC";
          |SALVA_FICHA #dscam009;
          |SI #dscam009#5 = "CAC";
               nDocEnt = #dscam009#35; nLinEnt = #dscam009#36;
               nDocRec = #dscam009#14; nLinRec = #dscam009#3;
          |FINSI;
          |SI #dscam009#5 = "REC";
               nDocEnt = #dscam009#14; nLinEnt = #dscam009#3;
               aAlfa = #dscam009#17; |QBF aAlfa;
               aAlfa = aAlfa - "Pago Doc. ";
               nDocRec = aAlfa; nLinRec = -1;

               #dscam009#14 = nDocRec;
               #dscam009#3  = 1;
               |LEE 000#dscam009.];
               |PARA; |SI FSalida = 0; |Y #dscam009#14 = nDocRec; |HACIENDO;
                         |SI #dscam009#35 = nDocEnt; |Y #dscam009#36 = nLinEnt;
                    nLinRec = #dscam009#3; |SAL;
               |FINSI;
               |LEE 000#dscam009.s;
          |FINSI;
          |REPON_FICHA #dscam009;
     |FINSI;

     |SALVA_FICHA #dscam009;
     #dscam008#40 = nDocEnt;
     |LEE 101#dscam008.=;
     |SI FSalida = 0;
          #dscam009#14 = nDocEnt;
          #dscam009#3  = nLinEnt;
          |LEE 101#dscam009.=;
          |SI FSalida = 0;
               #dscam067#0 = "PG";
               #dscam067#1 = nDocEnt;
               #dscam067#2 = nLinEnt;
               #dscam067#3 = "";
               #dscam067#11 = 1;
               #dscam067#8 = 0;
               #dscam067#9 = 0;
               |LEE 000#dscam067.];
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
               |PARA; |SI FEstado = 0; |Y Clave1 = nDocEnt; |HACIENDO;
                    |SI FEstado = 0; |Y Clave1 = nDocEnt; |Y Clave2 = nLinEnt; |Y Clave3  = "";
                         |SAL;
                    |FINSI;
                    |LEE 000#dscam067.s;
                    FEstado = FSalida;
                    Clave1 = #dscam067#1; Clave2 = #dscam067#2;
                    Clave3 = #dscam067#3; |QBF Clave3;
               |SIGUE;

               |SI FEstado = 0; |Y Clave1 = nDocEnt; |Y Clave2 = nLinEnt; |Y Clave3  = "";
                    enHayAsto = 1; |VETE FinCheqConta;
               |FINSI;
          |FINSI;
     |FINSI;

     #dscam008#40 = nDocRec;
     |LEE 000#dscam008.=;
     |SI FSalida = 0;
          #dscam009#14 = nDocRec;
          #dscam009#3  = nLinRec;
          |LEE 101#dscam009.=;
          |SI FSalida = 0;
               #dscam067#0 = "PG";
               #dscam067#1 = nDocRec;
               #dscam067#2 = nLinRec;
               #dscam067#3 = "";
               #dscam067#11 = 1;
               #dscam067#8 = 0;
               #dscam067#9 = 0;
               |LEE 000#dscam067.];
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
               |PARA; |SI FEstado = 0; |Y Clave1 = nDocRec; |HACIENDO;
                    |SI FEstado = 0; |Y Clave1 = nDocRec; |Y Clave2 = nLinRec; |Y Clave3  = "";
                         |SAL;
                    |FINSI;
                    |LEE 000#dscam067.s;
                    FEstado = FSalida;
                    Clave1 = #dscam067#1; Clave2 = #dscam067#2;
                    Clave3 = #dscam067#3; |QBF Clave3;
               |SIGUE;

               |SI FEstado = 0; |Y Clave1 = nDocRec; |Y Clave2 = nLinRec;  |Y Clave3  = "";
                    enHayAsto = 1; |VETE FinCheqConta;
               |FINSI;
          |FINSI;
     |FINSI;
     |REPON_FICHA #dscam009;

     |SI #dscam009#5 = "RAC";
          #dscam067#0 = "PG";
          #dscam067#1 = #dscam009#14;
          #dscam067#2 = #dscam009#3;
          #dscam067#3 = "";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2;
          Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam009#14; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam009#14; |Y Clave2 = #dscam009#3; |Y Clave3  = "";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam009#14; |Y Clave2 = #dscam009#3; |Y Clave3  = "";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |SI #dscam009#5 = "PDM";
          #dscam067#0 = "PD";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "V";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2;
          Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "V";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "V";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |SI #dscam009#5 = "PTA";
          #dscam067#0 = "TA";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2;
          Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "";
                  |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |SI #dscam009#5 = "RCC";
          #dscam067#0 = "CF";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = " ";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2; Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |SI #dscam009#5 = "PCF";
          #dscam067#0 = "CF";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "V";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2; Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "V";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "V";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;

          #dscam067#0 = "CF";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "E";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2; Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "E";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "E";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;

          #dscam067#0 = "CF";
          #dscam067#1 = #dscam008#17;
          #dscam067#2 = #dscam008#37;
          #dscam067#3 = "V";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2; Clave3 = #dscam067#3; |QBF Clave3;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam008#17; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3  = "V";
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam008#17; |Y Clave2 = #dscam008#37; |Y Clave3 = "V";
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |SI #dscam009#5 = "PAG"; |O #dscam009#5 = "PAP";
          #dscam067#0 = "PG";
          #dscam067#1 = #dscam009#14;
          #dscam067#2 = #dscam009#3;
          #dscam067#3 = "";
          #dscam067#11 = 1;
          #dscam067#8 = 0;
          #dscam067#9 = 0;
          |LEE 000#dscam067.];
          FEstado = FSalida;
          Clave1 = #dscam067#1; Clave2 = #dscam067#2;
          |PARA; |SI FEstado = 0; |Y Clave1 = #dscam009#14; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam009#14; |Y Clave2 = #dscam009#3;
                    |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
          |SIGUE;

          |SI FEstado = 0; |Y Clave1 = #dscam009#14; |Y Clave2 = #dscam009#3;
               enHayAsto = 1; |VETE FinCheqConta;
          |FINSI;
     |FINSI;

     |ET FinCheqConta;
     |CIERRA #dscam067;
     |REPON_FICHA #dscam008;
|FPRC;
