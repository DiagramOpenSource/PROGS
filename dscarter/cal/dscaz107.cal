|FICHEROS;
   dscaz107 #0;

   dscam095 #1;
   dscam096 #2;
   dscam014 #3;
   dscam008 #4;
   dscam009 #5;

   dscaw013 #9,MANTE;
   dscam030 #10;
   dscam036 #11,MANTE;
   dscam051 #12;
   dscam068 #13;
   dscam067 #14;

   dscaw051 #50,MANTE;
|FIN;

|VARIABLES;
   &eaUsuario = ""; &enImpAnt = 0;  &enImpAct = 0;  &eaDescr = "";
   &eaTipoReg = ""; &eaNumero = ""; &eaTipoOp = "";

   SwDatos = 0; SwSerie = 0; nCont = 0;
   nNume = 0; fFecha = @; aAlfa = ""; aAlfa1 = ""; aAlfa2 = "";
   SwImp = 0; fFechaVto = @; fFechaMov = @;
   nCampo = 0; nContador = 0; nCampo1 = 0;

   EmpreAnt = 0; PerioAnt = 0;
   Mensaje = 0; LinCob = 0; NumLinea = 0;

   UltOp = ""; Opcion = 0;
   TipoDato = ""; LongDato = 0; &HayConta = 0;

   Empresa = 0;
   Salir = 0; Cont = 0; nTecla = 0;

   Comodin = "";
   aCtrlSerie = "";
   &enEmpCartera = 0;  &enEmpGestion = 0; &Divisa = "";
   &eaSerie      = ""; &eaCliGest    = "";
   &nImporte     = 0;  &eaTipoOper   = ""; &enBanco = 0;
   &nDeci_Div    = 0;  &nDeci_Base   = 0;

   nTotalSel  = 0;
   nPrimero   = 0;
   nCalc      = 0;
   Calc       = 0;
   LinPag     = 0;
   NumSec     = 0;

{-1}Menu  = "";
    Menu1 = "2400";
    Menu2 = "1";
    Menu3 = "";
    Menu4 = "REC";
    Menu5 = " Revisar ";
    Menu6 = " Enlazar ";
    Menu7 = " Cancelar ";
|FIN;

|PROCESO EscogeFic;

         TipoDato = #dscaw013#11; LongDato = #dscaw013#12;
         |SI TipoDato = "A";
            |CAMPO_ANCHO #dscaw013#3,1,LongDato;
            |CAMPO_MAXIMO #dscaw013#3,1,"\ +#";
            |CAMPO_ANCHO #dscaw013#4,1,LongDato;
            |CAMPO_MAXIMO #dscaw013#4,1,"\ +#";
            |C_M #dscaw013#3,1,"S"; |C_V #dscaw013#3,1,"S"; |PINTA #dscaw013#3;
            |C_M #dscaw013#4,1,"S"; |C_V #dscaw013#4,1,"S"; |PINTA #dscaw013#4;
            |C_M #dscaw013#5,1,"N"; |C_V #dscaw013#5,1,"N";
            |C_M #dscaw013#6,1,"N"; |C_V #dscaw013#6,1,"N";
            |C_M #dscaw013#7,1,"N"; |C_V #dscaw013#7,1,"N";
            |C_M #dscaw013#8,1,"N"; |C_V #dscaw013#8,1,"N";
         |FINSI;
         |SI TipoDato = "N";
            |C_M #dscaw013#3,1,"N"; |C_V #dscaw013#3,1,"N";
            |C_M #dscaw013#4,1,"N"; |C_V #dscaw013#4,1,"N";
            |C_M #dscaw013#5,1,"S"; |C_V #dscaw013#5,1,"S"; |PINTA #dscaw013#5;
            |C_M #dscaw013#6,1,"S"; |C_V #dscaw013#6,1,"S"; |PINTA #dscaw013#6;
            |C_M #dscaw013#7,1,"N"; |C_V #dscaw013#7,1,"N";
            |C_M #dscaw013#8,1,"N"; |C_V #dscaw013#8,1,"N";
         |FINSI;
         |SI TipoDato = "F";
            |C_M #dscaw013#3,1,"N"; |C_V #dscaw013#3,1,"N";
            |C_M #dscaw013#4,1,"N"; |C_V #dscaw013#4,1,"N";
            |C_M #dscaw013#5,1,"N"; |C_V #dscaw013#5,1,"N";
            |C_M #dscaw013#6,1,"N"; |C_V #dscaw013#6,1,"N";
            |C_M #dscaw013#7,1,"S"; |C_V #dscaw013#7,1,"S"; |PINTA #dscaw013#7;
            |C_M #dscaw013#8,1,"S"; |C_V #dscaw013#8,1,"S"; |PINTA #dscaw013#8;
         |FINSI;
|FPRC;

|PROCESO TomaVal;
   |SI TipoDato = "A"; #dscaw013#9 = #dscaw013#3; #dscaw013#10 = #dscaw013#4; |FINSI;
   |SI TipoDato = "N"; #dscaw013#9 = #dscaw013#5; #dscaw013#10 = #dscaw013#6; |FINSI;
   |SI TipoDato = "F"; #dscaw013#9 = "   " + #dscaw013#7; #dscaw013#10 = "   "+ #dscaw013#8; |FINSI;

   |C_M #dscaw013#3,1,"N"; |C_V #dscaw013#3,1,"N";
   |C_M #dscaw013#4,1,"N"; |C_V #dscaw013#4,1,"N";
   |C_M #dscaw013#5,1,"N"; |C_V #dscaw013#5,1,"N";
   |C_M #dscaw013#6,1,"N"; |C_V #dscaw013#6,1,"N";
   |C_M #dscaw013#7,1,"N"; |C_V #dscaw013#7,1,"N";
   |C_M #dscaw013#8,1,"N"; |C_V #dscaw013#8,1,"N";
                           |C_V #dscaw013#9,1,"S";
                           |C_V #dscaw013#10,1,"S";
|FPRC;

|RUTINA infe1;
   #dscaw013#0 = 001;
   #dscaw013#15 = #dscaz107#5;
   #dscaw013#17 = "S";
|FRUT;

|RUTINA supe1;
   #dscaw013#0 = 999;
   #dscaw013#15 = #dscaz107#5;
   #dscaw013#17 = "S";
|FRUT;

|PROCESO RellenaAcot;
   |DDEFECTO #dscaw013;
   |PARA Cont = 0; |SI Cont [ 17; |HACIENDO Cont = Cont + 1;
      #dscaw013#Cont# = #dscam036#Cont#;
   |SIGUE;
   |GRABA 020#dscaw013.n;
|FPRC;

|DEFBUCLE RellenaAcot;
#dscam036#2;
;
#dscaz107#5,"S",001;
#dscaz107#5,"S",999;
;
NULL,RellenaAcot;
|FIN;

|PROCESO LineasRelacion;
   |SI #dscam096#6 > #dscaz107#4; |ACABA; |FINSI;
   |SI #dscam096#29 = 0;          |ACABA; |FINSI;

   |SI #dscaz107#6 = "S";
      SwSerie = 0;
      |PARA nCont = 7; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
         |SI #dscam096#4 = #dscaz107#nCont#; SwSerie = 1; |SAL; |FINSI;
      |SIGUE;
      |SI SwSerie = 0; |ACABA; |FINSI;
   |FINSI;

   |SI #dscam096#15 = "S"; |O #dscam096#15 = "R"; |ACABA; |FINSI;

   fFechaMov = #dscam096#25;
   #dscam096#15 = "S"; #dscam096#29 = 0; #dscam096#25 = "01.01.0000";
   |GRABA 020#dscam096.a;

   eaUsuario = Usuario % 0810;
   eaDescr   = "VENCIMIENTO LINEA PAGOS DOM.(" + (("00000" + #dscam095#0) % -105) + "/" + (("000" + #dscam096#1) % -103) + ") CON RECIBO ";
   eaDescr   = eaDescr + #dscam008#0 + "/" + #dscam008#1 + "/" + #dscam008#2;
   eaTipoReg = "RE";  eaNumero = ("00000" + #dscam095#0) % -105;
   eaTipoOp  = "V";   enImpAct = #dscam095#10; enImpAnt = #dscam095#10;
   |HAZ GrabaAudit;

   #dscam008#40 = #dscam096#16;
   |LEE 000#dscam008.=;
   |SI FSalida = 0;
      Divisa = #dscam008#59; |HAZ TomaDecim;
   |FINSI;

   || Actualizo  el historico de cobros
   |SI NumSec < 0;
      NumSec = 1;
      |SELECT #3#dscam009;
      |LEE 000#dscam009.u;
      |SI FSalida = 0;
         NumSec = #dscam009#33 + 1;
      |FINSI;
      |SELECT #1#dscam009;
   |FINSI;

   #dscam009#14 = #dscam096#16;
   #dscam009#3  = 99;
   |LEE 000#dscam009.];
   |SI FSalida ! 0;
      |LEE 010#dscam009.u;
      |SI FSalida = 0; |Y #dscam009#14 = #dscam096#16;
         LinPag = #dscam009#3 + 1;
      |SINO;
         LinPag = 1;
      |FINSI;
   |SINO;
      |SI #dscam009#14 = #dscam096#16;
         LinPag = #dscam009#3 + 1;
      |SINO;
         |LEE 010#dscam009.a;
         |SI FSalida = 0; |Y #dscam009#14 = #dscam096#16;
            LinPag = #dscam009#3 + 1;
         |SINO;
            LinPag = 1;
         |FINSI;
      |FINSI;
   |FINSI;

   |DDEFECTO #dscam009;
   #dscam009#14 = #dscam096#16;
   #dscam009#15 = #dscam096#2;
   #dscam009#0  = #dscam096#4;
   #dscam009#1  = #dscam096#3;
   #dscam009#2  = #dscam096#5;
   #dscam009#3  = LinPag;
   #dscam009#4  = #dscam095#14;
   #dscam009#5  = "PDM";
   #dscam009#6  = fFechaMov;
   #dscam008#40 = #dscam096#16;
   |LEE 010#dscam008.=;
   |SI FSalida = 0;
      #dscam009#7  = #dscam008#23; #dscam009#20  = #dscam008#57;
   |FINSI;
   #dscam009#8  = #dscam096#22; #dscam009#21  = #dscam096#7;
   #dscam009#9  = 0;
   #dscam009#10 = 0;
   #dscam009#33 = NumSec;
   |GRABA 020#dscam009.n;

   #dscam096#35 = NumSec;
   #dscam096#17 = LinPag; |GRABA 020#dscam096.a;

   || Actualizo el recibo
   #dscam008#40 = #dscam096#16;
   |LEE 101#dscam008.=;
   |SI FSalida = 0;
      #dscam008#26 = fFechaMov;
      #dscam008#23 = #dscam008#23 + #dscam096#22; #dscam008#57 = #dscam008#57 + #dscam096#7;
      #dscam008#25 = #dscam008#22 + #dscam008#24 + #dscam008#38;
      #dscam008#56 = #dscam008#53 + #dscam008#54 + #dscam008#55;
      Comodin = #dscam008#31; |QBF Comodin; Calc = Comodin;
      #dscam008#31 = #dscam008#25 - #dscam008#23;
      #dscam008#58 = #dscam008#56 - #dscam008#57;
      |SI #dscam008#31 = 0;
         #dscam008#14 = "L"; #dscam008#15 = "Recibo liquidado";
      |SINO;
         #dscam008#14 = "C"; #dscam008#15 = "Parcialmente cobrado";
      |FINSI;
      |GRABA 020#dscam008.a; |LIBERA #dscam008;
   |FINSI;
|FPRC;

|DEFBUCLE LineasRelacion;
#dscam096#1;
;
#dscam095#0,001;
#dscam095#0,999;
be;
NULL,LineasRelacion;
|FIN;

|PROCESO MiraSeries;
   |PARA nCampo1 = 7; |SI nCampo1 [ 18; |HACIENDO nCampo1 = nCampo1 + 1;
      nContador = 0; aAlfa1 = #dscaz107#nCampo1#;
      |PARA nCampo = 7; |SI nCampo [ 18; |HACIENDO nCampo = nCampo + 1;
         aAlfa  = #dscaz107#nCampo#;
         |SI aAlfa = aAlfa1; nContador = nContador + 1; |FINSI;
      |SIGUE;
      |SI nContador > 1; |Y aAlfa1 ! "zzzzz"; |ERROR; |SAL; |FINSI;
   |SIGUE;
|FPRC;

|PROCESO LineasPagos;
   |SI fFechaVto ! #dscam096#25;
      |SI nPrimero = 1;
         nPrimero = 0;
      |SINO;
         Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
         |NOME_DAT #9 Comodin;
         |DELINDEX #dscaw013; |ABRE #dscaw013;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 1;            #dscaw013#5  = #dscam095#0;
         #dscaw013#6  = #dscam095#0;  #dscaw013#11 = "N";
         #dscaw013#12 = 5;            #dscaw013#13 = "dscam096";
         #dscaw013#14 = 0;            #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 2;            #dscaw013#7  = fFechaVto;
         #dscaw013#8  = fFechaVto;    #dscaw013#11 = "F";
         #dscaw013#12 = 10;           #dscaw013#13 = "dscam096";
         #dscaw013#14 = 25;           #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 3;            #dscaw013#3  = "N";
         #dscaw013#4  = "N";          #dscaw013#11 = "A";
         #dscaw013#12 = 1;            #dscaw013#13 = "dscam096";
         #dscaw013#14 = 15;           #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n; NumLinea = NumLinea + 1;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 4;            #dscaw013#5  = 1;
         #dscaw013#6  = 1;            #dscaw013#11 = "N";
         #dscaw013#12 = 1;            #dscaw013#13 = "dscam096";
         #dscaw013#14 = 29;           #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n; NumLinea = NumLinea + 1;
         |SI #dscaz107#6 = "S";
            aCtrlSerie = "zzzzz";
            |PARA nCont = 7; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
               |SI #dscaz107#nCont# ! "zzzzz";
                  aCtrlSerie = "";
                  |DDEFECTO #dscaw013;
                  #dscaw013#0  = nCont - 3;    #dscaw013#3  = "";
                  #dscaw013#3 = #dscaz107#nCont#; #dscaw013#4 = #dscaz107#nCont#;
                  #dscaw013#11 = "A";
                  #dscaw013#12 = 5;            #dscaw013#13 = "dscam096";
                  #dscaw013#14 = 4;            #dscaw013#15 = #dscaz107#5;
                  #dscaw013#18 = "C";
                  |GRABA 020#dscaw013.c;
               |FINSI;
            |SIGUE;
            |SI aCtrlSerie = "zzzzz";
               |DDEFECTO #dscaw013;
               #dscaw013#0  = nCont - 3;    #dscaw013#3  = "";
               #dscaw013#3  = "zzzzz";      #dscaw013#4  = "zzzzz";
               #dscaw013#11 = "A";
               #dscaw013#12 = 5;            #dscaw013#13 = "dscam096";
               #dscaw013#14 = 4;            #dscaw013#15 = #dscaz107#5;
               #dscaw013#18 = "C";
               |GRABA 020#dscaw013.c;
            |FINSI;
         |FINSI;
         |CIERRA #dscaw013;
         Comodin = "dscam033.tab;" + #dscaz107#5 + ",V" + fFechaVto;
         |SI PARAMETRO ! "";
            Comodin = Comodin + "|" + aAlfa;
            |PUSHV 1227 1453;
            |BLANCO 1227 1453;
            |CUADRO 1227 1453;
            aAlfa1 = " Procesando relacion " + (("00000" + #dscam095#0) % -105) + " ";
            |ATRI R; |PINTA 1328, aAlfa1; |ATRI N;
         |FINSI;
         |LIBERA #dscam095; |CIERRAT #dscam095;
         |SUB_EJECUTA_NP Comodin;
         |ABRET #dscam095; |LEE 101#dscam095.=;
      |FINSI;
      fFechaVto = #dscam096#25;
   |FINSI;
|FPRC;

|DEFBUCLE LineasPagos;
#dscam096#5;
;
"01.01.0000", 00001, 001;
"31.12.9999", 99999, 999;
;
NULL, LineasPagos;
|FIN;

|PROCESO BajaRelacion;
   |SI #dscam095#8 = "N"; |ACABA; |FINSI;

   aAlfa = "SELECT * FROM dscam096 INTO Tm" + Usuario + " WHERE 0 == ";
   aAlfa = aAlfa + #dscam095#0 + " AND 15 == 'N' AND 29 == 1";
   |SQL aAlfa;
   |SI FSalida = 0;
      aAlfa = FSalida; |QBF aAlfa; aAlfa = aAlfa % -102;
      |SI aAlfa = ":0"; |ACABA; |FINSI;
   |SINO;
      |ACABA;
   |FINSI;

   Divisa = "EUR"; |HAZ TomaDecim;
   |SI HayConta = 1; |Y #dscam051#1 = "S";
      |ABRE #dscam067;
      #dscam067#0 = "PD";
      #dscam067#1 = #dscam095#0;
      #dscam067#2 = 1;
      #dscam067#3 = "E";
      |LEE 000#dscam067.];
      nNume = #dscam067#1;
      |SI FSalida = 0; |Y #dscam067#0 = "PD"; |Y nNume = #dscam095#0;
       |Y #dscam067#3 = "E";
         #dscam030#0 = #dscaz107#5;
         |LEE 000#dscam030.=;
         |SI FSalida = 0;
            EmpreAnt = #dscam030#4; PerioAnt = #dscam030#5;
            #dscam030#4 = #dscam067#8; #dscam030#5 = #dscam067#9;
            |GRABA 020#dscam030.a;
         |FINSI;
      |SINO;
         #dscam030#0 = #dscaz107#5;
         |LEE 000#dscam030.=; EmpreAnt = -1;
      |FINSI;
      |CIERRA #dscam067;

      fFechaVto = "01.01.0000"; nPrimero = 1;
      aAlfa = "Tm" + Usuario; |NOME_DAT #dscam096#aAlfa#;
      |BUCLE LineasPagos;
      |SI fFechaVto ! "01.01.0000";
         Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
         |NOME_DAT #9 Comodin;
         |DELINDEX #dscaw013; |ABRE #dscaw013;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 1;            #dscaw013#5  = #dscam095#0;
         #dscaw013#6  = #dscam095#0;  #dscaw013#11 = "N";
         #dscaw013#12 = 5;            #dscaw013#13 = "dscam096";
         #dscaw013#14 = 0;            #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 2;            #dscaw013#7  = fFechaVto;
         #dscaw013#8  = fFechaVto;    #dscaw013#11 = "F";
         #dscaw013#12 = 10;           #dscaw013#13 = "dscam096";
         #dscaw013#14 = 25;           #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 3;            #dscaw013#3  = "N";
         #dscaw013#4  = "N";          #dscaw013#11 = "A";
         #dscaw013#12 = 1;            #dscaw013#13 = "dscam096";
         #dscaw013#14 = 15;           #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n; NumLinea = NumLinea + 1;
         |DDEFECTO #dscaw013;
         #dscaw013#0  = 4;            #dscaw013#5  = 1;
         #dscaw013#6  = 1;            #dscaw013#11 = "N";
         #dscaw013#12 = 1;            #dscaw013#13 = "dscam096";
         #dscaw013#14 = 29;           #dscaw013#15 = #dscaz107#5;
         |GRABA 020#dscaw013.n; NumLinea = NumLinea + 1;
         |SI #dscaz107#6 = "S";
            |PARA nCont = 7; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
               |SI #dscaz107#nCont# ! "zzzzz";
                  |DDEFECTO #dscaw013;
                  #dscaw013#0  = nCont - 3;    #dscaw013#3  = "";
                  #dscaw013#3 = #dscaz107#nCont#; #dscaw013#4 = #dscaz107#nCont#;
                  #dscaw013#11 = "A";
                  #dscaw013#12 = 5;            #dscaw013#13 = "dscam096";
                  #dscaw013#14 = 4;            #dscaw013#15 = #dscaz107#5;
                  #dscaw013#18 = "C";
                  |GRABA 020#dscaw013.c;
               |FINSI;
            |SIGUE;
         |FINSI;
         |CIERRA #dscaw013;
         Comodin = "dscam033.tab;" + #dscaz107#5 + ",V" + fFechaVto;
         |SI PARAMETRO ! "";
            Comodin = Comodin + "|" + aAlfa;
            |PUSHV 1227 1453;
            |BLANCO 1227 1453;
            |CUADRO 1227 1453;
            aAlfa1 = " Procesando relacion " + (("00000" + #dscam095#0) % -105) + " ";
            |ATRI R; |PINTA 1328, aAlfa1; |ATRI N;
         |FINSI;
         |LIBERA #dscam095; |CIERRAT #dscam095;
         |SUB_EJECUTA_NP Comodin;
         |ABRET #dscam095; |LEE 101#dscam095.=;
      |FINSI;
      aAlfa = "dscam096";     |NOME_DAT #dscam096#aAlfa#;

      |SI PARAMETRO ! ""; |POPV; |FINSI;
      |SI EmpreAnt ! -1;
         #dscam030#4 = EmpreAnt; #dscam030#5 = PerioAnt;
         |GRABA 020#dscam030.a;
      |FINSI;
   |FINSI;

   NumSec = -1; |BUCLE LineasRelacion;
   #dscam095#9 = "S"; |GRABA 020#dscam095.a;
|FPRC;

|DEFBUCLE BajaRelacion;
#dscam095#1;
;
#dscaz107#0;
#dscaz107#1;
be;
NULL,BajaRelacion;
|FIN;

|PROCESO MarcaSelecs;
   #dscam096#0 = #dscaw051#0;
   #dscam096#1 = #dscaw051#10;
   |LEE 101#dscam096.=;
   |SI FSalida = 0;
      |SI #dscaw051#6 = "*";
         #dscam096#25 = #dscaw051#7;
         #dscam096#29 = "1";
      |SINO;
         #dscam096#25 = "01.01.0000";
         #dscam096#29 = "0";
      |FINSI;
      |GRABA 020#dscam096.a; |LIBERA #dscam096;
   |FINSI;
|FPRC;

|DEFBUCLE MarcaSelecs;
#dscaw051#1;
;
INICIO;
FINAL;
;
NULL,MarcaSelecs;
|FIN;

|PROCESO MiraParam; |TIPO 7;
   |SI #dscam051#1 = "S";
      Comodin = #dscam051#61;
      |C_M #dscaz107#5,1,Comodin;
   |SINO;
      |C_M #dscaz107#5,1,"N";
   |FINSI;
|FPRC;

|PROCESO RellenaTempo;
   |SI #dscam095#8 ! "S"; |ACABA; |FINSI;

   |ABRE #dscam008;
   #dscam008#40 = #dscam096#16;
   |LEE 000#dscam008.=;
   |SI FSalida = 0;
      |SI #dscam008#17 = 0; |CIERRA #dscam008; |ACABA; |FINSI;
   |SINO;
      |CIERRA #dscam008; |ACABA;
   |FINSI;
   |CIERRA #dscam008;

   |SI #dscam096#6 > #dscaz107#4; |ACABA; |FINSI;

   |SI #dscam096#15 = "S"; |ACABA; |FINSI;
   |GRABA 020#dscam096.a;

   Divisa = "EUR"; |HAZ TomaDecim; |PULSATECLA;

   |DDEFECTO #dscaw051;
   #dscaw051#0  = #dscam095#0;
   #dscaw051#1  = #dscam008#4;
   #dscaw051#2  = #dscam096#6;
   #dscaw051#3  = #dscam096#7;
   #dscaw051#4  = #dscam095#3;
   #dscaw051#5  = "EUR";
   |SI #dscaz107#20 = "S";
      #dscaw051#6  = "*";
      nTotalSel = nTotalSel + #dscaw051#3;
   |SINO;
      #dscaw051#6  = " ";
   |FINSI;
   #dscaw051#7  = #dscaz107#21;
   #dscaw051#8  = #dscam095#2;
   #dscaw051#9  = #dscam096#16;
   #dscaw051#10 = #dscam096#1;

   nCalc = ((#dscam095#0 / 2) ! 0) * 2;
   |SI nCalc = #dscam095#0;
      #dscaw051#11 = 0;
   |SINO;
      #dscaw051#11 = 1;
   |FINSI;

   |GRABA 020#dscaw051.n;

   #dscam096#29 = "0";
   #dscam096#25 = "01.01.0000";
   |GRABA 020#dscam096.a;
|FPRC;

|DEFBUCLE RellenaTempo;
#dscam095#1;
1;
#dscaz107#0,#dscaz107#2;
#dscaz107#1,#dscaz107#3;
be;
NULL,NULL,RellenaTempo;
|FIN;

|PROCESO GrabaFCont;
   |SI #dscaw051#6 = " "; |ACABA; |FINSI;

   #dscam096#0 = #dscaw051#0;
   #dscam096#1 = #dscaw051#10;
   |LEE 101#dscam096.=;
   |SI FSalida = 0;
      #dscam096#25 = #dscaw051#7;
      |GRABA 020#dscam096.a; |LIBERA #dscam096;
   |FINSI;
|FPRC;

|RUTINA infw051;
   #dscaw051#0  = 00001;
   #dscaw051#10 = 001;
|FRUT;

|RUTINA supw051;
   #dscaw051#0 = 99999;
   #dscaw051#10 = 999;
|FRUT;

|PROCESO Teclas; |TIPO 11;
   nTecla = FSalida;
   Divisa = #dscaw051#5; |HAZ TomaDecim; |PULSATECLA;
   |SI nTecla = 10;
      #dscam096#0 = #dscaw051#0;
      #dscam096#1 = #dscaw051#10;
      |LEE 101#dscam096.=;
      |SI FSalida = 0;
         |SI #dscaw051#6 = " ";
            #dscam096#25 = #dscaw051#7;
         |SINO;
            #dscam096#25 = "01.01.0000";
         |FINSI;
         |GRABA 020#dscam096.a; |LIBERA #dscam096;

         |SI #dscaw051#6 = "*";
            #dscaw051#6 = " ";
            nTotalSel = nTotalSel - #dscaw051#3;
         |SINO;
            #dscaw051#6 = "*";
            nTotalSel = nTotalSel + #dscaw051#3;
         |FINSI;
         |PINTA #dscaw051#6;
         |GRABA 020#dscaw051.a;
      |FINSI;
      |ERROR;
   |FINSI;
   #dscaw051#12 = nTotalSel; |PINTA 1964, #dscaw051#12;
   #dscaw051#12 = 0;
|FPRC;

|PROCESO Tipo5; |TIPO 5;
   #dscaw051#12 = nTotalSel; |PINTA 1964, #dscaw051#12;
   #dscaw051#12 = 0;
   #dscaw051#11 = 1;
   |LINEAS_BI_ATRI #dscaw051#11,S,D,-1;
|FPRC;

|PROGRAMA;
   |SI PARAMETRO = "";
      |HAZ Tipo8;
      |CLS;
      |CABEZA "Vencimiento de pagos domiciliados";

      |ABRE #dscaz107; |ABRE #dscam030;
      |ABRE #dscam051;
      |LEE 010#dscam051.p;
      |SI FSalida ! 0;
         |DDEFECTO #dscam051;
         |GRABA 020#dscam051.n;
      |FINSI;
      |CIERRA #dscam051;

      |LEE 000#dscaz107.p;
      |SI FSalida ! 0;
         |DDEFECTO #dscaz107;
         |GRABA 020#dscaz107.c;
      |FINSI;

      |SI #dscam051#1 = "S";
         #dscaz107#5 = #dscam051#79;
      |SINO;
         #dscaz107#5 = "    ";
      |FINSI;

      Comodin = #48#16; |QBF Comodin;
      |SI Comodin = "";
         HayConta = 0;
         |C_M #dscaz107#5,1,"N";
      |SINO;
         HayConta = 1;
         |SI #dscam051#1 = "S";
            |C_M #dscaz107#5,1,"S";
         |SINO;
            |C_M #dscaz107#5,1,"N";
         |FINSI;
      |FINSI;

      |PINPA #0#0; |PINDA #0#0;
      Empresa = #48#0;
      |ENDATOS #1#0;
      |SI FSalida = 0;
         ||#dscaz107#6 = "N";
         |GRABA 020#dscaz107.a;
         |ABRE #dscam096;
         |ABRE #dscam014;
         |ABRE #dscam009;
         |ABRE #dscam008;

         aAlfa = "tvp" + Usuario; |NOME_DAT #dscaw051#aAlfa#;
         |DELINDEX #dscaw051; |ABRE #dscaw051;
         |BUCLE RellenaTempo;
         |PUSHV 0501 2380;

         |ENTLINEAL #1#dscaw051,-2,2,17,1,infw051,supw051;

         |POPV;
         |CONFI "    N¨ Conforme con los datos editados ?";
         |SI FSalida = 0;
            |BUCLE MarcaSelecs;

            |BUCLE BajaRelacion;
         |FINSI;

         |CIERRA #dscam008;
         |CIERRA #dscam009;
         |CIERRA #dscam014;
         |CIERRA #dscam096;
         |CIERRA #dscaw051; |DELINDEX #dscaw051;
      |FINSI;
      |CIERRA #dscam030; |CIERRA #dscaz107;
      |HAZ Tipo9;
   |SINO;
      |DFICE aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + (("00000" + #48#0) % -105) + "/";
      aAlfa2 = aAlfa + "*";
      |_PDIR aAlfa2;
      |SI FSalida ] 0;
         |PATH_DAT #12 aAlfa; |PATH_DAT #2 aAlfa;
         |PATH_DAT #3 aAlfa;  |PATH_DAT #4 aAlfa;
         |PATH_DAT #1 aAlfa;  |PATH_DAT #5 aAlfa;
         |ABRE #dscam051;
         |LEE 010#dscam051.p;
         |SI FSalida ! 0;
            |DDEFECTO #dscam051;
            |GRABA 020#dscam051.n;
         |FINSI;

         |SI #dscam051#34 = "S";
            fFecha = ~;
            |SI #dscam051#36 ! fFecha;
               #dscam051#36 = fFecha; |GRABA 020#dscam051.a;
               nNume = fFecha;
               nNume = nNume - #dscam051#35;
               fFecha = nNume; #dscaz107#4 = fFecha;
               #dscaz107#5 = #dscam051#25;
               enEmpCartera = #48#0;
               |HAZ Tipo8;
               |ABRE #dscam095;
               |ABRE #dscam096;
               |ABRE #dscam014;
               |ABRE #dscam009;
               |ABRE #dscam008;
               NumLinea = 1;
               |BUCLE BajaRelacion;
               |CIERRA #dscam008;
               |CIERRA #dscam009;
               |CIERRA #dscam014;
               |CIERRA #dscam096;
               |CIERRA #dscam095;
               |HAZ Tipo9;
            |FINSI;
         |FINSI;
         |CIERRA #dscam030;
         |CIERRA #dscam051;
         |CIERRA #dscaz107;
      |FINSI;
   |FINSI;
|FPRO;

|RUTINA infer068;
   #dscam068#0 = #dscam036#15;
   #dscam068#1 = #dscam036#0;
   #dscam068#2 = 1;
|FRUT;

|RUTINA super068;
   #dscam068#0 = #dscam036#15;
   #dscam068#1 = #dscam036#0;
   #dscam068#2 = 999;
|FRUT;

|PROCESO Exclusion; |TIPO 3;
   |PUSHV 0959 1979;
   |SI #dscam036#11 = "A";
      LongDato = #dscam036#12;
      |CAMPO_ANCHO #dscam068#3,1,LongDato;
      |CAMPO_MAXIMO #dscam068#3,1,"#";
      |C_V #dscam068#3,1,"S"; |C_M #dscam068#3,1,"S";
   |SINO;
      |C_V #dscam068#3,1,"N"; |C_M #dscam068#3,1,"N";
   |FINSI;
   |SI #dscam036#11 = "N";
      |C_V #dscam068#4,1,"S"; |C_M #dscam068#4,1,"S";
   |SINO;
      |C_V #dscam068#4,1,"N"; |C_M #dscam068#4,1,"N";
   |FINSI;
   |SI #dscam036#11 = "F";
      |C_V #dscam068#5,1,"S"; |C_M #dscam068#5,1,"S";
   |SINO;
      |C_V #dscam068#5,1,"N"; |C_M #dscam068#5,1,"N";
   |FINSI;
   |C_V #dscam068#6,1,"N";
   |ENTLINEAL #1#dscam068,-3,1,18,1,infer068,super068;
   |C_V #dscam068#3,1,"N"; |C_M #dscam068#3,1,"N";
   |C_V #dscam068#4,1,"N"; |C_M #dscam068#4,1,"N";
   |C_V #dscam068#5,1,"N"; |C_M #dscam068#5,1,"N";
   |C_V #dscam068#6,1,"S";
   |POPV;
|FPRC;

|PROCESO Select;
   |SI #dscaz107#6 = "N";
      |PARA nCont = 7; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
         #dscaz107#nCont# = "zzzzz"; |PINTA #dscaz107#nCont#;
         |C_M #dscaz107#nCont#,1,"N";
      |SIGUE;
   |SINO;
      |PARA nCont = 7; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz107#nCont#,1,"S";
      |SIGUE;
   |FINSI;
|FPRC;
