|FICHEROS;
   dscaz065 #0;

   dscam003 #10;
   dscam004 #11;
   dscam008 #12;
   dscam009 #13;

   dscam075 #15;
   dscaw048 #16;

   dscam051 #50;
|FIN;

|VARIABLES;

   &aInforme = ""; &Divisa = "";
   &TipoCliente = ""; &CodCliente = "";
   &DCampoG = 0;      &HCampoG = 0;
   &DCampoC = 0;      &HCampoC = 0;
   &Total   = 0;
   &nDeci_Div = 0;    &nDeci_Base = 0;

   &eaVacia = "";

   aCliAnt = "";
   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aLong  = "";

   Sw = 0;
   nDocAnt = 0;
   SwTot  = 0;
   SwPasa = 0;
   nCont  = 0;
   nCalc  = 0;
   nLong  = 0;
|FIN;

|PROCESO AcotaCli;
   |SI #dscaz065#7 = "000000"; |Y #dscaz065#8 = "zzzzzz";
      |C_M #dscaz065#9,1,"S"; |C_M #dscaz065#10,1,"S";
   |SINO;
      #dscaz065#9  = "            "; |PINTA #dscaz065#9;
      #dscaz065#10 = "zzzzzzzzzzzz"; |PINTA #dscaz065#10;
      |C_M #dscaz065#9,1,"N"; |C_M #dscaz065#10,1,"N";
   |FINSI;
|FPRC;

|PROCESO MiraCliente;
   |SI FSalida = 10;
      TipoCliente = "G"; DCampoG = 7; HCampoG = 8;
      |HAZ ExisteCliente;
      #dscaz065#Campo# = CodCliente; |PINTA #dscaz065#Campo#;
   |FINSI;
|FPRC;

|PROCESO MiraCuenta;
   |SI FSalida = 10;
      TipoCliente = "C"; DCampoC = 9; HCampoC = 10;
      |HAZ ExisteCliente;
      #dscaz065#Campo# = CodCliente; |PINTA #dscaz065#Campo#;
   |FINSI;
|FPRC;

|PROCESO Imprime;
   |SI aCliAnt ! #dscaw048#0;
      Total = 0; aCliAnt = #dscaw048#0;
   |FINSI;
   |SI nDocAnt ! #dscaw048#2;
      Total = Total + #dscaw048#18;
      nDocAnt = #dscaw048#2;
   |FINSI;
   |PRINT;
|FPRC;

|DEFBUCLE Imprime;
#dscaw048#1;
;
INICIO;
FINAL;
;
NULL,Imprime;
|FIN;

|PROCESO AnotaCompras;
   |DDEFECTO #dscaw048;
   #dscaw048#0 = #dscam008#32;
   #dscaw048#1 = #dscam008#3;
   #dscaw048#2 = #dscam008#40;
   #dscaw048#3 = #dscam009#3;
   #dscaw048#4 = #dscam075#0;
   #dscaw048#5 = #dscam008#0;
   #dscaw048#6 = #dscam008#1;
   #dscaw048#7 = #dscam008#2;
   #dscaw048#8 = #dscam009#5;
   |SI #dscam004#8 ! 0;
      #dscaw048#9 = #dscam009#8;
   |SINO;
      #dscaw048#9 = #dscam009#9;
   |FINSI;
   #dscaw048#14 = #dscam008#6;
   #dscaw048#15 = #dscam075#1;
   #dscaw048#16 = #dscam075#3;
   #dscaw048#17 = #dscam075#2;
   aAlfa =         #dscam075#4; |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#5;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#6;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#7;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#8;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#9;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#10; |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#11; |QBF aAlfa;

   nCont = 10;
   |PARA; |SI aAlfa ! ""; |HACIENDO;
      aAlfa1 = aAlfa % 0160; aAlfa2 = aAlfa1 % -101;
      aLong = aAlfa1 % 0; nLong = aLong;
      |SI aAlfa2 ! " "; |Y nLong = 60;
         |PARA; |SI; |HACIENDO;
            aLong = aAlfa1 % 0; nLong = aLong; nCalc = (nLong - 1) + 100;
            |SI nCalc = 100; |SAL; |FINSI;
            aAlfa1 = aAlfa1 % nCalc; aAlfa2 = aAlfa1 % -101;
            |SI aAlfa2 = " "; |SAL; |FINSI;
         |SIGUE;
      |FINSI;
      #dscaw048#nCont# = aAlfa1; nCont = nCont + 1;
      aAlfa = aAlfa - aAlfa1;
   |SIGUE;
   |GRABA 020#dscaw048.n;
|FPRC;

|DEFBUCLE AnotCompras3;
#dscam075#1;
;
"C",#dscam009#14,#dscam009#3,01;
"C",#dscam009#14,#dscam009#3,99;
;
NULL,AnotaCompras;
|FIN;

|PROCESO AnotCompras2;
   |BUCLE AnotCompras3;
|FPRC;

|DEFBUCLE AnotCompras2;
#dscam004#1;
;
#dscam008#40,001;
#dscam008#40,999;
;
NULL,AnotCompras2;
|FIN;

|PROCESO AnotCompras1;
   |SI #dscam051#108 = "S";
      |SI #dscam008#17 ! 0;
         |SI #dscam008#73 < #dscaz065#5; |O #dscam008#73 > #dscaz065#6; |ACABA; |FINSI;
      |SINO;
         |SI #dscam008#3 < #dscaz065#5; |O #dscam008#3 > #dscaz065#6; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |BUCLE AnotCompras2;
|FPRC;

|DEFBUCLE AnotCompras;
#dscam008#1;
32,3;
000000001,#dscaz065#7,#dscaz065#5;
999999999,#dscaz065#8,#dscaz065#6;
;
NULL,AnotCompras1;
|FIN;

|DEFBUCLE AnotComprasb;
#dscam008#1;
32;
000000001,#dscaz065#7;
999999999,#dscaz065#8;
;
NULL,AnotCompras1;
|FIN;

|PROCESO AnotaVentas;
   #dscaw048#0 = #dscam003#32;
   #dscaw048#1 = #dscam003#3;
   #dscaw048#2 = #dscam003#40;
   #dscaw048#3 = #dscam004#3;
   #dscaw048#4 = #dscam075#0;
   |LEE 000#dscaw048.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw048;
      #dscaw048#0 = #dscam003#32;
      #dscaw048#1 = #dscam003#3;
      #dscaw048#2 = #dscam003#40;
      #dscaw048#3 = #dscam004#3;
      #dscaw048#4 = #dscam075#0;
      #dscaw048#5 = #dscam003#0;
      #dscaw048#6 = #dscam003#1;
      #dscaw048#7 = #dscam003#2;
      #dscaw048#8 = #dscam004#5;
      |GRABA 020#dscaw048.c;
   |FINSI;
   |SI #dscam004#8 ! 0;
      #dscaw048#9 = #dscam004#8;
   |SINO;
      #dscaw048#9 = #dscam004#9;
   |FINSI;
   #dscaw048#14 = #dscam003#6;
   #dscaw048#15 = #dscam075#1;
   #dscaw048#16 = #dscam075#3;
   #dscaw048#17 = #dscam075#2;
   #dscaw048#18 = #dscam003#31;
   aAlfa =         #dscam075#4; |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#5;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#6;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#7;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#8;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#9;  |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#10; |QBF aAlfa;
   aAlfa = aAlfa + " " + #dscam075#11; |QBF aAlfa;

   nCont = 10;
   |PARA; |SI aAlfa ! ""; |HACIENDO;
      aAlfa1 = aAlfa % 0160; aAlfa2 = aAlfa1 % -101;
      aLong = aAlfa1 % 0; nLong = aLong;
      |SI aAlfa2 ! " "; |Y nLong = 60;
         |PARA; |SI; |HACIENDO;
            aLong = aAlfa1 % 0; nLong = aLong; nCalc = (nLong - 1) + 100;
            |SI nCalc = 100; |SAL; |FINSI;
            aAlfa1 = aAlfa1 % nCalc; aAlfa2 = aAlfa1 % -101;
            |SI aAlfa2 = " "; |SAL; |FINSI;
         |SIGUE;
      |FINSI;
      #dscaw048#nCont# = aAlfa1; nCont = nCont + 1;
      aAlfa = aAlfa - aAlfa1;
   |SIGUE;
   |GRABA 020#dscaw048.a;
|FPRC;

|DEFBUCLE AnotVentas3;
#dscam075#1;
;
"V",#dscam004#17,#dscam004#3,01;
"V",#dscam004#17,#dscam004#3,99;
;
NULL,AnotaVentas;
|FIN;

|PROCESO AnotVentas2;
   Sw = 1;
   |SI #dscaz065#23 = "T";
      |DDEFECTO #dscaw048;
      #dscaw048#0 = #dscam003#32;
      #dscaw048#1 = #dscam003#3;
      #dscaw048#2 = #dscam003#40;
      #dscaw048#3 = #dscam004#3;
      #dscaw048#4 = 1
      #dscaw048#5 = #dscam003#0;
      #dscaw048#6 = #dscam003#1;
      #dscaw048#7 = #dscam003#2;
      #dscaw048#8 = #dscam004#5;
      #dscaw048#14 = #dscam003#6;
      #dscaw048#18 = #dscam003#31;
      |GRABA 020#dscaw048.c;
   |FINSI;
   |BUCLE AnotVentas3;
|FPRC;

|DEFBUCLE AnotVentas2;
#dscam004#1;
;
#dscam003#40,001;
#dscam003#40,999;
;
NULL,AnotVentas2;
|FIN;

|PROCESO AnotVentas1;

   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |Y #dscam003#72 ! "    ";
         |SI #dscam003#71 < #dscaz065#5; |O #dscam003#71 > #dscaz065#6; |ACABA; |FINSI;
      |SINO;
         |SI #dscam003#3 < #dscaz065#5; |O #dscam003#3 > #dscaz065#6; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   || Filtros de acotacion por estado
   |SI #dscaz065#13 = "S";
      SwPasa = 0;
      |SI #dscaz065#14 = "X";
         |SI #dscam003#14 = "P"; |O #dscam003#14 = "e";
            SwPasa = 1;
         |FINSI;
      |FINSI;
      |SI #dscaz065#15 = "X";
         |SI #dscam003#14 = "C"; |O #dscam003#14 = "E";
             SwPasa = 1;
         |FINSI;
      |FINSI;
      |SI #dscaz065#16 = "X"; |Y #dscam003#14 = "T"; SwPasa = 1; |FINSI;
      |SI #dscaz065#18 = "X"; |Y #dscam003#14 = "E"; SwPasa = 1; |FINSI;
      |SI #dscaz065#19 = "X"; |Y #dscam003#14 = "e"; SwPasa = 1; |FINSI;
      |SI #dscaz065#20 = "X"; |Y #dscam003#17 ! 0;
         |ABRE #dscam004;
         #dscam004#17 = #dscam003#40;
         #dscam004#3  = 1;
         |LEE 000#dscam004.];
         |PARA; |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40; |HACIENDO;
            |SI #dscam004#5 = "REM"; SwPasa = 1; |SINO; SwPasa = 0; |FINSI;
            |LEE 000#dscam004.s;
         |SIGUE;
         |CIERRA #dscam004;
         |SI SwPasa = 1; |Y #dscam003#84 = "S"; || Si no esta en riesgo ....
            SwPasa = 0;
         |FINSI;
      |FINSI;
      |SI #dscaz065#17 = "X"; |Y #dscam003#14 = "I"; SwPasa = 1; |FINSI;
      |SI #dscaz065#21 = "X"; |Y #dscam003#14 = "M"; SwPasa = 1; |FINSI;
      |SI #dscaz065#22 = "X"; |Y #dscam003#14 = "L"; SwPasa = 1; |FINSI;
   |SINO;
      SwPasa = 1;
   |FINSI;

   |SI SwPasa = 1;
      Sw = 0; Divisa = #dscam003#57; |HAZ TomaDecim; |BUCLE AnotVentas2;
      |SI Sw = 0;
         |DDEFECTO #dscaw048;
         #dscaw048#0 = #dscam003#32;
         #dscaw048#1 = #dscam003#3;
         #dscaw048#2 = #dscam003#40;
         #dscaw048#3 = #dscam004#3;
         #dscaw048#4 = 1
         #dscaw048#5 = #dscam003#0;
         #dscaw048#6 = #dscam003#1;
         #dscaw048#7 = #dscam003#2;
         #dscaw048#14 = #dscam003#6;
         #dscaw048#18 = #dscam003#31;
         |GRABA 020#dscaw048.c;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE AnotVentas;
#dscam003#11;
;
#dscaz065#7,#dscaz065#5,#dscaz065#24;
#dscaz065#8,#dscaz065#6,#dscaz065#25;
;
NULL,AnotVentas1;
|FIN;

|DEFBUCLE AnotVentasb;
#dscam003#11;
;
#dscaz065#7,"01.01.0000",#dscaz065#24;
#dscaz065#8,"31.12.9999",#dscaz065#25;
;
NULL,AnotVentas1;
|FIN;

|PROCESO PintaPant;
   aAlfa = #dscaz065#13;
   |C_M #dscaz065#14,1,aAlfa; |C_V #dscaz065#14,1,aAlfa;
   |C_M #dscaz065#15,1,aAlfa; |C_V #dscaz065#15,1,aAlfa;
   |C_M #dscaz065#16,1,aAlfa; |C_V #dscaz065#16,1,aAlfa;
   |C_M #dscaz065#17,1,aAlfa; |C_V #dscaz065#17,1,aAlfa;
   |C_M #dscaz065#18,1,aAlfa; |C_V #dscaz065#18,1,aAlfa;
   |C_M #dscaz065#19,1,aAlfa; |C_V #dscaz065#19,1,aAlfa;
   |C_M #dscaz065#20,1,aAlfa; |C_V #dscaz065#20,1,aAlfa;
   |C_M #dscaz065#21,1,aAlfa; |C_V #dscaz065#21,1,aAlfa;
   |C_M #dscaz065#22,1,aAlfa; |C_V #dscaz065#22,1,aAlfa;
   |SI #dscaz065#13 = "S";
      |CUADRO 0948 1977;
      |ATRI R; |PINTA 0949, " ACOTACION POR ESTADO       "; |ATRI N;
      |PINTA 1049, "Pendiente de cobro ......."; |PINTA #dscaz065#14;
      |PINTA 1149, "Cobrado parcialmente ....."; |PINTA #dscaz065#15;
      |PINTA 1249, "En talon/pagare de cliente"; |PINTA #dscaz065#16;
      |PINTA 1349, "Impagado ................."; |PINTA #dscaz065#17;
      |PINTA 1449, "Entrega comp.parcialmente "; |PINTA #dscaz065#18;
      |PINTA 1549, "Entrega pendiente de comp."; |PINTA #dscaz065#19;
      |PINTA 1649, "Remesado en riesgo ......."; |PINTA #dscaz065#20;
      |PINTA 1749, "En relacion de cobrador .."; |PINTA #dscaz065#21;
      |PINTA 1849, "Liquidado ................"; |PINTA #dscaz065#22;
   |SINO;
      |BLANCO 0948 1977;
      #dscaz065#14 = "";
      #dscaz065#15 = "";
      #dscaz065#16 = "";
      #dscaz065#17 = "";
      #dscaz065#18 = "";
      #dscaz065#19 = "";
      #dscaz065#20 = "";
      #dscaz065#21 = "";
      #dscaz065#22 = "";
   |FINSI;
|FPRC;

|PROGRAMA;
   |HAZ Tipo8;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |ABRE #dscaz065;
   |LEE 000#dscaz065.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscaz065;
      |GRABA 020#dscaz065.c;
   |FINSI;

   |CLS;
   |CABEZA " Listado de anotaciones de movimientos de recibos de venta";
   |PINPA #0#0; |PINDA #0#0; |HAZ PintaPant;

   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#dscaz065.a;

      |IMPRE 0;
      |SI FSalida ! 0; |MENAV "    Proceso abortado"; |ACABA; |FINSI;

      aInforme = "Informe notas movimientos"; |HAZ ObtenInforme;
      |SI aInforme = "Informe notas movimientos"; aInforme = "dscaz065"; |FINSI;
      |INFOR aInforme;
      |SI FSalida ! 0; |MENAV "    Informe inexistente. Proceso abortado"; |FINIMP; |ACABA; |FINSI;

      |DELINDEX #dscaw048; |ABRE #dscaw048;

      |SI #dscaz065#0 = "C";
         |SI #dscam051#108 = "S";
            |BUCLE AnotComprasb;
         |SINO;
            |BUCLE AnotCompras;
         |FINSI;
      |SINO;
         |SI #dscam051#104 = "S";
            |BUCLE AnotVentasb;
         |SINO;
            |BUCLE AnotVentas;
         |FINSI;
      |FINSI;

      eaVacia = " " * 60;
      |BUCLE Imprime;

      |PIEINF; |FININF;
      |FINIMP;

      |CIERRA #dscaw048;
   |FINSI;

   |CIERRA #dscaz065;

   |HAZ Tipo9;
|FPRO;
