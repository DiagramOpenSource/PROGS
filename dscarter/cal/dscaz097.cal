|FICHEROS;
   dscaz097 #0;
   dscam067 #10;
   dscam030 #11;

   camasic@ #100;
   camasil@ #101;

   camasi1@ #200;
   canemp1@ #201;
|FIN;

|VARIABLES;
   &enContLin = 0;

   &enSw     = 0;
   &enDiario = 0;
   &eaFecha  = "";
   &enDocum  = 0;
   &eaCuenta = "";
   &enConcepto = 0;
   &eaConcepto = "";
   &eaSigno    = "";
   &enImporte  = 0;

   nNumLin = 0;
   nSwAnt  = 0;
   nCalc   = 0;
   nInc   = 0;

   nCalc1 = 0;
   nCalc2 = 0;
   nCont = 0;
   nPeriodo = 0;

   aAlfa  = "";
   aAlfa1 = "";
   Comodin  = "";
   Comodin1 = "";
|FIN;

|PROCESO Imprime;
   |SI enSw = 1; nInc = 3; |FINSI;
   |SI enSw = 2; nInc = 3; |FINSI;
   |SI enSw = 3; nInc = 1; |FINSI;
   |SI enSw = 4; nInc = 1; |FINSI;
   |SI enSw = 5; nInc = 1; |FINSI;
   nCalc = enContLin + nInc;
   |SI enSw = 1; nCalc = nCalc + 5; |FINSI;
   |SI enSw = 2; nCalc = nCalc + 1; |FINSI;

   |SI nCalc ] nNumLin;
      nSwAnt = enSw;
      |PARA; |SI enContLin < nNumLin; |HACIENDO;
         enContLin = enContLin + 1;
         enSw = 5; |PRINT;
      |SIGUE;
      |PIEINF;
      enSw = nSwAnt; enContLin = 6;
   |SINO;
      enContLin = enContLin + nInc;
   |FINSI;
   |PRINT;
|FPRC;

|PROCESO Lineas;
   eaCuenta   = #camasil@#4; enConcepto = #camasil@#6;
   eaConcepto = #camasil@#7; eaSigno    = #camasil@#8;
   enImporte  = #camasil@#9;
   enSw = 3; |HAZ Imprime;
|FPRC;

|DEFBUCLE Lineas;
#camasil@#1004;
;
#camasic@#0,#camasic@#1,#camasic@#2, 0001;
#camasic@#0,#camasic@#1,#camasic@#2, 9999;
;
NULL,Lineas;
|FIN;

|PROCESO HistEnl;
||   enSw = 1; |HAZ Imprime;
   aAlfa = #dscam067#1; |QBF aAlfa;

   aAlfa = #48#16; |QBF aAlfa;
   aAlfa = aAlfa + "fich/" + (("00000" + #dscam067#8) % -105) + #dscam067#9 + "/";
   |PATH_DAT #100 aAlfa; |ABRE #camasic@;
   |PATH_DAT #101 aAlfa; |ABRE #camasil@;
   #camasic@#0 = #dscam067#4;
   #camasic@#1 = #dscam067#5;
   #camasic@#2 = #dscam067#6;
   |LEE 000#camasic@.=;
   |SI FSalida = 0;
/*
      enDiario = #camasic@#0;
      eaFecha  = #camasic@#1;
      enDocum  = #camasic@#2;

      enSw = 2; |HAZ Imprime;
      ||BUCLE Lineas;
      enSw = 5; |HAZ Imprime;
*/
   |SINO;
      enSw = 1; |HAZ Imprime;
      enSw = 4; |HAZ Imprime;
      enSw = 5; |HAZ Imprime;
   |FINSI;
   |CIERRA #camasic@; |CIERRA #camasil@;

   |SI #dscaz097#2 = "N"; |ACABA; |FINSI;

   #dscam030#0 = #dscam067#10;
   |LEE 000#dscam030.=;
   |SI FSalida = 0;
      aAlfa  = #dscam030#6; |QBF aAlfa;
      aAlfa1 = aAlfa + "def/camaasic.mas";
      |CARGA_DEF aAlfa1, camasi1@;
      |SI FSalida = 0;
         aAlfa1 = aAlfa + "def/canempre.mas";
         |CARGA_DEF aAlfa1, canemp1@;
         aAlfa1 = aAlfa + "fich/"; |PATH_DAT #canemp1@#aAlfa1#;

         nPeriodo = #dscam067#9;
         |ABRE #canemp1@;
         #canemp1@#2 = #dscam067#8;
         #canemp1@#3 = #dscam067#9;
         |LEE 000#canemp1@.=;
         |SI FSalida = 0;
            aAlfa1 = #dscam067#5; |QBF aAlfa1;
            aAlfa1 = aAlfa1 % 0704; nCalc1 = aAlfa1;
            nCalc2 = #canemp1@#26;
            |SI nCalc2 ] 80;
               nCalc2 = nCalc2 + 1900;
            |SINO;
               nCalc2 = nCalc2 + 2000;
            |FINSI;
            |SI nCalc1 ! nCalc2;
               nPeriodo = -1;
               |PARA nCont = 0; |SI nCont [ 9; |HACIENDO nCont = nCont + 1;
                  #canemp1@#2 = #dscam067#8;
                  #canemp1@#3 = nCont;
                  |LEE 000#canemp1@.=;
                  |SI FSalida = 0;
                     nCalc2 = #canemp1@#26;
                     |SI nCalc2 ] 80;
                        nCalc2 = nCalc2 + 1900;
                     |SINO;
                        nCalc2 = nCalc2 + 2000;
                     |FINSI;
                     |SI nCalc1 = nCalc2; nPeriodo = nCont; |SAL; |FINSI;
                  |FINSI;
               |SIGUE;
            |FINSI;
         |FINSI;
         |CIERRA #canemp1@; |DESCARGA_DEF #canemp1@;

         |SI nPeriodo ! -1;
            aAlfa1 = aAlfa + "fich/" + (("00000" + #dscam067#8) % -105) + nPeriodo + "/";
            |PATH_DAT #camasi1@#aAlfa1#; |ABRE #camasi1@;
            #camasi1@#0 = #dscam067#4;
            #camasi1@#1 = #dscam067#5;
            #camasi1@#2 = #dscam067#6;
            |LEE 000#camasi1@.=;
            |SI FSalida ! 0;
               |BORRA 020#dscam067.a;
            |FINSI;
         |SINO;
            |BORRA 020#dscam067.a;
         |FINSI;
         |CIERRA #camasi1@; |DESCARGA_DEF #camasi1@;
      |FINSI;
   |FINSI;

   |SI #dscam067#4 = 0; |Y #dscam067#5 = "00.00.0000"; |Y #dscam067#6 = 0;
      |BORRA 020#dscam067.a;
   |FINSI;
|FPRC;

|DEFBUCLE HistEnl;
#dscam067#3;
;
#dscaz097#0;
#dscaz097#1;
be;
NULL,HistEnl;
|FIN;

|PROGRAMA;

   |CLS;

   |CABEZA " Chequeo Cartera / Contabilidad ";
   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;

      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |CIMPR 11; nNumLin = FSalida; nNumLin = nNumLin - 1;

      |ABRE #dscam030;
      |INFOR "dscaz097";
      |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
      enContLin = 6;

      Comodin  = #48#16;  |QBF Comodin;
      Comodin  = Comodin + "def/";
      Comodin1 = Comodin + "camaasic.mas";
      |CARGA_DEF Comodin1, camasic@;
      |SI FSalida = 0;
         Comodin1 = Comodin + "camaasil.mas";
         |CARGA_DEF Comodin1, camasil@;
         |BUCLE HistEnl;
         |DESCARGA_DEF #camasil@; |DESCARGA_DEF #camasic@;
      |FINSI;

      |PIEINF; |FININF;
      |FINIMP;
      |CIERRA #dscam030;
   |FINSI;
|FPRO;
