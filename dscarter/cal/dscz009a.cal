|FICHEROS;
   dscaz009 #0;

   dscam044 #20;
   dscam045 #21;
   dscaw064 #22;
   dscam051 #23;
   dscam003 #24;
   dscam048 #25;
   dscam014 #26;
   dscam081 #27;
   dscam082 #28;

   agif024@ #500;
   agif019@ #501;
   agif007@ #502;
   agif084@ #503;
   agif069@ #504;
   agif142@ #505;
   agif027@ #506;
   agif066@ #507;
   dsm0113@ #508;
   agif025@ #509;
   agif321@ #510;
   agif324@ #511;
   agif091@ #512;
   agif133@ #513;
|FIN;

|VARIABLES;
   &eaSerieGastos = ""; &enFactGastos = 0; &efEmisionGastos = @;

   fFecha     = @;

   nEmpresa   = 0;
   nSwError   = 0;
   nNumerador = 0;
   nLinea     = 0;
   nCamp1     = 0;
   nConta     = 0;
   nContAnt   = 0;
   nLFactura  = 0;
   nIVA       = 0;
   nREC       = 0;
   nCalc      = 0;
   nCont      = 0;
   nImporte   = 0;
   nAjuste    = 0;

   aClave     = "";
   aSerie     = "";
   aAlfa      = "";
   aDire      = "";
|FIN;

|PROCESO TomaConta;
   |ABRE #agif027@;
   #agif027@#2 = aSerie;
   #agif027@#0 = aClave;
   |LEE 101#agif027@.=;
   |SI FSalida ! 0;
      |DDEFECTO #agif027@;
      #agif027@#2 = aSerie;
      #agif027@#0 = aClave;
      #agif027@#1 = 1;
      |GRABA 020#agif027@.b;
   |FINSI;
   nConta = #agif027@#1;
   #agif027@#1 = #agif027@#1 + 1;
   |GRABA 020#agif027@.a;
   |LIBERA #agif027@; |CIERRA #agif027@;
|FPRC;

|PROCESO CreaFacturas;

   #agif019@#0 = #dscaw064#4;
   |LEE 000#agif019@.=;
   |SI FSalida ! 0;
      |DDEFECTO #agif019@;
      #agif019@#0 = #dscaw064#4;
      #agif019@#1 = #dscaw064#9;
      |GRABA 020#agif019@.c;
   |FINSI;

   aAlfa = #dscaw064#3; |QBF aAlfa;
   aAlfa = ("000000" + aAlfa) % -106;
   #agif024@#0 = aAlfa;
   |LEE 000#agif024@.=;
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   #agif025@#0 = #agif024@#25;
   |LEE 000#agif025@.=;
   |SI FSalida ! 0; |DDEFECTO #agif025@; |FINSI;

   #agif324@#0 = #agif321@#9;
   |LEE 000#agif324@.=;
   |SI FSalida ! 0; |DDEFECTO #agif324@; |FINSI;

   #agif007@#26 = #dscaw064#0;
   |LEE 000#agif007@.=;
   |SI FSalida ! 0;
      |DDEFECTO #agif007@;
      #agif007@#26 = #dscaw064#0;
      #agif007@#27 = #dscaw064#8;
      |GRABA 020#agif007@.c;
   |FINSI;

   |SI nContAnt ! #dscaw064#1;
      nLFactura = 1;
      |SI nContAnt ! 0;
         |HAZ RecalcCab; |LIBERA #agif084@;
      |FINSI;
      nConta = 0;

      #agif084@#48 = #dscaw064#0;
      #agif084@#0 = 999999;
      |LEE 000#agif084@.];
      |SI FSalida = 0;
         |LEE 000#agif084@.a;
      |SINO;
         |LEE 000#agif084@.u;
      |FINSI;
      |SI FSalida = 0; |Y #agif084@#48 = #dscaw064#0;
         nConta = #agif084@#0 + 1;
      |FINSI;

      |SI #agif142@#137 = "F";
         |SI #agif142@#26 = "S";
            aClave = "vfactura"; |HAZ TomaConta;
         |SINO;
            aClave = "vfactuco"; |HAZ TomaConta;
         |FINSI;
      |FINSI;

      eaSerieGastos = #dscaw064#0; enFactGastos  = nConta;
      efEmisionGastos = #dscaz009#14;

      |DDEFECTO #agif084@;
      #agif084@#48 = #dscaw064#0;
      #agif084@#0  = nConta;
      |GRABA 020#agif084@.b;

      #agif084@#1 = #dscaz009#14;
      #agif084@#3 = #agif024@#0;
      #agif084@#4 = #agif024@#1;
      #agif084@#5 = #agif024@#37;
      #agif084@#6 = #agif024@#25;
      #agif084@#7 = #agif024@#38;
      #agif084@#8 = #agif024@#20;
      #agif084@#10 = "S";
      #agif084@#29 = #agif024@#1;
      #agif084@#30 = #agif024@#8;
      #agif084@#31 = #agif024@#9;
      #agif084@#32 = #agif024@#156;
      #agif084@#33 = #agif024@#10;
      #agif084@#34 = #agif025@#7;  || Tipo de comision
      #agif084@#35 = #agif024@#4;  || Tipo de cliente
      #agif084@#36 = #agif024@#47; || Recargo de equivalencia
      #agif084@#40 = #agif024@#16; || Cuenta contable
      #agif084@#60 = #agif024@#15; || CIF / DNI
      #agif084@#64 = #agif024@#183;|| Codigo postal
      #agif084@#65 = #agif321@#9;  || Divisa
      #agif084@#66 = #agif324@#2;  || Cambio divisa
      #agif084@#67 = #agif024@#193;|| Moneda de trabajo
      #agif084@#68 = #agif084@#65; || Moneda base
      #agif084@#69 = #agif084@#66; || Cambio moneda base
      #agif084@#78 = #agif024@#202;|| Agencia de transportes
      #agif084@#88 = #agif024@#22; || Dia de pago 1
      #agif084@#89 = #agif024@#23; || Dia de pago 2
      #agif084@#90 = #agif024@#24; || Dia de pago 3

      |GRABA 020#agif084@.a;

      nContAnt = #dscaw064#1;
   |FINSI;

   |DDEFECTO #agif069@;
   #agif069@#20 = #agif084@#48;
   #agif069@#0  = #agif084@#0;
   #agif069@#1  = nLFactura; nLFactura = nLFactura + 1;
   |GRABA 020#agif069@.b;
   #agif069@#2  = #dscaw064#4;
   #agif069@#3  = #agif007@#29; || Almacen
   #agif069@#4  = #agif019@#1;  || Descripcion articulo
   #agif069@#5  = #dscaw064#5;  || Unidades
   #agif069@#6  = #dscaw064#6;  || Precio
   #agif069@#11 = #agif019@#30; || Tipo iva
   #agif069@#13 = #agif019@#2;  || Familia
   #agif069@#15 = #dscaw064#3;  || Cliente
   #agif069@#16 = #agif084@#34; || Tipo comision
   #agif069@#17 = #agif024@#4;  || Tipo cliente

   |HAZ RecalcLin; |LIBERA #agif069@;
|FPRC;

|DEFBUCLE CreaFacturas;
#dscaw064#1;
;
INICIO;
FINAL;
;
NULL,CreaFacturas;
|FIN;

|PROCESO BuscaGestion;
   aAlfa = #dscam051#49;
   |SI aAlfa < #dscam045#4; |O aAlfa > #dscam045#5; |ACABA; |FINSI;
   nSwError = 0; |ERROR10;
|FPRC;

|DEFBUCLE BuscaGestion;
#dscam045#2;
2;
nEmpresa,"V";
nEmpresa,"V";
;
NULL,BuscaGestion;
|FIN;

|PROCESO VuelcaRecibos;
   #dscam082#1 = #agif091@#69;
   |LEE 000#dscam082.=;
   |SI FSalida ! 0; |DDEFECTO #dscam082; |FINSI;

   #dscam081#0 = #dscam082#0;
   |LEE 000#dscam081.=;
   |SI FSalida ! 0; |DDEFECTO #dscam081; |FINSI;

   #dscam014#0 = #agif024@#203;
   |LEE 000#dscam014.=;
   |SI FSalida ! 0; |DDEFECTO #dscam014; |FINSI;

   |LEE 000#dscam003.u;
   |SI FSalida = 0;
      nCalc = #dscam003#40 + 1;
   |SINO;
      nCalc = 1;
   |FINSI;
   |DDEFECTO #dscam003;
   #dscam003#40 = nCalc;
   |GRABA 020#dscam003.b;

   nCalc = #agif084@#66 / #agif084@#69;

   #dscam003#0  = #agif084@#48;
   #dscam003#1  = #agif084@#0;
   #dscam003#2  = #agif133@#1;
   #dscam003#3  = #agif133@#3;
   #dscam003#4  = #agif084@#1;
   #dscam003#5  = #agif084@#40;
   #dscam003#6  = #agif084@#4;
   #dscam003#7  = #agif024@#29;
   #dscam003#8  = #agif024@#32;
   #dscam003#9  = #agif024@#33;
   #dscam003#10 = #agif024@#31;
   #dscam003#11 = #agif091@#30;
   #dscam003#12 = #agif091@#69;
   #dscam003#14 = "P";
   #dscam003#15 = "Pendiente de cobro";
   #dscam003#22 = #agif133@#2;
   |SI #dscam081#2 = "A";
      #dscam003#28 = "S";
   |SINO;
      #dscam003#28 = "N";
   |FINSI;
   #dscam003#30 = #agif133@#2;
   #dscam003#31 = #agif133@#2;
   #dscam003#32 = #agif084@#3;
   #dscam003#33 = #agif084@#6;
   #dscam003#34 = #agif025@#1;
   #dscam003#39 = #agif024@#3;
   #dscam003#39 = #agif024@#3;
   #dscam003#46 = nEmpresa;
   #dscam003#51 = #agif024@#203;
   #dscam003#52 = #dscam014#1;
   #dscam003#57 = #agif321@#9;
   #dscam003#58 = #agif324@#1;
   #dscam003#59 = 1 / nCalc;
   #dscam003#60 = (#dscam003#22 * nCalc) ! #agif324@#7;
   #dscam003#64 = (#dscam003#30 * nCalc) ! #agif324@#7;
   #dscam003#65 = (#dscam003#31 * nCalc) ! #agif324@#7;
   #dscam003#80 = #agif091@#0;
   #dscam003#81 = #agif091@#1;
   #dscam003#91 = #agif084@#91;
   |GRABA 020#dscam003.a; |LIBERA #dscam003;
|FPRC;

|DEFBUCLE VuelcaRecibos;
#agif133@#1003;
;
#agif084@#48, #agif084@#0, 001;
#agif084@#48, #agif084@#0, 999;
;
NULL,VuelcaRecibos;
|FIN;

|PROCESO CreaRecibos;
   #agif324@#0 = #agif321@#9;
   |LEE 000#agif324@.=;
   |SI FSalida ! 0; |DDEFECTO #agif324@; |FINSI;

   #agif024@#0 = #agif084@#3;
   |LEE 000#agif024@.=;
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   #agif091@#0 = #dscam051#54;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   nImporte = #agif084@#73; nAjuste = 0; aAlfa = "1" + ("0" * #agif324@#7);
   nCalc = aAlfa; nCalc = 1 / nCalc;
   nImporte = (nImporte / #agif091@#3) ! #agif324@#7;
   nAjuste = (#agif084@#73 - (nImporte * #agif091@#3)) ! #agif324@#7;
   |SI nAjuste < 0;
      nImporte = nImporte - nCalc;
      nAjuste = (#agif084@#73 - (nImporte * #agif091@#3)) ! #agif324@#7;
   |FINSI;

   |PARA nCont = 1; |SI nCont [ #agif091@#3; |HACIENDO nCont = nCont + 1;
      nCamp1 = nCont + 5;
      fFecha = #agif084@#1; nCalc = fFecha;
      nCalc = nCalc + #agif091@#nCamp1#;
      fFecha = nCalc;
      |DDEFECTO #agif133@;
      #agif133@#0 = #agif084@#0;
      #agif133@#1 = nCont;
      #agif133@#2 = nImporte;
      #agif133@#3 = fFecha;
      #agif133@#4 = #agif084@#48;
      #agif133@#8 = nCont;
      |GRABA 020#agif133@.c;
   |SIGUE;

   |SI nCont = 1;
      |DDEFECTO #agif133@;
      #agif133@#0 = #agif084@#0;
      #agif133@#1 = nCont - 5;
      #agif133@#2 = nImporte;
      #agif133@#3 = fFecha;
      #agif133@#4 = #agif084@#48;
      #agif133@#8 = nCont - 5;
      |GRABA 020#agif133@.c;
   |SINO;
      |SI nAjuste ! 0;
         #agif133@#2 = #agif133@#2 + nAjuste;
         |GRABA 020#agif133@.a;
      |FINSI;
   |FINSI;

   |BUCLE VuelcaRecibos;
|FPRC;

|PROCESO GrabaAcumCli;
   #agif024@#0 = #agif084@#3;
   |LEE 000#agif024@.=;
   |SI FSalida = 0;
      aAlfa = #agif084@#1; |QBF aAlfa;
      aAlfa = aAlfa % 0402;
      nCalc = aAlfa; nCalc = 50 + (nCalc * 4);
      #agif024@#nCalc# = #agif024@#nCalc# + #agif084@#73;
      |GRABA 020#agif024@.a;
   |FINSI;
|FPRC;

|PROCESO RecalcLin;
   #agif069@#7  = #agif069@#5 * #agif069@#6;
   #agif069@#8  = 0;
   #agif069@#9  = #agif069@#7;
   #agif069@#30 = #agif069@#5;
   #agif069@#14 = #agif019@#9 * #agif069@#5;     || Margen
   #agif069@#26 = #agif069@#6;  || Precio DIV
   #agif069@#27 = #agif069@#7;  || Importe DIV
   #agif069@#28 = #agif069@#6;  || Precio VIS
   #agif069@#29 = #agif069@#7;  || Importe VIS
   |GRABA 020#agif069@.a;

   aAlfa = #agif024@#0; |QBF aAlfa;
   #dsm0113@#0 = #agif024@#0;
   #dsm0113@#1 = #agif069@#11;
   |LEE 000#dsm0113@.=;
   |SI FSalida ! 0; |O aAlfa = "";
      nIVA = -1; nREC = -1;
      #agif066@#0 = #agif069@#11;
      #agif066@#4 = "01.01.0000";
      |LEE 000#agif066@.];
      |PARA; |SI FSalida = 0; |Y #agif066@#0 = #agif069@#11; |HACIENDO;
         |SI #agif084@#1 ] #agif066@#4;
            nIVA = #agif066@#2; nREC = #agif066@#3;
         |FINSI;
         |LEE 000#agif066@.s;
      |SIGUE;

      |SI nIVA < 0; |O nREC < 0;
         aAlfa = "    !! ATENCION !! El tipo de IVA " + #agif069@#11 + " no tiene una fecha de vigor actualizada";
         |MENAV aAlfa;
         nIVA = 0; nREC = 0;
      |FINSI;
   |SINO;
      nIVA = #dsm0113@#3; nREC = #dsm0113@#4;
   |FINSI;

   |SI #agif069@#11 = 0;
      #agif084@#28 = #agif084@#28 + #agif069@#9;
   |FINSI;

   |SI #agif069@#11 = 1;
      #agif084@#16 = #agif084@#16 + #agif069@#9;
      #agif084@#17 = #agif084@#16 % nIVA;
      #agif084@#50 = nIVA;
      |SI #agif084@#36 = "S";
         #agif084@#18 = #agif084@#16 % nREC;
         #agif084@#51 = nREC;
      |FINSI;
   |FINSI;

   |SI #agif069@#11 = 2;
      #agif084@#19 = #agif084@#19 + #agif069@#9;
      #agif084@#20 = #agif084@#19 % nIVA;
      #agif084@#52 = nIVA;
      |SI #agif084@#36 = "S";
         #agif084@#21 = #agif084@#19 % nREC;
         #agif084@#53 = nREC;
      |FINSI;
   |FINSI;

   |SI #agif069@#11 = 3;
      #agif084@#22 = #agif084@#22 + #agif069@#9;
      #agif084@#23 = #agif084@#22 % nIVA;
      #agif084@#54 = nIVA;
      |SI #agif084@#36 = "S";
         #agif084@#49 = #agif084@#22 % nREC;
         #agif084@#55 = nREC;
      |FINSI;
   |FINSI;

   |SI #agif069@#11 = 4;
      #agif084@#42 = #agif084@#42 + #agif069@#9;
      #agif084@#43 = #agif084@#42 % nIVA;
      #agif084@#56 = nIVA;
      |SI #agif084@#36 = "S";
         #agif084@#44 = #agif084@#42 % nREC;
         #agif084@#57 = nREC;
      |FINSI;
   |FINSI;

   |SI #agif069@#11 = 5;
      #agif084@#45 = #agif084@#45 + #agif069@#9;
      #agif084@#46 = #agif084@#45 % nIVA;
      #agif084@#58 = nIVA;
      |SI #agif084@#36 = "S";
         #agif084@#47 = #agif084@#45 % nREC;
         #agif084@#59 = nREC;
      |FINSI;
   |FINSI;

   #agif084@#15 = #agif084@#15 + #agif069@#9;   || Bruto factura
   #agif084@#25 = (((#agif084@#15 < #agif084@#5) < #agif084@#32) < #agif084@#7);
   #agif084@#25 = #agif084@#15 - #agif084@#25;
   #agif084@#70 = #agif084@#70 + #agif069@#27;  || Bruto factura
   #agif084@#37 = #agif084@#37 + #agif069@#14;  || Margen factura
   #agif084@#24 = #agif084@#17 + #agif084@#18 + #agif084@#20 + #agif084@#21;
   #agif084@#24 = #agif084@#24 + #agif084@#23 + #agif084@#43 + #agif084@#44;
   #agif084@#24 = #agif084@#24 + #agif084@#46 + #agif084@#47 + #agif084@#49;
   #agif084@#41 = (#agif084@#15 - #agif084@#25) + (#agif084@#11 + #agif084@#13 + #agif084@#24);

   |SI #agif084@#67 = "D";
      #agif084@#72 = #agif084@#70;
      #agif084@#73 = #agif084@#71;
      #agif084@#74 = #agif084@#15;
      #agif084@#75 = #agif084@#41;
   |SINO;
      #agif084@#72 = #agif084@#15;
      #agif084@#73 = #agif084@#41;
      #agif084@#74 = #agif084@#70;
      #agif084@#75 = #agif084@#71;
   |FINSI;
|FPRC;

|DEFBUCLE RecalcLin;
#agif069@#1003;
;
#agif084@#48, #agif084@#0, 001;
#agif084@#48, #agif084@#0, 999;
be;
NULL,RecalcLin;
|FIN;

|PROCESO RecalcCab;

   #agif084@#15 = 0; || Bruto factura
   #agif084@#24 = 0; || Total iva
   #agif084@#25 = 0; || Total descuento
   #agif084@#26 = 0; || Total comision
   #agif084@#37 = 0; || Margen factura
   #agif084@#41 = 0; || Total factura
   #agif084@#70 = 0; || Bruto factura DIV
   #agif084@#71 = 0; || Total factura DIV
   #agif084@#72 = 0; || Bruto factura VIS
   #agif084@#73 = 0; || Total factura VIS
   #agif084@#74 = 0; || Bruto factura NO VIS
   #agif084@#75 = 0; || Total factura NO VIS

   #agif084@#16 = 0; #agif084@#17 = 0; #agif084@#18 = 0; || Iva 1
   #agif084@#19 = 0; #agif084@#20 = 0; #agif084@#21 = 0; || Iva 2
   #agif084@#22 = 0; #agif084@#23 = 0; #agif084@#49 = 0; || Iva 3
   #agif084@#42 = 0; #agif084@#43 = 0; #agif084@#44 = 0; || Iva 4
   #agif084@#45 = 0; #agif084@#46 = 0; #agif084@#47 = 0; || Iva 5
   #agif084@#50 = 0; #agif084@#51 = 0;                   || % Iva 1
   #agif084@#52 = 0; #agif084@#53 = 0;                   || % Iva 2
   #agif084@#54 = 0; #agif084@#55 = 0;                   || % Iva 3
   #agif084@#56 = 0; #agif084@#57 = 0;                   || % Iva 4
   #agif084@#58 = 0; #agif084@#59 = 0;                   || % Iva 5
   #agif084@#28 = 0;                                     || Base exenta

   |BUCLE RecalcLin;

   |GRABA 020#agif084@.a;

   |HAZ GrabaAcumCli;
   |HAZ CreaRecibos;
|FPRC;

|PROCESO TempoEnl;
   |DDEFECTO #dscaw064;
   #dscaw064#0 = #dscam051#49;
   #dscaw064#1 = nNumerador;
   #dscaw064#2 = nLinea;
   #dscaw064#3 = #dscaz009#5;
   #dscaw064#4 = #dscam051#51;
   #dscaw064#5 = 1;
   #dscaw064#6 = #dscaz009#15 + #dscaz009#18 + #dscaz009#19;
   #dscaw064#7 = nNumerador;
   #dscaw064#8 = #dscam051#50;
   #dscaw064#9 = #dscam051#52;
   |GRABA 020#dscaw064.n;
|FPRC;

|PROCESO FacturaGastos;
   nCalc = #dscaz009#15 + #dscaz009#18 + #dscaz009#19;
   |SI nCalc = 0; |ACABA; |FINSI;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;
   |SI #dscam051#48 = "N"; |ACABA; |FINSI;

   |DFICB aAlfa; |QBF aAlfa;
   |PATH_DAT #20 aAlfa; |PATH_DAT #21 aAlfa;
   |ABRE #dscam044; |ABRE #dscam045; |ABRE #dscam003; |ABRE #dscam014;
   nSwError = 1; nEmpresa = #48#15;
   |BUCLE BuscaGestion;
   |SI nSwError = 0;
      #dscam044#0 = #dscam045#0;
      |LEE 000#dscam044.=;
      |SI FSalida = 0;
         aDire = #dscam044#1; |QBF aDire;
         aDire = aDire + "def/";
         aAlfa = aDire + "agifa024.mas";
         |CARGA_DEF aAlfa, agif024@;
         |SI FSalida = 0;
            aAlfa = aDire + "agifa019.mas"; |CARGA_DEF aAlfa, agif019@;
            aAlfa = aDire + "agifa007.mas"; |CARGA_DEF aAlfa, agif007@;
            aAlfa = aDire + "agifa084.mas"; |CARGA_DEF aAlfa, agif084@;
            aAlfa = aDire + "agifa069.mas"; |CARGA_DEF aAlfa, agif069@;
            aAlfa = aDire + "agifa142.mas"; |CARGA_DEF aAlfa, agif142@;
            aAlfa = aDire + "agifa027.mas"; |CARGA_DEF aAlfa, agif027@;
            aAlfa = aDire + "agifa066.mas"; |CARGA_DEF aAlfa, agif066@;
            aAlfa = aDire + "dsm00113.mas"; |CARGA_DEF aAlfa, dsm0113@;
            aAlfa = aDire + "agifa025.mas"; |CARGA_DEF aAlfa, agif025@;
            aAlfa = aDire + "agifa321.mas"; |CARGA_DEF aAlfa, agif321@;
            aAlfa = aDire + "agifa324.mas"; |CARGA_DEF aAlfa, agif324@;
            aAlfa = aDire + "agifa091.mas"; |CARGA_DEF aAlfa, agif091@;
            aAlfa = aDire + "agifa133.mas"; |CARGA_DEF aAlfa, agif133@;
            aAlfa = #dscam044#1; |QBF aAlfa;
            aAlfa = aAlfa + "fich/" + (("00000" + #dscam044#0)%-105) + "/";
            |PATH_DAT #500 aAlfa; |PATH_DAT #501 aAlfa;
            |PATH_DAT #502 aAlfa; |PATH_DAT #503 aAlfa;
            |PATH_DAT #504 aAlfa; |PATH_DAT #505 aAlfa;
            |PATH_DAT #506 aAlfa; |PATH_DAT #507 aAlfa;
            |PATH_DAT #508 aAlfa; |PATH_DAT #509 aAlfa;
            |PATH_DAT #510 aAlfa; |PATH_DAT #511 aAlfa;
            |PATH_DAT #512 aAlfa; |PATH_DAT #513 aAlfa;

            |DELINDEX #dscaw064; |ABRE #dscaw064;
            |ABRE #agif024@; |ABRE #agif019@;
            |ABRE #agif007@; |ABRE #agif084@;
            |ABRE #agif069@; |ABRE #agif142@;
            |ABRE #agif027@; |ABRE #agif066@;
            |ABRE #dsm0113@; |ABRE #agif025@;
            |ABRE #agif321@; |ABRE #agif324@;
            |ABRE #agif091@; |ABRE #agif133@;

            |LEE 000#agif142@.p;
            |SI FSalida ! 0; |DDEFECTO #agif142@; |FINSI;

            |LEE 000#agif321@.p;
            |SI FSalida ! 0; |DDEFECTO #agif321@; |FINSI;

            || Compruebo que la aplicacion de gestion comercial est‚
            ||     actualizada
            aAlfa = "|K000"; aAlfa = #agif066@#aAlfa#;
            aAlfa = aAlfa % 0103;
            |SI aAlfa ! "002";
               |MENAV "    La aplicacion de gestion comercial esta obsoleta. Actualice a la ultima version.";
            |SINO;
               nLinea = 1; nNumerador = 1;
               |HAZ TempoEnl; nContAnt = 0;

               |HAZ CargaNDeci;
               |BUCLE CreaFacturas;
               |HAZ RecalcCab; |LIBERA #agif084@;
            |FINSI;

            |CIERRA #agif133@; |DESCARGA_DEF #agif133@;
            |CIERRA #agif091@; |DESCARGA_DEF #agif091@;
            |CIERRA #agif324@; |DESCARGA_DEF #agif324@;
            |CIERRA #agif321@; |DESCARGA_DEF #agif321@;
            |CIERRA #agif025@; |DESCARGA_DEF #agif025@;
            |CIERRA #dsm0113@; |DESCARGA_DEF #dsm0113@;
            |CIERRA #agif066@; |DESCARGA_DEF #agif066@;
            |CIERRA #agif027@; |DESCARGA_DEF #agif027@;
            |CIERRA #agif142@; |DESCARGA_DEF #agif142@;
            |CIERRA #agif069@; |DESCARGA_DEF #agif069@;
            |CIERRA #agif084@; |DESCARGA_DEF #agif084@;
            |CIERRA #agif007@; |DESCARGA_DEF #agif007@;
            |CIERRA #agif019@; |DESCARGA_DEF #agif019@;
            |CIERRA #agif024@; |DESCARGA_DEF #agif024@;

            |CIERRA #dscaw064;
         |SINO;
            |MENAV "    Poblemas al acceder al fichero de clientes de Gestion";
         |FINSI;
      |FINSI;
      |CIERRA #dscam044; |CIERRA #dscam045; |CIERRA #dscam003; |CIERRA #dscam014;
   |FINSI;
|FPRC;
