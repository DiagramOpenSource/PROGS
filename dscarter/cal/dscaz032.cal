|FICHEROS;
   dscaw183 #50;

   dscam999 #999;
|FIN;

|VARIABLES;
   &eaOrigen  = "";
   &eaNombre1 = "";
   &eaDSMAC   = "";
   &eaDirect  = "";

   aDestino = "";
   Comodin  = "";
   ip       = "";
   aResp    = "";

   aAlfa    = "";
|FIN;

|PROGRAMA;
/*
   |PUSHV 0501 2380;
   |BLANCO 0915 1365;
   |CUADRO 1016 1264;
   |PINTA 1117, " ¨ Grabar en Disquete, Carpeta o Ninguna ? ";
   E_sup = 1;
   E_inf = "DCNdcn";
   aResp = 1160 ? 0;
   |POPV;
*/
  aResp = "C";

   |SI aResp = "N"; |O aResp = "n"; |ACABA; |FINSI;
   |SI aResp = "D"; |O aResp = "d";
      |PUSHV 0501 2380;
      |BLANCO 0815 1465;
      |CUADRO 0915 1364;
      |IP_REMOTO ip; |QBF ip;
      |PINTA 1015, "      Introduzca un disquete en su PC             ";
      |PINTA 1115, "               y pulse una tecla                  ";
      |PAUSA;

      aDestino = "/normas/"; |RMKDIR aDestino;
      aDestino = aDestino + eaNombre1;
      Comodin = eaOrigen; |QBF Comodin; Comodin = Comodin + eaNombre1;
      |SI ip ! "";
         |ENVIA_FICHERO Comodin, aDestino;
      |SINO;
         |COPIA_FICHERO Comodin, aDestino;
      |FINSI;
      Comodin = "COPY " + aDestino + " A:"; |RSYSTEM Comodin;
      Comodin = "DEL " + aDestino;          |RSYSTEM Comodin;
      |POPV;
   |FINSI;
   |SI aResp = "C"; |O aResp = "c";
      |HAZ RecogeMac;
      |ABRE #dscam999;
      #dscam999#0 = eaDSMAC;
      |LEE 101#dscam999.=;
      |SI FSalida ! 0;
         |DDEFECTO #dscam999;
         #dscam999#0 = eaDSMAC;
         |GRABA 020#dscam999.b;
      |FINSI;

      |IP_REMOTO ip; |QBF ip;

      eaDirect = #dscam999#1; |QBF eaDirect;
      |HAZ RecogeDirectorio; aDestino = eaDirect;
      |SI aDestino = "";
         |MENAV "    Proceso cancelado"; |ACABA;
      |FINSI;

      aAlfa = aDestino % -101;
      |SI aAlfa ! "/"; |Y aAlfa ! "\";
         aDestino = aDestino + "/";
      |FINSI;

      #dscam999#1 = aDestino;
      |GRABA 020#dscam999.a; |LIBERA #dscam999;
      |CIERRA #dscam999;

      |PUSHV 0501 2380;
      #dscaw183#0 = eaNombre1;
      |PINPA #0#dscaw183; |PINDA #0#dscaw183;
      |ENDATOS #1#dscaw183;
      |SI FSalida = 0;
         |POPV;
      |SINO;
         |POPV;
         |MENAV "    Proceso cancelado"; |ACABA;
      |FINSI;

      aDestino = aDestino + #dscaw183#0; |QBF aDestino;
      Comodin = eaOrigen; |QBF Comodin; Comodin = Comodin + eaNombre1;
      |SI ip ! "";
         |ENVIA_FICHERO Comodin, aDestino;
      |SINO;
         |COPIA_FICHERO Comodin, aDestino;
      |FINSI;
      |SI FSalida = 0;
         |MENAV "    Fichero correctamente ubicado en la carpeta seleccionada";
      |SINO;
         |MENAV "    Ha ocurrido un error al copiar el fichero al directorio destino";
      |FINSI;
   |FINSI;
|FPRO;
