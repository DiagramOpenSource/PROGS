|FICHEROS;
   dscaz073 #0;

   dscam076 #10;
   dscam077 #11;
   dscam078 #12;
   dscaw056 #13;
   dscam051 #14;
   dscam020 #15;
   dscam018 #16;
|FIN;

|VARIABLES;
   &enSw       = 0;
   &eaPeriodo  = "";
   &enDias     = 0;
   &enImpTotal = 0;
   &eaCifCli   = "";
   &eaExpCli   = "";

   aAntCli = "";
   aAlfa   = "";

   nAntCom = 0;
   nAntPer = 0;
   nAntAny = 0;
   nCab    = 0;
   nCalc   = 0;
   nCont   = 0;
   nContLi = 0;
   nNumLin = 0;
|FIN;

|PROCESO Reparte;
   nCalc = #dscam078#9 - #dscam078#8;
   #dscaw056#0 = nCalc;
   |LEE 000#dscaw056.];
   #dscaw056#1 = #dscaw056#1 + #dscam078#10;
   |GRABA 020#dscaw056.a;
|FPRC;

|DEFBUCLE Reparte;
#dscam078#1;
;
#dscam077#0, #dscam077#1, #dscam077#2, #dscam077#3,   1;
#dscam077#0, #dscam077#1, #dscam077#2, #dscam077#3, 999;
;
NULL,Reparte;
|FIN;

|PROCESO CuentaLins;
   |SI enSw = 1; nCalc = nContLi + 2; |FINSI;
   |SI enSw = 2; nCalc = nContLi + 2; |FINSI;
   |SI enSw = 3; nCalc = nContLi + 2; |FINSI;
   |SI enSw = 4; nCalc = nContLi + 1; |FINSI;
   |SI enSw = 5; nCalc = nContLi + 1; |FINSI;
   |SI enSw = 6; nCalc = nContLi + 2; |FINSI;
   |SI enSw = 7; nCalc = nContLi + 1; |FINSI;
   |SI nCalc > nNumLin;
      nCalc = enSw; enSw = 5;
      |PARA; |SI; |HACIENDO;
         |PRINT;
         nContLi = nContLi + 1; |SI nContLi > nNumLin; |SAL; |FINSI;
      |SIGUE;
      enSw = nCalc;
   |FINSI;
|FPRC;

|PROCESO Vtos;
   |LEE 000#dscaw056.p;
   |SI FSalida = 0;
      enDias = #dscaw056#0; enImpTotal = #dscaw056#1;
      |BORRA 020#dscaw056.a;
   |SINO;
      enDias = -1; enImpTotal = 0;
   |FINSI;

   |SI nCab = 0;
      enSw = 5; |HAZ CuentaLins; |PRINT;
      enSw = 6; |HAZ CuentaLins; |PRINT;
      nCab = 1;
   |FINSI;
   enSw = 7; |HAZ CuentaLins; |PRINT;
|FPRC;

|DEFBUCLE Vtos;
#dscam078#2;
;
0000,#dscam077#0, #dscam077#1, #dscam077#2, #dscam077#3, 001;
9999,#dscam077#0, #dscam077#1, #dscam077#2, #dscam077#3, 999;
;
NULL,Vtos;
|FIN;

|PROCESO Lineas1b;
   |PRINT;
|FPRC;

|DEFBUCLE Lineas1b;
#dscam078#1;
;
#dscam077#0, #dscam077#1, #dscam077#2, #dscam077#3, 001;
#dscam077#0, #dscam077#1, #dscam077#2, #dscam077#3, 999;
;
NULL, Lineas1b;
|FIN;

|PROCESO Lineas1;
   |ABRE #dscam020;
   |SELECT #3#dscam020;
   #dscam020#4 = #dscam077#3;
   |LEE 000#dscam020.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam020;
   |FINSI;
   eaCifCli = #dscam020#11;
   eaExpCli = #dscam020#2;
   |CIERRA #dscam020;

   |BUCLE Lineas1b;
|FPRC;

|DEFBUCLE Lineas1;
#dscam077#1;
;
#dscam076#0, #dscam076#1, #dscam076#2, "      ";
#dscam076#0, #dscam076#1, #dscam076#2, "zzzzzz";
;
NULL,Lineas1;
|FIN;

|PROCESO Lineas;
   |ABRE #dscam020;
   |SELECT #3#dscam020;
   #dscam020#4 = #dscam077#3;
   |LEE 000#dscam020.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam020;
   |FINSI;
   eaCifCli = #dscam020#11;
   eaExpCli = #dscam020#2;
   |CIERRA #dscam020;

   |SI aAntCli ! #dscam077#3;
      enSw = 3; |HAZ CuentaLins; |PRINT;
      nCab = 0; aAntCli = #dscam077#3;
   |FINSI;
   enSw = 4; |HAZ CuentaLins; |PRINT;

   |PUSHV 0501 2380;
   |ABRE #dscam051;
   |LEE 000#dscam051.=;
   |CIERRA #dscam051;

   aAlfa = "di" + Usuario; |NOME_DAT #13 aAlfa;
   |DELINDEX #dscaw056; |ABRE #dscaw056;
   |PARA nCont = 1; |SI nCont [ #dscam051#46; |HACIENDO nCont = nCont + 1;
      nCalc = nCont * #dscam051#45;
      |DDEFECTO #dscaw056;
      #dscaw056#0 = nCalc;
      |GRABA 020#dscaw056.n;
   |SIGUE;
   |DDEFECTO #dscaw056; #dscaw056#0 = 999; |GRABA 020#dscaw056.n;

   |BUCLE Reparte;
   |BUCLE Vtos;

   |LEE 000#dscaw056.p;
   |PARA; |SI FSalida = 0; |HACIENDO;
      #dscam078#7 = 0;
      enDias = #dscaw056#0; enImpTotal = #dscaw056#1;
      enSw = 7; |HAZ CuentaLins; |PRINT;
      |BORRA 020#dscaw056.a;
      |LEE 000#dscaw056.p;
   |SIGUE;

   |CIERRA #dscaw056;
   enSw = 5; |HAZ CuentaLins; |PRINT;
|FPRC;

|DEFBUCLE Lineas;
#dscam077#1;
;
#dscam076#0, #dscam076#1, #dscam076#2, "      ";
#dscam076#0, #dscam076#1, #dscam076#2, "zzzzzz";
;
NULL,Lineas;
|FIN;

|PROCESO Impresion;
   #dscam018#0 = #dscam076#0;
   |LEE 000#dscam018.=;
   |SI FSalida ! 0; |DDEFECTO #dscam018; |FINSI;

   |SI nAntCom ! #dscam076#0;
      |SI nAntCom ] 0; |PIEINF; |FININF; |FINSI;

      aAlfa = #dscam018#16; |QBF aAlfa;
      |INFOR aAlfa;
      |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
      |CIMPR 11; nNumLin = FSalida;
   |FINSI;

   |SI #dscam076#1 = 01; eaPeriodo = "ENERO     "; |FINSI;
   |SI #dscam076#1 = 02; eaPeriodo = "FEBRERO   "; |FINSI;
   |SI #dscam076#1 = 03; eaPeriodo = "MARZO     "; |FINSI;
   |SI #dscam076#1 = 04; eaPeriodo = "ABRIL     "; |FINSI;
   |SI #dscam076#1 = 05; eaPeriodo = "MAYO      "; |FINSI;
   |SI #dscam076#1 = 06; eaPeriodo = "JUNIO     "; |FINSI;
   |SI #dscam076#1 = 07; eaPeriodo = "JULIO     "; |FINSI;
   |SI #dscam076#1 = 08; eaPeriodo = "AGOSTO    "; |FINSI;
   |SI #dscam076#1 = 09; eaPeriodo = "SEPTIEMBRE"; |FINSI;
   |SI #dscam076#1 = 10; eaPeriodo = "OCTUBRE   "; |FINSI;
   |SI #dscam076#1 = 11; eaPeriodo = "NOVIEMBRE "; |FINSI;
   |SI #dscam076#1 = 12; eaPeriodo = "DICIEMBRE "; |FINSI;

   |SI #dscam018#15 = "D";
      |SI nAntCom ! #dscam076#0;
         enSw = 1; |HAZ CuentaLins; |PRINT;
         enSw = 2; |HAZ CuentaLins; |PRINT;
         nAntPer = #dscam076#1; nAntAny = #dscam076#2;
         nAntCom = #dscam076#0;
      |FINSI;
      |SI nAntPer ! #dscam076#1; |O nAntAny ! #dscam076#2;
         enSw = 2; |HAZ CuentaLins; |PRINT;
         nAntPer = #dscam076#1; nAntAny = #dscam076#2;
      |FINSI;

      |BUCLE Lineas;
   |SINO;
      |SI nAntCom ! #dscam076#0;
         nAntCom = #dscam076#0;
      |FINSI;
      |BUCLE Lineas1;
   |FINSI;
|FPRC;

|DEFBUCLE Impresion;
#dscam076#1;
;
#dscaz073#0 , #dscaz073#1 , #dscaz073#2;
#dscaz073#3 , #dscaz073#4 , #dscaz073#5;
;
NULL, Impresion;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA " Emision mantenimiento importes ";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      nAntCom = -1;
      |ABRE #dscam018;
      |BUCLE Impresion;
      |CIERRA #dscam018;
      |SI nAntCom ] 0; |PIEINF; |FININF; |FINSI;
      |FINIMP;
   |FINSI;
|FPRO;
