|FICHEROS;
   dscam002 #0;
   dscam044 #10;
   dscam045 #11;
   dscam052 #52;
   agifa024@ #100;
|FIN;

|VARIABLES;
     nCampos = "";
     i = 0;
     DEmpresa = 0;
     HEmpresa = 0;
     aDir  = "";
     aAlfa = "";
     aCodBanco = "";
     aCodSuc   = "";
     nSwCambio = 0;
|FIN;

|PROCESO Clientes1;
     #agifa024@#29  = #dscam002#2;
     #agifa024@#34  = #dscam002#3;
     #agifa024@#162 = #dscam002#6;
     |GRABA 020#agifa024@.a;

     aAlfa = "|NC";
     nCampos = (N\(#52aAlfa));

     #52#0 = #agifa024@#0;
     |LEE 101#52=;
     |SI FSalida ! 0; |GRABA 020#52b; |FINSI;
     |PARA i = 1; |SI i < nCampos; |HACIENDO i = i + 1;
          #52i = #agifa024@#i#;
     |SIGUE;
     |GRABA 020#52a;
     |LIBERA #52;
|FPRC;

|DEFBUCLE Clientes1;
     #agifa024@#1001;
     32,33;
     "      ",aCodBanco,aCodSuc;
     "zzzzzz",aCodBanco,aCodSuc;
     be;
     NULL,Clientes1;
|FIN;

|PROCESO Empresas1;
   #dscam044#0 = #dscam045#0;
   |LEE 000#dscam044.=;
   |SI FSalida = 0;
      aDir = #dscam044#1; |QBF aDir;
      aAlfa = aDir + "def/agifa024.mas";
      |CARGA_DEF aAlfa , agifa024@;
      |SI FSalida = 0;
         aAlfa = aDir + "fich/" + (("00000" + #dscam044#0) % -105) + "/";
         aCodBanco = (("0000" + #dscam002#0) % -104) + "  ";
         aCodSuc   = (("0000" + #dscam002#1) % -104) + "  ";
         |PATH_DAT #100 aAlfa;
         |ABRE #agifa024@;
         |BUCLE Clientes1;
         |CIERRA #agifa024@; |DESCARGA_DEF #agifa024@;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Empresas1;
#dscam045#2;
;
DEmpresa;
HEmpresa;
;
NULL,Empresas1;
|FIN;

|PROCESO Tipo31; |TIPO 30;
   |SI nSwCambio = 1;
      |CONFI "    NCambiar en las fichas de los clientes de gestion comercial ? ";
      |SI FSalida = 0;
         |DFICB aAlfa; |QBF aAlfa;
         |PATH_DAT #10 aAlfa; |PATH_DAT #11 aAlfa;
         |ABRE #dscam044; |ABRE #dscam045;
         |ABRE #52;
         DEmpresa = #48#0; HEmpresa = #48#0;
         |BUCLE Empresas1;
         |CIERRA #52;
         |CIERRA #dscam044; |CIERRA #dscam045;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO CambioS;
   |SI #dscam002#Campo# ! Contenido; nSwCambio = 1; |FINSI;
|FPRC;

|PROCESO Tipo131; |TIPO 13;
   nSwCambio = 0;
|FPRC;
