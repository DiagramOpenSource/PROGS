|FICHEROS;
   dscaz163 #0;

   dscam170 #10;
   dscam003 #11;
|FIN;

|VARIABLES;
   &enSwCambio = 0;
   &eaCodigo    = "";
   &eaTipoCod   = "";
   &aCuenta     = "";
   &eaNif       = "";
   &eaNombre    = "";
   &eaApCorreos = "";
   &eaDireccion = "";
   &eaPoblacion = "";
   &eaProvincia = "";
   &eaCP        = "";
   &eaCP1       = "";
   &eaCP2       = "";
   &eaTelefono  = "";
   &eaFax       = "";

   aAlfa        = "";
   aEntidad     = "";
   aNumero      = "";
|FIN;

|PROCESO Documentos;
   |PRINT;

   |SI #dscam003#3 = #dscam170#3; |O #dscaz163#6 ! "N";
      #dscam003#3 = #dscam170#1;
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE Documentos;
#dscam003#7;
;
aEntidad, aNumero, 000000001;
aEntidad, aNumero, 999999999;
be;
NULL, Documentos;
|FIN;

|PROCESO Aplazamientos;
   #dscam003#40 = #dscam170#0;
   |LEE 101#dscam003.=;
   |SI FSalida ! 0; |ACABA; |FINSI;

   eaCodigo = #dscam003#32; eaTipoCod = "C"; aCuenta = #dscam003#5; |HAZ LeeDatos;

   enSwCambio = 0;
   |SI #dscam003#3 ! #dscam170#3; |Y #dscaz163#6 = "N"; enSwCambio = 1; |FINSI;

   |PRINT;

   |SI #dscam003#3 ! #dscam170#3; |Y #dscaz163#6 = "N"; |LIBERA #dscam003; |ACABA; |FINSI;

   #dscam003#3 = #dscam170#1;
   |GRABA 020#dscam003.a; |LIBERA #dscam003;

   #dscam170#4 = "S"; |GRABA 020#dscam170.a;
|FPRC;

|DEFBUCLE Aplazamientos;
#dscam170#1;
1,4;
#dscaz163#0, #dscaz163#1, #dscaz163#2, "N";
#dscaz163#3, #dscaz163#4, #dscaz163#5, "N";
be;
NULL, Aplazamientos;
|FIN;

|PROGRAMA;
   |HAZ Tipo8;

   |SI PARAMETRO = "";
      |CLS;

      |CABEZA "Carta de aplazamiento de vencimientos";
      |PINPA #0#0; |PINDA #0#0;
      |ENDATOS #1#0;
   |SINO;
      aAlfa = PARAMETRO; |QBF aAlfa;
      #0#0 = aAlfa; #0#3 = aAlfa;
      FSalida = 0;
   |FINSI;

   |SI FSalida = 0;
      Impresora = "CrystalReport";
      |IMPRE -1;
      |SI FSalida = 0;
         |INFOR "dscaz163";
         |SI FSalida = 0;
            |ABRE #dscam003;
            |BUCLE Aplazamientos;
            |CIERRA #dscam003;
            |PIEINF; |FININF;
         |FINSI;
         |FINIMP;
      |FINSI;
   |FINSI;

   |HAZ Tipo9;
|FPRO;
