|FICHEROS;
   dscaz033 #0;
   dscam016 #1;
   dscam017 #2;
   dscam048 #3;
   dscam003 #4;

   &agif024@ #50;
   &caclipr@ #51;
|FIN;

|VARIABLES;
   &SwNumAsig  = 0;
   &SwTotal    = 0;
   &nDeci_Base = 0;
   &nDeci_Div  = 0;
   &CambioDiv  = 0;
   &Divisa     = "";
   &aInforme   = "";
   &Fichero    = ""; &Tipo = ""; &Cmp = ""; &CmpNum = 0;
   &aPoblac    = ""; &HayGestion = 0; &HayConta = 0;
   &Niv1 = 0; &Niv2 = 0; &Niv3 = 0; &Niv4 = 0; &Niv5 = 0; &Niv6 = 0;
   &eaCodigo    = "";
   &eaTipoCod   = "";
   &aCuenta     = "";
   &eaNif       = "";
   &eaNombre    = "";
   &eaDireccion = "";
   &eaPoblacion = "";
   &eaProvincia = "";
   &eaCP        = "";
   &eaCP1       = "";
   &eaCP2       = "";
   &eaTelefono  = "";

   nCont = 0;
   nLong = 0;

   Comodin   = "";
   aLong     = "";
   DCobrador = "";
   HCobrador = "";
   CobAnt    = "";
|FIN;

|PROCESO LineasAsig;
   #dscam003#40 = #dscam017#9;
   |LEE 000#dscam003.=;
   Divisa = #dscam003#57; |HAZ TomaDecim;

   eaCodigo = #dscam003#32; eaTipoCod = "C"; aCuenta = #dscam003#5; |HAZ LeeDatos;
   aPoblac = eaPoblacion;
/*
   |SI HayGestion = 1;
       Fichero = "Clientes"; Tipo = "G"; Cmp = "Codigo Cliente"; |HAZ ObtenDato;
       #agif024@#CmpNum# = #dscam003#32;
       |LEE 000#agif024@.=;
       |SI FSalida = 0; |Y #agif024@#CmpNum# ! "      ";
          aPoblac = #agif024@#6;
       |FINSI;
   |SINO;
      |SI HayConta = 1;
          Fichero = "Clientes/Proveedores"; Tipo = "C"; Cmp = "Cliente/Proveedor"; |HAZ ObtenDato;
          #caclipr@#CmpNum# = "C";
          Fichero = "Clientes/Proveedores"; Tipo = "C"; Cmp = "Cuenta Contable"; |HAZ ObtenDato;
          #caclipr@#CmpNum# = #dscam003#5;
          Fichero = "Clientes/Proveedores"; Tipo = "C"; Cmp = "Digito Contable"; |HAZ ObtenDato;
          Comodin = #dscam003#5; |QBF Comodin; aLong = Comodin % 0; nLong = aLong;
          |SI nLong = Niv1; #caclipr@#CmpNum# = 1; |FINSI;
          |SI nLong = Niv2; #caclipr@#CmpNum# = 2; |FINSI;
          |SI nLong = Niv3; #caclipr@#CmpNum# = 3; |FINSI;
          |SI nLong = Niv4; #caclipr@#CmpNum# = 4; |FINSI;
          |SI nLong = Niv5; #caclipr@#CmpNum# = 5; |FINSI;
          |SI nLong = Niv6; #caclipr@#CmpNum# = 6; |FINSI;
          |LEE 000#caclipr@.=;
          |SI FSalida = 0; aPoblac = #caclipr@#6; |FINSI;
      |FINSI;
   |FINSI;
*/
   |PRINT;
   SwNumAsig = 0;
   Divisa = #dscam017#10; |HAZ Tipo13;
|FPRC;

|DEFBUCLE LineasAsig;
#dscam017#1;
;
#dscam016#0,001;
#dscam016#0,999;
;
NULL,LineasAsig;
|FIN;

|PROCESO EmiteAsig;
   |SI CobAnt ! #dscam016#1;
      |SI CobAnt ! 0;
         |PIEINF;
      |FINSI;
      CobAnt = #dscam016#1;
   |FINSI;
   #dscam048#0 = #dscam016#1;
   |LEE 000#dscam048.=;
   SwNumAsig = 1;
   SwTotal   = 0;
   |BUCLE LineasAsig;
   SwTotal   = 1; |PRINT;
|FPRC;
ñ
|DEFBUCLE EmiteAsig;
#dscam016#1;
1;
#dscaz033#21,DCobrador;
#dscaz033#22,HCobrador;
;
NULL,EmiteAsig;
|FIN;

|PROCESO Selec;
   |SI #dscaz033#0 = "S";
      |C_M #dscaz033#1,1,"S";
      |C_M #dscaz033#2,1,"S";
      |PARA nCont = 3; |SI nCont [ 20; |HACIENDO nCont = nCont + 1;
         #dscaz033#nCont# = ""; |PINTA #dscaz033#nCont#; |C_M #dscaz033#nCont#,1,"N";
      |SIGUE;
   |SINO;
      #dscaz033#1 = ""; |PINTA #dscaz033#1; |C_M #dscaz033#1,1,"N";
      #dscaz033#2 = ""; |PINTA #dscaz033#2; |C_M #dscaz033#2,1,"N";
      |PARA nCont = 3; |SI nCont [ 20; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz033#nCont#,1,"S";
      |SIGUE;
   |FINSI;
|FPRC;

|PROGRAMA;
   |CLS;
   |HAZ Tipo8;

   |CABEZA "Emision de asignaciones de cobradores";
   |ATRI R; |PINTA 0606, "EMISION DE ASIGNACIONES DE COBRADORES"; |ATRI N;
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |ABRE #dscam003; |ABRE #dscam048;
      |IMPRE 0;
      |SI FSalida ! 0; |MENAV "    Proceso abortado"; |ACABA; |FINSI;
      aInforme = "Carta asignacion a cobrador"; |HAZ ObtenInforme;
      |INFOR aInforme;
      |SI FSalida ! 0; |MENAV "    No existe informe"; |ACABA; |FINSI;
      |SI #dscaz033#0 = "S";
         DCobrador = #dscaz033#1; HCobrador = #dscaz033#2;
         |BUCLE EmiteAsig;
      |SINO;
         |PARA nCont = 3; |SI nCont [ 20; |HACIENDO nCont = nCont + 1;
             DCobrador = #dscaz033#nCont#;
             HCobrador = #dscaz033#nCont#;
             |BUCLE EmiteAsig;
         |SIGUE;
      |FINSI;
      |PIEINF;
      |FININF;
      |FINIMP;
      |CIERRA #dscam048; |CIERRA #dscam003;
   |FINSI;

   |HAZ Tipo9;
|FPRO;
