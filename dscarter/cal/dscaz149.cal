|FICHEROS;
     dscaz149 #0;
     dscam008 #1;
     dscam058 #4;

     dscaw134 #10;
     dscam051 #11;
|FIN;

|VARIABLES;
     informe = "";
     inform1 = "dscaz149";
     inform2 = "dsca1491";
     sw = 0;
     &enfor = 0;
     &ult_cta = "";
     &total = 0;
     &total1 = 0;
     &total2 = 0;
     &sw_inf = 0;
     &empres = "";
     &cp = "";
     &ult_dia = @;
     &ult_mes = "";
     &mes = "";
     &impor = 0;
     alfa1 = "";
     novale = 0;
     Parte1 = "";
     Parte2 = "";
     Posic1 = 0;
     Posic2 = 0;
     Comodin = "";
     Long = "";
     LongNum = 0;
     FEstado = 0;
     &MaxDigit = 0;
     &nDeci_Div = 0;
     &nDeci_Base = 0;
     &EURO_DB = 0;
     &EURO_DV = 0;

     &efFechaVto = @;

     &eaDescr = "";

     aAlfa = "";
|FIN;

|PROCESO mayor;
   alfa1 = #0Campo > " ";
   #0Campo = alfa1;
   |PINTA #0Campo;
|FPRC;

|PROCESO el_mes;
   |SI ult_mes = "01";      mes = "ENERO";       |FINSI;
   |SI ult_mes = "02";      mes = "FEBRERO";     |FINSI;
   |SI ult_mes = "03";      mes = "MARZO";       |FINSI;
   |SI ult_mes = "04";      mes = "ABRIL";       |FINSI;
   |SI ult_mes = "05";      mes = "MAYO";        |FINSI;
   |SI ult_mes = "06";      mes = "JUNIO";       |FINSI;
   |SI ult_mes = "07";      mes = "JULIO";       |FINSI;
   |SI ult_mes = "08";      mes = "AGOSTO";      |FINSI;
   |SI ult_mes = "09";      mes = "SEPTIEMBRE";  |FINSI;
   |SI ult_mes = "10";      mes = "OCTUBRE";     |FINSI;
   |SI ult_mes = "11";      mes = "NOVIEMBRE";   |FINSI;
   |SI ult_mes = "12";      mes = "DICIEMBRE";   |FINSI;
|FPRC;

|PROCESO imprim;
     |SI #dscam051#108 = "N";
        |HAZ verbueno;
        |SI novale = 1; |ACABA; |FINSI;

        efFechaVto = #dscam008#3;
     |SINO;
        #dscam008#40 = #dscaw134#1;
        |LEE 000#dscam008.=;
        |SI FSalida ! 0; |DDEFECTO #dscam008; |FINSI;
        impor = #dscaw134#2;

        |SI #dscam008#14 = "A"; |O #dscam008#14 = "D"; |ACABA; |FINSI;
        |SI #dscam008#73 ! "01.01.0000";
           efFechaVto = #dscam008#73;
        |SINO;
           efFechaVto = #dscam008#3;
        |FINSI;
     |FINSI;

     |SI sw = 0;
          sw = 1;
          ult_dia = #1#3;
          alfa1 = #1#3;  alfa1 = alfa1 % 402;
          ult_mes = alfa1;
     |FINSI;
     alfa1 = efFechaVto;  alfa1 = alfa1 % 402;
     |SI ult_mes ! alfa1;
         sw_inf = 2;
         |PRINT;
         sw_inf = 3;
         |HAZ el_mes;
         |PRINT;
         total = 0;
         total2 = 0;
         ult_mes = alfa1;
         ult_dia = efFechaVto;
     |SINO;
         |SI ult_dia ! efFechaVto;
               sw_inf = 2;    ||Imprime el primer total
               |PRINT;
               total = 0;
               ult_dia = efFechaVto;
          |FINSI;
     |FINSI;
     eaDescr = #dscam008#63; |QBF eaDescr;
     |HAZ leetipo;
     sw_inf = 1;
     |PRINT;
     total = total + impor;
     total1 = total1 + impor;
     total2 = total2 + impor;
|FPRC;

|PROCESO leetipo;
     |DDEFECTO #4;
     #4#0 = #1#12;
     |LEE 001#4=;
|FPRC;

|DEFBUCLE lee_cobro;
   #1#3;
   5, 27, 1, 12, 16;
   #0#6, 000000001, #0#4, #0#0, #0#2, #0#12, #0#15;
   #0#7, 999999999, #0#5, #0#1, #0#3, #0#13, #0#16;
   e;
   NULL, imprim;
|FIN;

|DEFBUCLE Imprime;
     #dscaw134#1;
     ;
     "01.01.0000", 0000000000;
     "31.12.9999", 9999999999;
     ;
     NULL, imprim;
|FIN;

|PROCESO Grabaw134;
     |SI #dscam008#14 = "A"; |O #dscam008#14 = "D"; |ACABA; |FINSI;
     |SI #dscam008#73 ! "01.01.0000";
        |SI #dscam008#73 < #0#6; |O #dscam008#73 > #0#7; |ACABA; |FINSI;
     |SINO;
        |SI #dscam008#3 < #0#6; |O #dscam008#3 > #0#7; |ACABA; |FINSI;
     |FINSI;

     |HAZ verbueno;
     |SI novale = 1; |ACABA; |FINSI;

     |DDEFECTO #dscaw134;
     |SI #dscam008#17 ! 0;
        #dscaw134#0 = #dscam008#73;
     |SINO;
        #dscaw134#0 = #dscam008#3;
     |FINSI;
     #dscaw134#1 = #dscam008#40;
     #dscaw134#2 = impor;
     |GRABA 020#dscaw134.n;
|FPRC;

|DEFBUCLE lee_cobrob;
   #1#2;
   5, 12, 16;
   #0#0, "     ", #0#2, 000, #0#4, #0#12, #0#15;
   #0#1, "zzzzz", #0#3, 999, #0#5, #0#13, #0#16;
   e;
   NULL, Grabaw134;
|FIN;

|PROCESO inicia; |TIPO 3;
   EURO_DB = nDeci_Base;
   EURO_DV = nDeci_Div;

   |IMPRE 0;
   |SI FSalida ! 0;  |ACABA;  |FINSI;
   |SI #0#17 ! "C";
       enfor = 1; |SI #0#17 = "N"; enfor = 2; |FINSI;
       informe = inform1;
   |SINO;
       enfor = 0;
       informe = inform2;
   |FINSI;

   |INFOR informe;
   |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
   empres = #48#1;
   |ABRE #4;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |SI #dscam051#108 = "N";
      |BUCLE lee_cobro;
   |SINO;
      aAlfa = "th" + Usuario; |NOME_DAT #dscaw134#aAlfa#;
      |DELINDEX #dscaw134; |ABRE #dscaw134;
      |BUCLE lee_cobrob;
      |ABRE #dscam008;
      |BUCLE Imprime;
      |CIERRA #dscam008;
   |FINSI;

   |SI sw = 1;
       sw_inf = 2;
       |PRINT;
       sw_inf = 3;
       |HAZ el_mes;
       |PRINT;
   |FINSI;
   |CIERRA #4;

   |SI #dscam051#108 = "S";
      |CIERRA #dscaw134; |DELINDEX #dscaw134;
   |FINSI;

   |PIEINF; |FININF;
   |FINIMP;
|FPRC;

|PROCESO verbueno;
   novale = 0;
   impor = 0;
   |SI #dscam008#14 = "A"; |O #dscam008#14 = "D";
       novale = 1; |ACABA;
   |FINSI;
   |SI #0#14 = "T";
       impor = #dscam008#25; || importe total pago
       |ACABA;
   |FINSI;
   |SI #0#14 = "S";
       impor = #dscam008#23; || importe pagado
       |SI impor = 0;
           novale = 1;
       |FINSI;
       |ACABA;
   |FINSI;
   |SI #0#14 = "N";
       impor = #dscam008#25 - #dscam008#23; || importe total - liquidado
       |SI impor = 0;
           |SI #dscam008#14 ! "P"; |Y #dscam008#14 ! "C";
              novale = 1;
              impor = 0;
           |FINSI;
       |FINSI;
       |ACABA;
   |FINSI;
|FPRC;

|PROCESO Cuenta; |TIPO 6;
   Comodin = #dscaz149#Campo#;
   Comodin = Comodin - ".";
   |SI FSalida ! 0;
      FEstado = FSalida;
      Posic1 = (FEstado / 100) ! 0;
      Posic1 = Posic1 + 99;
      Posic2 = FEstado + 98;
      Parte1 = Comodin % Posic1;
      Parte2 = Comodin % Posic2;
      |QBF Comodin;
      Long = Comodin % 0;
      LongNum = MaxDigit - Long;
      Comodin = "0" * LongNum;
      Comodin = Parte1 + Comodin + Parte2;
      #dscaz149#Campo# = Comodin;
      |PINTA #dscaz149#Campo#;
   |FINSI;
|FPRC;                                                                              |PINTA #capredcb#Campo#;
