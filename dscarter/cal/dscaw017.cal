|FICHEROS;
   dscaw017 #0;

   dscam003 #10;
   dscam058 #11;
   Referen@ #100;
|FIN;

|VARIABLES;
   &MaxDigit    = 0;
   &eaCodEnlace = "";
   &efFecha     = @;

   SwError = 0;

   Comodin  = "";
   Part1    = "";
   Part2    = "";
   LongAlfa = "";

   aAlfa    = "";

   nTecla   = 0;

   Long   = 0;
   Parte  = 0;
   Parte1 = 0;
   Parte2 = 0;
|FIN;

|PROCESO BuscaNum;
   SwError = 1;
|FPRC;

|DEFBUCLE BuscaNum;
#dscam003#7;
;
#dscaw017#0,#dscaw017#2,000000001;
#dscaw017#0,#dscaw017#2,999999999;
;
NULL,BuscaNum;
|FIN;

|PROCESO MiraNumero;
   |SI FSalida = 2; |ACABA; |FINSI;
   |SI #dscaw017#2 = "          ";
      |MENAV "    El numero de pagare no puede estar vacio"; |ERROR; |ACABA;
   |FINSI;
   SwError = 0;
   |BUCLE BuscaNum;
   |SI SwError = 1;
      |MENAV "    El numero de pagare ya existe";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO Cuenta01; |TIPO 6;
   Comodin = #Fichero@#Campo#;
   Comodin = Comodin - ".";
   |SI FSalida ! 0;
      Parte = FSalida;
      Parte1 = 100 + (((Parte / 100) ! 0) - 1);
      Parte2 = ((((Parte / 100) ! 0) + 1) * 100) + 99;
      Part1 = #Fichero@#Campo# % Parte1;
      Part2 = #Fichero@#Campo# % Parte2;
      |QBF Part2;
      Comodin = Part1 + Part2;
      LongAlfa = Comodin % 0;
      Long = MaxDigit - LongAlfa;
      LongAlfa = "0" * Long;
      Comodin = Part1 + LongAlfa + Part2;
      #Fichero@#Campo# = Comodin;
      |PINTA #Fichero@#Campo#;
   |FINSI;
   Comodin = #Fichero@#Campo#; |QBF Comodin;
   LongAlfa = Comodin % 0; Long = LongAlfa;
   |SI Long > MaxDigit;
      |MENAV "    Cuenta fuera de nivel";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO MiraCuenta;
   |HAZ EsViuda;
   |SI FSalida = 0;
      aAlfa = #dscaw017#5; |QBF aAlfa;
      |SI aAlfa = "";
         |MENAV "    La cuenta de recepcion del talon/pagare de cliente no puede estar vacia.";
         |ERROR;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO MiraEmpCont2;
   eaCodEnlace = #dscaw017#7; efFecha = #dscaw017#8;
   |HAZ ComprEmpContable;
|FPRC;

|PROCESO Tipo07Aspecto; |TIPO 7;
   |HAZ EsLuxe;
   |SI FSalida = 0;
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "luxem001.mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         |SI #dscaw017#9 = " "; #dscaw017#9 = "P"; |FINSI;
         |PINTA 1715, "บ Tipo Documento Recibido                        บ";
         |PINTA 1815, "ศออออออออออออออออออออออออออออออออออออออออออออออออผ";
         |C_M #dscaw017#9, 1, "S"; |C_V #dscaw017#9, 1, "S";
         |PINTA #dscaw017#9;

         |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
         #Referen@#0 = #dscaw017#9;
         |LEE 000#Referen@.=;
         |SI FSalida = 0;
            |PINTA 1744, #Referen@#1;
         |FINSI;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |SINO;
         |PINTA 1715, "ศออออออออออออออออออออออออออออออออออออออออออออออออผ";
         |PINTA 1815, "                                                  ";
      |FINSI;
   |SINO;
      |HAZ EsArtenvas;
      |SI FSalida = 0;
         |PINTA 1715, "บ Tipo Recibo :                                  บ";
         |PINTA 1815, "ศออออออออออออออออออออออออออออออออออออออออออออออออผ";
         |C_M #dscaw017#10, 1, "S"; |C_V #dscaw017#10, 1, "S"; |C_P #dscaw017#10, 1, 1731;
         |PINTA #dscaw017#10;

         |ABRE #dscam058;
         #dscam058#0 = #dscaw017#10;
         |LEE 000#dscam058.=;
         |SI FSalida ! 0; |DDEFECTO #dscam058; |FINSI;
         |CIERRA #dscam058;

         |PINTA 1734, #dscam058#1;
      |SINO;
         #dscaw017#9 = " ";
         |PINTA 1715, "ศออออออออออออออออออออออออออออออออออออออออออออออออผ";
         |PINTA 1815, "                                                  ";
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO TipoDocT66; |TIPO 66;
   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "luxem001.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
      |ABRE #Referen@;
      |CONSULTA_CLAVE #1#Referen@;
      |SI FSalida = 0;
         #dscaw017#9 = #Referen@#0;
         |PINTA 1744, #Referen@#1;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
   |ERROR;
|FPRC;

|PROCESO TrasTDoc;
   nTecla = FSalida;

   |C_V #dscaw017#9, 0, aAlfa;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "luxem001.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
      |ABRE #Referen@;
      #Referen@#0 = #dscaw017#9;
      |LEE 000#Referen@.=;
      |SI FSalida = 0;
         |PINTA 1744, #Referen@#1;
         #dscaw017#10 = #Referen@#2;
      |SINO;
         |MENAV "    Tipo de documento inexistente";
         |ERROR;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;

|PROCESO TipoRecT66; |TIPO 66;
   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "dscam058.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
      |ABRE #Referen@;
      |CONSULTA_CLAVE #1#Referen@;
      |SI FSalida = 0;
         #dscaw017#10 = #Referen@#0;
         |PINTA 1734, #Referen@#1;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
   |ERROR;
|FPRC;

|PROCESO TrasTRec;
   nTecla = FSalida;

   |C_V #dscaw017#10, 0, aAlfa;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "dscam058.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
      |ABRE #Referen@;
      #Referen@#0 = #dscaw017#10;
      |LEE 000#Referen@.=;
      |SI FSalida = 0;
         |PINTA 1734, #Referen@#1;
      |SINO;
         |MENAV "    Tipo de documento inexistente";
         |ERROR;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;
