|FICHEROS;
   dscaz160 #0;

   dscam003 #10;
   dscam004 #11;
   dscam012 #12;
   dscam013 #13;
   dscam067 #14;

   dscam008 #15;
   dscam009 #16;

   dscaw123 #20;
   dscaw124 #21;
   dscaw125 #22;

   cacuenta@ #100;
   canempre@ #101;
|FIN;

|VARIABLES;
   &aInforme = "";

   nSwImpreso = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aAlfa3 = "";

   nCalc    = 0;
   nCalc1   = 0;
   nCont    = 0;
   nCont1   = 0;
   nEmpresa = 0;
   nPeriodo = 0;

   nSwEmp   = 0;
   nSwRem   = 0;
   nSwAsto  = 0;
   nSwSerie = 0;

   nFactor  = 0;

   nSwPrint = 0;
   nEstimTota = 0;
   nEstimPdte = 0;
   nEstimGNeg = 0;
   nEstimGDev = 0;
   nEstimGOtr = 0;

   fFechaLim  = @;
|FIN;

|PROCESO RecogeEmpCont;
   |SI FSalida = 10;
      |SI Campo = 0; |O Campo = 3; |O Campo = 6; |O Campo = 9;
         nCalc = Campo + 1;
         #canempre@#2 = #dscaz160#Campo#;
         #canempre@#3 = #dscaz160#nCalc#;
      |SINO;
         nCalc = Campo - 1;
         #canempre@#2 = #dscaz160#nCalc#;
         #canempre@#3 = #dscaz160#Campo#;
      |FINSI;
      |LEE 000#canempre@.];
      |CONSULTA_CLAVE #1#canempre@;
      |SI FSalida = 0;
         |SI Campo = 0; |O Campo = 3; |O Campo = 6; |O Campo = 9;
            nCalc = Campo + 1;
            #dscaz160#Campo# = #canempre@#2; |PINTA #dscaz160#Campo#;
            #dscaz160#nCalc# = #canempre@#3; |PINTA #dscaz160#nCalc#;
            nCalc = Campo + 2;
            #dscaz160#nCalc# = #canempre@#1; |PINTA #dscaz160#nCalc#;
         |SINO;
            nCalc = Campo - 1;
            #dscaz160#nCalc# = #canempre@#2; |PINTA #dscaz160#nCalc#;
            #dscaz160#Campo# = #canempre@#3; |PINTA #dscaz160#Campo#;
            nCalc = Campo + 1;
            #dscaz160#nCalc# = #canempre@#1; |PINTA #dscaz160#nCalc#;
         |FINSI;
      |FINSI;
      |ERROR;
   |FINSI;

   |SI Campo = 0; |O Campo = 3; |O Campo = 6; |O Campo = 9;
      |ACABA;
      nCalc = Campo + 1;
      #canempre@#2 = #dscaz160#Campo#;
      #canempre@#3 = #dscaz160#nCalc#;
      nCalc = Campo + 2;
   |SINO;
      nCalc = Campo - 1;
      #canempre@#2 = #dscaz160#nCalc#;
      #canempre@#3 = #dscaz160#Campo#;
      nCalc = Campo + 1;
   |FINSI;
   |LEE 000#canempre@.=;
   |SI FSalida = 0;
      #dscaz160#nCalc# = #canempre@#1; |PINTA #dscaz160#nCalc#;
   |SINO;
      |SI #canempre@#2 ! 0; |O #canempre@#3 ! 0;
         |MENAV "    Empresa contable inexistente";
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO Cuentas;
   #dscaw123#0 = #cacuenta@#0;
   |LEE 000#dscaw123.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw123;
      #dscaw123#0 = #cacuenta@#0;
      #dscaw123#1 = #cacuenta@#2;
      |GRABA 020#dscaw123.c;
   |FINSI;

   |SI nSwEmp = 1;  #dscaw123#9  = "S"; |FINSI;
   |SI nSwEmp = 2;  #dscaw123#10 = "S"; |FINSI;
   |SI nSwEmp = 3;  #dscaw123#11 = "S"; |FINSI;
   |SI nSwEmp = 4;  #dscaw123#12 = "S"; |FINSI;

   nCalc = nSwEmp + 1;
   |SI #dscaz160#29 = 0;
      #dscaw123#nCalc# = (#cacuenta@#53 * nFactor);
   |SINO;
      nCalc1 = (#dscaz160#29 * 3) + 11;
      |PARA nCont1 = 11; |SI nCont1 [ nCalc1; |HACIENDO nCont1 = nCont1 + 3;
         #dscaw123#nCalc# = #dscaw123#nCalc# + (#cacuenta@#nCont1# * nFactor);
      |SIGUE;
   |FINSI;
   #dscaw123#6 = #dscaw123#2 + #dscaw123#3 + #dscaw123#4 + #dscaw123#5;
   |GRABA 020#dscaw123.a;
|FPRC;

|DEFBUCLE Cuentas;
#cacuenta@#1001;
;
#dscaz160#12;
#dscaz160#13;
;
NULL, Cuentas;
|FIN;

|PROCESO SaldoCont;
   aAlfa = #48#16; |QBF aAlfa;
   aAlfa1 = aAlfa + "fich/" + (("00000" + nEmpresa) % -105) + nPeriodo + "/";
   |PATH_DAT #cacuenta@#aAlfa1#;
   |BUCLE Cuentas;
|FPRC;

|PROCESO MovtosVta;
  nSwRem = 0;
  |SELECT #2#dscam013;
  #dscam013#16 = #dscam004#17;
  #dscam013#17 = #dscam004#3;
  |LEE 000#dscam013.=;
  |SI FSalida = 0;
     nSwRem = #dscam013#0;
     |DDEFECTO #dscam067;
     #dscam067#0 = "RM";
     #dscam067#1 = #dscam013#0; aAlfa1 = #dscam067#1;
     #dscam067#2 = #dscam013#1; aAlfa2 = #dscam067#2;
     #dscam067#3 = "I";         aAlfa3 = #dscam067#3;
     |LEE 000#dscam067.];
     |SI FSalida = 0; |Y #dscam067#0 = "RM"; |Y #dscam067#1 = aAlfa1; |Y #dscam067#2 = aAlfa2; |Y #dscam067#3 = aAlfa3;
        nSwAsto = 1;
     |SINO;
        #dscam067#0 = "RM";
        #dscam067#1 = #dscam013#0; aAlfa1 = #dscam067#1;
        #dscam067#2 = #dscam013#1; aAlfa2 = #dscam067#2;
        #dscam067#3 = "V";         aAlfa3 = #dscam067#3;
        |LEE 000#dscam067.];
        |SI FSalida = 0; |Y #dscam067#0 = "RM"; |Y #dscam067#1 = aAlfa1; |Y #dscam067#2 = aAlfa2; |Y #dscam067#3 = aAlfa3;
        |SINO;
           nSwAsto = 0;
           |DDEFECTO #dscam067;
        |FINSI;
     |FINSI;
  |SINO;
     |SELECT #4#dscam013;
     #dscam013#16 = #dscam004#17;
     #dscam013#24 = #dscam004#3;
     |LEE 000#dscam013.=;
     |SI FSalida = 0;
        nSwRem = #dscam013#0;
        |DDEFECTO #dscam067;
        #dscam067#0 = "RM";
        #dscam067#1 = #dscam013#0; aAlfa1 = #dscam067#1;
        #dscam067#2 = #dscam013#1; aAlfa2 = #dscam067#2;
        #dscam067#3 = "E";         aAlfa3 = #dscam067#3;
        |LEE 000#dscam067.];
        |SI FSalida = 0; |Y #dscam067#0 = "RM"; |Y #dscam067#1 = aAlfa1; |Y #dscam067#2 = aAlfa2; |Y #dscam067#3 = aAlfa3;
           nSwAsto = 1;
        |SINO;
           #dscam067#0 = "RM";
           #dscam067#1 = #dscam013#0; aAlfa1 = #dscam067#1
           #dscam067#2 = #dscam013#1; aAlfa2 = #dscam067#2;
           #dscam067#3 = "V";         aAlfa3 = #dscam067#3;
           |LEE 000#dscam067.];
           |SI FSalida = 0; |Y #dscam067#0 = "RM"; |Y #dscam067#1 = aAlfa1; |Y #dscam067#2 = aAlfa2; |Y #dscam067#3 = aAlfa3;
              nSwAsto = 1;
           |SINO;
              nSwAsto = 0;
              |DDEFECTO #dscam067;
           |FINSI;
        |FINSI;
     |FINSI;
  |FINSI;
  |SELECT #1#dscam013;

  |SI nSwAsto = 0;
     |DDEFECTO #dscam067;
     #dscam067#0 = "CB";
     #dscam067#1 = #dscam004#17; aAlfa1 = #dscam067#1;
     #dscam067#2 = #dscam004#3;  aAlfa2 = #dscam067#2;
     |LEE 000#dscam067.];
     |SI FSalida = 0; |Y #dscam067#0 = "CB"; |Y #dscam067#1 = aAlfa1; |Y #dscam067#2 = aAlfa2;
        nSwAsto = 1;
     |SINO;
        nSwAsto = 0;
        |DDEFECTO #dscam067;
     |FINSI;
  |FINSI;

  #dscaw125#0 = #dscam003#5;
  #dscaw125#1 = #dscam003#40;
  #dscaw125#2 = #dscam004#3;
  |LEE 000#dscaw125.=;
  |SI FSalida ! 0;
     |DDEFECTO #dscaw125;
     #dscaw125#0 = #dscam003#5;
     #dscaw125#1 = #dscam003#40;
     #dscaw125#2 = #dscam004#3;
     |GRABA 020#dscaw125.c;
  |FINSI;

  |SI #dscam004#5 = "COB"; #dscaw125#3 = "Cobro total del recibo"; |FINSI;
  |SI #dscam004#5 = "RCB"; #dscaw125#3 = "Cobro a traves de cobrador"; |FINSI;
  |SI #dscam004#5 = "REC"; #dscaw125#3 = "Compensacion entrega a cuenta"; |FINSI;
  |SI #dscam004#5 = "CAC"; #dscaw125#3 = "Cobrado de entrega a cuenta"; |FINSI;
  |SI #dscam004#5 = "COP"; #dscaw125#3 = "Cobro parcial"; |FINSI;
  |SI #dscam004#5 = "IMP"; #dscaw125#3 = "Impagado"; |FINSI;
  |SI #dscam004#5 = "RAC"; #dscaw125#3 = "Recepcion entrega a cuenta"; |FINSI;
  |SI #dscam004#5 = "RTA"; #dscaw125#3 = "Vencimiento talon/pagare de cliente"; |FINSI;
  |SI #dscam004#5 = "RPT"; #dscaw125#3 = "Recepcion talon/pagare de cliente"; |FINSI;
  |SI #dscam004#5 = "PRE"; #dscaw125#3 = "Preparacion de recibo para remesar"; |FINSI;
  |SI #dscam004#5 = "ENV"; #dscaw125#3 = "Recibo enviado a cliente para aceptado"; |FINSI;
  |SI #dscam004#5 = "ACE"; #dscaw125#3 = "Recibo aceptado por el cliente"; |FINSI;
  |SI #dscam004#5 = "REM"; #dscaw125#3 = "Abono de remesa"; |FINSI;
  |SI #dscam004#5 = "EMR"; #dscaw125#3 = "Emision de remesa"; |FINSI;
  |SI #dscam004#5 = "PRC"; #dscaw125#3 = "Peticion de reclamacion de documento"; |FINSI;
  |SI #dscam004#5 = "RCE"; #dscaw125#3 = "Confirmacion de reclamacion de documento"; |FINSI;
  |SI #dscam004#5 = "RCF"; #dscaw125#3 = "Recepcion confirming"; |FINSI;

  |SI nSwAsto = 1;
     #dscaw125#4 = #dscam067#8;
     #dscaw125#5 = #dscam067#9;
     #dscaw125#6 = #dscam067#4;
     #dscaw125#7 = #dscam067#5;
     #dscaw125#8 = #dscam067#6;
     #dscaw125#9 = #dscam067#7;
  |FINSI;

  |SI nSwRem ! 0;
     #dscaw125#10 = #dscam013#0;
     #dscaw125#11 = #dscam013#1;
  |FINSI;

  #dscaw125#12 = #dscam004#51;
  #dscaw125#13 = #dscam004#52;
  #dscaw125#14 = #dscam004#53;
  #dscaw125#15 = #dscam004#44;
  #dscaw125#16 = #dscam004#6;
  |GRABA 020#dscaw125.a;

  |SI #dscam004#6 [ fFechaLim;
     |SI #dscam004#5 ! "PRE";
        nEstimTota = nEstimTota + #dscam004#12 + #dscam004#13 + #dscam004#14 - #dscam004#32;
        ||nEstimPdte = nEstimPdte - #dscam004#8 - #dscam004#12 - #dscam004#13;
        ||nEstimPdte = nEstimPdte - #dscam004#14 + #dscam004#9;
        nEstimPdte = nEstimPdte - #dscam004#8 + #dscam004#12 + #dscam004#13;
        nEstimPdte = nEstimPdte + #dscam004#14 + #dscam004#9;
        nEstimGNeg = nEstimGNeg + #dscam004#12;
        nEstimGDev = nEstimGDev + #dscam004#13;
        nEstimGOtr = nEstimGOtr + #dscam004#14;
     |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE MovtosVta;
#dscam004#1;
;
#dscam003#40, 01;
#dscam003#40, 99;
;
NULL, MovtosVta;
|FIN;

|PROCESO RecibosVta;
   |SI #dscam003#14 = "D"; |O #dscam003#14 = "A"; |ACABA; |FINSI;
   |SI #dscam003#4 > fFechaLim; |ACABA; |FINSI;

   |SI #dscaz160#16 = "N";
      |SI #dscam003#0 < #dscaz160#27; |O #dscaz160#28 < #dscam003#0;
         |ACABA;
      |FINSI;
   |SINO;
      nSwSerie = 0;
      |PARA nCont = 17; |SI nCont [ 26; |HACIENDO nCont = nCont + 1;
         |SI #dscam003#0 = #dscaz160#nCont#; nSwSerie = 1; |SAL; |FINSI;
      |SIGUE;
      |SI nSwSerie = 0; |ACABA; |FINSI;
   |FINSI;

   #dscaw124#0 = #dscam003#5;
   #dscaw124#1 = #dscam003#40;
   |LEE 000#dscaw124.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw124;
      #dscaw124#0 = #dscam003#5;
      #dscaw124#1 = #dscam003#40;
      |GRABA 000#dscaw124.c;
   |FINSI;
   #dscaw124#2 = #dscam003#14;
   #dscaw124#3 = #dscam003#15;
   #dscaw124#4 = #dscam003#22;
||   #dscaw124#5 = #dscam003#30;
||   #dscaw124#6 = #dscam003#31;
||   #dscaw124#7 = #dscam003#24;
||   #dscaw124#8 = #dscam003#25;
||   #dscaw124#9 = #dscam003#38;
   #dscaw124#10 = #dscam003#0;
   #dscaw124#11 = #dscam003#1;
   #dscaw124#12 = #dscam003#3;
   #dscaw124#13 = #dscam003#4;
   #dscaw124#14 = #dscam003#26;
   |GRABA 000#dscaw124.a;

   aAlfa = #dscam003#15; |QBF aAlfa; aAlfa = aAlfa < aAlfa;
   aAlfa = aAlfa - "liquidado";
   |SI FSalida = 0;
      nEstimPdte = #dscam003#22; nEstimTota = #dscam003#22;
      nEstimGNeg = 0; nEstimGDev = 0; nEstimGOtr = 0;
      |BUCLE MovtosVta;
   |SINO;
      nEstimPdte = #dscam003#31; nEstimTota = #dscam003#30;
      nEstimGNeg = #dscam003#24; nEstimGDev = #dscam003#25;
      nEstimGOtr = #dscam003#38;
   |FINSI;

   #dscaw124#15 = #dscam003#30;
   #dscaw124#16 = #dscam003#31;
   #dscaw124#17 = #dscam003#24;
   #dscaw124#18 = #dscam003#25;
   #dscaw124#19 = #dscam003#38;
   #dscaw124#5  = nEstimTota;
   #dscaw124#6  = nEstimPdte;
   #dscaw124#7  = nEstimGNeg;
   #dscaw124#8  = nEstimGDev;
   #dscaw124#9  = nEstimGOtr;
   |GRABA 000#dscaw124.a;

   #dscaw123#0 = #dscam003#5;
   |LEE 000#dscaw123.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw123;
      #dscaw123#0 = #dscam003#5;
      #dscaw123#1 = #dscam003#6;
      |GRABA 020#dscaw123.c;
   |FINSI;
   #dscaw123#13 = "S";
   #dscaw123#7 = #dscaw123#7 + nEstimPdte;
   #dscaw123#8 = #dscaw123#6 - #dscaw123#7;
   |GRABA 020#dscaw123.a;
|FPRC;

|DEFBUCLE RecibosVta;
#dscam003#4;
4;
#dscaz160#12, 0000000001, "01.01.0000";
#dscaz160#13, 9999999999, #dscaz160#30;
;
NULL, RecibosVta;
|FIN;

|PROCESO RecibosCmp;
   |SI #dscam008#14 = "D"; |O #dscam008#14 = "A"; |ACABA; |FINSI;
   |SI #dscam008#4 > fFechaLim; |ACABA; |FINSI;

   |SI #dscaz160#16 = "N";
      |SI #dscam008#0 < #dscaz160#27; |O #dscaz160#28 < #dscam008#0;
         |ACABA;
      |FINSI;
   |SINO;
      nSwSerie = 0;
      |PARA nCont = 17; |SI nCont [ 26; |HACIENDO nCont = nCont + 1;
         |SI #dscam008#0 = #dscaz160#nCont#; nSwSerie = 1; |SAL; |FINSI;
      |SIGUE;
      |SI nSwSerie = 0; |ACABA; |FINSI;
   |FINSI;

   #dscaw124#0 = #dscam008#5;
   #dscaw124#1 = #dscam008#40;
   |LEE 000#dscaw124.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw124;
      #dscaw124#0 = #dscam008#5;
      #dscaw124#1 = #dscam008#40;
      |GRABA 000#dscaw124.c;
   |FINSI;
   #dscaw124#2 = #dscam008#14;
   #dscaw124#3 = #dscam008#15;
   #dscaw124#4 = #dscam008#22;
   #dscaw124#5 = #dscam008#25;
   #dscaw124#6 = #dscam008#31;
   #dscaw124#7 = #dscam008#24;
   #dscaw124#9 = #dscam008#38;
   #dscaw124#10 = #dscam008#0;
   #dscaw124#11 = #dscam008#1;
   |SI #dscam008#73 = "01.01.0000";
      #dscaw124#12 = #dscam008#3;
   |SINO;
      #dscaw124#12 = #dscam008#73;
   |FINSI;
   #dscaw124#13 = #dscam008#4;
   #dscaw124#14 = #dscam008#26;
   |GRABA 000#dscaw124.a;

   aAlfa = #dscam008#15; |QBF aAlfa; aAlfa = aAlfa < aAlfa;
   nEstimPdte = #dscam008#31; nEstimTota = #dscam008#25;
   nEstimGNeg = #dscam008#24; nEstimGDev = 0;
   nEstimGOtr = #dscam008#38;

   #dscaw124#15 = #dscam008#25;
   #dscaw124#16 = #dscam008#31;
   #dscaw124#17 = #dscam008#24;
   #dscaw124#18 = 0;
   #dscaw124#19 = #dscam008#38;
   #dscaw124#5  = nEstimTota;
   #dscaw124#6  = nEstimPdte;
   #dscaw124#7  = nEstimGNeg;
   #dscaw124#8  = nEstimGDev;
   #dscaw124#9  = nEstimGOtr;
   |GRABA 000#dscaw124.a;

   #dscaw123#0 = #dscam008#5;
   |LEE 000#dscaw123.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw123;
      #dscaw123#0 = #dscam008#5;
      #dscaw123#1 = #dscam008#6;
      |GRABA 020#dscaw123.c;
   |FINSI;
   #dscaw123#13 = "S";
   #dscaw123#7 = #dscaw123#7 + nEstimPdte;
   #dscaw123#8 = #dscaw123#6 - #dscaw123#7;
   |GRABA 020#dscaw123.a;
|FPRC;

|DEFBUCLE RecibosCmp;
#dscam008#5;
4;
#dscaz160#12, 0000000001, "01.01.0000";
#dscaz160#13, 9999999999, #dscaz160#30;
;
NULL, RecibosCmp;
|FIN;

|PROCESO ImprimeL2;
   nSwPrint = 0;
   |PRINT;
|FPRC;

|DEFBUCLE ImprimeL2;
#dscaw125#1;
;
#dscaw124#0, #dscaw124#1, 00;
#dscaw124#0, #dscaw124#1, 99;
;
NULL, ImprimeL2;
|FIN;

|PROCESO ImprimeL1;
   nSwPrint = 1;

   |BUCLE ImprimeL2;
   |SI nSwPrint = 1;
      |DDEFECTO #dscaw125;
      |PRINT;
      nSwImpreso = 1;
   |FINSI;
|FPRC;

|DEFBUCLE ImprimeL1;
#dscaw124#1;
;
#dscaw123#0, 0000000000;
#dscaw123#0, 9999999999;
;
NULL, ImprimeL1;
|FIN;

|PROCESO Imprime;
   |SI #dscaw123#8 = 0;
      |SI #dscaz160#14 = "S"; |ACABA; |FINSI;
   |FINSI;

   nSwImpreso = 0;
   |BUCLE ImprimeL1;
   |SI nSwImpreso = 0;
      |SI #dscaw123#2 ! 0; |O #dscaw123#3 ! 0; |O #dscaw123#4 ! 0; |O #dscaw123#5 ! 0;
         |PRINT;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Imprime;
#dscaw123#1;
;
INICIO;
FINAL;
;
NULL, Imprime;
|FIN;

|PROCESO Seleccion;
   |SI #dscaz160#16 = "N";
      |C_M #dscaz160#27, 1, "S"; |C_M #dscaz160#28, 1, "S";
      |PARA nCont = 17; |SI nCont [ 26; |HACIENDO nCont = nCont + 1;
         #dscaz160#nCont# = "zzzzz"; |PINTA #dscaz160#nCont#;
         |C_M #dscaz160#nCont#, 1, "N";
      |SIGUE;
   |SINO;
      #dscaz160#27 = "     "; |PINTA #dscaz160#27;
      #dscaz160#28 = "zzzzz"; |PINTA #dscaz160#28;
      |C_M #dscaz160#27, 1, "N"; |C_M #dscaz160#28, 1, "N";
      |PARA nCont = 17; |SI nCont [ 26; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz160#nCont#, 1, "S";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO MesLimite;
   |ATRI I;
   |SI #dscaz160#29 = 0;  |PINTA 1854, "TODOS     "; |FINSI;
   |SI #dscaz160#29 = 1;  |PINTA 1854, "ENERO     "; |FINSI;
   |SI #dscaz160#29 = 2;  |PINTA 1854, "FEBRERO   "; |FINSI;
   |SI #dscaz160#29 = 3;  |PINTA 1854, "MARZO     "; |FINSI;
   |SI #dscaz160#29 = 4;  |PINTA 1854, "ABRIL     "; |FINSI;
   |SI #dscaz160#29 = 5;  |PINTA 1854, "MAYO      "; |FINSI;
   |SI #dscaz160#29 = 6;  |PINTA 1854, "JUNIO     "; |FINSI;
   |SI #dscaz160#29 = 7;  |PINTA 1854, "JULIO     "; |FINSI;
   |SI #dscaz160#29 = 8;  |PINTA 1854, "AGOSTO    "; |FINSI;
   |SI #dscaz160#29 = 9;  |PINTA 1854, "SEPTIEMBRE"; |FINSI;
   |SI #dscaz160#29 = 10; |PINTA 1854, "OCTUBRE   "; |FINSI;
   |SI #dscaz160#29 = 11; |PINTA 1854, "NOVIEMBRE "; |FINSI;
   |SI #dscaz160#29 = 12; |PINTA 1854, "DICIEMBRE "; |FINSI;
   |ATRI N;

   |SI #dscaz160#29 = 0;
      fFechaLim = "31.12.9999";
   |SINO;
      fFechaLim = ~; aAlfa = fFechaLim; |QBF aAlfa;
      aAlfa = aAlfa % -104;
      aAlfa = "01." + (("00" + (#dscaz160#29 + 1)) % -102) + "." + aAlfa;
      nCalc = aAlfa; nCalc = nCalc - 1; fFechaLim = nCalc;
   |FINSI;
|FPRC;

|PROGRAMA;
   |HAZ Tipo8;

   |SI PARAMETRO = ""; PARAMETRO = "VENTAS"; |FINSI;

   |ABRE #dscaz160;
   |LEE 000#dscaz160.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscaz160;
      |GRABA 020#dscaz160.c;
   |FINSI;

   aAlfa = #48#16; |QBF aAlfa;
   aAlfa1 = aAlfa + "def/canempre.mas";
   |CARGA_DEF aAlfa1, canempre@;
   |SI FSalida ! 0;
      |MENAV "    Introduzca correctamente el camino a contabilidad en la empresa de cartera";
      |CIERRA #dscaz160; |HAZ Tipo9; |ACABA;
   |FINSI;

   aAlfa1 = aAlfa + "fich/"; |PATH_DAT #canempre@#aAlfa1#;
   |ABRE #canempre@;

   |CLS;
   |SI PARAMETRO = "VENTAS";
      nFactor  = 1;
      |CABEZA "Informe cotejo Cartera / Contabilidad (Ventas)";
      |PINPA #0#0; |PINDA #0#0;
      |ATRI R; |PINTA 0645, "(VENTAS)"; |ATRI N;
   |FINSI;
   |SI PARAMETRO = "COMPRAS";
      nFactor  = -1;
      |CABEZA "Informe cotejo Cartera / Contabilidad (Compras)";
      |PINPA #0#0; |PINDA #0#0;
      |ATRI R; |PINTA 0645, "(COMPRAS)"; |ATRI N;
   |FINSI;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#dscaz160.a;

      |SI #dscaz160#29 = 0;
         fFechaLim = "31.12.9999";
      |SINO;
         fFechaLim = ~; aAlfa = fFechaLim; |QBF aAlfa;
         aAlfa = aAlfa % -104;
         nCalc = #dscaz160#29 + 1;
         aAlfa = "01." + (("00" + nCalc) % -102) + "." + aAlfa;
         fFechaLim = aAlfa; nCalc = fFechaLim; nCalc = nCalc - 1;
         fFechaLim = nCalc;
      |FINSI;

      aAlfa = "t1" + Usuario; |NOME_DAT #dscaw123#aAlfa#;
      aAlfa = "t2" + Usuario; |NOME_DAT #dscaw124#aAlfa#;
      aAlfa = "t3" + Usuario; |NOME_DAT #dscaw125#aAlfa#;
      |DELINDEX #dscaw123; |ABRE #dscaw123;
      |DELINDEX #dscaw124; |ABRE #dscaw124;
      |DELINDEX #dscaw125; |ABRE #dscaw125;

      aAlfa = #48#16; |QBF aAlfa;
      aAlfa1 = aAlfa + "def/cacuenta.mas";
      |CARGA_DEF aAlfa1, cacuenta@;
      |SI FSalida = 0;
         nSwEmp = 1; nEmpresa = #dscaz160#0; nPeriodo = #dscaz160#1;  |HAZ SaldoCont;
         nSwEmp = 2; nEmpresa = #dscaz160#3; nPeriodo = #dscaz160#4;  |HAZ SaldoCont;
         nSwEmp = 3; nEmpresa = #dscaz160#6; nPeriodo = #dscaz160#7;  |HAZ SaldoCont;
         nSwEmp = 4; nEmpresa = #dscaz160#9; nPeriodo = #dscaz160#10; |HAZ SaldoCont;
         |DESCARGA_DEF #cacuenta@;
      |FINSI;

      |ABRE #dscam067; |ABRE #dscam012; |ABRE #dscam013;
      |SI PARAMETRO = "VENTAS";  |BUCLE RecibosVta; |FINSI;
      |SI PARAMETRO = "COMPRAS"; |BUCLE RecibosCmp; |FINSI;
      |CIERRA #dscam067; |CIERRA #dscam012; |CIERRA #dscam013;

      Impresora = "CrystalReport";
      |IMPRE -1;
      |SI FSalida = 0;
         |SI PARAMETRO = "VENTAS";
            aInforme = "Inf.cotejo contab./cartera VTA"; |HAZ ObtenInforme;
            |SI aInforme = "Inf.cotejo contab./cartera VTA";
               aInforme = "dscaz160";
            |FINSI;
         |FINSI;
         |SI PARAMETRO = "COMPRAS";
            aInforme = "Inf.cotejo contab./cartera CMP"; |HAZ ObtenInforme;
            |SI aInforme = "Inf.cotejo contab./cartera CMP";
               aInforme = "dscaz160";
            |FINSI;
         |FINSI;
         |INFOR aInforme;
         |SI FSalida = 0;
            |BUCLE Imprime;
            |PIEINF; |FININF;
         |FINSI;
         |FINIMP;
      |FINSI;

      |CIERRA #dscaw125; |DELINDEX #dscaw125;
      |CIERRA #dscaw124; |DELINDEX #dscaw124;
      |CIERRA #dscaw123; |DELINDEX #dscaw123;
   |FINSI;

   |CIERRA #dscaz160;

   |CIERRA #canempre@; |DESCARGA_DEF #canempre@;

   |HAZ Tipo9;
|FPRO;
