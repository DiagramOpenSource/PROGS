|FICHEROS;
   dscaz045 #0;
   dscaw033 #1;

   dscam008 #2;
   dscam021 #3;
   dscam046 #4;
   dscam049 #5;

   dscam003 #6;
   dscam012 #7;

   dscam014 #8;
   dscam051 #10;
   &cacuent@ #492;
|FIN;

|VARIABLES;
   &UltNivel   = 0;
   &nDeci_Div  = 0;
   &nDeci_Base = 0;
   &Divisa     = "";
   &HayConta   = 0;
   &Fichero   = "";  &Cmp = "";   &Tipo = ""; &CmpNum = 0;
   &aInforme   = "";

   &enSwCabBanco = 0;
   &enSwCabVto   = 0;
   &enSwCobros   = 0;
   &enSwPagos    = 0;
   &enSwTBanco   = 0;
   &enSwTVto     = 0;
   &enSwLinea    = 0;
   &FechaPago    = "";
   &TotalImp     = 0;
   &TotalVto     = 0;
   &Mensaje      = "";

   CtaBanco    = "";
   NombreBanco = "";
   VtoAnt      = @;
   BancoAnt    = "zzzzzzzzzzzz";
   Saldo       = 0;
   CobPag      = "";

   Primero = 1;
|FIN;

|PROCESO Imprime;

   FechaPago = #dscaw033#2;

   |SI Mensaje = "(CONTINUACION)";
      enSwCabBanco = 1; enSwCabVto   = 1;
      |SI #dscaw033#11 = "C"; enSwCobros = 1; |SINO; enSwPagos = 1; |FINSI;
      |PRINT; enSwCabVto   = 0; enSwCabBanco = 0;
      |SI #dscaw033#11 = "C"; enSwCobros = 0; |SINO; enSwPagos = 0; |FINSI;
      Mensaje = "              ";
   |FINSI;

   |SI BancoAnt ! #dscaw033#1;
      |SI Primero = 0;
         enSwTVto = 1; enSwTBanco = 1; |PRINT; enSwTBanco = 0; enSwTVto = 0;
         TotalVto = 0; TotalImp   = 0;
         enSwCabBanco = 1; enSwCabVto = 1;
         |SI #dscaw033#11 = "C"; enSwCobros = 1; |SINO; enSwPagos = 1; |FINSI;
         |PRINT;
         |SI #dscaw033#11 = "C"; enSwCobros = 0; |SINO; enSwPagos = 0; |FINSI;
         enSwCabVto   = 0; enSwCabBanco = 0;
      |SINO;
         enSwCabBanco = 1; enSwCabVto   = 1;
         |SI #dscaw033#11 = "C"; enSwCobros = 1; |SINO; enSwPagos = 1; |FINSI;
         |PRINT;
         |SI #dscaw033#11 = "C"; enSwCobros = 0; |SINO; enSwPagos = 0; |FINSI;
         enSwCabVto   = 0; enSwCabBanco = 0;
         Primero = 0;
      |FINSI;
      CobPag = #dscaw033#11;
      VtoAnt = #dscaw033#2;
      BancoAnt = #dscaw033#1;
   |FINSI;

   |SI VtoAnt ! #dscaw033#2;
      |SI Primero = 0;
         enSwTVto   = 1; |PRINT; enSwTVto   = 0;
         TotalVto = 0;
         enSwCabVto = 1;
         |SI #dscaw033#11 = "C"; enSwCobros = 1; |SINO; enSwPagos = 1; |FINSI;
         |PRINT; enSwCabVto = 0;
         |SI #dscaw033#11 = "C"; enSwCobros = 0; |SINO; enSwPagos = 0; |FINSI;
      |SINO;
         enSwCabVto = 1;
         |SI #dscaw033#11 = "C"; enSwCobros = 1; |SINO; enSwPagos = 1; |FINSI;
         |PRINT; enSwCabVto = 0;
         |SI #dscaw033#11 = "C"; enSwCobros = 0; |SINO; enSwPagos = 0; |FINSI;
         Primero = 0;
      |FINSI;
      CobPag = #dscaw033#11;
      VtoAnt = #dscaw033#2;
   |FINSI;

   |SI CobPag ! #dscaw033#11;
      enSwCabVto = 1; enSwPagos = 1; |PRINT; enSwPagos = 0; enSwCabVto = 0;
      CobPag = #dscaw033#11;
   |FINSI;

   enSwLinea = 1; |PRINT;
   |SI #dscaw033#11 = "C";
      TotalImp = TotalImp - #dscaw033#3;
      TotalVto = TotalVto - #dscaw033#3;
   |SINO;
      TotalImp = TotalImp + #dscaw033#3;
      TotalVto = TotalVto + #dscaw033#3;
   |FINSI;
   |SI enSwLinea < 0;
      Mensaje = "(CONTINUACION)";
   |SINO;
      Mensaje = "              ";
   |FINSI;
   enSwLinea = 0;

|FPRC;

|DEFBUCLE Imprime;
#dscaw033#2;
;
INICIO;
FINAL;
;
NULL,Imprime;
|FIN;

|PROCESO RellTempoCmp;
   |SI #dscam008#14 = "A"; |O #dscam008#14 = "D"; |ACABA; |FINSI;
   |SI #dscam008#31 = 0; |ACABA; |FINSI;

   |SI #dscam051#108 = "S";
      |SI #dscam008#17 ! 0;
         |SI #dscam008#73 < #dscaz045#0; |O #dscam008#73 > #dscaz045#1; |ACABA; |FINSI;
      |SINO;
         |SI #dscam008#3 < #dscaz045#0; |O #dscam008#3 > #dscaz045#1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI #dscam008#39 = " ";
      CtaBanco = "";
      NombreBanco = "";
      Saldo = 0;
   |FINSI;

   |SI #dscam008#39 = "P";
      #dscam021#0 = #dscam008#37;
      |LEE 000#dscam021.=;
      |SI FSalida = 0;
         CtaBanco = #dscam021#10;
         #dscam014#0 = #dscam021#3;
         |LEE 000#dscam014.=;
         |SI FSalida = 0;
            NombreBanco = #dscam014#1;
         |FINSI;
      |FINSI;
   |FINSI;

   |SI #dscam008#39 = "T";
      #dscam046#0 = #dscam008#37;
      |LEE 000#dscam046.=;
      |SI FSalida = 0;
         CtaBanco = #dscam046#10;
         #dscam014#0 = #dscam046#3;
         |LEE 000#dscam014.=;
         |SI FSalida = 0;
            NombreBanco = #dscam014#1;
         |FINSI;
      |FINSI;
   |FINSI;

   |SI #dscam008#39 = "C";
      #dscam049#0 = #dscam008#37;
      |LEE 000#dscam049.=;
      |SI FSalida = 0;
         CtaBanco = #dscam049#10;
         #dscam014#0 = #dscam049#3;
         |LEE 000#dscam014.=;
         |SI FSalida = 0;
            NombreBanco = #dscam014#1;
         |FINSI;
      |FINSI;
   |FINSI;

   |SI CtaBanco ! "";
      |SI #dscaz045#2 > CtaBanco; |O #dscaz045#3 < CtaBanco;
         |ACABA;
      |FINSI;
      Divisa = #dscaw033#6; |HAZ TomaDecim;
      Fichero = "Plan Contable"; Cmp = "Cuenta"; Tipo = "C"; |HAZ ObtenDato;
      #cacuent@#CmpNum# = CtaBanco;
      Fichero = "Plan Contable"; Cmp = "Digito"; Tipo = "C"; |HAZ ObtenDato;
      #cacuent@#CmpNum# = UltNivel;
      |LEE 000#cacuent@.=;
      Fichero = "Plan Contable"; Cmp = "Saldo Total"; Tipo = "C"; |HAZ ObtenDato;
      Saldo = #cacuent@#CmpNum#
   |FINSI;

   |DDEFECTO #dscaw033;
   #dscaw033#0  = #dscam008#40;
   #dscaw033#1  = CtaBanco;
   |SI #dscam051#108 = "S";
      |SI #dscam008#17 ! 0;
         #dscaw033#2  = #dscam008#73;
      |SINO;
         #dscaw033#2  = #dscam008#3;
      |FINSI;
   |SINO;
      #dscaw033#2  = #dscam008#3;
   |FINSI;
   #dscaw033#3  = #dscam008#25;
   #dscaw033#4  = #dscam008#56;
   #dscaw033#5  = #dscam008#32;
   #dscaw033#6  = #dscam008#59;
   #dscaw033#7  = NombreBanco;
   #dscaw033#8  = #dscam008#6;
   #dscaw033#9  = #dscam008#60;
   #dscaw033#10 = Saldo;
   #dscaw033#11 = "P";
   |GRABA 020#dscaw033.n;
|FPRC;

|DEFBUCLE RellTempoCmp;
#dscam008#3;
67;
#dscaz045#0, 000000001, #dscaz045#5;
#dscaz045#1, 999999999, #dscaz045#6;
;
NULL,RellTempoCmp;
|FIN;

|DEFBUCLE RellTempoCmp1;
#dscam008#1;
67;
000000001, #dscaz045#5;
999999999, #dscaz045#6;
;
NULL,RellTempoCmp;
|FIN;

|PROCESO RellTempoVnt;

   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         |SI #dscam003#71 < #dscaz045#0; |O #dscam003#71 > #dscaz045#1; |ACABA; |FINSI;
      |SINO;
         |SI #dscam003#3 < #dscaz045#0; |O #dscam003#3 > #dscaz045#1; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   |SI #dscam003#14 = "A"; |O #dscam003#14 = "D"; |ACABA; |FINSI;
   |SI #dscam003#31 = 0; |ACABA; |FINSI;

   |SI #dscam003#17 ! 0;
      #dscam012#0 = #dscam003#17;
      |LEE 000#dscam012.=;
      |SI FSalida = 0;
         CtaBanco = #dscam012#10;
         #dscam014#0 = #dscam012#3;
         |LEE 000#dscam014.=;
         |SI FSalida = 0;
            NombreBanco = #dscam014#1;
         |FINSI;
      |FINSI;
   |SINO;
      CtaBanco = "";
      NombreBanco = "";
      Saldo = 0;
   |FINSI;

   |SI CtaBanco ! "";
      |SI #dscaz045#2 > CtaBanco; |O #dscaz045#3 < CtaBanco;
         |ACABA;
      |FINSI;
      Divisa = #dscaw033#6; |HAZ TomaDecim;
      Fichero = "Plan Contable"; Cmp = "Cuenta"; Tipo = "C"; |HAZ ObtenDato;
      #cacuent@#CmpNum# = CtaBanco;
      Fichero = "Plan Contable"; Cmp = "Digito"; Tipo = "C"; |HAZ ObtenDato;
      #cacuent@#CmpNum# = UltNivel;
      |LEE 000#cacuent@.=;
      Fichero = "Plan Contable"; Cmp = "Saldo Total"; Tipo = "C"; |HAZ ObtenDato;
      Saldo = #cacuent@#CmpNum#
   |FINSI;

   |DDEFECTO #dscaw033;
   #dscaw033#0  = #dscam003#40;
   #dscaw033#1  = CtaBanco;
   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         #dscaw033#2  = #dscam003#71;
      |SINO;
         #dscaw033#2  = #dscam003#3;
      |FINSI;
   |SINO;
      #dscaw033#2  = #dscam003#3;
   |FINSI;
   #dscaw033#3  = #dscam003#30;
   #dscaw033#4  = #dscam003#64;
   #dscaw033#5  = #dscam003#32;
   #dscaw033#6  = #dscam003#57;
   #dscaw033#7  = NombreBanco;
   #dscaw033#8  = #dscam003#6;
   #dscaw033#9  = #dscam003#58;
   #dscaw033#10 = Saldo;
   #dscaw033#11 = "C";
   |GRABA 020#dscaw033.n;
|FPRC;

|DEFBUCLE RellTempoVnt;
#dscam003#2;
80;
#dscaz045#0, 000000001, #dscaz045#5;
#dscaz045#1, 999999999, #dscaz045#6;
;
NULL,RellTempoVnt;
|FIN;

|DEFBUCLE RellTempoVnt1;
#dscam003#1;
80;
000000001, #dscaz045#5;
999999999, #dscaz045#6;
;
NULL,RellTempoVnt;
|FIN;

|PROGRAMA;
   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |CLS;
   |HAZ Tipo8;
   |SI HayConta = 0;
      |MENAV "    Contabilidad no disponible";
      |HAZ Tipo9;
      |ACABA;
   |FINSI;

   |CABEZA "Listado situacion economica";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |IMPRE 0;
      |SI FSalida ! 0; |HAZ Tipo9; |ACABA; |FINSI;
      aInforme = "Listado situacion economica"; |HAZ ObtenInforme;
      |INFOR aInforme;
      |SI FSalida ! 0; |HAZ Tipo9; |ACABA; |FINSI;
      |DELINDEX #dscaw033; |ABRE #dscaw033;
      |ABRE #dscam014; |ABRE #dscam021; |ABRE #dscam046; |ABRE #dscam049;

      |SI #dscam051#108 = "S";
         |BUCLE RellTempoCmp1;
      |SINO;
         |BUCLE RellTempoCmp;
      |FINSI;

      |SI #dscam051#104 = "S";
         |BUCLE RellTempoVnt1;
      |SINO;
         |BUCLE RellTempoVnt;
      |FINSI;

      |BUCLE Imprime;
      |CIERRA #dscam014; |CIERRA #dscam021; |CIERRA #dscam046; |CIERRA #dscam049;
      |CIERRA #dscaw033;
      enSwTVto = 1; enSwTBanco = 1; |PRINT; enSwTBanco = 0; enSwTVto = 0;
      |PIEINF;
      |FININF;
      |FINIMP;
   |FINSI;
   |HAZ Tipo9;
|FPRO;
