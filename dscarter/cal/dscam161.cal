|FICHEROS;
   dscam161 #0;

   agif024@ #100;
|FIN;

|VARIABLES;
   aAlfa = "";
   aCliente =  "";

   nSwCli = 0;
   nLinea = 0;
   nTecla = 0;
|FIN;

|PROCESO AbreClientes;
   nSwCli = 0;
   aAlfa = #48#17; |QBF aAlfa;
   aAlfa = aAlfa + "def/agifa024.mas";
   |CARGA_DEF aAlfa, agif024@;
   |SI FSalida = 0;
      nSwCli = 1;
      aAlfa = #48#17; |QBF aAlfa;
      aAlfa = aAlfa + "fich/" + (("00000" + #48#15) % -105) + "/";
      |PATH_DAT #agif024@#aAlfa#; |ABRE #agif024@;
   |FINSI;
|FPRC;

|PROCESO CierraClientes;
   |SI nSwCli = 1;
      |CIERRA #agif024@; |DESCARGA_DEF #agif024@;
   |FINSI;
   nSwCli = 0;
|FPRC;

|PROCESO TomaDatosm100;
   nTecla = FSalida;
   |HAZ AbreClientes;
   |SI nSwCli = 1;
      |SI nTecla = 10;
         |CONSULTA_CLAVE #1#agif024@;

         #dscam161#1 = #agif024@#0;  |PINTA #dscam161#1;
         |ERROR;
      |FINSI;

      #agif024@#0 = #dscam161#1;
      |LEE 000#agif024@.=;
      |SI FSalida = 0;
         #dscam161#2 = #agif024@#2;  |PINTA #dscam161#2;
         #dscam161#3 = #agif024@#15; |PINTA #dscam161#3;
      |SINO;
         |MENAV "    Cliente inexistente"; |ERROR;
      |FINSI;
   |FINSI;
   |HAZ CierraClientes;

   nLinea = #dscam161#0; aCliente = #dscam161#1;
   |SALVA_FICHA #dscam161;
   |SELECT #2#dscam161;
   #dscam161#0 = aCliente;
   |LEE 000#dscam161.=;
   |PARA; |SI FSalida = 0; |Y #dscam161#0 = aCliente; |HACIENDO;
      |SI nLinea ! #dscam161#0;
         aAlfa = "    El cliente [" + #dscam161#1 + "] " + #dscam161#2; |QBF aAlfa;
         aAlfa = aAlfa + " ya existe";
         |MENAV aAlfa;
         |ERROR; |SAL;
      |FINSI;
      |LEE 000#dscam161.s;
   |SIGUE;
   |SELECT #1#dscam161;
   |REPON_FICHA #dscam161;
|FPRC;

|PROCESO CalculaRef;
   aAlfa = #dscam161#3 + #dscam161#4;
   #dscam161#5 = aAlfa; |PINTA #dscam161#5;
|FPRC;
