|FICHEROS;
   taglz001 #0;
   taglw001 #1;

   dscam023 #10;
   dscam024 #11;
   dscam003 #12;
   dscam044 #13;
   dscam045 #14;

   agifa024@ #100;
|FIN;

|VARIABLES;
   aAlfa   = "";
   aAlfa1  = "";
   aAntRep = "";

   nCont = 0;
   SwHay = 0;
   nEmpresa = 0;
|FIN;

|PROCESO RellenaTempo;
   SwHay = 0;
   |PARA nCont = 6; |SI nCont [ 15; |HACIENDO nCont = nCont + 1;
      |SI #taglz001#nCont# = #dscam003#0; SwHay = 1; |SAL; |FINSI;
   |SIGUE;

   |SI SwHay = 0; |ACABA; |FINSI;

   |SI #dscam003#14 = "D"; |O #dscam003#14 = "A"; |ACABA; |FINSI;

   #dscam023#0 = #dscam003#32;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam023;
      ||ACABA;
   |FINSI;

   |DDEFECTO #taglw001;
   #taglw001#0 = #dscam003#33;
   #taglw001#2 = #dscam003#32;
   |LEE 000#taglw001.=;
   |SI FSalida ! 0;
      |DDEFECTO #taglw001;
      #taglw001#0 = #dscam003#33;
      #taglw001#2 = #dscam003#32;
      |GRABA 020#taglw001.c;
   |FINSI;
   #taglw001#1 = #dscam003#34;
   #taglw001#3 = #dscam003#6;
   #taglw001#4 = #dscam003#81;
   #taglw001#5 = #agifa024@#204;
   #taglw001#6 = #taglw001#6 + #dscam003#64;
   #taglw001#7 = #dscam023#13 + #dscam023#15 + #dscam023#17;
   #taglw001#8 = #dscam023#20;
   #taglw001#9 = #dscam023#19 - #dscam023#20;
   |GRABA 020#taglw001.a;
|FPRC;

|DEFBUCLE RellenaTempo;
#dscam003#1;
32,33,4,46;
000000001,#taglz001#0,#taglz001#1,#taglz001#2,#dscam044#0;
999999999,#taglz001#3,#taglz001#4,#taglz001#5,#dscam044#0;
;
NULL,RellenaTempo;
|FIN;

|PROCESO Empresas;
   #dscam044#0 = #dscam045#0;
   |LEE 000#dscam044.=;
   |SI FSalida = 0;
      aAlfa = #dscam044#1; |QBF aAlfa;
      aAlfa1 = aAlfa + "def/agifa024.mas";
      |CARGA_DEF aAlfa1, agifa024@;
      |SI FSalida = 0;
         aAlfa1 = aAlfa + "fich/" + (("00000" + nEmpresa) % -105) + "/";
         |PATH_DAT #100 aAlfa;
         |ABRE #agifa024@;
         |BUCLE RellenaTempo;
         |CIERRA #agifa024@; |DESCARGA_DEF #agifa024@;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Empresas;
#dscam045#2;
2;
nEmpresa,"V";
nEmpresa,"V";
;
NULL,Empresas;
|FIN;

|PROCESO Impresion;
   |SI aAntRep ! #taglw001#0;
      |SI aAntRep ! "XXXX"; |PIEINF; |FINSI;
      aAntRep = #taglw001#0;
   |FINSI;
   |PRINT;
|FPRC;

|DEFBUCLE Impresion;
#taglw001#1;
;
INICIO;
FINAL;
;
NULL,Impresion;
|FIN;

|PROGRAMA;
   |ABRE #taglz001;
   |LEE 000#taglz001.p;
   |SI FSalida ! 0;
      |DDEFECTO #taglz001; |GRABA 020#taglz001.c;
   |FINSI;

   |CLS;
   |CABEZA "Informe de riesgos por representante";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#taglz001.a;

      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |INFOR "taglz001";
      |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

      |DFICB aAlfa; |QBF aAlfa;
      |PATH_DAT #13 aAlfa; |PATH_DAT #14 aAlfa;

      |DELINDEX #taglw001; |ABRE #taglw001;
      |ABRE #dscam044; |ABRE #dscam023;
      nEmpresa = #48#0; |BUCLE Empresas;
      aAntRep = "XXXX"; |BUCLE Impresion;
      |CIERRA #dscam044; |CIERRA #dscam023;
      |CIERRA #taglw001;

      |PIEINF; |FININF;
      |FINIMP;
   |FINSI;
   |CIERRA #taglz001;
|FPRO;
