|FICHEROS;
   dscaz116 #0;
   dscam003 #10;
   dscam004 #11;
   agis0002@ #1000;
   agifa010@ #1001;
   agifa025@ #1002;
   agifa041@ #1003;
|FIN;

|VARIABLES;
   aAlfa = "";

   nTecla  = 0;
   nCalc   = 0;
   nHandle = 0;
|FIN;

|PROCESO Recibos;
   |SI #dscam003#14 = "L"; |Y #dscam003#55 = 0; |Y #dscam003#68 = 0;
      #dscam003#14 = "e"; #dscam003#15 = "Pendiente de compensar";
      #dscam003#30 = #dscam003#22; #dscam003#64 = #dscam003#60;
      #dscam003#23 = #dscam003#22; #dscam003#61 = #dscam003#60;
      #dscam003#31 = 0;            #dscam003#65 = 0;
   |FINSI;

   #agifa010@#52 = #dscam003#0;
   #agifa010@#0  = #dscam003#1;
   |LEE 000#agifa010@.=;
   |SI FSalida ! 0; |DDEFECTO #agifa010@; |FINSI;

   #agifa025@#0 = #agifa010@#6;
   |LEE 000#agifa025@.=;
   |SI FSalida ! 0; |DDEFECTO #agifa025@; |FINSI;

   #agis0002@#30 = "A";
   #agis0002@#20 = #dscam003#0;
   #agis0002@#17 = #dscam003#1;
   #agis0002@#18 = #dscam003#2;
   |LEE 000#agis0002@.=;
   |SI FSalida = 0; |Y #agis0002@#7 = #dscam003#4;
      #dscam003#26 = #agis0002@#16;
      #dscam003#33 = #agifa010@#6;
      #dscam003#34 = #agifa025@#1;
      #dscam003#30 = #dscam003#22; #dscam003#64 = #dscam003#60;
      #dscam003#23 = #dscam003#22; #dscam003#61 = #dscam003#60;
      #dscam003#31 = 0;            #dscam003#65 = 0;

      |GRABA 020#dscam003.a;

      #dscam004#17 = #dscam003#40;
      #dscam004#3  = 1;
      |LEE 000#dscam004.];
      |PARA; |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40; |HACIENDO;
         |SI #dscam004#5 = "RAC"; |SAL; |FINSI;
         |LEE 000#dscam004.s;
      |SIGUE;

      |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40; |Y #dscam004#5 = "RAC";
         #dscam004#6 = #dscam003#26;
         #dscam004#8 = #dscam003#22; #dscam004#26 = #dscam003#60;
         |GRABA 020#dscam004.a;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Recibos;
#dscam003#6;
;
00, "     ", 000000, 000, "A", 000000001;
99, "zzzzz", 999999, 999, "A", 999999999;
be;
NULL,Recibos;
|FIN;

|PROCESO MiraSiGestion;
   aAlfa = #0#0; |QBF aAlfa;
   aAlfa = aAlfa + "def/agifa041.mas";
   |XABRE "E", aAlfa, nHandle;
   |SI FSalida ! 0;
      |MENAV "    No existe aplicacion"; |ERROR;
   |FINSI;
|FPRC;

|PROCESO MiraEmpGestion;
   nTecla = FSalida;

   aAlfa = #0#0; |QBF aAlfa;
   aAlfa = aAlfa + "def/agifa041.mas";
   |CARGA_DEF aAlfa, agifa041@;
   |SI FSalida = 0;
      aAlfa = #0#0; |QBF aAlfa; aAlfa = aAlfa + "fich/"
      |PATH_DAT #1003 aAlfa;
      |ABRE #agifa041@;
      #agifa041@#0 = #0#1;
      |SI nTecla = 10;
         |LEE 000#agifa041@.];
         |CONSULTA_CLAVE #1#agifa041@;
         #dscaz116#1 = #agifa041@#0; |PINTA #dscaz116#1;
      |FINSI;
      #agifa041@#0 = #dscaz116#1;
      |LEE 000#agifa041@.=;
      |SI FSalida ! 0;
         |MENAV "    Empresa inexistente"; |ERROR;
      |SINO;
         |PINTA 1117, #agifa041@#1;
      |FINSI;
      |CIERRA #agifa041@; |DESCARGA_DEF #agifa041@;
   |FINSI;
|FPRC

|PROGRAMA;
   |CLS;
   |CABEZA "Recalculo entregas a cuenta";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      aAlfa = #0#0; |QBF aAlfa;
      aAlfa = aAlfa + "def/agis0002.mas";
      |CARGA_DEF aAlfa, agis0002@;
      |SI FSalida = 0;
         aAlfa = #0#0; |QBF aAlfa;
         aAlfa = aAlfa + "def/agifa010.mas";
         |CARGA_DEF aAlfa, agifa010@;
         |SI FSalida = 0;
            aAlfa = #0#0; |QBF aAlfa;
            aAlfa = aAlfa + "def/agifa025.mas";
            |CARGA_DEF aAlfa, agifa025@;
            |SI FSalida = 0;
               aAlfa = #0#0; |QBF aAlfa;
               aAlfa = aAlfa + "fich/" + (("00000" + #0#1) % -105) + "/";
               |PATH_DAT #1000 aAlfa; |PATH_DAT #1001 aAlfa;
               |ABRE #agis0002@; |ABRE #agifa010@;
               |BUCLE Recibos;
               |CIERRA #agifa010@; |CIERRA #agis0002@; |CIERRA #agifa025@;
               |DESCARGA_DEF #agifa025@;
            |FINSI;
            |DESCARGA_DEF #agifa010@;
         |FINSI;
         |DESCARGA_DEF #agis0002@;
      |FINSI;
   |FINSI;
|FPRO;
