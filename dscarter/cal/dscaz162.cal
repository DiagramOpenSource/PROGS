|FICHEROS;
     dscaz162 #0;   || Este
|FIN;


|VARIABLES;
     org     = "";
     alfa1   = "";
     alfa2   = "";
     alfa3   = "";
     alfa4   = "";
     nume1   = 0;
     nume2   = 0;
     para1   = 0;

     dir       = "";
     dir_fich  = "";
     list      = "";
     empresa_o = "";
     empresa_d = "";
     swlistados = 0;
     nomlistado = "";
     field      = "";
     fichero1   = "";
     fichero2   = "";
     aEmp       = "";
|FIN;


|PROCESO Compru; |TIPO 0;
     |DFICE aEmp;
     aEmp = aEmp % -205;
     |SI #0#0 = aEmp;
          |MENAV "0000La empreda destino no puede ser la actual...";
          |ERROR;
     |FINSI;
|FPRC;


|PROCESO inicio; |TIPO 3;

 |SI #0#1 ! "SI"; |ACABA; |FINSI;

|| ........ Leer Directorios empresa_o y empresa_d;

  |DFICE empresa_o;
  |DBASE dir_fich;
  dir_fich = dir_fich + "fich/";
  dir = #0#0;  dir = "00000" + dir;  dir = dir % -105;
  empresa_d = dir_fich + dir + "/";

  list  = "*.dir";
  |HAZ leecopia;
  list  = "lis*.*";
  |HAZ leecopia;
|FPRC;

|PROCESO leecopia;
  alfa4 = empresa_o + list;
  |_PDIR alfa4;
  |PARA; |SI FSalida = 0; |HACIENDO;
       alfa1 = alfa4 % 0;   nume1 = alfa1;
       |PARA para1 = nume1; |SI para1 ] 1; |HACIENDO para1 = para1 - 1;
             nume1 = (para1 * 100) + 1;
             alfa1 = alfa4 % nume1;
             |SI alfa1 = "/";
                 nume2 = para1 + 1;
                 |SAL;
             |FINSI;
       |SIGUE;
       nomlistado = alfa4 % nume2;
       |HAZ copiando;
       FSalida = 0;
   |_SDIR alfa4;
   |SIGUE;
|FPRC;

|PROCESO copiando;

 alfa3 = "2400Copiando " + nomlistado;
 |ATRI P;
 |MENSA alfa3;
 |ATRI 0;

 fichero1 = empresa_o + nomlistado;
 fichero2 = empresa_d + nomlistado;
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa3 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa3;
 |FINSI;

 |ATRI N;
 |BLIN 24;
 |ATRI 0;
|FPRC;
