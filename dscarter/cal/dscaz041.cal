|FICHEROS;
   dscaz041 #0;

   dscam003 #1;
   dscam004 #2;
   dscaw059 #3,MANTE;
   dscaw112 #4,MANTE;
   dscam051 #10;
   dscam030 #11;
   dscam043 #12;
   dscam165 #13;
   dscaw221 #14,MANTE;

   dscam008 #51;
   dscam009 #52;
   dscam021 #53;
   dscam022 #54;
   dscam014 #55;

   dscaw013 #50;

   &agif024@ #100;
   &agif324@ #101;
   &agif112@ #102;
   &caclipr@ #103;

   canempre@ #500;
   cajainca@ #501;
   cajainli@ #502;
   caconasi@ #503;
   cacuenta@ #504;
|FIN;

|VARIABLES;
   aPath = "";
   nEmp = 0;
   nEmpCon = 0;
   nPerCon = 0;
   aSerCob = "";
   nPerCob = 0;
   fFecCob = @;
   &eaFichClas = "";  &eaTipoClas = ""; &enSwClas = 0;
   &enExistOblig = 0;

   &Fichero   = "";  &Cmp = "";     &Tipo = ""; &CmpNum = 0;
   &aInforme  = "";  &eaCuenta = "";
   &nDeci_Base = 0;  &nDeci_Div = 0; &Divisa = ""; &efFechaDiv = @;
   &CambioDivVn = 0; &CambioDivCm = 0; &NombreDiv = "";
   &MaxDigit = 0;    &MonedaConta = "";
   &HayGestion = 0;  &HayConta = 0;
   &DCampoG = 0;  &HCampoG = 0;  &DCampoC = 0;  &HCampoC = 0;

   &CodCliente = "";  &TipoCliente = ""; &CtaCliente = ""; &Nombre = "";
   &CodProveedor = "";  &TipoProveedor = ""; &CtaProveedor = ""; &UltNivel = 0;

   &enEmpCartera = 0; &enEmpGestion = 0; SwError = 0;
   &eaSerie = ""; &eaCliGest = ""; &nImporte = 0; &eaTipoOper = "";

   Comodin = "";
   aParte1 = ""; nParte1 = 0;
   aParte2 = ""; nParte2 = 0;
   aLong   = "";
   aCodEnl = "";
   aResp   = "";
   aResp1  = "";

   aAlfa   = "";


   nTecla      = 0;
   nSwLuxe     = 0;
   nLong       = 0;
   Calc        = 0;
   nCalc       = 0;
   NumEntregas = 0;
   ModoEntrada = 0;
   NumDoc      = 0;
   Linea       = 0;
   nSalida     = 0;

   nAnyo       = 0;
   nApunte     = 0;
   nCont       = 0;
   nSwNoEnlace = 0;
|FIN;

|PROCESO AntesCodigo; |TIPO 7;
   |SI FSalida = 2; |BLIN 4; |FINSI;
   |SI aResp = "C";
      |SI aResp1 = "G";
         |MENSA "    <F2> Consulta de codigos de cliente";
      |SINO;
         |MENSA "    <F2> Consulta de cuentas de cliente";
      |FINSI;
   |SINO;
      |SI aResp1 = "G";
         |MENSA "    <F2> Consulta de codigos de proveedor";
      |SINO;
         |MENSA "    <F2> Consulta de cuentas de proveedor";
      |FINSI;
   |FINSI;

   |SI nSwLuxe = 1; |Y aResp1 = "G";
      |SI Campo = 22;
         |MENSA "    <F2> Consulta de cuentas contables";
      |FINSI;

      |C_M #dscaz041#2, 1, "N"; |C_V #dscaz041#2, 1, "N";
      |C_M #dscaz041#22, 1, "S"; |C_V #dscaz041#22, 1, "S";
      |C_L #dscaz041#22, 1, "S"; |C_P #dscaz041#22, 1, 1215;

      |SI #dscaz041#22 = "            ";
         |SI aResp = "C";
            Fichero = "Clientes"; Cmp = "Codigo Cliente"; Tipo = "G"; |HAZ ObtenDato;
            #agif024@#CmpNum# = #dscaz041#1;
            |LEE 000#agif024@.=;
            |SI FSalida = 0; |Y #agif024@#CmpNum# ! "      "; |Y Campo = 22;
               Fichero = "Clientes"; Cmp = "Cuenta Contable"; Tipo = "G"; |HAZ ObtenDato;
               aAlfa = #agif024@#CmpNum#; |QBF aAlfa;
               aAlfa = aAlfa % 0499; aAlfa = "438" + aAlfa; #dscaz041#22 = aAlfa;
            |FINSI;
         |FINSI;
         |SI aResp = "P";
            Fichero = "Proveedores"; Cmp = "Codigo Proveedor"; Tipo = "G"; |HAZ ObtenDato;
            #agif112@#CmpNum# = #dscaz041#1;
            |LEE 000#agif112@.=;
            |SI FSalida = 0; |Y #agif112@#CmpNum# ! "      "; |Y Campo = 22;
               Fichero = "Proveedores"; Cmp = "Cuenta Contable"; Tipo = "G"; |HAZ ObtenDato;
               aAlfa = #agif112@#CmpNum#; |QBF aAlfa;
               aAlfa = aAlfa % 0499; aAlfa = "407" + aAlfa; #dscaz041#22 = aAlfa;
            |FINSI;
         |FINSI;
      |FINSI;
   |SINO;
      |C_M #dscaz041#2, 1, "S"; |C_V #dscaz041#2, 1, "S";
      |C_M #dscaz041#22, 1, "N"; |C_V #dscaz041#22, 1, "N";
   |FINSI;
|FPRC;

|PROCESO AltaCuenta;
   aAlfa = #48#16; |QBF aAlfa; aAlfa = aAlfa + "def/cacuenta.mas";
   |CARGA_DEF aAlfa, cacuenta@;
   |SI FSalida = 0;
      aAlfa = #48#16; |QBF aAlfa;
      aAlfa = aAlfa + "fich/" + (("00000" + #48#14) % -105) + #48#19 + "/";
      |PATH_DAT #cacuenta@#aAlfa#; |ABRE #cacuenta@;
      #cacuenta@#0 = #dscaz041#22;
      |LEE 000#cacuenta@.=;
      |SI FSalida ! 0;
         aAlfa = #48#16; |QBF aAlfa;
         aAlfa = aAlfa + "fich/" + (("00000" + #48#14) % -105) + #48#19 + "/";
         aAlfa = aAlfa + "," + #dscaz041#22;
         aAlfa = ":contagen/caaltcue.tab;" + aAlfa;
         |SUB_EJECUTA aAlfa;
      |FINSI;
      |CIERRA #cacuenta@; |DESCARGA_DEF #cacuenta@;
   |FINSI;
|FPRC;

|PROCESO MiraCuentaLuxe;
   |SI aResp1 = "C"; |ACABA; |FINSI;

   nTecla = FSalida;
   eaCuenta = #dscaz041#22;
   FSalida = nTecla;
   TipoCliente = "C"; |HAZ ExisteCuenta;
   |SI TipoCliente = "ERROR";
      |HAZ AltaCuenta;
   |SINO;
      |SI eaCuenta ! #dscaz041#22; |Y nTecla = 10;
         #dscaz041#22 = eaCuenta;
      |FINSI;
   |FINSI;
   |PINTA #dscaz041#22;
|FPRC;

|PROCESO MiraCodigo;
   |SI nSwLuxe = 1; |Y aResp1 = "G";
      |SI Campo = 2; |BLIN 4; |ACABA; |FINSI;
   |FINSI;

   DCampoG = 1; HCampoG = 1;
   DCampoC = 2; HCampoC = 2;
   Comodin = #dscaz041#1; |QBF Comodin;
   Comodin = ("000000" + Comodin) % -106; #dscaz041#1 = Comodin; |PINTA #dscaz041#1;
   |SI aResp = "C";
      |SI aResp1 = "G"; CodCliente = #dscaz041#1; |FINSI;
      |SI aResp1 = "C"; CodCliente = #dscaz041#2; |FINSI;
      TipoCliente = aResp1; |HAZ ExisteCliente;
      |SI TipoCliente = "ERROR"; |ERROR; |ACABA; |FINSI;
   |SINO;
      |SI aResp1 = "G"; CodProveedor = #dscaz041#1; |FINSI;
      |SI aResp1 = "C"; CodProveedor = #dscaz041#2; |FINSI;
      TipoProveedor = aResp1; |HAZ ExisteProveedor;
      |SI TipoProveedor = "ERROR"; |ERROR; |ACABA; |FINSI;
   |FINSI;

   |SI Campo = 1;
      |SI aResp1 = "G";
         |SI aResp = "C";
            Fichero = "Clientes"; Cmp = "Codigo Cliente"; Tipo = "G";
            |HAZ ObtenDato; #dscaz041#1 = #agif024@#CmpNum#; |PINTA #dscaz041#1;
         |SINO;
            Fichero = "Proveedores"; Cmp = "Codigo Proveedor"; Tipo = "G";
            |HAZ ObtenDato; #dscaz041#1 = #agif112@#CmpNum#; |PINTA #dscaz041#1;
         |FINSI;
      |FINSI;
   |SINO;
      |SI aResp1 = "C";
         Fichero = "Clientes/Proveedores"; Cmp = "Cuenta Contable"; Tipo = aResp1;
         |HAZ ObtenDato; #dscaz041#2 = #caclipr@#CmpNum#;
         |PINTA #dscaz041#2;
      |FINSI;
   |FINSI;
   |SI Campo = 1;
      |SI aResp1 = "G";
         |SI aResp = "C";
            Fichero = "Clientes"; Cmp = "Nombre Cliente";  Tipo = "G";
         |SINO;
            Fichero = "Proveedores"; Cmp = "Nombre Comercial";  Tipo = "G";
         |FINSI;
      |FINSI;
   |SINO;
      |SI aResp1 = "C";
         Fichero = "Clientes/Proveedores"; Cmp = "Razon Social"; Tipo = aResp1;
      |FINSI;
   |FINSI;
   |HAZ ObtenDato;
   |SI aResp1 = "G";
      |SI aResp = "C";
         #dscaz041#3 = #agif024@#CmpNum#;
      |SINO;
         #dscaz041#3 = #agif112@#CmpNum#;
      |FINSI;
   |SINO;
      #dscaz041#3 = #caclipr@#CmpNum#;
   |FINSI;
   |PINTA #dscaz041#3;

   |SI Campo = 1;
      |SI aResp1 = "G";
         Fichero = "Clientes"; Cmp = "Divisa Defecto"; Tipo = "G";
         |HAZ ObtenDato; #dscaz041#6 = #agif024@#CmpNum#; |PINTA #dscaz041#6;
      |FINSI;
   |SINO;
      |SI MonedaConta = "P";
         #dscaz041#6 = "ESP";
      |SINO;
         #dscaz041#6 = "EUR";
      |FINSI;
   |FINSI;

   efFechaDiv = #dscaz041#4;
   Divisa = #dscaz041#6; |HAZ TomaDecim;
   |SI NombreDiv = "ERROR";
      |MENAV "    Divisa inexistente"; |ERROR;
   |SINO;
      #dscaz041#17 = NombreDiv; |PINTA #dscaz041#17;
      #dscaz041#7 = CambioDivVn;
   |FINSI;

   |BLIN 4;
|FPRC;

|PROCESO TomaDivisa;
   |SI #dscaz041#6 ! Contenido;
      efFechaDiv = #dscaz041#4;
      Divisa = #dscaz041#6; |HAZ TomaDecim;
      |SI NombreDiv = "ERROR";
         |MENAV "    Divisa inexistente"; |ERROR;
      |SINO;
         #dscaz041#17 = NombreDiv; |PINTA #dscaz041#17;
         #dscaz041#7 = CambioDivVn;
      |FINSI;
   |FINSI;
|FPRC;

|RUTINA inf041;
   #dscaz041#0 = 001;
|FRUT;

|RUTINA sup041;
   #dscaz041#0 = 999;
|FRUT;

|PROCESO CtrlConta;
     |SI aSerCob ] #dscam043#7; |Y aSerCob [ #dscam043#8;
          #canempre@#2 = #dscam043#0;
          #canempre@#3 = #dscam043#1;
          |LEE 000#canempre@.=;
          |SI FSalida = 0;
               nAnyo = #canempre@#26;
               |SI nAnyo > 80;
                    nAnyo = nAnyo + 1900;
               |SINO;
                    nAnyo = nAnyo + 2000;
               |FINSI;
               aAlfa = fFecCob;
               aAlfa = aAlfa % -104; nCalc = aAlfa;
               |SI nAnyo = nCalc;
                    |SI #canempre@#34 > fFecCob;
                              |Y #canempre@#34 ! "01.01.0000";
                         aAlfa = "0000Empresa contable bloqueada a fecha " + #canempre@#34;
                         |MENAV aAlfa;
                    |SINO;
                         nEmpCon = #dscam043#0;
                         nPerCon = #dscam043#1;
                    |FINSI;
                    |ERROR10;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE CtrlConta;
     #dscam043#2;
     3;
     nEmp, "V";
     nEmp, "V";
     ;
     NULL, CtrlConta;
|FIN;

|PROCESO LineaCaja;
    nEmpCon = 0;
    |DBASS aPath;
    aAlfa = aPath + "contagen/def/canempre.mas";
    |CARGA_DEF aAlfa, canempre@;
    |SI FSalida = 0;
          aAlfa = aPath + "contagen/fich/";
          |PATH_DAT #canempre@#aAlfa#;
          |ABRE #canempre@;
          |DFICB aAlfa;
          |PATH_DAT #dscam043#aAlfa#;
          nEmp = #48#0;
          |BUCLE CtrlConta;
          |SI nEmpCon = 0;
               |MENAV "0000No encuentro la empresa contable asociada a esta empresa de cartera.";
          |SINO;
               |HAZ LineaCaja0;
          |FINSI;
          |CIERRA #canempre@;
          |DESCARGA_DEF #canempre@;
     |FINSI;
|FPRC;

/*
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/def/canempre.mas";
   |CARGA_DEF aAlfa, canempre@;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa; aAlfa = aAlfa + "contagen/fich/";
      |PATH_DAT #canempre@#aAlfa#;
      |ABRE #canempre@;

      |DFICB aAlfa; |QBF aAlfa; |PATH_DAT #dscam043#aAlfa#;
      |ABRE #dscam043;
      |SELECT #2#dscam043;
      #dscam043#9 = #48#0;
      |LEE 000#dscam043.];
      |PARA; |SI FSalida = 0; |HACIENDO;
         #canempre@#2 = #dscam043#0;
         #canempre@#3 = #dscam043#1;
         |LEE 000#canempre@.=;
         |SI FSalida = 0;
            nAnyo = #canempre@#26;
            |SI nAnyo > 80;
               nAnyo = nAnyo + 1900;
            |SINO;
               nAnyo = nAnyo + 2000;
            |FINSI;
            aAlfa = #dscam004#6; |QBF aAlfa;
            aAlfa = aAlfa % -104; nCalc = aAlfa;
            |SI nAnyo = nCalc;
                    |Y #dscam004#0 ] #dscam043#7; |Y #dscam004#0 [ #dscam043#8;
                    |Y #dscam043#3 = "V";
               |SI #canempre@#34 > #dscam004#6; |Y #canempre@#34 ! "01.01.0000";
                  aAlfa = "    Empresa contable bloqueada a fecha " + #canempre@#34;
                  |MENAV aAlfa;
               |SINO;
                  |SAL;
               |FINSI;
            |FINSI;
         |FINSI;
         |LEE 000#dscam043.s;
      |SIGUE;

      |SI FSalida ! 0; |O nAnyo ! nCalc; |O #dscam004#0 < #dscam043#7; |O #dscam004#0 > #dscam043#8;
         |MENAV "    No encuentro la empresa contable asociada a esta empresa de cartera.";
         |SELECT #1#dscam043; |CIERRA #dscam043;
         |CIERRA #canempre@; |DESCARGA_DEF #canempre@;
         |ACABA;
      |SINO;
         |SI #canempre@#34 > #dscam004#6; |Y #canempre@#34 ! "01.01.0000";
            |MENAV "    No encuentro la empresa contable asociada a esta empresa de cartera.";
            |SELECT #1#dscam043; |CIERRA #dscam043;
            |CIERRA #canempre@; |DESCARGA_DEF #canempre@;
            |ACABA;
         |FINSI;
      |FINSI;
      |SELECT #1#dscam043;
      |CIERRA #dscam043;
*/

|PROCESO LineaCaja0;
     |ABRE #dscam165;
     |LEE 000#dscam165.p;
     |SI FSalida ! 0; |DDEFECTO #dscam165; |FINSI;
     |CIERRA #dscam165;

     |DBASS aAlfa; |QBF aAlfa;
     aAlfa = aAlfa + "contagen/def/cajainca.mas";
     |CARGA_DEF aAlfa, cajainca@;
     |SI FSalida = 0;
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "contagen/def/cajainli.mas";
         |CARGA_DEF aAlfa, cajainli@;
         |SI FSalida = 0;
            |DBASS aAlfa; |QBF aAlfa;
            aAlfa = aAlfa + "contagen/def/caconasi.mas";
            |CARGA_DEF aAlfa, caconasi@;
            |SI FSalida = 0;
               |DBASS aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + "contagen/fich/" + (("00000" + nEmpCon) % -105) + nPerCon + "/";
               |PATH_DAT #cajainca@#aAlfa#;
               |PATH_DAT #cajainli@#aAlfa#;
               |PATH_DAT #caconasi@#aAlfa#;

               |ABRE #cajainca@;
               |ABRE #cajainli@;
               |ABRE #caconasi@;

               #canempre@#2 = #dscam043#0;
               #canempre@#3 = #dscam043#1;
               |LEE 000#canempre@.=;
               |SI FSalida ! 0; |DDEFECTO #canempre@; |FINSI;

               #cajainca@#1 = #dscam004#6;
               |LEE 101#cajainca@.=;
               |SI FSalida ! 0;
                  |DDEFECTO #cajainca@;
                  #cajainca@#0 = #dscam165#1;
                  #cajainca@#1 = #dscam004#6;

                  |DDEFECTO #caconasi@;
                  |LEE 101#caconasi@.p;
                  |SI FSalida = 0;
                     #caconasi@#1 = #caconasi@#1 + 1;
                     #cajainca@#4 = #caconasi@#1;
                     |GRABA 020#caconasi@.a; |LIBERA #caconasi@;
                  |FINSI;

                  |GRABA 020#cajainca@.b;
               |FINSI;

               nApunte = 1;
               #cajainli@#1 = #cajainca@#1;
               #cajainli@#3 = 1;
               |LEE 000#cajainli@.];
               |PARA; |SI FSalida = 0; |Y #cajainli@#1 = #cajainca@#1; |HACIENDO;
                  nApunte = #cajainli@#3 + 1;
                  |LEE 000#cajainli@.s;
               |SIGUE;
               |DDEFECTO #cajainli@;
               #cajainli@#0 = #cajainca@#0;
               #cajainli@#1 = #cajainca@#1;
               #cajainli@#2 = #cajainca@#4;
               #cajainli@#3 = nApunte;
               |SI aResp = "C";
                    #cajainli@#4 = #dscam003#5; || Cuenta Cliente
               |SINO;
                    #cajainli@#4 = #dscam008#5; || Cuenta Cliente
               |FINSI;
               aAlfa = #dscam004#4; |QBF aAlfa;
               aLong = aAlfa % 0; nLong = aLong;
               #cajainli@#5 = 0;

               |PARA nCont = 14; |SI nCont [ 19; |HACIENDO nCont = nCont + 1;
                  |SI nLong = #canempre@#nCont#;
                     #cajainli@#5 = nCont - 13; |SAL;
                  |FINSI;
               |SIGUE;
               |SI aResp = "C";
                    #cajainli@#6  = #dscam165#2;
               |SINO;
                    #cajainli@#6  = #dscam165#4;
               |FINSI;

               |SI aResp = "C";
                    aAlfa = #dscam165#3; |QBF aAlfa; aAlfa = aAlfa + " ENTREGA N§" + #dscam004#17;
                    #cajainli@#7  = aAlfa;
                    #cajainli@#8  = "C";
                    #cajainli@#9  = #dscam004#8;
                    #cajainli@#13 = "C";
                    #cajainli@#14 = #dscam003#27;
                    #cajainli@#15 = #dscam003#1;
                    #cajainli@#16 = #dscam003#0;
                    #cajainli@#17 = #dscam003#2;

                    #cajainca@#3 = #cajainca@#3 + #cajainli@#9;

                    #dscam004#56 = nApunte;
               |SINO;
                    aAlfa = #dscam165#5; |QBF aAlfa; aAlfa = aAlfa + " ENTREGA N§" + #dscam009#14;
                    #cajainli@#7  = aAlfa;
                    #cajainli@#8  = "P";
                    #cajainli@#9  = #dscam009#8;
                    #cajainli@#13 = "P";
                    #cajainli@#14 = #dscam008#27;
                    #cajainli@#15 = #dscam008#1;
                    #cajainli@#16 = #dscam008#0;
                    #cajainli@#17 = #dscam008#2;

                    #cajainca@#2 = #cajainca@#2 + #cajainli@#9;

                    #dscam009#38 = nApunte;
               |FINSI;
               |GRABA 020#cajainli@.n;

               |GRABA 020#cajainca@.a;

               |CIERRA #cajainli@;
               |CIERRA #cajainca@;
               |CIERRA #caconasi@;
               |DESCARGA_DEF #caconasi@;
            |FINSI;
            |DESCARGA_DEF #cajainli@;
         |FINSI;
         |DESCARGA_DEF #cajainca@;
     |FINSI;
|FPRC;

|PROCESO VolcadoCli;
   |LEE 000#dscam003.u;
   NumDoc = #dscam003#40 + 1;
   |DDEFECTO #dscam003;
   #dscam003#40 = NumDoc;
   |GRABA 020#dscam003.b;

   |SI aResp1 = "G";
      Fichero = "Clientes"; Cmp = "Codigo Cliente"; Tipo = "G"; |HAZ ObtenDato;
      #agif024@#CmpNum# = #dscaz041#1;
      |LEE 000#agif024@.=;
      |SI FSalida = 0; |Y #agif024@#CmpNum# ! "      ";
         Fichero = "Clientes"; Cmp = "Cuenta Contable"; Tipo = "G"; |HAZ ObtenDato;
         |SI nSwLuxe = 1;
            #dscam003#5 = #dscaz041#22;
         |SINO;
            #dscam003#5  = #agif024@#CmpNum#;
         |FINSI;
         Fichero = "Clientes"; Cmp = "Nombre Cliente";  Tipo = "G"; |HAZ ObtenDato;
         #dscam003#6  = #agif024@#CmpNum#;
         Fichero = "Clientes"; Cmp = "Banco Domiciliacion";  Tipo = "G"; |HAZ ObtenDato;
         #dscam003#7  = #agif024@#CmpNum#;
         Fichero = "Clientes"; Cmp = "Entidad Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam003#8  = #agif024@#CmpNum#;
         Fichero = "Clientes"; Cmp = "Sucursal Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam003#9  = #agif024@#CmpNum#;
         Fichero = "Clientes"; Cmp = "DC Cuenta Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam003#10 = #agif024@#CmpNum#;
         Fichero = "Clientes"; Cmp = "Num.Cuenta Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam003#11 = #agif024@#CmpNum#;
      |FINSI;
   |SINO;
      Fichero = "Clientes/Proveedores"; Cmp = "Cliente/Proveedor"; Tipo = "C"; |HAZ ObtenDato;
      #caclipr@#CmpNum# = "C";
      Fichero = "Clientes/Proveedores"; Cmp = "Cuenta Contable"; Tipo = "C"; |HAZ ObtenDato;
      #caclipr@#CmpNum# = #dscaz041#2;
      Fichero = "Clientes/Proveedores"; Cmp = "Digito Contable"; Tipo = "C"; |HAZ ObtenDato;
      #caclipr@#CmpNum# = UltNivel;
      |LEE 000#caclipr@.=;
      |SI FSalida = 0;
         Fichero = "Clientes/Proveedores"; Cmp = "Cuenta Contable"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#5 = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Razon Social"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#6 = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Banco Domiciliacion"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#7  = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Entidad Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#8  = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Sucursal Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#9  = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "DC Cuenta Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#10 = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Num.Cuenta Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam003#11 = #caclipr@#CmpNum#;
      |FINSI;
   |FINSI;
   #dscam003#12 = #dscaz041#16;    || Tipo recibo
   #dscam003#22 = #dscaz041#8;     || Importe Recibo (Divisa)
   #dscam003#60 = #dscaz041#8 / #dscaz041#7;   || Importe Recibo (Base)
   #dscam003#30 = #dscaz041#8;     || Total Recibo (Divisa)
   #dscam003#64 = #dscaz041#8 / #dscaz041#7;   || Total Recibo (Base)
   |SI #dscaz041#10 = "S";
      #dscam003#23 = #dscaz041#8;     || Total Liquidado (Divisa)
      #dscam003#61 = #dscaz041#8 / #dscaz041#7;   || Total Liquidado (Base)
   |SINO;
      #dscam003#23 = 0;               || Total Liquidado (Divisa)
      #dscam003#61 = 0;               || Total Liquidado (Base)
   |FINSI;
   #dscam003#0  = #dscaz041#19
   #dscam003#57 = #dscaz041#6;
   #dscam003#58 = NombreDiv;
   #dscam003#50 = #dscaz041#9;     || Cuenta Entrega
   #dscam003#44 = #48#14;          || Empresa Contable
   #dscam003#45 = #48#19;          || Periodo Contable
   #dscam003#46 = #48#15;          || Empresa Gestion
   #dscam003#59 = #dscaz041#7;     || Cambio Divisa
   #dscam003#32 = #dscaz041#1;     || Codigo Cliente
   #dscam003#33 = #dscaz041#24;    || Codigo representante
   #dscam003#34 = #dscaz041#25;    || Nombre representante
   #dscam003#4  = #dscaz041#4;     || Fecha de emision
   #dscam003#47 = "S";             || Entrega a cuenta S/N
   #dscam003#59 = #dscaz041#7;     || Cambio Actual Divisa
   |SI #dscaz041#10 = "N";
      #dscam003#70 = #dscaz041#13;    || Numero talon entrega
      #dscam003#72 = #dscaz041#11;    || Entidad talon entrega
      #dscam003#71 = #dscaz041#14;    || Fecha talon entrega
      #dscam003#3  = #dscaz041#14;    || Fecha de vencimiento
      #dscam003#31 = #dscam003#30;    || Total pendiente Divisa
      #dscam003#65 = #dscam003#64;    || Total pendiente Base
      #dscam003#78 = #dscam003#30;    || Total entrega Divisa
      #dscam003#79 = #dscam003#64;    || Total entrega Base
      #dscam003#14 = "p";
      #dscam003#15 = "Entrega pdte.cobro";
      #dscam003#90 = "S";             || Preparado
   |SINO;
      #dscam003#14 = "e";
      #dscam003#15 = "Pendiente de compensar";
   |FINSI;
   |GRABA 020#dscam003.a; |LIBERA #dscam003;

   #dscam004#17 = #dscam003#40;
   #dscam004#3 = 1;
   |LEE 000#dscam004.];
   |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40;
      |PARA; |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40; |HACIENDO;
         Linea = #dscam004#3 + 1;
         |LEE 000#dscam004.s;
      |SIGUE;
   |SINO;
      Linea = 1;
   |FINSI;

   |DDEFECTO #dscam004;
   #dscam004#17 = #dscam003#40;
   #dscam004#3  = Linea;
   |GRABA 020#dscam004.b;
   #dscam004#0 = #dscam003#0;
   #dscam004#1 = #dscam003#1;
   #dscam004#2 = #dscam003#2;
   #dscam004#4 = #dscaz041#9;
   #dscam004#5 = "RAC";
   #dscam004#6 = #dscaz041#4;
   #dscam004#7 = 0; #dscam004#25 = 0;
   |SI #dscaz041#10 = "S";
      #dscam004#8 = #dscaz041#8; #dscam004#26 = #dscaz041#5;
   |FINSI;
   #dscam004#15 = #dscam003#27;
   Comodin = "Entrega a cuenta";
   #dscam004#16 = Comodin;
   #dscam004#42 = #dscaz041#9;
   nSwNoEnlace = 0;
   |SI nSwLuxe = 1;
      aAlfa = #dscaz041#9; |QBF aAlfa;
      aAlfa = aAlfa % 0103;
      |SI aAlfa = "570";
         aAlfa = #dscaz041#9; |QBF aAlfa;
         aAlfa = aAlfa % 0412; |QBF aAlfa;
         nCalc = aAlfa;
         |SI nCalc = 1;
            #dscam004#55 = "S";
            aSerCob = #dscam004#0;
            fFecCob = #dscam004#6;
            |HAZ LineaCaja;
            nSwNoEnlace = 1;
         |FINSI;
      |FINSI;
   |FINSI;
   |GRABA 020#dscam004.a; |LIBERA #dscam004;

   eaTipoOper = "+5";     nImporte = #dscam003#64;
   enEmpCartera = -1;     enEmpGestion = -1;
   eaSerie = #dscam003#0; eaCliGest = #dscam003#32;
   |HAZ BucleRiesgo;

   |SI nSwNoEnlace = 0;
      |SI #dscam051#1 = "S"; |Y HayConta = 1; |Y aCodEnl ! "";
         Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
         |NOME_DAT #50 Comodin;
         |DELINDEX #dscaw013; |ABRE #dscaw013;
         #dscaw013#15 = aCodEnl;      #dscaw013#0  = 1;
         #dscaw013#13 = "dscam004";   #dscaw013#14 = 17;
         #dscaw013#5 = #dscam004#17;  #dscaw013#6  = #dscam004#17;
         #dscaw013#11 = "N";          #dscaw013#12 = 10;
         |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
         #dscaw013#15 = aCodEnl;      #dscaw013#0  = 2;
         #dscaw013#13 = "dscam004";   #dscaw013#14 = 3;
         #dscaw013#5  = #dscam004#3;  #dscaw013#6  = #dscam004#3;
         #dscaw013#11 = "N";          #dscaw013#12 = 3;
         |GRABA 020#dscaw013.n; |LIBERA #dscaw013;
         Comodin = aCodEnl; |QBF Comodin;
         Comodin = "dscam033.tab;" + Comodin;
         |LIBERA #dscam003; |CIERRAT #dscam003;
         |LIBERA #dscam004; |CIERRAT #dscam004;
         |SUB_EJECUTA_NP Comodin;
         |CIERRA #dscaw013; |DELINDEX #dscaw013;
         |ABRET #dscam003;  |LEE 101#dscam003.=;
         |ABRET #dscam004;  |LEE 101#dscam004.=;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO VolcadoPro;
   |LEE 000#dscam008.u;
   NumDoc = #dscam008#40 + 1;
   |DDEFECTO #dscam008;
   #dscam008#40 = NumDoc;
   |GRABA 020#dscam008.b;

   |SI aResp1 = "G";
      Fichero = "Proveedores"; Cmp = "Codigo Proveedor"; Tipo = "G"; |HAZ ObtenDato;
      #agif112@#CmpNum# = #dscaz041#1;
      |LEE 000#agif112@.=;
      |SI FSalida = 0; |Y #agif112@#CmpNum# ! "      ";
         |SI nSwLuxe = 0;
            Fichero = "Proveedores"; Cmp = "Cuenta Contable"; Tipo = "G"; |HAZ ObtenDato;
            #dscam008#5 = #agif112@#CmpNum#;
         |SINO;
            |SI #dscaz041#22 = "            ";
               Fichero = "Proveedores"; Cmp = "Cuenta Contable"; Tipo = "G"; |HAZ ObtenDato;
               #dscam008#5 = #agif112@#CmpNum#;
            |SINO;
               #dscam008#5 = #dscaz041#22;
            |FINSI;
         |FINSI;
         Fichero = "Proveedores"; Cmp = "Nombre Comercial";  Tipo = "G"; |HAZ ObtenDato;
         #dscam008#6 = #agif112@#CmpNum#;
         Fichero = "Proveedores"; Cmp = "Banco Domiciliacion";  Tipo = "G"; |HAZ ObtenDato;
         #dscam008#7  = #agif112@#CmpNum#;
         Fichero = "Proveedores"; Cmp = "Entidad Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam008#8  = #agif112@#CmpNum#;
         Fichero = "Proveedores"; Cmp = "Sucursal Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam008#9  = #agif112@#CmpNum#;
         Fichero = "Proveedores"; Cmp = "DC Cuenta Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam008#10 = #agif112@#CmpNum#;
         Fichero = "Proveedores"; Cmp = "Num.Cuenta Bancaria"; Tipo = "G"; |HAZ ObtenDato;
         #dscam008#11 = #agif112@#CmpNum#;
      |FINSI;
   |SINO;
      Fichero = "Clientes/Proveedores"; Cmp = "Cliente/Proveedor"; Tipo = "C"; |HAZ ObtenDato;
      #caclipr@#CmpNum# = "P";
      Fichero = "Clientes/Proveedores"; Cmp = "Cuenta Contable"; Tipo = "C"; |HAZ ObtenDato;
      #caclipr@#CmpNum# = #dscaz041#2;
      Fichero = "Clientes/Proveedores"; Cmp = "Digito Contable"; Tipo = "C"; |HAZ ObtenDato;
      #caclipr@#CmpNum# = UltNivel;
      |LEE 000#caclipr@.=;
      |SI FSalida = 0;
         Fichero = "Clientes/Proveedores"; Cmp = "Cuenta Contable"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#5 = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Razon Social"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#6 = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Banco Domiciliacion"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#7  = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Entidad Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#8  = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Sucursal Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#9  = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "DC Cuenta Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#10 = #caclipr@#CmpNum#;
         Fichero = "Clientes/Proveedores"; Cmp = "Num.Cuenta Bancaria"; Tipo = "C"; |HAZ ObtenDato;
         #dscam008#11 = #caclipr@#CmpNum#;
      |FINSI;
   |FINSI;
   #dscam008#12 = #dscaz041#16;       || Tipo recibo
   #dscam008#22 = #dscaz041#8;        || Importe Recibo (Divisa)
   #dscam008#53 = #dscaz041#8 / #dscaz041#7;   || Importe Recibo (Base)
   #dscam008#25 = #dscaz041#8;        || Total Recibo (Divisa)
   #dscam008#56 = #dscaz041#8 / #dscaz041#7;   || Total Recibo (Base)
   |SI #dscaz041#10 = "S";
      #dscam008#23 = #dscaz041#8;     || Total Liquidado (Divisa)
      #dscam008#57 = #dscaz041#8 / #dscaz041#7;   || Total Liquidado (Base)
   |SINO;
      #dscam008#23 = 0;               || Total Liquidado (Divisa)
      #dscam008#57 = 0;               || Total Liquidado (Base)
   |FINSI;
   #dscam008#0  = #dscaz041#19
   #dscam008#59 = #dscaz041#6;
   #dscam008#60 = NombreDiv;
   #dscam008#50 = #dscaz041#9;        || Cuenta Entrega
   #dscam008#44 = #48#14;             || Empresa Contable
   #dscam008#45 = #48#19;             || Periodo Contable
   #dscam008#46 = #48#15;             || Empresa Gestion
   #dscam008#61 = #dscaz041#7;        || Cambio Divisa
   #dscam008#32 = #dscaz041#1;        || Codigo Cliente
   #dscam008#4  = #dscaz041#4;        || Fecha de emision
   #dscam008#74 = "S";                || Entrega a cuenta S/N
   #dscam008#61 = #dscaz041#7;        || Cambio Actual Divisa
   |SI #dscaz041#10 = "N";
      #dscam008#39 = "P";             || Documento asociado a talon
      #dscam008#47 = "Pagaré";        || Descripcion documento asociado
      #dscam008#3  = #dscaz041#14;    || Fecha de vencimiento
      ||#dscam008#31 = #dscaz041#8;     || Total pendiente Divisa
      ||#dscam008#58 = #dscaz041#8 / #dscaz041#7;   || Total pendiente (Base)
      #dscam008#14 = "E";
      #dscam008#15 = "Englobado en pagaré";
   |SINO;
      #dscam008#14 = "e";
      #dscam008#15 = "Pendiente de compensar";
   |FINSI;

   |SI #dscam051#110 = "S";
      #dscam008#16 = #dscaz041#23;
      #dscam008#52 = #dscaz041#12;
   |FINSI;
   |GRABA 020#dscam008.a; |LIBERA #dscam008;

   #dscam009#14 = #dscam008#40;
   #dscam009#3 = 1;
   |LEE 000#dscam009.];
   |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
      |PARA; |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40; |HACIENDO;
         Linea = #dscam009#3 + 1;
         |LEE 000#dscam009.s;
      |SIGUE;
   |SINO;
      Linea = 1;
   |FINSI;

   |DDEFECTO #dscam009;
   #dscam009#14 = #dscam008#40;
   #dscam009#3  = Linea;
   |GRABA 020#dscam009.b;
   #dscam009#0 = #dscam008#0;
   #dscam009#1 = #dscam008#1;
   #dscam009#2 = #dscam008#2;
   #dscam009#4 = #dscaz041#9;
   #dscam009#5 = "RAC";
   #dscam009#6 = #dscaz041#4;
   #dscam009#7 = 0; #dscam009#20 = 0;
   |SI #dscaz041#10 = "S";
      #dscam009#8 = #dscaz041#8; #dscam009#21 = #dscaz041#5;
   |FINSI;
   #dscam009#13 = #dscam008#27;
   Comodin = "Entrega a cuenta";
   #dscam009#17 = Comodin;
   #dscam009#34 = #dscaz041#9;

   nSwNoEnlace = 0;
   |SI nSwLuxe = 1;
      aAlfa = #dscaz041#9; |QBF aAlfa;
      aAlfa = aAlfa % 0103;
      |SI aAlfa = "570";
         aAlfa = #dscaz041#9; |QBF aAlfa;
         aAlfa = aAlfa % 0412; |QBF aAlfa;
         nCalc = aAlfa;
         |SI nCalc = 1;
            #dscam009#37 = "S";
            aSerCob = #dscam009#0;
            fFecCob = #dscam009#6;
            |HAZ LineaCaja;
            nSwNoEnlace = 1;
         |FINSI;
      |FINSI;
   |FINSI;
   |GRABA 020#dscam009.a; |LIBERA #dscam009;

   |SI #dscaz041#10 = "N";
      nCalc = 0;
      |ABRE #dscam021; |ABRE #dscam022; |ABRE #dscam014;

      |LEE 000#dscam014.p;
      |PARA; |SI FSalida = 0; |HACIENDO;
         |SI #dscam014#34 = #dscaz041#11; |SAL; |FINSI;
         |LEE 000#dscam014.s;
      |SIGUE;

      |LEE 000#dscam021.u;
      |SI FSalida = 0;
         nCalc = #dscam021#0 + 1;
      |SINO;
         nCalc = 1;
      |FINSI;

      |DDEFECTO #dscam021;
      #dscam021#0 = nCalc;
      |GRABA 020#dscam021.b;

      #dscam021#1 = ~;
      #dscam021#2 = #dscaz041#14;
      #dscam021#3 = #dscam014#0;
      #dscam021#4 = #dscaz041#12;
      #dscam021#5 = 1;
      #dscam021#6 = #dscaz041#20;
      #dscam021#9 = #dscaz041#8;
      #dscam021#10 = #dscam014#10;
      #dscam021#12 = #dscam014#34;
      #dscam021#13 = #dscam014#35;
      #dscam021#14 = #dscam014#37;
      #dscam021#15 = #dscam014#36;
      #dscam021#16 = #dscaz041#13;
      #dscam021#17 = #dscaz041#8;
      #dscam021#18 = #dscaz041#6;
      #dscam021#19 = #dscaz041#17;
      #dscam021#20 = #dscaz041#7;
      #dscam021#23 = #dscaz041#8;
      #dscam021#24 = "N";
      |GRABA 020#dscam021.a; |LIBERA #dscam021;

      |DDEFECTO #dscam022;
      #dscam022#0  = #dscam021#0;
      #dscam022#1  = 1;
      |GRABA 020#dscam022.b;

      #dscam022#2  = #dscam008#27;
      #dscam022#3  = #dscam008#1;
      #dscam022#4  = #dscam008#0;
      #dscam022#5  = #dscam008#2;
      #dscam022#6  = #dscam008#3;
      #dscam022#7  = #dscam008#25;
      #dscam022#8  = #dscam008#5;
      #dscam022#10 = #dscam008#6;
      #dscam022#13 = #dscam009#14;
      #dscam022#14 = #dscam009#3;
      #dscam022#18 = #dscam008#12;
      #dscam022#19 = #dscam008#25;
      #dscam022#20 = #dscaz041#6;
      #dscam022#21 = #dscaz041#17;
      #dscam022#22 = #dscaz041#7;
      #dscam022#23 = #dscaz041#7;
      #dscam022#37 = #dscam008#63;
      |GRABA 020#dscam022.a; |LIBERA #dscam022;

      #dscam008#40 = NumDoc;
      |LEE 101#dscam008.=;
      |SI FSalida = 0;
         #dscam008#17 = #dscam021#0;
         |GRABA 020#dscam008.a; |LIBERA #dscam008;
      |FINSI;

      |CIERRA #dscam021; |CIERRA #dscam022; |CIERRA #dscam014;
   |FINSI;

   |SI nSwNoEnlace = 0;
        |SI #dscam051#1 = "S"; |Y HayConta = 1; |Y aCodEnl ! "";
           Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
           |NOME_DAT #50 Comodin;
           |DELINDEX #dscaw013; |ABRE #dscaw013;
           #dscaw013#15 = aCodEnl;      #dscaw013#0  = 1;
           #dscaw013#13 = "dscam009";   #dscaw013#14 = 14;
           #dscaw013#5 = #dscam009#14;  #dscaw013#6  = #dscam009#14;
           #dscaw013#11 = "N";          #dscaw013#12 = 10;
           |GRABA 020#dscaw013.n; |LIBERA #dscaw013;

           #dscaw013#15 = aCodEnl;      #dscaw013#0  = 2;
           #dscaw013#13 = "dscam009";   #dscaw013#14 = 3;
           #dscaw013#5  = #dscam009#3;  #dscaw013#6  = #dscam009#3;
           #dscaw013#11 = "N";          #dscaw013#12 = 3;
           |GRABA 020#dscaw013.n; |LIBERA #dscaw013;

           Comodin = aCodEnl; |QBF Comodin;
           Comodin = "dscam033.tab;" + Comodin;
           |LIBERA #dscam008; |CIERRAT #dscam008;
           |LIBERA #dscam009; |CIERRAT #dscam009;
           |SUB_EJECUTA_NP Comodin;
           |CIERRA #dscaw013; |DELINDEX #dscaw013;
           |ABRET #dscam008;  |LEE 101#dscam008.=;
           |ABRET #dscam004;  |LEE 101#dscam009.=;
        |FINSI;
   |FINSI;
|FPRC;

|PROCESO Volcado;
   |SI aResp = "C";
      |HAZ VolcadoCli;
   |SINO;
      |HAZ VolcadoPro;
   |FINSI;
|FPRC;

|DEFBUCLE Volcado;
#dscaz041#1;
;
INICIO;
FINAL;
;
NULL,Volcado;
|FIN;

|PROCESO Baja; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3; NumEntregas = NumEntregas - 1; |FINSI;
|FPRC;

|PROCESO Alta; |TIPO 3;
   #dscaz041#5 = #dscaz041#8 / #dscaz041#7;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 1; NumEntregas = NumEntregas + 1; |FINSI;
|FPRC;

|PROCESO PuntoCuenta; |TIPO 6;
   |SI Campo = 2;
      nSalida = FSalida;
      |SI FSalida = 10; |ACABA; |FINSI;
      |SI #dscaz041#2 = "            "; |ACABA; |FINSI;
   |FINSI;

   |SI Campo = 22;
      nSalida = FSalida;
      |SI FSalida = 10; |ACABA; |FINSI;
      |SI #dscaz041#22 = "            "; |ACABA; |FINSI;
   |FINSI;

   Comodin = #dscaz041#Campo#;
   Comodin = Comodin - ".";
   |PARA; |SI FSalida ! 0; |HACIENDO;
      nParte1 = 100 + (((FSalida / 100) ! 0) - 1);
      nParte2 = ((((FSalida / 100) ! 0) + 1) * 100) + 99;
      aParte1 = #dscaz041#Campo# % nParte1;
      aParte2 = #dscaz041#Campo# % nParte2;
      |QBF aParte1; |QBF aParte2;
      Comodin = aParte1 + aParte2;
      aLong = Comodin % 0; nLong = aLong;
      nLong = MaxDigit - nLong;
      aLong = "0" * nLong;
      Comodin = aParte1 + aLong + aParte2;
      #dscaz041#Campo# = Comodin;
      |PINTA #dscaz041#Campo#;
      Comodin = Comodin - ".";
   |SIGUE;
   Comodin = #dscaz041#Campo#; |QBF Comodin;
   aLong = Comodin % 0; nLong = aLong;
   |SI nLong ! MaxDigit;
      |MENAV "    Cuenta fuera de nivel";
      |ERROR;
   |FINSI;
   FSalida = nSalida;
|FPRC;

|PROCESO MiraImporte;
   |SI #dscaz041#8 [ 0; |ERROR; |FINSI;
|FPRC;

|PROCESO MiraTR;
   enSwClas   = 1; eaFichClas = "dscaz041"; eaTipoClas = #dscaz041#16;
   |HAZ CompruebaClas;
   |SI eaFichClas = "ERROR";
      |MENAV "    Documento inoperable en el perfil actual "; |ERROR;
   |FINSI;
|FPRC;

|PROCESO TomaDatos;
   |SI #dscaz041#10 = "N";
      |PUSHV 0501 2380;
      |SI aResp = "C";
         |PINPA #0#dscaw059; |PINDA #0#dscaw059;
         |ENDATOS #1#dscaw059;
         |SI FSalida = 0;
            #dscaz041#11 = #dscaw059#0;
            #dscaz041#12 = #dscaw059#1;
            #dscaz041#13 = #dscaw059#2;
            #dscaz041#14 = #dscaw059#3;
            #dscaz041#15 = #dscaw059#4;
         |SINO;
            |ERROR;
         |FINSI;
      |SINO;
         |PINPA #0#dscaw112; |PINDA #0#dscaw112;
         |ENDATOS #1#dscaw112;
         |SI FSalida = 0;
            |ABRE #dscam014;
            #dscam014#0 = #dscaw112#0;
            |LEE 000#dscam014.=;
            |SI FSalida ! 0; |DDEFECTO #dscam014; |FINSI;
            |CIERRA #dscam014;

            #dscaz041#11 = #dscam014#34;
            #dscaz041#12 = #dscaw112#1;
            #dscaz041#13 = #dscaw112#2;
            #dscaz041#14 = #dscaw112#3;
            #dscaz041#15 = #dscaw112#4;
            #dscaz041#20 = #dscaw112#5;
            #dscaz041#21 = #dscaw112#6;
            #dscaz041#23 = #dscaw112#0;
         |SINO;
            |ERROR;
         |FINSI;
      |FINSI;
      |POPV;
   |SINO;
      #dscaz041#11 = "";
      #dscaz041#12 = "";
      #dscaz041#13 = "";
      #dscaz041#14 = "01.01.0000";
      #dscaz041#15 = "";
      #dscaz041#20 = 0;
      #dscaz041#21 = "";
      #dscaz041#23 = 0;
   |FINSI;
|FPRC;

|PROCESO BuscaNum;
   SwError = 1;
|FPRC;

|DEFBUCLE BuscaNum;
#dscam003#7;
;
#dscaw059#0,#dscaw059#2,000000001;
#dscaw059#0,#dscaw059#2,999999999;
;
NULL,BuscaNum;
|FIN;

|PROCESO MiraTalon;
   |SI FSalida = 2; |ACABA; |FINSI;
   SwError = 0;
   |BUCLE BuscaNum;
   |SI SwError = 1;
      |MENAV "    El numero de talon/pagare ya existe";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO PideEnlace;
   |SI #dscam051#1 = "N"; aCodEnl = ""; |ACABA; |FINSI;

   |SI #dscam051#61 = "N";
      |SI aResp = "C";
         aCodEnl = #dscam051#73; |ACABA;
      |FINSI;
      |SI aResp = "P";
         aCodEnl = #dscam051#115; |ACABA;
      |FINSI;
   |FINSI;
   |PUSHV 2022 2357; |BLANCO 2022 2357;
   |CUADRO 2123 2356;
   |ATRI R; |PINTA 2124, " Introduzca un codigo de enlace "; |ATRI N;

   |MENSA "    <F2> Consulta enlaces ";
   |ABRE #dscam030; |DDEFECTO #dscam030;
   |SI aResp = "C"; #dscam030#0 = #dscam051#73; |FINSI;
   |SI aResp = "P"; #dscam030#0 = #dscam051#115; |FINSI;
   |LEE 000#dscam030.=;
   |SI FSalida ! 0; |DDEFECTO #dscam030; |FINSI;
   aCodEnl = #dscam030#0;

|ET OtraVez;
   |PINTA 2225, #dscam030#0; |PINTA 2230, #dscam030#1;
   E_sup = 4; E_inf = "";
   aCodEnl = 2225 ? 1;
   |SI FSalida = 0;
      #dscam030#0 = aCodEnl;
      |LEE 000#dscam030.=;
      |SI FSalida = 0;
         |PINTA 2225, #dscam030#0; |PINTA 2230, #dscam030#1;
         |CONFI "    NEs correcto ? ";
         |SI FSalida ! 0; aCodEnl = ""; |FINSI;
      |SINO;
         |MENAV "    No se encuentra la ficha ";
         |DDEFECTO #dscam030; |VETE OtraVez;
      |FINSI;
   |SINO;
      |SI FSalida = 10;
         #dscam030#0 = aCodEnl;
         |LEE 000#dscam030.];
         |CONSULTA_CLAVE #1#dscam030;
         |SI FSalida = 0;
            aCodEnl = #dscam030#0;
         |FINSI;
         |VETE OtraVez;
      |SINO;
         aCodEnl = "";
      |FINSI;
   |FINSI;
   |CIERRA #dscam030;
   |MENSA "     ";
   |POPV;
|FPRC;

|PROCESO MiraSiEnlace;
   aAlfa = #dscaz041#9; |QBF aAlfa;
   aAlfa = aAlfa % 0103;
   |SI aAlfa = "570";
      aAlfa = #dscaz041#9; |QBF aAlfa;
      aAlfa = aAlfa % 0412; |QBF aAlfa;
      nCalc = aAlfa;
      |SI nCalc ! 1;
         nSwNoEnlace = 0; |ERROR10;
      |FINSI;
   |SINO;
      nSwNoEnlace = 0; |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE MiraSiEnlace;
#dscaz041#1;
;
INICIO;
FINAL;
;
NULL, MiraSiEnlace;
|FIN;

|PROCESO Tipo11; |TIPO 11;
   |SI FSalida = 10;
      |PUSHV 1110 1572;
      #dscaw221#0 = #dscaz041#24;
      #dscaw221#1 = #dscaz041#25;

      |PINPA #0#dscaw221; |PINDA #0#dscaw221;
      |ENDATOS #1#dscaw221;
      |SI FSalida = 0;
         #dscaz041#24 = #dscaw221#0;
         #dscaz041#25 = #dscaw221#1;
         |GRABA 020#dscaz041.a;
      |FINSI;
      |POPV;
   |FINSI;
|FPRC;

|PROGRAMA;
   |HAZ Tipo8;

   |HAZ EsLuxe;
   |SI FSalida = 0;
      nSwLuxe = 1;
   |SINO;
      nSwLuxe = 0;
   |FINSI;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscam051;
      |GRABA 020#dscam051.c;
   |FINSI;

   |CLS;
   |CABEZA "Introduccion de entregas a cuenta";
   |PINPA #0#0;
   |ENTLINEAL #1#dscaz041,-1,7,18,1,inf041,sup041;

   |ATRI R; |PINTA 0504, "INTRODUCCION DE ENTREGAS A CUENTA"; |ATRI N;

   |BLANCO 0707 0941;
   |PINTA 0809, "Codigo Cli/Prov";
   |ATRI I; |PINTA 0816, "C"; |PINTA 0820, "P"; |ATRI N;
   |PINTA 0843, "Gestion/Contab.";
   |ATRI I; |PINTA 0843, "G"; |PINTA 0851, "C"; |ATRI N;
   |CUADRO 0707 0941; |CUADRO 0741 0976;

   |SI PARAMETRO ! ""; aResp = PARAMETRO; |PTEC 802; |FINSI;
|ET OtraEleccion;
   E_sup = 1; E_inf = "";
   aResp = 0825 ? 1; aResp = aResp > aResp;
   |SI FSalida = 7; |ACABA; |FINSI;
   |SI aResp ! "C"; |Y aResp ! "P"; |VETE OtraEleccion; |FINSI;

   |ATRI I;
   |SI aResp = "C";
      |PINTA 0827, "Clientes    ";
      |C_M #dscaz041#19, 1, "S";
   |FINSI;
   |SI aResp = "P";
      |PINTA 0827, "Proveedores ";
      |C_M #dscaz041#19, 1, "S";
   |FINSI;
   |ATRI N;
   |CUADRO 0707 0941;

   aResp1 = "";
   aAlfa = #48#16; |QBF aAlfa;
   |SI aAlfa ! "";
      aAlfa = #48#17; |QBF aAlfa;
      |SI aAlfa = "";
         aResp1 = "C"; |PTEC 802;
      |FINSI;
   |SINO;
      aAlfa = #48#17; |QBF aAlfa;
      |SI aAlfa ! "";
         aResp1 = "G"; |PTEC 802;
      |FINSI;
   |FINSI;

|ET OtraEleccion1;
   E_sup = 1; E_inf = "";
   aResp1 = 0859 ? 1; aResp1 = aResp1 > aResp1;
   |SI FSalida = 7; |ACABA; |FINSI;
   |SI aResp1 ! "G"; |Y aResp1 ! "C"; |VETE OtraEleccion1; |FINSI;

   |ATRI I;
   |SI aResp1 = "G";
      |PINTA 0862, "Gestion     ";
      |C_M #dscaz041#1, 1, "S"; |C_M #dscaz041#2, 1, "N";
   |FINSI;
   |SI aResp1 = "C";
      |PINTA 0862, "Contabilidad";
      |C_M #dscaz041#1, 1, "N"; |C_M #dscaz041#2, 1, "S";
   |FINSI;
   |ATRI N;
   |CUADRO 0741 0976;

   Comodin = "ea" + Usuario; |NOME_DAT #0 Comodin;
   |DELINDEX #dscaz041; |ABRE #dscaz041;
   NumEntregas = 0;

   |ENTLINEAL #1#dscaz041,-1,1,19,1,inf041,sup041;

   |SI NumEntregas > 0;
      nSwNoEnlace = 0;
      |SI nSwLuxe = 1;
         nSwNoEnlace = 1;
         || Compruebo si hay entregas con cuentas distintas de 570.1
         |BUCLE MiraSiEnlace;
      |FINSI;

      |SI HayConta = 1; |Y nSwNoEnlace = 0; |HAZ PideEnlace; |QBF aCodEnl; |FINSI;
      |SI aResp = "C";
         |ABRE #dscam003; |ABRE #dscam004;
      |SINO;
         |ABRE #dscam008; |ABRE #dscam009;
      |FINSI;
      |CONFI "    N¨ Desea volcar los datos introducidos ?";
      |SI FSalida = 0; |BUCLE Volcado; |FINSI;
      |SI aResp = "C";
         |CIERRA #dscam003; |CIERRA #dscam004;
      |SINO;
         |CIERRA #dscam008; |CIERRA #dscam009;
      |FINSI;
   |FINSI;
   |CIERRA #dscaz041;

   |CIERRA #dscam051;
   |HAZ Tipo9;
|FPRO;
