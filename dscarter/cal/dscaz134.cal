|FICHEROS;
   dscaz134 #10;

   dscaw099 #20;
   dscam000 #21;
   Referen@ #100;
|FIN;

|VARIABLES;
   nCont = 0;

   aAlfa = "";
|FIN;

|PROCESO Selec;
   |SI #dscaz134#0 = "N";
      |C_M #dscaz134#1, 1, "S"; |C_M #dscaz134#2, 1, "S";
      |PARA nCont = 3; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz134#nCont#, 1, "N";
      |SIGUE;
   |SINO;
      |C_M #dscaz134#1, 1, "N"; |C_M #dscaz134#2, 1, "N";
      |PARA nCont = 3; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz134#nCont#, 1, "S";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO MiraEmp;
   |SI FSalida = 10;
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "dscam005.mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         |DFICB aAlfa; |QBF aAlfa;
         |PATH_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
         |CONSULTA_CLAVE #1#Referen@;
         |SI FSalida = 0;
            #dscaz134#Campo# = #Referen@#0; |PINTA #dscaz134#Campo#;
         |FINSI;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |SINO;
         |MENAV "    No puedo cargar el def de empresas";
      |FINSI;
      |ERROR; |ACABA;
   |FINSI;

   |SI #dscaz134#Campo# = 0;
      |PARA nCont = Campo + 1; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz134#nCont#, 1, "N";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO Empresas;
   |DDEFECTO #dscaw099;
   #dscaw099#0 = #Referen@#0;
   #dscaw099#1 = #Referen@#1;
   |GRABA 020#dscaw099.n;
|FPRC;

|DEFBUCLE Empresas;
#Referen@#1001;
;
#dscaz134#1;
#dscaz134#2;
;
NULL,Empresas;
|FIN;

|PROGRAMA;
   |PUSHV 0501 2380;
   |PINPA #0#dscaz134; |PINDA #0#dscaz134;
   |ENDATOS #1#dscaz134;
   |SI FSalida = 0;
      aAlfa = "se" + Usuario; |NOME_DAT #dscaw099#aAlfa#;
      |DELINDEX #dscaw099; |ABRE #dscaw099;
      |DDEF aAlfa; |QBF aAlfa; aAlfa = aAlfa + "dscam005.mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         |DFICB aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
         |SI #dscaz134#0 = "S";
            |PARA nCont = 3; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
               |SI #dscaz134#nCont# ! 0;
                  #Referen@#0 = #dscaz134#nCont#;
                  |LEE 000#Referen@.=;
                  |SI FSalida = 0; |HAZ Empresas; |FINSI;
               |FINSI;
            |SIGUE;
         |SINO;
            |BUCLE Empresas;
         |FINSI;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |FINSI;
      |CIERRA #dscaw099;
   |FINSI;
   |POPV;
|FPRO;
