|FICHEROS;
   dscam016 #0;
   dscaw006 #1,MANTE;
   dscam003 #2;
   dscam004 #3;
   dscam017 #4;
   dscam001 #5;

   dscam048 #6;

   dscam056 #7;
   dscam057 #8;
   dscaw021 #9;
   dscaw224 #10,MANTE;
   dscam051 #40;
   dscaw226 #11,MANTE;

   dscam217 #100;

   &agif024@ #50;
   &caclipr@ #51;
   &agif321@ #52;
   &agif324@ #53;

   Referen@ #1000;
|FIN;

|VARIABLES;
   &eaFichClas = "";  &eaTipoClas = ""; &enSwClas = 0;
   &eaResult    = "";
   &enNumDocum  = 0;
   &enTipoRec   = 0;

   &TipoCliente = ""; &CodCliente = "";
   &MaxDigit = 0;     &aPoblac = "";
   &nDeci_Base = 0; &nDeci_Div = 0;
   &Divisa = "";    &CambioDiv = 0; &HayGestion = 0; &HayConta = 0;
   &aInforme = "";  &SwNumAsig = 0;  &SwTotal   = 0;
   &Niv1 = 0; &Niv2 = 0; &Niv3 = 0; &Niv4 = 0;  &Niv5 = 0; &Niv6 = 0;
   &Fichero = ""; &Tipo = ""; &Cmp = ""; &CmpNum = 0;

   &eaUsuario = ""; &enImpAnt = 0;  &enImpAct = 0;  &eaDescr = "";
   &eaTipoReg = ""; &eaNumero = ""; &eaTipoOp = ""; &eaFicher = ""; &eaClave = "";

   &eaCodigo    = "";
   &eaTipoCod   = "";
   &aCuenta     = "";
   &eaNif       = "";
   &eaNombre    = "";
   &eaDireccion = "";
   &eaPoblacion = "";
   &eaProvincia = "";
   &eaCP        = "";
   &eaCP1       = "";
   &eaCP2       = "";
   &eaTelefono  = "";

   Comodin = ""; Cont   = 0;  NumRelac = 0;
   aLong   = ""; nLong  = 0;
   Parte1  = 0;  Parte2 = 0;  Parte = 0;
   Part1   = ""; Part2  = ""; FEstado = 0;
   &PosLibro = 0; &PosSerie = 0; &PosFactu = 0; &PosRecib = 0; &enDocum = 0;
   SwClave = 0; Nivel = 0;

   LongAlfa = ""; Long = 0; Codigo = 0;
   ModoEntrada = 0; ModoCampo = 0;
   Linea = 0; LinCob = 0; NumLinea = 0;
   NumDocum = 0; SwRepet = 0; nSwArtenvas = 0;

   Flag = 0;
   nCont = 0;
   aAlfa = "";

   aDRep = "";
   aHRep = "";
   fDFecFra = @;
   fHFecFra = @;
   nSwPasa = 0;
   nCalc   = 0;

   nSwCambio = 0;
   nRemAuto = 0;

{10}aRep = "";
|FIN;

|PROCESO Decimales; |TIPO 11;
   Divisa = #dscam017#10; |HAZ TomaDecim;
|FPRC;

|PROCESO Volcado;
   |DDEFECTO #dscam017;
   #dscam017#0 = #dscam016#0;
   #dscam017#1 = Linea; Linea = Linea + 1;
   #dscam017#2 = #dscaw006#1;
   #dscam017#3 = #dscaw006#2;
   #dscam017#4 = #dscaw006#3;
   #dscam017#5 = #dscaw006#4;
   #dscam017#7 = #dscaw006#6;
   #dscam017#9 = #dscaw006#8;
   #dscam017#10 = #dscaw006#9;
   Divisa = #dscam017#10; CambioDiv = 0; |HAZ TomaDecim;
   #dscam017#11 = CambioDiv;
   #dscam017#12 = #dscaw006#10;
   #dscam017#13 = #dscaw006#11;

   |HAZ TomaDatos;
   |GRABA 020#dscam017.n;
   |LEE 000#dscam017.=;

   |HAZ ActRecibo;
|FPRC;

|DEFBUCLE Volcado;
#dscaw006#1;
7;
001,"*";
999,"*";
;
NULL,Volcado;
|FIN;

|PROCESO RellenaAuto;
   |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |Y #dscam003#14 ! "I";
       |ACABA;
   |FINSI;

   |SI aDRep = "  "; |Y aHRep = "zz"; |Y aRep1 ! "";
      nSwPasa = 1;
      |PARA nCont = 0; |SI nCont < 10; |HACIENDO nCont = nCont + 1;
         IaRep = aRep1<-; IaRep = IaRep + nCont;
         |SI aRep ! ""; |SI aRep = #dscam003#33; nSwPasa = 0; |SAL; |FINSI; |FINSI;
      |SIGUE;
      |SI nSwPasa = 1; |ACABA; |FINSI;
   |FINSI;

   enSwClas   = 1; eaFichClas = "dscam016"; eaTipoClas = #dscam003#12;
   |HAZ CompruebaClas;
   |SI eaFichClas = "ERROR"; |ACABA; |FINSI;

   Divisa = #dscam003#57; |HAZ TomaDecim;

   |DDEFECTO #dscaw006;
   #dscaw006#0 = Linea;    Linea = Linea + 1;
   #dscaw006#1 = #dscam003#27;
   #dscaw006#2 = #dscam003#0;
   #dscaw006#3 = #dscam003#1;
   #dscaw006#4 = #dscam003#2;
   #dscaw006#5 = #dscam003#3;
   #dscaw006#6 = #dscam003#31;
   #dscaw006#7 = " ";
   #dscaw006#8 = #dscam003#40;
   #dscaw006#9 = #dscam003#57;
   #dscaw006#10 = #dscam003#32;
   #dscaw006#11 = #dscam003#6;
   |GRABA 020#dscaw006.n;
|FPRC;

|DEFBUCLE RellenaAuto;
#dscam003#1;
31,33,39,3,12,4;
000000001,0000000001,aDRep,#dscaw021#2,#dscaw021#4,#dscaw021#6,fDFecFra;
999999999,9999999999,aHRep,#dscaw021#3,#dscaw021#5,#dscaw021#7,fHFecFra;
;
NULL,NULL,NULL,NULL,NULL,RellenaAuto;
#dscam003#3;
|FIN;

|RUTINA infw006;
   #dscaw006#0 = 1;
|FRUT;

|RUTINA supw006;
   #dscaw006#0 = 999;
|FRUT;

|PROCESO Tipo13w006; |TIPO 13;
   |SI nSwCambio = 0;
      |SI nSwArtenvas = 1;
         |PINTA 2108, "Cliente ";
         |PINTA 2165, "Divisa ";
         |ATRI R; |PINTA 1152, "Fecha Vto."; |ATRI N;
         |ATRI R; |PINTA 1140, "Fec.visita  "; |ATRI N;
      |FINSI;
      nSwCambio = 1;
   |FINSI;
|FPRC;

|PROCESO PintaLin; |TIPO 13;
   |PINTA 2208, "Nombre cliente";
   |SI nSwArtenvas = 1;
      |PINTA 2255, "F.Visita";
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "dscam223.mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
         #Referen@#0 = #dscam017#9;
         |LEE 000#Referen@.=;
         |SI FSalida ! 0; |DDEFECTO #Referen@; |FINSI;
         |PINTA 2264, #Referen@#4
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO AutoSel;
   nRemAuto = 0;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 1;
      |CONFI "    N¨ Seleccion automatica ?";
   |SINO;
      FSalida = 1;
   |FINSI;

   |SI FSalida = 0;
      nRemAuto = 1;
      |DELINDEX #dscaw006;
      Linea = 1;
      |ABRE #dscaw006;
      |ABRE #dscam017;
      |SI nSwArtenvas = 0;
         |PUSHV 0920 1659;
         |BLANCO 0920 1659;
         |PINPA #0#dscaw021; |PINDA #0#dscaw021;
         |ENDATOS #1#dscaw021;
         |SI FSalida = 0;
            |POPV;
            aDRep = #dscaw021#0; aHRep = #dscaw021#1;
            fDFecFra = "01.01.0000";  fHFecFra = "31.12.9999";
            |BUCLE RellenaAuto;
         |SINO;
            |POPV;
         |FINSI;
      |SINO;
         |PUSHV 0820 1859;
         |BLANCO 0820 1759;

         |PINPA #0#dscaw224; |PINDA #0#dscaw224;
         |ENDATOS #1#dscaw224;
         |SI FSalida = 0;
            |POPV;
            |SI #dscaw224#8 = "N";
               aDRep = #dscaw224#0; aHRep = #dscaw224#1;
            |SINO;
               aDRep = "  "; aHRep = "zz";
               |PARA nCont = 0; |SI nCont < 10; |HACIENDO nCont = nCont + 1;
                  IaRep = aRep1<-; IaRep = IaRep + nCont;
                  nCalc = nCont + 9;
                  aAlfa = #dscaw224#nCalc#; |QBF aAlfa; aRep = aAlfa;
                |SIGUE;
            |FINSI;

            fDFecFra = #dscaw224#19;  fHFecFra = #dscaw224#20;
            #dscaw021#0 = #dscaw224#0;
            #dscaw021#1 = #dscaw224#1;
            #dscaw021#2 = #dscaw224#2;
            #dscaw021#3 = #dscaw224#3;
            #dscaw021#4 = #dscaw224#4;
            #dscaw021#5 = #dscaw224#5;
            #dscaw021#6 = #dscaw224#6;
            #dscaw021#7 = #dscaw224#7;
            |BUCLE RellenaAuto;
         |SINO;
            |POPV;
         |FINSI;
      |FINSI;

      |SI FSalida = 0;
         |SI nSwArtenvas = 1;
            |C_L #dscaw006#10, 1, "N"; |C_P #dscaw006#10, 1, 2116;
            |C_L #dscaw006#9, 1, "N"; |C_P #dscaw006#9, 1, 2172;
            |C_P #dscaw006#5, 1, 1252;
            |C_P #dscaw006#12, 1, 1240; |C_V #dscaw006#12, 1, "S";
            |C_L #dscaw006#12, 1, "S";
         |FINSI;
         |PUSHV 10012380;
         |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809;
         |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809;
         |ENTLINEAL #1#dscaw006,-1,4,19,1,infw006,supw006;
         FEstado = FSalida;
         |POPV;
         FSalida = FEstado;
         |SI FSalida ] 0;
            Linea = 1;
            #dscam017#0 = #dscam016#0;
            #dscam017#1 = 1;
            |LEE 000#dscam017.]
            |PARA; |SI FSalida = 0; |HACIENDO;
               |LEE 000#dscam017.s;
               |SI FSalida = 0; |Y #dscam017#0 = #dscam016#0;
                  Linea = #dscam017#1 + 1;
               |SINO;
                  |SAL;
               |FINSI;
            |SIGUE;
            |BUCLE Volcado;
         |FINSI;
         |CIERRA #dscam017;
         |CIERRA #dscaw006;
         |PTEC 808; |PTEC 808; |PTEC 808; |PTEC 808; |PTEC 808;
         |PTEC 808; |PTEC 808; |PTEC 808; |PTEC 808; |PTEC 808;
      |FINSI;
   |FINSI;
   nRemAuto = 0;
|FPRC;

|PROCESO TomaDatos;
   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscam051;
      |GRABA 020#dscam051.c;
   |FINSI;
   |CIERRA #dscam051;

   |ABRE #dscam003;
   #dscam003#40 = #dscam017#9;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      ModoEntrada = (FEntrada / 100) ! 0;
      |SI ModoEntrada = 1;
         enSwClas   = 1; eaFichClas = "dscam016"; eaTipoClas = #dscam003#12;
         |HAZ CompruebaClas;
         |SI eaFichClas = "ERROR";
            |MENAV "    Documento inoperable en el perfil actual ";
            |ERROR; |ACABA;
         |FINSI;
         |SI eaFichClas = "INFOR";
            |CONFI "    Documento inoperable en el perfil actual. Cambiar Tipo recibo ?";
            |SI FSalida = 0;
               eaFichClas = "dscam016";
               enNumDocum = #dscam003#40; enTipoRec = 3; |HAZ CambiaTR;
            |SINO;
               |LIBERA #dscam003; |CIERRA #dscam003;
               |ERROR; |ACABA;
            |FINSI;
         |FINSI;

         |SI #dscam051#42 = "S";
            |SI #dscam003#28 = "S"; |Y #dscam003#29 = "N";
               |MENAV "    Recibo no aceptado";
               |LIBERA #dscam003; |CIERRA #dscam003;
               |ERROR; |ACABA;
            |FINSI;
         |FINSI;
         |SI #dscam003#14 = "R"; |MENAV "    Recibo remesado";         |ERROR; |ACABA; |FINSI;
         |SI #dscam003#14 = "L"; |MENAV "    Recibo liquidado";        |ERROR; |ACABA; |FINSI;
         |SI #dscam003#14 = "M"; |MENAV "    Recibo con cobrador";     |ERROR; |ACABA; |FINSI;
         |SI #dscam003#14 = "T"; |MENAV "    Recibo asignado a talon"; |ERROR; |ACABA; |FINSI;
         |SI #dscam003#14 = "A"; |MENAV "    Recibo agrupado ";        |ERROR; |ACABA; |FINSI;
         |SI #dscam003#14 = "D"; |MENAV "    Recibo dividido";         |ERROR; |ACABA; |FINSI;
      |FINSI;
      #dscam017#10 = #dscam003#57;
      #dscam017#11 = #dscam003#59; |HAZ Decimales;
      #dscam017#12 = #dscam003#32;
      #dscam017#13 = #dscam003#6;
      #dscam017#6 = #dscam003#3;
      #dscam017#7 = #dscam003#31;
      #dscam017#3 = #dscam003#0;
      #dscam017#4 = #dscam003#1;
      #dscam017#5 = #dscam003#2;

      || #dscam003#33 = #dscam016#1;
      || #dscam003#34 = #dscam048#1;
      |GRABA 020#dscam003.a;
   |SINO;
      |MENAV "    Recibo inexistente"; |ERROR;
   |FINSI;
   |LIBERA #dscam003; |CIERRA #dscam003;
|FPRC;

|PROCESO Contador; |TIPO 7;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada ! 1; |ACABA; |FINSI;
   |ABRE #dscam016;
   |LEE 000#dscam016.u;
   |SI FSalida = 0;
      Codigo = #dscam016#0 + 1;
   |SINO;
      |DDEFECTO #dscam016;
      Codigo = #dscam016#0;
   |FINSI;
   |CIERRA #dscam016;
   |DDEFECTO #dscam016;
   #dscam016#0 = Codigo;
|FPRC;

|PROCESO ActRecibo; |TIPO 2;
   ModoEntrada = (FEntrada / 100) ! 0;

   #dscam016#3 = #dscam016#3 +. 1; |PINTA #dscam016#3;
   #dscam016#4 = #dscam016#4 +. (#dscam017#7 * #dscam017#11); |PINTA #dscam016#4;
   #dscam016#5 = #dscam016#5 +. (#dscam017#7 * #dscam017#11); |PINTA #dscam016#5;

   |ABRE #dscam003; Flag = 0 +. 1;

   |SI nSwArtenvas = 1;
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "dscam223.mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
         #Referen@#0 = #dscam017#9;
         |SI Flag < 0
            |LEE 101#Referen@.=;
            |SI FSalida = 0;
               #dscaw226#0 = #Referen@#4;
               |BORRA 020#Referen@.a; |LIBERA #Referen@;
            |FINSI;
         |SINO;
            |SI nRemAuto = 0;
               |PUSHV 1233 1548;
               |PINPA #0#dscaw226; |PINDA #0#dscaw226;
               |ENDATOS #1#dscaw226;
               |SI FSalida = 0;
                  #dscaw006#12 = #dscaw226#0;
               |FINSI;
               |POPV;
            |FINSI;
            |LEE 000#Referen@.=;
            |SI FSalida ! 0;
               |DDEFECTO #Referen@;
               #Referen@#0 = #dscam017#9;
               #Referen@#1 = #dscam017#3;
               #Referen@#2 = #dscam017#4;
               #Referen@#3 = #dscam017#5;
               #Referen@#4 = #dscaw006#12;
               #Referen@#5 = #dscam016#0;
               |GRABA 020#Referen@.c;
            |FINSI;
         |FINSI;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |FINSI;
   |FINSI;

   #dscam003#40 = #dscam017#9;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      |SI Flag > 0
         #dscam003#14 = "M";
         #dscam003#15 = "Gestionado por cobrador";
         |GRABA 020#dscam003.a;
         eaUsuario = Usuario % 0810;
         eaDescr   = "ALTA ASIGNACION (" + (("00000" + #dscam016#0) % -105) + ") DE COBRADOR (" + #dscam016#1 + ")";
         eaDescr   = eaDescr + ") CON RECIBO (" + #dscam003#0 + "/" + #dscam003#1 + "/" + #dscam003#2 + ")";
         eaTipoReg = "RC";  eaNumero = ("00000" + #dscam016#0) % -105;
         eaTipoOp  = "A";   enImpAct = #dscam016#4;
         enImpAnt = #dscam016#4 - #dscam017#7;
         eaFicher = "dscam003"; eaClave = #dscam003#40;
         |HAZ GrabaAudit;
      |SINO;
         |SI #dscam003#31 = 0;
            #dscam003#14 = "L";
            #dscam003#15 = "Recibo Liquidado";
         |SINO;
            |SI #dscam003#23 = 0;
               |SI #dscam003#16 = 0;
                  #dscam003#14 = "P";
                  #dscam003#15 = "Pendiente de cobro";
               |SINO;
                  #dscam003#14 = "I";
                  #dscam003#15 = "Impagado";
               |FINSI;
            |SINO;
               #dscam003#14 = "C";
               #dscam003#15 = "Parcialmente cobrado";
            |FINSI;
         |FINSI;
         |GRABA 020#dscam003.a;
         eaUsuario = Usuario % 0810;
         eaTipoReg = "RC";  eaNumero = ("00000" + #dscam016#0) % -105;
         |SI ModoEntrada = 3;
            eaDescr   = "BAJA LINEA ASIGNACION (" + (("00000" + #dscam016#0) % -105) + ") DE COBRADOR (" + #dscam016#1 + ")";
            eaDescr   = eaDescr + " CON RECIBO (" + #dscam003#0 + "/" + #dscam003#1 + "/" + #dscam003#2 + ")";
            eaTipoOp  = "B";   enImpAct = #dscam016#4;
            enImpAnt = #dscam016#4 + #dscam017#7;
         |FINSI;
         |SI ModoEntrada = 2;
            eaDescr   = "MODIFICACION LINEA ASIGNACION (" + (("00000" + #dscam016#0) % -105) + ") DE COBRADOR (" + #dscam016#1 + ")";
            eaDescr   = eaDescr + " CON RECIBO (" + #dscam003#0 + "/" + #dscam003#1 + "/" + #dscam003#2 + ")";
         |FINSI;
         eaFicher = "dscam017"; eaClave = #dscam017#0 + "/" + #dscam017#1;
         |HAZ GrabaAudit;
      |FINSI;
   |FINSI;
   |LIBERA #dscam003;

   |CIERRA #dscam003;
|FPRC;

|PROCESO MiraSiAlta; |TIPO 7;
   ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada = 1;
      |C_M #dscam016#1,1,"S";
   |SINO;
      |C_M #dscam016#1,1,"N";
   |FINSI;
|FPRC;

|PROCESO BajaLin;
   #dscam016#3 = #dscam016#3 - 1;
   #dscam016#4 = #dscam016#4 - (#dscam017#7 * #dscam017#11);
   #dscam016#5 = #dscam016#5 - (#dscam017#7 * #dscam017#11);

   |SI nSwArtenvas = 1;
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "dscam223.mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         |DFICE aAlfa; |QBF aAlfa; |PATH_DAT #Referen@#aAlfa#;
         |ABRE #Referen@;
         #Referen@#0 = #dscam017#9;
         |LEE 101#Referen@.=;
         |SI FSalida = 0;
            |BORRA 020#Referen@.a; |LIBERA #Referen@;
         |FINSI;
         |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
      |FINSI;
   |FINSI;

   #dscam003#40 = #dscam017#9;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      |SI #dscam003#31 = 0;
         #dscam003#14 = "L";
         #dscam003#15 = "Recibo Liquidado";
      |SINO;
         |SI #dscam003#23 = 0;
            |SI #dscam003#16 = 0;
               #dscam003#14 = "P";
               #dscam003#15 = "Pendiente de cobro";
            |SINO;
               #dscam003#14 = "I";
               #dscam003#15 = "Impagado";
            |FINSI;
         |SINO;
            #dscam003#14 = "C";
            #dscam003#15 = "Parcialmente cobrado";
         |FINSI;
      |FINSI;
      |GRABA 020#dscam003.a;
   |FINSI;
   |LIBERA #dscam003;

   |BORRA 020#dscam017.a;
|FPRC;

|DEFBUCLE BajaLin;
#dscam017#1;
;
#dscam016#0,001;
#dscam016#0,999;
be;
NULL,BajaLin;
|FIN;

|PROCESO Baja; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 3;
      |ABRE #dscam003;
      |BUCLE BajaLin;
      |CIERRA #dscam003;
   |FINSI;
|FPRC;

|PROCESO Busca;
   |SI FSalida ! 10; |ACABA; |FINSI;
   |PUSHV 1217 1461;
   |BLANCO 1217 1461;
   |CUADRO 1217 1461;
   |PINTA 1319, "Libro    Serie    Fact.         Recibo    ";
   PosLibro = 1325; PosSerie = 1334; PosFactu = 1343; PosRecib = 1358;
   |HAZ ConsultaVentas;
   |SI enDocum ! -1;
      #dscam017#9 = enDocum;
   |SINO;
      |MENAV "    Ficha inexistente"; |ERROR;
   |FINSI;
   SwClave = 1;
   |POPV;
   |PINTA #dscam017#9;
|FPRC;

|PROCESO BuscaRel; |TIPO 7;

   |HAZ EsArtenvas;
   |SI FSalida = 0;
      nSwArtenvas = 1;
   |SINO;
      nSwArtenvas = 0;
   |FINSI;

   |HAZ TomaDecim;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada ! 1; |ACABA; |FINSI;

   |ABRE #dscam016;
   |LEE 000#dscam016.u;
   |SI FSalida = 0;
      NumRelac = #dscam016#0 + 1;
   |SINO;
      NumRelac = 1;
   |FINSI;
   |CIERRA #dscam016;
   |DDEFECTO #dscam016;
   #dscam016#0 = NumRelac;
|FPRC;

|PROCESO Impresion;
   #dscam003#40 = #dscam017#9;
   |LEE 000#dscam003.=;

   eaCodigo = #dscam003#32; eaTipoCod = "C"; aCuenta = #dscam003#5; |HAZ LeeDatos;
   aPoblac = eaPoblacion;
   |PRINT;
   SwNumAsig = 0;
   Divisa = #dscam017#10; |HAZ Tipo13;
|FPRC;

|DEFBUCLE Impresion;
#dscam017#1;
;
#dscam016#0,001;
#dscam016#0,999;
;
NULL,Impresion;
|FIN;

|PROCESO Impre; |TIPO 4;
   |IMPRE 0;
   |SI FSalida < 0; |ACABA; |FINSI;
   aInforme = "Carta asignacion a cobrador"; |HAZ ObtenInforme;
   |INFOR aInforme;
   |SI FSalida < 0; |ACABA; |FINSI;
   |ABRE #dscam048; |ABRE #dscam003;
   #dscam048#0 = #dscam016#1;
   |LEE 000#dscam048.=;
   SwNumAsig = 1; SwTotal   = 0;
   |BUCLE Impresion;
   SwTotal   = 1; |PRINT;
   |PIEINF;
   |FININF;
   |FINIMP;
   |CIERRA #dscam048; |CIERRA #dscam003;
|FPRC;

|PROCESO Tipo00Sit; |TIPO 0;
   |SI nSwArtenvas ! 1; |ACABA; |FINSI;

   |ABRE #dscam217;
   #dscam217#0 = #dscam016#6;
   |LEE 000#dscam217.=;
   |SI FSalida = 0;
      #dscam016#7 = #dscam217#1; |PINTA #dscam016#7;
   |SINO;
      |AVISO;
      |MENAV "    Situacion inexistente";
   |FINSI;
   |CIERRA #dscam217;
|FPRC;

|PROCESO Tipo07Sit; |TIPO 7;
   |SI nSwArtenvas ! 1; |ACABA; |FINSI;

   |MENSA "    <F11> Consulta de situaciones";
   |C_M #dscam016#7, 1, "N";
|FPRC;

|PROCESO Tipo66Sit; |TIPO 66;
   |SI nSwArtenvas ! 1; |ACABA; |FINSI;

   |ABRE #dscam217;
   |CONSULTA_CLAVE #1#dscam217;
   |SI FSalida = 0;
      #dscam016#6 = #dscam217#0; |PINTA #dscam016#6;
      #dscam016#7 = #dscam217#1; |PINTA #dscam016#7;
   |FINSI;
   |CIERRA #dscam217;
   |ERROR;
|FPRC;

|PROCESO SelecParrilla;
   |SI #dscaw224#8 = "N";
      |C_M #dscaw224#0, 1, "S"; |C_M #dscaw224#1, 1, "S";
      |PARA nCont = 9; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
         #dscaw224#nCont# = ""; |PINTA #dscaw224#nCont#;
         |C_M #dscaw224#nCont#, 1, "N";
      |SIGUE;
   |SINO;
      #dscaw224#0 = ""; |PINTA #dscaw224#0;
      #dscaw224#1 = "zz"; |PINTA #dscaw224#1;
      |C_M #dscaw224#0, 1, "N"; |C_M #dscaw224#1, 1, "N";
      |PARA nCont = 9; |SI nCont [ 18; |HACIENDO nCont = nCont + 1;
         |C_M #dscaw224#nCont#, 1, "S";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO T66Rep; |TIPO 66;
   |ABRE #dscam048;
   #dscam048#0 = #dscaw224#Campo#;
   |LEE 000#dscam048.];
   |CONSULTA_CLAVE #1#dscam048;
   |SI FSalida = 0;
      #dscaw224#Campo# = #dscam048#0; |PINTA #dscaw224#Campo#;
      |ERROR;
   |FINSI;
   |CIERRA #dscam048;
|FPRC;

|PROCESO MiraRep;
   |SI #dscaw224#Campo# = "  "; |ACABA; |FINSI;

   |ABRE #dscam048;
   #dscam048#0 = #dscaw224#Campo#;
   |LEE 000#dscam048.=;
   |SI FSalida = 0;
      #dscaw224#Campo# = #dscam048#0; |PINTA #dscaw224#Campo#;
   |SINO;
      |AVISO;
      |MENAV "    Representante inexistente";
      |ERROR;
   |FINSI;
   |CIERRA #dscam048;
|FPRC;
