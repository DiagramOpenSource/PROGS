|FICHEROS;
     dscaz241 #0;
     dscam003 #3;
     agifa010@ #10;
     agifa059@ #59;
|FIN;

|VARIABLES;
     &eaObs1 = "";
     &eaObs2 = "";
     &eaObs3 = "";
     aPath = "";
     aAlfa = "";
     aDLiq = "";
     aHLiq = "";
     nEmpresa = 0;
     aEmpresa = "";
     aSer = "";
     nFac = 0;
     nRec = 0;
|FIN;

|PROCESO agifa059;
     #agifa010@#52 = #agifa059@#15;
     #agifa010@#0 = #agifa059@#2;
     |LEE 020#agifa010@.=;
     |SI FSalida ! 0; |DDEFECTO #agifa010@; |FINSI;

     eaObs1 = #agifa010@#55;
     eaObs2 = #agifa010@#56;
     eaObs3 = #agifa010@#57;
     |PRINT;
|FPRC;

|DEFBUCLE agifa059;
     #agifa059@#1003;
     ;
     aSer, nFac, 001;
     aSer, nFac, 999;
     ;
     NULL, agifa059;
|FIN;

|PROCESO dscam003;
     |SI nEmpresa ! #3#46;
          |SI nEmpresa ! 0;
               |CIERRA #agifa010@;
          |FINSI;
          nEmpresa = #3#46;
          aEmpresa = ("00000" + #3#46) % -105;
          aAlfa = aPath + "fich/" + aEmpresa + "/";
          |PATH_DAT #agifa010@#aAlfa#;
          |PATH_DAT #agifa059@#aAlfa#;
          |ABRE #agifa010@;
     |FINSI;
     |SI aSer ! #3#0; |O nFac ! #3#1; |O nRec ! #3#2;
          aSer = #3#0;
          nFac = #3#1;
          nRec = #3#2;
          |BUCLE agifa059;
     |FINSI;
|FPRC;

|PROCESO Filtra;
     |SI #0#8 ! "T";
          |SI #0#8 = "L"; |Y #3#14 ! "L"; |ERROR; |FINSI;
          |SI #0#8 = "N"; |Y #3#14 = "L"; |ERROR; |FINSI;
     |FINSI;
     |SI #3#46 = 0; |ERROR; |FINSI;
|FPRC;

|DEFBUCLE dscam003;
     #3#11;
     4, 12, 30;
     #0#0, #0#4, "     ", #0#2, #0#6, #0#9;
     #0#1, #0#5, "zzzzz", #0#3, #0#7, #0#10;
     ;
     NULL, Filtra, NULL, NULL, NULL, dscam003;
     #3#46, #3#0, #3#1, #3#2, #3#40;
|FIN;

|PROCESO T3; |TIPO 3;
     aPath = #48#17; |QBF aPath;

     |SI aPath = "";
          |MENAV "0000Path gestion no informado en el acceso a empresas.";
          |ACABA;
     |FINSI;


     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "dscaz241";
          |SI FSalida = 0;
               aAlfa = aPath + "def/agifa010";
               |CARGA_DEF aAlfa, agifa010@;
               |SI FSalida = 0;
                    aAlfa = aPath + "def/agifa059";
                    |CARGA_DEF aAlfa, agifa059@;
                    |SI FSalida = 0;
                         |BUCLE dscam003;
                         |SI nEmpresa ! 0;
                              |CIERRA #agifa010@;
                         |FINSI;
                         |DESCARGA_DEF #agifa059@;
                    |FINSI;
                    |DESCARGA_DEF #agifa010@;
               |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
