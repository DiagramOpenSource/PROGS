|FICHEROS;
     dscaz155 #0;
     dscam020 #20;       ||Mant.Clasif.riesgo
     dscam105 #105;      ||Historico Clas.Riesg
     dscam051 #142;      ||Parametros Generales
|FIN;

|VARIABLES;
     aMensaje = "";
     nUltimo = 0;
|FIN;

|PROCESO GrabaHistorico;
     #dscam105#0 = #dscam020#0;
     #dscam105#1 = #dscam020#2;
     #dscam105#2 = 999;
     |LEE 000#dscam105.];
     |SI FSalida = 0;
          |LEE 000#dscam105.a;
     |SINO;
          |LEE 000#dscam105.u;
     |FINSI;
     |SI FSalida = 0; |Y #dscam105#0 = #dscam020#0; |Y #dscam105#1 = #dscam020#2;
          nUltimo = #dscam105#2 + 1;
     |SINO;
          nUltimo = 1;
     |FINSI;
     |DDEFECTO #dscam105;
     #dscam105#0 = #dscam020#0;
     #dscam105#1 = #dscam020#2;
     #dscam105#2 = nUltimo;
     |LEE 101#dscam105.=;
     |SI FSalida ! 0;
          #dscam105#3 = #dscam020#4;
          #dscam105#4 = #dscam020#14;
          #dscam105#5 = #dscam020#15;
          #dscam105#6 = #dscam020#16;
          #dscam105#7 = #dscam020#17;
          |GRABA 020#dscam105.n
          |LIBERA #dscam105;
     |FINSI;
|FPRC;


|PROCESO dscam020;
     |HAZ GrabaHistorico;
|FPRC;

|DEFBUCLE dscam020;
 #dscam020#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, dscam020;
|FIN;

|PROGRAMA;
     |ABRE #dscam051;
     |LEE 000#dscam051.p;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #dscam051#6 = "N";        ||Usar Compa¤ias?
          |ACABA;
     |FINSI;
     |CIERRA #dscam051;

     |CLS;

     |ABRE #dscam105;

     |LEE 000#dscam105.p;
     |SI FSalida ! 0;
          |BUCLE dscam020;
     |FINSI;

     |CIERRA #dscam105;
|FPRO;
