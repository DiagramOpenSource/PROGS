|FICHEROS;
   dscaw069 #0;
   dscam014 #1;
   dscam051 #2;
|FIN;

|VARIABLES;
   &Pagos = 0; &enRemesa = 0;
   TotalSel = 0;

   CodClie = ""; CtaClie = "";
   Comodin = "";
|FIN;

|PROCESO Marcalo; |TIPO 11;
   |SI FSalida = 10;
      |SI #dscaw069#4 = " ";
         |SI CodClie ! ""; |Y CtaClie ! ""; |Y enRemesa = 0;
            |SI #dscaw069#6 ! CtaClie; |O #dscaw069#5 ! CodClie;
               |MENAV "    El proveedor del documento marcado no coincide con el de los anteriores";
               |ERROR; |ACABA;
            |FINSI;
         |SINO;
            CodClie = #dscaw069#5; CtaClie = #dscaw069#6;
         |FINSI;
         |ABRE #dscam051;
         |LEE 000#dscam051.p;
         |SI FSalida ! 0;
            |DDEFECTO #dscam051;
            |GRABA 020#dscam051.n;
         |FINSI;
         |CIERRA #dscam051;

         #dscaw069#4 = "*";
         TotalSel = TotalSel + #dscaw069#3;
         |MODULO Comodin;
         |SI #dscam051#3 = "S"; |Y Comodin = "dscam012";
            |SI TotalSel > #dscam014#12; |Y Pagos = 0;
               |MENAV "    Sobrepasado el riesgo bancario concedido";
            |FINSI;
         |FINSI;
      |SINO;
         #dscaw069#4 = " ";
         TotalSel = TotalSel - #dscaw069#3;
         |SI TotalSel = 0;
            CodClie = ""; CtaClie = "";
         |FINSI;
      |FINSI;
      |GRABA 020#dscaw069.a;
      Comodin = ("          " + TotalSel) % -110;
      Comodin = " Total seleccion : " + Comodin;
      |ATRI I;
      |PINTA 2122, Comodin;
      |ATRI N;
   |FINSI;
|FPRC;

|PROCESO Tipo5; |TIPO 5;
   #dscaw069#7 = 1;
   |LINEAS_BI_ATRI #dscaw069#7,S,D,-1;
|FPRC;
