|FICHEROS;
   dscaz133 #0;

   dscam003 #1;
   dscaw097 #2;
   dscaw098 #3;
   dscaw099 #4;
   &agif024@ #100;

   dscam051 #50;
|FIN;

|VARIABLES;
   Primero = 1;
   nCont = 0;
   SwError = 0;
   RepAnt = "";

   &aCodigo = "";
   &MaxDigit = 0;
   &SwDetalle = 0;
   &SwPieCli  = 0;
   &Fichero    = ""; &Tipo = ""; &Cmp = ""; &CmpNum = 0;
   &DirCliente = ""; &Cp   = ""; &PobCliente = ""; &ProvCliente = "";
   &Telefono   = ""; &Fax  = ""; &Movil      = ""; &PersCont    = "";
   &aInforme = "";
   &eaCodigo    = "";
   &eaTipoCod   = "";
   &aCuenta     = "";
   &eaNif       = "";
   &eaNombre    = "";
   &eaDireccion = "";
   &eaPoblacion = "";
   &eaProvincia = "";
   &eaCP        = "";
   &eaCP1       = "";
   &eaCP2       = "";
   &eaTelefono  = "";
   &TipoCliente = ""; &CodCliente = "";
   &DCampoG = 0;      &HCampoG = 0;
   &DCampoC = 0;      &HCampoC = 0;

   CodCliAnt = ""; CtaCliAnt = "";
   nTecla = 0;     nSwHay    = 0;

   Comodin = ""; Comodin1 = "";
   Cuenta = "";
   aLong = ""; nLong = 0;
   Parte1 = "";
   Parte2 = "";
   Posic1 = 0;
   Posic2 = 0;
   FEstado = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
|FIN;

|PROCESO MiraCliente;
   |SI FSalida = 10;
      TipoCliente = "G"; DCampoG = 28; HCampoG = 29;
      |HAZ ExisteCliente;
      #dscaz133#Campo# = CodCliente; |PINTA #dscaz133#Campo#;
   |FINSI;
|FPRC;

|PROCESO MiraCuenta;
   aAlfa1 = " " * 12; aAlfa2 = "z" * 12;
   |SI #dscaz133#30 ! aAlfa1; |O #dscaz133#31 ! aAlfa2;
      #dscaz133#28 = "      "; |PINTA #dscaz133#28;
   |FINSI;

   |SI FSalida = 10;
      TipoCliente = "C"; DCampoC = 30; HCampoC = 31;
      |HAZ ExisteCliente;
      #dscaz133#Campo# = CodCliente; |PINTA #dscaz133#Campo#;
   |FINSI;
|FPRC;

|PROCESO PuntoCuenta; |TIPO 6;
   nTecla = FSalida;
      Cuenta = #Fichero@#Campo#;
      Cuenta = Cuenta - ".";
      |PARA; |SI FSalida ! 0; |HACIENDO;
         FEstado = FSalida;
         Posic1 = ((FEstado / 100) ! 0) + 99;
         Posic2 = FEstado + 98;
         Parte1 = Cuenta % Posic1;
         Parte2 = Cuenta % Posic2;
         |QBF Cuenta;
         aLong = Cuenta % 0; nLong = aLong;
         nLong = MaxDigit - nLong;
         Cuenta = "0" * nLong;
         Cuenta = Parte1 + Cuenta + Parte2;
         Cuenta = Cuenta - ".";
      |SIGUE;
      #Fichero@#Campo# = Cuenta; |PINTA #Fichero@#Campo#;
   FSalida = nTecla;
|FPRC;

|PROCESO SelRep;
   |SI #dscaz133#0 = "S";
      |PARA nCont = 1; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz133#nCont#,1,"S";
      |SIGUE;
      #dscaz133#32 = "  "; |PINTA #dscaz133#32; |C_M #dscaz133#32,1,"N";
      #dscaz133#33 = "zz"; |PINTA #dscaz133#33; |C_M #dscaz133#33,1,"N";
   |SINO;
      |PARA nCont = 1; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
         #dscaz133#nCont# = "  "; |PINTA #dscaz133#nCont#; |C_M #dscaz133#nCont#,1,"N";
      |SIGUE;
      |C_M #dscaz133#32,1,"S"; |C_M #dscaz133#33,1,"S";
   |FINSI;
|FPRC;

|PROCESO SelTR;
   |SI #dscaz133#11 = "S";
      |PARA nCont = 12; |SI nCont [ 21; |HACIENDO nCont = nCont + 1;
         |C_M #dscaz133#nCont#,1,"S";
      |SIGUE;
      #dscaz133#26 = 01; |PINTA #dscaz133#26; |C_M #dscaz133#26,1,"N";
      #dscaz133#27 = 99; |PINTA #dscaz133#27; |C_M #dscaz133#27,1,"N";
   |SINO;
      |PARA nCont = 12; |SI nCont [ 21; |HACIENDO nCont = nCont + 1;
         #dscaz133#nCont# = 0; |PINTA #dscaz133#nCont#; |C_M #dscaz133#nCont#,1,"N";
      |SIGUE;
      |C_M #dscaz133#26,1,"S"; |C_M #dscaz133#27,1,"S";
   |FINSI;
|FPRC;

|PROCESO Imprime;
      |DBASE aAlfa; |QBF aAlfa;
      Comodin1 = ("00000" + #dscaw097#10) % -105;
      Comodin1 = aAlfa + "fich/" + Comodin1 + "/";
      |PATH_DAT #dscam003#Comodin1#;

      |ABRE #dscam003;
      #dscam003#40 = #dscaw097#9;
      |LEE 000#dscam003.=;
      |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;
      |CIERRA #dscam003;

      #dscaw099#0 = #dscaw097#10;
      |LEE 000#dscaw099.=;
      |SI FSalida ! 0; |DDEFECTO #dscaw099; |FINSI;

      #dscam003#40 = #dscaw097#9; |LEE 000#dscam003.=; |HAZ TomaDecim;
      eaCodigo = #dscam003#32; eaTipoCod = "C"; aCuenta = #dscam003#5; |HAZ LeeDatos;
      DirCliente = eaDireccion;
      Cp = eaCP;
      PobCliente = eaPoblacion;
      ProvCliente = eaProvincia;
      Telefono = eaTelefono;

      Fichero = "Clientes"; Tipo = "G";
      Cmp = "Codigo Cliente"; |HAZ ObtenDato;
      #agif024@#CmpNum# = #dscam003#32;
      |LEE 000#agif024@.=;
      |SI FSalida = 0; |Y #agif024@#CmpNum# ! "      ";
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Fax"; |HAZ ObtenDato;
         Fax = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Movil"; |HAZ ObtenDato;
         Movil = #agif024@#CmpNum#;
         Fichero = "Clientes"; Tipo = "G"; Cmp = "Persona Contacto"; |HAZ ObtenDato;
         PersCont = #agif024@#CmpNum#;
      |FINSI;

      aCodigo = #dscam003#32; |QBF aCodigo;
      |SI aCodigo = "";
         aCodigo = #dscam003#5; |QBF aCodigo;
      |FINSI;

      |PRINT;
|FPRC;

|DEFBUCLE Imprime;
#dscaw097#1;
;
INICIO;
FINAL;
;
NULL,Imprime;
|FIN;

|PROCESO Temporal;
   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         |SI #dscam003#71 < #dscaz133#34; |O #dscam003#71 > #dscaz133#35; |ACABA; |FINSI;
      |SINO;
         |SI #dscam003#3 < #dscaz133#34; |O #dscam003#3 > #dscaz133#35; |ACABA; |FINSI;
      |FINSI;
   |SINO;
      |SI #dscam003#3 < #dscaz133#34; |O #dscam003#3 > #dscaz133#35; |ACABA; |FINSI;
   |FINSI;

   |SI #dscam003#14 = "A"; |O #dscam003#14 = "D"; |ACABA; |FINSI;
   |SI #dscam003#69 ! " "; |O #dscam003#47 = "S";
      #dscaw098#0 = #dscam003#32;
      |LEE 000#dscaw098.=;
      |SI FSalida ! 0;
         |DDEFECTO #dscaw098;
         #dscaw098#0 = #dscam003#32;
         #dscaw098#2 = #dscaw099#0;
         |GRABA 020#dscaw098.b;
      |FINSI;
      #dscaw098#1 = #dscaw098#1 + #dscam003#30;
      |GRABA 020#dscaw098.a;
      |ACABA;
   |FINSI;

   |SI #dscaz133#38 = "L";
      |SI #dscam003#14 ! "L"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscaz133#38 = "P";
      |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |ACABA; |FINSI;
   |FINSI;

   SwError = 1;            || Comprueba el representante
   |SI #dscaz133#0 = "S";
      |PARA nCont = 1; |SI nCont [ 10; |HACIENDO nCont = nCont + 1;
         |SI #dscaz133#nCont# = #dscam003#33;
            SwError = 0; |SAL;
         |FINSI;
      |SIGUE;
   |SINO;
      |SI #dscaz133#32 [ #dscam003#33; |Y #dscam003#33 [ #dscaz133#33;
         SwError = 0;
      |FINSI;
   |FINSI;
   |SI SwError = 1; |ACABA; |FINSI;

   SwError = 1;            || Comprueba el tipo de recibo
   |SI #dscaz133#11 = "S";
      |PARA nCont = 12; |SI nCont [ 21; |HACIENDO nCont = nCont + 1;
         |SI #dscaz133#nCont# = #dscam003#12;
            SwError = 0; |SAL;
         |FINSI;
      |SIGUE;
   |SINO;
      |SI #dscaz133#26 [ #dscam003#12; |Y #dscam003#12 [ #dscaz133#27;
         SwError = 0;
      |FINSI;
   |FINSI;
   |SI SwError = 1; |ACABA; |FINSI;

   |DDEFECTO #dscaw097;
   #dscaw097#0 = #dscam003#33;
   #dscaw097#1 = #dscam003#34;
   #dscaw097#2 = #dscam003#12;
   #dscaw097#3 = #dscam003#32;
   #dscaw097#4 = #dscam003#5;

   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         #dscaw097#5 = #dscam003#71;
      |SINO;
         #dscaw097#5 = #dscam003#3;
      |FINSI;
   |SINO;
      #dscaw097#5 = #dscam003#3;
   |FINSI;
   #dscaw097#6 = #dscam003#0;
   #dscaw097#7 = #dscam003#1;
   #dscaw097#8 = #dscam003#2;
   #dscaw097#9 = #dscam003#40;
   #dscaw097#10 = #dscaw099#0;
   #dscaw097#11 = #dscaw099#1;
   |GRABA 020#dscaw097.n;
|FPRC;

|DEFBUCLE Temporal;
#dscam003#1;
0,1,32,5;
000000001,#0#22,#0#24,#0#28,#0#30;
999999999,#0#23,#0#25,#0#29,#0#31;
;
NULL,Temporal;
|FIN;

|PROCESO Empresas;
      |SI FSalida ! 0; |ACABA; |FINSI;
      Comodin = #48#17; |QBF Comodin;
      Comodin1 = ("00000" + #48#15) % -105;
      Comodin1 = Comodin + "fich/" + Comodin1 + "/";
      |PATH_DAT #100 Comodin1;
      |DBASE aAlfa; |QBF aAlfa;
      Comodin1 = ("00000" + #dscaw099#0) % -105;
      Comodin1 = aAlfa + "fich/" + Comodin1 + "/";
      |PATH_DAT #1 Comodin1; |PATH_DAT #50 Comodin1;

      |ABRE #dscam051;
      |LEE 000#dscam051.p;
      |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
      |CIERRA #dscam051;

      |ABRE #agif024@; |ABRE #dscam003;

      |BUCLE Temporal;

      |CIERRA #dscam003; |CIERRA #agif024@;
      nSwHay = 1;
|FPRC;

|DEFBUCLE Empresas;
#dscaw099#1;
;
INICIO;
FINAL;
;
NULL,Empresas;
|FIN;

|PROGRAMA;
   |HAZ Tipo8;

   |CLS;
   |CABEZA "Informe de cobros por representante";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |SUB_EJECUTA "dscaz134";
      aAlfa = "se" + Usuario; |NOME_DAT #dscaw099#aAlfa#;
      |ABRE #dscaw099;

      |DELINDEX #dscaw097; |DELINDEX #dscaw098;

      nSwHay = 0;
      |ABRE #dscaw098; |ABRE #dscaw097;
      |BUCLE Empresas;
      |CIERRA #dscaw098; |CIERRA #dscaw097;

      |SI nSwHay ! 0;
         Impresora = "CrystalReport";
         |IMPRE -1;
         |SI FSalida ! 0; |ACABA; |FINSI;
         aInforme = "Inf.cobros representante mult."; |HAZ ObtenInforme;
         |SI aInforme = "Inf.cobros representante mult."; aInforme = "dscaz481"; |FINSI;
         |INFOR aInforme;
         |SI FSalida ! 0; |ACABA; |FINSI;
         |BUCLE Imprime;
         |PIEINF; |FININF;
         |FINIMP;
      |SINO;
         |MENAV "    Seleccion vac¡a";
      |FINSI;

      |CIERRA #dscaw099; |DELINDEX #dscaw099;
   |FINSI;

   |HAZ Tipo9;
|FPRO;
