|FICHEROS;
     dslpm512 #512;
     dslpm513 #513;
     dslpw037 #937;
|FIN;

|VARIABLES;
     nBoton1_1        = 0;
     nBoton1_2        = 0;
     nBoton1_3        = 0;
     nPanta0          = 0;
     nPanta1          = 0;
     nGrid1           = 0;
     nRango           = 0;
     nPos1            = 0;
     nPos2            = 0;
     nVentana         = 0;

     aFichero         = "";
     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aAlfa            = "";
     aBase            = "";
     aPathPlantilla   = "";

     &enPlantilla     = 0;
     &enDocumento     = 0;
     &enModo          = 0;
     &enAlta          = 0;
|FIN;

|PROCESO BajaPanta1;
     #513#0  = enPlantilla;
     #513#1  = 001;
|FPRC;

|PROCESO AltaPanta1;
     #513#0  = enPlantilla;
     #513#1  = 999;
|FPRC;

|PROCESO TipoDocumento;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #512#0 = #937#0;
     |LEE 000#512=;
     |SI FSalida = 0;
         |MENAV "0000 El Tipo de Documento ya existe.";
         |ERROR;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_1
|| ------------------------------------------------------

|PROCESO Boton1_1;
     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enPlantilla = #937#0;
     enDocumento = 0;
     enModo      = 1;
     |SUB_EJECUTA "dslpw038";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_2
|| ------------------------------------------------------

|PROCESO Boton1_2;
     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enPlantilla = #937#0;
     enDocumento = #513#1;
     enModo      = 2;
     |SUB_EJECUTA "dslpw038";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_3
|| ------------------------------------------------------

|PROCESO Boton1_3;
     aAlfa = "0000N" + &191 + " Esta vd.seguro de dar de baja a " + #513#2 + " ?";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#513=;
     |SI FSalida = 0;
         |DBASE aBase;  |QBF aBase;
         aPathPlantilla = aBase + "documentos/plantillas/";
         aAlfa          = aPathPlantilla + "doc" + (("00" + #513#0) % -102) + (("000" + #513#1) % -103) + ".doc";
         |FBORRA aAlfa;

         |BORRA 020#513a;
         |LIBERA #513;
     |FINSI;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Incio del Programa
|| ------------------------------------------------------

|PROCESO EventoPanta1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#513=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton1_2, "ENABLE";
             |SI enAlta = 1;  |ESTADO_CONTROL nBoton1_3, "ENABLE";  |FINSI;
         |SINO;
             |ESTADO_CONTROL nBoton1_2, "DISABLE";
             |SI enAlta = 1;  |ESTADO_CONTROL nBoton1_3, "DISABLE";  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE nPanta1, "BOTON,{{193}} Alta", 0777, 0898, Boton1_1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{197}} Modificar", 1077, 1198, Boton1_2;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{199}} Baja ", 1377, 1498, Boton1_3;
     nBoton1_3 = FSalida;

     |ESTADO_CONTROL nBoton1_1, "ENABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";

     |SI enAlta = 0;
         |ESTADO_CONTROL nBoton1_1, "HIDE";
         |ESTADO_CONTROL nBoton1_3, "HIDE";
     |FINSI;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |ABRET #513;

     FSalida = 2899;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #513;
|FPRC;

|PROGRAMA;
     |C_M #937#0, 1, "S";

     |ABRE #512;
     |SI enModo ! 1;
         #512#0 = enPlantilla;
         |LEE 000#512=;
         |SI FSalida ! 0;  |DDEFECTO #512; |FINSI;

         #937#0 = #512#0;
         #937#1 = #512#1;

         |C_M #937#0, 1, "N";
     |SINO;
         #937#0 = enPlantilla;
     |FINSI;

     |CABEZA "Datos Plantilla";

     |PINPA #0#937;  nPanta0 = FSalida;
     |PINDA #0#937;

     |PINPA #1#937;  nPanta1 = FSalida;
     |PINDA #1#937;

     nRango = 4 + 8 + 16 + 32;
     nPos1  = 0602;
     nPos2  = 2075;

     |LINEAL_SIMPLE #1#513, nRango, nPos1, nPos2, BajaPanta1, AltaPanta1, EventoPanta1;
     nGrid1 = FSalida;

     |HAZ BotonesPanta1;

     |SI enModo = 1;  |ENDATOS #1#937;  |FINSI;
     |SI enModo = 2;  |ENDATOS #2#937;  |FINSI;

     |SI FSalida = 0;
         #512#0 = #937#0;
         |LEE 101#512=;
         |SI FSalida ! 0;
             |DDEFECTO #512;
             #512#0 = #937#0;
             |GRABA 020#512b;
         |FINSI;
         #512#1 = #937#1;
         |GRABA 020#512a;
         |LIBERA #512;
     |FINSI;
     |CIERRA #512;

     |FIN_CONTROL_WINDOWS nBoton1_1;
     |FIN_CONTROL_WINDOWS nBoton1_2;
     |FIN_CONTROL_WINDOWS nBoton1_3;

     |DESTRUYECONTROL nGrid1;

     |PULSATECLA;
|FPRO;
