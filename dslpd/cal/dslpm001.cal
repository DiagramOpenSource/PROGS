|FICHEROS;
     dslpm000 #0;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm007 #7;
     dslpm008 #8;
     dslpm009 #9;
     dslpm010 #10;
     dslpm011 #11;
     dslpm012 #12;

     dslpm100 #100;
     dslpm500 #500;
     dslpm501 #501;
     dslpm511 #511;
     dslpm512 #512;
     dslpm513 #513;
     dslpm514 #514;
     dslpm999 #999;

     dslpw039 #939,MANTE;
     dslpw050 #950,MANTE;
     dslpw055 #955,MANTE;
     dslpw992 #992;
     dslpw996 #996;
     dslpw998 #998;

     :/gecochek/def/gecom010 #110;
|FIN;

|VARIABLES;
     aMensaje = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aTeclaSub      = "";
     aBase          = "";
     aBaseDoc       = "";
     aPathGecochek  = "";
     aAlfa          = "";
     aAlfa1         = "";
     aUsuario       = "";
     aOperacion     = "";
     aSitAnt        = "";
     aSitAct        = "";
     aHora          = "";
     aDirRecoge     = "";
     aDirFtp        = "";
     aAbre          = "";
     aTXT           = "";
     aPDF           = "";
     aCliente       = "";
     aOrigen        = "";
     aDestino       = "";
     aIPRemoto      = "";
     aDirServ       = "";
     aBaseAplica    = "";
     aDirLocal      = "";
     aDocPdf        = "";
     aFotoOrigen    = "";
     aFotoDestino   = "";
     aLong          = "";
     aLogo          = "";
     aCaracter      = "";
     aDocRemoto     = "";
     aDocServidor   = "";
     aFoto          = "";
     aMarca         = "";
     aNomFichero    = "";

     nReg           = 0;
     nSitAnt        = 0;
     nSitAct        = 0;
     nCampoD        = 0;
     nCampoH        = 0;
     nPanta0        = 0;
     nPanta1        = 0;
     nPanta2        = 0;
     nPanta3        = 0;
     nPanta4        = 0;
     nVentana       = 0;
     nTipoDoc       = 0;
     nCodDoc        = 0;
     nHandle        = 0;
     nDocu          = 0;
     nBorraPan      = 0;
     nLong          = 0;
     nCaracter      = 0;
     nPos           = 0;
     nDTipoActual   = 0;
     nHTipoActual   = 0;
     nDEmpresa      = 0;
     nHEmpresa      = 0;
     nSeleccion     = 0;
     nHisto         = 0;
     nIdSalir       = 0;
     nNume          = 0;

     {2}nNivel      = 0;

     nBotonFoto     = -1;

     nBoton0_1      = 0;
     nBoton0_2      = 0;
     nBoton0_3      = 0;
     nBoton0_4      = 0;
     nBoton0_5      = 0;
     nBoton0_6      = 0;
     nBoton0_7      = 0;
     nBoton0_8      = 0;
     nBoton0_9      = 0;
     nBoton0_10     = 0;
     nBoton0_11     = 0;
     nBoton0_12     = 0;
     nBoton0_13     = 0;

     nBoton1_1      = 0;
     nBoton1_2      = 0;
     nBoton1_3      = 0;
     nBoton1_4      = 0;
     nBoton1_5      = 0;
     nBoton1_6      = 0;
     nBoton1_7      = 0;

     nBoton2_1      = 0;
     nBoton2_2      = 0;
     nBoton2_3      = 0;
     nBoton2_4      = 0;
     nBoton2_6      = 0;
     nBoton2_7      = 0;
     nBoton2_8      = 0;
     nBoton2_9      = 0;

     nBoton3_1      = 0;
     nBoton3_2      = 0;
     nBoton3_3      = 0;
     nBoton3_4      = 0;
     nBoton3_5      = 0;
     nBoton3_6      = 0;
     nBoton3_7      = 0;
     nBoton3_8      = 0;
     nBoton3_9      = 0;
     nBoton3_10     = 0;
     nBoton3_11     = 0;
     nBoton3_12     = 0;
     nBoton3_13     = 0;
     nBoton3_14     = 0;
     nBoton3_15     = 0;
     nBoton3_16     = 0;
     nBoton3_17     = 0;
     nBoton3_18     = 0;
     nBoton3_19     = 0;

     nBoton4_1      = 0;
     nBoton4_2      = 0;
     nBoton4_3      = 0;
     nBoton4_4      = 0;
     nBoton4_5      = 0;
     nBoton4_6      = 0;
     nBoton4_7      = 0;
     nBoton4_8      = 0;
     nBoton4_9      = 0;
     nBoton4_10     = 0;
     nBoton4_11     = 0;
     nBoton4_12     = 0;

     nFoco1         = 0;
     nFoco2         = 0;
     nFoco3         = 0;
     nFoco4         = 0;

     nGrid1         = -1;
     nGrid2         = -1;
     nGrid3         = -1;
     nGrid4         = -1;

     nTipoActual    = 0;
     nTipoFuturo    = 0;
     nTipoPanta1    = 0;
     nTipoPanta2    = 0;
     nTipoPanta3    = 0;
     nTipoPanta4    = 0;
     nRango         = 0;
     nPos1          = 0;
     nPos2          = 0;

     {1}aContiene   = "";

     &enCliente     = 0;
     &eaNomClie     = "";
     &enEstado      = 0;
     &enModo        = 0;
     &enDocumento   = 0;
     &enIncidencias = 0;
     &enFormulario  = 0;
     &enError       = 0;
     &enErrorCorreo = 0;
     &enErrorDoc    = 0;
     &eaPathAcrobat = "";
     &enMasivo      = 0;
     &eaTipoEnvio   = "";
     &enVarios      = 0;
     &enEncuesta    = 0;
     &enAdministra  = 0;
     &enAuditoria   = 0;
|FIN;

|PROCESO BajaPanta1;
     #1#0  = nTipoPanta1;
     #1#1  = 00001;
|FPRC;

|PROCESO AltaPanta1;
     #1#0  = nTipoPanta1;
     #1#1  = 99999;
|FPRC;

|PROCESO BajaPanta2;
     #1#0  = nTipoPanta2;
     #1#1  = 00001;
|FPRC;

|PROCESO AltaPanta2;
     #1#0  = nTipoPanta2;
     #1#1  = 99999;
|FPRC;

|PROCESO BajaPanta3;
     #1#0  = nTipoPanta3;
     #1#1  = 00001;
|FPRC;

|PROCESO AltaPanta3;
     #1#0  = nTipoPanta3;
     #1#1  = 99999;
|FPRC;

|PROCESO BajaPanta4;
     #1#0  = nTipoPanta4;
     #1#1  = 00001;
|FPRC;

|PROCESO AltaPanta4;
     #1#0  = nTipoPanta4;
     #1#1  = 99999;
|FPRC;

|PROCESO dslpm001M;
     #1#39 = aMarca;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE dslpm001M;
     #1#1;
     ;
     nDTipoActual, nDEmpresa;
     nHTipoActual, nHEmpresa;
     be;
     NULL, dslpm001M;
|FIN;

|PROCESO dslpm001S;
     |SI #1#0 = 20;
         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         |SI #950#0 = "C";
             aAlfa = #1#17;  |QBF aAlfa;
             |SI aAlfa = "";  |ACABA;  |FINSI;
         |FINSI;

         enDocumento = #1#20;
         enEstado    = #1#0;
         enCliente   = #1#1;
         enMasivo    = 1;
         |SUB_EJECUTA "dslpz001";
         |SI enError = 1;
             |LIBERA #1;
             |FINVENTANA nVentana;
             |ACABA;
         |FINSI;
         |FINVENTANA nVentana;

         enCliente     = #1#1;
         enEstado      = #1#0;
         eaTipoEnvio   = #950#0;
         enErrorCorreo = 0;
         |SI #950#0    = "C";  enErrorCorreo = 1;  |FINSI;

         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;
         |SUB_EJECUTA "dslpm008";
         |FINVENTANA nVentana;

         |SI eaTipoEnvio = "C";
             eaTipoEnvio = "";
             |SI enErrorCorreo = 1;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     nSitAnt    = #1#0;
     |BORRA 020#1a;

     #1#0  = nTipoFuturo;
     #1#39 = "";
     |SI nCodDoc ! 0;  #1#20 = nCodDoc;  |FINSI;
     |GRABA 020#1n;

     nSitAct    = #1#0;
     |HAZ GrabaLogs;
     eaTipoEnvio = "";
|FPRC;

|DEFBUCLE dslpm001S;
     #1#1;
     39;
     nDTipoActual, nDEmpresa, "*";
     nHTipoActual, nHEmpresa, "*";
     be;
     NULL, dslpm001S;
|FIN;

|| --------------------------------------------
|| Proceso de sacar Documentos
|| --------------------------------------------

|PROCESO Baja513;
     #513#0 = nTipoDoc;
     #513#1 = 1;
|FPRC;

|PROCESO Alta513;
     #513#0 = nTipoDoc;
     #513#1 = 999;
|FPRC;

|PROCESO Evento513;
     |SI FSalida = 1;
         |LEE 000#513=;
     |FINSI;

     |SI FSalida = 4;
         nCodDoc = #513#1;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO SacaDocumentos;
     |ABRE #513;
     #513#0 = nTipoDoc;
     #513#1 = 2;
     |LEE 000#513=;
     |SI FSalida = 0;
         |VENTANA 1101, 2799, -1, 1, "";
         nVentana = FSalida;

         |LEE 000#513p;

         nRango       = 4 + 8 + 16;
         nPos1        = 1102;
         nPos2        = 2698;
         nCodDoc      = 0;

         |LINEAL_SIMPLE #1#513, nRango, nPos1, nPos2, Baja513, Alta513, Evento513;

         |FINVENTANA nVentana;

         |SI nCodDoc = 0;
             |MENAV "0000 Seleccionar un Documento.";
             |CIERRA #513;
             |ACABA;
         |FINSI;
     |SINO;
         nCodDoc = 1;
     |FINSI;
     |CIERRA #513;
|FPRC;

|| ------------------------------------------------------
|| Procesos Grabacion Log
|| ------------------------------------------------------

|PROCESO GrabaLogs;
     aSitAnt = "";
     aSitAct = "";

     |ABRE #514;

     #514#0 = nSitAnt;
     |LEE 000#514=;
     |SI FSalida = 0;  aSitAnt = #514#1;  |FINSI;

     #514#0 = nSitAct;
     |LEE 000#514=;
     |SI FSalida = 0;  aSitAct = #514#1;  |FINSI;

     |CIERRA #514;

     |HORA aHora;

     |ABRE #999;
     nReg = 1;
     |LEE 000#999u;
     |SI FSalida = 0;
         nReg = #999#0 + 1;
     |FINSI;

     #999#0  = nReg;
     |GRABA 020#999b;

     #999#1  = aUsuario;
     #999#2  = ~;
     #999#3  = aHora;
     #999#4  = #1#1;
     #999#5  = #1#2;
     #999#6  = aOperacion;
     #999#7  = nSitAnt;
     #999#8  = aSitAnt;
     #999#9  = nSitAct;
     #999#10 = aSitAct;

     |GRABA 020#999a;
     |LIBERA #999;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_1
|| ------------------------------------------------------

|PROCESO gecom010;
     aOperacion = "Actualizacion desde la importacion de datos.";

     #1#1 = #110#0;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0  = 10;
         #1#1  = #110#0;
         #1#19 = "S";
         |GRABA 020#1b;

         aOperacion = "Alta desde la importacion de datos.";
     |FINSI;

     |SI #1#19 = "N";
         aAlfa = "0000 De la importacion viene codigo " + #1#1;
         aAlfa = aAlfa + " que esta dado de alta manual por la aplicacion. Revisen datos.";
         |MENAV aAlfa;

         |ACABA;
     |FINSI;

     |PARA nCampoD = 1;  |SI nCampoD [ 15;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 1;
           #1nCampoH = #110nCampoD;
     |SIGUE;

     aAlfa = #110#16;  |QBF aAlfa;
     |SI aAlfa ! "";
         #1#17 = #110#16;
     |FINSI;

     #1#19 = "S";

     |GRABA 020#1a;
     |LIBERA #1;

     #500#0 = #1#10;
     |LEE 101#500=;
     |SI FSalida ! 0;
         |DDEFECTO #500;
         #500#0 = #1#10;
         #500#1 = #1#13;
         |GRABA 020#500n;
         |LIBERA #500;
     |FINSI;

     #501#0 = #1#10;
     #501#1 = #1#11;
     |LEE 101#501=;
     |SI FSalida ! 0;
         |DDEFECTO #501;
         #501#0 = #1#10;
         #501#1 = #1#11;
         #501#2 = #1#12;
         #501#3 = #1#13;
         |GRABA 020#501n;
         |LIBERA #501;
     |FINSI;

     #100#0 = #1#3;
     |LEE 101#100=;
     |SI FSalida ! 0;
         |DDEFECTO #100;
         #100#0  = #1#3;
         |GRABA 020#100b;
     |FINSI;

     #100#1  = #1#2;
     #100#2  = #1#4;
     #100#3  = #1#5;
     #100#4  = #1#6;
     #100#5  = #1#7;
     #100#6  = #1#8;
     #100#7  = #1#9;
     #100#8  = #1#10;
     #100#9  = #1#11;
     #100#10 = #1#12;
     #100#11 = #1#13;
     #100#12 = #1#15;
     #100#13 = #1#16;
     #100#14 = #1#17;

     |GRABA 020#100a;
     |LIBERA #100;

     nSitAnt    = 0;
     nSitAct    = #1#0;
     |HAZ GrabaLogs;
|FPRC;

|DEFBUCLE gecom010;
     #110#1;
     ;
     00001;
     99999;
     ;
     NULL, gecom010;
|FIN;

|PROCESO Boton0_1;
     nBorraPan = 0;

     |SI #1#0 ] 10;  |Y #1#0 [ 19;
         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#992, nPanta1;
         nBorraPan = 1;
     |FINSI;

     |SI #1#0 ] 20;  |Y #1#0 [ 29;
         |BORRA_HIJOS_PAN #2#1;
         |SUB_PINPA #0#992, nPanta2;
         nBorraPan = 2;
     |FINSI;

     |SI #1#0 ] 30;  |Y #1#0 [ 39;
         |BORRA_HIJOS_PAN #3#1;
         |SUB_PINPA #0#992, nPanta3;
         nBorraPan = 3;
     |FINSI;

     |SI #1#0 ] 40;  |Y #1#0 [ 49;
         |BORRA_HIJOS_PAN #4#1;
         |SUB_PINPA #0#992, nPanta4;
         nBorraPan = 4;
     |FINSI;

     |SELECT #2#1;

     |ABRE #100;
     |ABRE #500;
     |ABRE #501;
     |BUCLE gecom010;
     |CIERRA #100;
     |CIERRA #500;
     |CIERRA #501;

     |SELECT #1#1;

     |SI nBorraPan = 1;
         |BORRA_HIJOS_PAN #1#1;
     |FINSI;

     |SI nBorraPan = 2;
         |BORRA_HIJOS_PAN #2#1;
     |FINSI;

     |SI nBorraPan = 3;
         |BORRA_HIJOS_PAN #3#1;
     |FINSI;

     |SI nBorraPan = 4;
         |BORRA_HIJOS_PAN #4#1;
     |FINSI;

     |SI nGrid1 ! -1;
         |REFRESCACONTROL nGrid1;
         |REFRESCACONTROL nGrid2;
         |REFRESCACONTROL nGrid3;
         |REFRESCACONTROL nGrid4;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_2
|| ------------------------------------------------------

|PROCESO Menav;
     aAlfa  = "0000  El Cliente se encuentra en: ";
     aAlfa1 = "";

     |ABRE #514;
     #514#0 = #1#0;
     |LEE 000#514=;
     |SI FSalida = 0;  aAlfa1 = #514#1;  |FINSI;
     |CIERRA #514;

     aAlfa = aAlfa + aAlfa1;
     |MENAV aAlfa;
|FPRC;

|PROCESO Boton0_2;
     |CONSULTA_CLAVE #2#1;
     |SI FSalida = 0;
         |HAZ Menav;
     |FINSI;

     |SELECT #1#1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_3
|| ------------------------------------------------------

|PROCESO Boton0_3;
     nVentana = FSalida;

     enModo    = 1;
     enEstado  = 10;
     enCliente = 0;
     |SUB_EJECUTA "dslpw036";

     |SI enCliente ! 0;
         #1#0 = 10;
         #1#1 = enCliente;
         |LEE 000#1=;

         nSitAnt    = 0;
         aOperacion = "Alta cliente nuevo";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;

         |REFRESCACONTROL nGrid1;
         |REFRESCACONTROL nGrid2;
         |REFRESCACONTROL nGrid3;
         |REFRESCACONTROL nGrid4;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_4
|| ------------------------------------------------------

|PROCESO Boton0_4;
     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enModo    = 2;
     enEstado  = #1#0;
     enCliente = #1#1;
     |SUB_EJECUTA "dslpw036";

     |FINVENTANA nVentana;

     nSitAnt    = #1#0;
     aOperacion = "Modificacion datos del cliente";
     nSitAct    = #1#0;
     |HAZ GrabaLogs;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
     |REFRESCACONTROL nGrid3;
     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_5
|| ------------------------------------------------------

|PROCESO Boton0_5;
     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enCliente     = #1#1;
     eaNomClie     = #1#2;
     enDocumento   = 0;
     enFormulario  = 0;
     enIncidencias = 1;
     |SUB_EJECUTA "dslpw995";

     |FINVENTANA nVentana;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_6
|| ------------------------------------------------------

|PROCESO Boton0_6;
     |SI #1#0 ] 10;  |Y #1#0 [ 19;
         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#939, nPanta1;
     |FINSI;

     |SI #1#0 ] 20;  |Y #1#0 [ 29;
         |BORRA_HIJOS_PAN #2#1;
         |SUB_PINPA #0#939, nPanta2;
     |FINSI;

     |SI #1#0 ] 30;  |Y #1#0 [ 39;
         |BORRA_HIJOS_PAN #3#1;
         |SUB_PINPA #0#939, nPanta3;
     |FINSI;

     |SI #1#0 ] 40;  |Y #1#0 [ 49;
         |BORRA_HIJOS_PAN #4#1;
         |SUB_PINPA #0#939, nPanta4;
     |FINSI;

     |ABRE #514;
     #514#0 = #1#0;
     |LEE 000#514=;
     |SI FSalida = 0;  aAlfa1 = #514#1;  |FINSI;
     |CIERRA #514;

     nIdSalir = 0;
     InNivel   = nNivel1<-;
     nNivel1   = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;

     nIdSalir = nNivel2;
     |ESTADO_CONTROL nIdSalir, "HIDE";

     #939#0 = #1#1;
     #939#1 = #1#2;
     #939#2 = #1#0;
     #939#3 = #514#1;
     #939#4 = 0;
     #939#5 = "";
     |SI enAuditoria = 1;
         #939#4 = 20;
         #939#5 = "Oferta (Para enviar ofertas)";
     |FINSI;

     |PINDA #0#939;
     |ENDATOS #1#939;
     |SI FSalida = 0;  |Y #939#4 ! 0;
         |SI #1#0 ] 10;  |Y #1#0 [ 19;  |BORRA_HIJOS_PAN #1#1;  |FINSI;
         |SI #1#0 ] 20;  |Y #1#0 [ 29;  |BORRA_HIJOS_PAN #2#1;  |FINSI;
         |SI #1#0 ] 30;  |Y #1#0 [ 39;  |BORRA_HIJOS_PAN #3#1;  |FINSI;
         |SI #1#0 ] 40;  |Y #1#0 [ 49;  |BORRA_HIJOS_PAN #4#1;  |FINSI;

         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = #939#4;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |SINO;
         |SI #1#0 ] 10;  |Y #1#0 [ 19;  |BORRA_HIJOS_PAN #1#1;  |FINSI;
         |SI #1#0 ] 20;  |Y #1#0 [ 29;  |BORRA_HIJOS_PAN #2#1;  |FINSI;
         |SI #1#0 ] 30;  |Y #1#0 [ 39;  |BORRA_HIJOS_PAN #3#1;  |FINSI;
         |SI #1#0 ] 40;  |Y #1#0 [ 49;  |BORRA_HIJOS_PAN #4#1;  |FINSI;
     |FINSI;

     |ESTADO_CONTROL nIdSalir, "SHOW";

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
     |REFRESCACONTROL nGrid3;
     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_7
|| ------------------------------------------------------

|PROCESO Boton0_7;
     ||ARA38
     |ABRE #dslpm512;
     |LEE 000#dslpm512.p;
     |SI FSalida ! 0;
          aMensaje = "0000Falta instalar Ficheros Maestros | Plantillas de Documentos";
          |MENAV aMensaje;
          |CIERRA #dslpm512;
          |ACABA;
     |FINSI;
     |CIERRA #dslpm512;

     |ESTADO_CONTROL nBoton0_7,  "DISABLE";
     nBorraPan = 0;

     |SI #1#0 ] 10;  |Y #1#0 [ 19;
         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#998, nPanta1;
         nBorraPan = 1;
     |FINSI;

     |SI #1#0 ] 20;  |Y #1#0 [ 29;
         |BORRA_HIJOS_PAN #2#1;
         |SUB_PINPA #0#998, nPanta2;
         nBorraPan = 2;
     |FINSI;

     |SI #1#0 ] 30;  |Y #1#0 [ 39;
         |BORRA_HIJOS_PAN #3#1;
         |SUB_PINPA #0#998, nPanta3;
         nBorraPan = 3;
     |FINSI;

     |SI #1#0 ] 40;  |Y #1#0 [ 49;
         |BORRA_HIJOS_PAN #4#1;
         |SUB_PINPA #0#998, nPanta4;
         nBorraPan = 4;
     |FINSI;

     enVarios    = 1;
     enEncuesta  = 1;
     enCliente   = #1#1;
     enDocumento = 61;
     |SUB_EJECUTA_NP "dslpz001";
     enEncuesta = 0;

     |SI nBorraPan = 1;
         |BORRA_HIJOS_PAN #1#1;
     |FINSI;

     |SI nBorraPan = 2;
         |BORRA_HIJOS_PAN #2#1;
     |FINSI;

     |SI nBorraPan = 3;
         |BORRA_HIJOS_PAN #3#1;
     |FINSI;

     |SI nBorraPan = 4;
         |BORRA_HIJOS_PAN #4#1;
     |FINSI;
     |ESTADO_CONTROL nBoton0_7,  "ENABLE";
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_8
|| ------------------------------------------------------


|PROCESO Boton0_8;
     |SI nTipoActual ! 10;  |Y nTipoActual ! 11;  |Y nTipoActual ! 12;
      |Y nTipoActual ! 20;
         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
         |ESTADO_CONTROL nBoton0_10, "DISABLE";
         |ESTADO_CONTROL nBoton0_11, "DISABLE";

         |ACABA;
     |FINSI;

     aMarca       = "*";
     nDTipoActual = nTipoActual;
     nHTipoActual = nTipoActual;
     nDEmpresa    = 1;
     nHEmpresa    = 99999;
     |BUCLE dslpm001M;

     |SI nTipoActual = 10;  |O nTipoActual = 11;  |O nTipoActual = 12;
         |REFRESCACONTROL nGrid1;
         |FOCOTECLADO nGrid1;
     |FINSI;

     |SI nTipoActual = 20;
         |REFRESCACONTROL nGrid2;
         |FOCOTECLADO nGrid2;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_9
|| ------------------------------------------------------

|PROCESO Boton0_9;
     |SI nTipoActual ! 10;  |Y nTipoActual ! 11;  |Y nTipoActual ! 12;
      |Y nTipoActual ! 20;
         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
         |ESTADO_CONTROL nBoton0_10, "DISABLE";
         |ESTADO_CONTROL nBoton0_11, "DISABLE";

         |ACABA;
     |FINSI;

     aMarca = " ";
     nDTipoActual = nTipoActual;
     nHTipoActual = nTipoActual;
     nDEmpresa    = 1;
     nHEmpresa    = 99999;
     |BUCLE dslpm001M;

     |SI nTipoActual = 10;  |O nTipoActual = 11;  |O nTipoActual = 12;
         |REFRESCACONTROL nGrid1;
         |FOCOTECLADO nGrid1;
     |FINSI;

     |SI nTipoActual = 20;
         |REFRESCACONTROL nGrid2;
         |FOCOTECLADO nGrid2;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_10
|| ------------------------------------------------------

|PROCESO Boton0_10;
     |SI nTipoActual ! 10;  |Y nTipoActual ! 11;  |Y nTipoActual ! 12;
      |Y nTipoActual ! 20;
         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
         |ESTADO_CONTROL nBoton0_10, "DISABLE";
         |ESTADO_CONTROL nBoton0_11, "DISABLE";

         |ACABA;
     |FINSI;

     aMarca       = "*";
     nDTipoActual = #1#0;
     nHTipoActual = #1#0;
     nDEmpresa    = #1#1;
     nHEmpresa    = #1#1;
     |BUCLE dslpm001M;

     #1#0 = nDTipoActual;
     #1#1 = nDEmpresa;
     |LEE 000#1=;

     |SI nTipoActual = 10;  |O nTipoActual = 11;  |O nTipoActual = 12;
         |REFRESCACONTROL nGrid1;
         |FOCOTECLADO nGrid1;
     |FINSI;

     |SI nTipoActual = 20;
         |REFRESCACONTROL nGrid2;
         |FOCOTECLADO nGrid2;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_11
|| ------------------------------------------------------

|PROCESO Boton0_11;
     |SI nTipoActual ! 10;  |Y nTipoActual ! 11;  |Y nTipoActual ! 12;
      |Y nTipoActual ! 20;
         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
         |ESTADO_CONTROL nBoton0_10, "DISABLE";
         |ESTADO_CONTROL nBoton0_11, "DISABLE";

         |ACABA;
     |FINSI;

     aMarca       = " ";
     nDTipoActual = #1#0;
     nHTipoActual = #1#0;
     nDEmpresa    = #1#1;
     nHEmpresa    = #1#1;
     |BUCLE dslpm001M;

     #1#0 = nDTipoActual;
     #1#1 = nDEmpresa;
     |LEE 000#1=;

     |SI nTipoActual = 10;  |O nTipoActual = 11;  |O nTipoActual = 12;
         |REFRESCACONTROL nGrid1;
         |FOCOTECLADO nGrid1;
     |FINSI;

     |SI nTipoActual = 20;
         |REFRESCACONTROL nGrid2;
         |FOCOTECLADO nGrid2;
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_12
|| ------------------------------------------------------

|PROCESO dslpm002B;
     |BORRA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE dslpm002B;
     #2#1;
     ;
     #1#1, "            ";
     #1#1, "zzzzzzzzzzzz";
     be;
     NULL, dslpm002B;
|FIN;

|PROCESO dslpm004B;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE dslpm004B;
     #4#1;
     ;
     #1#1, 0001;
     #1#1, 9999;
     be;
     NULL, dslpm004B;
|FIN;

|PROCESO dslpm005B;
     |BORRA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE dslpm005B;
     #5#1;
     ;
     #1#1, 0001, 00001;
     #1#1, 9999, 99999;
     be;
     NULL, dslpm005B;
|FIN;

|PROCESO dslpm006B;
     |BORRA 020#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE dslpm006B;
     #6#1;
     ;
     #1#1, 0001, 00001, "   ";
     #1#1, 9999, 99999, "zzz";
     be;
     NULL, dslpm006B;
|FIN;

|PROCESO dslpm007B;
     |BORRA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE dslpm007B;
     #7#1;
     ;
     #1#1, 0001, 00001, "        ";
     #1#1, 9999, 99999, "zzzzzzzz";
     be;
     NULL, dslpm007B;
|FIN;

|PROCESO dslpm008B;
     |DBASE aBaseDoc;   |QBF aBaseDoc;
     aCliente    = (("00000" + #8#0) % -105);
     aNomFichero = (#8#16 + (("00000" + #8#1) % -105) + "." + #8#16) < "";
     aOrigen     = aBaseDoc + "documentos/clientes/" + aCliente + "/" + aNomFichero;
     |FBORRA aOrigen;

     |SI #8#16 = "PDF";
         aNomFichero = "txt" + (("00000" + #8#1) % -105) + ".txt";
         aOrigen     = aBaseDoc + "documentos/clientes/" + aCliente + "/" + aNomFichero;
         |FBORRA aOrigen;
     |FINSI;

     |BORRA 020#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE dslpm008B;
     #8#1;
     ;
     #1#1, 00001;
     #1#1, 99999;
     be;
     NULL, dslpm008B;
|FIN;

|PROCESO dslpm009B;
     |DBASE aBaseDoc;   |QBF aBaseDoc;
     aCliente    = (("00000" + #9#0) % -105);
     aNomFichero = "GPrivado." + (("000" + #9#1) % -103);
     aOrigen     = aBaseDoc + "documentos/clientes/" + aCliente + "/" + aNomFichero;
     |FBORRA aOrigen;

     |BORRA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE dslpm009B;
     #9#1;
     ;
     #1#1, 001;
     #1#1, 999;
     be;
     NULL, dslpm009B;
|FIN;

|PROCESO dslpm010B;
     |BORRA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE dslpm010B;
     #10#1;
     ;
     #1#1, "            ", 01;
     #1#1, "zzzzzzzzzzzz", 99;
     be;
     NULL, dslpm010B;
|FIN;

|PROCESO dslpm011B;
     |BORRA 020#11a;
     |LIBERA #11;
|FPRC;

|DEFBUCLE dslpm011B;
     #11#1;
     ;
     #1#1, 01;
     #1#1, 99;
     be;
     NULL, dslpm011B;
|FIN;

|PROCESO dslpm012B;
     |BORRA 020#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE dslpm012B;
     #12#1;
     ;
     #1#1, 0001, 00001;
     #1#1, 9999, 99999;
     be;
     NULL, dslpm012B;
|FIN;

|PROCESO dslpm999B;
     |BORRA 020#999a;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dslpm999B;
     #999#2;
     ;
     #1#1, "01.01.0000", "        ";
     #1#1, "31.12.2999", "zzzzzzzz";
     be;
     NULL, dslpm999B;
|FIN;

|PROCESO Boton0_12;
     ||CONFI "0000NEsta vd.seguro que quiere borrar los datos del Cliente y todos los documentos realizados.";
     aAlfa = "0000N" + &191 + " Esta vd.seguro que quiere borrar los datos del Cliente y todos los documentos realizados ?";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     ||CONFI "0000NSeguro !!! ";
     aAlfa = "0000N" + &191 + &191 + &191 + " SEGURO ???";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     ||CONFI "0000NBorrar tambien Historico !!! ";
     aAlfa = "0000N" + &191 + " Borrar tambien Historico ?";
     |CONFI aAlfa;
     nHisto = FSalida;

     |SI #1#19 = "S";
         |MENAV "0000 El Cliente viene de la exportacion, se borran todos sus datos y pasa a Situacion de No Seleccionados";
     |FINSI;

     |BUCLE dslpm002B;
     |BUCLE dslpm004B;
     |BUCLE dslpm005B;
     |BUCLE dslpm006B;
     |BUCLE dslpm007B;
     |BUCLE dslpm008B;
     |BUCLE dslpm009B;
     |BUCLE dslpm010B;
     |BUCLE dslpm011B;
     |BUCLE dslpm012B;

     |SI nHisto = 0;
         |BUCLE dslpm999B;
     |FINSI;

     |SI #1#19 = "S";
         |LEE 101#1=;

         nSitAnt    = #1#0;
         |BORRA 020#1a;
         |LIBERA #1;

         #1#0  = 10;
         #1#39 = "";
         |GRABA 020#1n;

         nSitAct    = #1#0;
     |SINO;
         |LEE 101#1=;

         nSitAnt    = #1#0;
         |BORRA 020#1a;

         nSitAct    = 00;
     |FINSI;

     |SI nHisto ! 0;
         aOperacion = "Baja Cliente";
         |HAZ GrabaLogs;
     |FINSI;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
     |REFRESCACONTROL nGrid3;
     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 0_13
|| ------------------------------------------------------

|PROCESO Boton0_13;
     |ESTADO_CONTROL nBoton0_13,  "DISABLE";

     |LEE 000#1=;
     |SI FSalida = 0;
         enCliente   = #1#1;
         enEstado    = #1#0;
         |SUB_EJECUTA "dslpw042";
     |FINSI;

     |ESTADO_CONTROL nBoton0_13,  "ENABLE";
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_1
|| ------------------------------------------------------

|PROCESO Boton1_1;
                        |ESTADO_CONTROL nBoton1_1, "DISABLE";
                        |ESTADO_CONTROL nBoton1_2, "ENABLE";
                        |ESTADO_CONTROL nBoton1_3, "ENABLE";
     |SI #511#7 = "S";  |ESTADO_CONTROL nBoton1_4, "ENABLE";  |FINSI;
                        |ESTADO_CONTROL nBoton1_5, "DISABLE";
                        |ESTADO_CONTROL nBoton1_6, "DISABLE";
                        |ESTADO_CONTROL nBoton1_7, "DISABLE";

     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;

     nTipoActual = 10;
     nTipoPanta1 = 10;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid1;
     |FOCOTECLADO nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_2
|| ------------------------------------------------------

|PROCESO Boton1_2;
                        |ESTADO_CONTROL nBoton1_2, "DISABLE";
                        |ESTADO_CONTROL nBoton1_1, "ENABLE";
                        |ESTADO_CONTROL nBoton1_3, "ENABLE";

     |SI #511#7 = "S";  |ESTADO_CONTROL nBoton1_4, "ENABLE";  |FINSI;
                        |ESTADO_CONTROL nBoton1_5, "DISABLE";
                        |ESTADO_CONTROL nBoton1_6, "DISABLE";
                        |ESTADO_CONTROL nBoton1_7, "DISABLE";

     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;

     nTipoActual = 11;
     nTipoPanta1 = 11;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid1;
     |FOCOTECLADO nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_3
|| ------------------------------------------------------

|PROCESO Boton1_3;
                         |ESTADO_CONTROL nBoton1_3, "DISABLE";
                         |ESTADO_CONTROL nBoton1_1, "ENABLE";
                         |ESTADO_CONTROL nBoton1_2, "ENABLE";

                         |ESTADO_CONTROL nBoton1_4, "DISABLE";
     |SI #511#8  = "S";  |ESTADO_CONTROL nBoton1_5, "ENABLE";  |FINSI;
     |SI #511#9  = "S";  |ESTADO_CONTROL nBoton1_6, "ENABLE";  |FINSI;
     |SI #511#10 = "S";  |ESTADO_CONTROL nBoton1_7, "ENABLE";  |FINSI;

     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;

     nTipoActual = 12;
     nTipoPanta1 = 12;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid1;
     |FOCOTECLADO nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_4
|| ------------------------------------------------------

|PROCESO Boton1_4;
     |SALVA_DATOS #1;

     nSeleccion = 0;

     |SELECT #3#1;
     #1#39 = "*";
     #1#0  = nTipoActual;
     |LEE 000#1=;
     |SI FSalida = 0;
         nSeleccion = 1;
     |FINSI;

     |REPON_DATOS #1;
     |SELECT #1#1;

     |SI nSeleccion = 1;
         ||CONFI "0000SSeguro de la seleccion ";
         aAlfa = "0000S" + &191 + " Esta vd.seguro de la seleccion ?";
         |CONFI aAlfa;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nTipoFuturo  = 12;
         nCodDoc      = 0;
         nDEmpresa    = 1;
         nHEmpresa    = 99999;
         nDTipoActual = #1#0;
         nHTipoActual = #1#0;
         aOperacion   = "Cambio de situacion";

         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#992, nPanta1;

         |BUCLE dslpm001S;

         eaTipoEnvio   = "";
         enErrorCorreo = 0;
         |BORRA_HIJOS_PAN #1#1;
     |SINO;
         |LEE 101#1=;
         |SI FSalida = 0;  |Y #1#0 = nTipoPanta1;
             nSitAnt    = #1#0;
             |BORRA 020#1a;

             #1#0  = 12;
             #1#39 = "";
             |GRABA 020#1n;

             aOperacion = "Cambio de situacion";
             nSitAct    = #1#0;
             |HAZ GrabaLogs;
         |FINSI;
         |LIBERA #1;
     |FINSI;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_5
|| ------------------------------------------------------

|PROCESO Boton1_5;
     |SALVA_DATOS #1;

     nSeleccion = 0;

     |SELECT #3#1;
     #1#39 = "*";
     #1#0  = nTipoActual;
     |LEE 000#1=;
     |SI FSalida = 0;
         nSeleccion = 1;
     |FINSI;

     |REPON_DATOS #1;
     |SELECT #1#1;

     |SI nSeleccion = 1;
         ||CONFI "0000SSeguro de la seleccion ";
         aAlfa = "0000S" + &191 + "Esta vd.seguro de la seleccion ";
         |CONFI aAlfa;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nTipoFuturo  = 11;
         nCodDoc      = 0;
         nDEmpresa    = 1;
         nHEmpresa    = 99999;
         nDTipoActual = #1#0;
         nHTipoActual = #1#0;
         aOperacion   = "Cambio de situacion";

         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#992, nPanta1;

         |BUCLE dslpm001S;

         |BORRA_HIJOS_PAN #1#1;
     |SINO;
         |LEE 101#1=;
         |SI FSalida = 0;  |Y #1#0 = nTipoPanta1;
             nSitAnt    = #1#0;
             |BORRA 020#1a;

             #1#0  = 11;
             #1#39 = "";
             |GRABA 020#1n;

             aOperacion = "Cambio de situacion";
             nSitAct    = #1#0;
             |HAZ GrabaLogs;
         |FINSI;
         |LIBERA #1;
     |FINSI;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_6
|| ------------------------------------------------------

|PROCESO Boton1_6;
     |SALVA_DATOS #1;

     nSeleccion = 0;

     |SELECT #3#1;
     #1#39 = "*";
     #1#0  = nTipoActual;
     |LEE 000#1=;
     |SI FSalida = 0;
         nSeleccion = 1;
     |FINSI;

     |REPON_DATOS #1;
     |SELECT #1#1;

     |SI nSeleccion = 1;
         ||CONFI "0000NSeguro de ofertar a los cliente seleccionados";
         aAlfa = "0000N" + &191 + " Esta vd.seguro de ofertar a los cliente seleccionados ?";
         |CONFI aAlfa;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nTipoDoc = 10;
         |HAZ SacaDocumentos;
         |SI nCodDoc = 0;
             |LIBERA #1;
             |ACABA;
         |FINSI;

         nTipoFuturo  = 20;
         nDEmpresa    = 1;
         nHEmpresa    = 99999;
         nDTipoActual = #1#0;
         nHTipoActual = #1#0;
         aOperacion   = "Cambio de situacion";

         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#992, nPanta1;

         |BUCLE dslpm001S;

         |BORRA_HIJOS_PAN #1#1;
     |SINO;
         ||CONFI "0000NSeguro de Ofertar al Cliente seleccionado";
         aAlfa = "0000N" + &191 + " Esta vd.seguro de ofertar al cliente seleccionado ?";
         |CONFI aAlfa;
         |SI FSalida ! 0; |ACABA;  |FINSI;

         |LEE 101#1=;
         |SI FSalida = 0;  |Y #1#0 = nTipoPanta1;
             nTipoDoc = 10;
             |HAZ SacaDocumentos;
             |SI nCodDoc = 0;
                 |LIBERA #1;
                 |ACABA;
             |FINSI;

             nSitAnt    = #1#0;
             |BORRA 020#1a;

             #1#0  = 20;
             #1#20 = nCodDoc;
             #1#39 = "";
             |GRABA 020#1n;

             aOperacion = "Cambio de situacion";
             nSitAct    = #1#0;
             |HAZ GrabaLogs;
         |FINSI;
         |LIBERA #1;
     |FINSI;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_7
|| ------------------------------------------------------

|PROCESO Boton1_7;
     |SALVA_DATOS #1;

     nSeleccion = 0;

     |SELECT #3#1;
     #1#39 = "*";
     #1#0  = nTipoActual;
     |LEE 000#1=;
     |SI FSalida = 0;
         nSeleccion = 1;
     |FINSI;

     |REPON_DATOS #1;
     |SELECT #1#1;

     |SI nSeleccion = 1;
         ||CONFI "0000SSeguro de la seleccion ";
         aAlfa = "0000S" + &191 + " Esta vd.seguro de la seleccion ?";
         |CONFI aAlfa;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nTipoFuturo  = 10;
         nCodDoc      = 0;
         nDEmpresa    = 1;
         nHEmpresa    = 99999;
         nDTipoActual = #1#0;
         nHTipoActual = #1#0;
         aOperacion   = "Cambio de situacion";

         |BORRA_HIJOS_PAN #1#1;
         |SUB_PINPA #0#992, nPanta1;

         |BUCLE dslpm001S;

         |BORRA_HIJOS_PAN #1#1;
     |SINO;
         |LEE 101#1=;
         |SI FSalida = 0;  |Y #1#0 = nTipoPanta1;
             nSitAnt    = #1#0;
             |BORRA 020#1a;

             #1#0  = 10;
             #1#39 = "";
             |GRABA 020#1n;

             aOperacion = "Cambio de situacion";
             nSitAct    = #1#0;
             |HAZ GrabaLogs;
         |FINSI;
         |LIBERA #1;
     |FINSI;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_1
|| ------------------------------------------------------

|PROCESO Boton2_1;
                         |ESTADO_CONTROL nBoton2_1, "DISABLE";
                         |ESTADO_CONTROL nBoton2_2, "ENABLE";
                         |ESTADO_CONTROL nBoton2_3, "ENABLE";

     |SI #511#11 = "S";  |ESTADO_CONTROL nBoton2_4, "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton2_6, "DISABLE";
                         |ESTADO_CONTROL nBoton2_7, "DISABLE";
                         |ESTADO_CONTROL nBoton2_8, "DISABLE";

     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;

     nTipoActual = 20;
     nTipoPanta2 = 20;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid2;
     |FOCOTECLADO nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_2
|| ------------------------------------------------------

|PROCESO Boton2_2;
                         |ESTADO_CONTROL nBoton2_2, "DISABLE";
                         |ESTADO_CONTROL nBoton2_1, "ENABLE";
                         |ESTADO_CONTROL nBoton2_3, "ENABLE";

                         |ESTADO_CONTROL nBoton2_4, "DISABLE";
     |SI #511#13 = "S";  |ESTADO_CONTROL nBoton2_6, "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton2_7, "DISABLE";
                         |ESTADO_CONTROL nBoton2_8, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 21;
     nTipoPanta2 = 21;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid2;
     |FOCOTECLADO nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_3
|| ------------------------------------------------------

|PROCESO Boton2_3;
                         |ESTADO_CONTROL nBoton2_3, "DISABLE";
                         |ESTADO_CONTROL nBoton2_1, "ENABLE";
                         |ESTADO_CONTROL nBoton2_2, "ENABLE";

                         |ESTADO_CONTROL nBoton2_4, "DISABLE";
                         |ESTADO_CONTROL nBoton2_6, "DISABLE";
     |SI #511#14 = "S";  |ESTADO_CONTROL nBoton2_7, "ENABLE";  |FINSI;
     |SI #511#15 = "S";  |ESTADO_CONTROL nBoton2_8, "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 22;
     nTipoPanta2 = 22;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid2;
     |FOCOTECLADO nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_4
|| ------------------------------------------------------

|PROCESO Boton2_4;
     |SALVA_DATOS #1;

     nSeleccion = 0;

     |SELECT #3#1;
     #1#39 = "*";
     #1#0  = nTipoActual;
     |LEE 000#1=;
     |SI FSalida = 0;
         nSeleccion = 1;
     |FINSI;

     |REPON_DATOS #1;
     |SELECT #1#1;

     |SI nSeleccion = 1;
         |BORRA_HIJOS_PAN #2#1;
         |SUB_PINPA #0#950, nPanta2;

         |DDEFECTO #950;
         #950#0 = "";
         |PINDA #0#950;

         |ENCAMPO #0#950;
         |SI #950#0 = "A";
             |BORRA_HIJOS_PAN #2#1;
             |ACABA;
         |FINSI;

         ||CONFI "0000SSeguro de la opcion";
         aAlfa = "0000S" + &191 + " Esta vd.seguro de la opcion ?";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             |BORRA_HIJOS_PAN #2#1;
             |ACABA;
         |FINSI;

         |BORRA_HIJOS_PAN #2#1;

         nTipoFuturo  = 22;
         nDEmpresa    = 1;
         nHEmpresa    = 99999;
         nDTipoActual = #1#0;
         nHTipoActual = #1#0;
         aOperacion   = "Cambio de situacion";

         |BUCLE dslpm001S;
     |SINO;
         |LEE 000#1=;
         |SI FSalida = 0;  |Y #1#0 = nTipoPanta2;
             |VENTANA 0501, 2799, -1, 1, "";
             nVentana = FSalida;

             enDocumento = #1#20;
             enEstado    = #1#0;
             enCliente   = #1#1;
             enMasivo    = 0;
             |SUB_EJECUTA "dslpz001";
             |SI enError = 1;
                 |LIBERA #1;
                 |FINVENTANA nVentana;
                 |ACABA;
             |FINSI;
             |FINVENTANA nVentana;

             |VENTANA 0501, 2799, -1, 1, "";
             nVentana = FSalida;

             enCliente = #1#1;
             enEstado  = #1#0;

             |SUB_EJECUTA "dslpm008";

             |FINVENTANA nVentana;

             |LEE 101#1=;
             nSitAnt    = #1#0;
             |BORRA 020#1a;

             #1#0  = 22;
             #1#39 = "";
             |GRABA 020#1n;

             aOperacion = "Cambio de situacion";
             nSitAct    = #1#0;
             |HAZ GrabaLogs;
         |FINSI;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_6
|| ------------------------------------------------------

|PROCESO Boton2_6;
     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta2;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 20;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_7
|| ------------------------------------------------------

|PROCESO Boton2_7;
     |CONFI "0000SCorreo aviso al Asesor";
     |SI FSalida = 0;
         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         enEstado      = #1#0;
         enCliente     = #1#1;
         eaNomClie     = #1#2;
         enDocumento   = 0;
         enFormulario  = 0;
         enIncidencias = 2;
         |SUB_EJECUTA "dslpw995";

         |FINVENTANA nVentana;
     |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta2;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 21;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_8
|| ------------------------------------------------------

|PROCESO Boton2_8;
     ||CONFI "0000NSeguro de pasar al cliente a presupuestos";
     aAlfa = "0000N" + &191 + " Esta vd.seguro de pasar al cliente a presupuestos ? ";
     |CONFI aAlfa;
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta2;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 30;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid2;
     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_1
|| ------------------------------------------------------

|PROCESO Boton3_1;
                         |ESTADO_CONTROL nBoton3_1,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";

     |SI #511#16 = "S";  |ESTADO_CONTROL nBoton3_6,   "ENABLE";  |FINSI;
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11,  "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton3_7,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_8,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_10, "DISABLE";

                         |ESTADO_CONTROL nBoton3_13, "DISABLE";
                         |ESTADO_CONTROL nBoton3_14, "DISABLE";
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 30;
     nTipoPanta3 = 30;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_2
|| ------------------------------------------------------

|PROCESO Boton3_2;
                         |ESTADO_CONTROL nBoton3_2,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";

                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";

     |SI #511#17 = "S";  |ESTADO_CONTROL nBoton3_7,   "ENABLE";  |FINSI;
     |SI #511#18 = "S";  |ESTADO_CONTROL nBoton3_8,   "ENABLE";  |FINSI;
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11,  "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_10, "DISABLE";

                         |ESTADO_CONTROL nBoton3_13, "DISABLE";
                         |ESTADO_CONTROL nBoton3_14, "DISABLE";
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 31;
     nTipoPanta3 = 31;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_16
|| ------------------------------------------------------

|PROCESO Boton3_16;
                         |ESTADO_CONTROL nBoton3_16, "DISABLE";
                         |ESTADO_CONTROL nBoton3_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";

                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_7,   "DISABLE";
     |SI #511#18 = "S";  |ESTADO_CONTROL nBoton3_8,   "ENABLE";  |FINSI;
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11,  "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_10, "DISABLE";
                         |ESTADO_CONTROL nBoton3_13, "DISABLE";
                         |ESTADO_CONTROL nBoton3_14, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";

     |SI #511#33 = "S";  |ESTADO_CONTROL nBoton3_18,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 32;
     nTipoPanta3 = 32;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_3
|| ------------------------------------------------------

|PROCESO Boton3_3;
                         |ESTADO_CONTROL nBoton3_3,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";

                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_7,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_8,  "DISABLE";

     |SI #511#19 = "S";  |ESTADO_CONTROL nBoton3_9,   "ENABLE";  |FINSI;
     |SI #511#34 = "S";  |ESTADO_CONTROL nBoton3_19,  "ENABLE";  |FINSI;
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11,  "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton3_10, "DISABLE";
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";

                         |ESTADO_CONTROL nBoton3_13, "DISABLE";
                         |ESTADO_CONTROL nBoton3_14, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 33;
     nTipoPanta3 = 33;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_4
|| ------------------------------------------------------

|PROCESO Boton3_4;
                         |ESTADO_CONTROL nBoton3_4,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";

                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_7,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_8,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";

     |SI #511#20 = "S";  |ESTADO_CONTROL nBoton3_10,  "ENABLE";  |FINSI;
     |SI #511#23 = "S";  |ESTADO_CONTROL nBoton3_13,  "ENABLE";  |FINSI;
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11,  "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton3_14, "DISABLE";
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 34;
     nTipoPanta3 = 34;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_17
|| ------------------------------------------------------

|PROCESO Boton3_17;
                         |ESTADO_CONTROL nBoton3_17, "DISABLE";
                         |ESTADO_CONTROL nBoton3_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";

                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_7,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_8,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_10, "DISABLE";
                         |ESTADO_CONTROL nBoton3_14, "DISABLE";
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";

     |SI #511#23 = "S";  |ESTADO_CONTROL nBoton3_13,  "ENABLE";  |FINSI;
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11,  "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 35;
     nTipoPanta3 = 35;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;


|| ------------------------------------------------------
|| Procesos del Boton 3_5
|| ------------------------------------------------------

|PROCESO Boton3_5;
                         |ESTADO_CONTROL nBoton3_5,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";

                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_7,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_8,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";

                         |ESTADO_CONTROL nBoton3_10, "DISABLE";
                         |ESTADO_CONTROL nBoton3_11, "DISABLE";
                         |ESTADO_CONTROL nBoton3_12, "DISABLE";
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";

     |SI #511#23 = "S";  |ESTADO_CONTROL nBoton3_13,  "ENABLE";  |FINSI;
     |SI #511#24 = "S";  |ESTADO_CONTROL nBoton3_14,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 36;
     nTipoPanta3 = 36;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid3;
     |FOCOTECLADO nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_6
|| ------------------------------------------------------

|PROCESO Boton3_6;
     |LEE 000#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         enCliente     = #1#1;
         eaNomClie     = #1#2;
         enDocumento   = 0;
         enIncidencias = 0;
         enFormulario  = 1;
         enErrorCorreo = 1;
         |SUB_EJECUTA "dslpw995";

         |FINVENTANA nVentana;

         |SI enErrorCorreo = 1;  |ACABA;  |FINSI;

         |LEE 101#1=;

         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 31;
         #1#39 = "";
         |GRABA 020#1n;

         |LIBERA #1;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_7
|| ------------------------------------------------------

|PROCESO Boton3_7;
     |LEE 000#1=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enCliente     = #1#1;
     eaNomClie     = #1#2;
     enDocumento   = 0;
     enIncidencias = 0;
     enFormulario  = 1;
     enErrorCorreo = 1;
     |SUB_EJECUTA "dslpw995";

     |FINVENTANA nVentana;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_8
|| ------------------------------------------------------

|PROCESO Boton3_8;
     |LEE 000#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         enCliente   = #1#1;
         enEstado    = #1#0;
         |SUB_EJECUTA "dslpw040";
         |SI enError = 1;
             |ACABA;
         |FINSI;

         |SI #1#0 ! 31;  |ACABA;  |FINSI;

         |LEE 101#1=;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 32;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_18
|| ------------------------------------------------------

|PROCESO Boton3_18;
     |LEE 000#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         enCliente   = #1#1;
         enEstado    = #1#0;
         |SUB_EJECUTA "dslpw042";
         |SI enError ! 0;
             |ACABA;
         |FINSI;

         nTipoDoc = 20;
         |HAZ SacaDocumentos;
         |SI nCodDoc = 0;
             |LIBERA #1;
             |ACABA;
         |FINSI;

         |LEE 101#1=;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 33;
         #1#37 = nCodDoc;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_19
|| ------------------------------------------------------

|PROCESO Boton3_19;
     |LEE 000#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         enCliente   = #1#1;
         enEstado    = #1#0;
         |SUB_EJECUTA "dslpw042";
         |SI enError ! 0;
             |ACABA;
         |FINSI;

         |LEE 000#1=;

         aOperacion = "Modificacion de Presupuesto";
         nSitAnt    = #1#0;
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_9
|| ------------------------------------------------------

|PROCESO Boton3_9;
     ||CONFI "0000NSeguro de Visar al Cliente seleccionado";
     aAlfa = "0000N" + &191 + " Esta vd.seguro de visar al cliente seleccionado ?";
     |CONFI aAlfa;
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 34;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_13
|| ------------------------------------------------------

|PROCESO Boton3_13;
     |LEE 000#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         enCliente   = #1#1;
         enEstado    = #1#0;
         |SUB_EJECUTA "dslpw042";
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_10
|| ------------------------------------------------------

|PROCESO Boton3_10;
     aAlfa = "0000N" + &191 + " Esta vd.seguro de enviar el presupuesto del cliente seleccionado ?";
     |CONFI aAlfa;
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |LEE 000#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         enDocumento = #1#37;
         enEstado    = #1#0;
         enCliente   = #1#1;
         enMasivo    = 0;
         |SUB_EJECUTA "dslpz001";
         |SI enError = 1;
             |LIBERA #1;
             |FINVENTANA nVentana;
             |ACABA;
         |FINSI;
         |FINVENTANA nVentana;

         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         enCliente = #1#1;
         enEstado  = #1#0;

         |SUB_EJECUTA "dslpm008";

         |FINVENTANA nVentana;

         |LEE 101#1=;

         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 35;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_11
|| ------------------------------------------------------

|PROCESO Boton3_11;
     |CONFI "0000NSeguro que el Cliente seleccionado acepta el presupuesto";
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |SI #1#36 = 0;
         |MENAV "0000 Presupuesto sin valorar.";
         |ACABA;
     |FINSI;

     |ABRE #8;
     |SELECT #2#8;
     #8#14 = 20;
     #8#0  = #1#1;
     #8#2  = 1;
     |LEE 000#8];
     |SI FSalida ! 0;  |O #8#14 ! 20;  |O #8#0 ! #1#1;
         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         enDocumento = #1#37;
         enEstado    = #1#0;
         enCliente   = #1#1;
         enMasivo    = 0;
         |SUB_EJECUTA "dslpz001";
         |SI enError = 1;
             |LIBERA #1;
             |FINVENTANA nVentana;
             |ACABA;
         |FINSI;
         |FINVENTANA nVentana;
     |FINSI;
     |CIERRA #8;

     enCliente     = #1#1;
     eaNomClie     = #1#2;
     enDocumento   = 0;
     enFormulario  = 0;
     enIncidencias = 0;
     enAdministra  = 2;
     |SUB_EJECUTA "dslpw995";
     enAdministra  = 0;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 40;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_12
|| ------------------------------------------------------

|PROCESO Boton3_12;
     |CONFI "0000SCorreo aviso al Asesor";
     |SI FSalida = 0;
         |VENTANA 0501, 2799, -1, 1, "";
         nVentana = FSalida;

         enEstado      = #1#0;
         enCliente     = #1#1;
         eaNomClie     = #1#2;
         enDocumento   = 0;
         enFormulario  = 0;
         enIncidencias = 3;
         |SUB_EJECUTA "dslpw995";

         |FINVENTANA nVentana;
     |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 36;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;


|| ------------------------------------------------------
|| Procesos del Boton 3_14
|| ------------------------------------------------------

|PROCESO Boton3_14;
     |CONFI "0000NSeguro que quiere Reintentar con el Cliente Seleccionado";
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta3;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 32;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid3;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_1
|| ------------------------------------------------------

|PROCESO Boton4_1;
                         |ESTADO_CONTROL nBoton4_1,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_11, "ENABLE";

     |SI #511#25 = "S";  |ESTADO_CONTROL nBoton4_4,  "ENABLE";  |FINSI;
     |SI #511#26 = "S";  |ESTADO_CONTROL nBoton4_5,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton4_6, "DISABLE";
                         |ESTADO_CONTROL nBoton4_7, "DISABLE";
                         |ESTADO_CONTROL nBoton4_8, "DISABLE";

                         |ESTADO_CONTROL nBoton4_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_12, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 40;
     nTipoPanta4 = 40;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_2
|| ------------------------------------------------------

|PROCESO Boton4_2;
                         |ESTADO_CONTROL nBoton4_2,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_11, "ENABLE";

                         |ESTADO_CONTROL nBoton4_4, "DISABLE";
                         |ESTADO_CONTROL nBoton4_5, "DISABLE";

     |SI #511#27 = "S";  |ESTADO_CONTROL nBoton4_6,  "ENABLE";  |FINSI;
     |SI #511#28 = "S";  |ESTADO_CONTROL nBoton4_7,  "ENABLE";  |FINSI;
     |SI #511#29 = "S";  |ESTADO_CONTROL nBoton4_8,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton4_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_12, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 41;
     nTipoPanta4 = 41;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_3
|| ------------------------------------------------------

|PROCESO Boton4_3;
                         |ESTADO_CONTROL nBoton4_3,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_11, "ENABLE";

                         |ESTADO_CONTROL nBoton4_4, "DISABLE";
                         |ESTADO_CONTROL nBoton4_5, "DISABLE";

                         |ESTADO_CONTROL nBoton4_7, "DISABLE";
                         |ESTADO_CONTROL nBoton4_8, "DISABLE";

     |SI #511#27 = "S";  |ESTADO_CONTROL nBoton4_6,  "ENABLE";  |FINSI;
     |SI #511#30 = "S";  |ESTADO_CONTROL nBoton4_9,  "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton4_12, "DISABLE";

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 42;
     nTipoPanta4 = 42;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_11
|| ------------------------------------------------------

|PROCESO Boton4_11;
                         |ESTADO_CONTROL nBoton4_11, "DISABLE";
                         |ESTADO_CONTROL nBoton4_1,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_3,  "ENABLE";

                         |ESTADO_CONTROL nBoton4_4, "DISABLE";
                         |ESTADO_CONTROL nBoton4_5, "DISABLE";

                         |ESTADO_CONTROL nBoton4_7, "DISABLE";
                         |ESTADO_CONTROL nBoton4_8, "DISABLE";

                         |ESTADO_CONTROL nBoton4_9, "DISABLE";

     |SI #511#27 = "S";  |ESTADO_CONTROL nBoton4_6,  "ENABLE";  |FINSI;
     |SI #511#35 = "S";  |ESTADO_CONTROL nBoton4_12, "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton0_10, "DISABLE";
                         |ESTADO_CONTROL nBoton0_11, "DISABLE";

     nTipoActual = 43;
     nTipoPanta4 = 43;
     |LEE 000#1p;
     |REFRESCACONTROL nGrid4;
     |FOCOTECLADO nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_4
|| ------------------------------------------------------

|PROCESO Boton4_4;
     nSitAnt    = #1#0;
     aOperacion = "Introducir Datos";
     nSitAct    = #1#0;
     |HAZ GrabaLogs;

     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enCliente = #1#1;
     |SUB_EJECUTA "dslpw001";

     |FINVENTANA nVentana;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_5
|| ------------------------------------------------------

|PROCESO Boton4_5;
     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta4;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 41;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_6
|| ------------------------------------------------------

|PROCESO Boton4_6;
     nSitAnt    = #1#0;
     aOperacion = "Imprimir";
     nSitAct    = #1#0;
     |HAZ GrabaLogs;

     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enCliente   = #1#1;
     enEstado    = #1#0;
     enDocumento = 0;
     enMasivo    = 0;
     |SUB_EJECUTA "dslpz001";

     |FINVENTANA nVentana;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_7
|| ------------------------------------------------------

|PROCESO Boton4_7;
     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta4;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 40;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_8
|| ------------------------------------------------------

|PROCESO Boton4_8;
     ||CONFI "0000NSeguro que quiere pasar al Cliente a Facturar";
     aAlfa = "0000N" + &191 + " Esta vd.seguro que quiere pasar al cliente a facturar";
     |CONFI aAlfa;
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta4;
         nSitAnt    = #1#0;
         |BORRA 020#1a;

         #1#0  = 42;
         #1#39 = "";
         |GRABA 020#1n;

         aOperacion = "Cambio de situacion";
         nSitAct    = #1#0;
         |HAZ GrabaLogs;
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_9
|| ------------------------------------------------------

|PROCESO Boton4_9;
     aAlfa = "0000N" + &191 + " Esta vd.seguro que quiere pasar al cliente a realizado";
     |CONFI aAlfa;
     |SI FSalida ! 0; |ACABA;  |FINSI;

     |LEE 101#1=;
     |SI FSalida = 0;  |Y #1#0 = nTipoPanta4;
         nIdSalir = 0;
         InNivel   = nNivel1<-;
         nNivel1   = 0;
         |ESPECIFICA "IDBOTONTECLA", nNivel;

         nIdSalir = nNivel2;
         |ESTADO_CONTROL nIdSalir, "HIDE";

         |BORRA_HIJOS_PAN #4#1;
         |SUB_PINPA #0#955, nPanta4;

         |DDEFECTO #955;
         #955#0 = #1#44;
         #955#1 = #1#45;
         #955#2 = #1#46;
         #955#3 = #1#47;
         #955#4 = #1#48;
         #955#5 = #1#49;
         #955#6 = #1#50;
         |SI #955#0 = "01.01.0000";
             #955#0 = ~;
             nNume  = #955#0;
             nNume  = nNume + 730;
             #955#1 = nNume;
         |FINSI;

         |PINDA #0#955;

         |ENDATOS #1#955;
         |SI FSalida = 0;
             enCliente     = #1#1;
             eaNomClie     = #1#2;
             enDocumento   = 0;
             enFormulario  = 0;
             enIncidencias = 0;
             enAdministra  = 1;
             |SUB_EJECUTA "dslpw995";
             enAdministra  = 0;

             |SI enErrorCorreo = 0;
                 nSitAnt    = #1#0;
                 |BORRA 020#1a;

                 #1#0  = 43;
                 #1#39 = "";
                 #1#44 = #955#0;
                 #1#45 = #955#1;
                 #1#46 = #955#2;
                 #1#47 = #955#3;
                 #1#48 = #955#4;
                 #1#49 = #955#5;
                 #1#50 = #955#6;

                 |GRABA 020#1n;

                 aOperacion = "Cambio de situacion";
                 nSitAct    = #1#0;
                 |HAZ GrabaLogs;
             |FINSI;
         |FINSI;

         |BORRA_HIJOS_PAN #4#1;
         |ESTADO_CONTROL nIdSalir, "SHOW";
     |FINSI;
     |LIBERA #1;

     |REFRESCACONTROL nGrid4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_10
|| ------------------------------------------------------

|PROCESO Boton4_10;
     nSitAnt    = #1#0;
     aOperacion = "Gestion documental";
     nSitAct    = #1#0;
     |HAZ GrabaLogs;

     |VENTANA 0501, 2899, -1, 1, "";
     nVentana = FSalida;

     enCliente = #1#1;
     enEstado  = #1#0;
     |SUB_EJECUTA "dslpm008";

     |FINVENTANA nVentana;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_12
|| ------------------------------------------------------

|PROCESO Boton4_12;
     |SI #1#0 ! 43;  |ACABA;  |FINSI;

      enAuditoria = 1;
     |HAZ Boton0_6;
     enAuditoria = 0;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Incio del Programa
|| ------------------------------------------------------

|PROCESO EventoPanta1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#1=;

         |SI #511#5  = "S";   |ESTADO_CONTROL nBoton0_4,  "ENABLE";   |FINSI;
         |SI #511#37 = "S";   |ESTADO_CONTROL nBoton0_12, "ENABLE";   |FINSI;

         |SI #1#19 = "S";
             |SI #511#6 = "S";   |ESTADO_CONTROL nBoton0_5, "ENABLE";   |FINSI;
         |SINO;
                                 |ESTADO_CONTROL nBoton0_5, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoPanta2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#1=;

         |SI #511#5  = "S";   |ESTADO_CONTROL nBoton0_4,  "ENABLE";   |FINSI;
         |SI #511#37 = "S";   |ESTADO_CONTROL nBoton0_12, "ENABLE";   |FINSI;

         |SI #1#19 = "S";
             |SI #511#6 = "S";   |ESTADO_CONTROL nBoton0_5, "ENABLE";   |FINSI;
         |SINO;
                                 |ESTADO_CONTROL nBoton0_5, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoPanta3;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#1=;

         |SI #511#5  = "S";   |ESTADO_CONTROL nBoton0_4,  "ENABLE";   |FINSI;
         |SI #511#37 = "S";   |ESTADO_CONTROL nBoton0_12, "ENABLE";   |FINSI;

         |SI #1#19 = "S";
             |SI #511#6 = "S";   |ESTADO_CONTROL nBoton0_5, "ENABLE";   |FINSI;
         |SINO;
                                 |ESTADO_CONTROL nBoton0_5, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoPanta4;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#1=;

         |SI #511#5  = "S";   |ESTADO_CONTROL nBoton0_4,  "ENABLE";   |FINSI;
         |SI #511#37 = "S";   |ESTADO_CONTROL nBoton0_12, "ENABLE";   |FINSI;

         |SI #1#19 = "S";
             |SI #511#6 = "S";   |ESTADO_CONTROL nBoton0_5, "ENABLE";   |FINSI;
         |SINO;
                                 |ESTADO_CONTROL nBoton0_5, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoFocoGrid1;
     nTipoActual = nTipoPanta1;

                          |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                          |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                          |ESTADO_CONTROL nBoton0_10, "DISABLE";
                          |ESTADO_CONTROL nBoton0_11, "DISABLE";

     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;

     |FOCOTECLADO nGrid1;
|FPRC;

|PROCESO EventoFocoGrid2;
     nTipoActual = nTipoPanta2;

                          |ESTADO_CONTROL nBoton0_8,  "DISABLE";
                          |ESTADO_CONTROL nBoton0_9,  "DISABLE";
                          |ESTADO_CONTROL nBoton0_10, "DISABLE";
                          |ESTADO_CONTROL nBoton0_11, "DISABLE";

     |SI nTipoPanta2 ! 20;  |ACABA;  |FINSI;

     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;

     |FOCOTECLADO nGrid2;
|FPRC;

|PROCESO EventoFocoGrid3;
     nTipoActual = nTipoPanta3;

     |ESTADO_CONTROL nBoton0_8,  "DISABLE";
     |ESTADO_CONTROL nBoton0_9,  "DISABLE";
     |ESTADO_CONTROL nBoton0_10, "DISABLE";
     |ESTADO_CONTROL nBoton0_11, "DISABLE";

     |FOCOTECLADO nGrid3;
|FPRC;

|PROCESO EventoFocoGrid4;
     nTipoActual = nTipoPanta4;

     |ESTADO_CONTROL nBoton0_8,  "DISABLE";
     |ESTADO_CONTROL nBoton0_9,  "DISABLE";
     |ESTADO_CONTROL nBoton0_10, "DISABLE";
     |ESTADO_CONTROL nBoton0_11, "DISABLE";

     |FOCOTECLADO nGrid4;
|FPRC;

|PROCESO Membrete
     |XABRE "E", aFotoOrigen, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aLong  = aFotoOrigen % 0;
     nLong  = aLong;
     aLogo  = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aFotoOrigen % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     aDirLocal    = "C:\DOCUMENTOS";                     |RMKDIR aDirLocal;
     aDirLocal    = "C:\DOCUMENTOS\DSLPD";               |RMKDIR aDirLocal;
     aDirLocal    = "C:\DOCUMENTOS\DSLPD\LOGOS";         |RMKDIR aDirLocal;
     aFotoDestino = aDirLocal + "/" + aLogo;

     aContiene1 = aFotoDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aFotoOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aFotoOrigen, aFotoDestino;
         |SINO;
             |COPIA_FICHERO aFotoOrigen, aFotoDestino;
         |FINSI;
     |FINSI;

     aFoto = "IMAGEN,"  + aFotoDestino;
     |CONTROL_SIMPLE nPanta0, aFoto, 0501, 0825, NULL;
     nBotonFoto = FSalida;

     |PULSATECLA;
|FPRC;

|PROCESO BotonesPanta0;
     |ABRE #0;
     |LEE 000#0p;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     aFotoOrigen = #0#21;                          |QBF aFotoOrigen;
     |SI aFotoOrigen ! "";  |HAZ Membrete;  |FINSI;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}} Cliente Nuevo", 0530, 0550, Boton0_3;
     nBoton0_3 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}} Modificar Cliente", 0630, 0650, Boton0_4;
     nBoton0_4 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{207}} Baja Cliente", 0730, 0750, Boton0_12;
     nBoton0_12 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{217}} Valoracion ", 0555, 0575, Boton0_13;
     nBoton0_13 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{137}} Correo Incidencia", 0655, 0675, Boton0_5;
     nBoton0_5 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{135}}Actualizar Datos ", 0755, 0775, Boton0_1;
     nBoton0_1 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{155}} Buscar Cliente", 0580, 0598, Boton0_2;
     nBoton0_2 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{217}} Cambiar Situacion", 0680, 0698, Boton0_6;
     nBoton0_6 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{205}} Encuesta ", 0780, 0798, Boton0_7;
     nBoton0_7 = FSalida;


     |CONTROL_SIMPLE nPanta0, "BOTON,ST", 0880, 0883, Boton0_8;
     nBoton0_8 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,QT", 0885, 0888, Boton0_9;
     nBoton0_9 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,SL", 0890, 0893, Boton0_10;
     nBoton0_10 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,QL", 0895, 0898, Boton0_11;
     nBoton0_11 = FSalida;

     |ESTADO_CONTROL nBoton0_1,  "DISABLE";
     |ESTADO_CONTROL nBoton0_3,  "DISABLE";
     |ESTADO_CONTROL nBoton0_4,  "DISABLE";
     |ESTADO_CONTROL nBoton0_5,  "DISABLE";
     |ESTADO_CONTROL nBoton0_6,  "DISABLE";
     |ESTADO_CONTROL nBoton0_7,  "DISABLE";
     |ESTADO_CONTROL nBoton0_8,  "DISABLE";
     |ESTADO_CONTROL nBoton0_9,  "DISABLE";
     |ESTADO_CONTROL nBoton0_10, "DISABLE";
     |ESTADO_CONTROL nBoton0_11, "DISABLE";
     |ESTADO_CONTROL nBoton0_12, "DISABLE";
     |ESTADO_CONTROL nBoton0_13, "DISABLE";

     |SI #511#3  = "S";   |ESTADO_CONTROL nBoton0_1,  "ENABLE";   |FINSI;
     |SI #511#4  = "S";   |ESTADO_CONTROL nBoton0_3,  "ENABLE";   |FINSI;
     |SI #511#32 = "S";   |ESTADO_CONTROL nBoton0_6,  "ENABLE";   |FINSI;
     |SI #511#12 = "S";   |ESTADO_CONTROL nBoton0_7,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_8,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_9,  "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_10, "ENABLE";   |FINSI;
     |SI #511#36 = "S";   |ESTADO_CONTROL nBoton0_11, "ENABLE";   |FINSI;
     |SI #511#38 = "S";   |ESTADO_CONTROL nBoton0_13, "ENABLE";   |FINSI;
|FPRC;

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE nPanta1, "BOTON,No Seleccionados ", 0610, 0630, Boton1_1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,Rechazados ", 0632, 0652, Boton1_2;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,Seleccionados ", 0654, 0674, Boton1_3;
     nBoton1_3 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,Seleccionar ", 1077, 1198, Boton1_4;
     nBoton1_4 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,Rechazar ", 1377, 1498, Boton1_5;
     nBoton1_5 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,Ofertar ", 1577, 1698, Boton1_6;
     nBoton1_6 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,A No Seleccionados", 1877, 1998, Boton1_7;
     nBoton1_7 = FSalida;

                         |ESTADO_CONTROL nBoton1_1, "DISABLE";
                         |ESTADO_CONTROL nBoton1_2, "ENABLE";
                         |ESTADO_CONTROL nBoton1_3, "ENABLE";

                         |ESTADO_CONTROL nBoton1_4, "DISABLE";
     |SI #511#7 = "S";   |ESTADO_CONTROL nBoton1_4, "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton1_5, "DISABLE";
                         |ESTADO_CONTROL nBoton1_6, "DISABLE";
                         |ESTADO_CONTROL nBoton1_7, "DISABLE";
|FPRC;

|PROCESO BotonesPanta2;
     |CONTROL_SIMPLE nPanta2, "BOTON,Para enviar ofertas", 0610, 0630, Boton2_1;
     nBoton2_1 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Con ofertas rechazadas", 0632, 0652, Boton2_2;
     nBoton2_2 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Para contestar oferta ", 0654, 0674, Boton2_3;
     nBoton2_3 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Enviar oferta ", 1077, 1198, Boton2_4;
     nBoton2_4 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Reintentar ", 1377, 1498, Boton2_6;
     nBoton2_6 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Rechazar ", 1677, 1798, Boton2_7;
     nBoton2_7 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Aceptar ", 1877, 1998, Boton2_8;
     nBoton2_8 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,Gestion Documental", 2377, 2398, Boton4_10;
     nBoton2_9 = FSalida;

                         |ESTADO_CONTROL nBoton2_1, "DISABLE";
                         |ESTADO_CONTROL nBoton2_2, "ENABLE";
                         |ESTADO_CONTROL nBoton2_3, "ENABLE";

                         |ESTADO_CONTROL nBoton2_4, "DISABLE";
     |SI #511#11 = "S";  |ESTADO_CONTROL nBoton2_4, "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton2_6, "DISABLE";
                         |ESTADO_CONTROL nBoton2_7, "DISABLE";
                         |ESTADO_CONTROL nBoton2_8, "DISABLE";
                         |ESTADO_CONTROL nBoton2_9, "DISABLE";
     |SI #511#31 = "S";  |ESTADO_CONTROL nBoton2_9, "ENABLE";  |FINSI;
|FPRC;

|PROCESO BotonesPanta3;
     |CONTROL_SIMPLE nPanta3, "BOTON,Con envo formulario pendiente", 0610, 0822, Boton3_1;
     nBoton3_1  = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Con contestacin formulario pendiente", 0623, 0835, Boton3_2;
     nBoton3_2 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Con confeccin presupuesto pendiente", 0636, 0848, Boton3_16;
     nBoton3_16 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Con visado presupuesto pendiente", 0649, 0861, Boton3_3;
     nBoton3_3 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Con presupuesto visado", 0662, 0874, Boton3_4;
     nBoton3_4 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Con presupuesto enviado", 0675, 0887, Boton3_17;
     nBoton3_17 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Con presupuesto rechazado", 0688, 0899, Boton3_5;
     nBoton3_5 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Enviar formulario", 1077, 1098, Boton3_6;
     nBoton3_6 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Reenviar", 1177, 1198, Boton3_7;
     nBoton3_7 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Contesta (Rellenar Formulario)", 1277, 1298, Boton3_8;
     nBoton3_8 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Confeccion presupuesto", 1377, 1398, Boton3_18;
     nBoton3_18 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Modificar presupuesto", 1477, 1498, Boton3_19;
     nBoton3_19 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Visar", 1577, 1598, Boton3_9;
     nBoton3_9 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Consultar presupuesto", 1677, 1698, Boton3_13;
     nBoton3_13 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Enviar presupuesto", 1777, 1798, Boton3_10;
     nBoton3_10 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Acepta", 1877, 1898, Boton3_11;
     nBoton3_11 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Rechaza", 1977, 1998, Boton3_12;
     nBoton3_12 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Reintentar", 2077, 2098, Boton3_14;
     nBoton3_14 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,Gestion Documental", 2377, 2398, Boton4_10;
     nBoton3_15 = FSalida;

                         |ESTADO_CONTROL nBoton3_1,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_4,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_5,  "ENABLE";
                         |ESTADO_CONTROL nBoton3_16, "ENABLE";
                         |ESTADO_CONTROL nBoton3_17, "ENABLE";
                         |ESTADO_CONTROL nBoton3_6,  "DISABLE";
     |SI #511#16 = "S";  |ESTADO_CONTROL nBoton3_6,  "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton3_7,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_8,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton3_10, "DISABLE";
     |SI #511#21 = "S";  |ESTADO_CONTROL nBoton3_11, "ENABLE";  |FINSI;
     |SI #511#22 = "S";  |ESTADO_CONTROL nBoton3_12, "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton3_13, "DISABLE";
                         |ESTADO_CONTROL nBoton3_14, "DISABLE";
                         |ESTADO_CONTROL nBoton3_15, "DISABLE";
     |SI #511#31 = "S";  |ESTADO_CONTROL nBoton3_15, "ENABLE";  |FINSI;
                         |ESTADO_CONTROL nBoton3_18, "DISABLE";
                         |ESTADO_CONTROL nBoton3_19, "DISABLE";
|FPRC;

|PROCESO BotonesPanta4;
     |CONTROL_SIMPLE nPanta4, "BOTON,Con toma de datos pendientes", 0610, 0730, Boton4_1;
     nBoton4_1 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Con elaboracin documentos pendientes", 0632, 0752, Boton4_2;
     nBoton4_2 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Facturando ", 0654, 0774, Boton4_3;
     nBoton4_3 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Realizado ", 0676, 0794, Boton4_11;
     nBoton4_11 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Introducir datos", 0977, 0998, Boton4_4;
     nBoton4_4 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Cerrar toma", 1077, 1098, Boton4_5;
     nBoton4_5 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Imprimir/XML", 1277, 1298, Boton4_6;
     nBoton4_6 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Reabrir toma", 1377, 1398, Boton4_7;
     nBoton4_7 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Facturar", 1477, 1498, Boton4_8;
     nBoton4_8 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Enviar Orden", 1677, 1698, Boton4_9;
     nBoton4_9 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Auditoria", 1877, 1898, Boton4_12;
     nBoton4_12 = FSalida;

     |CONTROL_SIMPLE nPanta4, "BOTON,Gestion Documental", 2377, 2398, Boton4_10;
     nBoton4_10 = FSalida;

                         |ESTADO_CONTROL nBoton4_1,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_2,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_3,  "ENABLE";
                         |ESTADO_CONTROL nBoton4_11, "ENABLE";

                         |ESTADO_CONTROL nBoton4_4, "DISABLE";
                         |ESTADO_CONTROL nBoton4_5, "DISABLE";
     |SI #511#25 = "S";  |ESTADO_CONTROL nBoton4_4, "ENABLE";  |FINSI;
     |SI #511#26 = "S";  |ESTADO_CONTROL nBoton4_5, "ENABLE";  |FINSI;

                         |ESTADO_CONTROL nBoton4_6, "DISABLE";
                         |ESTADO_CONTROL nBoton4_7, "DISABLE";
                         |ESTADO_CONTROL nBoton4_8, "DISABLE";

                         |ESTADO_CONTROL nBoton4_9,  "DISABLE";
                         |ESTADO_CONTROL nBoton4_12, "DISABLE";

                         |ESTADO_CONTROL nBoton4_10, "DISABLE";
     |SI #511#31 = "S";  |ESTADO_CONTROL nBoton4_10, "ENABLE";  |FINSI;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |DBASS aBase;  |QBF aBase;
     aPathGecochek = aBase + "gecochek/fich/";
     |PATH_DAT #110 aPathGecochek;

     |ABRET #1;
     |ABRET #999;

     FSalida = 2899;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #1;
     |CIERRAT #999;
|FPRC;

|PROGRAMA;
     aUsuario = Usuario % 810;
     |ABRE #511;
     #511#0 = aUsuario;
     |LEE 000#511=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe el Usuario en Permisos de Usuarios.";
         |CIERRA #511;
         |ACABA;
     |FINSI;
     |CIERRA #511;


     |PINPA #0#1;  nPanta0 = FSalida;

     |PINPA #1#1;  nPanta1 = FSalida;

     nRango = 4 + 8 + 16 + 32;

     nPos1       = 0702;
     nPos2       = 2375;
     nTipoPanta1 = 10;

     |LINEAL_SIMPLE #1#1, nRango, nPos1, nPos2, BajaPanta1, AltaPanta1, EventoPanta1;
     nGrid1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "EVENTOPAN", 0000, 0000, EventoFocoGrid1;
     nFoco1 = FSalida;

     |PINPA #2#1;  nPanta2 = FSalida;

     nPos1       = 0702;
     nPos2       = 2375;
     nTipoPanta2 = 20;

     |LINEAL_SIMPLE #1#1, nRango, nPos1, nPos2, BajaPanta2, AltaPanta2, EventoPanta2;
     nGrid2 = FSalida;

     |CONTROL_SIMPLE nPanta2, "EVENTOPAN", 0000, 0000, EventoFocoGrid2;
     nFoco2 = FSalida;

     |PINPA #3#1;  nPanta3 = FSalida;

     nPos1       = 0902;
     nPos2       = 2375;
     nTipoPanta3 = 30;

     |LINEAL_SIMPLE #1#1, nRango, nPos1, nPos2, BajaPanta3, AltaPanta3, EventoPanta3;
     nGrid3 = FSalida;

     |CONTROL_SIMPLE nPanta3, "EVENTOPAN", 0000, 0000, EventoFocoGrid3;
     nFoco3 = FSalida;

     |PINPA #4#1;  nPanta4 = FSalida;

     nPos1       = 0802;
     nPos2       = 2375;
     nTipoPanta4 = 40;

     |LINEAL_SIMPLE #1#1, nRango, nPos1, nPos2, BajaPanta4, AltaPanta4, EventoPanta4;
     nGrid4 = FSalida;

     |CONTROL_SIMPLE nPanta4, "EVENTOPAN", 0000, 0000, EventoFocoGrid4;
     nFoco4 = FSalida;

     |HAZ BotonesPanta0;
     |HAZ BotonesPanta1;
     |HAZ BotonesPanta2;
     |HAZ BotonesPanta3;
     |HAZ BotonesPanta4;

     nTipoActual = 10;

     |LEE 000#1p;
     |SI FSalida ! 0;
         |HAZ Boton0_1;
     |SINO;
         |ABRE #0;
         |LEE 101#0p;
         |SI FSalida = 0;
             |SI #0#17 = 1;
                 |HAZ Boton0_1;

                 #0#17 = 0;
                 |GRABA 020#0a;
             |FINSI;
             |LIBERA #0;
         |FINSI;
         |CIERRA #0;
     |FINSI;

     |FOCOTECLADO nGrid1;

     FSalida = 1;
     |HAZ EventoPanta1;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir," + nGrid1;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |SI nBotonFoto ! -1;  |FIN_CONTROL_WINDOWS nBotonFoto;  |FINSI;

     |FIN_CONTROL_WINDOWS nBoton0_1;
     |FIN_CONTROL_WINDOWS nBoton0_2;
     |FIN_CONTROL_WINDOWS nBoton0_3;
     |FIN_CONTROL_WINDOWS nBoton0_4;
     |FIN_CONTROL_WINDOWS nBoton0_5;
     |FIN_CONTROL_WINDOWS nBoton0_6;
     |FIN_CONTROL_WINDOWS nBoton0_7;
     |FIN_CONTROL_WINDOWS nBoton0_8;
     |FIN_CONTROL_WINDOWS nBoton0_9;
     |FIN_CONTROL_WINDOWS nBoton0_10;
     |FIN_CONTROL_WINDOWS nBoton0_11;
     |FIN_CONTROL_WINDOWS nBoton0_12;
     |FIN_CONTROL_WINDOWS nBoton0_13;
     |FIN_CONTROL_WINDOWS nBoton1_1;
     |FIN_CONTROL_WINDOWS nBoton1_2;
     |FIN_CONTROL_WINDOWS nBoton1_3;
     |FIN_CONTROL_WINDOWS nBoton1_4;
     |FIN_CONTROL_WINDOWS nBoton1_5;
     |FIN_CONTROL_WINDOWS nBoton1_6;
     |FIN_CONTROL_WINDOWS nBoton1_7;
     |FIN_CONTROL_WINDOWS nBoton2_1;
     |FIN_CONTROL_WINDOWS nBoton2_2;
     |FIN_CONTROL_WINDOWS nBoton2_3;
     |FIN_CONTROL_WINDOWS nBoton2_4;
     |FIN_CONTROL_WINDOWS nBoton2_6;
     |FIN_CONTROL_WINDOWS nBoton2_7;
     |FIN_CONTROL_WINDOWS nBoton2_8;
     |FIN_CONTROL_WINDOWS nBoton2_9;
     |FIN_CONTROL_WINDOWS nBoton3_1;
     |FIN_CONTROL_WINDOWS nBoton3_2;
     |FIN_CONTROL_WINDOWS nBoton3_3;
     |FIN_CONTROL_WINDOWS nBoton3_4;
     |FIN_CONTROL_WINDOWS nBoton3_5;
     |FIN_CONTROL_WINDOWS nBoton3_6;
     |FIN_CONTROL_WINDOWS nBoton3_7;
     |FIN_CONTROL_WINDOWS nBoton3_8;
     |FIN_CONTROL_WINDOWS nBoton3_9;
     |FIN_CONTROL_WINDOWS nBoton3_10;
     |FIN_CONTROL_WINDOWS nBoton3_11;
     |FIN_CONTROL_WINDOWS nBoton3_12;
     |FIN_CONTROL_WINDOWS nBoton3_13;
     |FIN_CONTROL_WINDOWS nBoton3_14;
     |FIN_CONTROL_WINDOWS nBoton3_15;
     |FIN_CONTROL_WINDOWS nBoton3_16;
     |FIN_CONTROL_WINDOWS nBoton3_17;
     |FIN_CONTROL_WINDOWS nBoton3_18;
     |FIN_CONTROL_WINDOWS nBoton3_19;
     |FIN_CONTROL_WINDOWS nBoton4_1;
     |FIN_CONTROL_WINDOWS nBoton4_2;
     |FIN_CONTROL_WINDOWS nBoton4_3;
     |FIN_CONTROL_WINDOWS nBoton4_11;
     |FIN_CONTROL_WINDOWS nBoton4_4;
     |FIN_CONTROL_WINDOWS nBoton4_5;
     |FIN_CONTROL_WINDOWS nBoton4_6;
     |FIN_CONTROL_WINDOWS nBoton4_7;
     |FIN_CONTROL_WINDOWS nBoton4_8;
     |FIN_CONTROL_WINDOWS nBoton4_9;
     |FIN_CONTROL_WINDOWS nBoton4_10;
     |FIN_CONTROL_WINDOWS nBoton4_12;

     |FIN_CONTROL_WINDOWS nFoco1;
     |FIN_CONTROL_WINDOWS nFoco2;
     |FIN_CONTROL_WINDOWS nFoco3;
     |FIN_CONTROL_WINDOWS nFoco4;

     |DESTRUYECONTROL nGrid1;
     |DESTRUYECONTROL nGrid2;
     |DESTRUYECONTROL nGrid3;
     |DESTRUYECONTROL nGrid4;

     |PULSATECLA;
|FPRO;
