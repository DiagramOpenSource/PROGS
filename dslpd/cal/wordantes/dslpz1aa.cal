|| ---------------------------------------
|| Documento de Seguridad
|| ---------------------------------------
|FICHEROS;
     dslpz001 #0;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm007 #7;
     dslpm100 #100;
     dslpw051 #951;
     dslpw052 #952;
     dslpw054 #954;
     dslpw101 #1001;
|FIN;

|VARIABLES;
      aAlfa         = "";
      aAlfa1        = "";
      aAlfa2        = "";
      aDocRtf       = "";
      aNif          = "";
      aFichero      = "";
      aDesResponS   = "";
      aDesResponP   = "";
      aNombre       = "";
      aNivel        = "";
      aAlfaAlto     = "";
      aAlfaMedio    = "";
      aAlfaBasico   = "";
      aGuaRespon    = "";
      aDepar        = "";
      aAsigna1      = "";
      aAsigna2      = "";
      aAsigna3      = "";
      aAsigna4      = "";
      aAsigna5      = "";
      aFrase        = "";
      aFrase1       = "";
      aFrase2       = "";
      aFrase3       = "";
      aFrase4       = "";
      aFrase5       = "";
      aLong         = "";
      aCompleta     = "";

      nNumFich      = 0;
      nHandle       = 0;
      nSwHay        = 0;
      nPers         = 0;
      nCampo        = 0;
      nHastaCampo   = 0;
      nContador     = 0;
      nTabla        = 0;
      nPara         = 0;
      nBuffer       = 0;
      nFrase        = 0;
      nLong         = 0;
      nLong1        = 0;
      nLong2        = 0;


     &enCliente      = 0;
     &enModelo       = 0;
     &enFichero      = 0;
     &eaNomFichero   = "";
     &enError        = 0;
     &eaAlfa         = "";
     &eaAsigna       = "";
     &eaHora         = "";
     &enWord1        = 0;
     &enCamWord      = 0;
     &enCargaPuntero = 0;
     &eaGuarda       = "";
     &enTipoDoc      = 0;
     &enDocumento    = 0;

   {500} &eaCamWord  = "";
|FIN;

|| ------------------------------------------------------
|| Procesos de la Generacion del Documento de Seguridad
|| ------------------------------------------------------

|PROCESO dslpm006C2;
     |SI aNif = #6#5;  |ACABA;  |FINSI;

     aNif    = #6#5;
     |SI nContador ! 0;
         aAlfa1    = "}1}" + nContador + "}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #6#6;                                   |HAZ QuitaRaros;
     aAlfa1 = "}1}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
|FPRC;

|DEFBUCLE dslpm006C2;
     #6#2;
     ;
     #5#0, #5#1, #5#2, "            ";
     #5#0, #5#1, #5#2, "zzzzzzzzzzzz";
     ;
     NULL, dslpm006C2;
|FIN;

|PROCESO RespTratamiento;
     aNif      = "";
     nContador = 0;
     |BUCLE dslpm006C2;
     |SI nContador = 0;
         eaAlfa = #4#6;                                   |HAZ QuitaRaros;
         aAlfa1 = "}1}1}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;
|FPRC;

|PROCESO dslpm006C3;
     |SI aNif = #6#7;  |ACABA;  |FINSI;

     aNif = #6#7;
     |SI nContador ! 0;
         aAlfa1    = "}2}" + nContador + "}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #6#8;                                   |HAZ QuitaRaros;
     aAlfa1 = "}2}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
|FPRC;

|DEFBUCLE dslpm006C3;
     #6#3;
     ;
     #5#0, #5#1, #5#2, "            ";
     #5#0, #5#1, #5#2, "zzzzzzzzzzzz";
     ;
     NULL, dslpm006C3;
|FIN;

|PROCESO EncTratamiento;
     aNif      = "";
     nContador = 0;
     |BUCLE dslpm006C3;
     |SI nContador = 0;
         eaAlfa = #4#18;                                   |HAZ QuitaRaros;
         aAlfa1 = "}2}1}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;
|FPRC;

|PROCESO dslpm007;
     |SI nContador ! 0;
         aAlfa1    = "}3}" + nContador + "}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #7#3;                           |HAZ QuitaRaros;
     aAlfa1 = "}3}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     eaAlfa = #7#4;                           |HAZ QuitaRaros;
     aAlfa1 = "}3}" + nContador + "}2}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
|FPRC;

|DEFBUCLE dslpm007;
     #7#1;
     ;
     #5#0, #5#1, #5#2, "        ";
     #5#0, #5#1, #5#2, "zzzzzzzz";
     ;
     NULL, dslpm007;
|FIN;

|PROCESO Aplicaciones;
     nContador = 0;
     |BUCLE dslpm007;
|FPRC;

|PROCESO dslpm006C1;
     |SI nPers = 1;  nTabla = 4;  |FINSI;
     |SI nPers = 2;  nTabla = 5;  |FINSI;

     |SI nContador ! 0;
         aAlfa1    = "}" + nTabla + "}" + nContador + "}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #6#4;                           |HAZ QuitaRaros;
     aAlfa1 = "}" + nTabla + "}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     |SI nPers = 1;  eaAlfa = #6#6;  |FINSI;
     |SI nPers = 2;  eaAlfa = #6#8;  |FINSI;

     |HAZ QuitaRaros;

     aAlfa1 = "}" + nTabla + "}" + nContador + "}2}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
|FPRC;

|DEFBUCLE dslpm006C1;
     #6#1;
     ;
     #5#0, #5#1, #5#2, "   ";
     #5#0, #5#1, #5#2, "zzz";
     ;
     NULL, dslpm006C1;
|FIN;

|PROCESO RespDepartamento;
     nContador = 0;
     nPers     = 1;
     |BUCLE dslpm006C1;
     |SI nContador = 0;
         eaAlfa = #4#5;                           |HAZ QuitaRaros;
         aAlfa1 = "}4}1}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         eaAlfa = #4#6;

         |HAZ QuitaRaros;

         aAlfa1 = "}4}1}2}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;
|FPRC;

|PROCESO EncDepartamento;
     nContador = 0;
     nPers     = 2;
     |BUCLE dslpm006C1;
     |SI nContador = 0;
         eaAlfa = #4#17;                           |HAZ QuitaRaros;
         aAlfa1 = "}5}1}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         eaAlfa = #4#18;

         |HAZ QuitaRaros;

         aAlfa1 = "}5}1}2}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;
|FPRC;

|PROCESO Copias;
     nHastaCampo = 0;
     |PARA nCampo = 62;  |SI nCampo ] 33;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #4nCampo;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo = 0;
         eaAlfa   = "";
         eaAsigna = "<<COPIAS>>";  |HAZ AsignaWord1;
     |SINO;
         |HAZ CopiaRTF;
         aDocRtf = "C:/DOCUMENTOS/DSLPD/DOCDSLPD/planilla.rtf";
         |XABRE "CA", aDocRtf, nHandle;
         |SI FSalida ] 0;
             |PARA nCampo = 33;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
                   eaAlfa  = #4nCampo;  |QBF eaAlfa;
                   |SI nCampo = 33;
                       eaAlfa  = "{\b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |SINO;
                       eaAlfa  = " \b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |FINSI;
                   |HAZ QuitaRaros;
                   |XGRABA nHandle, eaAlfa;
              |SIGUE;
              eaAlfa  = " \par} }";
              |XGRABA nHandle, eaAlfa;
         |FINSI;
         |XCIERRA nHandle;

         |WORD_CARGA_TEXTO enWord1, "!<<COPIAS>>", aDocRtf;
         |RFBORRA aDocRtf;
     |FINSI;
|FPRC;

|PROCESO DescEstructura;
     nHastaCampo = 0;
     |PARA nCampo = 108;  |SI nCampo ] 79;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #4nCampo;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo = 0;
         eaAlfa   = "";
         eaAsigna = "<<DESESTRUCTURA>>";  |HAZ AsignaWord1;
     |SINO;
         |HAZ CopiaRTF;
         aDocRtf = "C:/DOCUMENTOS/DSLPD/DOCDSLPD/planilla.rtf";
         |XABRE "CA", aDocRtf, nHandle;
         |SI FSalida ] 0;
             |PARA nCampo = 79;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
                   eaAlfa  = #4nCampo;  |QBF eaAlfa;
                   |SI nCampo = 79;
                       eaAlfa  = "{\b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |SINO;
                       eaAlfa  = " \b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |FINSI;
                   |HAZ QuitaRaros;
                   |XGRABA nHandle, eaAlfa;
              |SIGUE;
              eaAlfa  = " \par} }";
              |XGRABA nHandle, eaAlfa;
         |FINSI;
         |XCIERRA nHandle;

         |WORD_CARGA_TEXTO enWord1, "!<<DESESTRUCTURA>>", aDocRtf;
         |RFBORRA aDocRtf;
     |FINSI;
|FPRC;

|PROCESO Mantenimiento;
     nHastaCampo = 0;
     |PARA nCampo = 138;  |SI nCampo ] 109;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #4nCampo;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo = 0;
         eaAlfa   = "";
         eaAsigna = "<<MANTENIMIENTO>>";  |HAZ AsignaWord1;
     |SINO;
         |HAZ CopiaRTF;
         aDocRtf = "C:/DOCUMENTOS/DSLPD/DOCDSLPD/planilla.rtf";
         |XABRE "CA", aDocRtf, nHandle;
         |SI FSalida ] 0;
             |PARA nCampo = 109;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
                   eaAlfa = #4nCampo;  |QBF eaAlfa;
                   eaAlfa  = "{\b\f1\cf9\insrsid8939702\charrsid8939702 " + &9 + eaAlfa + " \par}";
                   |HAZ QuitaRaros;
                   |XGRABA nHandle, eaAlfa;
              |SIGUE;

              eaAlfa  = " }";
              |XGRABA nHandle, eaAlfa;
         |FINSI;
         |XCIERRA nHandle;

         |WORD_CARGA_TEXTO enWord1, "!<<MANTENIMIENTO>>", aDocRtf;

         |RFBORRA aDocRtf;
     |FINSI;
|FPRC;

|PROCESO AsignaSourcing;
     |SI nContador ! 1;
         aAlfa1 = "}" + nTabla +"}" + nContador + "}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}" + nTabla +"}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     |QBF eaAlfa;  |HAZ QuitaRaros;

     aAlfa1 = "}" + nTabla +"}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     eaAlfa = #2#2;                                   |HAZ QuitaRaros;
     aAlfa1 = "}" + nTabla +"}" + nContador + "}2}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
|FPRC;

|PROCESO dslpm002aa;
     |SI #2#35 = "N";  |Y #2#36 = "N";  |Y #2#37 = "N";
      |Y #2#38 = "N";  |Y #2#39 = "N";  |Y #2#40 = "N";
         |ACABA;
     |FINSI;

     |SI #2#35 = "S";  eaAlfa = "Bancos";                 |HAZ AsignaSourcing;  |FINSI;
     |SI #2#36 = "S";  eaAlfa = "Informatica";            |HAZ AsignaSourcing;  |FINSI;
     |SI #2#37 = "S";
          |SI #2#44 = "S"; |Y #2#45 = "S";
               eaAlfa = "Asesoria (Fiscal y Laboral)"; |HAZ AsignaSourcing;
          |SINO;
               |SI #2#43 = "S"; eaAlfa = "Asesoria (LPD)"; |HAZ AsignaSourcing; |FINSI;
               |SI #2#44 = "S"; eaAlfa = "Asesoria (Fiscal)"; |HAZ AsignaSourcing; |FINSI;
               |SI #2#45 = "S"; eaAlfa = "Asesoria (Laboral)"; |HAZ AsignaSourcing; |FINSI;
          |FINSI;
     |FINSI;
     |SI #2#38 = "S";  eaAlfa = "Auditoria";              |HAZ AsignaSourcing;  |FINSI;
     |SI #2#39 = "S";  eaAlfa = "Prevenci¢n de Riesgos";  |HAZ AsignaSourcing;  |FINSI;
     |SI #2#40 = "S";  eaAlfa = #2#41;                    |HAZ AsignaSourcing;  |FINSI;
|FPRC;

|DEFBUCLE dslpm002aa;
     #2#1;
     ;
     #4#0, "            ";
     #4#0, "zzzzzzzzzzzz";
     ;
     NULL, dslpm002aa;
|FIN;

|PROCESO OutSourcing;
     |SI enTipoDoc = 90;  nTabla = 6; |FINSI;
     |SI enTipoDoc = 91;  nTabla = 5; |FINSI;

     nContador = 1;
     |BUCLE dslpm002aa;
|FPRC;

|PROCESO PonDirigirseA;
     |SI #5#243 ! "            ";
         aNif    = #5#243;  |HAZ LeeNif;
     |SINO;
         aNif    = #5#6;    |HAZ LeeNif;
     |FINSI;

     aAlfa = #100#2;  |QBF aAlfa;
     aAlfa = aAlfa + " " + #100#3;  |QBF aAlfa;
     |SI #100#4 ! "    ";
         aAlfa = aAlfa + ", Numero: " + #100#4;  |QBF aAlfa;
     |FINSI;
     |SI #100#5 ! "   ";
         aAlfa = aAlfa + ", Escalera: " + #100#5;  |QBF aAlfa;
     |FINSI;
     |SI #100#6 ! "  ";
         aAlfa = aAlfa + ", Piso: " + #100#6;  |QBF aAlfa;
     |FINSI;
     |SI #100#7 ! "  ";
         aAlfa = aAlfa + ", Puerta: " + #100#7;  |QBF aAlfa;
     |FINSI;
     eaAlfa   = aAlfa;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#4#";   |HAZ AsignaWord1;

     aAlfa    = (("00" + #100#8) % -102) + (("000" + #100#9) % -103);
     aAlfa    = aAlfa + " " + #100#10;  |QBF aAlfa;
     aAlfa    = aAlfa + " (" + #100#11;  |QBF aAlfa;
     aAlfa    = aAlfa + ")";
     eaAlfa   = aAlfa;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#12#";  |HAZ AsignaWord1;
|FPRC;

|PROCESO PorFichero;
     |HORA eaHora;
     eaGuarda       = "S";
     enCargaPuntero = 1;
     enDocumento    = 0;

     |HAZ SacaDocumentos;
     |SI eaNomFichero = "";  |ACABA;  |FINSI;

     |HAZ EdicionWord;
     |SI enError = 1;  |ACABA;  |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = enModelo;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = enModelo;
     #5#2 = enFichero;
     |LEE 000#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     eaAlfa   = #1#2;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#2#";   |HAZ AsignaWord1;

     eaAlfa   = #5#3;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#3#";   |HAZ AsignaWord1;

     eaAlfa   = #5#4;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#4#";   |HAZ AsignaWord1;

     eaAlfa   = #5#5;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#5#";   |HAZ AsignaWord1;

     eaAlfa   = #5#7;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#7#";   |HAZ AsignaWord1;

     eaAlfa   = #5#17;            |QBF eaAlfa;
     |SI eaAlfa ! ""
         eaAlfa = "En aplicaci¢n de lo anterior, se designa/n como"; |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCFICHERO6#";   |HAZ AsignaWord1;

         eaAlfa = "Encargado del Fichero";    |HAZ QuitaRaros
         eaAsigna = "#FRASEENCFICHERO7#";   |HAZ AsignaWord1;

         eaAlfa = "objeto del presente Documento de Seguridad a"; |HAZ QuitaRaros
         eaAsigna = "#FRASEENCFICHERO8#";   |HAZ AsignaWord1;
     |SINO;
         eaAlfa = "";
         eaAsigna = "#FRASEENCFICHERO6#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO7#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO8#";   |HAZ AsignaWord1;
     |FINSI;

     eaAlfa   = #5#17;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#17#";  |HAZ AsignaWord1;

     eaAlfa   = #5#9;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#9#";   |HAZ AsignaWord1;

     eaAlfa   = #5#11;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#11#";  |HAZ AsignaWord1;

     eaAlfa   = #5#13;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#13#";  |HAZ AsignaWord1;

     eaAlfa   = #5#15;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#15#";  |HAZ AsignaWord1;

     eaAlfa   = #5#19;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#19#";  |HAZ AsignaWord1;

     eaAlfa   = #5#21;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#21#";  |HAZ AsignaWord1;

     eaAlfa   = #5#23;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#23#";  |HAZ AsignaWord1;

     eaAlfa   = #5#25;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#25#";  |HAZ AsignaWord1;

     eaAlfa   = #4#8;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#8#";   |HAZ AsignaWord1;

     eaAlfa   = #4#28;
     |SI #4#27 = "D";  eaAlfa = "DIARIA";     |FINSI;
     |SI #4#27 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#27 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#27 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#27 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#27#";  |HAZ AsignaWord1;

     eaAlfa   = #4#30;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#30#";  |HAZ AsignaWord1;

     eaAlfa   = #4#31;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#31#";  |HAZ AsignaWord1;

     eaAlfa   = #4#32;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#32#";  |HAZ AsignaWord1;

     eaAlfa   = #4#63;
     eaAsigna = "#dslpm004#63#";  |HAZ AsignaWord1;

     eaAlfa   = #4#64;
     eaAsigna = "#dslpm004#64#";  |HAZ AsignaWord1;

     eaAlfa   = #4#66;
     |SI #4#65 = "D";  eaAlfa = "DIARIO";     |FINSI;
     |SI #4#65 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#65 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#65 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#65 = "T";  eaAlfa = "TRIMESTRAL"; |FINSI;
     |SI #4#65 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |SI #4#65 = "B";  eaAlfa = "BIANUAL";    |FINSI;
     |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#65#";  |HAZ AsignaWord1;

     eaAlfa   = #4#67;
     eaAsigna = "#dslpm004#67#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#70 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#70#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#71 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#71#";  |HAZ AsignaWord1;

     eaAlfa   = #4#74;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#74#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#75 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#75#";  |HAZ AsignaWord1;

     eaAlfa   = #4#77;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#77#";  |HAZ AsignaWord1;

     eaAlfa   = #4#78;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#78#";  |HAZ AsignaWord1;

     |HAZ RespTratamiento;
     |HAZ EncTratamiento;
     |HAZ Aplicaciones;
     |HAZ RespDepartamento;
     |HAZ EncDepartamento;
     |HAZ Copias;
     |HAZ DescEstructura;
     |HAZ Mantenimiento;
     |HAZ OutSourcing;
     |HAZ PonDirigirseA;

     |HAZ FinDocumentoWord;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = enModelo;
     #5#2 = enFichero;
     |LEE 101#5=;
     |SI FSalida = 0;
         #5#239 = ~;
         #5#240 = eaHora;
         |GRABA 020#5a;
         |LIBERA #5;
     |FINSI;
     |CIERRA #5;

     #1001#0 = #0#0;
     #1001#1 = enModelo;
     #1001#2 = enFichero;
     |LEE 000#1001=;
     |SI FSalida = 0;
         #1001#5 = ~;
         #1001#6 = eaHora;
         |GRABA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO LeeNif;
     |ABRE #100;
     #100#0 = aNif;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;
|FPRC;

|PROCESO GrabaNif;
     |SI aNif = "            ";  |ACABA;  |FINSI;

     #951#0  = #5#1;
     #951#1  = #5#2;
     #951#2  = aNif;
     |LEE 101#951=;
     |SI FSalida ! 0;
         |DDEFECTO #951;
         #951#0  = #5#1;
         #951#1  = #5#2;
         #951#2  = aNif;
         |GRABA 020#951b;
     |FINSI;

     #951#3     = aNombre;
     #951#4     = #100#2;
     #951#5     = #100#3;
     #951#6     = #100#4;
     #951#7     = #100#5;
     #951#8     = #100#6;
     #951#9     = #100#7;
     #951#10    = #100#8;
     #951#11    = #100#9;
     #951#12    = #100#10;
     #951#13    = #100#11;
     #951#14    = #100#12;
     #951#15    = #100#13;
     #951#16    = #100#14;
     #951#17    = #100#15;
     #951#30    = #1#18;
     #951#44    = #5#3;
     #951#45    = #5#4;
     #951nCampo = "S";
     #951#47    = aDepar;

     |GRABA 020#951a;
     |LIBERA #951;
|FPRC;

|PROCESO dslpm006z1;
     |SI #6#5  ! "            ";
         aNif    = #6#5;  |HAZ LeeNif;
         aNombre = #6#6;
         nCampo  = 19;
         aDepar  = #6#4;
         nPara   = 1;
         |HAZ GrabaNif;
     |FINSI;

     |SI #6#7  ! "            ";
         aNif    = #6#7;  |HAZ LeeNif;
         aNombre = #6#8;
         nCampo  = 25;
         aDepar  = #6#4;
         nPara   = 1;
         |HAZ GrabaNif;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm006z1;
     #6#2;
     ;
     #5#0, #5#1, #5#2, "            ";
     #5#0, #5#1, #5#2, "zzzzzzzzzzzz";
     ;
     NULL, dslpm006z1;
|FIN;

|PROCESO dslpm005z1_1;
     #dslpw054#0 = #dslpm005#1;
     #dslpw054#2 = #dslpm005#2;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     #5#239 = ~;
     #5#240 = eaHora;
     |GRABA 020#5a;
     |LIBERA #5;

     #1001#0 = #5#0;
     #1001#1 = #5#1;
     #1001#2 = #5#2;
     |LEE 000#1001=;
     |SI FSalida = 0;
         #1001#5 = ~;
         #1001#6 = eaHora;
         |GRABA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |SI nContador ! 0;
         aAlfa1    = "}1}" + nContador + "}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #5#3;                                   |HAZ QuitaRaros;
     aAlfa1 = "}1}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     eaAlfa = #5#4;                                   |HAZ QuitaRaros;
     aAlfa1 = "}1}" + nContador + "}2}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     |SI #5#243 ! "            ";
         aNif    = #5#243;  |HAZ LeeNif;
         aNombre = #5#244;
         nCampo  = 46;
         aDepar  = "";
         |HAZ GrabaNif;
     |SINO;
         aNif    = #5#6;  |HAZ LeeNif;
         aNombre = #5#7;
         nCampo  = 46;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#6   ! "            ";
         aNif    = #5#6;  |HAZ LeeNif;
         aNombre = #5#7;
         nCampo  = 18;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#16  ! "            ";
         aNif    = #5#16;  |HAZ LeeNif;
         aNombre = #5#17;
         nCampo  = 24;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#8   ! "            ";
         aNif    = #5#8;  |HAZ LeeNif;
         aNombre = #5#9;
         nCampo  = 20;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#18  ! "            ";
         aNif    = #5#18;  |HAZ LeeNif;
         aNombre = #5#19;
         nCampo  = 26;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#10  ! "            ";
         aNif    = #5#10;  |HAZ LeeNif;
         aNombre = #5#11;
         nCampo  = 21;
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#20  ! "            ";
         aNif    = #5#20;  |HAZ LeeNif;
         aNombre = #5#21;
         nCampo  = 27;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#12  ! "            ";
         aNif    = #5#12;  |HAZ LeeNif;
         aNombre = #5#13;
         nCampo  = 22;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#22  ! "            ";
         aNif    = #5#22;  |HAZ LeeNif;
         aNombre = #5#23;
         nCampo  = 28;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#14  ! "            ";
         aNif    = #5#14;  |HAZ LeeNif;
         aNombre = #5#15;
         nCampo  = 23;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#24  ! "            ";
         aNif    = #5#24;  |HAZ LeeNif;
         aNombre = #5#25;
         nCampo  = 29;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     nPara = 0;
     |BUCLE dslpm006z1;
     |SI nPara = 0;
         aNif    = #4#5;  |HAZ LeeNif;
         aNombre = #4#6;
         nCampo  = 19;
         aDepar  = "Sin Departamento";
         |HAZ GrabaNif;

         aNif    = #4#17;  |HAZ LeeNif;
         aNombre = #4#18;
         nCampo  = 25;
         aDepar  = "Sin Departamento";
         |HAZ GrabaNif;
     |FINSI;

     #952#0 = #5#1;
     #952#1 = #5#2;
     |LEE 101#952=;
     |SI FSalida ! 0;
         |DDEFECTO #952;
         #952#0 = #5#1;
         #952#1 = #5#2;
         |GRABA 020#952b;
     |FINSI;

     #952#2 = #5#5;
     #952#3 = #5#3;
     #952#4 = #5#4;
     |GRABA 020#952a;
     |LIBERA #952;
|FPRC;

|DEFBUCLE dslpm005z1_1;
     #5#1;
     ;
     #1#1, 0000, 00000;
     #1#1, 9999, 99999;
     be;
     NULL, dslpm005z1_1;
|FIN;

|PROCESO dslpw051_1;
     #dslpw054#0 = #dslpw051#0;
     #dslpw054#2 = #dslpw051#1;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     |SI aNif = #951#2;
         eaAlfa = eaAlfa + ", " + #951#44;  |QBF eaAlfa;
         |ACABA;
     |FINSI;

     |SI aNif ! "";
         |HAZ QuitaRaros;
         aAlfa1 = "}2}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     aNif = #951#2;

     |SI nContador ! 0;
         aAlfa1    = "}2}" + nContador + "}1}+F";
         aAlfa2    = "1";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #951#4;  |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + #951#5;  |QBF eaAlfa;
     |SI #951#6 ! "    ";
         eaAlfa = eaAlfa + ", " + #951#6;  |QBF eaAlfa;
     |FINSI;
     |SI #951#7 ! "   ";
         eaAlfa = eaAlfa + " " + #951#7;  |QBF eaAlfa;
     |FINSI;
     |SI #951#8 ! "  ";
         eaAlfa = eaAlfa + " " + #951#8;  |QBF eaAlfa;
     |FINSI;
     |SI #951#9 ! "  ";
         eaAlfa = eaAlfa + " " + #951#9;  |QBF eaAlfa;
     |FINSI;

     eaAlfa = eaAlfa + ", " + (("00" + #951#10) % -102) + (("000" + #951#11) % -103);
     eaAlfa = eaAlfa + " " + #951#12;   |QBF eaAlfa;
     eaAlfa = eaAlfa + " (" + #951#13;  |QBF eaAlfa;
     eaAlfa = eaAlfa + ") para el/los fichero/s:";
     eaAlfa = eaAlfa + " " + #951#44;  |QBF eaAlfa;
|FPRC;

|DEFBUCLE dslpw051_1;
     #951#2;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_1;
|FIN;

|PROCESO Ubicaciones;
     nContador = 0;
     aNif      = "";
     |BUCLE dslpw051_1;
     |SI nContador ! 0;
         |HAZ QuitaRaros;
         aAlfa1 = "}2}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;
|FPRC;

|PROCESO dslpw051_2;
     #dslpw054#0 = #dslpw051#0;
     #dslpw054#2 = #dslpw051#1;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     |SI aNif = "";
         nContador = 2;
         aAlfa1    = "}3}2}1}";
         aAlfa2    = "Responsable de los Ficheros:";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     |SI aNif = #951#2;
         eaAlfa = eaAlfa + ", " + #951#44;  |QBF eaAlfa;
         |ACABA;
     |FINSI;

     |SI aNif ! "";
         aAlfa1    = "}3}2}1}";
         aAlfa2    = "Responsables de los Ficheros:";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;
     |FINSI;

     aNif      = #951#2;
     nContador = nContador + 1;

     eaAlfa = #951#3;  |QBF eaAlfa;
     eaAlfa = eaAlfa + " para el/los ficheros: " + #951#44;  |QBF eaAlfa;
|FPRC;

|DEFBUCLE dslpw051_2;
     #951#3;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_2;
|FIN;

|PROCESO dslpw051_3;
     |SI aNif = "";
         |SI nContador = 0;
             nContador = 2;
         |SINO;
             aAlfa1 = "}3}1}1}+G";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             aAlfa1 = "}3}1}1}+P";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             aAlfa1 = "}3}2}1}+G";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             aAlfa1 = "}3}2}1}+P";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             nContador = nContador + 2;
         |FINSI;

         aGuaRespon = "}3}" + nContador + "}1}";
         aAlfa1     = aGuaRespon;
         aAlfa      = eaAlfa
         eaAlfa     = aDesResponS;  |HAZ QuitaRaros;
         aAlfa2     = eaAlfa;
         eaAlfa     = aAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     |SI aNif = #951#2;
         eaAlfa = eaAlfa + ", " + #951#44;  |QBF eaAlfa;
         |ACABA;
     |FINSI;

     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         aAlfa1     = aGuaRespon;
         aAlfa      = eaAlfa;
         eaAlfa     = aDesResponP;  |HAZ QuitaRaros;
         aAlfa2     = eaAlfa;
         eaAlfa     = aAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     aNif      = #951#2;
     eaAlfa    = #951#3;  |QBF eaAlfa;
     eaAlfa    = eaAlfa + " para el/los ficheros: " + #951#44;  |QBF eaAlfa;
     nContador = nContador + 1;
|FPRC;

|DEFBUCLE dslpw051_3;
     #951#4;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|PROCESO dslpw051_4;
     |SI aNif = "";
         |SI nContador = 0;
             nContador = 2;
         |SINO;
             aAlfa1 = "}3}1}1}+G";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             aAlfa1 = "}3}1}1}+P";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             aAlfa1 = "}3}2}1}+G";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             aAlfa1 = "}3}2}1}+P";
             aAlfa2 = "";
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

             nContador = nContador + 2;
         |FINSI;

         aGuaRespon = "}3}" + nContador + "}1}";
         aAlfa1     = aGuaRespon;
         aAlfa      = eaAlfa;
         eaAlfa     = aDesResponS;  |HAZ QuitaRaros;
         aAlfa2     = eaAlfa;
         eaAlfa     = aAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |SINO;
         |SI aNif ! #951#2;
             aAlfa1     = aGuaRespon;
             aAlfa      = eaAlfa;
             eaAlfa     = aDesResponP;  |HAZ QuitaRaros;
             aAlfa2     = eaAlfa;
             eaAlfa     = aAlfa;
             |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
         |FINSI;
     |FINSI;

     |SI aNif ! #951#2;
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nContador = nContador + 1;
         eaAlfa    = #951#3;  |QBF eaAlfa;
         |HAZ QuitaRaros;
         aAlfa1    = "}3}" + nContador + "}1}";
         aAlfa2    = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;
     |FINSI;

     aAlfa1 = "}3}3}1}+G";
     aAlfa2 = "";
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     aAlfa1 = "}3}1}1}+P";
     aAlfa2 = "";
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     nContador = nContador + 1;
     eaAlfa    = &9 + " para el fichero: " + #951#44;  |QBF eaAlfa;
     eaAlfa    = eaAlfa + " y el departamento " + #951#47;  |QBF eaAlfa;

     |HAZ QuitaRaros;
     aAlfa1 = "}3}" + nContador + "}1}";
     aAlfa2 = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     eaAlfa = " para el fichero: " + #951#44;  |QBF eaAlfa;
     eaAlfa = eaAlfa + " y el departamento " + #951#47;  |QBF eaAlfa;
     aAlfa2 = eaAlfa;

     nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

     aNif  = #951#2;
|FPRC;

|DEFBUCLE dslpw051_4;
     #951#5;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_4;
|FIN;

|DEFBUCLE dslpw051_5;
     #951#6;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_4;
|FIN;

|DEFBUCLE dslpw051_6;
     #951#7;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_7;
     #951#8;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_8;
     #951#9;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_9;
     #951#10;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_10;
     #951#11;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_11;
     #951#12;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_12;
     #951#13;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_13;
     #951#14;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|PROCESO AsignaFrase;
     aFrase1 = "";
     aFrase2 = "";
     aFrase3 = "";
     aFrase4 = "";
     aFrase5 = "";
     aFrase  = "";
     nFrase  = 1;
     |PARA nPara = 1;  |SI nPara [ 50;  |HACIENDO nPara = nPara + 1;
           |DEL_BUF nBuffer, nPara, aAlfa;  |QBF aAlfa;

           |SI aAlfa ! "";
               |SI nPara = 1;
                   aCompleta = aAlfa;  |QBF aCompleta;
               |SINO;
                   aCompleta = ", " + aAlfa;  |QBF aCompleta;
               |FINSI;
               aLong  = aCompleta % 0;  nLong1 = aLong;
               aLong  = aFrase    % 0;  nLong2 = aLong;

               nLong  = nLong1 + nLong2;

               |SI nLong > 250;
                   nFrase = nFrase + 1;
                   aFrase = "";
               |SINO;
                   aFrase = aFrase + aCompleta;
               |FINSI;

               |SI nPara = 1;
                   |SI nFrase = 1;  aFrase1 = aAlfa;  |QBF aFrase1;  |FINSI;
                   |SI nFrase = 2;  aFrase2 = aAlfa;  |QBF aFrase2;  |FINSI;
                   |SI nFrase = 3;  aFrase3 = aAlfa;  |QBF aFrase3;  |FINSI;
                   |SI nFrase = 4;  aFrase4 = aAlfa;  |QBF aFrase4;  |FINSI;
                   |SI nFrase = 5;  aFrase5 = aAlfa;  |QBF aFrase5;  |FINSI;
               |SINO;
                   |SI nFrase = 1;  aFrase1 = aFrase1 + ", " + aAlfa;  |QBF aFrase1;  |FINSI;
                   |SI nFrase = 2;  aFrase2 = aFrase2 + ", " + aAlfa;  |QBF aFrase2;  |FINSI;
                   |SI nFrase = 3;  aFrase3 = aFrase3 + ", " + aAlfa;  |QBF aFrase3;  |FINSI;
                   |SI nFrase = 4;  aFrase4 = aFrase4 + ", " + aAlfa;  |QBF aFrase4;  |FINSI;
                   |SI nFrase = 5;  aFrase5 = aFrase5 + ", " + aAlfa;  |QBF aFrase5;  |FINSI;
               |FINSI;
           |FINSI;

           aAlfa = "";
           |AL_BUF nBuffer, nPara, aAlfa;
     |SIGUE;

     eaAlfa   = aFrase1;  |HAZ QuitaRaros;
     eaAsigna = aAsigna1; |HAZ AsignaWord1;

     eaAlfa   = aFrase2;  |HAZ QuitaRaros;
     eaAsigna = aAsigna2; |HAZ AsignaWord1;

     eaAlfa   = aFrase3;  |HAZ QuitaRaros;
     eaAsigna = aAsigna3; |HAZ AsignaWord1;

     eaAlfa   = aFrase4;  |HAZ QuitaRaros;
     eaAsigna = aAsigna4; |HAZ AsignaWord1;

     eaAlfa   = aFrase5;  |HAZ QuitaRaros;
     eaAsigna = aAsigna5; |HAZ AsignaWord1;
|FPRC;

|PROCESO Responsables;
     |DIMENSIONA 50, nBuffer, 0;

     nContador = 0;
                     || Responsables de los Ficheros;

     aNif       = "";
     nPara      = 0;
     |BUCLE dslpw051_2;
     |SI aNif ! "";
         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         aAsigna1 = "#FRASERESFICHERO1#";
         aAsigna2 = "#FRASERESFICHERO2#";
         aAsigna3 = "#FRASERESFICHERO3#";
         aAsigna4 = "#FRASERESFICHERO4#";
         aAsigna5 = "#FRASERESFICHERO5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASERESFICHERO1#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESFICHERO2#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESFICHERO3#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESFICHERO4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESFICHERO5#";    |HAZ AsignaWord1;
     |FINSI;

                     || Encargado de los Ficheros;

     aNif        = "";
     aDesResponS = "Encargado de los Ficheros:";
     aDesResponP = "Encargados de los Ficheros:";
     nPara       = 0;
     |BUCLE dslpw051_3;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         eaAlfa = "En aplicaci¢n de lo anterior, se designa/n como"; |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCFICHERO6#";   |HAZ AsignaWord1;

         eaAlfa = "Encargado/s de los Ficheros";    |HAZ QuitaRaros
         eaAsigna = "#FRASEENCFICHERO7#";   |HAZ AsignaWord1;

         eaAlfa = "objeto del presente Documento de Seguridad a"; |HAZ QuitaRaros
         eaAsigna = "#FRASEENCFICHERO8#";   |HAZ AsignaWord1;

         aAsigna1 = "#FRASEENCFICHERO1#";
         aAsigna2 = "#FRASEENCFICHERO2#";
         aAsigna3 = "#FRASEENCFICHERO3#";
         aAsigna4 = "#FRASEENCFICHERO4#";
         aAsigna5 = "#FRASEENCFICHERO5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASEENCFICHERO1#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO2#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO3#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO5#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO6#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO7#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCFICHERO8#";    |HAZ AsignaWord1;
     |FINSI;

                     || Responsable de Tratamiento

     aNif        = "";
     aDesResponS = "Responsable de Tratamiento:";
     aDesResponP = "Responsables de Tratamiento:";
     nPara      = 0;
     |BUCLE dslpw051_4;

     aAsigna1 = "#FRASERESTRATAMIENTO1#";
     aAsigna2 = "#FRASERESTRATAMIENTO2#";
     aAsigna3 = "#FRASERESTRATAMIENTO3#";
     aAsigna4 = "#FRASERESTRATAMIENTO4#";
     aAsigna5 = "#FRASERESTRATAMIENTO5#";
     |HAZ AsignaFrase;

                     || Encargado de Tratamiento

     aNif        = "";
     aDesResponS = "Encargado de Tratamiento:";
     aDesResponP = "Encargados de Tratamiento:";
     nPara       = 0;
     |BUCLE dslpw051_5;
     |SI nPara = 0;
         eaAlfa   = "";
         eaAsigna = "#FRASEENCTRATAMIENTO1#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO2#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO3#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO4#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO5#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO6#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO7#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCTRATAMIENTO8#";   |HAZ AsignaWord1;
     |SINO;
         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCTRATAMIENTO1#";   |HAZ AsignaWord1;

         eaAlfa   = "Encargado/s del Tratamiento";    |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCTRATAMIENTO2#";       |HAZ AsignaWord1;

         eaAlfa   = "de los respectivos departamentos en lo que se divide la entidad a las siguientes personas:";
                                                    |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCTRATAMIENTO3#";       |HAZ AsignaWord1;

         aAsigna1 = "#FRASEENCTRATAMIENTO4#";
         aAsigna2 = "#FRASEENCTRATAMIENTO5#";
         aAsigna3 = "#FRASEENCTRATAMIENTO6#";
         aAsigna4 = "#FRASEENCTRATAMIENTO7#";
         aAsigna5 = "#FRASEENCTRATAMIENTO8#";
         |HAZ AsignaFrase;
     |FINSI;

                     || Responsable de Seguridad;

     aNif        = "";
     aDesResponS = "Responsable de Seguridad:";
     aDesResponP = "Responsables de Seguridad:";
     nPara       = 0;
     |BUCLE dslpw051_6;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         aAsigna1 = "#FRASERESSEGURIDAD1#";
         aAsigna2 = "#FRASERESSEGURIDAD2#";
         aAsigna3 = "#FRASERESSEGURIDAD3#";
         aAsigna4 = "#FRASERESSEGURIDAD4#";
         aAsigna5 = "#FRASERESSEGURIDAD5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASERESSEGURIDAD1#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESSEGURIDAD2#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESSEGURIDAD3#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESSEGURIDAD4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESSEGURIDAD5#";    |HAZ AsignaWord1;
     |FINSI;

                     || Encargado de Seguridad;

     aNif        = "";
     aDesResponS = "Encargado de Seguridad:";
     aDesResponP = "Encargados de Seguridad:";
     nPara       = 0;
     |BUCLE dslpw051_7;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCSEGURIDAD1#";                             |HAZ AsignaWord1;

         eaAlfa   = "Encargado/s de Seguridad";     |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCSEGURIDAD2#";         |HAZ AsignaWord1;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCSEGURIDAD3#";         |HAZ AsignaWord1;


         eaAlfa   = "";
         eaAsigna = "#FRASEENCSEGURIDAD4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD5#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD6#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD7#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD8#";    |HAZ AsignaWord1;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASEENCSEGURIDAD1#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD2#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD3#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD4#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD5#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD6#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD7#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCSEGURIDAD8#";   |HAZ AsignaWord1;
     |FINSI;

                     || Responsable de Copias;

     aNif        = "";
     aDesResponS = "Responsable de Copias de Respaldo y Recuperaci¢n:";
     aDesResponP = "Responsables de Copias de Respaldo y Recuperaci¢n:";
     nPara       = 0;
     |BUCLE dslpw051_8;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         aAsigna1 = "#FRASERESCOPIAS1#";
         aAsigna2 = "#FRASERESCOPIAS2#";
         aAsigna3 = "#FRASERESCOPIAS3#";
         aAsigna4 = "#FRASERESCOPIAS4#";
         aAsigna5 = "#FRASERESCOPIAS5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASERESCOPIAS1#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESCOPIAS2#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESCOPIAS3#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESCOPIAS4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESCOPIAS5#";    |HAZ AsignaWord1;
     |FINSI;

                     || Encargado de Copias;

     aNif        = "";
     aDesResponS = "Encargado de Copias de Respaldo y Recuperaci¢n:";
     aDesResponP = "Encargados de Copias de Respaldo y Recuperaci¢n:";
     nPara       = 0;
     |BUCLE dslpw051_9;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCCOPIA1#";                                 |HAZ AsignaWord1;

         eaAlfa   = "Encargado/s de Copias de Respaldo y Recuperaci¢n"; |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCCOPIA2#";          |HAZ AsignaWord1;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCCOPIA3#";         |HAZ AsignaWord1;

         eaAlfa   = "";
         eaAsigna = "#FRASEENCCOPIA4#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA5#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA6#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA7#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA8#";          |HAZ AsignaWord1;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASEENCCOPIA#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA1#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA2#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA3#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA4#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA5#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA6#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA7#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCCOPIA8#";   |HAZ AsignaWord1;
     |FINSI;
                     || Responsable de Incidencias;

     aNif        = "";
     aDesResponS = "Responsable del Registro de Incidencias:";
     aDesResponP = "Responsables del Registro de Incidencias:";
     nPara       = 0;
     |BUCLE dslpw051_10;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         aAsigna1 = "#FRASERESINCIDENCIAS1#";
         aAsigna2 = "#FRASERESINCIDENCIAS2#";
         aAsigna3 = "#FRASERESINCIDENCIAS3#";
         aAsigna4 = "#FRASERESINCIDENCIAS4#";
         aAsigna5 = "#FRASERESINCIDENCIAS5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASERESINCIDENCIAS1#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESINCIDENCIAS2#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESINCIDENCIAS3#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESINCIDENCIAS4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESINCIDENCIAS5#";    |HAZ AsignaWord1;
     |FINSI;

                     || Encargado de Incidencias;

     aNif        = "";
     aDesResponS = "Encargado del Registro de Incidencias:";
     aDesResponP = "Encargados del Registro de Incidencias:";
     nPara       = 0;
     |BUCLE dslpw051_11;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCINCIDENCIA1#";                                 |HAZ AsignaWord1;

         eaAlfa   = "Encargado/s del Registro de Incidencias"; |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCINCIDENCIA2#";          |HAZ AsignaWord1;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCINCIDENCIA3#";         |HAZ AsignaWord1;

         eaAlfa   = "";
         eaAsigna = "#FRASEENCINCIDENCIA4#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA5#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA6#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA7#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA8#";          |HAZ AsignaWord1;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASEENCINCIDENCIA#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA1#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA2#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA3#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA4#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA5#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA6#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA7#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCINCIDENCIA8#";   |HAZ AsignaWord1;
     |FINSI;

                     || Responsable de Atencion a los Afectados

     aNif        = "";
     aDesResponS = "Responsable de Atenci¢n a los Afectados:";
     aDesResponP = "Responsables de Atenci¢n a los Afectados:";
     nPara       = 0;
     |BUCLE dslpw051_12;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         aAsigna1 = "#FRASERESAFECTADOS1#";
         aAsigna2 = "#FRASERESAFECTADOS2#";
         aAsigna3 = "#FRASERESAFECTADOS3#";
         aAsigna4 = "#FRASERESAFECTADOS4#";
         aAsigna5 = "#FRASERESAFECTADOS5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASERESAFECTADOS1#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESAFECTADOS2#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESAFECTADOS3#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESAFECTADOS4#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASERESAFECTADOS5#";    |HAZ AsignaWord1;
     |FINSI;

                     || Encargado de Atencion a los Afectados

     aNif        = "";
     aDesResponS = "Encargado de Atenci¢n a los Afectados:";
     aDesResponP = "Encargados de Atenci¢n a los Afectados:";
     nPara       = 0;
     |BUCLE dslpw051_13;
     |SI aNif ! "";
         aAlfa1 = "}3}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}3}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         |HAZ QuitaRaros;
         aAlfa1 = "}3}" + nContador + "}1}";
         aAlfa2 = eaAlfa;
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, aAlfa2;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCAFECTADO1#";                                 |HAZ AsignaWord1;

         eaAlfa   = "Encargado/s de Atenci¢n a los Afectados"; |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCAFECTADO2#";          |HAZ AsignaWord1;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaAsigna = "#FRASEENCAFECTADO3#";         |HAZ AsignaWord1;

         eaAlfa   = "";
         eaAsigna = "#FRASEENCAFECTADO4#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO5#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO6#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO7#";          |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO8#";          |HAZ AsignaWord1;
     |SINO;
         eaAlfa   = "";
         eaAsigna = "#FRASEENCAFECTADO#";    |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO1#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO2#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO3#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO4#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO5#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO6#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO7#";   |HAZ AsignaWord1;
         eaAsigna = "#FRASEENCAFECTADO8#";   |HAZ AsignaWord1;
     |FINSI;

     |FINDIM nBuffer;
|FPRC;

|PROCESO dslpw052_1;
     #dslpw054#0 = #dslpw052#0;
     #dslpw054#2 = #dslpw052#1;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     |SI aNivel = "";
         nContador = 2;
         aAlfa1    = "}4}2}1}";
         aAlfa2    = "Se califican de nivel " + #952#2;  |QBF aAlfa2;
         aAlfa2    = aAlfa2 + " los siguientes ficheros:";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     |SI aNivel ! #952#2;  |Y aNivel ! "";
         aAlfa1 = "}4}1}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}4}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}4}2}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}4}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         nContador = nContador + 2;

         aAlfa1    = "}4}" + nContador + "}1}";
         aAlfa2    = "Se califican de nivel " + #952#2;  |QBF aAlfa2;
         aAlfa2    = aAlfa2 + " los siguientes ficheros:";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     |SI nContador ! 2;
         aAlfa1 = "}4}3}1}+G";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

         aAlfa1 = "}4}1}1}+P";
         aAlfa2 = "";
         |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;
     |FINSI;

     aNivel    = #952#2;
     nContador = nContador + 1;

     eaAlfa    = #952#3;  |QBF eaAlfa;           |HAZ QuitaRaros;
     aAlfa1    = "}4}" + nContador + "}1}";
     aAlfa2    = eaAlfa;
     |WORD_ASIGNA_TEXTO enWord1, aAlfa1, aAlfa2;

     nNumFich = nNumFich + 1;

     |SI #952#2 = "ALTO           ";
         |SI aAlfaAlto = "";
             aAlfaAlto = #952#3;  |QBF aAlfaAlto;
         |SINO;
             aAlfaAlto = aAlfaAlto + ", " + #952#3;  |QBF aAlfaAlto;
         |FINSI;
     |FINSI;

     |SI #952#2 = "MEDIO          ";
         |SI aAlfaMedio = "";
             aAlfaMedio = #952#3;  |QBF aAlfaMedio;
         |SINO;
             aAlfaMedio = aAlfaMedio + ", " + #952#3;  |QBF aAlfaMedio;
         |FINSI;
     |FINSI;

     |SI #952#2 = "BASICO         ";
         |SI aAlfaBasico = "";
             aAlfaBasico = #952#3;  |QBF aAlfaBasico;
         |SINO;
             aAlfaBasico = aAlfaBasico + ", " + #952#3;  |QBF aAlfaBasico;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dslpw052_1;
     #952#2;
     ;
     "               ", "                                   ";
     "zzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw052_1;
|FIN;

|PROCESO Niveles;
     nContador    = 0;
     nNumFich     = 0;
     aNivel       = "";
     aAlfaAlto    = "";
     aAlfaMedio   = "";
     aAlfaBasico  = "";

     |BUCLE dslpw052_1;

     eaAlfa   = nNumFich;
     eaAsigna = "#NUMFICH#";   |HAZ AsignaWord1;

     eaAlfa = "";
     |SI aAlfaBasico ! "";
         eaAlfa = aAlfaBasico + " de nivel BASICO";
     |FINSI;

     |SI aAlfaMedio ! "";
         |SI eaAlfa = "";
             eaAlfa = aAlfaMedio + " de nivel MEDIO";
         |SINO;
             eaAlfa = eaAlfa + ", " + aAlfaMedio + " de nivel MEDIO";
         |FINSI;
     |FINSI;

     |SI aAlfaAlto ! "";
         |SI eaAlfa = "";
             eaAlfa = aAlfaAlto + " de nivel ALTO";
         |SINO;
             eaAlfa = eaAlfa + ", " + aAlfaAlto + " de nivel ALTO";
         |FINSI;
     |FINSI;

     |HAZ QuitaRaros;
     eaAsigna = "#FRASESEGURIDAD#";   |HAZ AsignaWord1;
|FPRC;

|PROCESO PorEmpresa;
     aFichero = ("51" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #951 aFichero;
     |ABRE  #951;  |CIERRA #951;  |DELINDEX #951;

     aFichero = ("52" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #952 aFichero;
     |ABRE  #952;  |CIERRA #952;  |DELINDEX #952;

     |HORA eaHora;
     eaGuarda       = "S";
     enCargaPuntero = 1;
     enDocumento    = 0;

     |HAZ SacaDocumentos;
     |SI eaNomFichero = "";  |ACABA;  |FINSI;

     |HAZ EdicionWord;
     |SI enError = 1;  |ACABA;  |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = 1;
     |LEE 000#4];
     |SI FSalida ! 0;  |O  #4#0 ! #0#0;
         |DDEFECTO #4;
     |FINSI;
     |CIERRA #4;

     |ABRE #951;
     |ABRE #952;
     nContador = 0;
     |BUCLE dslpm005z1_1;
     |CIERRA #951;
     |CIERRA #952;

     eaAlfa   = #1#2;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#2#";   |HAZ AsignaWord1;

     |HAZ Ubicaciones;
     |HAZ Responsables;
     |HAZ Niveles;
     |HAZ Copias;
     |HAZ DescEstructura;
     |HAZ Mantenimiento;
     |HAZ OutSourcing;

     |ABRE #5;
     #5#0 = #4#0;
     #5#1 = #4#1;
     #5#2 = 0;
     |LEE 000#5];
     |SI FSalida ! 0;  |O #5#0 ! #4#0;  |O #5#1 ! #4#1;
         |DDEFECTO #5;
     |FINSI;
     |CIERRA #5;

     |HAZ PonDirigirseA;

     eaAlfa   = #4#8;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#8#";   |HAZ AsignaWord1;

     |SI #4#27 = "D";  eaAlfa = "DIARIA";     |FINSI;
     |SI #4#27 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#27 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#27 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#27 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#27#";  |HAZ AsignaWord1;

     eaAlfa   = #4#30;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#30#";  |HAZ AsignaWord1;

     eaAlfa   = #4#31;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#31#";  |HAZ AsignaWord1;

     eaAlfa   = #4#32;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#32#";  |HAZ AsignaWord1;

     eaAlfa   = #4#63;
     eaAsigna = "#dslpm004#63#";  |HAZ AsignaWord1;

     eaAlfa   = #4#64;
     eaAsigna = "#dslpm004#64#";  |HAZ AsignaWord1;

     eaAlfa   = #4#66;
     |SI #4#65 = "D";  eaAlfa = "DIARIO";     |FINSI;
     |SI #4#65 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#65 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#65 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#65 = "T";  eaAlfa = "TRIMESTRAL"; |FINSI;
     |SI #4#65 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |SI #4#65 = "B";  eaAlfa = "BIANUAL";    |FINSI;
     |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#65#";  |HAZ AsignaWord1;

     eaAlfa   = #4#67;
     eaAsigna = "#dslpm004#67#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#70 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#70#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#71 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#71#";  |HAZ AsignaWord1;

     eaAlfa   = #4#74;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#74#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#75 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#75#";  |HAZ AsignaWord1;

     eaAlfa   = #4#77;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#77#";  |HAZ AsignaWord1;

     eaAlfa   = #4#78;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#78#";  |HAZ AsignaWord1;

     eaAlfa   = #5#7;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#7#";   |HAZ AsignaWord1;

     |HAZ FinDocumentoWord;

     |DELINDEX #951;
     |DELINDEX #952;

     |PULSATECLA;
|FPRC;

|PROCESO Anexos;
     |HORA eaHora;
     eaGuarda       = "N";
     enCargaPuntero = 1;
     enDocumento    = 0;

     |HAZ SacaDocumentos;
     |SI eaNomFichero = "";  |ACABA;  |FINSI;

     |HAZ EdicionWord;
     |SI enError = 1;  |ACABA;  |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = enModelo;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = enModelo;
     #5#2 = enFichero;
     |LEE 000#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     eaAlfa   = #1#2;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#2#";   |HAZ AsignaWord1;

     |HAZ Mantenimiento;
     |HAZ OutSourcing;
     |HAZ PonDirigirseA;

     eaAlfa   = #4#8;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#8#";   |HAZ AsignaWord1;

     |SI #4#27 = "D";  eaAlfa = "DIARIA";     |FINSI;
     |SI #4#27 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#27 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#27 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#27 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#27#";  |HAZ AsignaWord1;

     eaAlfa   = #4#30;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#30#";  |HAZ AsignaWord1;

     eaAlfa   = #4#31;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#31#";  |HAZ AsignaWord1;

     eaAlfa   = #4#32;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#32#";  |HAZ AsignaWord1;

     eaAlfa   = #4#63;
     eaAsigna = "#dslpm004#63#";  |HAZ AsignaWord1;

     eaAlfa   = #4#64;
     eaAsigna = "#dslpm004#64#";  |HAZ AsignaWord1;

     eaAlfa   = #4#66;
     |SI #4#65 = "D";  eaAlfa = "DIARIO";     |FINSI;
     |SI #4#65 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#65 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#65 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#65 = "T";  eaAlfa = "TRIMESTRAL"; |FINSI;
     |SI #4#65 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |SI #4#65 = "B";  eaAlfa = "BIANUAL";    |FINSI;
     |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#65#";  |HAZ AsignaWord1;

     eaAlfa   = #4#67;
     eaAsigna = "#dslpm004#67#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#70 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#70#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#71 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#71#";  |HAZ AsignaWord1;

     eaAlfa   = #4#74;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#74#";  |HAZ AsignaWord1;

     eaAlfa   = "NO";
     |SI #4#75 = "S";  eaAlfa = "SI";     |FINSI;
     eaAsigna = "#dslpm004#75#";  |HAZ AsignaWord1;

     eaAlfa   = #4#77;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#77#";  |HAZ AsignaWord1;

     eaAlfa   = #4#78;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#78#";  |HAZ AsignaWord1;

     eaAlfa   = #5#7;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#7#";   |HAZ AsignaWord1;

     |HAZ FinDocumentoWord;

     |PULSATECLA;
|FPRC;

|PROCESO DSeguridad;
     |SI enTipoDoc = 90;  |HAZ PorFichero;  |FINSI;
     |SI enTipoDoc = 91;  |HAZ PorEmpresa;  |FINSI;
     |SI enTipoDoc = 92;  |HAZ Anexos;      |FINSI;
|FPRC;
