|| ---------------------------------------
|| Otros Documentos
|| ---------------------------------------

|FICHEROS;
     dslpz001 #0;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm007 #7;
     dslpm010 #10;
     dslpm100 #100;
|FIN;

|VARIABLES;
      aAlfa         = "";
      aDocRtf       = "";
      aNif          = "";

      nHandle       = 0;
      nSwHay        = 0;
      nPers         = 0;
      nCampo        = 0;
      nHastaCampo   = 0;

     &enCliente      = 0;
     &enModelo       = 0;
     &enFichero      = 0;
     &eaNomFichero   = "";
     &enError        = 0;
     &eaAlfa         = "";
     &eaAsigna       = "";
     &eaHora         = "";
     &enWord1        = 0;
     &enCamWord      = 0;
     &enCargaPuntero = 0;
     &eaGuarda       = "";
     &enTipoDoc      = 0;
     &enDocumento    = 0;
     &enTipoOtro     = 0;
     &enTipoTipo     = 0;
     &eaDni          = "";
     &eaFecha        = "";
     &efFecha        = @;
     &enImprime      = 0;
     &enDocu         = 0;

   {500} &eaCamWord  = "";
|FIN;

|PROCESO OtrosDocumentos;
     |SI enTipoTipo = 0;
         |SI enTipoOtro = 1;   enTipoDoc = 70;  |FINSI;
         |SI enTipoOtro = 2;   enTipoDoc = 71;  |FINSI;
         |SI enTipoOtro = 3;   enTipoDoc = 72;  |FINSI;
         |SI enTipoOtro = 4;   enTipoDoc = 73;  |FINSI;
         |SI enTipoOtro = 5;   enTipoDoc = 74;  |FINSI;
         |SI enTipoOtro = 6;   enTipoDoc = 75;  |FINSI;
         |SI enTipoOtro = 7;   enTipoDoc = 76;  |FINSI;
         |SI enTipoOtro = 8;   enTipoDoc = 77;  |FINSI;
         |SI enTipoOtro = 9;   enTipoDoc = 78;  |FINSI;
         |SI enTipoOtro = 10;  enTipoDoc = 79;  |FINSI;
         |SI enTipoOtro = 11;  enTipoDoc = 80;  |FINSI;
         |SI enTipoOtro = 12;  enTipoDoc = 81;  |FINSI;
         |SI enTipoOtro = 13;  enTipoDoc = 82;  |FINSI;
         |SI enTipoOtro = 14;  enTipoDoc = 83;  |FINSI;

         enImprime = 0;
     |SINO;
         enImprime = 1;
     |FINSI;

     |HORA eaHora;
     eaGuarda       = "S";
     enCargaPuntero = 1;
     enDocumento    = 0;

     |SI enTipoTipo = 0;
         |HAZ SacaDocumentos;
         |SI eaNomFichero = "";  |ACABA;  |FINSI;
     |FINSI;

     |HAZ EdicionWord;
     |SI enError = 1;  |ACABA;  |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = 1;
     |LEE 000#4];
     |SI FSalida ! 0;  |O #4#0 ! #0#0;
         |DDEFECTO #4;
     |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #4#0;
     #5#1 = #4#1;
     #5#2 = 1;
     |LEE 000#5];
     |SI FSalida ! 0;  |O #5#0 ! #4#0;  |O #5#1 ! #4#1;
         |DDEFECTO #5;
     |FINSI;
     |CIERRA #5;

     eaAlfa   = #1#2;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#2#";   |HAZ AsignaWord1;

     eaAlfa   = #1#3;                   |QBF eaAlfa;
     eaAsigna = "#dslpm001#3#";   |HAZ AsignaWord1;

     eaAlfa   = #1#4;                   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #1#5;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + #1#6;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #1#7;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #1#8;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #1#9;   |QBF eaAlfa;  |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#4#";   |HAZ AsignaWord1;

     eaAlfa   = " (" + (("00" + #1#10) % -102) + (("000" + #1#11) % -103) + ") " + #1#12;
                                        |QBF eaAlfa;
                                        |HAZ QuitaRaros;
     eaAsigna = "#dslpm001#12#";        |HAZ AsignaWord1;

     eaAlfa   = #1#12;                  |QBF eaAlfa;
                                        |HAZ QuitaRaros;
     eaAsigna = "#1#12#SINCP#";         |HAZ AsignaWord1;

     eaAlfa   = #1#13;                  |QBF eaAlfa;
     eaAsigna = "#dslpm001#13#";        |HAZ AsignaWord1;

     eaAlfa   = #4#4;                   |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#4#";         |HAZ AsignaWord1;

     eaAlfa   = #4#6;                   |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#6#";         |HAZ AsignaWord1;

     eaAlfa   = #4#14;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#14#";  |HAZ AsignaWord1;

     eaAlfa   = #10#4;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm010#4#";    |HAZ AsignaWord1;

     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #0#0;
     #2#1 = #10#1;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;


     eaAlfa   = #2#1;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm002#1#";   |HAZ AsignaWord1;

     eaAlfa   = #2#2;             |HAZ QuitaRaros;
     eaAsigna = "#dslpm002#2#";   |HAZ AsignaWord1;

     eaAlfa   = #2#3;                   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #2#4;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + #2#5;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #2#6;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #2#7;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #2#8;   |QBF eaAlfa;  |HAZ QuitaRaros;
     eaAsigna = "#dslpm002#4#";   |HAZ AsignaWord1;

     eaAlfa   = " (" + (("00" + #2#9) % -102) + (("000" + #2#10) % -103) + ") " + #2#11;
                                       |QBF eaAlfa;
                                        |HAZ QuitaRaros;
     eaAsigna = "#dslpm002#11#";        |HAZ AsignaWord1;

     eaAlfa   = #2#12;                  |QBF eaAlfa;
     eaAsigna = "#dslpm002#12#";        |HAZ AsignaWord1;

     eaAlfa   = #2#41;            |HAZ QuitaRaros;
     eaAsigna = "#dslpm002#41#";   |HAZ AsignaWord1;

     |SI #5#243 ! "            ";
         |ABRE #2;
         |SELECT #1#2;
         #2#0 = #0#0;
         #2#1 = #5#243;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
         |CIERRA #2;
     |SINO;
         |ABRE #2;
         |SELECT #1#2;
         #2#0 = #0#0;
         #2#1 = #4#3;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
         |CIERRA #2;
     |FINSI;

     eaAlfa   = #2#11;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + #2#3;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #2#4;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #2#5;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #2#6;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #2#7;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #2#8;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " (" + (("00" + #2#9) % -102) + (("000" + #2#10) % -103) + ")";
                                   |HAZ QuitaRaros;
     eaAsigna = "#dslpm002#3#";    |HAZ AsignaWord1;

     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #0#0;
     #2#1 = #4#15;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     eaAlfa   = #2#2;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + #2#11;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + #2#3;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #2#4;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #2#5;   |QBF eaAlfa;
     eaAlfa   = eaAlfa + " (" + (("00" + #2#9) % -102) + (("000" + #2#10) % -103) + ")";
                                    |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#16#";    |HAZ AsignaWord1;

     eaAlfa   = eaAlfa + ", "  + #2#13;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "   + #2#14;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", "  + #2#15;  |QBF eaAlfa;
                                             |HAZ QuitaRaros;
     eaAsigna = "#dslpm004#5#";    |HAZ AsignaWord1;

     efFecha  = ~;
     |HAZ SacaFecha;
     eaAlfa   = #1#12;            |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + eaFecha;
     eaAsigna = "#FECHAENTERA#";  |HAZ AsignaWord1;

     |ABRE #2;
     |SELECT #2#2;
     #2#33 = "S";
     #2#0  = #0#0;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;


     eaAlfa = #2#2;               |QBF eaAlfa;
     eaAlfa = eaAlfa + ", titular del documento nacional de identidad n£mero " +  #2#1;  |QBF eaAlfa;
                                  |HAZ QuitaRaros;
     eaAsigna = "#GERENTE#";  |HAZ AsignaWord1;

     eaAlfa   = #5#3;              |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#3#";    |HAZ AsignaWord1;

     aAlfa    = #5#128;  |QBF aAlfa;
     aAlfa    = aAlfa + " " + #5#129;
     aAlfa    = aAlfa + " " + #5#130;
     aAlfa    = aAlfa + " " + #5#131;
     aAlfa    = aAlfa + " " + #5#132;
     eaAlfa   = aAlfa;   |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#128#";    |HAZ AsignaWord1;

     aAlfa    = #5#133;  |QBF aAlfa;
     aAlfa    = aAlfa + " " + #5#134;
     aAlfa    = aAlfa + " " + #5#135;
     aAlfa    = aAlfa + " " + #5#136;
     aAlfa    = aAlfa + " " + #5#137;
     eaAlfa   = aAlfa;   |HAZ QuitaRaros;
     eaAsigna = "#dslpm005#133#";    |HAZ AsignaWord1;

     |SI #5#243 ! "            ";
         eaAlfa   = #5#244;              |HAZ QuitaRaros;
     |SINO;
         eaAlfa   = #5#15;               |HAZ QuitaRaros;
     |FINSI;
     eaAsigna = "#dslpm005#244#";    |HAZ AsignaWord1;

     |ABRE #100;
     |SI #5#243 ! "            ";
         #100#0 = #5#243;
     |SINO;
         #100#0 = #5#6;
     |FINSI;

     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     eaAlfa   = #100#2;                 |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #100#3; |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", " + #100#4; |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #100#5; |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #100#6; |QBF eaAlfa;
     eaAlfa   = eaAlfa + " "  + #100#7; |QBF eaAlfa;  |HAZ QuitaRaros;
     eaAsigna = "#dslpm100#3#";   |HAZ AsignaWord1;

     |HAZ FinDocumentoWord;

     #10#0 = #0#0;
     #10#1 = eaDni;
     #10#2 = enTipoOtro;
     |LEE 101#10=;
     |SI FSalida = 0;
         #10#5 = ~;
         #10#6 = eaHora;
         #10#7 = enDocu;
         |GRABA 020#10a;
         |LIBERA #10;
     |FINSI;

     |PULSATECLA;
|FPRC;
