|FICHEROS;
     dslpz001 #0;
     dslpm001 #1;
     dslpm004 #4;
     dslpm005 #5;
     dslpm008 #8;
     dslpm513 #513;
|FIN;

|VARIABLES;
     aCadena         = "";
     aLen            = "";
     aCaracter       = "";
     aBase           = "";
     aOrigen         = "";
     aDestino        = "";
     aDestinoPlan    = "";
     aDestino2       = "";
     aIPRemoto       = "";
     aHora           = "";
     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aAcceso         = "";
     aTipo           = "";
     aWaitD          = "";
     aWaitO          = "";
     aPath           = "";
     aLongitud       = "";
     aDocRemoto      = "";
     aDocServidor    = "";
     aDir            = "";
     aFichero        = "";
     aCliente        = "";
     aDirec          = "";
     aNomLogo        = "";
     aLogo           = "";
     aLong           = "";
     aParaQuitar     = "";
     aLongAlfa       = "";
     aDecima         = "";
     aEntero         = "";
     aImpor1         = "";
     aImpor2         = "";

     {1}aContiene    = "";
     {1}aVersion     = "";

     fFecha          = @;

     nLen            = 0;
     nCampo          = 0;
     nCampoPara      = 0;
     nPos            = 0;
     nWord           = 0;
     nHandle         = 0;
     nHandleError    = 0;
     nLongitud       = 0;
     nCaracter       = 0;
     nPuntero        = 0;
     nTope           = 0;
     nRango          = 0;
     nPos1           = 0;
     nPos2           = 0;
     nVentana        = 0;
     nLong           = 0;
     nBlanco1        = 0;
     nBlanco2        = 0;
     nComa           = 0;
     nPara           = 0;
     nPosi           = 0;
     nLongNume       = 0;
     nDecimal        = 0;

     &enWord1        = 0;
     &enWord2        = 0;
     &enSwChequeo    = 0;

     &eaGuarda       = "";
     &eaEmpresa      = "";
     &eaCentro       = "";
     &eaAnexo        = "";
     &eaAsigna       = "";
     &eaAlfa         = "";
     &efFecha        = @;
     &eaHora         = "";
     &eaNomFichero   = "";
     &eaDocumento1   = "";
     &eaDocumento2   = "";
     &eaFecha        = "";
     &eaEtiqueta     = "Hoja1";
     &enCamWord      = 0;
     &eaMes          = "";
     &enError        = 0;
     &enPanta        = 0;
     &enPanta0       = 0;
     &enPanta1       = 0;
     &enPanta2       = 0;
     &enPanta3       = 0;
     &enCargaPuntero = 0;
     &enEstado       = 0;
     &enTipoDoc      = 0;
     &enDocumento    = 0;
     &eaCadena       = "";
     &eaCadena1      = "";
     &eaCadena2      = "";
     &eaCadena3      = "";
     &eaImporte      = "";
     &enPresenta     = 0;
     &enImprime      = 0;
     &enDocu         = 0;
     &enMasivo       = 0;
|FIN;

|PROCESO ActualizaRegistro;
     |ABRE #8;
     #8#0 = #1#1;
     #8#1 = 99999;
     |LEE 040#8];
     |SI FSalida = 0;
         |LEE 040#8a;
     |SINO;
         |LEE 040#8u;
     |FINSI;

     enDocu = 1;
     |SI FSalida = 0;  |Y  #8#0 = #1#1;
         enDocu = #8#1 + 1;
     |FINSI;

     |DDEFECTO #8;
     #8#0  = #1#1;
     #8#1  = enDocu;
     #8#2  = #513#2;

     |SI enEstado = 0;
         #8#3  = #4#1;
         #8#4  = #4#2;
         #8#5  = #5#2;
         #8#6  = #5#3;
         #8#7  = #5#4;
     |SINO;
         #8#3  = 0;
         #8#4  = "";
         #8#5  = 0;
         #8#6  = "";
         #8#7  = "";
     |FINSI;
     #8#8  = ~;
     #8#9  = eaHora;
     #8#10 = Usuario % 810;
     #8#11 = #8#8;
     #8#12 = #8#9;
     #8#13 = #8#10;
     #8#14 = #513#0;
     #8#15 = #513#1;
     #8#16 = "XGZ";

     |GRABA 020#8n;
     |LIBERA #8;
|FPRC;

|PROCESO Baja513;
     #513#0 = enTipoDoc;
     #513#1 = 1;
|FPRC;

|PROCESO Alta513;
     #513#0 = enTipoDoc;
     #513#1 = 999;
|FPRC;

|PROCESO Evento513;
     |SI FSalida = 1;
         |LEE 000#513=;
     |FINSI;

     |SI FSalida = 4;
         eaNomFichero = "doc" + (("00" + #513#0) % -102) + (("000" + #513#1) % -103) + ".xgz";
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO SacaDocumentos;
     eaNomFichero = "";
     |SI enDocumento = 0;  enDocumento = 1;  |FINSI;

     |ABRE #513;
     #513#0 = enTipoDoc;
     #513#1 = 2;
     |LEE 000#513=;
     |SI FSalida = 0;
         #513#0 = enTipoDoc;
         #513#1 = enDocumento;
         |LEE 000#513=;

         |SI enMasivo = 0;
             |VENTANA 1101, 2899, -1, 1, "";
             nVentana = FSalida;

             nRango       = 4 + 8 + 16;
             nPos1        = 1102;
             nPos2        = 2698;
             eaNomFichero = "";
             |LINEAL_SIMPLE #1#513, nRango, nPos1, nPos2, Baja513, Alta513, Evento513;

             |FINVENTANA nVentana;
         |SINO;
             eaNomFichero = "doc" + (("00" + #513#0) % -102) + (("000" + #513#1) % -103) + ".xgz";
         |FINSI;

         |SI eaNomFichero = "";
             |MENAV "0000 Proceso interrumpido.";
             |CIERRA #513;
             |ACABA;
         |FINSI;
     |SINO;
         #513#0 = enTipoDoc;
         #513#1 = 1;
         |LEE 000#513=;
         |SI FSalida = 0;
             eaNomFichero = "doc" + (("00" + #513#0) % -102) + (("000" + #513#1) % -103) + ".xgz";
         |FINSI;
     |FINSI;
     |CIERRA #513;
|FPRC;
