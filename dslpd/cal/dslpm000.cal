|FICHEROS;
     dslpm000 #0;
|FIN;

|VARIABLES;
     aDirec       = "";
     aAlfa        = "";
     aOrigen      = "";
     aDestino     = "";
     aCaracter    = "";
     aLong        = "";
     aLogo        = "";
     aPathLogo    = "";
     aBase        = "";
     aIPRemoto    = "";

     nCampoD      = 0;
     nCampoH      = 0;
     nPanta1      = 0;
     nCaracter    = 0;
     nLong        = 0;
     nPos         = 0;
     nBoton1_1    = 0;
     nBoton2_1    = 0;
     nBoton3_1    = 0;
     nBoton4_1    = 0;
     nBoton5_1    = 0;

     &eaVarDni    = "";
     &enCalcCif   = 0;
|FIN;

|| ------------------------------------------------------
|| Procesos del Boton 1_1
|| ------------------------------------------------------

|PROCESO Boton1_1;
     #0#16 = "";  |PINTA #0#16;

     aDirec = "F";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aLogo = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aPathLogo = aBase + "documentos/logos";  |MKDIR aPathLogo;
     aPathLogo = aBase + "documentos/logos/";

     aOrigen  = aDirec;
     aDestino = aPathLogo + aLogo;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #0#16 = aDestino;  |PINTA #0#16;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_1
|| ------------------------------------------------------

|PROCESO Boton2_1;
     #0#18 = "";  |PINTA #0#18;

     aDirec = "F";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aLogo = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aPathLogo = aBase + "documentos/logos";  |MKDIR aPathLogo;
     aPathLogo = aBase + "documentos/logos/";

     aOrigen  = aDirec;
     aDestino = aPathLogo + aLogo;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #0#18 = aDestino;  |PINTA #0#18;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 3_1
|| ------------------------------------------------------

|PROCESO Boton3_1;
     #0#21 = "";  |PINTA #0#21;

     aDirec = "F*.bmp";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aAlfa = (aDirec % -103) < "";
     |SI aAlfa ! "bmp";
         |MENAV "0000 Debe ser extension BMP";
         |ACABA;
     |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aLogo = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aPathLogo = aBase + "documentos/logos";  |MKDIR aPathLogo;
     aPathLogo = aBase + "documentos/logos/";

     aOrigen  = aDirec;
     aDestino = aPathLogo + aLogo;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #0#21 = aDestino;  |PINTA #0#21;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 4_1
|| ------------------------------------------------------

|PROCESO Boton4_1;
     #0#22 = "";  |PINTA #0#22;

     aDirec = "F";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aLogo = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aPathLogo = aBase + "documentos/logos";  |MKDIR aPathLogo;
     aPathLogo = aBase + "documentos/logos/";

     aOrigen  = aDirec;
     aDestino = aPathLogo + aLogo;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #0#22 = aDestino;  |PINTA #0#22;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 5_1
|| ------------------------------------------------------

|PROCESO Boton5_1;
     #0#23 = "";  |PINTA #0#23;

     aDirec = "F";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aLong = aDirec % 0;
     nLong = aLong;
     aLogo = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aDirec % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     |DBASE aBase;  |QBF aBase;
     aPathLogo = aBase + "documentos/logos";  |MKDIR aPathLogo;
     aPathLogo = aBase + "documentos/logos/";

     aOrigen  = aDirec;
     aDestino = aPathLogo + aLogo;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     #0#23 = aDestino;  |PINTA #0#23;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Incio del Programa
|| ------------------------------------------------------

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE nPanta1, "BOTON,{{136}}", 2447, 2449, Boton1_1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{136}}", 2647, 2649, Boton2_1;
     nBoton2_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{136}}", 2847, 2849, Boton3_1;
     nBoton3_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{136}}", 2495, 2497, Boton4_1;
     nBoton4_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{136}}", 2695, 2697, Boton5_1;
     nBoton5_1 = FSalida;
|FPRC;

|PROCESO LetraDni;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni   = #0Campo;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 3099;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         |GRABA 020#0b;
     |FINSI;

     |CABEZA "Datos del Despacho";

     |PINPA #0#0;  nPanta1 = FSalida;
     |PINDA #0#0;

     |HAZ BotonesPanta1;

     |ENDATOS #1#0;
     |SI FSalida = 0;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
     |CIERRA #0;

     |FIN_CONTROL_WINDOWS nBoton1_1;
     |FIN_CONTROL_WINDOWS nBoton2_1;
     |FIN_CONTROL_WINDOWS nBoton3_1;

     |PULSATECLA;
|FPRO;
