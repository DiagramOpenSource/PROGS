|| ------------------------------------------------------
|| Encuesta 61
|| ------------------------------------------------------

|FICHEROS;
     dslpz001 #0;
     dslpm000 #100;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm008 #8;
     dslpm011 #11;
     dslpm100 #1000;
     dslpm012 #12;
     dslpw042 #942;
     dslpw053 #953;

     dslpm510 #510;
     dslpm521 #521;
     dslpm522 #522;
|FIN;

|VARIABLES;
     nContador = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     aAlfa5 = "";
     aAlfa6 = "";
     aAlfa7 = "";
     aAlfa8 = "";

     aAlfa9    = "";
     aFichero  = "";
     aEtiqueta = "";
     aAbre     = "";
     aBase     = "";
     aIPRemoto = "";

     nCalc    = 0;
     nContLin = 0;
     nContTabla = 0;
     nContFichs = 0;
     nCont      = 0;
     nLinCont   = 0;

     aIDNombre      = "";
     aIDNif         = "";
     nIDCampo       = 0;
     nDatosId       = 0;
     nLinea         = 0;
     nLineaTabla    = 0;
     nPara          = 0;

      aAlfa         = "";
      aDocRtf       = "";
      aNif          = "";

      nHandle       = 0;
      nSwHay        = 0;
      nPers         = 0;
      nCampo        = 0;
      nHastaCampo   = 0;
      nPos          = 0;
      nPosi         = 0;
      nColumna      = 0;
      nNume         = 0;

      nLetra = 0;
      aChar  = "";

     aDescotros1  = "";
     aDescotros2  = "";
     aDescotros3  = "";
     aDescotros4  = "";
     aDescotros5  = "";
     aDescotros6  = "";
     aDescotros7  = "";
     aDescotros8  = "";
     aDescotros9  = "";
     aDescotros10 = "";
     aDescotros11 = "";

     &enCliente      = 0;
     &enModelo       = 0;
     &enFichero      = 0;
     &eaNomFichero   = "";
     &enError        = 0;
     &eaAlfa         = "";
     &eaAsigna       = "";
     &eaConten       = "";
     &eaHora         = "";
     &eaImporte      = "";
     &enWord1        = 0;
     &enCamWord      = 0;
     &enCargaPuntero = 0;
     &eaGuarda       = "";
     &enTipoDoc      = 0;
     &enDocumento    = 0;
     &eaFecha        = "";
     &efFecha        = @;
     &enPresenta     = 0;
     &enImprime      = 0;
     &enMasivo       = 0;

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerGuarda  = "";
     &eaDirSerPlan    = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaDestinoTra    = "";
     &eaFicheroTra    = "";
     &eaFicheroDef    = "";
     &eaFicheroXgz    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &eaFicheroTxt    = "";
     &enHandleTxt     = 0;
     &eaFicheroPlaGz  = "";
     &eaFicheroPlaMl  = "";
     &eaPathLogo      = "";
     &eaRaiz          = "";
     &eaModoPresenta  = "";
|FIN;

|PROCESO AbreDocuAF;
     |DBASE aBase;  |QBF aBase;
     |HORA eaHora;
     enDocumento    = 0;

     |HAZ SacaDocumentos;
     |SI eaNomFichero = "";  |ACABA;  |FINSI;

     eaDirPlantilla = "C:\DOCUMENTOS\DSLPD\PLANTILLAS\";
     eaDirTrabajo   = "C:\DOCUMENTOS\DSLPD\DOCDSLPD\";
     eaDirSerPlan   = aBase  + "documentos/plantillas/";
     eaDirSerGuarda = aBase  + "documentos/clientes/" + (("00000" + #1#1) % -105) + "/";
     eaDirTrabServi = aBase  + "documentos/tmp/";
     eaRaiz         = eaNomFichero - ".xgz";
     eaFicheroTra   = eaRaiz + "." + "doc";
     eaFicheroXgz   = eaRaiz + ".xgz";
     eaFicheroTar   = eaRaiz + ".tar";
     eaFicheroTgz   = eaRaiz + ".tgz";
     eaFicheroTxt   = eaRaiz + ".txt";
     eaFicheroPlaGz = (eaRaiz + ".xgz") < "";
     eaFicheroPlaMl = (eaRaiz + ".doc") < "";

     |MKDIR eaDirTrabServi;

     eaOrigen       = eaDirSerPlan   + eaFicheroPlaGz;
     eaDestino      = eaDirPlantilla + eaFicheroPlaGz;
     eaDestinoTra   = eaDirTrabajo   + eaFicheroPlaGz;

     |HAZ MiraDirectorios;
     |HAZ EnviaFicheroConMD5;
     |HAZ DescomprimeFichero;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Instalelo.";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;
|FPRC;

|PROCESO CierraDocuAF;
     |HAZ MiraLogos;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |SI eaModoPresenta ! "N";
         aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     |SI eaGuarda = "S";
         |HAZ ActualizaRegistro;

         eaRaiz        = "doc" + (("00000" + #8#1) % -105);
         eaFicheroDef  = eaRaiz + ".doc";
         eaFicheroXgz  = eaRaiz + ".xgz";
         eaFicheroTar  = eaRaiz + ".tar";
         eaFicheroTgz  = eaRaiz + ".tgz";
         eaFicheroTxt  = eaRaiz + ".txt";

         |HAZ ComprimeFichero;

         eaOrigen  = eaDirSerGuarda + eaFicheroXgz;
         eaDestino = eaDirTrabajo   + eaFicheroTgz;

         |HAZ RecibeFichero;

         |RFBORRA eaDestino;
     |SINO;
         eaDestino = eaDirTrabajo + eaFicheroTxt;  |RFBORRA eaDestino;
         eaDestino = eaDirTrabajo + eaFicheroTra;  |RFBORRA eaDestino;
     |FINSI;
|FPRC;

|PROCESO BuscaDatId;
     aIDNombre = ""; aIDNif = "";
     |ABRE #dslpm002;
     #dslpm002#0 = #dslpz001#0;
     #dslpm002#1 = "";
     |LEE 000#dslpm002.];
     |PARA; |SI FSalida = 0; |Y #dslpm002#0 = #dslpz001#0; |HACIENDO;
        |SI #dslpm002#nIDCampo# ! "N";
           aIDNombre = #dslpm002#2; aIDNif = #dslpm002#1;
           |SAL;
        |FINSI;
        |LEE 000#dslpm002.s;
     |SIGUE;
|FPRC;

|PROCESO ParteAFTablas;

     eaAlfa   = #dslpm001#2;                 |HAZ QuitaRaros;
     eaAlfa   = "Razón Social: " + eaAlfa;
     eaAsigna = "T}1}2}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#3;      |HAZ QuitaRaros;
     eaAlfa   = "NIF. / CIF.:" + eaAlfa;
     eaAsigna = "T}1}3}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#14;     |HAZ QuitaRaros;
     eaAlfa   = "Persona de contacto: " + eaAlfa;
     eaAsigna = "T}1}4}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     aAlfa    = #dslpm001#4; |QBF aAlfa;
     aAlfa    = aAlfa + " " + #dslpm001#5; |QBF aAlfa;
     eaAlfa   = aAlfa;            |HAZ QuitaRaros;
     eaAlfa   = "Domicilio: " + eaAlfa;
     eaAsigna = "T}1}5}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#6;      |HAZ QuitaRaros;
     eaAlfa   = "Num.: " + eaAlfa;
     eaAsigna = "T}1}5}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#7;      |HAZ QuitaRaros;
     eaAlfa   = "Esc.: " + eaAlfa;
     eaAsigna = "T}1}5}3}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#8;      |HAZ QuitaRaros;
     eaAlfa   = "Piso: " + eaAlfa;
     eaAsigna = "T}1}5}4}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#9;      |HAZ QuitaRaros;
     eaAlfa   = "Pta.: " + eaAlfa;
     eaAsigna = "T}1}5}5}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = (("00" + #dslpm001#10) % -102) + (("000" + #dslpm001#11) % -103);
     |HAZ QuitaRaros;
     eaAlfa   = "Cod.Postal: " + eaAlfa;
     eaAsigna = "T}1}6}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#12; |HAZ QuitaRaros;
     eaAlfa   = "Población: " + eaAlfa;
     eaAsigna = "T}1}6}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#13; |HAZ QuitaRaros;
     eaAlfa   = "Provincia: " + eaAlfa;
     eaAsigna = "T}1}6}3}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#15; |HAZ QuitaRaros;
     eaAlfa   = "Teléfono: " + eaAlfa;
     eaAsigna = "T}1}7}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#16; |HAZ QuitaRaros;
     eaAlfa   = "Fax: " + eaAlfa;
     eaAsigna = "T}1}7}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#17; |HAZ QuitaRaros;
     eaAlfa   = "E-mail: " + eaAlfa;
     eaAsigna = "T}1}7}3}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm001#18; |HAZ QuitaRaros;
     eaAlfa   = "Actividad Principal: " + eaAlfa;
     eaAsigna = "T}1}8}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     nContLin = 1;
     |ABRE #dslpm005; |ABRE #dslpm012;
     |DDEFECTO #dslpm005;
     #dslpm005#0 = enCliente;
     |LEE 000#dslpm005.=;
     |PARA; |SI FSalida = 0; |Y #dslpm005#0 = enCliente; |HACIENDO;
        |SI #dslpm005#247 = "S";
           #dslpm012#0 = #dslpm005#0;
           #dslpm012#1 = #dslpm005#1;
           #dslpm012#2 = #dslpm005#2;
           |LEE 000#dslpm012.=;
           |SI FSalida ! 0; |DDEFECTO #dslpm012; |FINSI;

           eaAlfa   = #dslpm005#3; |HAZ QuitaRaros;
           eaAsigna = "T}5}" + nContLin + "}1}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa   = #dslpm005#4; |HAZ QuitaRaros;
           eaAsigna = "T}5}" + nContLin + "}2}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa   = #dslpm012#83; |HAZ QuitaRaros;
           eaAsigna = "T}5}" + nContLin + "}3}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           nContLin = nContLin + 1;
        |FINSI;
        |LEE 000#dslpm005.s;
     |SIGUE;
     |CIERRA #dslpm005;

     || Sobre Gerencia

     |ABRE #dslpm002;
     #dslpm002#0 = #dslpz001#0;
     #dslpm002#1 = "";
     |LEE 000#dslpm002.];
     |PARA; |SI FSalida = 0; |Y #dslpm002#0 = #dslpz001#0; |HACIENDO;
        |SI #dslpm002#33 ! "N";
           eaAlfa   = #dslpm002#2; |HAZ QuitaRaros;
           eaAsigna = "T}9}1}2}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa   = #dslpm002#1; |HAZ QuitaRaros;
           eaAsigna = "T}9}2}2}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           |SAL;
        |FINSI;
        |LEE 000#dslpm002.s;
     |SIGUE;
     |CIERRA #dslpm002;

     || Tratamiento

     nContFichs = 0;
     |ABRE #dslpm006;
     #dslpm006#0 = enCliente;
     #dslpm006#1 = 1;
     #dslpm006#2 = 1;
     |LEE 000#dslpm006.];
     |SI FSalida = 0; |Y #dslpm006#0 = enCliente;
        |PARA; |SI FSalida = 0; |Y #dslpm006#0 = enCliente; |HACIENDO;
           |SI nContFichs = 0;
              eaAlfa   = "";
              eaAsigna = "T}10}1}1}+G";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              eaAsigna = "T}11}1}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              eaAsigna = "T}10}2}1}+G";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              eaAsigna = "T}11}2}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              eaAsigna = "T}10}3}1}+G";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}11}3}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#4; |HAZ QuitaRaros;
              eaAsigna = "T}10}1}2}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#6; |HAZ QuitaRaros;
              eaAsigna = "T}10}2}2}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#5; |HAZ QuitaRaros;
              eaAsigna = "T}10}2}4}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#8; |HAZ QuitaRaros;
              eaAsigna = "T}10}3}2}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#7; |HAZ QuitaRaros;
              eaAsigna = "T}10}3}4}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
           |SINO;
              eaAlfa   = "";
              nCalc = (((nContFichs - 1) * 4) + 1);
              eaAsigna = "T}11}" + nCalc + "}1}+G";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = ((nContFichs * 4) + 1);
              eaAsigna = "T}11}" + nCalc + "}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = (((nContFichs - 1) * 4) + 2);
              eaAsigna = "T}11}" + nCalc + "}1}+G";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = ((nContFichs * 4) + 2);
              eaAsigna = "T}11}" + nCalc + "}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = (((nContFichs - 1) * 4) + 3);
              eaAsigna = "T}11}" + nCalc + "}1}+G";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = ((nContFichs * 4) + 3);
              eaAsigna = "T}11}" + nCalc + "}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = (((nContFichs - 1) * 4) + 4);
              eaAsigna = "T}11}" + nCalc + "}1}+G";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              nCalc = ((nContFichs * 4) + 4);
              eaAsigna = "T}11}" + nCalc + "}1}+P";
              eaConten = "";     |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#4; |HAZ QuitaRaros;
              nCalc = (((nContFichs - 1) * 4) + 2);
              eaAsigna = "T}11}" + nCalc + "}2}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#6; |HAZ QuitaRaros;
              nCalc = (((nContFichs - 1) * 4) + 3);
              eaAsigna = "T}11}" + nCalc + "}2}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#5; |HAZ QuitaRaros;
              nCalc = (((nContFichs - 1) * 4) + 3);
              eaAsigna = "T}11}" + nCalc + "}4}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa   = #dslpm006#8; |HAZ QuitaRaros;
              nCalc = (((nContFichs - 1) * 4) + 4);
              eaAsigna = "T}11}" + nCalc + "}2}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

              nCalc = (((nContFichs - 1) * 4) + 4);
              eaAlfa   = #dslpm006#7; |HAZ QuitaRaros;
              eaAsigna = "T}11}" + nCalc + "}4}";
              eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
           |FINSI;

           nContTabla = nContTabla + 1;
           nContFichs = nContFichs + 1;
           |LEE 000#dslpm006.s;
        |SIGUE;
     |SINO;
        |ABRE #dslpm004;
        #dslpm004#0 = enCliente;
        #dslpm004#1 = 1;
        |LEE 000#dslpm004.];
        |SI FSalida = 0; |Y #dslpm004#0 = enCliente;
           |PARA; |SI FSalida = 0; |Y #dslpm004#0 = enCliente; |HACIENDO;
              |SI nContFichs = 0;
                 eaAlfa   = "";
                 eaAsigna = "T}10}1}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAsigna = "T}11}1}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAsigna = "T}10}2}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAsigna = "T}11}2}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAsigna = "T}10}3}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAsigna = "T}11}3}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#6; |HAZ QuitaRaros;
                 eaAsigna = "T}10}2}2}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#5; |HAZ QuitaRaros;
                 eaAsigna = "T}10}2}4}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#18; |HAZ QuitaRaros;
                 eaAsigna = "T}10}3}2}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#17; |HAZ QuitaRaros;
                 eaAsigna = "T}10}3}4}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
              |SINO;
                 eaAlfa   = "";
                 nCalc = (((nContFichs - 1) * 4) + 1);
                 eaAsigna = "T}10}" + nCalc + "}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = ((nContFichs * 4) + 1);
                 eaAsigna = "T}10}" + nCalc + "}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = (((nContFichs - 1) * 4) + 2);
                 eaAsigna = "T}10}" + nCalc + "}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = ((nContFichs * 4) + 2);
                 eaAsigna = "T}10}" + nCalc + "}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = (((nContFichs - 1) * 4) + 3);
                 eaAsigna = "T}10}" + nCalc + "}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = ((nContFichs * 4) + 3);
                 eaAsigna = "T}10}" + nCalc + "}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = (((nContFichs - 1) * 4) + 4);
                 eaAsigna = "T}10}" + nCalc + "}1}+G";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 nCalc = ((nContFichs * 4) + 4);
                 eaAsigna = "T}10}" + nCalc + "}1}+P";
                 eaConten = "";     |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#6; |HAZ QuitaRaros;
                 nCalc = (((nContFichs - 1) * 4) + 3);
                 eaAsigna = "T}10}" + nCalc + "}2}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#5; |HAZ QuitaRaros;
                 nCalc = (((nContFichs - 1) * 4) + 3);
                 eaAsigna = "T}10}" + nCalc + "}4}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

                 eaAlfa   = #dslpm004#18; |HAZ QuitaRaros;
                 nCalc = (((nContFichs - 1) * 4) + 4);
                 eaAsigna = "T}10}" + nCalc + "}2}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

                 nCalc = (((nContFichs - 1) * 4) + 4);
                 eaAlfa   = #dslpm004#17; |HAZ QuitaRaros;
                 eaAsigna = "T}10}" + nCalc + "}4}";
                 eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
              |FINSI;

              nContTabla = nContTabla + 1;
              nContFichs = nContFichs + 1;
              |LEE 000#dslpm006.s;
           |SIGUE;
        |FINSI;
        |CIERRA #dslpm004;
     |FINSI;

     #dslpm006#0 = enCliente;
     #dslpm006#1 = 1;
     #dslpm006#2 = 1;
     |LEE 000#dslpm006.];
     |SI FSalida = 0; |Y #dslpm006#0 = enCliente;
         |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
            |SI nContFichs = 0;
               eaAlfa   = "";
               eaAsigna = "T}11}1}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAsigna = "T}12}1}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAsigna = "T}11}2}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAsigna = "T}12}2}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAsigna = "T}11}3}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAsigna = "T}12}3}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#4; |HAZ QuitaRaros;
               eaAsigna = "T}11}1}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#6; |HAZ QuitaRaros;
               eaAsigna = "T}12}2}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#5; |HAZ QuitaRaros;
               eaAsigna = "T}11}2}4}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#8; |HAZ QuitaRaros;
               eaAsigna = "T}12}3}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#7; |HAZ QuitaRaros;
               eaAsigna = "T}11}3}4}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
            |SINO;
               eaAlfa   = "";
               nCalc = (((nContFichs - 1) * 4) + 1);
               eaAsigna = "T}11}" + nCalc + "}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = ((nContFichs * 4) + 1);
               eaAsigna = "T}11}" + nCalc + "}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = (((nContFichs - 1) * 4) + 2);
               eaAsigna = "T}11}" + nCalc + "}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = ((nContFichs * 4) + 2);
               eaAsigna = "T}11}" + nCalc + "}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = (((nContFichs - 1) * 4) + 3);
               eaAsigna = "T}11}" + nCalc + "}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = ((nContFichs * 4) + 3);
               eaAsigna = "T}11}" + nCalc + "}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = (((nContFichs - 1) * 4) + 4);
               eaAsigna = "T}11}" + nCalc + "}1}+G";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               nCalc = ((nContFichs * 4) + 4);
               eaAsigna = "T}11}" + nCalc + "}1}+P";
               eaConten = "";     |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#4; |HAZ QuitaRaros;
               nCalc = (((nContFichs - 1) * 4) + 2);
               eaAsigna = "T}11}" + nCalc + "}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#6; |HAZ QuitaRaros;
               nCalc = (((nContFichs - 1) * 4) + 3);
               eaAsigna = "T}11}" + nCalc + "}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#5; |HAZ QuitaRaros;
               nCalc = (((nContFichs - 1) * 4) + 3);
               eaAsigna = "T}11}" + nCalc + "}4}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm006#8; |HAZ QuitaRaros;
               nCalc = (((nContFichs - 1) * 4) + 4);
               eaAsigna = "T}11}" + nCalc + "}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               nCalc = (((nContFichs - 1) * 4) + 4);
               eaAlfa   = #dslpm006#7; |HAZ QuitaRaros;
               eaAsigna = "T}11}" + nCalc + "}4}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
            |FINSI;
            nContFichs = nContFichs + 1;
         |SIGUE;
     |FINSI;

     |CIERRA #dslpm006;

     |ABRE #dslpm004; |ABRE #dslpm100;

     nDatosId = 0;
     #dslpm004#0 = enCliente;
     #dslpm004#1 = enModelo;
     |LEE 000#dslpm004.=;
     |SI FSalida ! 0;
        #dslpm004#0 = enCliente;
        #dslpm004#1 = 1;
        |LEE 000#dslpm004.];
        |SI FSalida ! 0; |O #dslpm004#0 ! enCliente;
           |DDEFECTO #dslpm004; nDatosId = 1;
        |FINSI;
     |FINSI;

     #dslpm100#0 = #dslpm004#145;
     |LEE 000#dslpm100.=;
     |SI FSalida ! 0; |DDEFECTO #dslpm100; |FINSI;

     |SI nDatosId = 0;
        || Seguridad

        eaAlfa   = #dslpm004#8; |HAZ QuitaRaros;
        eaAsigna = "T}12}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#7; |HAZ QuitaRaros;
        eaAsigna = "T}12}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#20; |HAZ QuitaRaros;
        eaAsigna = "T}12}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#19; |HAZ QuitaRaros;
        eaAsigna = "T}12}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        || Copias de respaldo y recuperacion

        eaAlfa   = #dslpm004#10; |HAZ QuitaRaros;
        eaAsigna = "T}13}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#9; |HAZ QuitaRaros;
        eaAsigna = "T}13}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#22; |HAZ QuitaRaros;
        eaAsigna = "T}13}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#21; |HAZ QuitaRaros;
        eaAsigna = "T}13}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        || Incidencias

        nContTabla = nContTabla + 1;
        eaAlfa   = #dslpm004#12; |HAZ QuitaRaros;
        eaAsigna = "T}14}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#11; |HAZ QuitaRaros;
        eaAsigna = "T}14}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#24; |HAZ QuitaRaros;
        eaAsigna = "T}14}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#23; |HAZ QuitaRaros;
        eaAsigna = "T}14}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        || Atencion a los afectados

        eaAlfa   = #dslpm004#14; |HAZ QuitaRaros;
        eaAsigna = "T}15}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#13; |HAZ QuitaRaros;
        eaAsigna = "T}15}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#26; |HAZ QuitaRaros;
        eaAsigna = "T}15}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = #dslpm004#25; |HAZ QuitaRaros;
        eaAsigna = "T}15}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
     |SINO;

        || Seguridad
        nIDCampo = 18; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}12}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}12}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        nIDCampo = 24; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}12}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}12}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        || Copias de respaldo y recuperacion

        nIDCampo = 19; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}13}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}13}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        nIDCampo = 25; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}13}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}13}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        || Incidencias

        nContTabla = nContTabla + 1;
        nIDCampo = 20; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}14}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}14}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        nIDCampo = 26; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}14}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}14}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        || Atencion a los afectados

        nIDCampo = 21; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}15}1}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}15}1}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        nIDCampo = 27; |HAZ BuscaDatId;
        eaAlfa   = aIDNombre; |HAZ QuitaRaros;
        eaAsigna = "T}15}2}2}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

        eaAlfa   = aIDNif; |HAZ QuitaRaros;
        eaAsigna = "T}15}2}4}";
        eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
     |FINSI;

     || Datos empresa externa para el servicio de atención a los afectados

     eaAlfa   = #dslpm004#146; |HAZ QuitaRaros;
     eaAlfa   = "Razón Social: " + eaAlfa;
     eaAsigna = "T}16}2}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm004#145; |HAZ QuitaRaros;
     eaAlfa   = "NIF. / CIF.:" + eaAlfa;
     eaAsigna = "T}16}3}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#2; |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #dslpm100#3; |HAZ QuitaRaros;
     eaAlfa   = "Domicilio: " + eaAlfa;
     eaAsigna = "T}16}4}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#4; |HAZ QuitaRaros;
     eaAlfa   = "Num.: " + eaAlfa;
     eaAsigna = "T}16}4}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#5; |HAZ QuitaRaros;
     eaAlfa   = "Esc.: " + eaAlfa;
     eaAsigna = "T}16}4}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#6; |HAZ QuitaRaros;
     eaAlfa   = "Piso: " + eaAlfa;
     eaAsigna = "T}16}4}4}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#7; |HAZ QuitaRaros;
     eaAlfa   = "Pta.: " + eaAlfa;
     eaAsigna = "T}16}4}5}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = (("00" + #dslpm100#8) % -102) + (("000" + #dslpm100#9) % -103);
     |HAZ QuitaRaros;
     eaAlfa   = "Cod.Postal: " + eaAlfa;
     eaAsigna = "T}16}5}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#10; |HAZ QuitaRaros;
     eaAlfa   = "Población: " + eaAlfa;
     eaAsigna = "T}16}5}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#11; |HAZ QuitaRaros;
     eaAlfa   = "Provincia: " + eaAlfa;
     eaAsigna = "T}16}5}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#12; |HAZ QuitaRaros;
     eaAlfa   = "Teléfono: " + eaAlfa;
     eaAsigna = "T}16}6}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#13; |HAZ QuitaRaros;
     eaAlfa   = "Fax: " + eaAlfa;
     eaAsigna = "T}16}6}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#14; |HAZ QuitaRaros;
     eaAlfa   = "E-mail: " + eaAlfa;
     eaAsigna = "T}16}6}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     || Datos de la empresa donde se encuentran ubicados los ficheros

     #dslpm100#0 = #dslpm004#147;
     |LEE 000#dslpm100.=;
     |SI FSalida ! 0; |DDEFECTO #dslpm100; |FINSI;

     eaAlfa   = #dslpm004#148; |HAZ QuitaRaros;
     eaAlfa   = "Razón Social: " + eaAlfa;
     eaAsigna = "T}17}2}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm004#147; |HAZ QuitaRaros;
     eaAlfa   = "NIF. / CIF.:" + eaAlfa;
     eaAsigna = "T}17}3}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#2; |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #dslpm100#3; |HAZ QuitaRaros;
     eaAlfa   = "Domicilio: " + eaAlfa;
     eaAsigna = "T}17}4}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#4; |HAZ QuitaRaros;
     eaAlfa   = "Num.: " + eaAlfa;
     eaAsigna = "T}17}4}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#5; |HAZ QuitaRaros;
     eaAlfa   = "Esc.: " + eaAlfa;
     eaAsigna = "T}17}4}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#6; |HAZ QuitaRaros;
     eaAlfa   = "Piso: " + eaAlfa;
     eaAsigna = "T}17}4}4}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#7; |HAZ QuitaRaros;
     eaAlfa   = "Pta.: " + eaAlfa;
     eaAsigna = "T}17}4}5}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = (("00" + #dslpm100#8) % -102) + (("000" + #dslpm100#9) % -103);
     |HAZ QuitaRaros;
     eaAlfa   = "Cod.Postal: " + eaAlfa;
     eaAsigna = "T}17}5}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#10; |HAZ QuitaRaros;
     eaAlfa   = "Población: " + eaAlfa;
     eaAsigna = "T}17}5}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#11; |HAZ QuitaRaros;
     eaAlfa   = "Provincia: " + eaAlfa;
     eaAsigna = "T}17}5}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#12; |HAZ QuitaRaros;
     eaAlfa   = "Teléfono: " + eaAlfa;
     eaAsigna = "T}17}6}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#13; |HAZ QuitaRaros;
     eaAlfa   = "Fax: " + eaAlfa;
     eaAsigna = "T}17}6}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#14; |HAZ QuitaRaros;
     eaAlfa   = "E-mail: " + eaAlfa;
     eaAsigna = "T}17}6}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     || Datos de la empresa de tratamiento de los ficheros

     #dslpm100#0 = #dslpm004#17;
     |LEE 000#dslpm100.=;
     |SI FSalida ! 0; |DDEFECTO #dslpm100; |FINSI;

     eaAlfa   = #dslpm004#18; |HAZ QuitaRaros;
     eaAlfa   = "Razón Social: " + eaAlfa;
     eaAsigna = "T}18}2}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm004#17; |HAZ QuitaRaros;
     eaAlfa   = "NIF. / CIF.:" + eaAlfa;
     eaAsigna = "T}18}3}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#2; |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #dslpm100#3; |HAZ QuitaRaros;
     eaAlfa   = "Domicilio: " + eaAlfa;
     eaAsigna = "T}18}4}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#4; |HAZ QuitaRaros;
     eaAlfa   = "Num.: " + eaAlfa;
     eaAsigna = "T}18}4}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#5; |HAZ QuitaRaros;
     eaAlfa   = "Esc.: " + eaAlfa;
     eaAsigna = "T}18}4}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#6; |HAZ QuitaRaros;
     eaAlfa   = "Piso: " + eaAlfa;
     eaAsigna = "T}18}4}4}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#7; |HAZ QuitaRaros;
     eaAlfa   = "Pta.: " + eaAlfa;
     eaAsigna = "T}18}4}5}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = (("00" + #dslpm100#8) % -102) + (("000" + #dslpm100#9) % -103);
     |HAZ QuitaRaros;
     eaAlfa   = "Cod.Postal: " + eaAlfa;
     eaAsigna = "T}18}5}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#10; |HAZ QuitaRaros;
     eaAlfa   = "Población: " + eaAlfa;
     eaAsigna = "T}18}5}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#11; |HAZ QuitaRaros;
     eaAlfa   = "Provincia: " + eaAlfa;
     eaAsigna = "T}18}5}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#12; |HAZ QuitaRaros;
     eaAlfa   = "Teléfono: " + eaAlfa;
     eaAsigna = "T}18}6}1}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#13; |HAZ QuitaRaros;
     eaAlfa   = "Fax: " + eaAlfa;
     eaAsigna = "T}18}6}2}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     eaAlfa   = #dslpm100#14; |HAZ QuitaRaros;
     eaAlfa   = "E-mail: " + eaAlfa;
     eaAsigna = "T}18}6}3}";
     eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

     |CIERRA #dslpm004; |CIERRA #dslpm100;

     || Contratos de Out-Sourcing : Bancos

     nLinCont = 2;
     |ABRE #dslpm002;
     #dslpm002#0 = #dslpz001#0;
     #dslpm002#1 = "";
     |LEE 000#dslpm002.];
     |PARA; |SI FSalida = 0; |Y #dslpm002#0 = #dslpz001#0; |HACIENDO;
        |SI #dslpm002#35 ! "N";
           eaAlfa   = "1";      eaAsigna = "T}20}1}1}+F";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa   = #dslpm002#2; |HAZ QuitaRaros; eaAsigna = "T}20}" + nLinCont + "}1}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa   = #dslpm002#1; |HAZ QuitaRaros; eaAsigna = "T}20}"+ nLinCont + "}2}";
           eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
           nLinCont = nLinCont + 1;
        |FINSI;
        |LEE 000#dslpm002.s;
     |SIGUE;
     |CIERRA #dslpm002;

     || Datos de la empresa de servicios informaticos

     nLinCont = 0;
     nLetra = 97; aChar = "";
     |ABRE #dslpm002;
     #dslpm002#0 = #dslpz001#0;
     #dslpm002#1 = "";
     |LEE 000#dslpm002.];
     |PARA; |SI FSalida = 0; |Y #dslpm002#0 = #dslpz001#0; |HACIENDO;
        |SI #dslpm002#36 ! "N";
           #dslpm100#0 = #dslpm002#1;
           |LEE 000#dslpm100.=;
           |SI FSalida ! 0; |DDEFECTO #dslpm100; |FINSI;

           |SI nLinCont = 0;
               eaAlfa   = #dslpm002#2; |HAZ QuitaRaros;
               eaAlfa   = "Razón Social: " + eaAlfa;
               eaAsigna = "T}21}2}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#1; |HAZ QuitaRaros;
               eaAlfa   = "NIF. / CIF.:" + eaAlfa;
               eaAsigna = "T}21}3}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#3; |HAZ QuitaRaros;
               eaAlfa   = eaAlfa + " " + #dslpm002#4; |HAZ QuitaRaros;
               eaAlfa   = "Domicilio: " + eaAlfa;
               eaAsigna = "T}21}4}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#5; |HAZ QuitaRaros;
               eaAlfa   = "Num.: " + eaAlfa;
               eaAsigna = "T}21}4}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#6; |HAZ QuitaRaros;
               eaAlfa   = "Esc.: " + eaAlfa;
               eaAsigna = "T}21}4}3}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#7; |HAZ QuitaRaros;
               eaAlfa   = "Piso: " + eaAlfa;
               eaAsigna = "T}21}4}4}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#8; |HAZ QuitaRaros;
               eaAlfa   = "Pta.: " + eaAlfa;
               eaAsigna = "T}21}4}5}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = (("00" + #dslpm002#9) % -102) + (("000" + #dslpm002#10) % -103);
               |HAZ QuitaRaros;
               eaAlfa   = "Cod.Postal: " + eaAlfa;
               eaAsigna = "T}21}5}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#11; |HAZ QuitaRaros;
               eaAlfa   = "Población: " + eaAlfa;
               eaAsigna = "T}21}5}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#12; |HAZ QuitaRaros;
               eaAlfa   = "Provincia: " + eaAlfa;
               eaAsigna = "T}21}5}3}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#13; |HAZ QuitaRaros;
               eaAlfa   = "Teléfono: " + eaAlfa;
               eaAsigna = "T}21}6}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#14; |HAZ QuitaRaros;
               eaAlfa   = "Fax: " + eaAlfa;
               eaAsigna = "T}21}6}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#15; |HAZ QuitaRaros;
               eaAlfa   = "E-mail: " + eaAlfa;
               eaAsigna = "T}21}6}3}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
           |SINO;
              |SI nLinCont = 1;  nLinea = 1;  |FINSI;

              |SI nLinCont ! 1;
                  eaAsigna = "T}22}1}1}+G";
                  eaConten = ""; |HAZ GrabaFicheroExterno;

                  eaAsigna = "T}22}" + nLinea + "}1}+P";
                  eaConten = ""; |HAZ GrabaFicheroExterno;

                  nLinea  = nLinea + 1;
                  eaAsigna = "T}22}1}1}+G";
                  eaConten = ""; |HAZ GrabaFicheroExterno;

                  eaAsigna = "T}22}" + nLinea + "}1}+P";
                  eaConten = ""; |HAZ GrabaFicheroExterno;
              |FINSI;

              nLinea  = nLinea + 1;
              eaAsigna = "T}21}1}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}22}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}21}2}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}22}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}21}3}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}22}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}21}4}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}22}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}21}5}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}22}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}21}6}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}22}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              |SI nLinCont = 1;
                  nLineaTabla = 2;
              |SINO;
                  nLineaTabla = nLineaTabla + 3;
              |FINSI;

              nLetra      = nLetra + 1; aChar = &nLetra;
              eaAlfa      = "Datos de la empresa de servicios informáticos (" + aChar + ")";
              eaAsigna    = "T}22}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#2; |HAZ QuitaRaros;
              eaAlfa      = "Razón Social: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#1; |HAZ QuitaRaros;
              eaAlfa      = "NIF. / CIF.:" + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#3; |QBF eaAlfa;
              eaAlfa      = eaAlfa + " " + #dslpm002#4; |HAZ QuitaRaros;
              eaAlfa      = "Domicilio: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#5; |HAZ QuitaRaros;
              eaAlfa      = "Num.: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}2}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#6; |HAZ QuitaRaros;
              eaAlfa      = "Esc.: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}3}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#7; |HAZ QuitaRaros;
              eaAlfa      = "Piso: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}4}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#8; |HAZ QuitaRaros;
              eaAlfa      = "Pta.: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}5}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = (("00" + #dslpm002#9) % -102) + (("000" + #dslpm002#10) % -103);
              |HAZ QuitaRaros;
              eaAlfa      = "Cod.Postal: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#11; |HAZ QuitaRaros;
              eaAlfa      = "Población: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}2}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#12; |HAZ QuitaRaros;
              eaAlfa      = "Provincia: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}3}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#13; |HAZ QuitaRaros;
              eaAlfa      = "Teléfono: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#14; |HAZ QuitaRaros;
              eaAlfa      = "Fax: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}2}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#15; |HAZ QuitaRaros;
              eaAlfa      = "E-mail: " + eaAlfa;
              eaAsigna    = "T}22}" + nLineaTabla + "}3}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;
           |FINSI;

           nLinCont = nLinCont + 1;
        |FINSI;
        |LEE 000#dslpm002.s;
     |SIGUE;

     |SI nLinCont = 0; nLinCont = 1;  |FINSI;

     |PARA nPara = 1; |SI nPara [ 2; |HACIENDO nPara = nPara + 1;
           |SI nLinCont =  1;  nLinea = 1;  |FINSI;

           |SI nLinCont ! 1;
               eaAsigna = "T}22}1}1}+G";
               eaConten = ""; |HAZ GrabaFicheroExterno;

               eaAsigna = "T}22}" + nLinea + "}1}+P";
               eaConten = ""; |HAZ GrabaFicheroExterno;

               nLinea  = nLinea + 1;
               eaAsigna = "T}22}1}1}+G";
               eaConten = ""; |HAZ GrabaFicheroExterno;

               eaAsigna = "T}22}" + nLinea + "}1}+P";
               eaConten = ""; |HAZ GrabaFicheroExterno;
           |FINSI;

           nLinea  = nLinea + 1;
           eaAsigna = "T}21}1}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAlfa  = ""; eaAsigna = "T}22}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}21}2}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}22}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}21}3}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}22}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}21}4}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}22}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}21}5}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}22}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}21}6}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}22}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           |SI nLinCont = 1;
               nLineaTabla = 2;
           |SINO;
               nLineaTabla = nLineaTabla + 3;
           |FINSI;

           nLetra      = nLetra + 1; aChar = &nLetra;
           eaAlfa      = "Datos de la empresa de servicios informáticos (" + aChar + ")";
           eaAsigna    = "T}22}" + nLineaTabla + "}1}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           nLineaTabla = nLineaTabla + 1;
           eaAlfa      = "Razón Social: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}1}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           nLineaTabla = nLineaTabla + 1;
           eaAlfa      = #dslpm002#1; |HAZ QuitaRaros;
           eaAlfa      = "NIF. / CIF.:";
           eaAsigna    = "T}22}" + nLineaTabla + "}1}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           nLineaTabla = nLineaTabla + 1;
           eaAlfa      = "Domicilio: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}1}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "Num.: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}2}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "Esc.: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}3}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "Piso: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}4}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "Pta.: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}5}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           nLineaTabla = nLineaTabla + 1;
           eaAlfa      = "Cod.Postal: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}1}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "Población: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}2}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;
           eaAlfa      = "Provincia: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}3}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           nLineaTabla = nLineaTabla + 1;
           eaAlfa      = "Teléfono: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}1}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "Fax: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}2}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           eaAlfa      = "E-mail: ";
           eaAsigna    = "T}22}" + nLineaTabla + "}3}";
           eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

           nLinCont = nLinCont + 1;
     |SIGUE;

     || Datos del despacho profesional o asesoría
     nLinCont = 0;
     nLetra = 97; aChar = "";

     #dslpm002#0 = #dslpz001#0;
     #dslpm002#1 = "";
     |LEE 000#dslpm002.];
     |PARA; |SI FSalida = 0; |Y #dslpm002#0 = #dslpz001#0; |HACIENDO;
        |SI #dslpm002#37 ! "N";
           #dslpm100#0 = #dslpm002#1;
           |LEE 000#dslpm100.=;
           |SI FSalida ! 0; |DDEFECTO #dslpm100; |FINSI;

           |SI nLinCont = 0;
               eaAlfa   = #dslpm002#2; |HAZ QuitaRaros;
               eaAlfa   = "Razón Social: " + eaAlfa;
               eaAsigna = "T}23}2}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#1; |HAZ QuitaRaros;
               eaAlfa   = "NIF. / CIF.:" + eaAlfa;
               eaAsigna = "T}23}3}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#3; |QBF eaAlfa;
               eaAlfa   = eaAlfa + " " + #dslpm002#4; |HAZ QuitaRaros;
               eaAlfa   = "Domicilio: " + eaAlfa;
               eaAsigna = "T}23}4}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#5; |HAZ QuitaRaros;
               eaAlfa   = "Num.: " + eaAlfa;
               eaAsigna = "T}23}4}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#6; |HAZ QuitaRaros;
               eaAlfa   = "Esc.: " + eaAlfa;
               eaAsigna = "T}23}4}3}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#7; |HAZ QuitaRaros;
               eaAlfa   = "Piso: " + eaAlfa;
               eaAsigna = "T}23}4}4}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#8; |HAZ QuitaRaros;
               eaAlfa   = "Pta.: " + eaAlfa;
               eaAsigna = "T}23}4}5}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = (("00" + #dslpm002#9) % -102) + (("000" + #dslpm002#10) % -103);
               |HAZ QuitaRaros;
               eaAlfa   = "Cod.Postal: " + eaAlfa;
               eaAsigna = "T}23}5}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#11; |HAZ QuitaRaros;
               eaAlfa   = "Población: " + eaAlfa;
               eaAsigna = "T}23}5}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#12; |HAZ QuitaRaros;
               eaAlfa   = "Provincia: " + eaAlfa;
               eaAsigna = "T}23}5}3}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#13; |HAZ QuitaRaros;
               eaAlfa   = "Teléfono: " + eaAlfa;
               eaAsigna = "T}23}6}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#14; |HAZ QuitaRaros;
               eaAlfa   = "Fax: " + eaAlfa;
               eaAsigna = "T}23}6}2}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa   = #dslpm002#15; |HAZ QuitaRaros;
               eaAlfa   = "E-mail: " + eaAlfa;
               eaAsigna = "T}23}6}3}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;

               eaAlfa = "";
               |SI #dslpm002#44 = "S"; eaAlfa = "Fiscal";  |FINSI;
               |SI #dslpm002#45 = "S"; eaAlfa = "Laboral"; |FINSI;
               |SI #dslpm002#44 = "S"; |Y #dslpm002#45 = "S";
                   eaAlfa = "Ambas";
               |FINSI;
               eaAlfa   = "Indicar si es laboral, fiscal o ambas: " + eaAlfa;
               eaAsigna = "T}23}7}1}";
               eaConten = eaAlfa; |HAZ GrabaFicheroExterno;
           |SINO;
              |SI nLinCont = 1;  nLinea = 1;  |FINSI;

              |SI nLinCont ! 1;
                  eaAsigna = "T}24}1}1}+G";
                  eaConten = ""; |HAZ GrabaFicheroExterno;

                  eaAsigna = "T}24}" + nLinea + "}1}+P";
                  eaConten = ""; |HAZ GrabaFicheroExterno;

                  nLinea   = nLinea + 1;
                  eaAsigna = "T}24}1}1}+G";
                  eaConten = ""; |HAZ GrabaFicheroExterno;

                  eaAsigna = "T}24}" + nLinea + "}1}+P";
                  eaConten = ""; |HAZ GrabaFicheroExterno;
              |FINSI;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}1}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}2}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}3}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}4}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}5}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}6}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              nLinea  = nLinea + 1;
              eaAsigna = "T}23}7}1}+G";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              eaAsigna = "T}24}" + nLinea + "}1}+P";
              eaConten = ""; |HAZ GrabaFicheroExterno;

              |SI nLinCont = 1;
                  nLineaTabla = 2;
              |SINO;
                  nLineaTabla = nLineaTabla + 3;
              |FINSI;

              nLetra      = nLetra + 1; aChar = &nLetra;
              eaAlfa      = " Datos del despacho profesional o asesoría (" + aChar + ")";
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#2; |HAZ QuitaRaros;
              eaAlfa      = "Razón Social: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#1; |HAZ QuitaRaros;
              eaAlfa      = "NIF. / CIF.:" + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#3; |QBF eaAlfa;
              eaAlfa      = eaAlfa + " " + #dslpm002#4; |HAZ QuitaRaros;
              eaAlfa      = "Domicilio: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#5; |HAZ QuitaRaros;
              eaAlfa      = "Num.: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}2}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#6; |HAZ QuitaRaros;
              eaAlfa      = "Esc.: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}3}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#7; |HAZ QuitaRaros;
              eaAlfa      = "Piso: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}4}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#8; |HAZ QuitaRaros;
              eaAlfa      = "Pta.: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}5}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = (("00" + #dslpm002#9) % -102) + (("000" + #dslpm002#10) % -103);
              |HAZ QuitaRaros;
              eaAlfa      = "Cod.Postal: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#11; |HAZ QuitaRaros;
              eaAlfa      = "Población: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}2}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#12; |HAZ QuitaRaros;
              eaAlfa      = "Provincia: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}3}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              nLineaTabla = nLineaTabla + 1;
              eaAlfa      = #dslpm002#13; |HAZ QuitaRaros;
              eaAlfa      = "Teléfono: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#14; |HAZ QuitaRaros;
              eaAlfa      = "Fax: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}2}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa      = #dslpm002#15; |HAZ QuitaRaros;
              eaAlfa      = "E-mail: " + eaAlfa;
              eaAsigna    = "T}24}" + nLineaTabla + "}3}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

              eaAlfa = "";
              |SI #dslpm002#44 = "S"; eaAlfa = "Fiscal";  |FINSI;
              |SI #dslpm002#45 = "S"; eaAlfa = "Laboral"; |FINSI;
              |SI #dslpm002#44 = "S"; |Y #dslpm002#45 = "S";
                 eaAlfa = "Ambas";
              |FINSI;
              eaAlfa      = "Indicar si es laboral, fiscal o ambas: " + eaAlfa;
              nLineaTabla = nLineaTabla + 1;
              eaAsigna    = "T}24}" + nLineaTabla + "}1}";
              eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;
           |FINSI;

           nLinCont = nLinCont + 1;
        |FINSI;
        |LEE 000#dslpm002.s;
     |SIGUE;
     |CIERRA #dslpm002;

     |SI nLinCont = 0; nLinCont = 1;  |FINSI;

     |PARA nPara = 1; |SI nPara [ 2; |HACIENDO nPara = nPara + 1;
           |SI nLinCont = 1;  nLinea = 1;  |FINSI;

           |SI nLinCont ! 1;
               eaAsigna = "T}24}1}1}+G";
               eaConten = ""; |HAZ GrabaFicheroExterno;

               eaAsigna = "T}24}" + nLinea + "}1}+P";
               eaConten = ""; |HAZ GrabaFicheroExterno;

               nLinea  = nLinea + 1;
               eaAsigna = "T}24}1}1}+G";
               eaConten = ""; |HAZ GrabaFicheroExterno;

               eaAsigna = "T}24}" + nLinea + "}1}+P";
               eaConten = ""; |HAZ GrabaFicheroExterno;
           |FINSI;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}1}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}2}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}3}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}4}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}5}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}6}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           nLinea  = nLinea + 1;
           eaAsigna = "T}23}7}1}+G";
           eaConten = ""; |HAZ GrabaFicheroExterno;

           eaAsigna = "T}24}" + nLinea + "}1}+P";
           eaConten = ""; |HAZ GrabaFicheroExterno;

          |SI nLinCont = 1;
              nLineaTabla = 2;
          |SINO;
              nLineaTabla = nLineaTabla + 3;
          |FINSI;

          nLetra      = nLetra + 1; aChar = &nLetra;
          eaAlfa      = " Datos del despacho profesional o asesoría (" + aChar + ")";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLineaTabla = nLineaTabla + 1;
          eaAlfa      = "Razón Social: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLineaTabla = nLineaTabla + 1;
          eaAlfa      = "NIF. / CIF.:";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLineaTabla = nLineaTabla + 1;
          eaAlfa      = "Domicilio: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Num.: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}2}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Esc.: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}3}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Piso: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}4}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Pta.: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}5}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLineaTabla = nLineaTabla + 1;
          eaAlfa      = "Cod.Postal: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Población: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}2}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Provincia: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}3}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLineaTabla = nLineaTabla + 1;
          eaAlfa      = "Teléfono: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "Fax: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}2}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          eaAlfa      = "E-mail: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}3}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLineaTabla = nLineaTabla + 1;
          eaAlfa      = "Indicar si es laboral, fiscal o ambas: ";
          eaAsigna    = "T}24}" + nLineaTabla + "}1}";
          eaConten    = eaAlfa; |HAZ GrabaFicheroExterno;

          nLinCont = nLinCont + 1;
     |SIGUE;
|FPRC;

|PROCESO Encuesta61;
     #0#0 = enCliente;

     enTipoDoc      = enDocumento;
     eaModoPresenta = "N";
     eaGuarda       = "S";
     |HAZ AbreDocuAF;

     |ABRE #dslpm001; |SELECT #2#dslpm001;
     #dslpm001#1 = #0#0;
     |LEE 000#dslpm001.=;
     |SI FSalida ! 0; |DDEFECTO #dslpm001; |FINSI;
     |CIERRA #dslpm001;

     |ABRE #dslpm004;
     #dslpm004#0 = enCliente;
     #dslpm004#1 = 1;
     |LEE 000#dslpm004.];
     |SI FSalida ! 0;  |O #dslpm004#0 ! enCliente;
         |DDEFECTO #dslpm004;
     |FINSI;
     |CIERRA #dslpm004;

     |HAZ ParteAGVariables;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |HAZ ParteAFTablas;
     |HAZ ParteAGTablas;

     |HAZ CierraDocuAF;
     |PULSATECLA;
|FPRC;
