|FICHEROS;
     dslpm002 #2;

     dslpw004 #904;
     dslpw033 #933;
     dslpw044 #944;

     dslpm002@ #999;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nCampo1      = 0;

     aAlfa        = "";
     aBase        = "";
     aMas         = "";
     aFichero     = "";

     &enValidar   = 0;
     &enCliente   = 0;
     &enPlantilla = 0;
|FIN;

|PROCESO Tipo12w44;  |TIPO 12;
     enValidar = 0;

     |SI enPlantilla = 0;
         #904#244 = "S";
     |SINO;
         #933#223 = "S";
     |FINSI;

     |SI enPlantilla = 0;
         aAlfa = #944#0;           |QBF aAlfa;
         aAlfa = aAlfa + #944#2;   |QBF aAlfa;
         aAlfa = aAlfa + #944#4;   |QBF aAlfa;
         aAlfa = aAlfa + #944#6;   |QBF aAlfa;
         aAlfa = aAlfa + #944#8;   |QBF aAlfa;
         aAlfa = aAlfa + #944#10;  |QBF aAlfa;
     |SINO;
         aAlfa = #944#8;           |QBF aAlfa;
         aAlfa = aAlfa + #944#9;   |QBF aAlfa;
         aAlfa = aAlfa + #944#10;  |QBF aAlfa;
         aAlfa = aAlfa + #944#11;  |QBF aAlfa;
     |FINSI;

     |SI aAlfa = "";
         |SI enPlantilla = 0;
             #904#244 = "N";
         |SINO;
             #933#223 = "N";
         |FINSI;
     |FINSI;

     |SI enPlantilla = 0;
         |PINTA #904#244;
     |SINO;
         |PINTA #933#223;
     |FINSI;
|FPRC;

|PROCESO Baja999m44;
     #999#0 = enCliente;
     #999#1 = "";
|FPRC;

|PROCESO Alta999m44;
     #999#0 = enCliente;
     #999#1 = "zzzzzzzzzzzz";
|FPRC;

|PROCESO dslpm002w44;
     |PARA nCampo = 0;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           #999nCampo = #2nCampo;
     |SIGUE;

     |GRABA 020#999n;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dslpm002w44;
     #2#1;
     ;
     enCliente, "            ";
     enCliente, "zzzzzzzzzzzz";
     ;
     NULL, dslpm002w44;
|FIN;

|PROCESO LeeDNI;  |TIPO 66;
     |SI enPlantilla ! 0;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dslpm002.mas";
     |CARGA_DEF aMas, dslpm002@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = ("DD" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     |ABRE #999;
     |BUCLE dslpm002w44;

     |LEE 000#999p;
     |SI FSalida ! 0;
         |MENAV "0000 No hay informado responsable o encargado en este apartado.";
         |ERROR;
         |CIERRA #999;
         |DELINDEX #999;
         |DESCARGA_DEF #dslpm002@;
         |ACABA;
     |FINSI;

     |CONSULTA_F_CLAVE #1#999, Baja999m44, Alta999m44;
     |SI FSalida = 0;
        #944Campo = #999#1;  |PINTA #944Campo;
     |FINSI;
     |CIERRA #999;
     |DELINDEX #999;

     |DESCARGA_DEF #dslpm002@;
     |ERROR;
|FPRC;

|PROCESO CogeDNI;  |TIPO 0;
     |SI enPlantilla ! 0;  |ACABA;  |FINSI;

     nCampo1 = Campo + 1;
     |SI #944Campo = "            ";
         #944nCampo1 = "";
         |PINTA #944nCampo1;
         |ACABA;
     |FINSI;

     |ABRE #2;
     #2#0 = enCliente;
     #2#1 = #944Campo;
     |LEE 000#2=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe la Persona en la Empresa";
         |ERROR;
     |SINO;
         #944nCampo1 = #2#2;  |PINTA #944nCampo1;
     |FINSI;
     |CIERRA #2;
|FPRC;
