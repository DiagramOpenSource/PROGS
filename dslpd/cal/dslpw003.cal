|FICHEROS;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm007 #7;
     dslpm012 #12;
     dslpm510 #510;
     dslpm523 #523;
     dslpw003 #903;
     dslpw031 #931;
     dslpw053 #953;
     dslpw998 #998;

     dslpm002@ #999;
|FIN;

|VARIABLES;
     &enSolicitud   = 0;
     &enEncuesta    = 0;
     &enVarios      = 0;
     &enDocumento   = 0;

     nBoton7_1      = 0;
     nBoton7_2      = 0;
     nBoton7_3      = 0;
     nBoton7_4      = 0;
     nBoton7_5      = 0;
     nBoton7_6      = 0;
     nSubBoton7     = 0;

     nPanta0        = 0;
     nPanta1        = 0;
     nPanta2        = 0;
     nPanta3        = 0;
     nPanta4        = 0;
     nPanta5        = 0;
     nPanta6        = 0;
     nPanta7        = 0;
     nSubPanta7     = 0;

     nCampoD        = 0;
     nCampoH        = 0;
     nCampoHasta    = 0;
     nCampo1        = 0;
     nVentana       = 0;
     nGrid1         = 0;
     nSubGrid7      = 0;
     nRango         = 0;
     nPos1          = 0;
     nPos2          = 0;
     nResp          = 0;
     nCampo         = 0;
     nLinea         = 0;

     aAlfa          = "";
     aBase          = "";
     aMas           = "";
     aFichero       = "";
     aAlfa1         = "";
     aAlfa2         = "";

     &enCliente     = 0;
     &enModelo      = 0;
     &enFichero     = 0;
     &eaNIF         = "";
     &enModo        = 1;
     &eaVarDni      = "";
     &enCalcCif     = 0;
|FIN;

|PROCESO BajaPanta7;
     #5#0  = enCliente;
     #5#1  = #903#0;
     #5#2  = 1;
|FPRC;

|PROCESO AltaPanta7;
     #5#0  = enCliente;
     #5#1  = #903#0;
     #5#2  = 99999;
|FPRC;

|PROCESO GrabaModelo;
     #4#0 = enCliente;
     #4#1 = #903#0;
     |LEE 101#4=;
     |SI FSalida ! 0;
         |DDEFECTO #4;
         #4#0 = enCliente;
         #4#1 = #903#0;
         |GRABA 020#4b;
     |FINSI;

     |PARA nCampoD = 1;  |SI nCampoD [ nCampoHasta;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 1;
           #4nCampoD = #903nCampoH;
     |SIGUE;
     |GRABA 020#4a;
     |LIBERA #4;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 6_1
|| ------------------------------------------------------

|PROCESO Boton7_1;
     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     |HAZ GrabaModelo;

     enModelo  = #903#0;
     enFichero = 0;
     enModo    = 1;
     |SUB_EJECUTA "dslpw004";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 6_2
|| ------------------------------------------------------

|PROCESO Boton7_2;
     |VENTANA 0501, 2799, -1, 1, "";
     nVentana = FSalida;

     enModelo  = #903#0;
     enFichero = #5#2;
     enModo    = 2;
     |SUB_EJECUTA "dslpw004";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 6_3
|| ------------------------------------------------------

|PROCESO dslpm006;
     |BORRA 020#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE dslpm006;
     #6#1;
     ;
     #5#0, #5#1, #5#2, "   ";
     #5#0, #5#1, #5#2, "zzz";
     be;
     NULL, dslpm006;
|FIN;

|PROCESO dslpm007;
     |BORRA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE dslpm007;
     #7#1;
     ;
     #5#0, #5#1, #5#2, "        ";
     #5#0, #5#1, #5#2, "zzzzzzzz";
     be;
     NULL, dslpm007;
|FIN;

|PROCESO Boton7_3;
     aAlfa = "0000N" + &191 + " Esta vd.seguro de dar de baja a " + #5#3 + " ?";
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#5=;
     |SI FSalida = 0;
         |ABRE #12;
         #12#0 = #5#0;
         #12#1 = #5#1;
         #12#2 = #5#2;
         |LEE 101#12=;
         |SI FSalida = 0;
             |BORRA 020#12a;
             |LIBERA #12;
         |FINSI;
         |CIERRA #12;

         |BUCLE dslpm006;
         |BUCLE dslpm007;

         |BORRA 020#5a;
         |LIBERA #5;
     |FINSI;

     #5#0 = enCliente;
     #5#1 = #903#0;
     #5#1 = 1;
     |LEE 000#5];
     |SI FSalida = 0;  |Y  #5#0 = enCliente;  |Y  #5#1 = #903#0;
         |ESTADO_CONTROL nBoton7_2, "ENABLE";
         |ESTADO_CONTROL nBoton7_3, "ENABLE";
     |SINO;
         |ESTADO_CONTROL nBoton7_2, "DISABLE";
         |ESTADO_CONTROL nBoton7_3, "DISABLE";
     |FINSI;

     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 6_4
|| ------------------------------------------------------

|PROCESO dslpm510C;
     #931#0 = #510#0;
     |LEE 101#931=;
     |SI FSalida ! 0;
         |DDEFECTO #931;
         #931#0 = #510#0;
         #931#1 = #510#2;
         |GRABA 020#931n;
     |FINSI;
     |LIBERA #931;
|FPRC;

|DEFBUCLE dslpm510C;
     #510#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dslpm510C;
|FIN;

|PROCESO dslpm510;
     #5#0  = enCliente;
     #5#1  = #903#0;
     #5#2  = 99999;
     |LEE 000#5];
     |SI FSalida = 0;
         |LEE 000#5a;
     |SINO;
         |LEE 000#5u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y  #5#0  = enCliente;  |Y #5#1  = #903#0;
         nLinea = #5#2 + 1;
     |FINSI;

     |DDEFECTO #5;

     #5#0  = enCliente;
     #5#1  = #903#0;
     #5#2  = nLinea;
     #5#3  = #510#3;
     #5#4  = #510#4;
     #5#5  = #510#5;

     #5#6  = #903#2;
     #5#7  = #903#3;
     #5#8  = #903#6;
     #5#9  = #903#7;
     #5#10 = #903#8;
     #5#11 = #903#9;
     #5#12 = #903#10;
     #5#13 = #903#11;
     #5#14 = #903#12;
     #5#15 = #903#13;
     #5#16 = #903#14;
     #5#17 = #903#15;
     #5#18 = #903#18;
     #5#19 = #903#19;
     #5#20 = #903#20;
     #5#21 = #903#21;
     #5#22 = #903#22;
     #5#23 = #903#23;
     #5#24 = #903#24;
     #5#25 = #903#25;

     |PARA nCampoD = 26;  |SI nCampoD [ 238;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 20;
           #5nCampoD = #510nCampoH;
     |SIGUE;

     #5#243 = #903#144;
     #5#244 = #903#145;
     #5#245 = #903#146;
     #5#246 = #903#147;

     #5#248 = #510#219;
     #5#249 = #510#220;
     #5#250 = #510#221;
     #5#251 = #510#222;

     |GRABA 020#5n;
     |LIBERA #5;

     #523#0 = #510#0;
     #523#1 = #510#1;
     |LEE 000#523=;
     |SI FSalida ! 0;  |DDEFECTO #523;  |FINSI;

     #12#0  = #5#0;
     #12#1  = #5#1;
     #12#2  = #5#2;
     |LEE 101#12=;
     |SI FSalida ! 0;
         |DDEFECTO #12;
         #12#0  = #5#0;
         #12#1  = #5#1;
         #12#2  = #5#2;
         |GRABA 020#12b;
     |FINSI;

     |PARA nCampoD = 3;  |SI nCampoD [ 14;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 1;
           #12nCampoD = #523nCampoH;
     |SIGUE;

     |PARA nCampoD = 15;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 3;
           #12nCampoD = #523nCampoH;
     |SIGUE;

     |PARA nCampoD = 38;  |SI nCampoD [ 49;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 14;
           #12nCampoD = #523nCampoH;
     |SIGUE;

     |PARA nCampoD = 68;  |SI nCampoD [ 71;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 54;
           #12nCampoD = #523nCampoH;
     |SIGUE;

     |PARA nCampoD = 72;  |SI nCampoD [ 82;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 31;
           #12nCampoD = #523nCampoH;
     |SIGUE;

     |GRABA 020#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE dslpm510;
     #510#1;
     ;
     #931#0, 00001;
     #931#0, 99999;
     ;
     NULL, dslpm510;
|FIN;

|PROCESO Boton7_4;
     aFichero = ("31" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #931 aFichero;
     |ABRE #931;  |CIERRA #931;  |DELINDEX #931;

     |ABRE #931;
     |BUCLE dslpm510C;

     |LEE 000#931p;
     |SI FSalida ! 0;
         |MENAV "0000 No Existe Plantillas.";
         |CIERRA #931;
         |DELINDEX #931;
         |ACABA;
     |FINSI;

     |CONSULTA_CLAVE #1#931;
     |SI FSalida = 0;
         |ABRE #12;
         |ABRE #523;
         |BUCLE dslpm510;
         |CIERRA #12;
         |CIERRA #523;

         |REFRESCACONTROL nGrid1;
     |FINSI;

     |CIERRA #931;
     |DELINDEX #931;
|FPRC;

|PROCESO dslpm005;
     #953#0 = #5#2;
     #953#1 = #5#3;
     #953#2 = #5#4;
     #953#3 = "*";
     |GRABA 020#953n;
     |LIBERA #953;
|FPRC;

|DEFBUCLE dslpm005;
     #5#1;
     ;
     #4#0, #4#1, 00001;
     #4#0, #4#1, 99999;
     ;
     NULL, dslpm005;
|FIN;

|PROCESO EventoSubPanta7;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#953=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#953=;
         |SI FSalida = 0;
             |SI #953#3 = "*";
                 #953#3 = " ";
             |SINO;
                 #953#3 = "*";
             |FINSI;
             |GRABA 020#953a;
             |LIBERA #953;

             |PINDA #0#953;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO SubBoton7;
     enSolicitud = 1;
     |PTEC 806;
|FPRC;

|PROCESO Boton7_6;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = enCliente;
     |LEE 020#1=;
     |CIERRA #1;

     aFichero = ("53" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #953 aFichero;
     |ABRE #953;  |CIERRA #953;  |DELINDEX #953;

     |ABRE #953;
     |BUCLE dslpm005;

     |LEE 000#953p;
     |SI FSalida ! 0;
         |MENAV "0000 No hay informados Ficheros en este Modelo.";
         |CIERRA #953;
         |DELINDEX #953;
         |ACABA;
     |FINSI;

     enSolicitud = 0;

     |BORRA_HIJOS_PAN #7#903;
     |SUB_PINPA #0#953, nPanta7;
     nSubPanta7 = FSalida;

     |CONTROL_SIMPLE nSubPanta7, "BOTON,{{205}} Crear Documento", 1280, 1498, SubBoton7;
     nSubBoton7 = FSalida;

     nRango = 4 + 8 + 16;
     nPos1  = 0810;
     nPos2  = 2050;

     |LINEAL_SIMPLE #1#953, nRango, nPos1, nPos2, NULL, NULL, EventoSubPanta7;

     |FIN_CONTROL_WINDOWS nSubBoton7;

     |BORRA_HIJOS_PAN #7#903;

     |SI enSolicitud = 1;
         enVarios    = 1;
         enSolicitud = 1;
         enCliente   = #1#1;
         enModelo    = #903#0;
         |SUB_PINPA #0#998, nPanta7;

         |SUB_EJECUTA_NP "dslpz001";
         enSolicitud = 0;

         |BORRA_HIJOS_PAN #7#903;
     |FINSI;

     |CIERRA #953;
     |DELINDEX #953;
|FPRC;

|PROCESO Boton7_5;
     |ABRE #1;
     |SELECT #2#1;
     #1#1 = enCliente;
     |LEE 020#1=;
     |CIERRA #1;

     aAlfa = "0000NEmitir Encuesta a Cliente " + #1#2;
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBoton7_5, "DISABLE";
     enVarios    = 1;
     enEncuesta  = 1;
     enCliente   = #1#1;
     enModelo    = #903#0;
     enFichero   = #5#2;
     enDocumento = 0;
     |SUB_EJECUTA_NP "dslpz001";
     enEncuesta = 0;
     |ESTADO_CONTROL nBoton7_5, "ENABLE";
|FPRC;

|| ------------------------------------------------------
|| Procesos del Incio del Programa
|| ------------------------------------------------------

|PROCESO EventoPanta7;
     |SI FSalida = 1;  |O FSalida = 2;
         |ESTADO_CONTROL nBoton7_1, "ENABLE";

         |LEE 000#5=;
         |SI FSalida = 0;  |Y  #5#0 = enCliente;  |Y  #5#1 = #903#0;
             |ESTADO_CONTROL nBoton7_2, "ENABLE";
             |ESTADO_CONTROL nBoton7_3, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton7_2, "DISABLE";
             |ESTADO_CONTROL nBoton7_3, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta7;
     |CONTROL_SIMPLE nPanta7, "BOTON,{{193}} Alta", 0777, 0898, Boton7_1;
     nBoton7_1 = FSalida;

     |CONTROL_SIMPLE nPanta7, "BOTON,{{197}} Modificar", 0977, 1098, Boton7_2;
     nBoton7_2 = FSalida;

     |CONTROL_SIMPLE nPanta7, "BOTON,{{199}} Baja ", 1177, 1298, Boton7_3;
     nBoton7_3 = FSalida;

     |CONTROL_SIMPLE nPanta7, "BOTON,{{218}} Recoger de Plantillas ", 1377, 1498, Boton7_4;
     nBoton7_4 = FSalida;

/*
     |CONTROL_SIMPLE nPanta7, "BOTON,{{205}} Emitir Encuesta ", 1577, 1698, Boton7_5;
     nBoton7_5 = FSalida;
*/

     |CONTROL_SIMPLE nPanta7, "BOTON,{{205}} Solicitud N§ Inscripcion ", 1577, 1698, Boton7_6;
     nBoton7_6 = FSalida;

     |ESTADO_CONTROL nBoton7_1, "DISABLE";
     |ESTADO_CONTROL nBoton7_2, "DISABLE";
     |ESTADO_CONTROL nBoton7_3, "DISABLE";
|FPRC;

|PROCESO Modelo;  |TIPO 7;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #4#0 = enCliente;
     #4#1 = 9999;
     |LEE 000#4];
     |SI FSalida = 0;
         |LEE 000#4a;
     |SINO;
         |LEE 000#4u;
     |FINSI;

     #903#0 = 1;
     |SI FSalida = 0;  |Y #4#0 = enCliente;
         #903#0 = #4#1 + 1;
     |FINSI;

     |PINTA #903#0;
|FPRC;

|PROCESO Baja999;
     #999#0 = enCliente;
     #999#1 = "";
|FPRC;

|PROCESO Alta999;
     #999#0 = enCliente;
     #999#1 = "zzzzzzzzzzzz";
|FPRC;

|PROCESO dslpm002;
     |SI nResp ! 0;
         |SI #2nResp ! "S";  |ACABA;  |FINSI;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           #999nCampo = #2nCampo;
     |SIGUE;

     |GRABA 020#999n;
     |LIBERA #999;
|FPRC;

|DEFBUCLE dslpm002;
     #2#1;
     ;
     enCliente, "            ";
     enCliente, "zzzzzzzzzzzz";
     ;
     NULL, dslpm002;
|FIN;

|PROCESO CogeResponsable;  |TIPO 66;
     |SI Campo = 2;   nResp = 16;  |FINSI;
     |SI Campo = 4;   nResp = 17;  |FINSI;
     |SI Campo = 6;   nResp = 18;  |FINSI;
     |SI Campo = 8;   nResp = 19;  |FINSI;
     |SI Campo = 10;  nResp = 20;  |FINSI;
     |SI Campo = 12;  nResp = 21;  |FINSI;
     |SI Campo = 14;  nResp = 22;  |FINSI;
     |SI Campo = 16;  nResp = 23;  |FINSI;
     |SI Campo = 18;  nResp = 24;  |FINSI;
     |SI Campo = 20;  nResp = 25;  |FINSI;
     |SI Campo = 22;  nResp = 26;  |FINSI;
     |SI Campo = 24;  nResp = 27;  |FINSI;
     |SI Campo = 144; nResp = 0;   |FINSI;
     |SI Campo = 146; nResp = 0;   |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dslpm002.mas";
     |CARGA_DEF aMas, dslpm002@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = ("DD" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     |ABRE #999;
     |BUCLE dslpm002;

     |LEE 000#999p;
     |SI FSalida ! 0;
         |MENAV "0000 No hay informado responsable o encargado en este apartado.";
         |ERROR;
         |CIERRA #999;
         |DELINDEX #999;
         |DESCARGA_DEF #dslpm002@;
         |ACABA;
     |FINSI;

     |CONSULTA_F_CLAVE #1#999, Baja999, Alta999;
     |SI FSalida = 0;
        #903Campo = #999#1;  |PINTA #903Campo;
     |FINSI;
     |CIERRA #999;
     |DELINDEX #999;

     |DESCARGA_DEF #dslpm002@;
     |ERROR;
|FPRC;

|PROCESO LeeResponsable;  |TIPO 0;
     |SI Campo = 2;   nResp = 16;  |FINSI;
     |SI Campo = 4;   nResp = 17;  |FINSI;
     |SI Campo = 6;   nResp = 18;  |FINSI;
     |SI Campo = 8;   nResp = 19;  |FINSI;
     |SI Campo = 10;  nResp = 20;  |FINSI;
     |SI Campo = 12;  nResp = 21;  |FINSI;
     |SI Campo = 14;  nResp = 22;  |FINSI;
     |SI Campo = 16;  nResp = 23;  |FINSI;
     |SI Campo = 18;  nResp = 24;  |FINSI;
     |SI Campo = 20;  nResp = 25;  |FINSI;
     |SI Campo = 22;  nResp = 26;  |FINSI;
     |SI Campo = 24;  nResp = 27;  |FINSI;
     |SI Campo = 144; nResp = 0;   |FINSI;
     |SI Campo = 146; nResp = 0;   |FINSI;

     nCampo1 = Campo + 1;
     |SI #903Campo = "            ";
         #903nCampo1 = "";
         |PINTA #903nCampo1;
         |ACABA;
     |FINSI;

     |ABRE #2;
     #2#0 = enCliente;
     #2#1 = #903Campo;
     |LEE 000#2=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe la Persona en la Empresa";
         |ERROR;
     |SINO;
         |SI #2nResp ! "S";  |Y nResp ! 0;
             |MENAV "0000 La persona no tiene informado responsable o encargado en este apartado.";
             |ERROR;
         |SINO;
             #903nCampo1 = #2#2;  |PINTA #903nCampo1;
         |FINSI;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO OtrosPanta3;  |TIPO 0;
     |C_M #903#27, 1, "S";
     |SI #903#26 ! "O";
         |C_M #903#27, 1, "N";
         #903#27 = "";  |PINTA #903#27;
     |FINSI;
|FPRC;

|PROCESO OtrosPanta4;  |TIPO 0;
     |C_M #903#65, 1, "S";
     |SI #903#64 ! "O";
         |C_M #903#65, 1, "N";
         #903#65 = "";  |PINTA #903#65;
     |FINSI;
|FPRC;

|PROCESO OtrosPanta5;  |TIPO 0;
     |C_M #903#75, 1, "S";

     |SI #903#74 = "N";
         |C_M #903#75, 1, "N";
     |FINSI;

     |PINTA #903#75;
|FPRC;

|PROCESO dslpm002A;
     |SI #2nResp ! "S";  |ACABA;  |FINSI;

     aAlfa1 = #2#1;
     aAlfa2 = #2#2;

     |ERROR10;
|FPRC;

|PROCESO Limpia;
     aAlfa1 = "";
     aAlfa2 = "";
|FPRC;

|DEFBUCLE dslpm002A;
     #2#1;
     ;
     #1#1, "            ";
     #1#1, "zzzzzzzzzzzz";
     ;
     Limpia, dslpm002A;
|FIN;

|PROCESO Menav;
     |SI nCampo = 2;
         |MENAV "0000 Falta Responsable de Ficheros en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 4;
         |MENAV "0000 Falta Responsable de Tratamiento en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 6;
         |MENAV "0000 Falta Responsable de Seguridad en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 8;
         |MENAV "0000 Falta Responsable de Copias respaldo y recuperacion en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 10;
         |MENAV "0000 Falta Responsable de Registros de incidencias en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 12;
         |MENAV "0000 Falta Responsable de Atencion a los afectados en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 14;
         |MENAV "0000 Falta Encargado de Ficheros en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 16;
         |MENAV "0000 Falta Encargado de Tratamiento en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 18;
         |MENAV "0000 Falta Encargado de Seguridad en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 20;
         |MENAV "0000 Falta Encargado de Copias respaldo y recuperacion en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 22;
         |MENAV "0000 Falta Encargado de Registros de incidencias en Datos Identificativos.";
     |FINSI;

     |SI nCampo = 24;
         |MENAV "0000 Falta Encargado de Atencion a los afectados en Datos Identificativos.";
     |FINSI;
|FPRC;

|PROCESO RecogeResponsables;
     nResp = 16;  |BUCLE dslpm002A;  #903#2  = aAlfa1;  #903#3  = aAlfa2;
     nResp = 17;  |BUCLE dslpm002A;  #903#4  = aAlfa1;  #903#5  = aAlfa2;
     nResp = 18;  |BUCLE dslpm002A;  #903#6  = aAlfa1;  #903#7  = aAlfa2;
     nResp = 19;  |BUCLE dslpm002A;  #903#8  = aAlfa1;  #903#9  = aAlfa2;
     nResp = 20;  |BUCLE dslpm002A;  #903#10 = aAlfa1;  #903#11 = aAlfa2;
     nResp = 21;  |BUCLE dslpm002A;  #903#12 = aAlfa1;  #903#13 = aAlfa2;

     nResp = 22;  |BUCLE dslpm002A;  #903#14 = aAlfa1;  #903#15 = aAlfa2;
     nResp = 23;  |BUCLE dslpm002A;  #903#16 = aAlfa1;  #903#17 = aAlfa2;
     nResp = 24;  |BUCLE dslpm002A;  #903#18 = aAlfa1;  #903#19 = aAlfa2;
     nResp = 25;  |BUCLE dslpm002A;  #903#20 = aAlfa1;  #903#21 = aAlfa2;
     nResp = 26;  |BUCLE dslpm002A;  #903#22 = aAlfa1;  #903#23 = aAlfa2;
     nResp = 27;  |BUCLE dslpm002A;  #903#24 = aAlfa1;  #903#25 = aAlfa2;

     #903#77 = #1#27;

     |PARA nCampo = 2;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 2;
           aAlfa = #903nCampo;  |QBF aAlfa;
           |SI aAlfa = "";
               |HAZ Menav;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |ABRET #5;

     FSalida = 2899;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #5;
|FPRC;

|PROGRAMA;
     nCampoHasta = 148;

     |ABRE #4;
     |SI enModo ! 1;
         #4#0 = enCliente;
         #4#1 = enModelo;
         |LEE 101#4=;
         |SI FSalida ! 0;  |DDEFECTO #4; |FINSI;

         |PARA nCampoD = 1;  |SI nCampoD [ nCampoHasta;   |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD - 1;
               #903nCampoH = #4nCampoD;
         |SIGUE;
     |SINO;
         |ABRE #1;
         #1#0 = 40;
         #1#1 = enCliente;
         |LEE 000#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
         |CIERRA #1;

         |HAZ RecogeResponsables;
     |FINSI;

     |CABEZA "Datos del Modelo";

     |PINPA #0#903;  nPanta0 = FSalida;
     |PINDA #0#903;

     |PINPA #1#903;  nPanta1 = FSalida;
     |PINDA #1#903;

     |PINPA #2#903;  nPanta2 = FSalida;
     |PINDA #2#903;

     |PINPA #3#903;  nPanta3 = FSalida;
     |PINDA #3#903;

     |PINPA #4#903;  nPanta4 = FSalida;
     |PINDA #4#903;

     |PINPA #5#903;  nPanta5 = FSalida;
     |PINDA #5#903;

     |PINPA #6#903;  nPanta6 = FSalida;
     |PINDA #6#903;

     |PINPA #7#903;  nPanta7 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1  = 0602;
     nPos2  = 2060;

     |LINEAL_SIMPLE #1#5, nRango, nPos1, nPos2, BajaPanta7, AltaPanta7, EventoPanta7;
     nGrid1 = FSalida;

     |HAZ BotonesPanta7;

     |SI enModo = 1;  |ENDATOS #1#903;  |FINSI;
     |SI enModo = 2;  |ENDATOS #2#903;  |FINSI;

     |SI FSalida = 0;
         |HAZ GrabaModelo;
     |FINSI;
     |CIERRA #4;

     |FIN_CONTROL_WINDOWS nBoton7_1;
     |FIN_CONTROL_WINDOWS nBoton7_2;
     |FIN_CONTROL_WINDOWS nBoton7_3;
     |FIN_CONTROL_WINDOWS nBoton7_4;
     |FIN_CONTROL_WINDOWS nBoton7_5;
     |FIN_CONTROL_WINDOWS nBoton7_6;

     |DESTRUYECONTROL nGrid1;

     |PULSATECLA;
|FPRO;
