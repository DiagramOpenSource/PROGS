|| ---------------------------------------
|| Soporte
|| ---------------------------------------

|FICHEROS;
     dslpz001 #0;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm007 #7;
     dslpm008 #8;
     dslpm009 #9;
     dslpm012 #12;
     dslpm013 #13;
     dslpm014 #14;
     dslpm015 #15;
     dslpm016 #16;
     dslpm017 #17;
     dslpm504 #504;
     dslpm505 #505;
     dslpm506 #506;
     dslpm507 #507;
     dslpw100 #1000,MANTE;
     dslpw101 #1001;
     dslpw102 #1002;
     dslpw103 #1003;
     dslpw104 #1004;
     dslpw105 #1005;
     dslpw998 #998;
|FIN;

|VARIABLES;
     aNifEnTrata = "";
     nVoyPorPais = 0;
     &eaFinalidad1 = "";
     &eaFinalidad2 = "";

     &eaProceUno = "";
     &eaProceDos = "";

     &eaCesionUno = "";
     &eaCesionDos = "";

     &eaPaisUno = "";
     &eaCateUno = "";
     &eaPaisDos = "";
     &eaCateDos = "";
     &eaPaisTres = "";
     &eaCateTres = "";
     &eaPaisCuatro = "";
     &eaCateCuatro = "";
     &eaPaisCinco = "";
     &eaCateCinco = "";

     nNumDesde = 0;
     aFrase1 = "";
     aFrase2 = "";
     aFrase3 = "";
     aFaltaPoner = "";
     nLongFalta = 0;
     nLongUno = 0;
     nLongDos = 0;
     nLongTres = 0;
     nCabenUno = 0;
     nCabenDos = 0;
     nCabenTres = 0;
     nDif = 0;
     nNumAlFinal = 0;
     nCorte = 0;
     aAux1 = "";
     aAux2 = "";

     &enTipo = 0;
     &enSwTrata = 0;
     aDniEncargado = "";

     ||Creacion XML.
     aNombreXML = "";
     aPathXML = "";
     aAnyo = "";
     aMes = "";
     aDia = "";
     fSistema = @;
     aSistema = "";
     aFicXML = "";
     nHandleXML = 0;
     aMete = "";
     aTab = "";
     aHoraSis = "";
     aHH = "";
     aMM = "";
     aSS = "";
     aIdUpload = "";
     aCif = "";
     aFechaHex = ""
     nMes = 0;
     aAux = "";
     nTab = 0;
     aEtiqueta = "";
     aDirPostal = "";
     aBeta = "";
     aFinalidad = "";
     aSaca = "";
     aSaca2 = "";
     {1}aLocal = "";
     aPathLocal = "";

      aMensaje = "";
      nVentana = 0;
      nPanta         = 0;
      nBoton1        = 0;
      nBoton2        = 0;
      nRango         = 0;
      nPos1          = 0;
      nPos2          = 0;
      nCampoD        = 0;
      nCampoH        = 0;
      nEnvio         = 0;
      nSwLectura     = 0;
      nHandle        = 0;
      nHandleEnvio   = 0;
      nCampo         = 0;
      nAscii         = 0;
      nLongitud      = 0;
      nPos           = 0;
      nBusca         = 0;
      nCaracter      = 0;
      nPorDonde      = 0;
      nDocu          = 0;
      nConta         = 0;
      nPosici        = 0;
      nRegis         = 0;
      nLong          = 0;
      nIdSalir       = 0;
      nNume          = 0;

      {2}nNivel      = 0;

      aAlfa          = "";
      aAlfa1         = "";
      aAlfa2         = "";
      aAlfa3         = "";
      aAlfa4         = "";
      aAbre          = "";
      aAbreEnvio     = "";
      aBase          = "";
      aHora          = "";
      aCliente       = "";
      aDir           = "";
      aOrigen        = "";
      aDestino       = "";
      aIPRemoto      = "";
      aLinea         = "";
      aCaracter      = "";
      aCarac10       = "";
      aCadena        = "";
      aLongitud      = "";
      aMiCaracter    = "";
      aBasePdf       = "";
      aDirLocal      = "";
      aArchivoPdf    = "";
      aPathReader    = "";
      aEjecutable    = "";
      aWait          = "";
      aFicheroBAT    = "";
      aUnidad        = "";
      aValor         = "";
      aValorE        = "";
      aCampo         = "";
      aDirServ       = "";
      aPais          = "";
      aFichero       = "";
      aFicher        = "";
      aLong          = "";

     &enPanta0       = 0;
     &enPanta1       = 0;
     &enPanta2       = 0;
     &enErrorDoc     = 0;
     &eaAlfa         = "";
     &eaCadena       = "";
     &eaCadena1      = "";
     &eaCadena2      = "";
     &eaCadena3      = "";
     &eaPathAcrobat  = "";
     &enError        = 0;

     {26}aRegistro   = "";
|FIN;

|| ------------------------------------------------------
|| Procesos del Copia del Disquete
|| ------------------------------------------------------

|PROCESO CopiaDisquete;
     |MENAV "0000 Introduzca un disquete formateado y vacio en la disquetera y pulse cualquier tecla para continuar";

     enError = 0;
     aDir    = "A:/*.*";
     |R_PDIR aDir;
     |SI FSalida = 0;
         enError = 1;
         |MENAV "0000 El disquete no esta vacio.";
         |ACABA;
     |FINSI;

     |DBASE aBase;   |QBF aBase;
     aCliente = ("00000" + #1#1) % -105;
     aAlfa = aBase + "documentos";                  |MKDIR aAlfa;
     aAlfa = aAlfa + "/clientes";                   |MKDIR aAlfa;
     aAlfa = aAlfa + "/" + aCliente;                |MKDIR aAlfa;

     aOrigen = aAlfa + "/GPrivado." + (("000" + #9#1) % -103);
     aDestino = "A:/GPrivado.dat";

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aDir = "A:/gprivado.dat";
     |R_PDIR aDir;
     |SI FSalida = 0;
         |MENAV "0000 El disquete se ha copiado satisfactoriamente.";
     |SINO;
         enError = 1;
         |MENAV "0000 No se ha podido copia el disquete.";
     |FINSI;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Certificado
|| ------------------------------------------------------

|PROCESO Certificado;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "dslpw100";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |PARA nCampoD = 0;  |SI nCampoD [ 25;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH      = nCampoD + 5;
           #1000nCampoD = #9nCampoH;
     |SIGUE;

     aAlfa    = #9#22 % 102;  #1000#26 = aAlfa;
     aAlfa    = #9#22 % 303;  #1000#27 = aAlfa;
     #1000#24 = #1000#16;

     aAlfa    = #1000#8;  |QBF aAlfa;
     aAlfa    = aAlfa + " " + #1000#9;   |QBF aAlfa;
     aAlfa    = aAlfa + " " + #1000#10;  |QBF aAlfa;
     #1000#23 = aAlfa;

     |PRINT;
     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|| ------------------------------------------------------
|| Procesos de la Generacion del Soporte
|| ------------------------------------------------------

|PROCESO Registro0;
     eaAlfa = "0";                                 |XGRABA nHandle, eaAlfa;
     eaAlfa = "I";
     |SI #1000#0 = "S";  eaAlfa = "A";  |FINSI;
                                                   |XGRABA nHandle, eaAlfa;

     eaAlfa = "A";
     |SI #1000#4 = "M";  eaAlfa = "M";  |FINSI;
     |SI #1000#4 = "S";  eaAlfa = "S";  |FINSI;
                                                   |XGRABA nHandle, eaAlfa;

     eaAlfa = #1000#7;                             |XGRABA nHandle, eaAlfa;
     eaAlfa = ("000" + #1000#3) % -103;            |XGRABA nHandle, eaAlfa;
     eaAlfa = " " * 16;                            |XGRABA nHandle, eaAlfa;
     eaAlfa = &10;                                 |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO LeePais;
     |ABRE #506;
     #506#0 = aPais;
     |LEE 000#506=;
     |SI FSalida ! 0;
         |DDEFECTO #506;
         #506#0 = "ESPA¥A";
         #506#1 = "ES";
     |FINSI;
     |CIERRA #506;
|FPRC;

|PROCESO ServicioUnidad;
     |SI #5#243 = #5#6;            |ACABA;  |FINSI;
     |SI #5#243 = "            ";  |ACABA;  |FINSI;

     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #5#0;
     #2#1 = #5#243;
     |LEE 000#2=;
     |SI FSalida ! 0;  |CIERRA #2;  |ACABA; |FINSI;
     |CIERRA #2;

     aPais = #2#28;  |HAZ LeePais;

     #1004#15  = #5#244;
     #1004#16  = #5#243;

                            #1004#17  = #2#29 % 103;
     |SI #1004#17 = "   ";  #1004#17  = #1#18 % 103;  |FINSI;

     #1004#18  = #2#3;
     #1004#19  = #2#4;
     #1004#20  = #2#5;
     #1004#21  = #2#7;
     #1004#22  = #2#11;
     #1004#23  = #2#12;
     #1004#24  = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     #1004#25  = #2#13;
     #1004#26  = #2#14;
     #1004#27  = #506#1;
     #1004#28  = #2#15;
|FPRC;

|PROCESO UbicacionPpal;
     |SI #5#245 = #5#6;            |ACABA;  |FINSI;
     |SI #5#245 = "            ";  |ACABA;  |FINSI;

     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #5#0;
     #2#1 = #5#245;
     |LEE 000#2=;
     |SI FSalida ! 0;  |CIERRA #2;  |ACABA; |FINSI;
     |CIERRA #2;

     aPais = #2#28;  |HAZ LeePais;

     #1004#31  = #5#246;
     #1004#32  = #5#245;

                            #1004#33  = #2#29 % 103;
     |SI #1004#33 = "   ";  #1004#33  = #1#18 % 103;  |FINSI;

     #1004#34  = #2#3;
     #1004#35  = #2#4;
     #1004#36  = #2#5;
     #1004#37  = #2#7;
     #1004#38  = #2#11;
     #1004#39  = #2#12;
     #1004#40  = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     #1004#41  = #2#13;
     #1004#42  = #2#14;
     #1004#43  = #506#1;
     #1004#44  = #2#15;
|FPRC;

|PROCESO Encargado;
     |ABRE #dslpm006;
     #dslpm006#0 = #dslpm005#0;
     #dslpm006#1 = #dslpm005#1;
     #dslpm006#2 = #dslpm005#2;
     #dslpm006#3 = "   ";
     |LEE 000#dslpm006.];
     |SI FSalida ! 0; |O #dslpm006#0 ! #dslpm005#0; |O #dslpm006#1 ! #dslpm005#1;
      |O #dslpm006#2 ! #dslpm005#2;
         |DDEFECTO #dslpm006;
     |FINSI;
     |CIERRA #dslpm006;

     #1004#45  = #dslpm006#8;
     #1004#46  = #dslpm006#7;

     |SI #dslpm006#7  = #5#6;            |ACABA;  |FINSI;
     |SI #dslpm006#7  = "            ";
        #1004#45  = #dslpm004#18;
        #1004#46  = #dslpm004#17;
     |FINSI;

     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #5#0;
     #2#1 = #1004#46;
     |LEE 000#2=;
     |SI FSalida ! 0;  |CIERRA #2;  |ACABA; |FINSI;
     |CIERRA #2;

     aPais = #2#28;  |HAZ LeePais;

                            #1004#47  = #2#29 % 103;
     |SI #1004#47 = "   ";  #1004#47  = #1#18 % 103;  |FINSI;

     #1004#48  = #2#3;
     #1004#49  = #2#4;
     #1004#50  = #2#5;
     #1004#51  = #2#7;
     #1004#52  = #2#11;
     #1004#53  = #2#12;
     #1004#54  = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     #1004#55  = #2#13;
     #1004#56  = #2#14;
     #1004#57  = #506#1;
     #1004#58  = #2#15;
|FPRC;

|PROCESO Registro1;
     |DDEFECTO #1004;
     |DDEFECTO #1005;

     |ABRE #4;
     #4#0 = #5#0;
     #4#1 = #5#1;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |ABRE #2;
     |SELECT #1#2;
     #2#0 = #5#0;
     #2#1 = #5#6;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     aPais = #2#28;  |HAZ LeePais;

     |ABRE #504;
     #504#0 = #4#76;
     |LEE 000#504=;
     |SI FSalida ! 0;  |DDEFECTO #504;  |FINSI;
     |CIERRA #504;

     |ABRE #507;
     |SELECT #2#507;
     #507#1 = #1000#12;
     |LEE 000#507=;
     |SI FSalida ! 0;  |DDEFECTO #507;  |FINSI;
     |CIERRA #507;

     |ABRE #12;
     #12#0 = #5#0;
     #12#1 = #5#1;
     #12#2 = #5#2;
     |LEE 000#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     #1004#1   = #5#7;
     #1004#2   = #2#3;
     #1004#3   = #2#4;
     #1004#4   = #2#5;
     #1004#5   = #2#7;
     #1004#6   = #2#11;
     #1004#7   = #2#12;
     #1004#8   = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     #1004#9   = #2#13;
     #1004#10  = #2#14;
     #1004#11  = #2#1;

                            #1004#12  = #2#29 % 103;
     |SI #1004#12 = "   ";  #1004#12  = #1#18 % 103;  |FINSI;

     #1004#13  = #506#1;
     #1004#14  = #2#15;

     |HAZ ServicioUnidad;

     #1004#29  = #5#3;
     #1004#30  = #5#4;

     |HAZ UbicacionPpal;
     |HAZ Encargado;

     aAlfa     = #4#68;  |QBF aAlfa;
     aAlfa     = aAlfa + " " + #4#69;
     #1004#59  = aAlfa;

     |SI #4#70  = "S";  #1004#60 = "X";  |FINSI;
     |SI #4#71  = "S";  #1004#61 = "X";  |FINSI;
     |SI #4#72  = "S";  #1004#62 = "X";  |FINSI;

     #1004#63  = #4#75;

     |SI #504#2 = "1";  #1004#64 = "X";  |FINSI;
     |SI #504#2 = "2";  #1004#65 = "X";  |FINSI;
     |SI #504#2 = "3";  #1004#66 = "X";  |FINSI;

     #1004#67   = #4#78;

     |SI #5#37  = "S";  #1004#68 = "X";  |FINSI;
     |SI #5#38  = "S";  #1004#69 = "X";  |FINSI;
     |SI #5#39  = "S";  #1004#70 = "X";  |FINSI;
     |SI #5#40  = "S";  #1004#71 = "X";  |FINSI;

                        #1004#72 = "";
                        #1004#73 = "";
     |SI #5#41  = "S";  #1004#72 = "S";  |FINSI;
     |SI #5#248 = "S";  #1004#72 = "N";  |FINSI;
     |SI #5#42  = "S";  #1004#73 = "S";  |FINSI;
     |SI #5#249 = "S";  #1004#73 = "N";  |FINSI;

     #1004#74   = "N";

     |SI #5#43  = "S";  #1004#75 = "X";  |FINSI;
     |SI #5#44  = "S";  #1004#76 = "X";  |FINSI;
     |SI #5#45  = "S";  #1004#77 = "X";  |FINSI;

                        #1004#78 = "";
                        #1004#79 = "";
     |SI #5#46  = "S";  #1004#78 = "S";  |FINSI;
     |SI #5#250 = "S";  #1004#78 = "N";  |FINSI;
     |SI #5#47  = "S";  #1004#79 = "S";  |FINSI;
     |SI #5#251 = "S";  #1004#79 = "N";  |FINSI;


     #1004#80   = #5#48;
     #1004#81   = #5#49;

     aAlfa      = #5#50;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#51;
     #1004#82   = aAlfa;

     |SI #5#52  = "S";  #1004#83 = "X";  |FINSI;
     |SI #5#53  = "S";  #1004#84 = "X";  |FINSI;
     |SI #5#54  = "S";  #1004#85 = "X";  |FINSI;
     |SI #5#55  = "S";  #1004#86 = "X";  |FINSI;
     |SI #5#56  = "S";  #1004#87 = "X";  |FINSI;
     |SI #5#57  = "S";  #1004#88 = "X";  |FINSI;
     |SI #5#58  = "S";  #1004#89 = "X";  |FINSI;
     |SI #5#59  = "S";  #1004#90 = "X";  |FINSI;
     |SI #5#60  = "S";  #1004#91 = "X";  |FINSI;
     |SI #5#61  = "S";  #1004#92 = "X";  |FINSI;

     aAlfa      = #5#62;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#63;
     #1004#93   = aAlfa;

     |SI #5#64  = "S";  #1004#94  = "X";  |FINSI;
     |SI #5#65  = "S";  #1004#95  = "X";  |FINSI;
     |SI #5#66  = "S";  #1004#96  = "X";  |FINSI;
     |SI #5#67  = "S";  #1004#97  = "X";  |FINSI;
     |SI #5#68  = "S";  #1004#98  = "X";  |FINSI;
     |SI #5#69  = "S";  #1004#99  = "X";  |FINSI;
     |SI #5#70  = "S";  #1004#100 = "X";  |FINSI;
     |SI #5#71  = "S";  #1004#101 = "X";  |FINSI;
     |SI #5#72  = "S";  #1004#102 = "X";  |FINSI;
     |SI #5#73  = "S";  #1004#103 = "X";  |FINSI;

     aAlfa      = #5#74;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#75;
     #1004#104  = aAlfa;

     |SI #5#76  = "S";  #1004#105 = "X";  |FINSI;
     |SI #5#77  = "S";  #1004#106 = "X";  |FINSI;
     |SI #5#78  = "S";  #1004#107 = "X";  |FINSI;
     |SI #5#79  = "S";  #1004#108 = "X";  |FINSI;
     |SI #5#80  = "S";  #1004#109 = "X";  |FINSI;
     |SI #5#81  = "S";  #1004#110 = "X";  |FINSI;
     |SI #5#82  = "S";  #1004#111 = "X";  |FINSI;

     aAlfa      = #5#83;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#84;
     #1004#112  = aAlfa;

     |SI #5#85  = "S";  #1004#113 = "X";  |FINSI;
     |SI #5#86  = "S";  #1004#114 = "X";  |FINSI;
     |SI #5#87  = "S";  #1004#115 = "X";  |FINSI;
     |SI #5#88  = "S";  #1004#116 = "X";  |FINSI;
     |SI #5#89  = "S";  #1004#117 = "X";  |FINSI;

     aAlfa      = #5#90;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#91;
     #1004#118  = aAlfa;

     |SI #5#92  = "S";  #1004#119 = "X";  |FINSI;
     |SI #5#93  = "S";  #1004#120 = "X";  |FINSI;
     |SI #5#94  = "S";  #1004#121 = "X";  |FINSI;
     |SI #5#95  = "S";  #1004#122 = "X";  |FINSI;
     |SI #5#96  = "S";  #1004#123 = "X";  |FINSI;

     aAlfa      = #5#97;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#98;
     #1004#124  = aAlfa;

     |SI #5#99  = "S";  #1004#125 = "X";  |FINSI;
     |SI #5#100 = "S";  #1004#126 = "X";  |FINSI;
     |SI #5#101 = "S";  #1004#127 = "X";  |FINSI;
     |SI #5#102 = "S";  #1004#128 = "X";  |FINSI;
     |SI #5#103 = "S";  #1004#129 = "X";  |FINSI;

     aAlfa      = #5#104;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#105;
     #1004#130  = aAlfa;

     |SI #5#106 = "S";  #1004#131 = "X";  |FINSI;
     |SI #5#107 = "S";  #1004#132 = "X";  |FINSI;
     |SI #5#108 = "S";  #1004#133 = "X";  |FINSI;
     |SI #5#109 = "S";  #1004#134 = "X";  |FINSI;
     |SI #5#110 = "S";  #1004#135 = "X";  |FINSI;
     |SI #5#111 = "S";  #1004#136 = "X";  |FINSI;
     |SI #5#112 = "S";  #1004#137 = "X";  |FINSI;
     |SI #5#113 = "S";  #1004#138 = "X";  |FINSI;
     |SI #5#114 = "S";  #1004#139 = "X";  |FINSI;
     |SI #5#115 = "S";  #1004#140 = "X";  |FINSI;
     |SI #5#116 = "S";  #1004#141 = "X";  |FINSI;
     |SI #5#117 = "S";  #1004#142 = "X";  |FINSI;
     |SI #5#118 = "S";  #1004#143 = "X";  |FINSI;

     aAlfa      = #5#119;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#120;
     #1004#144  = aAlfa;

     |SI #5#121 = "S";  #1004#145 = "X";  |FINSI;
     |SI #5#122 = "S";  #1004#146 = "X";  |FINSI;
     |SI #5#123 = "S";  #1004#147 = "X";  |FINSI;
     |SI #5#124 = "S";  #1004#148 = "X";  |FINSI;
     |SI #5#125 = "S";  #1004#149 = "X";  |FINSI;

     aAlfa      = #5#126;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#127;
     #1004#150  = aAlfa;

     aAlfa      = #5#128;  |QBF aAlfa;
     |PARA nCampo = 129;  |SI nCampo [ 132;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = aAlfa + " " + #5nCampo;  |QBF aAlfa;
     |SIGUE;
     #1004#151  = aAlfa;

     aAlfa      = #5#133;  |QBF aAlfa;
     |PARA nCampo = 134;  |SI nCampo [ 137;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = aAlfa + " " + #5nCampo;  |QBF aAlfa;
     |SIGUE;
     #1004#152  = aAlfa;

     |PARA nCampoD = 153;  |SI nCampoD [ 201;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 4;
           |SI #5nCampoH = "S";  #1004nCampoD = "X";  |FINSI;
     |SIGUE;

     |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 198;
           |SI #5nCampoH = "S";  #1005nCampoD = "X";  |FINSI;
     |SIGUE;

     |PARA nCampoD = 14;  |SI nCampoD [ 28;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 202;
           |SI #5nCampoH = "S";  #1005nCampoD = "X";  |FINSI;
     |SIGUE;

     aAlfa      = #5#231;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#232;
     #1005#29   = aAlfa;

     |SI #5#233 = "S";  #1005#30  = "X";  |FINSI;
     |SI #5#234 = "S";  #1005#31  = "X";  |FINSI;
     |SI #5#235 = "S";  #1005#32  = "X";  |FINSI;
     |SI #5#236 = "S";  #1005#33  = "X";  |FINSI;

     aAlfa      = #5#237;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #5#238;
     #1005#34   = aAlfa;

                        #1005#35   = "";
                        #1005#36   = "";
                        #1005#37   = "";
                        #1005#38   = "";

     |SI #12#7  = "S";  #1005#35   = "S";  |FINSI;
     |SI #12#68 = "S";  #1005#35   = "N";  |FINSI;
     |SI #12#8  = "S";  #1005#36   = "S";  |FINSI;
     |SI #12#69 = "S";  #1005#36   = "N";  |FINSI;
     |SI #12#9  = "S";  #1005#37   = "S";  |FINSI;
     |SI #12#70 = "S";  #1005#37   = "N";  |FINSI;
     |SI #12#10 = "S";  #1005#38   = "S";  |FINSI;
     |SI #12#71 = "S";  #1005#38   = "N";  |FINSI;

     #1005#39   = #12#11;
     #1005#40   = #12#12;

     aAlfa      = #12#13;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#14;
     #1005#41   = aAlfa;

     #1005#42   = #12#15;
     #1005#43   = #12#16;
     #1005#44   = #12#17;
     #1005#45   = #12#18;
     #1005#46   = #12#19;
     #1005#47   = #12#20;
     #1005#48   = #12#21;
     #1005#49   = #12#22;

     aAlfa      = #12#23;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#24;
     #1005#50   = aAlfa;

     aAlfa      = #12#25;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#26;
     #1005#51   = aAlfa;

                         #1005#52   = "";
                         #1005#53   = "";
                         #1005#54   = "";
                         #1005#55   = "";
                         #1005#56   = "";
                         #1005#57   = "";
                         #1005#58   = "";
                         #1005#59   = "";
                         #1005#60   = "";
                         #1005#61   = "";
                         #1005#62   = "";

     |SI #12#27  = "S";  #1005#52   = "S";  |FINSI;
     |SI #12#72  = "S";  #1005#52   = "N";  |FINSI;
     |SI #12#28  = "S";  #1005#53   = "S";  |FINSI;
     |SI #12#73  = "S";  #1005#53   = "N";  |FINSI;
     |SI #12#29  = "S";  #1005#54   = "S";  |FINSI;
     |SI #12#74  = "S";  #1005#54   = "N";  |FINSI;
     |SI #12#30  = "S";  #1005#55   = "S";  |FINSI;
     |SI #12#75  = "S";  #1005#55   = "N";  |FINSI;
     |SI #12#31  = "S";  #1005#56   = "S";  |FINSI;
     |SI #12#76  = "S";  #1005#56   = "N";  |FINSI;
     |SI #12#32  = "S";  #1005#57   = "S";  |FINSI;
     |SI #12#77  = "S";  #1005#57   = "N";  |FINSI;
     |SI #12#33  = "S";  #1005#58   = "S";  |FINSI;
     |SI #12#78  = "S";  #1005#58   = "N";  |FINSI;
     |SI #12#34  = "S";  #1005#59   = "S";  |FINSI;
     |SI #12#79  = "S";  #1005#59   = "N";  |FINSI;
     |SI #12#35  = "S";  #1005#60   = "S";  |FINSI;
     |SI #12#80  = "S";  #1005#60   = "N";  |FINSI;
     |SI #12#36  = "S";  #1005#61   = "S";  |FINSI;
     |SI #12#81  = "S";  #1005#61   = "N";  |FINSI;
     |SI #12#37  = "S";  #1005#62   = "S";  |FINSI;
     |SI #12#82  = "S";  #1005#62   = "N";  |FINSI;

     #1005#63   = #12#38;
     #1005#64   = #12#39;
     #1005#65   = #12#40;
     #1005#66   = #12#41;
     #1005#67   = #12#42;
     #1005#68   = #12#43;
     #1005#69   = #12#44;
     #1005#70   = #12#45;

     aAlfa      = #12#46;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#47;
     #1005#71   = aAlfa;

     aAlfa      = #12#48;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#49;
     #1005#72   = aAlfa;

     #1005#73   = #12#50;

     aAlfa      = #12#51;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#52;
     #1005#74   = aAlfa;

     aAlfa      = #12#53;  |QBF aAlfa;
     aAlfa      = aAlfa + " " + #12#54;
     #1005#75   = aAlfa;

     |SI #5#247 = "S";
         #1005#76   = #5#6;
         #1005#77   = #5#7;
     |FINSI;

     #1005#78   = #12#55;

     |PARA nCampoD = 79;  |SI nCampoD [ 90;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD - 23;
           |SI #12nCampoH = "S";  #1005nCampoD = "X";  |FINSI;
     |SIGUE;

     |SI #5#247 = "M";
         #1005#91   = #5#6;
         #1005#92   = #5#7;
     |FINSI;

     #1005#93   = #1000#8;
     #1005#94   = #1000#9;
     #1005#95   = #1000#10;
     #1005#96   = #1000#11;
     #1005#97   = #1000#5;
     #1005#98   = #507#0;
     #1005#99   = #1000#13;
     #1005#100  = #1000#14;
     #1005#101  = #1000#15;
     #1005#102  = #1000#16;
     #1005#103  = #1000#18;
     #1005#104  = #1000#17;
     #1005#105  = #1000#20;
     #1005#106  = #1000#21;

     aPais = #1000#19;  |HAZ LeePais;

     #1005#107  = #506#1;
     #1005#108  = #1000#22;

     aAlfa = #5#5;  |QBF aAlfa;
     |SI aAlfa = "BASICO";  #1005#109  = "X";  |FINSI;
     |SI aAlfa = "MEDIO";   #1005#110  = "X";  |FINSI;
     |SI aAlfa = "ALTO";    #1005#111  = "X";  |FINSI;

     #1005#112 = &10;

     |PARA nCampo = 0;  |SI nCampo [ 201;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa      = #1004nCampo;  |HAZ QuitaRaros;
           #1004nCampo = eaAlfa;
           eaAlfa      = #1004nCampo;
           |XGRABA nHandle, eaAlfa;
     |SIGUE;

     |PARA nCampo = 0;  |SI nCampo [ 112;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa      = #1005nCampo;  |HAZ QuitaRaros;
           #1005nCampo = eaAlfa;
           eaAlfa      = #1005nCampo;
           |XGRABA nHandle, eaAlfa;
     |SIGUE;
|FPRC;

|PROCESO dslpw103;
     |SI nSwLectura = 0;
         #1000#3 = #1000#3 + 1;
         #9#4    = #1003#7;
         #1000#4 = #1003#7;
         |ACABA;
     |FINSI;

     |ABRE #5;
     #5#0 = #1003#0;
     #5#1 = #1003#1;
     #5#2 = #1003#2;
     |LEE 101#5=;
     |SI FSalida = 0;
         #5#241 = ~;
         #5#242 = aHora;
         |GRABA 020#5a;
         |LIBERA #5;
     |FINSI;
     |CIERRA #5;

     |HAZ Registro1;

     |BORRA 020#1003a;
     |LIBERA #1003;
|FPRC;

|DEFBUCLE dslpw103;
     #1003#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, dslpw103;
|FIN;

|PROCESO MeteLinea;
     |SI aAux = "";
          aMete = aTab * nTab + "<" + aEtiqueta + "/>";
     |SINO;
          aMete = aTab * nTab + "<" + aEtiqueta + ">" + aAux + "</" + aEtiqueta + ">";
     |FINSI;
     |XGRABA nHandleXML, aMete;
|FPRC;

|PROCESO Tipo12w100;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     #1000#17 = (("00" + #1000#26) % -102) + (("000" + #1000#27) % -103)

     aAlfa = #1000#5;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Puesto desempe¤ado del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#8;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Nombre del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#9;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Primer Apellido del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

/*
     ||Ahora YA no es obligatorio
     aAlfa = #1000#10;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Segundo Apellido del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;
*/

     aAlfa = #1000#11;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el NIF del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#12;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el SG del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#13;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Nombre de la Calle del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#14;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Numero de la Calle del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#17;   |QBF aAlfa;
     |SI aAlfa = "0000";
         |MENAV "0000 Introduzca la Poblacion del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#16;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca la Poblacion del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#18;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca la Provincia del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = #1000#19;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Introduzca el Pais del Declarante.";
         |ERROR;
         |ACABA;
     |FINSI;

     |CONFI "0000SGenerar el documento XML para la AGPD.?";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASE aBase;
     |QBF aBase;
     aPathXML = aBase + "xml/";
     |MKDIR aPathXML;

     aTab = &9;

     fSistema = ~;
     aSistema = fSistema;
     aDia = aSistema % 102;
     aMes = aSistema % 402;
     aAnyo = aSistema % -104;
     |HORA aHoraSis;
     |QBF aHoraSis;
     aHH = aHoraSis % 102;
     aMM = aHoraSis % 402;
     aSS = aHoraSis % -102;

     |ABRE #dslpm001;
     #dslpm001#0 = 41;
     #dslpm001#1 = #1002#0;
     |LEE 000#dslpm001.=;
     |SI FSalida ! 0;
          aMensaje = "0000ERROR: No existe el cliente: " + #1002#0;
          |MENAV aMensaje;
          |ACABA;
     |FINSI;
     |CIERRA #dslpm001;

     aNombreXML = (("00000" + #1002#0) % -105) + (("0000" + #1002#1) % -104) + (("00000" + #1002#2) % -105) + aAnyo + aMes + aDia + ".xml";

     aFicXML = aPathXML + aNombreXML;

     |XABRE "W", aFicXML, nHandleXML;
     |SI FSalida < 0;
          aMensaje = "0000ERROR: Problemas al crear " + aFicXML;
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     aMete = "<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "ISO-8859-1" + &34 + "?>";
     |XGRABA nHandleXML, aMete;

     aMete = "<Envio Id=" + &34 + "AGPD" + &34 + ">"
     |XGRABA nHandleXML, aMete;

     aMete = aTab + "<reg_cero>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<id_rock>0</id_rock>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<ind_titula>2</ind_titula>";
     |XGRABA nHandleXML, aMete;

     ||6. XML sin FIRMAR.   ||5 XML FIRMADO
     aMete = aTab * 2 + "<ind_soporte>6</ind_soporte>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<f_proceso>" + aDia + aMes + aAnyo + "</f_proceso>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<h_proceso>" + aHH + aMM + aSS + "</h_proceso>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<ind_procesado>0</ind_procesado>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab + "</reg_cero>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab + "<reg_uno>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<Control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<id_rock>1</id_rock>";
     |XGRABA nHandleXML, aMete;

     ||Codigo de Forma de cuplimentacion.
     aMete = aTab * 3 + "<forma_c>u</forma_c>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<signatura>Pr000</signatura>";
     |XGRABA nHandleXML, aMete;

     nMes = aMes;
     |SI nMes < 10;
          aFechaHex = aDia + nMes + aAnyo;
     |SINO;
          |SI nMes = 10;
               aFechaHex = aDia + "a" + aAnyo;
          |SINO;
               |SI nMes = 11;
                    aFechaHex = aDia + "b" + aAnyo;
               |SINO;
                    aFechaHex = aDia + "c" + aAnyo;
               |FINSI;
          |FINSI;
     |FINSI;

     aCif = #dslpm001#3;
     |QBF aCif;

     aIdUpload = aCif + aFechaHex + aHH + aMM + aSS;
     aAux = aIdUpload;
     |QBF aAux;
     nTab = 3;
     aEtiqueta = "id_upload";
     |HAZ MeteLinea;

     aMete = aTab * 3 + "<f_web/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<h_web/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<num_reg/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "</Control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<declarante>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<futuro_uso/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<est_err/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<doc_anexa/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "</control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<hoja_solicitud>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<persona_fisica>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm001#2;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "razon_s";
     |HAZ MeteLinea;

     aAux = aCif;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "cif_nif";
     |HAZ MeteLinea;

     aAux = #1000#8;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "nombre";
     |HAZ MeteLinea;

     aAux = #1000#9;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "apellido1";
     |HAZ MeteLinea;

     aAux = #1000#10;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "apellido2";
     |HAZ MeteLinea;

     aAux = #1000#11;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "nif";
     |HAZ MeteLinea;

     ||Cargo
     aAux = #1000#5;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "cargo";
     |HAZ MeteLinea;

     aMete = aTab * 4 + "</persona_fisica>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<direccion_notif>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm001#2;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "denomina_p";
     |HAZ MeteLinea;

     aAux = #dslpm001#4;
     |QBF aAux;
     |SI aAux ! "";
          aAux = aAux + ". " + #dslpm001#5;
     |SINO;
          aAux = #dslpm001#5;
     |FINSI;
     |QBF aAux;

     aBeta = #dslpm001#6;
     |QBF aBeta;
     |SI aBeta ! "";
          aAux = aAux + " " + aBeta;
     |FINSI;

     aBeta = #dslpm001#7;
     |QBF aBeta;
     |SI aBeta ! "";
          aAux = aAux + " " + aBeta;
     |FINSI;

     aBeta = #dslpm001#8;
     |QBF aBeta;
     |SI aBeta ! "";
          aAux = aAux + " " + aBeta;
     |FINSI;

     aBeta = #dslpm001#9;
     |QBF aBeta;
     |SI aBeta ! "";
          aAux = aAux + " " + aBeta;
     |FINSI;
     |QBF aAux;
     aDirPostal = aAux;
     nTab = 5;
     aEtiqueta = "dir_postal";
     |HAZ MeteLinea;

     aAux = "ES";
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "pais";
     |HAZ MeteLinea;

     aAux = ("00" + #dslpm001#10) % -102;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "provincia";
     |HAZ MeteLinea;

     aAux = #dslpm001#12;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "localidad";
     |HAZ MeteLinea;

     aAux = (("00" + #dslpm001#10) % -102) + (("000" + #dslpm001#11) % -103);
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "postal";
     |HAZ MeteLinea;

     aAux = #dslpm001#15 % 109;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "telefono";
     |HAZ MeteLinea;

     aAux = #dslpm001#16 % 109;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "fax";
     |HAZ MeteLinea;

     aAux = #dslpm001#17;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "email";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "<forma>" + 1 + "</forma>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<Id_notific/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<ind_deberes>" + 1 + "</ind_deberes>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "</direccion_notif>";
     |XGRABA nHandleXML, aMete;


     aMete = aTab * 3 + "</hoja_solicitud>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "</declarante>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<declaracion>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<responsable>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<ordinal>01</ordinal>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<est_err/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<texto_libre/>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "</control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<responsable_fichero>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm001#3;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "cif";
     |HAZ MeteLinea;

     aAux = aDirPostal;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "dir_postal";
     |HAZ MeteLinea;

     aAux = (("00" + #dslpm001#10) % -102) + (("000" + #dslpm001#11) % -103);
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "postal";
     |HAZ MeteLinea;

     aAux = #dslpm001#12;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "localidad";
     |HAZ MeteLinea;

     aAux = ("00" + #dslpm001#10) % -102;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "provincia";
     |HAZ MeteLinea;

     aAux = "ES";
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "pais";
     |HAZ MeteLinea;

     aAux = #dslpm001#15 % 109;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "telefono";
     |HAZ MeteLinea;

     aAux = #dslpm001#16 % 109;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "fax";
     |HAZ MeteLinea;

     aAux = #dslpm001#17;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "email";
     |HAZ MeteLinea;

     aAux = #dslpm001#2;
     |QBF aAux;
     nTab = 5;
     aEtiqueta = "n_razon";
     |HAZ MeteLinea;

     |ABRE #dslpm505;
     |DDEFECTO #dslpm505;
     |SELECT #2#dslpm505;
     #dslpm505#1 = #dslpm001#18;
     |LEE 000#dslpm505.=;
     |SI FSalida = 0;
          aAux = #dslpm505#0;
     |SINO;
          aAux = "";
     |FINSI;
     |CIERRA #dslpm505;
     nTab = 5;
     aEtiqueta = "cap";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "tip_admin";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "cod_automia";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "denomina_ente";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "denomina_dirdep";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "denomina_organo";
     |HAZ MeteLinea;

     aMete = aTab * 4 + "</responsable_fichero>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<derecho>";
     |XGRABA nHandleXML, aMete;

     |ABRE #4;
     #4#0 = #1002#0;
     #4#1 = #1002#1;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     aAux = #4#145;
     |QBF aAux;
     |SI aAux = "";
          aAux = "";
          nTab = 5;
          aEtiqueta = "oficina";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "nif_cif";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "dir_postal";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "localidad";
          |HAZ MeteLinea;

          aAux = ;
          nTab = 5;
          aEtiqueta = "postal";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "provincia";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "pais";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "telefono";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "fax";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "email";
          |HAZ MeteLinea;

     |SINO;
          |ABRE #dslpm002;
          |DDEFECTO #dslpm002;
          #dslpm002#0 = #1002#0;
          #dslpm002#1 = #4#145;
          |LEE 000#dslpm002.=;

          aAux = #dslpm002#2;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "oficina";
          |HAZ MeteLinea;

          aAux = #dslpm002#1;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "nif_cif";
          |HAZ MeteLinea;

          aAux = #dslpm002#3;
          |QBF aAux;
          |SI aAux ! "";
               aAux = aAux + ". " + #dslpm002#4;
          |SINO;
               aAux = #dslpm002#4;
          |FINSI;
          |QBF aAux;

          aBeta = #dslpm002#5;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;

          aBeta = #dslpm002#6;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;

          aBeta = #dslpm002#7;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;

          aBeta = #dslpm002#8;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "dir_postal";
          |HAZ MeteLinea;

          aAux = #dslpm002#11;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "localidad";
          |HAZ MeteLinea;

          aAux = (("00" + #dslpm002#9) % -102) + (("000" + #dslpm002#10) % -103);
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "postal";
          |HAZ MeteLinea;

          aAux = #dslpm002#9;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "provincia";
          |HAZ MeteLinea;

          aAux = "ES";
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "pais";
          |HAZ MeteLinea;

          aAux = #dslpm002#13;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "telefono";
          |HAZ MeteLinea;

          aAux = #dslpm002#14;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "fax";
          |HAZ MeteLinea;

          aAux = #dslpm002#15;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "email";
          |HAZ MeteLinea;

          |CIERRA #dslpm002;
     |FINSI;

     aMete = aTab * 4 + "</derecho>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "</responsable>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "<fichero>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<acciones_generales>";
     |XGRABA nHandleXML, aMete;

     aAux = "0001";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "ordinal";
     |HAZ MeteLinea;

     aAux = "1";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "tipo_solicitud";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "est_err";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "doc_anexa";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</acciones_generales>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<acciones_not_alta>";
     |XGRABA nHandleXML, aMete;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "fecha_reg";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "num_reg";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "id_resolucion";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</acciones_not_alta>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<acciones_mod>";
     |XGRABA nHandleXML, aMete;

     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "responsable"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "cif_nif_ant"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "servicio_unidad"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "disposicion"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "iden_finalid"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "encargado"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "estruct_sistema"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "medidas_seg"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "origen"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "trans_inter"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "comunic_ces"; |HAZ MeteLinea;

     aMete = aTab * 5 + "</acciones_mod>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<acciones_supr>";
     |XGRABA nHandleXML, aMete;

     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "motivos"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "destino_previsiones"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 6; aEtiqueta = "cifnif"; |HAZ MeteLinea;

     aMete = aTab * 5 + "</acciones_supr>";
     |XGRABA nHandleXML, aMete;


     aMete = aTab * 4 + "</control>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<dispo_gen_cms>";
     |XGRABA nHandleXML, aMete;

     aAux = ""; |QBF aAux; nTab = 5; aEtiqueta = "cod_boletin"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 5; aEtiqueta = "num_boletin"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 5; aEtiqueta = "fecha"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 5; aEtiqueta = "disposicion"; |HAZ MeteLinea;
     aAux = ""; |QBF aAux; nTab = 5; aEtiqueta = "url"; |HAZ MeteLinea;


     aMete = aTab * 4 + "</dispo_gen_cms>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<encargado>";
     |XGRABA nHandleXML, aMete;

     aAux = #4#17;
     |QBF aAux;
     |SI aAux = "";
          aAux = "";
          nTab = 5;
          aEtiqueta = "n_razon";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "cif_nif";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "dir_postal";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "localidad";
          |HAZ MeteLinea;

          aAux = ;
          nTab = 5;
          aEtiqueta = "postal";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "provincia";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "pais";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "telefono";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "fax";
          |HAZ MeteLinea;

          aAux = "";
          nTab = 5;
          aEtiqueta = "email";
          |HAZ MeteLinea;

     |SINO;
          |ABRE #dslpm002;
          |DDEFECTO #dslpm002;
          #dslpm002#0 = #1002#0;
          #dslpm002#1 = #4#17;
          |LEE 000#dslpm002.=;

          aAux = #dslpm002#2;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "n_razon";
          |HAZ MeteLinea;

          aAux = #dslpm002#1;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "cif_nif";
          |HAZ MeteLinea;

          aAux = #dslpm002#3;
          |QBF aAux;
          |SI aAux ! "";
               aAux = aAux + ". " + #dslpm002#4;
          |SINO;
               aAux = #dslpm002#4;
          |FINSI;
          |QBF aAux;

          aBeta = #dslpm002#5;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;

          aBeta = #dslpm002#6;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;

          aBeta = #dslpm002#7;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;

          aBeta = #dslpm002#8;
          |QBF aBeta;
          |SI aBeta ! "";
               aAux = aAux + " " + aBeta;
          |FINSI;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "dir_postal";
          |HAZ MeteLinea;

          aAux = #dslpm002#11;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "localidad";
          |HAZ MeteLinea;

          aAux = (("00" + #dslpm002#9) % -102) + (("000" + #dslpm002#10) % -103);
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "postal";
          |HAZ MeteLinea;

          aAux = #dslpm002#9;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "provincia";
          |HAZ MeteLinea;

          aAux = "ES";
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "pais";
          |HAZ MeteLinea;

          aAux = #dslpm002#13;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "telefono";
          |HAZ MeteLinea;

          aAux = #dslpm002#14;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "fax";
          |HAZ MeteLinea;

          aAux = #dslpm002#15;
          |QBF aAux;
          nTab = 5;
          aEtiqueta = "email";
          |HAZ MeteLinea;

          |CIERRA #dslpm002;
     |FINSI;

     aMete = aTab * 4 + "</encargado>";
     |XGRABA nHandleXML, aMete;


     aMete = aTab * 4 + "<identifica_finalidad>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<denominacion>";
     |XGRABA nHandleXML, aMete;

     |ABRE #dslpm005;
     |DDEFECTO #dslpm005;
     #dslpm005#0 = #1002#0;
     #dslpm005#1 = #1002#1;
     #dslpm005#2 = #1002#2;
     |LEE 000#dslpm005.=;
     |CIERRA #dslpm005;

     aAux = #dslpm005#3;
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "fichero";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "c_inscripcion";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "c_inscrip_t";
     |HAZ MeteLinea;

     aAux = "";
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "f_inscrip";
     |HAZ MeteLinea;

     aAux = #dslpm005#128;
     |QBF aAux;
     aFinalidad = aAux;
     aAux = #dslpm005#129;
     |QBF aAux;
     |SI aAux ! "";
          aFinalidad = aFinalidad + " " + aAux;
     |FINSI;
     aAux = #dslpm005#130;
     |QBF aAux;
     |SI aAux ! "";
          aFinalidad = aFinalidad + " " + aAux;
     |FINSI;
     aAux = #dslpm005#131;
     |QBF aAux;
     |SI aAux ! "";
          aFinalidad = aFinalidad + " " + aAux;
     |FINSI;
     aAux = #dslpm005#132;
     |QBF aAux;
     |SI aAux ! "";
          aFinalidad = aFinalidad + " " + aAux;
     |FINSI;
     aAux = #dslpm005#133;
     |QBF aAux;
     |SI aAux ! "";
          aFinalidad = aFinalidad + " " + aAux;
     |FINSI;
     aAux = aFinalidad;
     |QBF aAux;
     nTab = 6;
     aEtiqueta = "desc_fin_usos";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</denominacion>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<tipificacion>";
     |XGRABA nHandleXML, aMete;

     aSaca = "";
     |HAZ SacaFinalidades;
     aAux = aSaca;
     nTab = 6;
     aEtiqueta = "finalidades";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</tipificacion>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "</identifica_finalidad>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<procedencia>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<origen>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm005#216; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "indica_inte";
     |HAZ MeteLinea;

     aAux = #dslpm005#217; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "indica_otras";
     |HAZ MeteLinea;

     aAux = #dslpm005#218; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "indic_fap";
     |HAZ MeteLinea;

     aAux = #dslpm005#224; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "indic_rp";
     |HAZ MeteLinea;

     aAux = #dslpm005#225; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "indic_ep";
     |HAZ MeteLinea;

     aAux = #dslpm005#226; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "indic_ap";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</origen>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<colectivos_categ>";
     |XGRABA nHandleXML, aMete;

     aSaca = "";
     |HAZ SacaColectivos;
     aAux = aSaca;
     nTab = 6;
     aEtiqueta = "colectivos";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 6;
     aEtiqueta = "otro_col";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</colectivos_categ>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "</procedencia>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<medidas_seg>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm005#5;
     |QBF aAux;
     |SI aAux = "A"; |O aAux = "";
          aAux = "3";
     |SINO;
          |SI aAux = "M";
               aAux = "2";
          |SINO;
               aAux = "1";
          |FINSI;
     |FINSI;
     nTab = 5;
     aEtiqueta = "nivel";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "f_audit";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "t_audit";
     |HAZ MeteLinea;

     aMete = aTab * 4 + "</medidas_seg>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<estructura>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<datos_esp_proteg>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm005#37; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_ide";
     |HAZ MeteLinea;

     aAux = #dslpm005#38; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_as";
     |HAZ MeteLinea;

     aAux = #dslpm005#39; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_r";
     |HAZ MeteLinea;

     aAux = #dslpm005#40; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_c";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</datos_esp_proteg>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<otros_esp_proteg>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm005#43; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_re";
     |HAZ MeteLinea;

     aAux = #dslpm005#44; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_sal";
     |HAZ MeteLinea;

     aAux = #dslpm005#45; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_sexo";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</otros_esp_proteg>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<infracciones_penal>";
     |XGRABA nHandleXML, aMete;

     aAux = "";
     nTab = 6;
     aEtiqueta = "ind_ipen";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 6;
     aEtiqueta = "ind_iad";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</infracciones_penal>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<identificativos>";
     |XGRABA nHandleXML, aMete;

     aAux = #dslpm005#52; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_nif";
     |HAZ MeteLinea;

     aAux = #dslpm005#53; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_ss";
     |HAZ MeteLinea;

     aAux = #dslpm005#54; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_n_a";
     |HAZ MeteLinea;

     aAux = #dslpm005#147; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_ts";
     |HAZ MeteLinea;


     aAux = #dslpm005#55; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_dir";
     |HAZ MeteLinea;

     aAux = #dslpm005#56; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_tel";
     |HAZ MeteLinea;

     aAux = #dslpm005#146; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_huella";
     |HAZ MeteLinea;

     aAux = #dslpm005#58; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_img";
     |HAZ MeteLinea;

     aAux = #dslpm005#59; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_marcas";
     |HAZ MeteLinea;

     aAux = #dslpm005#60; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_firma";
     |HAZ MeteLinea;

     aAux = #dslpm005#148; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_registro";
     |HAZ MeteLinea;

     aAux = #dslpm005#57; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_firmaManual";
     |HAZ MeteLinea;

     aAux = #dslpm005#136; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = "1";
     |SINO;
          aAux = "0";
     |FINSI;
     nTab = 6;
     aEtiqueta = "ind_biometricos";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 6;
     aEtiqueta = "ODCI";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</identificativos>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<otros>";
     |XGRABA nHandleXML, aMete;

     aSaca = "";
     |HAZ SacaOtros;
     aAux = aSaca;
     nTab = 6;
     aEtiqueta = "otros_tipos";
     |HAZ MeteLinea;

     aAux = #dslpm005#73; |QBF aAux;
     |SI aAux = "S"; |O aAux = "s";
          aAux = #dslpm005#74;
          |QBF aAux;
          |SI aAux = "";
               aAux = #dslpm005#75;
          |SINO;
               aAux = aAux + " " + #dslpm005#75;
          |FINSI;
          |QBF aAux;
     |SINO;
          aAux = "";
     |FINSI;
     nTab = 6;
     aEtiqueta = "desc_otros_tipos";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</otros>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 5 + "<sist_tratamiento>";
     |XGRABA nHandleXML, aMete;

     aAux = "1";
     nTab = 6;
     aEtiqueta = "sis_trata";
     |HAZ MeteLinea;

     aMete = aTab * 5 + "</sist_tratamiento>";
     |XGRABA nHandleXML, aMete;


     aMete = aTab * 4 + "</estructura>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<cesion>";
     |XGRABA nHandleXML, aMete;

     aSaca = "";
     |HAZ SacaCesiones;
     aAux = aSaca;
     nTab = 5;
     aEtiqueta = "cesiones";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "desc_otros";
     |HAZ MeteLinea;

     aMete = aTab * 4 + "</cesion>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 4 + "<transfer_inter>";
     |XGRABA nHandleXML, aMete;

     aSaca = "";
     aSaca2 = "";
     |HAZ SacaTrasferencias;
     aAux = aSaca;
     nTab = 5;
     aEtiqueta = "pais";
     |HAZ MeteLinea;
     aAux = aSaca2;
     nTab = 5;
     aEtiqueta = "categoria";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 5;
     aEtiqueta = "otros";
     |HAZ MeteLinea;

     aMete = aTab * 4 + "</transfer_inter>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 3 + "</fichero>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "</declaracion>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab * 2 + "<final>";
     |XGRABA nHandleXML, aMete;

     aAux = "";
     nTab = 3;
     aEtiqueta = "contador";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 3;
     aEtiqueta = "tot_altas";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 3;
     aEtiqueta = "tot_modif";
     |HAZ MeteLinea;

     aAux = "";
     nTab = 3;
     aEtiqueta = "tot_bajas";
     |HAZ MeteLinea;

     aMete = aTab * 2 + "</final>";
     |XGRABA nHandleXML, aMete;

     aMete = aTab + "</reg_uno>";
     |XGRABA nHandleXML, aMete;

     aMete = "</Envio>"
     |XGRABA nHandleXML, aMete;

     |XCIERRA nHandleXML;

     |ESPECIFICA "RBASS", aLocal;
     aPathLocal = aLocal;
     |QBF aPathLocal;

     aPathLocal = aPathLocal + "xml/";
     |RMKDIR aPathLocal;

     aOrigen = aFicXML;
     aDestino = aPathLocal + aNombreXML;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aIPRemoto ! "";
          |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
          |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aMensaje = "0000Documento XML generado. Ubicacion:" + &13 + aPathLocal + &13 + aNombreXML;
     |MENAV aMensaje;

/*

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |HORA aHora;

     |DBASE aBase;   |QBF aBase;
     aCliente = ("00000" + #1#1) % -105;
     aAlfa = aBase + "documentos";                  |MKDIR aAlfa;
     aAlfa = aAlfa + "/clientes";                   |MKDIR aAlfa;
     aAlfa = aAlfa + "/" + aCliente;                |MKDIR aAlfa;

     aAbre = aAlfa + "/GPrivado." + (("000" + nEnvio) % -103);
     |XABRE "BW", aAbre, nHandle;
     |SI FSalida ] 0;
         |HAZ Registro0;

         nSwLectura = 1;
         |BUCLE dslpw103;
     |FINSI;
     |XCIERRA nHandle;

     |DDEFECTO #9;
     #9#0  = #1#1;
     #9#1  = nEnvio;
     #9#2  = "Envio " + (("000" + #9#1) % -103)
     #9#3  = ~;
     #9#4  = aHora;

     #1000#6  = #1#2;
     #1000#7  = #1#3;
     #1000#24 = #1000#16;
     aAlfa    = #1000#8;  |QBF aAlfa;
     aAlfa    = aAlfa + " " + #1000#9;   |QBF aAlfa;
     aAlfa    = aAlfa + " " + #1000#10;  |QBF aAlfa;
     #1000#23 = aAlfa;

     |PARA nCampoD = 0;  |SI nCampoD [ 25;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 5;
           #9nCampoH = #1000nCampoD;
     |SIGUE;

     |GRABA 020#9n;
     |LIBERA #9;

*/
|FPRC;

|PROCESO dslpm013;
     aAux = ("000" + #dslpm013#3) % -103;

     |SI aSaca = "";
          aSaca = aAux;
     |SINO;
          aSaca = aSaca + ";" + aAux;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm013;
 #dslpm013#1;
 ;
 #1002#0, #1002#1, #1002#2, 000;
 #1002#0, #1002#1, #1002#2, 999;
 ;
 NULL, dslpm013;
|FIN;

|PROCESO SacaFinalidades;
     |BUCLE dslpm013;
|FPRC;

|PROCESO dslpm014;
     aAux = ("00" + #dslpm014#3) % -102;

     |SI aSaca = "";
          aSaca = aAux;
     |SINO;
          aSaca = aSaca + ";" + aAux;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm014;
 #dslpm014#1;
 ;
 #1002#0, #1002#1, #1002#2, 00;
 #1002#0, #1002#1, #1002#2, 99;
 ;
 NULL, dslpm014;
|FIN;

|PROCESO SacaColectivos;
     |BUCLE dslpm014;
|FPRC;

|PROCESO dslpm015;
     aAux = ("00" + #dslpm015#3) % -102;

     |SI aSaca = "";
          aSaca = aAux;
     |SINO;
          aSaca = aSaca + ";" + aAux;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm015;
 #dslpm015#1;
 ;
 #1002#0, #1002#1, #1002#2, 00;
 #1002#0, #1002#1, #1002#2, 99;
 ;
 NULL, dslpm015;
|FIN;

|PROCESO SacaOtros;
     |BUCLE dslpm015;
|FPRC;

|PROCESO dslpm016;
     aAux = ("00" + #dslpm016#3) % -102;

     |SI aSaca = "";
          aSaca = aAux;
     |SINO;
          aSaca = aSaca + ";" + aAux;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm016;
 #dslpm016#1;
 ;
 #1002#0, #1002#1, #1002#2, 00;
 #1002#0, #1002#1, #1002#2, 99;
 ;
 NULL, dslpm016;
|FIN;

|PROCESO SacaCesiones;
     |BUCLE dslpm016;
|FPRC;

|PROCESO dslpm017;
     aAux = #dslpm017#3;
     |QBF aAux;
     |SI aSaca = "";
          aSaca = aAux;
     |SINO;
          aSaca = aSaca + ";" + aAux;
     |FINSI;


     aAux = ("00" + #dslpm017#5) % -102;

     |SI aSaca2 = "";
          aSaca2 = aAux;
     |SINO;
          aSaca2 = aSaca2 + ";" + aAux;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm017;
 #dslpm017#1;
 ;
 #1002#0, #1002#1, #1002#2, "  ", 00;
 #1002#0, #1002#1, #1002#2, "zz", 99;
 ;
 NULL, dslpm017;
|FIN;

|PROCESO SacaTrasferencias;
     |BUCLE dslpm017;
|FPRC;


|PROCESO Evento507;
     |SI FSalida = 1;
         |LEE 000#507c;
     |FINSI;

     |SI FSalida = 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Boton1;
     nRango = 4 + 8 + 16;
     nPos1  = 0630;
     nPos2  = 2060;

     |ABRE #507;
     |SELECT #2#507;
     #507#1 = #1000#12;
     |LEE 000#507=;

     |LINEAL_SIMPLE #2#507, nRango, nPos1, nPos2, NULL, NULL, Evento507;

     #1000#12 = #507#1;
     |PINTA #1000#12;
     |CIERRA #507;
|FPRC;

|PROCESO Evento506;
     |SI FSalida = 1;
         |LEE 000#506c;
     |FINSI;

     |SI FSalida = 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Boton2;
     nRango = 4 + 8 + 16;
     nPos1  = 0630;
     nPos2  = 2050;

     |ABRE #506;
     #506#0 = #1000#19;
     |LEE 000#506=;

     |LINEAL_SIMPLE #1#506, nRango, nPos1, nPos2, NULL, NULL, Evento506;

     #1000#19 = #506#0;
     |PINTA #1000#19;
     |CIERRA #506;
|FPRC;

|PROCESO Soporte;
     nIdSalir = 0;
     InNivel   = nNivel1<-;
     nNivel1   = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;

     nIdSalir = nNivel2;
     |ESTADO_CONTROL nIdSalir, "HIDE";

     |VENTANA 1001, 2799, -1, -1, "";
     nVentana = FSalida;

     |DDEFECTO #9;

     |ABRE #2;
     |SELECT #2#2;
     #2#33 = "S";
     #2#0  = #0#0;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     eaCadena = #2#2;
     |QBF eaCadena;
     |HAZ SeparaNombre;

     #9#10 = "Gerente";
     #9#14 = eaCadena1;
     #9#15 = eaCadena2;
     #9#13 = eaCadena3;
     #9#16 = #2#1;

     |ABRE #507;
     |SELECT #1#507;
     #507#0 = #2#3;
     |LEE 000#507=;
     |SI FSalida ! 0;  |DDEFECTO #507;  |FINSI;
     |CIERRA #507;

     #9#17 = #507#1;
     #9#18 = #2#4;
     #9#19 = #2#5;
     #9#20 = #2#7;
     #9#21 = #2#11;
     #9#22 = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     #9#23 = #2#12;
     #9#24 = #2#28;
     #9#25 = #2#13;
     #9#26 = #2#14;
     #9#27 = #2#15;

     |PARA nCampoD = 0;  |SI nCampoD [ 25;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH = nCampoD + 5;
           #1000nCampoD = #9nCampoH;
     |SIGUE;

     aAlfa    = #9#22 % 102;  #1000#26 = aAlfa;
     aAlfa    = #9#22 % 303;  #1000#27 = aAlfa;

     #1000#3  = 0;
     #1000#25 = ~;

/*
     nSwLectura = 0;
     |BUCLE dslpw103;

     |BORRA_HIJOS_PAN #2#0;
     |SUB_PINPA #0#1000, enPanta2;
     nPanta = FSalida;
*/

     |PINPA #0#1000;
     nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{155}}", 1727, 1729, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{155}}", 1925, 1927, Boton2;
     nBoton2 = FSalida;

     |PINDA #0#1000;
     |ENDATOS #1#1000;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;

/*
     |BORRA_HIJOS_PAN #2#0;
     |PULSATECLA;
*/
     |FINVENTANA nVentana;

     |ESTADO_CONTROL nIdSalir, "SHOW";
|FPRC;

||--------------------------------------------------------------------------
|| ENCUESTA
||--------------------------------------------------------------------------

|PROCESO Cabecera;
     aLinea = "%FDF-1.2";       |XGRABA nHandle, aLinea;
     aLinea = "%âãÏÓ";          |XGRABA nHandle, aLinea;
     aLinea = "1 0 obj";        |XGRABA nHandle, aLinea;
     aLinea = "<< /FDF ";       |XGRABA nHandle, aLinea;
     aLinea = "<< /Fields [ ";  |XGRABA nHandle, aLinea;
|FPRC;

|PROCESO GrabaLineas;
     |QBF aValor;
     |SI aValor = "";  |ACABA;  |FINSI;

     eaAlfa = "<< /V (" + aValor + ")/T (" + aCampo + ")>> ";
     |HAZ QuitaRaros;
     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO GrabaLineasE;
     |QBF aValor;
     |SI aValor = "";  |ACABA;  |FINSI;

     eaAlfa = "<< /V (" + aValor;                    |HAZ QuitaRaros;
     |XGRABA nHandle, eaAlfa;

     eaAlfa = aValorE;                               |HAZ QuitaRaros;
     |XGRABA nHandle, eaAlfa;

     eaAlfa = ")/T (" + aCampo + ")>> ";             |HAZ QuitaRaros;
     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO Lineas;
     aCampo = "0_0";   aValor = #1#3;       |HAZ GrabaLineas;
     aCampo = "1_1";   aValor = #1004#1;    |HAZ GrabaLineas;
     aCampo = "1_2";   aValor = #1004#11;   |HAZ GrabaLineas;
     aCampo = "1_3";   aValor = #1004#12;   |HAZ GrabaLineas;

     |ABRE #507;
     |SELECT #1#507;
     #507#0 = #1004#2;
     |LEE 000#507=;
     |SI FSalida ! 0;  |DDEFECTO #507;  |FINSI;
     |CIERRA #507;

     aCampo = "1_4";   aValor = #507#1;    |HAZ GrabaLineas;
     aCampo = "1_5";   aValor = #1004#3;    |HAZ GrabaLineas;
     aCampo = "1_6";   aValor = #1004#4;    |HAZ GrabaLineas;
     aCampo = "1_7";   aValor = #1004#5;    |HAZ GrabaLineas;
     aCampo = "1_8";   aValor = #1004#6;    |HAZ GrabaLineas;
     aCampo = "1_9";   aValor = #1004#8;    |HAZ GrabaLineas;
     aCampo = "1_10";  aValor = #1004#7;    |HAZ GrabaLineas;

     |ABRE #506;
     |SELECT #2#506;
     #506#1 = #1004#13;
     |LEE 000#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;
     |CIERRA #506;

     aCampo = "1_11";  aValor = #506#0;     |HAZ GrabaLineas;
     aCampo = "1_12";  aValor = #1004#9;    |HAZ GrabaLineas;
     aCampo = "1_13";  aValor = #1004#10;   |HAZ GrabaLineas;
     aCampo = "1_14";  aValor = #1004#14;   |HAZ GrabaLineas;

     aCampo = "2_1";   aValor = #1004#15;   |HAZ GrabaLineas;
     aCampo = "2_2";   aValor = #1004#16;   |HAZ GrabaLineas;
     aCampo = "2_3";   aValor = #1004#17;   |HAZ GrabaLineas;

     |ABRE #507;
     |SELECT #1#507;
     #507#0 = #1004#18;
     |LEE 000#507=;
     |SI FSalida ! 0;  |DDEFECTO #507;  |FINSI;
     |CIERRA #507;

     aCampo = "2_4";   aValor = #507#1;    |HAZ GrabaLineas;
     aCampo = "2_5";   aValor = #1004#19;   |HAZ GrabaLineas;
     aCampo = "2_6";   aValor = #1004#20;   |HAZ GrabaLineas;
     aCampo = "2_7";   aValor = #1004#21;   |HAZ GrabaLineas;
     aCampo = "2_8";   aValor = #1004#22;   |HAZ GrabaLineas;
     aCampo = "2_9";   aValor = #1004#24;   |HAZ GrabaLineas;
     aCampo = "2_10";  aValor = #1004#23;   |HAZ GrabaLineas;

     |ABRE #506;
     |SELECT #2#506;
     #506#1 = #1004#27;
     |LEE 000#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;
     |CIERRA #506;

     aCampo = "2_11";  aValor = #506#0;     |HAZ GrabaLineas;
     aCampo = "2_12";  aValor = #1004#25;   |HAZ GrabaLineas;
     aCampo = "2_13";  aValor = #1004#26;   |HAZ GrabaLineas;
     aCampo = "2_14";  aValor = #1004#28;   |HAZ GrabaLineas;

     aCampo = "3_1";   aValor = #1004#29;   |HAZ GrabaLineas;
     aCampo = "3_2";   aValor = #1004#30;   |HAZ GrabaLineas;

     aCampo = "4_1";   aValor = #1004#31;   |HAZ GrabaLineas;
     aCampo = "4_2";   aValor = #1004#32;   |HAZ GrabaLineas;
     aCampo = "4_3";   aValor = #1004#33;   |HAZ GrabaLineas;

     |ABRE #507;
     |SELECT #1#507;
     #507#0 = #1004#34;
     |LEE 000#507=;
     |SI FSalida ! 0;  |DDEFECTO #507;  |FINSI;
     |CIERRA #507;

     aCampo = "4_4";   aValor = #507#1;    |HAZ GrabaLineas;
     aCampo = "4_5";   aValor = #1004#35;   |HAZ GrabaLineas;
     aCampo = "4_6";   aValor = #1004#36;   |HAZ GrabaLineas;
     aCampo = "4_7";   aValor = #1004#37;   |HAZ GrabaLineas;
     aCampo = "4_8";   aValor = #1004#38;   |HAZ GrabaLineas;
     aCampo = "4_9";   aValor = #1004#40;   |HAZ GrabaLineas;
     aCampo = "4_10";  aValor = #1004#39;   |HAZ GrabaLineas;

     |ABRE #506;
     |SELECT #2#506;
     #506#1 = #1004#43;
     |LEE 000#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;
     |CIERRA #506;

     aCampo = "4_11";  aValor = #506#0;     |HAZ GrabaLineas;
     aCampo = "4_12";  aValor = #1004#41;   |HAZ GrabaLineas;
     aCampo = "4_13";  aValor = #1004#42;   |HAZ GrabaLineas;
     aCampo = "4_14";  aValor = #1004#44;   |HAZ GrabaLineas;

     aCampo = "5_1";   aValor = #1004#45;   |HAZ GrabaLineas;
     aCampo = "5_2";   aValor = #1004#46;   |HAZ GrabaLineas;
     aCampo = "5_3";   aValor = #1004#47;   |HAZ GrabaLineas;

     |ABRE #507;
     |SELECT #1#507;
     #507#0 = #1004#48;
     |LEE 000#507=;
     |SI FSalida ! 0;  |DDEFECTO #507;  |FINSI;
     |CIERRA #507;

     aCampo = "5_4";   aValor = #507#1;     |HAZ GrabaLineas;
     aCampo = "5_5";   aValor = #1004#49;   |HAZ GrabaLineas;
     aCampo = "5_6";   aValor = #1004#50;   |HAZ GrabaLineas;
     aCampo = "5_7";   aValor = #1004#51;   |HAZ GrabaLineas;
     aCampo = "5_8";   aValor = #1004#52;   |HAZ GrabaLineas;
     aCampo = "5_9";   aValor = #1004#54;   |HAZ GrabaLineas;
     aCampo = "5_10";  aValor = #1004#53;   |HAZ GrabaLineas;

     |ABRE #506;
     |SELECT #2#506;
     #506#1 = #1004#57;
     |LEE 000#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;
     |CIERRA #506;

     aCampo = "5_11";  aValor = #506#0;     |HAZ GrabaLineas;
     aCampo = "5_12";  aValor = #1004#55;   |HAZ GrabaLineas;
     aCampo = "5_13";  aValor = #1004#56;   |HAZ GrabaLineas;
     aCampo = "5_14";  aValor = #1004#58;   |HAZ GrabaLineas;

     aCampo = "6_1";   aValor = #1004#59;   |HAZ GrabaLineas;
     aCampo = "6_2";   aValor = #1004#60;   |HAZ GrabaLineas;
     aCampo = "6_3";   aValor = #1004#61;   |HAZ GrabaLineas;
     aCampo = "6_4";   aValor = #1004#62;   |HAZ GrabaLineas;

     |SI #1004#63 = "N";
         aCampo = "6_5";   aValor = "X";   |HAZ GrabaLineas;
     |FINSI;

     |SI #1004#63 = "S";
         aCampo = "6_6";   aValor = "X";   |HAZ GrabaLineas;
     |FINSI;

     aCampo = "6_7";   aValor = #1004#64;   |HAZ GrabaLineas;
     aCampo = "6_8";   aValor = #1004#65;   |HAZ GrabaLineas;
     aCampo = "6_9";   aValor = #1004#66;   |HAZ GrabaLineas;
     aCampo = "6_10";  aValor = #1004#67;   |HAZ GrabaLineas;

     aCampo = "7_1";   aValor = #1005#109;  |HAZ GrabaLineas;
     aCampo = "7_2";   aValor = #1005#110;  |HAZ GrabaLineas;
     aCampo = "7_3";   aValor = #1005#111;  |HAZ GrabaLineas;

     aCampo = "8_1";   aValor = #1004#68;   |HAZ GrabaLineas;
     aCampo = "8_2";   aValor = #1004#69;   |HAZ GrabaLineas;
     aCampo = "8_3";   aValor = #1004#70;   |HAZ GrabaLineas;
     aCampo = "8_4";   aValor = #1004#71;   |HAZ GrabaLineas;

     |SI #1004#72 = "S";  aCampo = "8_5";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1004#72 = "N";  aCampo = "8_6";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1004#73 = "S";  aCampo = "8_7";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1004#73 = "N";  aCampo = "8_8";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;

     aCampo = "8_9";   aValor = #1004#75;   |HAZ GrabaLineas;
     aCampo = "8_10";  aValor = #1004#76;   |HAZ GrabaLineas;
     aCampo = "8_11";  aValor = #1004#77;   |HAZ GrabaLineas;

     |SI #1004#78 = "S";  aCampo = "8_12";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1004#78 = "N";  aCampo = "8_13";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1004#79 = "S";  aCampo = "8_14";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1004#79 = "N";  aCampo = "8_15";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;

     aCampo = "8_16";  aValor = #1004#80;   |HAZ GrabaLineas;
     aCampo = "8_17";  aValor = #1004#81;   |HAZ GrabaLineas;
     aCampo = "8_18";  aValor = #1004#82;   |HAZ GrabaLineas;
     aCampo = "8_19";  aValor = #1004#83;   |HAZ GrabaLineas;
     aCampo = "8_20";  aValor = #1004#84;   |HAZ GrabaLineas;
     aCampo = "8_21";  aValor = #1004#85;   |HAZ GrabaLineas;
     aCampo = "8_22";  aValor = #1004#86;   |HAZ GrabaLineas;
     aCampo = "8_23";  aValor = #1004#87;   |HAZ GrabaLineas;
     aCampo = "8_24";  aValor = #1004#88;   |HAZ GrabaLineas;
     aCampo = "8_25";  aValor = #1004#89;   |HAZ GrabaLineas;
     aCampo = "8_26";  aValor = #1004#90;   |HAZ GrabaLineas;
     aCampo = "8_27";  aValor = #1004#91;   |HAZ GrabaLineas;
     aCampo = "8_28";  aValor = #1004#92;   |HAZ GrabaLineas;
     aCampo = "8_29";  aValor = #1004#93;   |HAZ GrabaLineas;
     aCampo = "8_30";  aValor = #1004#94;   |HAZ GrabaLineas;
     aCampo = "8_31";  aValor = #1004#95;   |HAZ GrabaLineas;
     aCampo = "8_32";  aValor = #1004#96;   |HAZ GrabaLineas;
     aCampo = "8_33";  aValor = #1004#97;   |HAZ GrabaLineas;
     aCampo = "8_34";  aValor = #1004#98;   |HAZ GrabaLineas;
     aCampo = "8_35";  aValor = #1004#99;   |HAZ GrabaLineas;
     aCampo = "8_36";  aValor = #1004#100;  |HAZ GrabaLineas;
     aCampo = "8_37";  aValor = #1004#101;  |HAZ GrabaLineas;
     aCampo = "8_38";  aValor = #1004#102;  |HAZ GrabaLineas;
     aCampo = "8_39";  aValor = #1004#103;  |HAZ GrabaLineas;
     aCampo = "8_40";  aValor = #1004#104;  |HAZ GrabaLineas;
     aCampo = "8_41";  aValor = #1004#105;  |HAZ GrabaLineas;
     aCampo = "8_42";  aValor = #1004#106;  |HAZ GrabaLineas;
     aCampo = "8_43";  aValor = #1004#107;  |HAZ GrabaLineas;
     aCampo = "8_44";  aValor = #1004#108;  |HAZ GrabaLineas;
     aCampo = "8_45";  aValor = #1004#109;  |HAZ GrabaLineas;
     aCampo = "8_46";  aValor = #1004#110;  |HAZ GrabaLineas;
     aCampo = "8_47";  aValor = #1004#111;  |HAZ GrabaLineas;
     aCampo = "8_48";  aValor = #1004#112;  |HAZ GrabaLineas;
     aCampo = "8_49";  aValor = #1004#113;  |HAZ GrabaLineas;
     aCampo = "8_50";  aValor = #1004#114;  |HAZ GrabaLineas;
     aCampo = "8_51";  aValor = #1004#115;  |HAZ GrabaLineas;
     aCampo = "8_52";  aValor = #1004#116;  |HAZ GrabaLineas;
     aCampo = "8_53";  aValor = #1004#117;  |HAZ GrabaLineas;
     aCampo = "8_54";  aValor = #1004#118;  |HAZ GrabaLineas;
     aCampo = "8_55";  aValor = #1004#119;  |HAZ GrabaLineas;
     aCampo = "8_56";  aValor = #1004#120;  |HAZ GrabaLineas;
     aCampo = "8_57";  aValor = #1004#121;  |HAZ GrabaLineas;
     aCampo = "8_58";  aValor = #1004#122;  |HAZ GrabaLineas;
     aCampo = "8_59";  aValor = #1004#123;  |HAZ GrabaLineas;
     aCampo = "8_60";  aValor = #1004#124;  |HAZ GrabaLineas;
     aCampo = "8_61";  aValor = #1004#125;  |HAZ GrabaLineas;
     aCampo = "8_62";  aValor = #1004#126;  |HAZ GrabaLineas;
     aCampo = "8_63";  aValor = #1004#127;  |HAZ GrabaLineas;
     aCampo = "8_64";  aValor = #1004#128;  |HAZ GrabaLineas;
     aCampo = "8_65";  aValor = #1004#129;  |HAZ GrabaLineas;
     aCampo = "8_66";  aValor = #1004#130;  |HAZ GrabaLineas;
     aCampo = "8_67";  aValor = #1004#131;  |HAZ GrabaLineas;
     aCampo = "8_68";  aValor = #1004#132;  |HAZ GrabaLineas;
     aCampo = "8_69";  aValor = #1004#133;  |HAZ GrabaLineas;
     aCampo = "8_70";  aValor = #1004#134;  |HAZ GrabaLineas;
     aCampo = "8_71";  aValor = #1004#135;  |HAZ GrabaLineas;
     aCampo = "8_72";  aValor = #1004#136;  |HAZ GrabaLineas;
     aCampo = "8_73";  aValor = #1004#137;  |HAZ GrabaLineas;
     aCampo = "8_74";  aValor = #1004#138;  |HAZ GrabaLineas;
     aCampo = "8_75";  aValor = #1004#139;  |HAZ GrabaLineas;
     aCampo = "8_76";  aValor = #1004#140;  |HAZ GrabaLineas;
     aCampo = "8_77";  aValor = #1004#141;  |HAZ GrabaLineas;
     aCampo = "8_78";  aValor = #1004#142;  |HAZ GrabaLineas;
     aCampo = "8_79";  aValor = #1004#143;  |HAZ GrabaLineas;
     aCampo = "8_80";  aValor = #1004#144;  |HAZ GrabaLineas;
     aCampo = "8_81";  aValor = #1004#145;  |HAZ GrabaLineas;
     aCampo = "8_82";  aValor = #1004#146;  |HAZ GrabaLineas;
     aCampo = "8_83";  aValor = #1004#147;  |HAZ GrabaLineas;
     aCampo = "8_84";  aValor = #1004#148;  |HAZ GrabaLineas;
     aCampo = "8_85";  aValor = #1004#149;  |HAZ GrabaLineas;
     aCampo = "8_86";  aValor = #1004#150;  |HAZ GrabaLineas;

     aCampo = "9_1";   aValor = #1004#151;
                      aValorE = #1004#152;  |HAZ GrabaLineasE;
     aCampo = "9_2";   aValor = #1004#153;  |HAZ GrabaLineas;
     aCampo = "9_3";   aValor = #1004#154;  |HAZ GrabaLineas;
     aCampo = "9_4";   aValor = #1004#155;  |HAZ GrabaLineas;
     aCampo = "9_5";   aValor = #1004#156;  |HAZ GrabaLineas;
     aCampo = "9_6";   aValor = #1004#157;  |HAZ GrabaLineas;
     aCampo = "9_7";   aValor = #1004#158;  |HAZ GrabaLineas;
     aCampo = "9_8";   aValor = #1004#159;  |HAZ GrabaLineas;
     aCampo = "9_9";   aValor = #1004#160;  |HAZ GrabaLineas;
     aCampo = "9_10";  aValor = #1004#161;  |HAZ GrabaLineas;
     aCampo = "9_11";  aValor = #1004#162;  |HAZ GrabaLineas;
     aCampo = "9_12";  aValor = #1004#163;  |HAZ GrabaLineas;
     aCampo = "9_13";  aValor = #1004#164;  |HAZ GrabaLineas;
     aCampo = "9_14";  aValor = #1004#165;  |HAZ GrabaLineas;
     aCampo = "9_15";  aValor = #1004#166;  |HAZ GrabaLineas;
     aCampo = "9_16";  aValor = #1004#167;  |HAZ GrabaLineas;
     aCampo = "9_17";  aValor = #1004#168;  |HAZ GrabaLineas;
     aCampo = "9_18";  aValor = #1004#169;  |HAZ GrabaLineas;
     aCampo = "9_19";  aValor = #1004#170;  |HAZ GrabaLineas;
     aCampo = "9_20";  aValor = #1004#171;  |HAZ GrabaLineas;
     aCampo = "9_21";  aValor = #1004#172;  |HAZ GrabaLineas;
     aCampo = "9_22";  aValor = #1004#173;  |HAZ GrabaLineas;
     aCampo = "9_23";  aValor = #1004#174;  |HAZ GrabaLineas;
     aCampo = "9_24";  aValor = #1004#175;  |HAZ GrabaLineas;
     aCampo = "9_25";  aValor = #1004#176;  |HAZ GrabaLineas;
     aCampo = "9_26";  aValor = #1004#177;  |HAZ GrabaLineas;
     aCampo = "9_27";  aValor = #1004#178;  |HAZ GrabaLineas;
     aCampo = "9_28";  aValor = #1004#179;  |HAZ GrabaLineas;
     aCampo = "9_29";  aValor = #1004#180;  |HAZ GrabaLineas;
     aCampo = "9_30";  aValor = #1004#181;  |HAZ GrabaLineas;
     aCampo = "9_31";  aValor = #1004#182;  |HAZ GrabaLineas;
     aCampo = "9_32";  aValor = #1004#183;  |HAZ GrabaLineas;
     aCampo = "9_33";  aValor = #1004#184;  |HAZ GrabaLineas;
     aCampo = "9_34";  aValor = #1004#185;  |HAZ GrabaLineas;
     aCampo = "9_35";  aValor = #1004#186;  |HAZ GrabaLineas;
     aCampo = "9_36";  aValor = #1004#187;  |HAZ GrabaLineas;
     aCampo = "9_37";  aValor = #1004#188;  |HAZ GrabaLineas;
     aCampo = "9_38";  aValor = #1004#189;  |HAZ GrabaLineas;
     aCampo = "9_39";  aValor = #1004#190;  |HAZ GrabaLineas;
     aCampo = "9_40";  aValor = #1004#191;  |HAZ GrabaLineas;
     aCampo = "9_41";  aValor = #1004#192;  |HAZ GrabaLineas;
     aCampo = "9_42";  aValor = #1004#193;  |HAZ GrabaLineas;
     aCampo = "9_43";  aValor = #1004#194;  |HAZ GrabaLineas;
     aCampo = "9_44";  aValor = #1004#195;  |HAZ GrabaLineas;
     aCampo = "9_45";  aValor = #1004#196;  |HAZ GrabaLineas;
     aCampo = "9_46";  aValor = #1004#197;  |HAZ GrabaLineas;
     aCampo = "9_47";  aValor = #1004#198;  |HAZ GrabaLineas;
     aCampo = "9_48";  aValor = #1004#199;  |HAZ GrabaLineas;
     aCampo = "9_49";  aValor = #1004#200;  |HAZ GrabaLineas;
     aCampo = "9_50";  aValor = #1004#201;  |HAZ GrabaLineas;
     aCampo = "9_51";  aValor = #1005#0;    |HAZ GrabaLineas;
     aCampo = "9_52";  aValor = #1005#1;    |HAZ GrabaLineas;
     aCampo = "9_53";  aValor = #1005#2;    |HAZ GrabaLineas;
     aCampo = "9_54";  aValor = #1005#3;    |HAZ GrabaLineas;
     aCampo = "9_55";  aValor = #1005#4;    |HAZ GrabaLineas;
     aCampo = "9_56";  aValor = #1005#5;    |HAZ GrabaLineas;
     aCampo = "9_57";  aValor = #1005#6;    |HAZ GrabaLineas;
     aCampo = "9_58";  aValor = #1005#7;    |HAZ GrabaLineas;
     aCampo = "9_59";  aValor = #1005#8;    |HAZ GrabaLineas;
     aCampo = "9_60";  aValor = #1005#9;    |HAZ GrabaLineas;
     aCampo = "9_61";  aValor = #1005#10;   |HAZ GrabaLineas;
     aCampo = "9_62";  aValor = #1005#11;   |HAZ GrabaLineas;
     aCampo = "9_63";  aValor = #1005#12;   |HAZ GrabaLineas;
     aCampo = "9_64";  aValor = #1005#13;   |HAZ GrabaLineas;

     aCampo = "10_1";  aValor = #1005#14;   |HAZ GrabaLineas;
     aCampo = "10_2";  aValor = #1005#15;   |HAZ GrabaLineas;
     aCampo = "10_3";  aValor = #1005#16;   |HAZ GrabaLineas;
     aCampo = "10_4";  aValor = #1005#17;   |HAZ GrabaLineas;
     aCampo = "10_5";  aValor = #1005#18;   |HAZ GrabaLineas;
     aCampo = "10_6";  aValor = #1005#19;   |HAZ GrabaLineas;
     aCampo = "10_7";  aValor = #1005#20;   |HAZ GrabaLineas;
     aCampo = "10_8";  aValor = #1005#21;   |HAZ GrabaLineas;
     aCampo = "10_9";  aValor = #1005#22;   |HAZ GrabaLineas;
     aCampo = "10_10"; aValor = #1005#23;   |HAZ GrabaLineas;
     aCampo = "10_11"; aValor = #1005#24;   |HAZ GrabaLineas;
     aCampo = "10_12"; aValor = #1005#25;   |HAZ GrabaLineas;
     aCampo = "10_13"; aValor = #1005#26;   |HAZ GrabaLineas;
     aCampo = "10_14"; aValor = #1005#27;   |HAZ GrabaLineas;
     aCampo = "10_15"; aValor = #1005#28;   |HAZ GrabaLineas;
     aCampo = "10_16"; aValor = #1005#29;   |HAZ GrabaLineas;
     aCampo = "10_17"; aValor = #1005#30;   |HAZ GrabaLineas;
     aCampo = "10_18"; aValor = #1005#31;   |HAZ GrabaLineas;
     aCampo = "10_19"; aValor = #1005#32;   |HAZ GrabaLineas;
     aCampo = "10_20"; aValor = #1005#33;   |HAZ GrabaLineas;
     aCampo = "10_21"; aValor = #1005#34;   |HAZ GrabaLineas;

     |SI #1005#35 = "S";  aCampo = "11_1";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#35 = "N";  aCampo = "11_2";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#36 = "S";  aCampo = "11_3";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#36 = "N";  aCampo = "11_4";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#37 = "S";  aCampo = "11_5";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#37 = "N";  aCampo = "11_6";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#38 = "S";  aCampo = "11_7";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#38 = "N";  aCampo = "11_8";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;

     aCampo = "11_9";  aValor = #1005#39;   |HAZ GrabaLineas;
     aCampo = "11_10"; aValor = #1005#40;   |HAZ GrabaLineas;
     aCampo = "11_11"; aValor = #1005#41;   |HAZ GrabaLineas;
     aCampo = "11_12"; aValor = #1005#42;   |HAZ GrabaLineas;
     aCampo = "11_13"; aValor = #1005#43;   |HAZ GrabaLineas;
     aCampo = "11_14"; aValor = #1005#44;   |HAZ GrabaLineas;
     aCampo = "11_15"; aValor = #1005#45;   |HAZ GrabaLineas;
     aCampo = "11_16"; aValor = #1005#46;   |HAZ GrabaLineas;
     aCampo = "11_17"; aValor = #1005#47;   |HAZ GrabaLineas;
     aCampo = "11_18"; aValor = #1005#48;   |HAZ GrabaLineas;
     aCampo = "11_19"; aValor = #1005#49;   |HAZ GrabaLineas;
     aCampo = "11_20"; aValor = #1005#50;   |HAZ GrabaLineas;
     aCampo = "11_21"; aValor = #1005#51;   |HAZ GrabaLineas;

     |SI #1005#52 = "S";  aCampo = "12_1";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#52 = "N";  aCampo = "12_2";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#53 = "S";  aCampo = "12_3";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#53 = "N";  aCampo = "12_4";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#54 = "S";  aCampo = "12_5";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#54 = "N";  aCampo = "12_6";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#55 = "S";  aCampo = "12_7";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#55 = "N";  aCampo = "12_8";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#56 = "S";  aCampo = "12_9";   aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#56 = "N";  aCampo = "12_10";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#57 = "S";  aCampo = "12_11";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#57 = "N";  aCampo = "12_12";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#58 = "S";  aCampo = "12_13";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#58 = "N";  aCampo = "12_14";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#59 = "S";  aCampo = "12_15";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#59 = "N";  aCampo = "12_16";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#60 = "S";  aCampo = "12_17";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#60 = "N";  aCampo = "12_18";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#61 = "S";  aCampo = "12_19";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#61 = "N";  aCampo = "12_20";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#62 = "S";  aCampo = "12_21";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;
     |SI #1005#62 = "N";  aCampo = "12_22";  aValor = "X";   |HAZ GrabaLineas;  |FINSI;

     aCampo = "12_23"; aValor = #1005#63;   |HAZ GrabaLineas;
     aCampo = "12_24"; aValor = #1005#64;   |HAZ GrabaLineas;
     aCampo = "12_25"; aValor = #1005#65;   |HAZ GrabaLineas;
     aCampo = "12_26"; aValor = #1005#66;   |HAZ GrabaLineas;
     aCampo = "12_27"; aValor = #1005#67;   |HAZ GrabaLineas;
     aCampo = "12_28"; aValor = #1005#68;   |HAZ GrabaLineas;
     aCampo = "12_29"; aValor = #1005#69;   |HAZ GrabaLineas;
     aCampo = "12_30"; aValor = #1005#70;   |HAZ GrabaLineas;
     aCampo = "12_31"; aValor = #1005#71;   |HAZ GrabaLineas;
     aCampo = "12_32"; aValor = #1005#72;   |HAZ GrabaLineas;

     aCampo = "13_1";  aValor = #1005#73;   |HAZ GrabaLineas;
     aCampo = "13_2";  aValor = #1005#74;   |HAZ GrabaLineas;
     aCampo = "13_3";  aValor = #1005#75;   |HAZ GrabaLineas;

     aCampo = "14_1";  aValor = #1005#78;   |HAZ GrabaLineas;
     aCampo = "14_2";  aValor = #1005#79;   |HAZ GrabaLineas;
     aCampo = "14_3";  aValor = #1005#80;   |HAZ GrabaLineas;
     aCampo = "14_4";  aValor = #1005#81;   |HAZ GrabaLineas;
     aCampo = "14_5";  aValor = #1005#82;   |HAZ GrabaLineas;
     aCampo = "14_6";  aValor = #1005#83;   |HAZ GrabaLineas;
     aCampo = "14_7";  aValor = #1005#84;   |HAZ GrabaLineas;
     aCampo = "14_8";  aValor = #1005#85;   |HAZ GrabaLineas;
     aCampo = "14_9";  aValor = #1005#86;   |HAZ GrabaLineas;
     aCampo = "14_10"; aValor = #1005#87;   |HAZ GrabaLineas;
     aCampo = "14_11"; aValor = #1005#88;   |HAZ GrabaLineas;
     aCampo = "14_12"; aValor = #1005#89;   |HAZ GrabaLineas;
     aCampo = "14_13"; aValor = #1005#90;   |HAZ GrabaLineas;
|FPRC;

|PROCESO Pie;
     aLinea = "] ";                                  |XGRABA nHandle, aLinea;
     aLinea = "/F (C:/DOCUMENTOS/DSLPD/DOCDSLPD/encuesta.pdf)";  |XGRABA nHandle, aLinea;
     aLinea = "/ID [ ] >>";                          |XGRABA nHandle, aLinea;
     aLinea = ">> ";                                 |XGRABA nHandle, aLinea;
     aLinea = "endobj";                              |XGRABA nHandle, aLinea;
     aLinea = "trailer";                             |XGRABA nHandle, aLinea;
     aLinea = "<</Root 1 0 R >>";                    |XGRABA nHandle, aLinea;
     aLinea = "%%EOF";                               |XGRABA nHandle, aLinea;
|FPRC;

|PROCESO BuscaCaracter;
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = ((nPos * 100) + 1) * nPorDonde;
          aCaracter = aCadena % nCaracter;
          |SI aCaracter = aMiCaracter;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Encuesta;
     |HAZ LocalizaAcrobat;
     |SI enErrorDoc ! 0;  |ACABA;  |FINSI;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #5;
     #5#0 = #1001#0;
     #5#1 = #1001#1;
     #5#2 = #1001#2;
     |LEE 000#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |HAZ Registro1;

     |DBASE aBase;  |QBF aBase;
     aBasePdf  = aBase + "documentos/plantillas/";
     aDirLocal = "C:\DOCUMENTOS";                     |RMKDIR aDirLocal;
     aDirLocal = "C:\DOCUMENTOS\DSLPD";               |RMKDIR aDirLocal;
     aDirLocal = "C:\DOCUMENTOS\DSLPD\PLANTILLAS";    |RMKDIR aDirLocal;
     aDirLocal = "C:\DOCUMENTOS\DSLPD\DOCDSLPD";      |RMKDIR aDirLocal;
     aDirLocal = "C:\DOCUMENTOS\DSLPD\DOCDSLPD\";

     aOrigen  = aBasePdf  + "encuesta.pdf";
     aDestino = aDirLocal + "encuesta.pdf";

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aOrigen  = aBasePdf  + "wait.exe";
     aDestino = aDirLocal + "\wait.EXE";

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aArchivoPdf = aDirLocal + "encuesta.fdf";
     |XABRE "CW", aArchivoPdf, nHandle;
     |SI FSalida ] 0;
         |HAZ Cabecera;
         |HAZ Lineas;
         |HAZ Pie;
     |FINSI;
     |XCIERRA nHandle;

     aPathReader = eaPathAcrobat;  |QBF aPathReader;
     aCadena     = aPathReader;
     aMiCaracter = "\";
     nPorDonde   = -1;
     |HAZ BuscaCaracter;
     nPos        = nPos -1;
     nPos        = nPos + 100;
     nPos        = (-1) * nPos;
     aEjecutable = aPathReader % nPos;
     aPathReader = aPathReader - aEjecutable;

     aWait       = aDirLocal + "wait.exe";
     aFicheroBAT = aDirLocal + "imprime.bat";
     |XABRE "CBW", aFicheroBAT, nHandle;
     |SI FSalida = 0;
         aAlfa   = "@echo off" + &13 + &10;  |XGRABA nHandle, aAlfa;
         aUnidad = aPathReader % 102;
         aAlfa   = aUnidad + &13 + &10;      |XGRABA nHandle, aAlfa;
         aAlfa   = "cd " + &34 + aPathReader + &34 + &13 + &10;
         aAlfa   = aAlfa - aUnidad;          |XGRABA nHandle, aAlfa;
         aAlfa   = aWait + " " + aEjecutable;
         aAlfa   = aAlfa + " " + aArchivoPdf + &13 + &10;
                                             |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     |BORRA_HIJOS_PAN #1#0;
     |SUB_PINPA #0#998, enPanta1;

     |RSYSTEM aFicheroBAT;

     |BORRA_HIJOS_PAN #1#0;

     |HORA aHora;

     |ABRE #8;
     #8#0 = #0#0;
     #8#1 = 99999;
     |LEE 040#8];
     |SI FSalida = 0;
         |LEE 040#8a;
     |SINO;
         |LEE 040#8u;
     |FINSI;

     nDocu = 1;
     |SI FSalida = 0;  |Y  #8#0 = #1#1;
         nDocu = #8#1 + 1;
     |FINSI;

     |DDEFECTO #8;
     #8#0  = #0#0;
     #8#1  = nDocu;
     #8#2  = "Encuesta";
     #8#3  = #4#1;
     #8#4  = #4#2;
     #8#5  = #5#2;
     #8#6  = #5#3;
     #8#7  = #5#4;
     #8#8  = ~;
     #8#9  = aHora;
     #8#10 = Usuario % 810;
     #8#11 = #8#8;
     #8#12 = #8#9;
     #8#13 = #8#10;
     #8#14 = 0;
     #8#15 = 0;
     #8#16 = "FDF";

     |GRABA 020#8n;
     |LIBERA #8;
     |CIERRA #8;

     aDirServ = aBase + "documentos";                       |MKDIR aDirServ;
     aDirServ = aDirServ + "/clientes";                     |MKDIR aDirServ;
     aDirServ = aDirServ + "/" + (("00000" + #0#0) % -105); |MKDIR aDirServ;

     aOrigen  = aArchivoPdf;
     aDestino = aDirServ + "/fdf" + (("00000" + #8#1) % -105) + ".fdf";

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aAlfa = aDirLocal + "encuesta.pdf";

     |RFBORRA aFicheroBAT;
     |RFBORRA aArchivoPdf;
     |RFBORRA aWait;
     |RFBORRA aAlfa;
|FPRC;

|PROCESO GrabaRegistro;
     IaRegistro = aRegistro1 <-;
     aAlfa = aRegistro % 101;
     |SI aAlfa = "0";
         IaRegistro = aRegistro1 <-;
         |PARA nRegis = 1;  |SI nRegis [ 26;  |HACIENDO nRegis = nRegis + 1;
               aRegistro  = "";
               IaRegistro = IaRegistro + 1;
         |SIGUE;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     |SI nConta = 1;
         aAlfa  = ("1" * #9#8) + ("0" * 200);
         aAlfa1 = aAlfa % 150;
         aAlfa2 = aAlfa % 5150;
         aAlfa3 = aAlfa % 10050;
         aAlfa4 = aAlfa % 15150;

         eaAlfa = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + &10;    |XGRABA nHandle, eaAlfa;
     |FINSI;

     eaAlfa = aFichero + aFicher;  |QBF eaAlfa;
     eaAlfa = (eaAlfa + (" " * 35)) % 135;
     eaAlfa = eaAlfa + (#9#3 % 102) + (#9#3 % 402) + (#9#3 % 704);
     eaAlfa = eaAlfa + (#9#4 % 102) + (#9#4 % 402) + (#9#4 % 702);
     eaAlfa = eaAlfa + "                  " + "1" + "   " + &10;
     |XGRABA nHandle, eaAlfa;

     |SI #9#9 = "C";  aAlfa = "A";  |FINSI;
     |SI #9#9 = "M";  aAlfa = "M";  |FINSI;
     |SI #9#9 = "S";  aAlfa = "S";  |FINSI;

     eaAlfa = "0A" + aAlfa + "                           " + &10;
     |XGRABA nHandle, eaAlfa;

     IaRegistro = aRegistro1 <-;
     |PARA nRegis = 1;  |SI nRegis [ 26;  |HACIENDO nRegis = nRegis + 1;
           eaAlfa = aRegistro;
           |XGRABA nHandle, eaAlfa;
           aRegistro  = "";
           IaRegistro = IaRegistro + 1;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO Exportacion;
     |DBASE aBase;   |QBF aBase;
     aCliente = ("00000" + #9#0) % -105;
     aAlfa = aBase + "documentos";                  |MKDIR aAlfa;
     aAlfa = aAlfa + "/clientes";                   |MKDIR aAlfa;
     aAlfa = aAlfa + "/" + aCliente;                |MKDIR aAlfa;

     aAbreEnvio = aAlfa + "/GPrivado." + (("000" + #9#1) % -103);
     |XABRE "AB", aAbreEnvio, nHandleEnvio;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aDirLocal = "C:\DOCUMENTOS";                        |RMKDIR aDirLocal;
     aDirLocal = "C:\DOCUMENTOS\DSLPD";                  |RMKDIR aDirLocal;
     aDirLocal = "C:\DOCUMENTOS\DSLPD\EXPORTACION";      |RMKDIR aDirLocal;

     |DBASS aBase;

     aFichero = aBase;
     |PARA;  |SI;  |HACIENDO;
          aFichero = aFichero - "\";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     |PARA;  |SI;  |HACIENDO;
          aFichero = aFichero - "/";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     |PARA;  |SI;  |HACIENDO;
          aFichero = aFichero - ":";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     aFichero = aFichero + (("00000" + #9#0) % -105) + (("000" + #9#1) % -103);
     aFichero = aFichero > "";

     aAbre    = aDirLocal + "\" + aFichero + ".dat";

     |XABRE "CBW", aAbre, nHandle;

     nConta    = 0;
     aCarac10  = &10;
     nPosici   = 0;
     aFicher   = "";
     IaRegistro = aRegistro1 <-;
     |PARA;  |SI;  |HACIENDO;
          |XLEE nHandleEnvio, 1, aAlfa;
          |SI FSalida [ 0;  |SAL;  |FINSI;

          nPosici = nPosici + 1;
          |SI nPosici ] 680;  |Y nPosici [ 714;
              aFicher = aFicher + aAlfa;
          |FINSI;

          aLong = aRegistro % 0;
          nLong = aLong;

          |SI nLong = 201;
              IaRegistro = IaRegistro + 1;
          |FINSI;

          aRegistro = aRegistro + aAlfa;

          |SI aAlfa = aCarac10;
              |HAZ GrabaRegistro;
              aCadena = "";
              nPosici = 0;
              aFicher = "";

              IaRegistro = aRegistro1 <-;
          |FINSI;
     |SIGUE;

     |XCIERRA nHandle;
     |XCIERRA nHandleEnvio;

     aAlfa = "0000 El fichero esta ubicado en " + aAbre;
     |MENAV aAlfa;
|FPRC;

|PROCESO dslpm002ET;
     |SI #dslpm002#23 = "S";
          enSwTrata = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm002ET;
 #dslpm002#1;
 ;
 #5#0, "            ";
 #5#0, "zzzzzzzzzzzz";
 ;
 NULL, dslpm002ET;
|FIN;

|PROCESO EncargadoTrata;
     |BUCLE dslpm002ET;
|FPRC;

|PROCESO dslpm006;
     aDniEncargado = #dslpm006#7;
     |QBF aDniEncargado;

     |SI aDniEncargado ! "";
          |DDEFECTO #2;
          |ABRE #2;
          #2#0 = #5#0;
          #2#1 = aDniEncargado;
          |LEE 000#2=;
          |SI FSalida = 0;
               enSwTrata = 1;
               |ERROR10;
          |FINSI;
          |CIERRA #2;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm006;
 #dslpm006#1;
 ;
 #5#0, #5#1, #5#2, "   ";
 #5#0, #5#1, #5#2, "zzz";
 ;
 NULL, dslpm006;
|FIN;

|PROCESO EncargadoTrata6;
     |BUCLE dslpm006;
|FPRC;

|PROCESO MeteEnFrases;
     ||ARA40
     aLong = aFaltaPoner % A0;
     nLongFalta = aLong;

     aLong = aFrase1 % A0;
     nLongUno = aLong;
     aLong = aFrase2 % A0;
     nLongDos = aLong;
     aLong = aFrase3 % A0;
     nLongTres = aLong;

     nCabenUno = 248 - nLongUno;
     nCabenDos = 248 - nLongDos;
     nCabenTres = 248 - nLongDos;

     |SI nCabenUno = 248;
          aFrase1 = aFaltaPoner;
     |SINO;
          nDif = nCabenUno - nLongFalta;
          |SI nDif > 2;  || Para que quepa el ", " de separacion
               aFrase1 = aFrase1 + ", " + aFaltaPoner;
          |SINO;
               |SI nCabenUno < 4;
                    ||Salto a la siguiente linea
                    |SI aFrase2 = "";
                         aFrase2 = aFaltaPoner;
                    |SINO;
                         aFrase2 = aFrase2 + ", " + aFaltaPoner;
                    |FINSI;
               |SINO;
                    nNumAlFinal = nCabenUno - 2;    ||para el ", "

                    nNumDesde = nNumAlFinal + 1;

                    nCorte = 100 + nNumAlFinal;

                    aAux1 = aFaltaPoner % nCorte;
                    aAux2 = aFaltaPoner % nNumDesde;
                    aFrase1 = aFrase1 + ", " + aAux1;
                    aFrase2 = aFrase2 + aAux2;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ImprePDF;
     ||TODO CCC
     ||ARA39

     |ABRE #1;                ||Toma de Datos
     |SELECT #2#1;
     #1#1 = #1001#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #5;                || Datos del fichero
     #5#0 = #1001#0;
     #5#1 = #1001#1;
     #5#2 = #1001#2;
     |LEE 000#5=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #5;

     |ABRE #12;               || Datos del fichero
     #12#0 = #5#0;
     #12#1 = #5#1;
     #12#2 = #5#2;
     |LEE 000#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;
     |CIERRA #12;

     |ABRE #4;                || Datos del modelo
     #4#0 = #5#0;
     #4#1 = #5#1;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     ||Busca encargado tratamiento
     |ABRE #6;
     #6#0 = #5#0;
     #6#1 = #5#1;
     #6#2 = #5#2;
     #6#3 = "";
     |LEE 000#6];
     |SI FSalida = 0; |Y #6#0 = #5#0; |Y #6#1 = #5#1; |Y #6#2 = #5#2;
          aNifEnTrata = #6#7;
     |SINO;
          aNifEnTrata = #4#17;
     |FINSI;
     |CIERRA #6;

     enSwTrata = 0;
     |DDEFECTO #2;
     |ABRE #2;
     #2#0 = #5#0;
     #2#1 = aNifEnTrata;
     |LEE 000#2=;
     |SI FSalida = 0;
          enSwTrata = 1;
     |FINSI;
     |CIERRA #2;

/*
     enSwTrata = 0;
     |HAZ EncargadoTrata;
     |HAZ EncargadoTrata6;
*/

||     enTipo = 0; |PRINT;

||     enTipo = 1; |PRINT;


     aFrase1 = "";
     aFrase2 = "";
     aFrase3 = "";
     |ABRE #13;
     #13#0 = #5#0;
     #13#1 = #5#1;
     #13#2 = #5#2;
     #13#3 = 0;
     |LEE 000#13];
     |PARA; |SI FSalida = 0; |Y #13#0 = #5#0; |Y #13#1 = #5#1; |Y #13#2 = #5#2;
               |HACIENDO;
||          enTipo = 2; |PRINT;

          aFaltaPoner = #13#4;
          |QBF aFaltaPoner;
          |SI aFaltaPoner ! "";
               |HAZ MeteEnFrases;
          |FINSI;

          |LEE 000#13s;
     |SIGUE;
     |CIERRA #13;

     eaFinalidad1 = aFrase1;
     eaFinalidad2 = aFrase2;
||     enTipo = 2; |PRINT;

||     enTipo = 3; |PRINT;

     aFrase1 = "";
     aFrase2 = "";
     aFrase3 = "";
     |ABRE #14;
     #14#0 = #5#0;
     #14#1 = #5#1;
     #14#2 = #5#2;
     #14#3 = 0;
     |LEE 000#14];
     |PARA; |SI FSalida = 0; |Y #14#0 = #5#0; |Y #14#1 = #5#1; |Y #14#2 = #5#2;
               |HACIENDO;
||          enTipo = 4; |PRINT;

          aFaltaPoner = #14#4;
          |QBF aFaltaPoner;
          |SI aFaltaPoner ! "";
               |HAZ MeteEnFrases;
          |FINSI;

          |LEE 000#14s;
     |SIGUE;
     |CIERRA #14;

     eaProceUno = aFrase1;
     eaProceDos = aFrase2;


||     enTipo = 5; |PRINT;
     |ABRE #15;
     #15#0 = #5#0;
     #15#1 = #5#1;
     #15#2 = #5#2;
     #15#3 = 0;
     |LEE 000#15];
     |PARA; |SI FSalida = 0; |Y #15#0 = #5#0; |Y #15#1 = #5#1; |Y #15#2 = #5#2;
               |HACIENDO;
||          enTipo = 6; |PRINT;
          |LEE 000#15s;
     |SIGUE;
     |CIERRA #15;
||     enTipo = 7; |PRINT;

||     enTipo = 8; |PRINT;

     aFrase1 = "";
     aFrase2 = "";
     aFrase3 = "";
     |ABRE #16;
     #16#0 = #5#0;
     #16#1 = #5#1;
     #16#2 = #5#2;
     #16#3 = 0;
     |LEE 000#16];
     |PARA; |SI FSalida = 0; |Y #16#0 = #5#0; |Y #16#1 = #5#1; |Y #16#2 = #5#2;
               |HACIENDO;
||          enTipo = 9; |PRINT;

          aFaltaPoner = #16#4;
          |QBF aFaltaPoner;
          |SI aFaltaPoner ! "";
               |HAZ MeteEnFrases;
          |FINSI;

          |LEE 000#16s;
     |SIGUE;
     |CIERRA #16;

     eaCesionUno = aFrase1;
     eaCesionDos = aFrase2;

||     enTipo = 10; |PRINT;


     nVoyPorPais = 0;
     |ABRE #17;
     #17#0 = #5#0;
     #17#1 = #5#1;
     #17#2 = #5#2;
     #17#3 = 0;
     |LEE 000#17];
     |PARA; |SI FSalida = 0; |Y #17#0 = #5#0; |Y #17#1 = #5#1; |Y #17#2 = #5#2;
               |HACIENDO;
||          enTipo = 11; |PRINT;

          aPais = #17#4;
          |QBF aPais;
          |SI aPais ! "";
               nVoyPorPais = nVoyPorPais + 1;

               |SI nVoyPorPais = 1;
                    eaPaisUno = aPais;
                    eaCateUno = #17#6;
                    |QBF eaCateUno;
               |FINSI;
               |SI nVoyPorPais = 2;
                    eaPaisDos = aPais;
                    eaCateDos = #17#6;
                    |QBF eaCateDos;
               |FINSI;
               |SI nVoyPorPais = 3;
                    eaPaisTres = aPais;
                    eaCateTres = #17#6;
                    |QBF eaCateTres;
               |FINSI;
               |SI nVoyPorPais = 4;
                    eaPaisCuatro = aPais;
                    eaCateCuatro = #17#6;
                    |QBF eaCateCuatro;
               |FINSI;
               |SI nVoyPorPais = 5;
                    eaPaisCinco = aPais;
                    eaCateCinco = #17#6;
                    |QBF eaCateCinco;
               |FINSI;

          |FINSI;

          |LEE 000#17s;
     |SIGUE;
     |CIERRA #17;

     |PRINT;
|FPRC;

|PROCESO CreaPDF
     ||TODO CCC
/*
     Impresora = "CrystalReport";
     |IMPRE -1;
*/
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "estructu";
          |SI FSalida = 0;
               |HAZ ImprePDF;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC
