|FICHEROS;
     dslpw031 #931;
     dslpw034 #934;
     dslpm510 #510;
     dslpm523 #523;

     dslpw031@ #999;
     dslpm510@ #998;
     dslpm523@ #997;
|FIN;

|VARIABLES;
     nBoton1_1        = 0;
     nBoton1_2        = 0;
     nBoton1_3        = 0;
     nPanta1          = 0;
     nGrid1           = 0;
     nGrid2           = 0;
     nRango           = 0;
     nPos1            = 0;
     nPos2            = 0;
     nVentana         = 0;
     nHandle          = 0;
     nLong            = 0;
     nCampo           = 0;

     aFichero         = "";
     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aAlfa            = "";
     aDirec           = "";
     aDir             = "";
     aAbre            = "";
     aLong            = "";
     aBase            = "";
     aMas             = "";
     aReg             = "";
     aCap             = "";
|FIN;

|PROCESO BajaPanta1_1;
     #931#0  = 00001;
|FPRC;

|PROCESO AltaPanta1_1;
     #931#0  = 99999;
|FPRC;

|PROCESO BajaPanta1_2;
     #999#0  = 00001;
|FPRC;

|PROCESO AltaPanta1_2;
     #999#0  = 99999;
|FPRC;

|PROCESO dslpm510B;
     |BORRA 020#510a;
     |LIBERA #510;
|FPRC;

|DEFBUCLE dslpm510B;
     #510#1;
     ;
     #931#0, 00001;
     #931#0, 99999;
     ;
     NULL, dslpm510B;
|FIN;

|PROCESO dslpm523B;
     |BORRA 020#523a;
     |LIBERA #523;
|FPRC;

|DEFBUCLE dslpm523B;
     #523#1;
     ;
     #931#0, 00001;
     #931#0, 99999;
     ;
     NULL, dslpm523B;
|FIN;

|PROCESO dslpm510R;
     #510#0 = #931#0;
     #510#1 = #998#1;
     #510#2 = #931#1;

     |PARA nCampo = 3;  |SI nCampo [ 222;  |HACIENDO nCampo = nCampo + 1;
           #510nCampo = #998nCampo;
     |SIGUE;

     |GRABA 020#510n;
     |LIBERA #510;

     #997#0 = #998#0;
     #997#1 = #998#1;
     #997#2 = #998#2;
     |LEE 000#997=;
     |SI FSalida ! 0;  |DDEFECTO #997;  |FINSI;

     #523#0 = #931#0;
     #523#1 = #998#1;
     #523#2 = #931#1;

     |PARA nCampo = 3;  |SI nCampo [ 63;  |HACIENDO nCampo = nCampo + 1;
           #523nCampo = #997nCampo;
     |SIGUE;

     |GRABA 020#523n;
     |LIBERA #523;
|FPRC;

|DEFBUCLE dslpm510R;
     #998#1002;
     ;
     #999#0, 00001;
     #999#0, 99999;
     ;
     NULL, dslpm510R;
|FIN;

|| ------------------------------------------------------
|| Procesos del Boton 1_1
|| ------------------------------------------------------

|PROCESO Boton1_1;
     |LEE 000#931u;
     |SI FSalida ! 0;  |DDEFECTO #931;  |FINSI;

     #931#0 = #931#0 + 1;
     #931#1 = #999#1;
     |GRABA 020#931n;
     |LIBERA #931;

     |ABRE #510;
     |ABRE #523;
     |ABRE #997;
     |BUCLE dslpm510R;
     |CIERRA #997;
     |CIERRA #510;
     |CIERRA #523;

     |LEE 000#931=;
     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_2
|| ------------------------------------------------------

|PROCESO Boton1_2;
     #931#0 = #999#0;
     |LEE 000#931=;
     |SI FSalida = 0;
         ||CONFI "0000NLa Plantilla ya existe. Seguro de reemplazarla.";
         aAlfa = "0000N" + &191 + "La plantilla ya existe. Seguro de reemplazarla. ?";
         |CONFI aAlfa;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     #931#0 = #999#0;
     |LEE 101#931=;
     |SI FSalida ! 0;
         #931#0 = #999#0;
         |GRABA 020#931b;
     |FINSI;
     #931#1 = #999#1;
     |GRABA 020#931a;
     |LIBERA #931;

     |BUCLE dslpm510B;
     |BUCLE dslpm523B;

     |ABRE #510;
     |ABRE #523;
     |BUCLE dslpm510R;
     |CIERRA #510;
     |CIERRA #523;

     |LEE 000#931=;
     |REFRESCACONTROL nGrid1;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_3
|| ------------------------------------------------------

|PROCESO Cap000;
     |DDEFECTO #999;
     aReg = aAlfa % 405;  #999#0 = aReg;
     aReg = aAlfa % 950;  #999#1 = aReg;

     |GRABA 020#999n;
     |LIBERA #999;
|FPRC;

|PROCESO Cap001;
     |DDEFECTO #998;
                            #998#0 = #999#0;
                            #998#2 = #999#1;
     aReg = aAlfa % 405;    #998#1 = aReg;
     aReg = aAlfa % 935;    #998#3 = aReg;
     aReg = (aAlfa % 4470) + (aAlfa % 11470);   #998#4 = aReg;
     aReg = aAlfa % 18415;  #998#5 = aReg;

     |GRABA 020#998b;

     |DDEFECTO #997;

     #997#0 = #998#0;
     #997#1 = #998#1;

     |GRABA 020#997b;
|FPRC;

|PROCESO CapE00;
     aReg = aAlfa % 401;    #998#7  = aReg;
     aReg = aAlfa % 501;    #998#8  = aReg;
     aReg = aAlfa % 601;    #998#9  = aReg;
     aReg = aAlfa % 701;    #998#10 = aReg;
     aReg = aAlfa % 801;    #998#11 = aReg;
     aReg = aAlfa % 901;    #998#12 = aReg;
     aReg = aAlfa % 1001;   #998#13 = aReg;
     aReg = aAlfa % 1101;   #998#14 = aReg;
     aReg = aAlfa % 1201;   #998#15 = aReg;
     aReg = aAlfa % 1301;   #998#16 = aReg;
|FPRC;

|PROCESO CapE01;
     aReg = aAlfa % 401;    #998#17  = aReg;
     aReg = aAlfa % 501;    #998#18  = aReg;
     aReg = aAlfa % 601;    #998#19  = aReg;
     aReg = aAlfa % 701;    #998#20  = aReg;
     aReg = aAlfa % 801;    #998#21  = aReg;
     aReg = aAlfa % 901;    #998#22  = aReg;
     aReg = aAlfa % 1001;   #998#219 = aReg;
     aReg = aAlfa % 1101;   #998#220 = aReg;
|FPRC;

|PROCESO CapE02;
     aReg = aAlfa % 401;    #998#23  = aReg;
     aReg = aAlfa % 501;    #998#24  = aReg;
     aReg = aAlfa % 601;    #998#25  = aReg;
     aReg = aAlfa % 701;    #998#26  = aReg;
     aReg = aAlfa % 801;    #998#27  = aReg;
     aReg = aAlfa % 901;    #998#221 = aReg;
     aReg = aAlfa % 1001;   #998#222 = aReg;
     aReg = aAlfa % 1104;   #998#28  = aReg;
     aReg = aAlfa % 1504;   #998#29  = aReg;
     aReg = aAlfa % 1935;   #998#30  = aReg;
     aReg = aAlfa % 5435;   #998#31  = aReg;
|FPRC;

|PROCESO CapE03;
     aReg = aAlfa % 401;    #998#32  = aReg;
     aReg = aAlfa % 501;    #998#33  = aReg;
     aReg = aAlfa % 601;    #998#34  = aReg;
     aReg = aAlfa % 701;    #998#35  = aReg;
     aReg = aAlfa % 801;    #998#36  = aReg;
     aReg = aAlfa % 901;    #998#37  = aReg;
     aReg = aAlfa % 1001;   #998#38  = aReg;
     aReg = aAlfa % 1101;   #998#39  = aReg;
     aReg = aAlfa % 1201;   #998#40  = aReg;
     aReg = aAlfa % 1301;   #998#41  = aReg;
     aReg = aAlfa % 1435;   #998#42  = aReg;
     aReg = aAlfa % 4935;   #998#43  = aReg;
|FPRC;

|PROCESO CapE04;
     aReg = aAlfa % 401;    #998#44  = aReg;
     aReg = aAlfa % 501;    #998#45  = aReg;
     aReg = aAlfa % 601;    #998#46  = aReg;
     aReg = aAlfa % 701;    #998#47  = aReg;
     aReg = aAlfa % 801;    #998#48  = aReg;
     aReg = aAlfa % 901;    #998#49  = aReg;
     aReg = aAlfa % 1001;   #998#50  = aReg;
     aReg = aAlfa % 1101;   #998#51  = aReg;
     aReg = aAlfa % 1201;   #998#52  = aReg;
     aReg = aAlfa % 1301;   #998#53  = aReg;
     aReg = aAlfa % 1435;   #998#54  = aReg;
     aReg = aAlfa % 4935;   #998#55  = aReg;
|FPRC;

|PROCESO CapE05;
     aReg = aAlfa % 401;    #998#56  = aReg;
     aReg = aAlfa % 501;    #998#57  = aReg;
     aReg = aAlfa % 601;    #998#58  = aReg;
     aReg = aAlfa % 701;    #998#59  = aReg;
     aReg = aAlfa % 801;    #998#60  = aReg;
     aReg = aAlfa % 901;    #998#61  = aReg;
     aReg = aAlfa % 1001;   #998#62  = aReg;
     aReg = aAlfa % 1135;   #998#63  = aReg;
     aReg = aAlfa % 4635;   #998#64  = aReg;
|FPRC;

|PROCESO CapE06;
     aReg = aAlfa % 401;    #998#65  = aReg;
     aReg = aAlfa % 501;    #998#66  = aReg;
     aReg = aAlfa % 601;    #998#67  = aReg;
     aReg = aAlfa % 701;    #998#68  = aReg;
     aReg = aAlfa % 801;    #998#69  = aReg;
     aReg = aAlfa % 0935;   #998#70  = aReg;
     aReg = aAlfa % 4435;   #998#71  = aReg;
|FPRC;

|PROCESO CapE07;
     aReg = aAlfa % 401;    #998#72  = aReg;
     aReg = aAlfa % 501;    #998#73  = aReg;
     aReg = aAlfa % 601;    #998#74  = aReg;
     aReg = aAlfa % 701;    #998#75  = aReg;
     aReg = aAlfa % 801;    #998#76  = aReg;
     aReg = aAlfa % 0935;   #998#77  = aReg;
     aReg = aAlfa % 4435;   #998#78  = aReg;
|FPRC;

|PROCESO CapE08;
     aReg = aAlfa % 401;    #998#79  = aReg;
     aReg = aAlfa % 501;    #998#80  = aReg;
     aReg = aAlfa % 601;    #998#81  = aReg;
     aReg = aAlfa % 701;    #998#82  = aReg;
     aReg = aAlfa % 801;    #998#83  = aReg;
     aReg = aAlfa % 0935;   #998#84  = aReg;
     aReg = aAlfa % 4435;   #998#85  = aReg;
|FPRC;

|PROCESO CapE09;
     aReg = aAlfa % 401;    #998#86  = aReg;
     aReg = aAlfa % 501;    #998#87  = aReg;
     aReg = aAlfa % 601;    #998#88  = aReg;
     aReg = aAlfa % 701;    #998#89  = aReg;
     aReg = aAlfa % 801;    #998#90  = aReg;
     aReg = aAlfa % 901;    #998#91  = aReg;
     aReg = aAlfa % 1001;   #998#92  = aReg;
     aReg = aAlfa % 1101;   #998#93  = aReg;
     aReg = aAlfa % 1201;   #998#94  = aReg;
     aReg = aAlfa % 1301;   #998#95  = aReg;
     aReg = aAlfa % 1401;   #998#96  = aReg;
     aReg = aAlfa % 1501;   #998#97  = aReg;
     aReg = aAlfa % 1601;   #998#98  = aReg;
     aReg = aAlfa % 1735;   #998#99  = aReg;
     aReg = aAlfa % 5235;   #998#100 = aReg;
|FPRC;

|PROCESO CapE10;
     aReg = aAlfa % 401;    #998#101 = aReg;
     aReg = aAlfa % 501;    #998#102 = aReg;
     aReg = aAlfa % 601;    #998#103 = aReg;
     aReg = aAlfa % 701;    #998#104 = aReg;
     aReg = aAlfa % 801;    #998#105 = aReg;
     aReg = aAlfa % 0935;   #998#106 = aReg;
     aReg = aAlfa % 4435;   #998#107 = aReg;
|FPRC;

|PROCESO CapFD1;
     aReg = aAlfa % 435;    #998#108 = aReg;
     aReg = aAlfa % 3935;   #998#109 = aReg;
     aReg = aAlfa % 7435;   #998#110 = aReg;
     aReg = aAlfa % 10935;  #998#111 = aReg;
     aReg = aAlfa % 14435;  #998#112 = aReg;
|FPRC;

|PROCESO CapFD2;
     aReg = aAlfa % 435;    #998#113 = aReg;
     aReg = aAlfa % 3935;   #998#114 = aReg;
     aReg = aAlfa % 7435;   #998#115 = aReg;
     aReg = aAlfa % 10935;  #998#116 = aReg;
     aReg = aAlfa % 14435;  #998#117 = aReg;
|FPRC;

|PROCESO CapF00;
     aReg = aAlfa % 401;    #998#119 = aReg;
     aReg = aAlfa % 501;    #998#120 = aReg;
     aReg = aAlfa % 601;    #998#121 = aReg;
     aReg = aAlfa % 701;    #998#122 = aReg;
     aReg = aAlfa % 801;    #998#123 = aReg;
     aReg = aAlfa % 901;    #998#124 = aReg;
     aReg = aAlfa % 1001;   #998#125 = aReg;
     aReg = aAlfa % 1101;   #998#126 = aReg;
     aReg = aAlfa % 1201;   #998#127 = aReg;
     aReg = aAlfa % 1301;   #998#128 = aReg;
|FPRC;

|PROCESO CapF01;
     aReg = aAlfa % 401;    #998#129 = aReg;
     aReg = aAlfa % 501;    #998#130 = aReg;
     aReg = aAlfa % 601;    #998#131 = aReg;
     aReg = aAlfa % 701;    #998#132 = aReg;
     aReg = aAlfa % 801;    #998#133 = aReg;
     aReg = aAlfa % 901;    #998#134 = aReg;
     aReg = aAlfa % 1001;   #998#135 = aReg;
     aReg = aAlfa % 1101;   #998#136 = aReg;
     aReg = aAlfa % 1201;   #998#137 = aReg;
     aReg = aAlfa % 1301;   #998#138 = aReg;
|FPRC;

|PROCESO CapF02;
     aReg = aAlfa % 401;    #998#139 = aReg;
     aReg = aAlfa % 501;    #998#140 = aReg;
     aReg = aAlfa % 601;    #998#141 = aReg;
     aReg = aAlfa % 701;    #998#142 = aReg;
     aReg = aAlfa % 801;    #998#143 = aReg;
     aReg = aAlfa % 901;    #998#144 = aReg;
     aReg = aAlfa % 1001;   #998#145 = aReg;
     aReg = aAlfa % 1101;   #998#146 = aReg;
     aReg = aAlfa % 1201;   #998#147 = aReg;
|FPRC;

|PROCESO CapF03;
     aReg = aAlfa % 401;    #998#148 = aReg;
     aReg = aAlfa % 501;    #998#149 = aReg;
     aReg = aAlfa % 601;    #998#150 = aReg;
     aReg = aAlfa % 701;    #998#151 = aReg;
     aReg = aAlfa % 801;    #998#152 = aReg;
     aReg = aAlfa % 901;    #998#153 = aReg;
     aReg = aAlfa % 1001;   #998#154 = aReg;
     aReg = aAlfa % 1101;   #998#155 = aReg;
     aReg = aAlfa % 1201;   #998#156 = aReg;
     aReg = aAlfa % 1301;   #998#157 = aReg;
     aReg = aAlfa % 1401;   #998#158 = aReg;
|FPRC;

|PROCESO CapF04;
     aReg = aAlfa % 401;    #998#159 = aReg;
     aReg = aAlfa % 501;    #998#160 = aReg;
     aReg = aAlfa % 601;    #998#161 = aReg;
     aReg = aAlfa % 701;    #998#162 = aReg;
     aReg = aAlfa % 801;    #998#163 = aReg;
     aReg = aAlfa % 901;    #998#164 = aReg;
     aReg = aAlfa % 1001;   #998#165 = aReg;
     aReg = aAlfa % 1101;   #998#166 = aReg;
|FPRC;

|PROCESO CapF05;
     aReg = aAlfa % 401;    #998#167 = aReg;
     aReg = aAlfa % 501;    #998#168 = aReg;
     aReg = aAlfa % 601;    #998#169 = aReg;
     aReg = aAlfa % 701;    #998#170 = aReg;
|FPRC;

|PROCESO CapF06;
     aReg = aAlfa % 401;    #998#171 = aReg;
     aReg = aAlfa % 501;    #998#172 = aReg;
     aReg = aAlfa % 601;    #998#173 = aReg;
     aReg = aAlfa % 701;    #998#174 = aReg;
     aReg = aAlfa % 801;    #998#175 = aReg;
     aReg = aAlfa % 901;    #998#176 = aReg;
|FPRC;

|PROCESO CapF07;
     aReg = aAlfa % 401;    #998#177 = aReg;
     aReg = aAlfa % 501;    #998#178 = aReg;
     aReg = aAlfa % 601;    #998#179 = aReg;
     aReg = aAlfa % 701;    #998#180 = aReg;
     aReg = aAlfa % 801;    #998#181 = aReg;
|FPRC;

|PROCESO CapF08;
     aReg = aAlfa % 401;    #998#182 = aReg;
     aReg = aAlfa % 501;    #998#183 = aReg;
     aReg = aAlfa % 601;    #998#184 = aReg;
|FPRC;

|PROCESO CapF09;
     aReg = aAlfa % 401;    #998#185 = aReg;
     aReg = aAlfa % 501;    #998#186 = aReg;
     aReg = aAlfa % 601;    #998#187 = aReg;
|FPRC;

|PROCESO CapF10;
     aReg = aAlfa % 401;    #998#188 = aReg;
     aReg = aAlfa % 501;    #998#189 = aReg;
     aReg = aAlfa % 601;    #998#190 = aReg;
     aReg = aAlfa % 701;    #998#191 = aReg;
|FPRC;

|PROCESO CapP00;
     aReg = aAlfa % 401;    #998#193 = aReg;
     aReg = aAlfa % 501;    #998#194 = aReg;
     aReg = aAlfa % 601;    #998#195 = aReg;
|FPRC;

|PROCESO CapP01;
     aReg = aAlfa % 401;    #998#196 = aReg;
     aReg = aAlfa % 501;    #998#197 = aReg;
     aReg = aAlfa % 601;    #998#198 = aReg;
     aReg = aAlfa % 701;    #998#199 = aReg;
     aReg = aAlfa % 801;    #998#200 = aReg;
     aReg = aAlfa % 901;    #998#201 = aReg;
     aReg = aAlfa % 1001;   #998#202 = aReg;
     aReg = aAlfa % 1101;   #998#203 = aReg;
     aReg = aAlfa % 1201;   #998#204 = aReg;
     aReg = aAlfa % 1301;   #998#205 = aReg;
     aReg = aAlfa % 1401;   #998#206 = aReg;
|FPRC;

|PROCESO CapP02;
     aReg = aAlfa % 401;    #998#207 = aReg;
     aReg = aAlfa % 501;    #998#208 = aReg;
     aReg = aAlfa % 601;    #998#209 = aReg;
     aReg = aAlfa % 701;    #998#210 = aReg;
     aReg = aAlfa % 0835;   #998#211 = aReg;
     aReg = aAlfa % 4335;   #998#212 = aReg;
|FPRC;

|PROCESO CapP03;
     aReg = aAlfa % 401;    #998#213 = aReg;
     aReg = aAlfa % 501;    #998#214 = aReg;
     aReg = aAlfa % 601;    #998#215 = aReg;
     aReg = aAlfa % 701;    #998#216 = aReg;
     aReg = aAlfa % 0835;   #998#217 = aReg;
     aReg = aAlfa % 4335;   #998#218 = aReg;
|FPRC;

|PROCESO CapC00;
     aReg = aAlfa % 401;    #997#2   = aReg;
     aReg = aAlfa % 501;    #997#3   = aReg;
|FPRC;

|PROCESO CapC01;
     aReg = aAlfa % 401;    #997#6   = aReg;
     aReg = aAlfa % 501;    #997#7   = aReg;
     aReg = aAlfa % 601;    #997#8   = aReg;
     aReg = aAlfa % 701;    #997#9   = aReg;
     aReg = aAlfa % 804;    #997#10  = aReg;
     aReg = aAlfa % 1204;   #997#11  = aReg;
     aReg = aAlfa % 1635;   #997#12  = aReg;
     aReg = aAlfa % 5135;   #997#13  = aReg;
     aReg = aAlfa % 8601;   #997#14  = aReg;
     aReg = aAlfa % 8701;   #997#15  = aReg;
     aReg = aAlfa % 8801;   #997#16  = aReg;
     aReg = aAlfa % 8901;   #997#17  = aReg;
|FPRC;

|PROCESO CapC02;
     aReg = aAlfa %   412;  #997#18  = aReg;
     aReg = aAlfa %  1640;  #997#19  = aReg;
     aReg = aAlfa %  5612;  #997#20  = aReg;
     aReg = aAlfa %  6840;  #997#21  = aReg;
     aReg = aAlfa % 10812;  #997#22  = aReg;
     aReg = aAlfa % 12040;  #997#23  = aReg;
     aReg = aAlfa % 16012;  #997#24  = aReg;
     aReg = aAlfa % 17240;  #997#25  = aReg;
|FPRC;

|PROCESO CapC03;
     aReg = aAlfa %   450;  #997#26  = aReg;
     aReg = aAlfa %  5450;  #997#27  = aReg;
     aReg = aAlfa % 10450;  #997#28  = aReg;
     aReg = aAlfa % 15450;  #997#29  = aReg;
|FPRC;

|PROCESO CapT00;
     aReg = aAlfa % 401;    #997#4   = aReg;
     aReg = aAlfa % 501;    #997#5   = aReg;
|FPRC;

|PROCESO CapT01;
     aReg = aAlfa %   401;  #997#30  = aReg;
     aReg = aAlfa %   501;  #997#31  = aReg;
     aReg = aAlfa %   601;  #997#32  = aReg;
     aReg = aAlfa %   701;  #997#33  = aReg;
     aReg = aAlfa %   801;  #997#34  = aReg;
     aReg = aAlfa %   901;  #997#35  = aReg;
     aReg = aAlfa %  1001;  #997#36  = aReg;
     aReg = aAlfa %  1101;  #997#37  = aReg;
     aReg = aAlfa %  1201;  #997#38  = aReg;
     aReg = aAlfa %  1301;  #997#39  = aReg;
     aReg = aAlfa %  1401;  #997#40  = aReg;
     aReg = aAlfa %  1501;  #997#41  = aReg;
     aReg = aAlfa %  1601;  #997#42  = aReg;
     aReg = aAlfa %  1701;  #997#43  = aReg;
     aReg = aAlfa %  1801;  #997#44  = aReg;
     aReg = aAlfa %  1901;  #997#45  = aReg;
     aReg = aAlfa %  2001;  #997#46  = aReg;
     aReg = aAlfa %  2101;  #997#47  = aReg;
     aReg = aAlfa %  2201;  #997#48  = aReg;
     aReg = aAlfa %  2301;  #997#49  = aReg;
     aReg = aAlfa %  2401;  #997#50  = aReg;
     aReg = aAlfa %  2501;  #997#51  = aReg;
|FPRC;

|PROCESO CapT02;
     aReg = aAlfa %   402;  #997#52  = aReg;
     aReg = aAlfa %   640;  #997#53  = aReg;
     aReg = aAlfa %  4602;  #997#54  = aReg;
     aReg = aAlfa %  4840;  #997#55  = aReg;
     aReg = aAlfa %  8802;  #997#56  = aReg;
     aReg = aAlfa %  9040;  #997#57  = aReg;
     aReg = aAlfa % 13002;  #997#58  = aReg;
     aReg = aAlfa % 13240;  #997#59  = aReg;
|FPRC;

|PROCESO CapT03;
     aReg = aAlfa %   450;  #997#60  = aReg;
     aReg = aAlfa %  5450;  #997#61  = aReg;
     aReg = aAlfa % 10450;  #997#62  = aReg;
     aReg = aAlfa % 15450;  #997#63  = aReg;

     |GRABA 020#998a;
     |LIBERA #998;

     |GRABA 020#997a;
     |LIBERA #999;
|FPRC;

|PROCESO TrataFichero;
     |XABRE "CAB", aDir, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |PARA;  |SI;  |HACIENDO;
          |XLEE nHandle, 241, aAlfa;
          |SI FSalida [ 0;  |SAL;  |FINSI;

          aCap = aAlfa % 103;
          |SI aCap = "000";  |HAZ Cap000;  |FINSI;
          |SI aCap = "001";  |HAZ Cap001;  |FINSI;
          |SI aCap = "E00";  |HAZ CapE00;  |FINSI;
          |SI aCap = "E01";  |HAZ CapE01;  |FINSI;
          |SI aCap = "E02";  |HAZ CapE02;  |FINSI;
          |SI aCap = "E03";  |HAZ CapE03;  |FINSI;
          |SI aCap = "E04";  |HAZ CapE04;  |FINSI;
          |SI aCap = "E05";  |HAZ CapE05;  |FINSI;
          |SI aCap = "E06";  |HAZ CapE06;  |FINSI;
          |SI aCap = "E07";  |HAZ CapE07;  |FINSI;
          |SI aCap = "E08";  |HAZ CapE08;  |FINSI;
          |SI aCap = "E09";  |HAZ CapE09;  |FINSI;
          |SI aCap = "E10";  |HAZ CapE10;  |FINSI;

          |SI aCap = "FD1";  |HAZ CapFD1;  |FINSI;
          |SI aCap = "FD2";  |HAZ CapFD2;  |FINSI;

          |SI aCap = "F00";  |HAZ CapF00;  |FINSI;
          |SI aCap = "F01";  |HAZ CapF01;  |FINSI;
          |SI aCap = "F02";  |HAZ CapF02;  |FINSI;
          |SI aCap = "F03";  |HAZ CapF03;  |FINSI;
          |SI aCap = "F04";  |HAZ CapF04;  |FINSI;
          |SI aCap = "F05";  |HAZ CapF05;  |FINSI;
          |SI aCap = "F06";  |HAZ CapF06;  |FINSI;
          |SI aCap = "F07";  |HAZ CapF07;  |FINSI;
          |SI aCap = "F08";  |HAZ CapF08;  |FINSI;
          |SI aCap = "F09";  |HAZ CapF09;  |FINSI;
          |SI aCap = "F10";  |HAZ CapF10;  |FINSI;

          |SI aCap = "P00";  |HAZ CapP00;  |FINSI;
          |SI aCap = "P01";  |HAZ CapP01;  |FINSI;
          |SI aCap = "P02";  |HAZ CapP02;  |FINSI;
          |SI aCap = "P03";  |HAZ CapP03;  |FINSI;

          |SI aCap = "C00";  |HAZ CapC00;  |FINSI;
          |SI aCap = "C01";  |HAZ CapC01;  |FINSI;
          |SI aCap = "C02";  |HAZ CapC02;  |FINSI;
          |SI aCap = "C03";  |HAZ CapC03;  |FINSI;

          |SI aCap = "T00";  |HAZ CapT00;  |FINSI;
          |SI aCap = "T01";  |HAZ CapT01;  |FINSI;
          |SI aCap = "T02";  |HAZ CapT02;  |FINSI;
          |SI aCap = "T03";  |HAZ CapT03;  |FINSI;
     |SIGUE;

     |XCIERRA nHandle;
|FPRC;

|PROCESO Boton1_3;
     aDirec = "D";
     |BROWSE aDirec;
     aDirec = aDirec % 290;  |QBF aDirec;
     |SI aDirec = "";  |ACABA;  |FINSI;

     aDir = aDirec + "/seg*.txt";
     |R_PDIR aDir;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |HAZ TrataFichero;

          |R_SDIR aDir;
     |SIGUE;

     |LEE 000#999p;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBoton1_3, "DISABLE";

     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Incio del Programa
|| ------------------------------------------------------

|PROCESO EventoPanta1_2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#999=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton1_2, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton1_2, "DISABLE";
         |FINSI;

         #931#0 = #999#0;
         |LEE 000#931=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton1_1, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton1_1, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE nPanta1, "BOTON,======> ", 1542, 1657, Boton1_1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,======> ", 2042, 2157, Boton1_2;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{136}}", 1042, 1157, Boton1_3;
     nBoton1_3 = FSalida;

     |ESTADO_CONTROL nBoton1_1, "DISABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "ENABLE";
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     aFichero = ("31" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #931 aFichero;

     |DBASE aBase;  |QBF aBase;

     aMas = aBase + "def/dslpw031.mas";
     |CARGA_DEF aMas, dslpw031@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "def/dslpm510.mas";
     |CARGA_DEF aMas, dslpm510@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "def/dslpm523.mas";
     |CARGA_DEF aMas, dslpm523@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = ("I1" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     aFichero = ("I2" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #998 aFichero;
     |ABRE #998;  |CIERRA #998;  |DELINDEX #998;

     aFichero = ("I3" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #997 aFichero;
     |ABRE #997;  |CIERRA #997;  |DELINDEX #997;

     |ABRET #931;
     |ABRET #997;
     |ABRET #998;
     |ABRET #999;

     FSalida = 2899;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #931;
     |CIERRAT #997;
     |CIERRAT #998;
     |CIERRAT #999;

     |DELINDEX #997;
     |DELINDEX #998;
     |DELINDEX #999;

     |DESCARGA_DEF #dslpm523@;
     |DESCARGA_DEF #dslpm510@;
     |DESCARGA_DEF #dslpw031@;
|FPRC;

|PROGRAMA;
     |PINPA #0#934;  nPanta1 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1  = 1060;
     nPos2  = 2698;

     |LINEAL_SIMPLE #1#931, nRango, nPos1, nPos2, BajaPanta1_1, AltaPanta1_1, NULL;
     nGrid1 = FSalida;

     nPos1  = 1002;
     nPos2  = 2639;

     |LINEAL_SIMPLE #1#999, nRango, nPos1, nPos2, BajaPanta1_2, AltaPanta1_2, EventoPanta1_2;
     nGrid2 = FSalida;

     |HAZ BotonesPanta1;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir";
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1_1;
     |FIN_CONTROL_WINDOWS nBoton1_2;
     |FIN_CONTROL_WINDOWS nBoton1_3;

     |DESTRUYECONTROL nGrid1;
     |DESTRUYECONTROL nGrid2;

     |PULSATECLA;
|FPRO;
