|| ---------------------------------------
|| Documento de Seguridad
|| ---------------------------------------

|FICHEROS;
     dslpz001 #0;
     dslpm001 #1;
     dslpm002 #2;
     dslpm004 #4;
     dslpm005 #5;
     dslpm006 #6;
     dslpm007 #7;
     dslpm008 #8;
     dslpm100 #100;
     dslpw051 #951;
     dslpw052 #952;
     dslpw054 #954;
     dslpw101 #1001;
|FIN;

|VARIABLES;
      aAlfa         = "";
      aAlfa1        = "";
      aDocRtf       = "";
      aNif          = "";
      aFichero      = "";
      aDesResponS   = "";
      aDesResponP   = "";
      aNombre       = "";
      aNivel        = "";
      aAlfaAlto     = "";
      aAlfaMedio    = "";
      aAlfaBasico   = "";
      aGuaRespon    = "";
      aDepar        = "";
      aAsigna1      = "";
      aAsigna2      = "";
      aAsigna3      = "";
      aAsigna4      = "";
      aAsigna5      = "";
      aFrase        = "";
      aFrase1       = "";
      aFrase2       = "";
      aFrase3       = "";
      aFrase4       = "";
      aFrase5       = "";
      aLong         = "";
      aCompleta     = "";
      aBase         = "";
      aAbre         = "";
      aIPRemoto     = "";

      nNumFich      = 0;
      nHandle       = 0;
      nSwHay        = 0;
      nPers         = 0;
      nCampo        = 0;
      nHastaCampo   = 0;
      nContador     = 0;
      nTabla        = 0;
      nPara         = 0;
      nBuffer       = 0;
      nFrase        = 0;
      nLong         = 0;
      nLong1        = 0;
      nLong2        = 0;


     &enCliente      = 0;
     &enModelo       = 0;
     &enFichero      = 0;
     &eaNomFichero   = "";
     &enError        = 0;
     &eaAlfa         = "";
     &eaAsigna       = "";
     &eaConten       = "";
     &eaHora         = "";
     &enWord1        = 0;
     &enCamWord      = 0;
     &enCargaPuntero = 0;
     &eaGuarda       = "";
     &enTipoDoc      = 0;
     &enDocumento    = 0;

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerGuarda  = "";
     &eaDirSerPlan    = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaDestinoTra    = "";
     &eaFicheroTra    = "";
     &eaFicheroDef    = "";
     &eaFicheroXgz    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &eaFicheroTxt    = "";
     &enHandleTxt     = 0;
     &eaFicheroPlaGz  = "";
     &eaFicheroPlaMl  = "";
     &eaPathLogo      = "";
     &eaRaiz          = "";
     &eaModoPresenta  = "";
|FIN;

|| ------------------------------------------------------
|| Procesos de la Generacion del Documento de Seguridad
|| ------------------------------------------------------

|PROCESO dslpm006C2;
     |SI aNif = #6#5;  |ACABA;  |FINSI;

     aNif    = #6#5;
     |SI nContador ! 0;
         eaAsigna = "T}1}" + nContador + "}1}+F";
         eaConten = "1";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #6#6;                                   |HAZ QuitaRaros;
     eaAsigna = "T}1}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;
|FPRC;

|DEFBUCLE dslpm006C2;
     #6#2;
     ;
     #5#0, #5#1, #5#2, "            ";
     #5#0, #5#1, #5#2, "zzzzzzzzzzzz";
     ;
     NULL, dslpm006C2;
|FIN;

|PROCESO RespTratamiento;
     aNif      = "";
     nContador = 0;
     |BUCLE dslpm006C2;

     |SI nContador = 0;
         eaAlfa   = #4#6; |HAZ QuitaRaros;
         eaAsigna = "T}1}1}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;
|FPRC;

|PROCESO dslpm006C3;
     |SI aNif = #6#7;  |ACABA;  |FINSI;

     aNif = #6#7;
     |SI nContador ! 0;
         eaAsigna  = "T}2}" + nContador + "}1}+F";
         eaConten  = "1";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa   = #6#8;                                   |HAZ QuitaRaros;
     eaAsigna = "T}2}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;
|FPRC;

|DEFBUCLE dslpm006C3;
     #6#3;
     ;
     #5#0, #5#1, #5#2, "            ";
     #5#0, #5#1, #5#2, "zzzzzzzzzzzz";
     ;
     NULL, dslpm006C3;
|FIN;

|PROCESO EncTratamiento;
     aNif      = "";
     nContador = 0;
     |BUCLE dslpm006C3;
     |SI nContador = 0;
         eaAlfa = #4#18;                                   |HAZ QuitaRaros;
         eaAsigna = "T}2}1}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;
|FPRC;

|PROCESO dslpm007;
     |SI nContador ! 0;
         eaAsigna  = "T}3}" + nContador + "}1}+F";
         eaConten  = "1";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa   = #7#3;                           |HAZ QuitaRaros;
     eaAsigna = "T}3}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #7#4;                           |HAZ QuitaRaros;
     eaAsigna = "T}3}" + nContador + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;
|FPRC;

|DEFBUCLE dslpm007;
     #7#1;
     ;
     #5#0, #5#1, #5#2, "        ";
     #5#0, #5#1, #5#2, "zzzzzzzz";
     ;
     NULL, dslpm007;
|FIN;

|PROCESO Aplicaciones;
     nContador = 0;
     |BUCLE dslpm007;
|FPRC;

|PROCESO dslpm006C1;
     |SI nPers = 1;  nTabla = 4;  |FINSI;
     |SI nPers = 2;  nTabla = 5;  |FINSI;

     |SI nContador ! 0;
         eaAsigna = "T}" + nTabla + "}" + nContador + "}1}+F";
         eaConten = "1";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa   = #6#4;                  |HAZ QuitaRaros;
     eaAsigna = "T}" + nTabla + "}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     |SI nPers = 1;  eaAlfa = #6#6;  |FINSI;
     |SI nPers = 2;  eaAlfa = #6#8;  |FINSI;

     |HAZ QuitaRaros;

     eaAsigna = "T}" + nTabla + "}" + nContador + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;
|FPRC;

|DEFBUCLE dslpm006C1;
     #6#1;
     ;
     #5#0, #5#1, #5#2, "   ";
     #5#0, #5#1, #5#2, "zzz";
     ;
     NULL, dslpm006C1;
|FIN;

|PROCESO RespDepartamento;
     nContador = 0;
     nPers     = 1;
     |BUCLE dslpm006C1;
     |SI nContador = 0;
         eaAlfa   = #4#5;            |HAZ QuitaRaros;
         eaAsigna = "T}4}1}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         eaAlfa   = #4#6;              |HAZ QuitaRaros;
         eaAsigna = "T}4}1}2}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;
|FPRC;

|PROCESO EncDepartamento;
     nContador = 0;
     nPers     = 2;
     |BUCLE dslpm006C1;
     |SI nContador = 0;
         eaAlfa   = #4#17;        |HAZ QuitaRaros;
         eaAsigna = "T}5}1}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         eaAlfa   = #4#18;          |HAZ QuitaRaros;
         eaAsigna = "T}5}1}2}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;
|FPRC;

|PROCESO Copias;
     nHastaCampo = 0;
     |PARA nCampo = 62;  |SI nCampo ] 33;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #4nCampo;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo = 0;
         eaConten = "";
         eaAsigna = "X<<COPIAS>>";  |HAZ GrabaFicheroExterno;
     |SINO;
         |HAZ CopiaRTF;
         aDocRtf = eaDirTrabajo + "planilla.rtf";
         |XABRE "CA", aDocRtf, nHandle;
         |SI FSalida ] 0;
             |PARA nCampo = 33;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
                   eaAlfa  = #4nCampo;  |QBF eaAlfa;
                   |SI nCampo = 33;
                       eaAlfa  = "{\b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |SINO;
                       eaAlfa  = " \b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |FINSI;
                   |HAZ QuitaRaros;
                   |XGRABA nHandle, eaAlfa;
              |SIGUE;
              eaAlfa  = " \par} }";
              |XGRABA nHandle, eaAlfa;
         |FINSI;
         |XCIERRA nHandle;

         eaAsigna = "<<COPIAS>>";
         eaConten = aDocRtf;
         |HAZ PegarWordId1;
         |RFBORRA aDocRtf;
     |FINSI;
|FPRC;

|PROCESO DescEstructura;
     nHastaCampo = 0;
     |PARA nCampo = 108;  |SI nCampo ] 79;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #4nCampo;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo = 0;
         eaConten = "";
         eaAsigna = "X<<DESESTRUCTURA>>";  |HAZ GrabaFicheroExterno;
     |SINO;
         |HAZ CopiaRTF;
         aDocRtf = eaDirTrabajo + "planilla.rtf";
         |XABRE "CA", aDocRtf, nHandle;
         |SI FSalida ] 0;
             |PARA nCampo = 79;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
                   eaAlfa  = #4nCampo;  |QBF eaAlfa;
                   |SI nCampo = 79;
                       eaAlfa  = "{\b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |SINO;
                       eaAlfa  = " \b\f1\cf9\insrsid8939702\charrsid8939702 " + eaAlfa;
                   |FINSI;
                   |HAZ QuitaRaros;
                   |XGRABA nHandle, eaAlfa;
              |SIGUE;
              eaAlfa  = " \par} }";
              |XGRABA nHandle, eaAlfa;
         |FINSI;
         |XCIERRA nHandle;

         eaAsigna = "<<DESESTRUCTURA>>";
         eaConten = aDocRtf;
         |HAZ PegarWordId1;
         |RFBORRA aDocRtf;
     |FINSI;
|FPRC;

|PROCESO Mantenimiento;
     nHastaCampo = 0;
     |PARA nCampo = 138;  |SI nCampo ] 109;  |HACIENDO nCampo = nCampo - 1;
           aAlfa = #4nCampo;  |QBF aAlfa;
           |SI aAlfa ! "";
               nHastaCampo = nCampo;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nHastaCampo = 0;
         eaConten = "";
         eaAsigna = "X<<MANTENIMIENTO>>";  |HAZ GrabaFicheroExterno;
     |SINO;
         |HAZ CopiaRTF;
         aDocRtf = eaDirTrabajo + "planilla.rtf";
         |XABRE "CA", aDocRtf, nHandle;
         |SI FSalida ] 0;
             |PARA nCampo = 109;  |SI nCampo [ nHastaCampo;  |HACIENDO nCampo = nCampo + 1;
                   eaAlfa = #4nCampo;  |QBF eaAlfa;
                   eaAlfa  = "{\b\f1\cf9\insrsid8939702\charrsid8939702 " + &9 + eaAlfa + " \par}";
                   |HAZ QuitaRaros;
                   |XGRABA nHandle, eaAlfa;
              |SIGUE;

              eaAlfa  = " }";
              |XGRABA nHandle, eaAlfa;
         |FINSI;
         |XCIERRA nHandle;

         eaAsigna = "<<MANTENIMIENTO>>";
         eaConten = aDocRtf;
         |HAZ PegarWordId1;
         |RFBORRA aDocRtf;
     |FINSI;
|FPRC;

|PROCESO AsignaSourcing;
     aAlfa = eaAlfa;
     |SI nContador ! 1;
         eaAsigna = "T}" + nTabla +"}" + nContador + "}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}" + nTabla +"}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;
     |FINSI;
     eaAlfa = aAlfa;

     nContador = nContador + 1;

     |QBF eaAlfa;  |HAZ QuitaRaros;

     eaAsigna = "T}" + nTabla +"}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #2#2;  |HAZ QuitaRaros;
     eaAsigna = "T}" + nTabla +"}" + nContador + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;
|FPRC;

|PROCESO dslpm002aa;
     |SI #2#35 = "N";  |Y #2#36 = "N";  |Y #2#37 = "N";
      |Y #2#38 = "N";  |Y #2#39 = "N";  |Y #2#40 = "N";
         |ACABA;
     |FINSI;

     |SI #2#35 = "S";  eaAlfa = "Bancos";                 |HAZ AsignaSourcing;  |FINSI;
     |SI #2#36 = "S";  eaAlfa = "Informatica";            |HAZ AsignaSourcing;  |FINSI;
     |SI #2#37 = "S";
          |SI #2#44 = "S"; |Y #2#45 = "S";
               eaAlfa = "Asesoria (Fiscal y Laboral)"; |HAZ AsignaSourcing;
          |SINO;
               |SI #2#43 = "S"; eaAlfa = "Asesoria (LPD)"; |HAZ AsignaSourcing; |FINSI;
               |SI #2#44 = "S"; eaAlfa = "Asesoria (Fiscal)"; |HAZ AsignaSourcing; |FINSI;
               |SI #2#45 = "S"; eaAlfa = "Asesoria (Laboral)"; |HAZ AsignaSourcing; |FINSI;
          |FINSI;
     |FINSI;
     |SI #2#38 = "S";  eaAlfa = "Auditoria";              |HAZ AsignaSourcing;  |FINSI;
     |SI #2#39 = "S";  eaAlfa = "Prevenci¢n de Riesgos";  |HAZ AsignaSourcing;  |FINSI;
     |SI #2#40 = "S";  eaAlfa = #2#41;                    |HAZ AsignaSourcing;  |FINSI;
|FPRC;

|DEFBUCLE dslpm002aa;
     #2#1;
     ;
     #4#0, "            ";
     #4#0, "zzzzzzzzzzzz";
     ;
     NULL, dslpm002aa;
|FIN;

|PROCESO OutSourcing;
     |SI enTipoDoc = 90;  nTabla = 6; |FINSI;
     |SI enTipoDoc = 91;  nTabla = 5; |FINSI;
     |SI enTipoDoc = 92;  nTabla = 1; |FINSI;

     nContador = 1;
     |BUCLE dslpm002aa;
|FPRC;

|PROCESO PonDirigirseA;
     |SI #5#243 ! "            ";
         aNif    = #5#243;  |HAZ LeeNif;
     |SINO;
         aNif    = #5#6;    |HAZ LeeNif;
     |FINSI;

     aAlfa = #100#2;  |QBF aAlfa;
     aAlfa = aAlfa + " " + #100#3;  |QBF aAlfa;
     |SI #100#4 ! "    ";
         aAlfa = aAlfa + ", Numero: " + #100#4;  |QBF aAlfa;
     |FINSI;
     |SI #100#5 ! "   ";
         aAlfa = aAlfa + ", Escalera: " + #100#5;  |QBF aAlfa;
     |FINSI;
     |SI #100#6 ! "  ";
         aAlfa = aAlfa + ", Piso: " + #100#6;  |QBF aAlfa;
     |FINSI;
     |SI #100#7 ! "  ";
         aAlfa = aAlfa + ", Puerta: " + #100#7;  |QBF aAlfa;
     |FINSI;

     eaAlfa   = aAlfa;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm001#4#";  |HAZ GrabaFicheroExterno;

     aAlfa    = (("00" + #100#8) % -102) + (("000" + #100#9) % -103);
     aAlfa    = aAlfa + " " + #100#10;  |QBF aAlfa;
     aAlfa    = aAlfa + " (" + #100#11;  |QBF aAlfa;
     aAlfa    = aAlfa + ")";
     eaAlfa   = aAlfa;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm001#12#";  |HAZ GrabaFicheroExterno;
|FPRC;

|PROCESO PorFichero;
     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = enModelo;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = enModelo;
     #5#2 = enFichero;
     |LEE 000#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     eaAlfa   = #1#2;              |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm001#2#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#3;              |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#3#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#4;              |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#4#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#5;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#5#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#7;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#7#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#17;            |QBF eaAlfa;
     |SI eaAlfa ! ""
         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como"; |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO6#";   |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado del Fichero";    |HAZ QuitaRaros
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO7#";   |HAZ GrabaFicheroExterno;

         eaAlfa   = "objeto del presente Documento de Seguridad a"; |HAZ QuitaRaros
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO8#";   |HAZ GrabaFicheroExterno;
     |SINO;
         eaConten = "";
         eaAsigna = "V#FRASEENCFICHERO6#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO7#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO8#";   |HAZ GrabaFicheroExterno;
     |FINSI;

     eaAlfa   = #5#17;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#17#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#9;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#9#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#11;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#11#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#13;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#13#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#15;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#15#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#19;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#19#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#21;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#21#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#23;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#23#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#25;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#25#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#8;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#8#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#28;
     |SI #4#27 = "D";  eaAlfa = "DIARIA";     |FINSI;
     |SI #4#27 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#27 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#27 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#27 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#27#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#30;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#30#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#31;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#31#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#32;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#32#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#63;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#63#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#64;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#64#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#66;
     |SI #4#65 = "D";  eaAlfa = "DIARIO";     |FINSI;
     |SI #4#65 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#65 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#65 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#65 = "T";  eaAlfa = "TRIMESTRAL"; |FINSI;
     |SI #4#65 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |SI #4#65 = "B";  eaAlfa = "BIANUAL";    |FINSI;
     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#65#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#67;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#67#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#70 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#70#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#71 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#71#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#74;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#74#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#75 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#75#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#77;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#77#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#78;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#78#";  |HAZ GrabaFicheroExterno;

     |HAZ PonDirigirseA;
     |HAZ RespTratamiento;
     |HAZ EncTratamiento;
     |HAZ Aplicaciones;
     |HAZ RespDepartamento;
     |HAZ EncDepartamento;
     |HAZ Copias;
     |HAZ DescEstructura;
     |HAZ Mantenimiento;
     |HAZ OutSourcing;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = enModelo;
     #5#2 = enFichero;
     |LEE 101#5=;
     |SI FSalida = 0;
         #5#239 = ~;
         #5#240 = eaHora;
         |GRABA 020#5a;
         |LIBERA #5;
     |FINSI;
     |CIERRA #5;

     #1001#0 = #0#0;
     #1001#1 = enModelo;
     #1001#2 = enFichero;
     |LEE 000#1001=;
     |SI FSalida = 0;
         #1001#5 = ~;
         #1001#6 = eaHora;
         |GRABA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO LeeNif;
     |ABRE #100;
     #100#0 = aNif;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;
|FPRC;

|PROCESO GrabaNif;
     |SI aNif = "            ";  |ACABA;  |FINSI;

     #951#0  = #5#1;
     #951#1  = #5#2;
     #951#2  = aNif;
     |LEE 101#951=;
     |SI FSalida ! 0;
         |DDEFECTO #951;
         #951#0  = #5#1;
         #951#1  = #5#2;
         #951#2  = aNif;
         |GRABA 020#951b;
     |FINSI;

     #951#3     = aNombre;
     #951#4     = #100#2;
     #951#5     = #100#3;
     #951#6     = #100#4;
     #951#7     = #100#5;
     #951#8     = #100#6;
     #951#9     = #100#7;
     #951#10    = #100#8;
     #951#11    = #100#9;
     #951#12    = #100#10;
     #951#13    = #100#11;
     #951#14    = #100#12;
     #951#15    = #100#13;
     #951#16    = #100#14;
     #951#17    = #100#15;
     #951#30    = #1#18;
     #951#44    = #5#3;
     #951#45    = #5#4;
     #951nCampo = "S";
     #951#47    = aDepar;

     |GRABA 020#951a;
     |LIBERA #951;
|FPRC;

|PROCESO dslpm006z1;
     |SI #6#5  ! "            ";
         aNif    = #6#5;  |HAZ LeeNif;
         aNombre = #6#6;
         nCampo  = 19;
         aDepar  = #6#4;
         nPara   = 1;
         |HAZ GrabaNif;
     |FINSI;

     |SI #6#7  ! "            ";
         aNif    = #6#7;  |HAZ LeeNif;
         aNombre = #6#8;
         nCampo  = 25;
         aDepar  = #6#4;
         nPara   = 1;
         |HAZ GrabaNif;
     |FINSI;
|FPRC;

|DEFBUCLE dslpm006z1;
     #6#2;
     ;
     #5#0, #5#1, #5#2, "            ";
     #5#0, #5#1, #5#2, "zzzzzzzzzzzz";
     ;
     NULL, dslpm006z1;
|FIN;

|PROCESO dslpm005z1_1;
     #dslpw054#0 = #dslpm005#1;
     #dslpw054#2 = #dslpm005#2;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     #5#239 = ~;
     #5#240 = eaHora;
     |GRABA 020#5a;
     |LIBERA #5;

     #1001#0 = #5#0;
     #1001#1 = #5#1;
     #1001#2 = #5#2;
     |LEE 000#1001=;
     |SI FSalida = 0;
         #1001#5 = ~;
         #1001#6 = eaHora;
         |GRABA 020#1001a;
         |LIBERA #1001;
     |FINSI;

     |SI nContador ! 0;
         eaAsigna  = "T}1}" + nContador + "}1}+F";
         eaConten  = "1";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa   = #5#3;                                   |HAZ QuitaRaros;
     eaAsigna = "T}1}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#4;                                   |HAZ QuitaRaros;
     eaAsigna = "T}1}" + nContador + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     |SI #5#243 ! "            ";
         aNif    = #5#243;  |HAZ LeeNif;
         aNombre = #5#244;
         nCampo  = 46;
         aDepar  = "";
         |HAZ GrabaNif;
     |SINO;
         aNif    = #5#6;  |HAZ LeeNif;
         aNombre = #5#7;
         nCampo  = 46;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#6   ! "            ";
         aNif    = #5#6;  |HAZ LeeNif;
         aNombre = #5#7;
         nCampo  = 18;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#16  ! "            ";
         aNif    = #5#16;  |HAZ LeeNif;
         aNombre = #5#17;
         nCampo  = 24;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#8   ! "            ";
         aNif    = #5#8;  |HAZ LeeNif;
         aNombre = #5#9;
         nCampo  = 20;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#18  ! "            ";
         aNif    = #5#18;  |HAZ LeeNif;
         aNombre = #5#19;
         nCampo  = 26;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#10  ! "            ";
         aNif    = #5#10;  |HAZ LeeNif;
         aNombre = #5#11;
         nCampo  = 21;
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#20  ! "            ";
         aNif    = #5#20;  |HAZ LeeNif;
         aNombre = #5#21;
         nCampo  = 27;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#12  ! "            ";
         aNif    = #5#12;  |HAZ LeeNif;
         aNombre = #5#13;
         nCampo  = 22;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#22  ! "            ";
         aNif    = #5#22;  |HAZ LeeNif;
         aNombre = #5#23;
         nCampo  = 28;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#14  ! "            ";
         aNif    = #5#14;  |HAZ LeeNif;
         aNombre = #5#15;
         nCampo  = 23;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     |SI #5#24  ! "            ";
         aNif    = #5#24;  |HAZ LeeNif;
         aNombre = #5#25;
         nCampo  = 29;
         aDepar  = "";
         |HAZ GrabaNif;
     |FINSI;

     nPara = 0;
     |BUCLE dslpm006z1;
     |SI nPara = 0;
         aNif    = #4#5;  |HAZ LeeNif;
         aNombre = #4#6;
         nCampo  = 19;
         aDepar  = "Sin Departamento";
         |HAZ GrabaNif;

         aNif    = #4#17;  |HAZ LeeNif;
         aNombre = #4#18;
         nCampo  = 25;
         aDepar  = "Sin Departamento";
         |HAZ GrabaNif;
     |FINSI;

     #952#0 = #5#1;
     #952#1 = #5#2;
     |LEE 101#952=;
     |SI FSalida ! 0;
         |DDEFECTO #952;
         #952#0 = #5#1;
         #952#1 = #5#2;
         |GRABA 020#952b;
     |FINSI;

     #952#2 = #5#5;
     #952#3 = #5#3;
     #952#4 = #5#4;
     |GRABA 020#952a;
     |LIBERA #952;
|FPRC;

|DEFBUCLE dslpm005z1_1;
     #5#1;
     ;
     #1#1, 0000, 00000;
     #1#1, 9999, 99999;
     be;
     NULL, dslpm005z1_1;
|FIN;

|PROCESO dslpw051_1;
     #dslpw054#0 = #dslpw051#0;
     #dslpw054#2 = #dslpw051#1;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     |SI aNif = #951#2;
         eaAlfa = eaAlfa + ", " + #951#44;  |QBF eaAlfa;
         |ACABA;
     |FINSI;

     |SI aNif ! "";
         |HAZ QuitaRaros;
         eaAsigna = "T}2}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;

     aNif = #951#2;

     |SI nContador ! 0;
         eaAsigna = "T}2}" + nContador + "}1}+F";
         eaConten = "1";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     nContador = nContador + 1;

     eaAlfa = #951#4;  |QBF eaAlfa;
     eaAlfa = eaAlfa + " " + #951#5;  |QBF eaAlfa;
     |SI #951#6 ! "    ";
         eaAlfa = eaAlfa + ", " + #951#6;  |QBF eaAlfa;
     |FINSI;
     |SI #951#7 ! "   ";
         eaAlfa = eaAlfa + " " + #951#7;  |QBF eaAlfa;
     |FINSI;
     |SI #951#8 ! "  ";
         eaAlfa = eaAlfa + " " + #951#8;  |QBF eaAlfa;
     |FINSI;
     |SI #951#9 ! "  ";
         eaAlfa = eaAlfa + " " + #951#9;  |QBF eaAlfa;
     |FINSI;

     eaAlfa = eaAlfa + ", " + (("00" + #951#10) % -102) + (("000" + #951#11) % -103);
     eaAlfa = eaAlfa + " " + #951#12;   |QBF eaAlfa;
     eaAlfa = eaAlfa + " (" + #951#13;  |QBF eaAlfa;
     eaAlfa = eaAlfa + ") para el/los fichero/s:";
     eaAlfa = eaAlfa + " " + #951#44;  |QBF eaAlfa;
|FPRC;

|DEFBUCLE dslpw051_1;
     #951#2;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_1;
|FIN;

|PROCESO Ubicaciones;
     nContador = 0;
     aNif      = "";
     |BUCLE dslpw051_1;
     |SI nContador ! 0;
         |HAZ QuitaRaros;
         eaAsigna = "T}2}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;
|FPRC;

|PROCESO dslpw051_2;
     #dslpw054#0 = #dslpw051#0;
     #dslpw054#2 = #dslpw051#1;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     |SI aNif = "";
         nContador  = 2;
         eaAsigna   = "T}3}2}1}";
         eaConten   = "Responsable de los Ficheros:";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     |SI aNif = #951#2;
         eaAlfa = eaAlfa + ", " + #951#44;  |QBF eaAlfa;
         |ACABA;
     |FINSI;

     |SI aNif ! "";
         eaAsigna    = "T}3}2}1}";
         eaConten    = "Responsables de los Ficheros:";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;
     |FINSI;

     aNif      = #951#2;
     nContador = nContador + 1;

     eaAlfa = #951#3;  |QBF eaAlfa;
     eaAlfa = eaAlfa + " para el/los ficheros: " + #951#44;  |QBF eaAlfa;
|FPRC;

|DEFBUCLE dslpw051_2;
     #951#3;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_2;
|FIN;

|PROCESO dslpw051_3;
     |SI aNif = "";
         |SI nContador = 0;
             nContador = 2;
         |SINO;
             eaAsigna = "T}3}1}1}+G";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             eaAsigna = "T}3}1}1}+P";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             eaAsigna = "T}3}2}1}+G";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             eaAsigna = "T}3}2}1}+P";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             nContador = nContador + 2;
         |FINSI;

         aGuaRespon = "T}3}" + nContador + "}1}";
         eaAsigna   = aGuaRespon;
         aAlfa      = eaAlfa
         eaAlfa     = aDesResponS;  |HAZ QuitaRaros;
         eaConten   = eaAlfa;
         eaAlfa     = aAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;

     |SI aNif = #951#2;
         eaAlfa = eaAlfa + ", " + #951#44;  |QBF eaAlfa;
         |ACABA;
     |FINSI;

     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         eaAsigna   = aGuaRespon;
         aAlfa      = eaAlfa;
         eaAlfa     = aDesResponP;  |HAZ QuitaRaros;
         eaConten   = eaAlfa;
         eaAlfa     = aAlfa;
         |HAZ GrabaFicheroExterno;
     |FINSI;

     aNif      = #951#2;
     eaAlfa    = #951#3;  |QBF eaAlfa;
     eaAlfa    = eaAlfa + " para el/los ficheros: " + #951#44;  |QBF eaAlfa;
     nContador = nContador + 1;
|FPRC;

|DEFBUCLE dslpw051_3;
     #951#4;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|PROCESO dslpw051_4;
     |SI aNif = "";
         |SI nContador = 0;
             nContador = 2;
         |SINO;
             eaAsigna = "T}3}1}1}+G";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             eaAsigna = "T}3}1}1}+P";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             eaAsigna = "T}3}2}1}+G";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             eaAsigna = "T}3}2}1}+P";
             eaConten = "";
             |HAZ GrabaFicheroExterno;

             nContador = nContador + 2;
         |FINSI;

         aGuaRespon = "T}3}" + nContador + "}1}";
         eaAsigna   = aGuaRespon;
         aAlfa      = eaAlfa;
         eaAlfa     = aDesResponS;  |HAZ QuitaRaros;
         eaConten   = eaAlfa;
         eaAlfa     = aAlfa;
         |HAZ GrabaFicheroExterno;
     |SINO;
         |SI aNif ! #951#2;
             eaAsigna   = aGuaRespon;
             aAlfa      = eaAlfa;
             eaAlfa     = aDesResponP;  |HAZ QuitaRaros;
             eaConten   = eaAlfa;
             eaAlfa     = aAlfa;
             |HAZ GrabaFicheroExterno;
         |FINSI;
     |FINSI;

     |SI aNif ! #951#2;
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         nContador = nContador + 1;
         eaAlfa    = #951#3;  |QBF eaAlfa;
         |HAZ QuitaRaros;
         eaAsigna    = "T}3}" + nContador + "}1}";
         eaConten    = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;
     |FINSI;

     eaAsigna = "T}3}3}1}+G";
     eaConten = "";
     |HAZ GrabaFicheroExterno;

     eaAsigna = "T}3}1}1}+P";
     eaConten = "";
     |HAZ GrabaFicheroExterno;

     nContador = nContador + 1;
     eaAlfa    = &9 + " para el fichero: " + #951#44;  |QBF eaAlfa;
     eaAlfa    = eaAlfa + " y el departamento " + #951#47;  |QBF eaAlfa;

     |HAZ QuitaRaros;
     eaAsigna = "T}3}" + nContador + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaFicheroExterno;

     eaAlfa   = " para el fichero: " + #951#44;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + " y el departamento " + #951#47;  |QBF eaAlfa;
     eaConten = eaAlfa;

     nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

     aNif  = #951#2;
|FPRC;

|DEFBUCLE dslpw051_4;
     #951#5;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_4;
|FIN;

|DEFBUCLE dslpw051_5;
     #951#6;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_4;
|FIN;

|DEFBUCLE dslpw051_6;
     #951#7;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_7;
     #951#8;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_8;
     #951#9;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_9;
     #951#10;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_10;
     #951#11;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_11;
     #951#12;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_12;
     #951#13;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|DEFBUCLE dslpw051_13;
     #951#14;
     ;
     "S", "            ", "                                   ";
     "S", "zzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw051_3;
|FIN;

|PROCESO AsignaFrase;
     aFrase1 = "";
     aFrase2 = "";
     aFrase3 = "";
     aFrase4 = "";
     aFrase5 = "";
     aFrase  = "";
     nFrase  = 1;
     |PARA nPara = 1;  |SI nPara [ 50;  |HACIENDO nPara = nPara + 1;
           |DEL_BUF nBuffer, nPara, aAlfa;  |QBF aAlfa;

           |SI aAlfa ! "";
               |SI nPara = 1;
                   aCompleta = aAlfa;  |QBF aCompleta;
               |SINO;
                   aCompleta = ", " + aAlfa;  |QBF aCompleta;
               |FINSI;
               aLong  = aCompleta % 0;  nLong1 = aLong;
               aLong  = aFrase    % 0;  nLong2 = aLong;

               nLong  = nLong1 + nLong2;

               |SI nLong > 250;
                   nFrase = nFrase + 1;
                   aFrase = "";
               |SINO;
                   aFrase = aFrase + aCompleta;
               |FINSI;

               |SI nPara = 1;
                   |SI nFrase = 1;  aFrase1 = aAlfa;  |QBF aFrase1;  |FINSI;
                   |SI nFrase = 2;  aFrase2 = aAlfa;  |QBF aFrase2;  |FINSI;
                   |SI nFrase = 3;  aFrase3 = aAlfa;  |QBF aFrase3;  |FINSI;
                   |SI nFrase = 4;  aFrase4 = aAlfa;  |QBF aFrase4;  |FINSI;
                   |SI nFrase = 5;  aFrase5 = aAlfa;  |QBF aFrase5;  |FINSI;
               |SINO;
                   |SI nFrase = 1;  aFrase1 = aFrase1 + ", " + aAlfa;  |QBF aFrase1;  |FINSI;
                   |SI nFrase = 2;  aFrase2 = aFrase2 + ", " + aAlfa;  |QBF aFrase2;  |FINSI;
                   |SI nFrase = 3;  aFrase3 = aFrase3 + ", " + aAlfa;  |QBF aFrase3;  |FINSI;
                   |SI nFrase = 4;  aFrase4 = aFrase4 + ", " + aAlfa;  |QBF aFrase4;  |FINSI;
                   |SI nFrase = 5;  aFrase5 = aFrase5 + ", " + aAlfa;  |QBF aFrase5;  |FINSI;
               |FINSI;
           |FINSI;

           aAlfa = "";
           |AL_BUF nBuffer, nPara, aAlfa;
     |SIGUE;

     eaAlfa   = aFrase1;  |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = aAsigna1; |HAZ GrabaFicheroExterno;

     eaAlfa   = aFrase2;  |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = aAsigna2; |HAZ GrabaFicheroExterno;

     eaAlfa   = aFrase3;  |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = aAsigna3; |HAZ GrabaFicheroExterno;

     eaAlfa   = aFrase4;  |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = aAsigna4; |HAZ GrabaFicheroExterno;

     eaAlfa   = aFrase5;  |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = aAsigna5; |HAZ GrabaFicheroExterno;
|FPRC;

|PROCESO Responsables;
     |DIMENSIONA 50, nBuffer, 0;

     nContador = 0;
                     || Responsables de los Ficheros;

     aNif       = "";
     nPara      = 0;
     |BUCLE dslpw051_2;
     |SI aNif ! "";
         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         aAsigna1 = "V#FRASERESFICHERO1#";
         aAsigna2 = "V#FRASERESFICHERO2#";
         aAsigna3 = "V#FRASERESFICHERO3#";
         aAsigna4 = "V#FRASERESFICHERO4#";
         aAsigna5 = "V#FRASERESFICHERO5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASERESFICHERO1#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESFICHERO2#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESFICHERO3#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESFICHERO4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESFICHERO5#";    |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Encargado de los Ficheros;

     aNif        = "";
     aDesResponS = "Encargado de los Ficheros:";
     aDesResponP = "Encargados de los Ficheros:";
     nPara       = 0;
     |BUCLE dslpw051_3;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como"; |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO6#";   |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado/s de los Ficheros";    |HAZ QuitaRaros
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO7#";   |HAZ GrabaFicheroExterno;

         eaAlfa   = "objeto del presente Documento de Seguridad a"; |HAZ QuitaRaros
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO8#";   |HAZ GrabaFicheroExterno;

         aAsigna1 = "V#FRASEENCFICHERO1#";
         aAsigna2 = "V#FRASEENCFICHERO2#";
         aAsigna3 = "V#FRASEENCFICHERO3#";
         aAsigna4 = "V#FRASEENCFICHERO4#";
         aAsigna5 = "V#FRASEENCFICHERO5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCFICHERO1#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO2#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO3#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO5#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO6#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO7#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCFICHERO8#";    |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Responsable de Tratamiento

     aNif        = "";
     aDesResponS = "Responsable de Tratamiento:";
     aDesResponP = "Responsables de Tratamiento:";
     nPara      = 0;
     |BUCLE dslpw051_4;

     aAsigna1 = "V#FRASERESTRATAMIENTO1#";
     aAsigna2 = "V#FRASERESTRATAMIENTO2#";
     aAsigna3 = "V#FRASERESTRATAMIENTO3#";
     aAsigna4 = "V#FRASERESTRATAMIENTO4#";
     aAsigna5 = "V#FRASERESTRATAMIENTO5#";
     |HAZ AsignaFrase;

                     || Encargado de Tratamiento

     aNif        = "";
     aDesResponS = "Encargado de Tratamiento:";
     aDesResponP = "Encargados de Tratamiento:";
     nPara       = 0;
     |BUCLE dslpw051_5;
     |SI nPara = 0;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCTRATAMIENTO1#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO2#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO3#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO4#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO5#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO6#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO7#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCTRATAMIENTO8#";   |HAZ GrabaFicheroExterno;
     |SINO;
         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCTRATAMIENTO1#";   |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado/s del Tratamiento";    |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCTRATAMIENTO2#";       |HAZ GrabaFicheroExterno;

         eaAlfa   = "de los respectivos departamentos en lo que se divide la entidad a las siguientes personas:";
                                                    |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCTRATAMIENTO3#";       |HAZ GrabaFicheroExterno;

         aAsigna1 = "V#FRASEENCTRATAMIENTO4#";
         aAsigna2 = "V#FRASEENCTRATAMIENTO5#";
         aAsigna3 = "V#FRASEENCTRATAMIENTO6#";
         aAsigna4 = "V#FRASEENCTRATAMIENTO7#";
         aAsigna5 = "V#FRASEENCTRATAMIENTO8#";
         |HAZ AsignaFrase;
     |FINSI;

                     || Responsable de Seguridad;

     aNif        = "";
     aDesResponS = "Responsable de Seguridad:";
     aDesResponP = "Responsables de Seguridad:";
     nPara       = 0;
     |BUCLE dslpw051_6;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         aAsigna1 = "V#FRASERESSEGURIDAD1#";
         aAsigna2 = "V#FRASERESSEGURIDAD2#";
         aAsigna3 = "V#FRASERESSEGURIDAD3#";
         aAsigna4 = "V#FRASERESSEGURIDAD4#";
         aAsigna5 = "V#FRASERESSEGURIDAD5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASERESSEGURIDAD1#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESSEGURIDAD2#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESSEGURIDAD3#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESSEGURIDAD4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESSEGURIDAD5#";    |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Encargado de Seguridad;

     aNif        = "";
     aDesResponS = "Encargado de Seguridad:";
     aDesResponP = "Encargados de Seguridad:";
     nPara       = 0;
     |BUCLE dslpw051_7;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCSEGURIDAD1#";     |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado/s de Seguridad";     |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCSEGURIDAD2#";         |HAZ GrabaFicheroExterno;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCSEGURIDAD3#";         |HAZ GrabaFicheroExterno;


         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCSEGURIDAD4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD5#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD6#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD7#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD8#";    |HAZ GrabaFicheroExterno;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCSEGURIDAD1#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD2#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD3#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD4#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD5#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD6#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD7#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCSEGURIDAD8#";   |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Responsable de Copias;

     aNif        = "";
     aDesResponS = "Responsable de Copias de Respaldo y Recuperaci¢n:";
     aDesResponP = "Responsables de Copias de Respaldo y Recuperaci¢n:";
     nPara       = 0;
     |BUCLE dslpw051_8;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         aAsigna1 = "V#FRASERESCOPIAS1#";
         aAsigna2 = "V#FRASERESCOPIAS2#";
         aAsigna3 = "V#FRASERESCOPIAS3#";
         aAsigna4 = "V#FRASERESCOPIAS4#";
         aAsigna5 = "V#FRASERESCOPIAS5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASERESCOPIAS1#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESCOPIAS2#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESCOPIAS3#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESCOPIAS4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESCOPIAS5#";    |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Encargado de Copias;

     aNif        = "";
     aDesResponS = "Encargado de Copias de Respaldo y Recuperaci¢n:";
     aDesResponP = "Encargados de Copias de Respaldo y Recuperaci¢n:";
     nPara       = 0;
     |BUCLE dslpw051_9;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCCOPIA1#";                                 |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado/s de Copias de Respaldo y Recuperaci¢n"; |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCCOPIA2#";          |HAZ GrabaFicheroExterno;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCCOPIA3#";         |HAZ GrabaFicheroExterno;

         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCCOPIA4#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA5#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA6#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA7#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA8#";          |HAZ GrabaFicheroExterno;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCCOPIA#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA1#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA2#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA3#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA4#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA5#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA6#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA7#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCCOPIA8#";   |HAZ GrabaFicheroExterno;
     |FINSI;
                     || Responsable de Incidencias;

     aNif        = "";
     aDesResponS = "Responsable del Registro de Incidencias:";
     aDesResponP = "Responsables del Registro de Incidencias:";
     nPara       = 0;
     |BUCLE dslpw051_10;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         aAsigna1 = "V#FRASERESINCIDENCIAS1#";
         aAsigna2 = "V#FRASERESINCIDENCIAS2#";
         aAsigna3 = "V#FRASERESINCIDENCIAS3#";
         aAsigna4 = "V#FRASERESINCIDENCIAS4#";
         aAsigna5 = "V#FRASERESINCIDENCIAS5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASERESINCIDENCIAS1#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESINCIDENCIAS2#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESINCIDENCIAS3#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESINCIDENCIAS4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESINCIDENCIAS5#";    |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Encargado de Incidencias;

     aNif        = "";
     aDesResponS = "Encargado del Registro de Incidencias:";
     aDesResponP = "Encargados del Registro de Incidencias:";
     nPara       = 0;
     |BUCLE dslpw051_11;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCINCIDENCIA1#";                                 |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado/s del Registro de Incidencias"; |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCINCIDENCIA2#";          |HAZ GrabaFicheroExterno;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCINCIDENCIA3#";         |HAZ GrabaFicheroExterno;

         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCINCIDENCIA4#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA5#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA6#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA7#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA8#";          |HAZ GrabaFicheroExterno;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCINCIDENCIA#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA1#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA2#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA3#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA4#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA5#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA6#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA7#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCINCIDENCIA8#";   |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Responsable de Atencion a los Afectados

     aNif        = "";
     aDesResponS = "Responsable de Atenci¢n a los Afectados:";
     aDesResponP = "Responsables de Atenci¢n a los Afectados:";
     nPara       = 0;
     |BUCLE dslpw051_12;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         aAsigna1 = "V#FRASERESAFECTADOS1#";
         aAsigna2 = "V#FRASERESAFECTADOS2#";
         aAsigna3 = "V#FRASERESAFECTADOS3#";
         aAsigna4 = "V#FRASERESAFECTADOS4#";
         aAsigna5 = "V#FRASERESAFECTADOS5#";
         |HAZ AsignaFrase;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASERESAFECTADOS1#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESAFECTADOS2#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESAFECTADOS3#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESAFECTADOS4#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASERESAFECTADOS5#";    |HAZ GrabaFicheroExterno;
     |FINSI;

                     || Encargado de Atencion a los Afectados

     aNif        = "";
     aDesResponS = "Encargado de Atenci¢n a los Afectados:";
     aDesResponP = "Encargados de Atenci¢n a los Afectados:";
     nPara       = 0;
     |BUCLE dslpw051_13;
     |SI aNif ! "";
         eaAsigna = "T}3}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}3}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         |HAZ QuitaRaros;
         eaAsigna = "T}3}" + nContador + "}1}";
         eaConten = eaAlfa;
         |HAZ GrabaFicheroExterno;

         nPara = nPara + 1;  |AL_BUF nBuffer, nPara, eaConten;

         eaAlfa   = "En aplicaci¢n de lo anterior, se designa/n como";  |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCAFECTADO1#";                                 |HAZ GrabaFicheroExterno;

         eaAlfa   = "Encargado/s de Atenci¢n a los Afectados"; |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCAFECTADO2#";          |HAZ GrabaFicheroExterno;

         eaAlfa   = "a la/s persona/s expresada/s en el Cuadro de Responsables ";
         eaAlfa   = eaAlfa + "del Apartado correspondiente a Informaci¢n General ";
         eaAlfa   = eaAlfa + "de los Ficheros, del presente Documento de Seguridad.";
                                                        |HAZ QuitaRaros;
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCAFECTADO3#";         |HAZ GrabaFicheroExterno;

         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCAFECTADO4#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO5#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO6#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO7#";          |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO8#";          |HAZ GrabaFicheroExterno;
     |SINO;
         eaAlfa   = "";
         eaConten = eaAlfa;
         eaAsigna = "V#FRASEENCAFECTADO#";    |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO1#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO2#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO3#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO4#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO5#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO6#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO7#";   |HAZ GrabaFicheroExterno;
         eaAsigna = "V#FRASEENCAFECTADO8#";   |HAZ GrabaFicheroExterno;
     |FINSI;

     |FINDIM nBuffer;
|FPRC;

|PROCESO dslpw052_1;
     #dslpw054#0 = #dslpw052#0;
     #dslpw054#2 = #dslpw052#1;
     |LEE 000#dslpw054.=;
     |SI FSalida = 0;
        |SI #dslpw054#5 = " "; |ACABA; |FINSI;
     |SINO;
        |ACABA;
     |FINSI;

     |SI aNivel = "";
         nContador = 2;
         eaAsigna  = "T}4}2}1}";
         eaConten  = "Se califican de nivel " + #952#2;  |QBF eaConten;
         eaConten  = eaConten + " los siguientes ficheros:";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     |SI aNivel ! #952#2;  |Y aNivel ! "";
         eaAsigna = "T}4}1}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}4}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}4}2}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}4}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         nContador = nContador + 2;

         eaAsigna    = "T}4}" + nContador + "}1}";
         eaConten    = "Se califican de nivel " + #952#2;  |QBF eaConten;
         eaConten    = eaConten + " los siguientes ficheros:";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     |SI nContador ! 2;
         eaAsigna = "T}4}3}1}+G";
         eaConten = "";
         |HAZ GrabaFicheroExterno;

         eaAsigna = "T}4}1}1}+P";
         eaConten = "";
         |HAZ GrabaFicheroExterno;
     |FINSI;

     aNivel    = #952#2;
     nContador = nContador + 1;

     eaAlfa    = #952#3;  |QBF eaAlfa;           |HAZ QuitaRaros;
     eaAsigna  = "T}4}" + nContador + "}1}";
     eaConten  = eaAlfa;
     |HAZ GrabaFicheroExterno;

     nNumFich = nNumFich + 1;

     |SI #952#2 = "ALTO           ";
         |SI aAlfaAlto = "";
             aAlfaAlto = #952#3;  |QBF aAlfaAlto;
         |SINO;
             aAlfaAlto = aAlfaAlto + ", " + #952#3;  |QBF aAlfaAlto;
         |FINSI;
     |FINSI;

     |SI #952#2 = "MEDIO          ";
         |SI aAlfaMedio = "";
             aAlfaMedio = #952#3;  |QBF aAlfaMedio;
         |SINO;
             aAlfaMedio = aAlfaMedio + ", " + #952#3;  |QBF aAlfaMedio;
         |FINSI;
     |FINSI;

     |SI #952#2 = "BASICO         ";
         |SI aAlfaBasico = "";
             aAlfaBasico = #952#3;  |QBF aAlfaBasico;
         |SINO;
             aAlfaBasico = aAlfaBasico + ", " + #952#3;  |QBF aAlfaBasico;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dslpw052_1;
     #952#2;
     ;
     "               ", "                                   ";
     "zzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dslpw052_1;
|FIN;

|PROCESO Niveles;
     nContador    = 0;
     nNumFich     = 0;
     aNivel       = "";
     aAlfaAlto    = "";
     aAlfaMedio   = "";
     aAlfaBasico  = "";

     |BUCLE dslpw052_1;

     eaAlfa   = nNumFich;
     eaConten = eaAlfa;
     eaAsigna = "V#NUMFICH#";   |HAZ GrabaFicheroExterno;

     eaAlfa = "";
     |SI aAlfaBasico ! "";
         eaAlfa = aAlfaBasico + " de nivel BASICO";
     |FINSI;

     |SI aAlfaMedio ! "";
         |SI eaAlfa = "";
             eaAlfa = aAlfaMedio + " de nivel MEDIO";
         |SINO;
             eaAlfa = eaAlfa + ", " + aAlfaMedio + " de nivel MEDIO";
         |FINSI;
     |FINSI;

     |SI aAlfaAlto ! "";
         |SI eaAlfa = "";
             eaAlfa = aAlfaAlto + " de nivel ALTO";
         |SINO;
             eaAlfa = eaAlfa + ", " + aAlfaAlto + " de nivel ALTO";
         |FINSI;
     |FINSI;

     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#FRASESEGURIDAD#";   |HAZ GrabaFicheroExterno;
|FPRC;

|PROCESO PorEmpresa;
     aFichero = ("51" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #951 aFichero;
     |ABRE  #951;  |CIERRA #951;  |DELINDEX #951;

     aFichero = ("52" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #952 aFichero;
     |ABRE  #952;  |CIERRA #952;  |DELINDEX #952;

     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = 1;
     |LEE 000#4];
     |SI FSalida ! 0;  |O  #4#0 ! #0#0;
         |DDEFECTO #4;
     |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #4#0;
     #5#1 = #4#1;
     #5#2 = 0;
     |LEE 000#5];
     |SI FSalida ! 0;  |O #5#0 ! #4#0;  |O #5#1 ! #4#1;
         |DDEFECTO #5;
     |FINSI;
     |CIERRA #5;

     eaAlfa   = #1#2;                   |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm001#2#";        |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#8;              |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#8#";   |HAZ GrabaFicheroExterno;

     |SI #4#27 = "D";  eaAlfa = "DIARIA";     |FINSI;
     |SI #4#27 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#27 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#27 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#27 = "A";  eaAlfa = "ANUAL";      |FINSI;

     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#27#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#30;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#30#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#31;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#31#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#32;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#32#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#63;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#63#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#64;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#64#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#66;
     |SI #4#65 = "D";  eaAlfa = "DIARIO";     |FINSI;
     |SI #4#65 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#65 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#65 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#65 = "T";  eaAlfa = "TRIMESTRAL"; |FINSI;
     |SI #4#65 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |SI #4#65 = "B";  eaAlfa = "BIANUAL";    |FINSI;
     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#65#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#67;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#67#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#70 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#70#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#71 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#71#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#74;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#74#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#75 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#75#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#77;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#77#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#78;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#78#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#7;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#7#";   |HAZ GrabaFicheroExterno;

     |HAZ PonDirigirseA;

     |ABRE #951;
     |ABRE #952;
     nContador = 0;
     |BUCLE dslpm005z1_1;
     |CIERRA #951;
     |CIERRA #952;

     |HAZ Ubicaciones;
     |HAZ Responsables;
     |HAZ Niveles;
     |HAZ Copias;
     |HAZ DescEstructura;
     |HAZ Mantenimiento;
     |HAZ OutSourcing;

     |DELINDEX #951;
     |DELINDEX #952;

     |PULSATECLA;
|FPRC;

|PROCESO Anexos;
     |ABRE #1;
     |SELECT #2#1;
     #1#1 = #0#0;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = enModelo;
     |LEE 000#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = enModelo;
     #5#2 = enFichero;
     |LEE 000#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     eaAlfa   = #1#2;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm001#2#";   |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#8;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#8#";   |HAZ GrabaFicheroExterno;

     |SI #4#27 = "D";  eaAlfa = "DIARIA";     |FINSI;
     |SI #4#27 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#27 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#27 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#27 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#27#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#30;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#30#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#31;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#31#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#32;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#32#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#63;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#63#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#64;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#64#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#66;
     |SI #4#65 = "D";  eaAlfa = "DIARIO";     |FINSI;
     |SI #4#65 = "S";  eaAlfa = "SEMANAL";    |FINSI;
     |SI #4#65 = "Q";  eaAlfa = "QUINCENAL";  |FINSI;
     |SI #4#65 = "M";  eaAlfa = "MENSUAL";    |FINSI;
     |SI #4#65 = "T";  eaAlfa = "TRIMESTRAL"; |FINSI;
     |SI #4#65 = "A";  eaAlfa = "ANUAL";      |FINSI;
     |SI #4#65 = "B";  eaAlfa = "BIANUAL";    |FINSI;
     |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#65#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#67;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#67#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#70 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#70#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#71 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#71#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#74;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#74#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = "NO";
     |SI #4#75 = "S";  eaAlfa = "SI";     |FINSI;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#75#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#77;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#77#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #4#78;            |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm004#78#";  |HAZ GrabaFicheroExterno;

     eaAlfa   = #5#7;             |HAZ QuitaRaros;
     eaConten = eaAlfa;
     eaAsigna = "V#dslpm005#7#";   |HAZ GrabaFicheroExterno;

     |HAZ PonDirigirseA;

     |SI eaRaiz = "doc92001";  |O eaRaiz = "doc92003";
         |HAZ Mantenimiento;
         |HAZ OutSourcing;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO DSeguridad;
     |DBASE aBase;  |QBF aBase;
     |HORA eaHora;
     enDocumento    = 0;

     |HAZ SacaDocumentos;
     |SI eaNomFichero = "";  |ACABA;  |FINSI;

     eaDirPlantilla = "C:\DOCUMENTOS\DSLPD\PLANTILLAS\";
     eaDirTrabajo   = "C:\DOCUMENTOS\DSLPD\DOCDSLPD\";
     eaDirSerPlan   = aBase  + "documentos/plantillas/";
     eaDirSerGuarda = aBase  + "documentos/clientes/" + (("00000" + #1#1) % -105) + "/";
     eaDirTrabServi = aBase  + "documentos/tmp/";
     eaRaiz         = eaNomFichero - ".xgz";
     eaFicheroTra   = eaRaiz + "." + "doc";
     eaFicheroXgz   = eaRaiz + ".xgz";
     eaFicheroTar   = eaRaiz + ".tar";
     eaFicheroTgz   = eaRaiz + ".tgz";
     eaFicheroTxt   = eaRaiz + ".txt";
     eaFicheroPlaGz = (eaRaiz + ".xgz") < "";
     eaFicheroPlaMl = (eaRaiz + ".doc") < "";
     eaModoPresenta = "P";

     |MKDIR eaDirTrabServi;

     eaOrigen       = eaDirSerPlan   + eaFicheroPlaGz;
     eaDestino      = eaDirPlantilla + eaFicheroPlaGz;
     eaDestinoTra   = eaDirTrabajo   + eaFicheroPlaGz;

     |HAZ MiraDirectorios;
     |HAZ EnviaFicheroConMD5;
     |HAZ DescomprimeFichero;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Instalelo.";
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |SI enTipoDoc = 90;  |HAZ PorFichero;  eaGuarda = "S";  |FINSI;
     |SI enTipoDoc = 91;  |HAZ PorEmpresa;  eaGuarda = "S";  |FINSI;
     |SI enTipoDoc = 92;  |HAZ Anexos;      eaGuarda = "N";  |FINSI;

     |HAZ MiraLogos;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     |SI eaGuarda = "S";
         |HAZ ActualizaRegistro;

         eaRaiz        = "doc" + (("00000" + #8#1) % -105);
         eaFicheroDef  = eaRaiz + ".doc";
         eaFicheroXgz  = eaRaiz + ".xgz";
         eaFicheroTar  = eaRaiz + ".tar";
         eaFicheroTgz  = eaRaiz + ".tgz";
         eaFicheroTxt  = eaRaiz + ".txt";

         |HAZ ComprimeFichero;

         eaOrigen  = eaDirSerGuarda + eaFicheroXgz;
         eaDestino = eaDirTrabajo   + eaFicheroTgz;

         |HAZ RecibeFichero;

         |RFBORRA eaDestino;
     |SINO;
         eaDestino = eaDirTrabajo + eaFicheroTxt;  |RFBORRA eaDestino;
         eaDestino = eaDirTrabajo + eaFicheroTra;  |RFBORRA eaDestino;
     |FINSI;
|FPRC;
