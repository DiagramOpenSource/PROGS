|FICHEROS;
     reparame;
     rem00100;
     rem00101;
     rem00901;
     rem00902;
     rem01001;
     rem01002;
     rem01003;
     rem01004;

     rew01003;
     rew01004;
     rew01005;
     rew01006,MANTE;
     rew01007,MANTE;

     rem01001@;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aTecla        = "";
     aMas          = "";
     aContenido    = "";
     aLineaMenu    = "";
     aCaracter     = "";
     aPrograma     = "";
     aGuardaProg   = "";
     aTitulo       = "";
     aAbre         = "";
     aCap          = "";
     aDestino      = "";
     aOrigen       = "";
     aPathRenta    = "";
     aFichero      = "";
     aIPRemoto     = "";
     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTipo         = "";
     aRenta        = "";
     aJusti        = "";
     aPago         = "";
     aBlq          = "";
     aCas          = "";

     nValor1       = 0;
     nValor2       = 0;
     nValor3       = 0;
     nLLave        = 0;
     nLinea        = 0;
     nCampo        = 0;
     nSwSeleccion  = 0;
     nValor        = 0;
     nResta        = 0;
     nIndi         = 0;
     nConj         = 0;
     nSwPrint      = 0;
     nCompensacion = 0;
     nAnterior     = 0;
     nHandle       = 0;
     nHandle1      = 0;
     nHandle2      = 0;
     nModo         = 0;
     nRango        = 0;
     nCambio       = 0;
     nGrid         = 0;
     nPanta1001    = 0;
     nVentana      = 0;
     nVentTrab     = 0;
     nAnyo         = 0;
     nHay          = 0;

     nBotonF2      = -1;
     nBotonF3      = -1;
     nBotonF5      = -1;
     nBotonF6      = -1;
     nBotonF8      = -1;
     nBotonF9      = -1;
     nBotonF10     = -1;
     nBotonF12     = -1;
     nBotonF13     = -1;
     nBotonF14     = -1;
     nEBotonF2     = 0;
     nEBotonF3     = 0;
     nEBotonF5     = 0;
     nEBotonF6     = 0;
     nEBotonF8     = 0;
     nEBotonF9     = 0;
     nEBotonF10    = 0;
     nEBotonF12    = 0;
     nEBotonF14    = 0;

 {-1}aVent             = "";
     aVent1            = 0;
     aVent2            = 0;
     aVent3            = 0;
     aVent4            = 0;
     aVent5            = "";

     &enEmpresa        = 0;
     &enModoLiq        = 0;
     &enSwRetorno      = 0;
     &eaPrograma       = "";
     &eaPunto          = "";
     &enSwPresenta     = 0;
     &enModo           = 0;
     &eaMuerto         = "";
     &eaCasilla        = "";
     &enImporte        = 0;
     &enSwAcum         = 0;
     &enDBloque        = 0;
     &enHBloque        = 99;
     &eaDCasilla       = "   ";
     &eaHCasilla       = "zzz";
     &enComplementaria = 0;
     &eaContri         = "";
     &enPatrimonio     = 0;
     &eaModoRenta      = "";
     &eaNomDef         = "";
     &enLineal         = 0;
     &eaLetra          = "";
     &eaUnidadBasico   = "";
     &enVentTrab       = 0;
     &enSwLiquida      = 1;
     &enBtnSalir       = -1;
     &eaTipoBor        = "";
|FIN;

|PROCESO Borrador;
     |VENTANA 0501, 3499, -1, 1, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     enEmpresa = #rem01001#0;
     eaTipoBor = #rem01001#2;
     |SI #rem01001#39 = "Renta     ";
         |SUB_EJECUTA "reemi100;BORRADOR_RENTA";
     |FINSI;

     |SI #rem01001#39 = "Patrimonio";
         |SUB_EJECUTA "reemi100;BORRADOR_PATRI";
     |FINSI;

     |FINVENTANA nVentana;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Baja1004;
     #rem01004#0 = #rem01001#0;
     #rem01004#1 = #rem01001#1;
     #rem01004#2 = #rem01001#2;
     #rem01004#3 = "";
|FPRC;

|PROCESO Alta1004;
     #rem01004#0 = #rem01001#0;
     #rem01004#1 = #rem01001#1;
     #rem01004#2 = #rem01001#2;
     #rem01004#3 = "zz";
|FPRC;

|PROCESO MotivosObliga;
     |SI nEBotonF14 = 0;  |ACABA;  |FINSI;

     |ABRE #rem01004;
     |CONSULTA_F_CLAVE #1#rem01004, Baja1004, Alta1004;
     |CIERRA #rem01004;
|FPRC;

|PROCESO rem01001Mod;
     |SI #rem01001#2 = "TITULAR   ";
         #rem01001#38 = 1;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Titular";
     |FINSI;

     |SI #rem01001#2 = "CONYUGE   ";
         #rem01001#38 = 2;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Conyuge";
     |FINSI;

     |SI #rem01001#2 = "1 FAMILIAR";
         #rem01001#38 = 3;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Familiar 1";
     |FINSI;

     |SI #rem01001#2 = "2 FAMILIAR";
         #rem01001#38 = 4;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Familiar 2";
     |FINSI;

     |SI #rem01001#2 = "3 FAMILIAR";
         #rem01001#38 = 5;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Familiar 3";
     |FINSI;

     |SI #rem01001#2 = "4 FAMILIAR";
         #rem01001#38 = 6;
         #rem01001#39 = "Renta";

#rem01001#40 = "Familiar 4";
     |FINSI;

     |SI #rem01001#2 = "CONJUNTA  ";
         #rem01001#38 = 7;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Conjunta";
     |FINSI;

     |SI #rem01001#2 = "CONJUNTAE ";
         #rem01001#38 = 8;
         #rem01001#39 = "Renta";
         #rem01001#40 = "Conjunta";
     |FINSI;

     |SI #rem01001#2 = "ZPATRITIT ";
         #rem01001#38 = 9;
         #rem01001#39 = "Patrimonio";
         #rem01001#40 = "Titular";
     |FINSI;

     |SI #rem01001#2 = "ZPATRICON ";
         #rem01001#38 = 10;
         #rem01001#39 = "Patrimonio";
         #rem01001#40 = "Conyuge";
     |FINSI;

     |GRABA 0203#rem01001.a;
     |LIBERA #rem01001;
|FPRC;

|DEFBUCLE rem01001Mod;
     #rem01001#1;
     ;
     enEmpresa, 00, "          ";
     enEmpresa, 00, "zzzzzzzzzz";
     be;
     NULL, rem01001Mod;
|FIN;

|PROCESO FinBotones;
     |SI nBotonF2  ! -1;   |FIN_CONTROL_WINDOWS nBotonF2;   |FINSI;
     |SI nBotonF3  ! -1;   |FIN_CONTROL_WINDOWS nBotonF3;   |FINSI;
     |SI nBotonF5  ! -1;   |FIN_CONTROL_WINDOWS nBotonF5;   |FINSI;
     |SI nBotonF6  ! -1;   |FIN_CONTROL_WINDOWS nBotonF6;   |FINSI;
     |SI nBotonF8  ! -1;   |FIN_CONTROL_WINDOWS nBotonF8;   |FINSI;
     |SI nBotonF9  ! -1;   |FIN_CONTROL_WINDOWS nBotonF9;   |FINSI;
     |SI nBotonF10 ! -1;   |FIN_CONTROL_WINDOWS nBotonF10;  |FINSI;
     |SI nBotonF12 ! -1;   |FIN_CONTROL_WINDOWS nBotonF12;  |FINSI;
     |SI nBotonF13 ! -1;   |FIN_CONTROL_WINDOWS nBotonF13;  |FINSI;
     |SI nBotonF14 ! -1;   |FIN_CONTROL_WINDOWS nBotonF14;  |FINSI;
     |SI enBtnSalir ! -1; |FIN_CONTROL_WINDOWS enBtnSalir; |FINSI;

     nBotonF2  = -1;
     nBotonF3  = -1;
     nBotonF5  = -1;
     nBotonF6  = -1;
     nBotonF8  = -1;
     nBotonF9  = -1;
     nBotonF10 = -1;
     nBotonF12 = -1;
     nBotonF13 = -1;
     nBotonF14 = -1;
|FPRC;

|PROCESO Botones;
     |HAZ FinBotones;

     nEBotonF2   = 1;

     |CONTROL_SIMPLE nPanta1001, "LABEL,{{15}}Obligado a declarar:", 2702, 2720, NULL;
     |CONTROL_SIMPLE nPanta1001, "LABEL,{{11}}-S- Obligado", 2808, 2830, NULL;
     |CONTROL_SIMPLE nPanta1001, "LABEL,{{11}}-N- No obligado", 2908, 2930, NULL;
     |CONTROL_SIMPLE nPanta1001, "LABEL,{{11}}-R- Se recomienda", 3008, 3030, NULL;

     |CONTROL_SIMPLE nPanta1001, "BOTON,&Ver liquidaci¢n", 2102, 2220, VerLiquidacion;
     nBotonF2 = FSalida;

     |SI PARAMETRO ! "";  |ACABA;  |FINSI;

     nEBotonF3   = 1;
     nEBotonF5   = 1;
     nEBotonF6   = 1;
     nEBotonF8   = 1;
     nEBotonF9   = 1;
     nEBotonF10  = 1;
     nEBotonF12  = 1;
     nEBotonF14  = 1;

     |CONTROL_SIMPLE nPanta1001, "BOTON,seleccionar &Rentas", 2122, 2240, SeleccionRenta;
     nBotonF5 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,rentas marcadas con &X", 2142, 2260, RentasX;
     nBotonF8 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,liquidaci¢n a¤o &Anterior", 2162, 2280, EjerAnt;
     nBotonF10 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,a&Notaciones", 2182, 2298, Anotaciones;
     nBotonF12 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,&Motivos obligaci¢n", 2402, 2520, MotivosObliga;
     nBotonF14 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,activar/desactivar &Patrimonio", 2422, 2540, ActivarPat;
     nBotonF6 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,&Complementarias patrimonio", 2442, 2560, ComplemenPat;
     nBotonF9 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,cambiar &Forma pago patrimonio", 2462, 2580, FPagoPat;
     nBotonF3 = FSalida;

     |CONTROL_SIMPLE nPanta1001, "BOTON,&Borrador", 2482, 2598, Borrador;
     nBotonF13 = FSalida;

     |ESTADO_CONTROL nBotonF6, "DISABLE";  nEBotonF6 = 0;
     |ESTADO_CONTROL nBotonF8, "DISABLE";  nEBotonF8 = 0;
     |ESTADO_CONTROL nBotonF3, "DISABLE";  nEBotonF3 = 0;
     |ESTADO_CONTROL nBotonF9, "DISABLE";  nEBotonF9 = 0;

     |SI enModo = 4;
         |ESTADO_CONTROL nBotonF5, "DISABLE";  nEBotonF5 = 0;
     |FINSI;

     |ABRE #rem01003;
     #rem01003#0 = enEmpresa;
     #rem01003#1 = "        ";
     #rem01003#2 = 1;
     |LEE 040#rem01003.];
     |SI FSalida = 0;  |Y  #rem01003#0 = enEmpresa;
         |ESTADO_CONTROL nBotonF8, "ENABLE";  nEBotonF8 = 1;
     |FINSI;
     |CIERRA #rem01003;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;
     enBtnSalir = FSalida;
|FPRC;

|PROCESO GrabaComple;
     aBlq = eaCasilla % 102;
     aCas = eaCasilla % 404;

     |ABRE #rem01002;
     |SELECT #2#rem01002;
     #rem01002#0 = #rem01001#0;
     #rem01002#1 = #rem01001#1;
     #rem01002#2 = #rem01001#2;
     #rem01002#3 = aBlq;
     #rem01002#5 = aCas;
     |LEE 101#rem01002.=;
     |SI FSalida = 0;
         |SI enSwAcum = 0;
             #rem01002#7 = enImporte;
         |SINO;
             #rem01002#7 = #rem01002#7 + enImporte;
         |FINSI;
         |GRABA 020#rem01002.a;
     |FINSI;
     |LIBERA #rem01002;
     |CIERRA #rem01002;
|FPRC;

|PROCESO LeePatrimonio;
     |ABRE #rem01002;
     |SELECT #2#rem01002;
     #rem01002#0 = #rem01001#0;
     #rem01002#1 = #rem01001#1;
     #rem01002#2 = #rem01001#2;
     #rem01002#3 = 11;
     #rem01002#5 = "055";
     |LEE 000#rem01002.=;
     |SI FSalida = 0;
         enImporte = #rem01002#7;
     |FINSI;
     |CIERRA #rem01002;
|FPRC;

|PROCESO PonDatosN;
     |SI #rem01001#2 = "CONJUNTA  ";  #rew01003#0 = #rem01001#15;            nLinea  = 1;  nIndi = 0;  nConj = 0; |FINSI;
     |SI #rem01001#2 = "TITULAR   ";  #rew01003#1 = #rew01003#1 + #rem01001#15;  nLinea  = 2;  |FINSI;
     |SI #rem01001#2 = "CONYUGE   ";  #rew01003#1 = #rew01003#1 + #rem01001#15;  nLinea  = 3;  nIndi = 0;  |FINSI;
     |SI #rem01001#2 = "1 FAMILIAR";  #rew01003#1 = #rew01003#1 + #rem01001#15;  nLinea  = 4;  nIndi = 0;  |FINSI;
     |SI #rem01001#2 = "2 FAMILIAR";  #rew01003#1 = #rew01003#1 + #rem01001#15;  nLinea  = 5;  nIndi = 0;  |FINSI;
     |SI #rem01001#2 = "3 FAMILIAR";  #rew01003#1 = #rew01003#1 + #rem01001#15;  nLinea  = 6;  nIndi = 0;  |FINSI;
     |SI #rem01001#2 = "4 FAMILIAR";  #rew01003#1 = #rew01003#1 + #rem01001#15;  nLinea  = 7;  nIndi = 0;  |FINSI;

     nCampo = ((nLinea - 1) * 9) + 4;  #rew01003#nCampo# = #rem01001#13;
     nCampo = nCampo + 1;              #rew01003#nCampo# = #rem01001#15;
     nCampo = nCampo + 1;              #rew01003#nCampo# = #rem01001#8;
     nCampo = nCampo + 1;              #rew01003#nCampo# = #rem01001#10;
     |SI #rem01001#8 = "S";
         nCampo = nCampo + 1;          #rew01003#nCampo# = #rem01001#15 % 60;
         nCampo = nCampo + 1;          #rew01003#nCampo# = #rem01001#15 % 40;
     |SINO;
         |SI #rem01001#15 > 0;
             nCampo = nCampo + 1;          #rew01003#nCampo# = #rem01001#15;
             nCampo = nCampo + 1;          #rew01003#nCampo# = 0;
         |SINO;
             nCampo = nCampo + 1;          #rew01003#nCampo# = 0;
             nCampo = nCampo + 1;          #rew01003#nCampo# = 0;
         |FINSI;
     |FINSI;
     nCampo = nCampo + 1;             #rew01003#nCampo# = "N";
     |SI #rem01001#11 = "X";  #rew01003#nCampo# = "S";  |FINSI;

     nCampo = nCampo + 1;             #rew01003#nCampo# = "N";
     |SI #rem01001#12 = "X";  #rew01003#nCampo# = "S";  |FINSI;

     nCampo = nCampo + 1;              #rew01003#nCampo# = #rem01001#9;

     #rem01001#5 = "";
     |GRABA 020#rem01001.a;
     |LIBERA #rem01001;
|FPRC;

|PROCESO PonDatosP;
     |SI #rem01001#2 = "CONJUNTA  ";  #rew01005#1 = #rem01001#15;            nLinea  = 1;  |FINSI;
     |SI #rem01001#2 = "TITULAR   ";  #rew01005#0 = #rew01005#0 + #rem01001#15;  nLinea  = 2;  |FINSI;
     |SI #rem01001#2 = "CONYUGE   ";  #rew01005#0 = #rew01005#0 + #rem01001#15;  nLinea  = 3;  |FINSI;
     |SI #rem01001#2 = "1 FAMILIAR";  #rew01005#0 = #rew01005#0 + #rem01001#15;  nLinea  = 4;  |FINSI;
     |SI #rem01001#2 = "2 FAMILIAR";  #rew01005#0 = #rew01005#0 + #rem01001#15;  nLinea  = 5;  |FINSI;
     |SI #rem01001#2 = "3 FAMILIAR";  #rew01005#0 = #rew01005#0 + #rem01001#15;  nLinea  = 6;  |FINSI;
     |SI #rem01001#2 = "4 FAMILIAR";  #rew01005#0 = #rew01005#0 + #rem01001#15;  nLinea  = 7;  |FINSI;
     |SI #rem01001#2 = "CONJUNTAE ";  #rew01005#3 = #rem01001#15;            nLinea  = 8;  |FINSI;

     |SI #rem01001#2 = "TITULAR   ";  |Y eaMuerto = "T";
         #rew01005#2 =  #rem01001#15;
     |FINSI;

     |SI #rem01001#2 = "CONYUGE   ";  |Y eaMuerto = "C";
         #rew01005#2 =  #rem01001#15;
     |FINSI;

     nCampo = ((nLinea - 1) * 9) + 6;  #rew01005#nCampo# = #rem01001#13;
     nCampo = nCampo + 1;              #rew01005#nCampo# = #rem01001#15;
     nCampo = nCampo + 1;              #rew01005#nCampo# = #rem01001#8;
     nCampo = nCampo + 1;              #rew01005#nCampo# = #rem01001#10;
     |SI #rem01001#8 = "S";
         nCampo = nCampo + 1;          #rew01005#nCampo# = #rem01001#15 % 60;
         nCampo = nCampo + 1;          #rew01005#nCampo# = #rem01001#15 % 40;
     |SINO;
         |SI #rem01001#15 > 0;
             nCampo = nCampo + 1;          #rew01005#nCampo# = #rem01001#15;
             nCampo = nCampo + 1;          #rew01005#nCampo# = 0;
         |SINO;
             nCampo = nCampo + 1;          #rew01005#nCampo# = 0;
             nCampo = nCampo + 1;          #rew01005#nCampo# = 0;
         |FINSI;
     |FINSI;
     nCampo = nCampo + 1;             #rew01005#nCampo# = "N";
     |SI #rem01001#11 = "X";  #rew01005#nCampo# = "S";  |FINSI;

     nCampo = nCampo + 1;             #rew01005#nCampo# = "N";
     |SI #rem01001#12 = "X";  #rew01005#nCampo# = "S";  |FINSI;

     nCampo = nCampo + 1;              #rew01005#nCampo# = #rem01001#9;

     #rew01005#4 = #rew01005#2 + #rew01005#3;

     #rem01001#5 = "";
     |GRABA 020#rem01001.a;
     |LIBERA #rem01001;
|FPRC;

|PROCESO PonDatos;
     |SI eaMuerto = "";
         |HAZ PonDatosN;
     |SINO;
         |HAZ PonDatosP;
     |FINSI;
|FPRC;

|DEFBUCLE rem01001;
     #rem01001#1;
     ;
     enEmpresa, 00, "          ";
     enEmpresa, 00, "Tzzzzzzzzz";
     be;
     NULL, PonDatos;
|FIN;

|PROCESO Graba112;
     |SELECT #1#rem01001;
     #rem01001#0 = enEmpresa;
     #rem01001#1 = enComplementaria;
     #rem01001#2 = eaContri;
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#16 = enImporte;
         |SI enImporte = -9999999999; #rem01001#16 = #rem01001#3;  |FINSI;
         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     |SELECT #2#rem01001;
|FPRC;

|PROCESO Compensaciones;
     |SI nCompensacion = 0;
         eaContri  = "TITULAR";
         enImporte = -9999999999;
         |HAZ Graba112;

         eaContri  = "CONYUGE";
         enImporte = -9999999999;
         |HAZ Graba112;

         |PONCONTROL 23, "SI";
         |PTEC 812;

         |ACABA;
     |FINSI;

     |SI #rew01003#14 > 0;
         enEmpresa        = #rem01001#0;
         enComplementaria = #rem01001#1;
         eaContri         = "TITULAR";

         #rem01001#0 = enEmpresa;
         #rem01001#1 = 0;
         #rem01001#2 = "TITULAR   ";

         nResta    = #rew01003#14 - (-#rew01003#23);
         |SI nResta > 0;
             enImporte = -#rew01003#23;
             enSwAcum  = 0; eaCasilla = "47-0693"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; eaCasilla = "47-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #rew01003#14;
             enSwAcum  = 0; eaCasilla = "47-0693"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; eaCasilla = "47-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |SI #rew01003#14 < 0;
         enEmpresa        = #rem01001#0;
         enComplementaria = #rem01001#1;
         eaContri         = "TITULAR";

         #rem01001#0 = enEmpresa;
         #rem01001#1 = 0;
         #rem01001#2 = "TITULAR   ";

         nResta    = #rew01003#23 - (-#rew01003#14);
         |SI nResta > 0;
             enImporte = -#rew01003#14;
             enSwAcum  = 0; eaCasilla = "48-0694"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; eaCasilla = "48-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #rew01003#23;
             enSwAcum  = 0; eaCasilla = "48-0694"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; eaCasilla = "48-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |SI #rew01003#23 > 0;
         enEmpresa        = #rem01001#0;
         enComplementaria = #rem01001#1;
         eaContri         = "CONYUGE";

         #rem01001#0 = enEmpresa;
         #rem01001#1 = 0;
         #rem01001#2 = "CONYUGE   ";

         nResta    = #rew01003#23 - (-#rew01003#14);
         |SI nResta > 0;
             enImporte = -#rew01003#14;
             enSwAcum  = 0; eaCasilla = "47-0693"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; eaCasilla = "47-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #rew01003#23;
             enSwAcum  = 0; eaCasilla = "47-0693"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; eaCasilla = "47-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |SI #rew01003#23 < 0;
         enEmpresa        = #rem01001#0;
         enComplementaria = #rem01001#1;
         eaContri         = "CONYUGE";

         #rem01001#0 = enEmpresa;
         #rem01001#1 = 0;
         #rem01001#2 = "CONYUGE   ";

         nResta    = #rew01003#14 - (-#rew01003#23);
         |SI nResta > 0;
             enImporte = -#rew01003#23;
             enSwAcum  = 0; eaCasilla = "48-0694"; |HAZ GrabaComple;

             enImporte = 0;
             enSwAcum  = 0; eaCasilla = "48-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |SINO;
             enImporte = #rew01003#14;
             enSwAcum  = 0; eaCasilla = "48-0694"; |HAZ GrabaComple;

             enImporte = nResta;
             enSwAcum  = 0; eaCasilla = "48-0695"; |HAZ GrabaComple;

             |HAZ Graba112;
         |FINSI;
     |FINSI;

     |PONCONTROL 23, "SI";
     |PTEC 812;
|FPRC;

|PROCESO GrabaSeleccionN;
     |SELECT #1#rem01001;

     |DDEFECTO #rew01004;
     nSwSeleccion = 1;
     eaModoRenta  = "";
     |SI #rew01003#3 = "C";  eaModoRenta  = "C";  |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "CONJUNTA  ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#4;
         #rem01001#8  = #rew01003#6;
         #rem01001#9  = #rew01003#12;
         #rem01001#10 = #rew01003#7;
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#10 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#11 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#0  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#0  = #rem01001#14;
             |FINSI;

             #rew01004#1  = #rem01001#5;
             #rew01004#2  = #rem01001#15;
             #rew01004#6  = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "TITULAR   ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#13;    || Modelo
         #rem01001#8  = #rew01003#15;    || Modelo 102
         #rem01001#9  = #rew01003#21;    || Pago Efectivo
         #rem01001#10 = #rew01003#16;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#19 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#20 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#16  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#16  = #rem01001#14;
             |FINSI;

             #rew01004#17 = #rem01001#5;
             #rew01004#18 = #rem01001#15;
             #rew01004#22 = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "CONYUGE   ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#22;    || Modelo
         #rem01001#8  = #rew01003#24;    || Modelo 102
         #rem01001#9  = #rew01003#30;    || Pago Efectivo
         #rem01001#10 = #rew01003#25;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#28 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#29 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#24  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#24  = #rem01001#14;
             |FINSI;

             #rew01004#25 = #rem01001#5;
             #rew01004#26 = #rem01001#15;
             #rew01004#30 = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "1 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#31;    || Modelo
         #rem01001#8  = #rew01003#33;    || Modelo 102
         #rem01001#9  = #rew01003#39;    || Pago Efectivo
         #rem01001#10 = #rew01003#34;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#37 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#38 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#32  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#32  = #rem01001#14;
             |FINSI;

             #rew01004#33 = #rem01001#5;
             #rew01004#34 = #rem01001#15;
             #rew01004#38 = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "2 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#40;    || Modelo
         #rem01001#8  = #rew01003#42;    || Modelo 102
         #rem01001#9  = #rew01003#48;    || Pago Efectivo
         #rem01001#10 = #rew01003#43;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#46 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#47 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#40  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#40  = #rem01001#14;
             |FINSI;

             #rew01004#41 = #rem01001#5;
             #rew01004#42 = #rem01001#15;
             #rew01004#46 = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "3 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#49;    || Modelo
         #rem01001#8  = #rew01003#51;    || Modelo 102
         #rem01001#9  = #rew01003#57;    || Pago Efectivo
         #rem01001#10 = #rew01003#52;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#55 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#56 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#48  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#48  = #rem01001#14;
             |FINSI;

             #rew01004#49 = #rem01001#5;
             #rew01004#50 = #rem01001#15;
             #rew01004#54 = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "4 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01003#58;    || Modelo
         #rem01001#8  = #rew01003#60;    || Modelo 102
         #rem01001#9  = #rew01003#66;    || Pago Efectivo
         #rem01001#10 = #rew01003#61;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01003#64 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01003#65 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#56  = "";
             |SI #rem00100#97 ! "1";
                 #rew01004#56  = #rem01001#14;
             |FINSI;

             #rew01004#57 = #rem01001#5;
             #rew01004#58 = #rem01001#15;
             #rew01004#62 = #rem01001#17;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     |ABRE #rem00100;
     #rem00100#0 = enEmpresa;
     |LEE 101#rem00100.=;
     |SI FSalida = 0;
         #rem00100#56 = " ";
         #rem00100#57 = " ";
         #rem00100#58 = " ";
         |SI #rew01003#3 = "I";  #rem00100#56 = "X";  |FINSI;
         |SI #rew01003#3 = "S";  #rem00100#58 = "X";  |FINSI;
         |SI #rew01003#3 = "C";  #rem00100#57 = "X";  |FINSI;
         |GRABA 020#rem00100.a;
         |LIBERA #rem00100;
     |FINSI;
     |CIERRA #rem00100;

     nCompensacion = 0;
     |SI #rew01003#13 ! "   ";  |Y  #rew01003#22 ! "   ";  |Y #rem00100#97 = "1";
         |SI #rew01003#14 > 0;  |Y #rew01003#23 < 0;
             |CONFI "0000SDesea activar la Compensacion entre Conyuges";
             |SI FSalida = 0;  nCompensacion = 1;  |FINSI;
         |FINSI;

         |SI #rew01003#14 < 0;  |Y #rew01003#23 > 0;
             |CONFI "0000SDesea activar la Compensacion entre Conyuges";
             |SI FSalida = 0;  nCompensacion = 1;  |FINSI;
         |FINSI;
     |FINSI;

     |SELECT #2#rem01001;
|FPRC;

|PROCESO SeleccionN;
     |VENTANA 0501, 3499, -1, 16, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #rew01003;
     nIndi = 1;
     nConj = 1;
     |BUCLE rem01001;

     |PINPA #0#rew01003;

     |ABRE #reparame;
     |LEE 040#reparame.p;
     |SI FSalida ! 0;  |DDEFECTO #reparame;  |FINSI;
     |CIERRA #reparame;

     |SI nConj = 0;
         |C_M #rew01003#3, 1, "S";
         #rew01003#2 = "CONJUNTA";
         #rew01003#3 = "C";
     |SINO;
         #rew01003#2 = "SEPARADA";
         #rew01003#3 = "S";
     |FINSI;

     |SI #rew01003#1 < #rew01003#0;
         nResta = #rew01003#0 - #rew01003#1;
         |SI nResta [ 0;  nResta = -nResta;  |FINSI;
         |SI nResta [ #reparame#11;
             #rew01003#2 = "CONJUNTA";
             #rew01003#3 = "C";
         |SINO;
             #rew01003#2 = "SEPARADA";
             #rew01003#3 = "S";
         |FINSI;
     |FINSI;

     nValor = #rew01003#5 + #rew01003#14 + #rew01003#23 + #rew01003#32 + #rew01003#41 + #rew01003#50 + #rew01003#59;
     |SI nValor = #rew01003#14;  |Y nIndi = 1;
         #rew01003#2 = "INDIVIDUAL";
         #rew01003#3 = "I";
     |FINSI;

     |PINDA #0#rew01003;

     |PTEC 802;
     |ENDATOS #1#rew01003;
     |SI FSalida = 0;
         |HAZ GrabaSeleccionN;
     |FINSI;

     |FINVENTANA nVentana;

     |HAZ Compensaciones;
|FPRC;

|PROCESO GrabaSeleccionP;
     |SELECT #1#rem01001;

     |DDEFECTO #rew01004;
     nSwSeleccion = 1;
     eaModoRenta  = "";

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "CONJUNTA  ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#6;
         #rem01001#8  = #rew01005#8;
         #rem01001#9  = #rew01005#14;
         #rem01001#10 = #rew01005#9;
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#12 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#13 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#1  = #rem01001#5;
             #rew01004#2  = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "TITULAR   ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#15;    || Modelo
         #rem01001#8  = #rew01005#17;    || Modelo 102
         #rem01001#9  = #rew01005#23;    || Pago Efectivo
         #rem01001#10 = #rew01005#18;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#21 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#22 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#17 = #rem01001#5;
             #rew01004#18 = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "CONYUGE   ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#24;    || Modelo
         #rem01001#8  = #rew01005#26;    || Modelo 102
         #rem01001#9  = #rew01005#32;    || Pago Efectivo
         #rem01001#10 = #rew01005#27;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#30 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#31 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#25 = #rem01001#5;
             #rew01004#26 = #rem01001#15;
         |FINSI;
         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "1 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#33;    || Modelo
         #rem01001#8  = #rew01005#35;    || Modelo 102
         #rem01001#9  = #rew01005#41;    || Pago Efectivo
         #rem01001#10 = #rew01005#36;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#39 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#40 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#33 = #rem01001#5;
             #rew01004#34 = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "2 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#42;    || Modelo
         #rem01001#8  = #rew01005#44;    || Modelo 102
         #rem01001#9  = #rew01005#50;    || Pago Efectivo
         #rem01001#10 = #rew01005#45;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#48 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#49 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#41 = #rem01001#5;
             #rew01004#42 = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "3 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#51;    || Modelo
         #rem01001#8  = #rew01005#53;    || Modelo 102
         #rem01001#9  = #rew01005#59;    || Pago Efectivo
         #rem01001#10 = #rew01005#54;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#57 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#58 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#49 = #rem01001#5;
             #rew01004#50 = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "4 FAMILIAR";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#60;    || Modelo
         #rem01001#8  = #rew01005#62;    || Modelo 102
         #rem01001#9  = #rew01005#68;    || Pago Efectivo
         #rem01001#10 = #rew01005#63;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#66 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#67 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#57 = #rem01001#5;
             #rew01004#58 = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     #rem01001#0 = enEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = "CONJUNTAE ";
     |LEE 101#rem01001.=;
     |SI FSalida = 0;
         #rem01001#5  = #rew01005#69;    || Modelo
         #rem01001#8  = #rew01005#71;    || Modelo 102
         #rem01001#9  = #rew01005#77;    || Pago Efectivo
         #rem01001#10 = #rew01005#72;    || 102 Domiciliado
         #rem01001#11 = " ";
         #rem01001#12 = " ";
         #rem01001#36 = "";

         |SI #rew01005#75 = "S";  #rem01001#11 = "X";  |FINSI;
         |SI #rew01005#76 = "S";  #rem01001#12 = "X";  |FINSI;

         |SI #rem01001#5 ! "   ";
             #rem01001#36 = "0,0,0;81,222,62";

             #rew01004#9  = #rem01001#5;
             #rew01004#10 = #rem01001#15;
         |FINSI;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     |ABRE #rem00100;
     #rem00100#0 = enEmpresa;
     |LEE 101#rem00100.=;
     |SI FSalida = 0;
         #rem00100#56 = " ";
         #rem00100#57 = " ";
         #rem00100#58 = " ";
         |SI #rew01005#5 = "A";  #rem00100#56 = "X";  |FINSI;
         |SI #rew01005#5 = "B";  #rem00100#57 = "X";  |FINSI;
         |SI #rew01005#5 = "C";  #rem00100#57 = "X";  |FINSI;
         |GRABA 020#rem00100.a;
         |LIBERA #rem00100;
     |FINSI;
     |CIERRA #rem00100;

     |SELECT #2#rem01001;
|FPRC;

|PROCESO SeleccionP;
     |VENTANA 0501, 3499, -1, 16, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #rew01005;
     |C_M #rew01005#5, 1, "S";

     |BUCLE rem01001;

     |PINPA #0#rew01005;
     |PINDA #0#rew01005;

     |ENDATOS #1#rew01005;
     |SI FSalida = 0;
         |HAZ GrabaSeleccionP;
     |FINSI;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO GrabaREM01001;
     |SI aRenta = "CONJUNTA  ";
         aTipo   = #rew01004#0;
         nValor1 = #rew01004#3;
         nValor2 = #rew01004#4;
         nValor3 = #rew01004#5;
         aJusti  = #rew01004#6;
         aPago   = #rew01004#7;
     |FINSI;

     |SI aRenta = "CONJUNTAE ";
         aTipo   = #rew01004#8;
         nValor1 = #rew01004#11;
         nValor2 = #rew01004#12;
         nValor3 = #rew01004#13;
         aJusti  = #rew01004#14;
         aPago   = #rew01004#15;
     |FINSI;

     |SI aRenta = "TITULAR   ";
         aTipo   = #rew01004#16;
         nValor1 = #rew01004#19;
         nValor2 = #rew01004#20;
         nValor3 = #rew01004#21;
         aJusti  = #rew01004#22;
         aPago   = #rew01004#23;
     |FINSI;

     |SI aRenta = "CONYUGE   ";
         aTipo   = #rew01004#24;
         nValor1 = #rew01004#27;
         nValor2 = #rew01004#28;
         nValor3 = #rew01004#29;
         aJusti  = #rew01004#30;
         aPago   = #rew01004#31;
     |FINSI;

     |SI aRenta = "1 FAMILIAR";
         aTipo   = #rew01004#32;
         nValor1 = #rew01004#35;
         nValor2 = #rew01004#36;
         nValor3 = #rew01004#37;
         aJusti  = #rew01004#38;
         aPago   = #rew01004#39;
     |FINSI;

     |SI aRenta = "2 FAMILIAR";
         aTipo   = #rew01004#40;
         nValor1 = #rew01004#43;
         nValor2 = #rew01004#44;
         nValor3 = #rew01004#45;
         aJusti  = #rew01004#46;
         aPago   = #rew01004#47;
     |FINSI;

     |SI aRenta = "3 FAMILIAR";
         aTipo   = #rew01004#48;
         nValor1 = #rew01004#51;
         nValor2 = #rew01004#52;
         nValor3 = #rew01004#53;
         aJusti  = #rew01004#54;
         aPago   = #rew01004#55;
     |FINSI;

     |SI aRenta = "4 FAMILIAR";
         aTipo   = #rew01004#56;
         nValor1 = #rew01004#59;
         nValor2 = #rew01004#60;
         nValor3 = #rew01004#61;
         aJusti  = #rew01004#62;
         aPago   = #rew01004#63;
     |FINSI;

     |SI aTipo ! "127";
         aJusti  = "";
         aPago   = "";
     |FINSI;

     |SI aTipo ! "   ";  |Y aTipo ! "107";
         #rem01001#0 = enEmpresa;
         #rem01001#1 = 0;
         #rem01001#2 = aRenta;
         |LEE 101#rem01001.=;
         |SI FSalida = 0;
             #rem01001#3  = nValor3;
             #rem01001#16 = nValor3;
             #rem01001#5  = "100";
             #rem01001#8  = "N";
             #rem01001#10 = "N";
             #rem01001#17 = aJusti;
             #rem01001#18 = aPago;
             #rem01001#14 = aTipo;
             |GRABA 020#rem01001.a;
             |LIBERA #rem01001;

             |SI aTipo ! "127"
                 enImporte = nValor1;
                 enSwAcum  = 0;
                 eaCasilla = "45-0676";
                 |HAZ GrabaComple;

                 enImporte = nValor2;
                 enSwAcum  = 0;
                 eaCasilla = "45-0677";
                 |HAZ GrabaComple;

                 enImporte = nValor3;
                 enSwAcum  = 0;
                 eaCasilla = "45-0680";
                 |HAZ GrabaComple;
             |FINSI;

             |SI aTipo = "127"
                 enImporte = nValor1;
                 enSwAcum  = 0;
                 eaCasilla = "46-0681";
                 |HAZ GrabaComple;

                 enImporte = nValor2;
                 enSwAcum  = 0;
                 eaCasilla = "46-0682";
                 |HAZ GrabaComple;

                 enImporte = nValor3;
                 enSwAcum  = 0;
                 eaCasilla = "46-0685";
                 |HAZ GrabaComple;
             |FINSI;
         |FINSI;
     |SINO;
         #rem01001#0 = enEmpresa;
         #rem01001#1 = 0;
         #rem01001#2 = aRenta;
         |LEE 101#rem01001.=;
         |SI FSalida = 0;
             #rem01001#3  = #rem01001#15;
             #rem01001#16 = #rem01001#15;
             #rem01001#14 = aTipo;
             |GRABA 020#rem01001.a;
             |LIBERA #rem01001;

             enImporte = 0;
             enSwAcum  = 0;
             eaCasilla = "45-0676"; |HAZ GrabaComple;
             eaCasilla = "45-0677"; |HAZ GrabaComple;
             eaCasilla = "45-0680"; |HAZ GrabaComple;
             eaCasilla = "46-0681"; |HAZ GrabaComple;
             eaCasilla = "46-0682"; |HAZ GrabaComple;
             eaCasilla = "46-0685"; |HAZ GrabaComple;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO DatosComplementaria;
     |VENTANA 0501, 3699, -1, 16, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |PARA; |SI; |HACIENDO;
            |PINPA #0#rew01004;
            |PINDA #0#rew01004;
            |ENDATOS #1#rew01004;
            |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     |SELECT #1#rem01001;

     aRenta = "CONJUNTA  ";  |HAZ GrabaREM01001;
     aRenta = "CONJUNTAE ";  |HAZ GrabaREM01001;
     aRenta = "TITULAR   ";  |HAZ GrabaREM01001;
     aRenta = "CONYUGE   ";  |HAZ GrabaREM01001;
     aRenta = "1 FAMILIAR";  |HAZ GrabaREM01001;
     aRenta = "2 FAMILIAR";  |HAZ GrabaREM01001;
     aRenta = "3 FAMILIAR";  |HAZ GrabaREM01001;
     aRenta = "4 FAMILIAR";  |HAZ GrabaREM01001;

     |SELECT #2#rem01001;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO SeleccionRenta;
     |SI nEBotonF5 = 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 3499, -1, 1, "";
     nVentTrab = FSalida;

     |PTEC 802;  |PAUSA;

     |ABRE #rem00100;
     #rem00100#0 = enEmpresa;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI eaMuerto = "";
         |HAZ SeleccionN;
     |SINO;
         |HAZ SeleccionP;
     |FINSI;

     enPatrimonio = 1;
     |SUB_EJECUTA "rezcalcu";
     enPatrimonio = 0;

     |BUCLE rem01001Mod;

     |ABRE #rem00100;
     #rem00100#0 = enEmpresa;
     |LEE 040#rem00100.=;
     |SI FSalida = 0;  |Y #rem00100#97 ! "1";  |Y nSwSeleccion = 1;
         |HAZ DatosComplementaria;
     |FINSI;
     |CIERRA #rem00100;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO rem00901;
     aAlfa      = "";
     aContenido = #rem00901#5 + #rem00901#6;

                            aAlfa2 = "{{" + aContenido + "}}";
                            aAlfa1 = #rem00901#0;
      |SI #rem00901#1 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00901#1;  |FINSI;
      |SI #rem00901#2 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00901#2;  |FINSI;
      |SI #rem00901#3 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00901#3;  |FINSI;

     aAlfa1 = aAlfa1 + ":" + #rem00901#4;  |QBF aAlfa1;

     aAlfa1 = aAlfa1 + " " + aAlfa + " " + aAlfa2 + &13 + &10;
     |XGRABA nHandle2, aAlfa1;
|FPRC;

|DEFBUCLE rem00901;
     #rem00901#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00901;
|FIN;

|PROCESO rem00902;
     aAlfa      = "";

     aContenido = #rem00902#5 + #rem00902#6;

                       aAlfa2 = "{{" + aContenido + "}}";
                       aAlfa1 = #rem00902#0;
      |SI #rem00902#1 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00902#1;  |FINSI;
      |SI #rem00902#2 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00902#2;  |FINSI;
      |SI #rem00902#3 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00902#3;  |FINSI;

     aAlfa1 = aAlfa1 + ":" + #rem00902#4;  |QBF aAlfa1;

     aAlfa1 = aAlfa1 + " " + aAlfa + " " + aAlfa2 + &13 + &10;
     |XGRABA nHandle2, aAlfa1;
|FPRC;

|DEFBUCLE rem00902;
     #rem00902#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00902;
|FIN;

|PROCESO TraeTxtComprimido;
     aAlfa = aPathRenta + aFichero + ".tar " + aFichero + ".txt";
     |ATAR aAlfa, aPathRenta;

     aAlfa = aPathRenta + aFichero + ".tar";
     |COMPRIME aAlfa;

     aAlfa = aPathRenta + aFichero + ".tar";  |FBORRA aAlfa;
     aAlfa = aPathRenta + aFichero + ".txt";  |FBORRA aAlfa;

     aOrigen  = aPathRenta + aFichero + ".tgz";
     aDestino = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".tgz";

     |RFBORRA aDestino;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     Pos    = -1;
     aAlfa  = eaUnidadBasico + "\MODELOS\TMP\" + aFichero + ".tgz";
     aAlfa1 = eaUnidadBasico + "\MODELOS\TMP\";
     |RDESCOMPRIME aAlfa;
     |RDETAR aAlfa, aAlfa1;

     aAlfa = aPathRenta + aFichero + ".tgz";         |FBORRA aAlfa;
     aAlfa = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".tgz";  |RFBORRA aAlfa;
     aAlfa = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".tar";  |RFBORRA aAlfa;
|FPRC;

|PROCESO CreaFicheros;
     aFichero = "003" + (("00000" + #rem01001#0) % -105);

     |DBASE aPathRenta;  |QBT aPathRenta;
     aPathRenta = aPathRenta + "tmp";  |MKDIR aPathRenta;
     aPathRenta = aPathRenta + "/";

     aOrigen    = aPathRenta + aFichero + ".txt";

     |XABRE "WB", aOrigen, nHandle2;

     |SI #rem01001#2 ! "ZPATRITIT ";  |Y #rem01001#2 ! "ZPATRICON ";
         |BUCLE rem00901;
     |SINO;
         |BUCLE rem00902;
     |FINSI;

     |XCIERRA nHandle2;

     |HAZ TraeTxtComprimido;

     aDestino = eaUnidadBasico + "\MODELOS";      |RMKDIR aDestino;
     aDestino = eaUnidadBasico + "\MODELOS\TMP";  |RMKDIR aDestino;
     aDestino = eaUnidadBasico + "\MODELOS\TMP\"  + "003" + (("00000" + #rem01001#0) % -105) + ".TXT";
|FPRC;

|PROCESO LanzaPrograma;
     |PULSATECLA;

     eaNomDef    = "";
     eaLetra     = "";
     enLineal    = 0;
     enSwRetorno = 0;
     aAlfa       = aPrograma % -102;
     |SI aAlfa = "LI"; |O aAlfa = "L1"; |O aAlfa = "L2";
      |O aAlfa = "L3"; |O aAlfa = "L4"; |O aAlfa = "PA";
         eaNomDef         = aPrograma % 108;
         enComplementaria = #rem01001#1;
         eaContri         = #rem01001#2;
         |SI aAlfa ! "LI";  |Y aAlfa ! "PA"
             eaLetra = aAlfa % -101;;
         |FINSI;

         |SUB_EJECUTA eaNomDef;

         |ACABA;
     |FINSI;

     aAlfa = aPrograma % 103;
     |SI aAlfa ! "LIQ";
         eaContri = #rem01001#2;
         aAlfa    = aPrograma % 108;
         eaLetra  = aPrograma % 902;

         |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;

|PROCESO CreaMenu;
     |HAZ CreaFicheros;

     aPrograma = "";

     |SI aGuardaProg ! "";
         aPrograma       = aGuardaProg;
         aGuardaProg = "";
     |FINSI;

     aTitulo   = (("00000" + #rem01001#0) % -105) + " - " + #rem01001#7;  |QBF aTitulo;
     aTitulo   = aTitulo + " - " + #rem01001#39;  |QBF aTitulo;
     aTitulo   = aTitulo + " - " + #rem01001#40;  |QBF aTitulo;

     |PARA;  |SI;  |HACIENDO;
          aAbre = eaUnidadBasico + "\MODELOS\TMP\"  + "002" + (("00000" + #rem01001#0) % -105) + ".TXT";
          |XABRE "WCB", aAbre, nHandle;

          aAlfa = ((aDestino + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = ((aTitulo + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = ((aPrograma + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;

          |SI #rem01001#2 ! "ZPATRITIT ";  |Y #rem01001#2 ! "ZPATRICON ";
              aAlfa = (("RE" + (" " * 99)) % 198) + &13 + &10;
          |SINO;
              aAlfa = (("PA" + (" " * 99)) % 198) + &13 + &10;
          |FINSI;
          |XGRABA nHandle, aAlfa;

          aAlfa = ("00000" + #rem01001#0) % -105;
          aAlfa = aAlfa + (("00" + #rem01001#1) % -102);
          aAlfa = aAlfa + ((#rem01001#2 + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;

          |XCIERRA nHandle;

          aAlfa    = "rez99999;" + aAbre;
          |SUB_EJECUTA aAlfa;

          nLinea = 1;
          |XABRE "ABC",  aAbre,  nHandle;
          |PARA;  |SI;  |HACIENDO;
              |XLEE nHandle, 100, aAlfa;
              |SI FSalida [ 0;  |SAL;  |FINSI;

              |SI nLinea = 1;  aAbre     = aAlfa % 198;  |FINSI;
              |SI nLinea = 2;  aTitulo   = aAlfa % 198;  |FINSI;
              |SI nLinea = 3;  aPrograma = aAlfa % 198;  |FINSI;

              nLinea = nLinea + 1;
          |SIGUE;
          |XCIERRA nHandle;

          |QBF aAbre;
          |QBF aTitulo;
          |QBF aPrograma;

          |SI aPrograma = "";  |SAL;  |FINSI;

          nCambio = 0;
          aAlfa = aPrograma % 106;
          |SI aAlfa = "CAMBIO";
              aPrograma = aPrograma % 898;
              |SELECT #1#rem01001;
              #rem01001#2 = aPrograma;
              |LEE 000#rem01001.=;

              nCambio = 1;
              |SAL;
          |FINSI;

          |HAZ LanzaPrograma;

          |SI enSwRetorno = 1;
              aGuardaProg = aPrograma;
              aPrograma   = "";
          |FINSI;

          |SI aPrograma = "";
              |SAL;
          |FINSI;
     |SIGUE;

     aAbre = eaUnidadBasico + "\MODELOS\TMP\"  + "002" + (("00000" + #rem01001#0) % -105) + ".TXT";
     |RFBORRA aAbre;

     aAbre = eaUnidadBasico + "\MODELOS\TMP\"  + "003" + (("00000" + #rem01001#0) % -105) + ".TXT";
     |RFBORRA aAbre;
|FPRC;

|PROCESO Baja1001;
     #rem01001#0  = enEmpresa;
     #rem01001#1  = 00;
     #rem01001#38 = 00;
     #rem01001#39 = "";
     #rem01001#40 = "";
|FPRC;

|PROCESO Alta1001;
     #rem01001#0  = enEmpresa;
     #rem01001#1  = 99;
     #rem01001#38 = 99;
     #rem01001#39 = "zzzzzzzzzz";
     #rem01001#40 = "zzzzzzzzzz";
|FPRC;

|PROCESO Baja1003;
     #rem01003#0 = enEmpresa;
     #rem01003#1 = "          ";
     #rem01003#2 = 001;
|FPRC;

|PROCESO Alta1003;
     #rem01003#0 = enEmpresa;
     #rem01003#1 = "zzzzzzzzzz";
     #rem01003#2 = 99;
|FPRC;

|PROCESO Disabla;
     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";
     |ESTADO_CONTROL nBotonF2, "DISABLE";  nEBotonF2 = 0;
|FPRC;

|PROCESO Enabla;
     |HAZ PonBtnSalir;

     |ESTADO_CONTROL nBotonF2, "ENABLE";  nEBotonF2 = 1;
     |ESTADO_CONTROL nGrid, "ENABLE";

     |HAZ Botones;
|FPRC;

|PROCESO VerLiquidacion;
     |SI nEBotonF2 = 0;  |ACABA;  |FINSI;

     |HAZ Disabla;

     |PARA; |SI; |HACIENDO;
          aTitulo   = (("00000" + #rem01001#0) % -105) + " - " + #rem01001#7;  |QBF aTitulo;
          aTitulo   = aTitulo + " - " + #rem01001#39;  |QBF aTitulo;
          aTitulo   = aTitulo + " - " + #rem01001#40;  |QBF aTitulo;
          aTitulo   = aTitulo + " - Resultado: " + #rem01001#3;

          |VENTANA 0501, 3499, -1, 16, aTitulo;
          nVentana = FSalida;

          |PTEC 802;  |PAUSA;

          enSwRetorno = 0;
          nCambio     = 0;
          enModoLiq   = 4;
          |HAZ CreaMenu;

          |SI enSwRetorno = 1;
              |CIERRA #rem01001;

              aAlfa1 = #rem01001#0;
              aAlfa2 = #rem01001#1;
              aAlfa3 = #rem01001#2;

              |SUB_EJECUTA "rezcalcu";

              |BUCLE rem01001Mod;

              |ABRE #rem01001;
              #rem01001#0 = aAlfa1;
              #rem01001#1 = aAlfa2;
              #rem01001#2 = aAlfa3;
              |SELECT #1#rem01001;
              |LEE 000#rem01001.=;

              |FINVENTANA  nVentana;
          |SINO;
              |FINVENTANA  nVentana;
              |SI nCambio = 0;  |SAL;  |FINSI;
          |FINSI;
     |SIGUE;

     |HAZ Enabla;

     |SELECT #2#rem01001;
     |REFRESCACONTROL nGrid;

     |PTEC 802;  |PAUSA;
     |FOCOTECLADO nGrid;

     |ESTADO_CONTROL nBotonF8, "DISABLE";  nEBotonF8 = 0;

     |ABRE #rem01003;
     #rem01003#0 = enEmpresa;
     #rem01003#1 = "        ";
     #rem01003#2 = 1;
     |LEE 040#rem01003.];
     |SI FSalida = 0;  |Y  #rem01003#0 = enEmpresa;
         |ESTADO_CONTROL nBotonF8, "ENABLE";  nEBotonF8 = 1;
     |FINSI;
     |CIERRA #rem01003;
|FPRC;

|PROCESO RentasX;
     |SI nEBotonF8 = 0;  |ACABA;  |FINSI;

     |ABRE #rem01003;
     #rem01003#0 = enEmpresa;
     #rem01003#1 = "        ";
     #rem01003#2 = 1;
     |LEE 040#rem01003.];
     |SI FSalida ! 0;  |O  #rem01003#0 ! enEmpresa;
         |CIERRA #rem01003;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 3499, -1, 16, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;

     |PINPA #0#rem01003;

     nRango = 4 + 8 + 16 + 128;
     |LINEAL_SIMPLE #1#rem01003, nRango, 0702, 3598, Baja1003, Alta1003, NULL;

     |CIERRA #rem01003;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO EjerAnt;
     |SI nEBotonF10 = 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 3499, -1, 16, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     aAlfa = ":ren2017/rem01001;" + (("00000" + enEmpresa) % -105);
     |SUB_EJECUTA aAlfa;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Anotaciones;
     |SI nEBotonF12 = 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 3499, -1, 1, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     aAlfa    = "rem01005;" + (("00000" + #rem01001#0) % -105);
     |SUB_EJECUTA aAlfa;

     |FINVENTANA nVentana;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO ActivarPat;
     |SI nEBotonF6 = 0;  |ACABA;  |FINSI;

     |LEE 101#rem01001.=;
     |SI #rem01001#5 = "714";
         #rem01001#5  = "";
         #rem01001#36 = "";
     |SINO;
         #rem01001#5  = "714";
         #rem01001#36 = "0,0,0;81,222,62";
     |FINSI;

     |GRABA 020#rem01001.a;
     |LIBERA #rem01001;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;

     |SI #rem01001#5 = "714";
         |MENAV "0000Activado patrimonio";
     |SINO;
         |MENAV "0000Desactivado patrimonio";
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO GrabaComplePat;
     enImporte = #rew01006#1;
     eaCasilla = "12-056 ";
     |HAZ GrabaComple;

     enImporte = #rew01006#2;
     eaCasilla = "12-057 ";
     |HAZ GrabaComple;

     |LEE 101#rem01001.=;

     #rem01001#3 = #rew01006#2;

     |GRABA 020#rem01001.a;
     |LIBERA #rem01001;
|FPRC;

|PROCESO ComplemenPat;
     |SI nEBotonF9 = 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1356, -1, 0, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |DDEFECTO #rew01006;

     |HAZ LeePatrimonio;

     #rew01006#0 = #rem01002#7;

     |PINPA #0#rew01006;
     |PINDA #0#rew01006;
     |ENDATOS #1#rew01006;
     |SI FSalida = 0;
         |SI #rew01006#2 < 0;
             |MENAV "0000 La Renta se queda negativa, no se puede imprimir, debera hacer un escrito para Hacienda.";
         |FINSI;

         |HAZ GrabaComplePat;
     |FINSI;

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO FPagoPat;
     |SI nEBotonF3 = 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1340, -1, 0, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |SI #rem01001#9 = "E";
         #rem01001#9 = "D";
     |FINSI;

     #rew01007#0 = #rem01001#9;

     |PINPA #0#rew01007;
     |PINDA #0#rew01007;
     |ENDATOS #1#rew01007;
     |SI FSalida = 0;
         |LEE 101#rem01001.=;

         #rem01001#9 = #rew01007#0;

         |GRABA 020#rem01001.a;
         |LIBERA #rem01001;
     |FINSI;

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;


|PROCESO Evento1001;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#rem01001.=;

         |ESTADO_CONTROL nBotonF6,  "DISABLE";  nEBotonF6  = 0;
         |ESTADO_CONTROL nBotonF3,  "DISABLE";  nEBotonF3  = 0;
         |ESTADO_CONTROL nBotonF9,  "DISABLE";  nEBotonF9  = 0;
         |ESTADO_CONTROL nBotonF14, "DISABLE";  nEBotonF14 = 0;

         |SI #rem01001#2 = "ZPATRITIT ";  |O #rem01001#2 = "ZPATRICON ";
             |SI enModo ! 4;
                 |ESTADO_CONTROL nBotonF6, "ENABLE";  nEBotonF6 = 1;
             |FINSI;
         |FINSI;

         |SI #rem01001#5 = "714";  |Y enModo ! 4;
             |ESTADO_CONTROL nBotonF3, "ENABLE";  nEBotonF3 = 1;
             |ESTADO_CONTROL nBotonF9, "ENABLE";  nEBotonF9 = 1;
         |FINSI;

         |SI #rem01001#2 ! "ZPATRITIT ";  |Y #rem01001#2 ! "ZPATRICON ";
             |SI #rem01001#4 ! "N";
                 |ESTADO_CONTROL nBotonF14, "ENABLE";  nEBotonF14 = 1;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Liquidacion2018;
     |ABRE #rem01001;
     #rem01001#0 = enEmpresa;
     #rem01001#1 = 00;
     #rem01001#2 = "          ";
     |LEE 000#rem01001.];
     |SI FSalida ! 0;  |O  #rem01001#0 ! enEmpresa;
         |CIERRA #rem01001;
         |MENAV "0000 No hay liquidacion en el Ejercicio 2018";
         |ACABA;
     |FINSI;

     nPanta1001  = 0;
     nEBotonF2   = 1;
     aTitulo     = "Liquidaci¢n Renta 2018.  C¢digo: " + enEmpresa;

     |VENTANA 0501, 3499, -1, 16, aTitulo;
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     nModo     = enModo;
     enModo    = 4;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #2#rem01001, nRango, 0502, 1998, Baja1001, Alta1001, Evento1001;
     nGrid = FSalida;

     |HAZ Botones;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::," + nGrid;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #rem01001;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO rem00101Cheq;
     aAlfa1 =  #rem01001#7;   |QBF aAlfa1;
     aAlfa2 =  #rem00101#3;   |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;
         |ACABA;
     |FINSI;

     |SI #rem00101#11 ! -1;
         nHay = 1;
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE rem00101Cheq;
     #rem00101#5;
     13;
     enEmpresa, "DESCENDIENTE", 00, "S";
     enEmpresa, "DESCENDIENTE", 99, "S";
     ;
     NULL, rem00101Cheq;
|FIN;

|PROCESO rem01001Cheq;
     |BUCLE rem00101Cheq;

     |SI nHay = 1;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem01001Cheq;
     #rem01001#1;
     ;
     enEmpresa, 00, "1 FAMILIAR";
     enEmpresa, 00, "4 FAMILIAR";
     ;
     NULL, rem01001Cheq;
|FIN;

|PROCESO CheqLiquida;
     nHay = 0;
     |BUCLE rem01001Cheq;
     |SI nHay = 0;  |ACABA;  |FINSI;

     aAlfa = "0000Hay hijos que son contribuyentes y con porcentaje de ";
     aAlfa = aAlfa + "imputaci¢n distinto a -1, por lo que se aplicar  ";
     aAlfa = aAlfa + "el m¡nimo por descendientes. Revisar el dato.";
     |MENAV aAlfa;
|FPRC;

|PROCESO rem00101Hijos;
     nAnyo = #rem00101#5;
     nAnyo = 2018 - nAnyo;
     |SI nAnyo ] 25;  |Y #rem00101#6 < 33;
         nHay = 1;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101Hijos;
     #rem00101#5;
     ;
     enEmpresa, "DESCENDIENTE", 00;
     enEmpresa, "DESCENDIENTE", 99;
     ;
     NULL, rem00101Hijos;
|FIN;

|PROCESO CheqHijos;
     nHay = 0;
     |BUCLE rem00101Hijos;
     |SI nHay = 0;  |ACABA;  |FINSI;

     aAlfa = "0000Existen hijos mayores de 25 a¤os sin discapacidad informados. Rev¡selos";
     |MENAV aAlfa;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;
     |HAZ LeeUnidadBasico;

     |BUCLE rem01001Mod;

     enSwLiquida = 1;

     |SI PARAMETRO ! "";
         |HAZ Liquidacion2018;

         |ACABA;
     |FINSI;

     nSwSeleccion  = 0;
     |SI enModo    = 4;  nSwSeleccion = 1;    |FINSI;

     |PTEC 802;  |PAUSA;

     |SI enModo ! 4;
         nEBotonF8 = 1;
         |HAZ RentasX;
         |HAZ CheqLiquida;
         |HAZ CheqHijos;
     |FINSI;

     |PINPA #0#rem01001;  nPanta1001 = FSalida;
     |HAZ Botones;

     aAlfa1 = #rem01001#0;
     aAlfa2 = #rem01001#1;
     aAlfa3 = #rem01001#2;
     |PARA;  |SI;  |HACIENDO;
             |ABRE #rem01001;
             nRango = 4 + 8 + 16 + 32 + 128;
             |LINEAL_SIMPLE #2#rem01001, nRango, 0702, 1998, Baja1001, Alta1001, Evento1001;
             nGrid = FSalida;

             aEsc1  = &255 + "806";
             aEsc2  = &255 + "807";
             aRetu  = &255 + "802";
             |PARA; |SI;  |HACIENDO;
                  FSalida = "::," + nGrid;
                  |LEETECLA aTecla;
                  |SI aTecla = aEsc1; |SAL;  |FINSI;
                  |SI aTecla = aEsc2; |SAL;  |FINSI;
                  |SI aTecla = aRetu;
                      |HAZ VerLiquidacion;
                  |FINSI;
             |SIGUE;

             |CIERRA #rem01001;

             |SI nSwSeleccion = 0;
                 |||HAZ BorraLiquidacion;  || Quitar
                 |||SAL;                   || Quitar cuando activemos la renta

                 |||CONFI "      Liquidacion sin seleccionar, Salir ";
                 |||SI FSalida = 0;  |HAZ BorraLiquidacion;  |SAL;  |FINSI;

                 |HAZ BorraLiquidacion;  |SAL;
             |SINO;
                 |SAL;
             |FINSI;
     |SIGUE;

     |HAZ FinBotones;

     eaPrograma   = "rem01001";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
