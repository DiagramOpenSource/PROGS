|FICHEROS;
     rey00005;
     reacceso;
     rem01001;
|FIN;

|VARIABLES;
     &aAsigna    = "";
     &aIdenti    = "";
     &aAbre1     = "";
     &aAbre2     = "";
     &aIPRemoto  = "";
     &aOrigen    = "";
     &aDestino   = "";
     &aPathDocu  = "";
     &aAlfa      = "";
     &aDocumento = "";
     &aAlfa1     = "";
     &aAlfa2     = "";
     &aAlfa3     = "";
     &aPathRenta = "";
     &aDef       = "";
     &aLen       = "";
     &aImpor1    = "";
     &aImpor2    = "";
     &aImpor3    = "";
     &aImpor4    = "";
     &aImporte   = "";
     &aBloque    = "";
     &aFichero   = "";
     &aCaracter  = "";
     &aCadena    = "";
     &eaAlfa     = "";

     &nContador     = 0;
     &nOpcion       = 0;
     &nCabecera     = 0;
     &nSubCabecera  = 0;
     &nImporte      = 0;
     &nImporte1     = 0;
     &nImporte2     = 0;
     &nLen          = 0;
     &nWord         = 0;
     &nWord1        = 0;
     &nWord2        = 0;
     &nCampo        = 0;
     &nCampoS       = 0;
     &nSwAlguno     = 0;
     &nSwLiqui      = 0;
     &nLinea        = 0;
     &nBloque       = 0;
     &nHay          = 0;
     &nPos          = 0;
     &nPaso         = 0;

     {39}&aCarac    = "";

     &enCanti      = 0;
     &enSwTrata    = 0;
     &eaMoneda     = "";
     &eaImporte    = "";
     &eaUnidadBasico  = "";
|FIN;

|PROCESO Importe;    || Calculo para poner las comas en el importe
     enCanti   = nImporte;
     enSwTrata = 1;
     eaMoneda  = "EUROS  ";
     |HAZ SeparaImporte;
     aImporte   = eaImporte;
|FPRC;

|PROCESO AbreWord1;
     |DBASS aPathDocu;
     |QBF aPathDocu;
     aPathDocu = aPathDocu + "basica/word/";

     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     aOrigen   = aPathDocu + aDocumento;
     aDestino  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/" + aDocumento;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord  = 1;
     aAbre1 = aDestino;

     |MENSA "      Abriendo el Documento, espere un Momento.";

     |WORD_ABRE nWord, aAbre1;
     nWord1 = nWord;
     |WORD_PROPIEDADES nWord1, "Visible", "NO";

     |MENSA "      Asignando Campos, espere un Momento.";
|FPRC;

|PROCESO AbreWord2;
     |DBASS aPathDocu;
     |QBF aPathDocu;
     aPathDocu = aPathDocu + "basica/word/";

     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     aOrigen   = aPathDocu + aDocumento;
     aDestino  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/" + aDocumento;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord  = 2;
     aAbre2 = aDestino;

     |WORD_ABRE nWord, aAbre2;

     nWord2 = nWord;
     |WORD_PROPIEDADES nWord2, "Visible", "NO";
|FPRC;

|PROCESO ImprimeWord;
     |MENSA "      Imprimiendo Documento, espere un Momento.";

     aAsigna = "";
     aIdenti = "!<<PEGAR>>";
     |WORD_ASIGNA_TEXTO nWord1, aIdenti, aAsigna;

     |WORD_PROPIEDADES nWord1, "limpiafinal", "";
     |SI #rey00005#44 = "V";
         |WORD_PROPIEDADES nWord1, "Visible", "SI";
         FSalida = "NO";
         |PARA;  |SI FSalida = "NO";  |HACIENDO;
                 |PULSATECLA;
                 |WORD_PROPIEDADES nWord1, "Quit", "";
         |SIGUE;
     |SINO;
         |WORD_IMPRIME nWord1, "";
         |SLEEP 10;
         |WORD_SALVA nWord1, "";
     |FINSI;

     |RFBORRA aAbre1;
|FPRC;

|PROCESO CompletaLineas;
     |PARA nCampo = nContador; |SI nCampo [ 50; |HACIENDO nCampo = nCampo + 1;
           aAsigna = "";
           aIdenti = "!#"+ nCampo + "#";
           |WORD_ASIGNA_TEXTO nWord2, aIdenti, aAsigna;
     |SIGUE;

     |WORD_SALVA nWord2, "";

     |WORD_CARGA_TEXTO nWord1, "!<<PEGAR>>", aAbre2;
     |RFBORRA aAbre2;
|FPRC;

|PROCESO AbreOtro;
     |WORD_SALVA nWord2, "";

     |WORD_CARGA_TEXTO nWord1, "!<<PEGAR>>", aAbre2;

     |RFBORRA aAbre2;

     |HAZ AbreWord2;
|FPRC;

|PROCESO Asigna;
     eaAlfa = aAsigna;
     |HAZ QuitaRaros;
     aAsigna = eaAlfa;

     nContador = nContador + 1;
     aIdenti   = "!#" + nContador + "#";
     |WORD_ASIGNA_TEXTO nWord2, aIdenti, aAsigna;
     |SI FSalida ! 0;
         aAlfa1 = aAsigna;
         |HAZ AbreOtro;

         aAsigna   = "RENTA : " + (("00000" + #reacceso#0) % -105) + " " + #reacceso#1;
         nContador = 1;
         aIdenti   = "!#" + nContador + "#";
         |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

         |SI nSwLiqui = 0;
             aAsigna   = "";
             nContador = 2;
             aIdenti   = "!#" + nContador + "#";
             |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

             aAsigna   = aAlfa1;
             nContador = 3;
             aIdenti   = "!#" + nContador + "#";
             |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
         |SINO;
             aAsigna   = "LIQUIDACION " + #rem01001#2;
             nContador = 2;
             aIdenti   = "!#" + nContador + "#";
             |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

             aAsigna   = "";
             nContador = 3;
             aIdenti   = "!#" + nContador + "#";
             |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

             aAsigna   = aAlfa1;
             nContador = 4;
             aIdenti   = "!#" + nContador + "#";
             |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO FiltroImpre;
     |SI nImporte = 0;  |Y #rey00005#43 = "N";
         |ACABA;
     |FINSI;

     |HAZ Asigna;
|FPRC;

|PROCESO ConverAyN;
     |SI nImporte = 0;  |Y #rey00005#43 = "N";
         |ACABA;
     |FINSI;

     |HAZ Importe;

     aAsigna = aAlfa1 + aImporte;
     |HAZ Asigna;
|FPRC;

|PROCESO ConverAyNN;
     |SI nImporte1 = 0;  |Y nImporte2 = 0;  |Y #rey00005#43 = "N";
         |ACABA;
     |FINSI;

     nImporte = nImporte1;  |HAZ Importe;  aAlfa2 = aImporte;
     nImporte = nImporte2;  |HAZ Importe;  aAlfa3 = aImporte;

     aAsigna = aAlfa1 + aAlfa2 + " " + aAlfa3;
     |HAZ Asigna;
|FPRC;

|PROCESO ConverAyD;
     |SI nImporte = 0;  |Y #rey00005#43 = "N";
         |ACABA;
     |FINSI;

     aAsigna = aAlfa1 + nImporte;
     |HAZ Asigna;
|FPRC;
