|FICHEROS;
     reacceso;
     reparame;
     rem99999;

     rem00021;
     rem00044;
     rem00100;
     rem00101;
     rem00102;
     rem00900;
     rem01001;

     rew99995;

     &clientes@;
     :/integral/def/dsam0004;
     :/integral/def/dsam0000;
|FIN;

|VARIABLES;
     aVariable = "";
     aAlfa     = "";
     aGrupo1   = "";
     aGrupo2   = "";
     aSiNo     = "";
     aTipo     = "";
     aPathRenta = "";
     aDef       = "";
     aAlfa1     = "";
     aAlfa2     = "";
     aUsuario1  = "";
     aUsuario2  = "";
     aBase      = "";
     aCadena    = "";
     aEsc1      = "";
     aEsc2      = "";
     aRetu      = "";
     aTecla     = "";
     aOrigen    = "";
     aDestino   = "";
     aIPRemoto  = "";
     aQueBoton  = "";
     aBoton     = "";
     aID        = "";
     aContenido = "";
     aLineaMenu = "";
     aCaracter  = "";
     aPrograma  = "";
     aTitulo    = "";
     aAbre      = "";
     aCap       = "";
     aFichero   = "";
     aLanza     = "";
     aDef1      = "";
     aDef2      = "";
     aQueQuiero = "";
     aNCmp      = "";
     aNomb1     = "";
     aNomb2     = "";
     aFicTmp    = "";

     nHandle1   = 0;
     nHandle2   = 0;
     nPos       = 0;
     nLLave     = 0;
     nBoton     = 0;
     nSwGrupo1  = 0;
     nSwGrupo2  = 0;
     nOpcion    = 0;
     nEsArrend  = 0;
     nSwRecoge  = 0;
     nSwActiv   = 0;
     nDCodigo   = 0;
     nHCodigo   = 0;
     nCampo     = 0;
     nCampo1    = 0;
     nRegraba   = 0;
     nCompara   = 0;
     nPatrones  = 0;
     nContinuar = 0;
     nError     = 0;
     nHandle    = 0;
     nLong      = 0;
     nCaracter  = 0;
     nPosi      = 0;
     nPtec      = 0;
     nTree      = 0;
     nPanta900  = 0;
     nLinea     = 0;
     nLiquida   = 0;
     nHayArrend = 0;
     nVentana   = 0;
     nCmp1      = 0;
     nCmp2      = 0;
     nLinDif    = 0;
     n0Vent     = 0;

     nBoton1    = 0;
     nBoton2    = 0;
     nBoton3    = 0;
     nBoton4    = 0;
     nBoton5    = 0;
     nBoton6    = 0;
     nBoton7    = 0;
     nBoton8    = 0;
     nBoton9    = 0;
     nBoton10   = 0;
     nBoton11   = 0;
     nBoton12   = 0;
     nBoton13   = 0;
     nBoton14   = -1;

     {5}aPopup    = "";

     {-1}sTree    = 0;
     sT_nID       = 0;
     sT_nOper     = 0;
     sT_aData     = "";

      {-1}aDatPer = "";
      aDatPer1    = "0820";
      aDatPer2    = "1";
      aDatPer3    = "3";
      aDatPer4    = "Visualizar diferencias";
      aDatPer5    = "Actualizar de Cliente a Renta";
      aDatPer6    = "Salir";

     {-1}aVent    = "";
         aVent1   = 0;
         aVent2   = 0;
         aVent3   = 0;
         aVent4   = 0;
         aVent5   = "";

     &eaExtr           = "";
     &enEmpresa        = 0;
     &eaNombre         = "";
     &eaNif            = "";
     &enModo           = 0;
     &eaVarDni         = "";
     &enCalcCif        = 0;
     &enComplementaria = 0;
     &eaLetra          = "";
     &eaPrograma       = "";
     &eaExtension      = "";
     &eaPunto          = "";
     &enCodCli         = 0;
     &enSwDeDonde      = 0;
     &enError          = 0;
     &eaUnidadBasico   = "";
     &enTipoEntrada    = 0;
     &enVentGnrl       = 0;
     &enVentTrab       = 0;
     &enPatrimonio     = 0;
     &eaCta            = "";
     &eaIBAN           = "";
     &eaImpreso        = "";
     &eaModoMac        = "";
     &eaContri         = "";

     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &eaMarron     = "";
|FIN;

|INCLUYE i_sepnom;

|PROCESO GrabaDife;
     |SI aDef1 = "rem00101";
         aNomb1     = "Datos familiares renta";
         aQueQuiero = "|C" + (("000" + nCmp1) % -103) + "NOMBRE";
         aNCmp      = (#rem00101#aQueQuiero# + (" " * 20)) % 120;
         aAlfa1     = #rem00101#nCmp1#;
     |FINSI;

     |SI aDef1 = "rem00100";
         aNomb1     = "Datos contribuyente renta";
         aQueQuiero = "|C" + (("000" + nCmp1) % -103) + "NOMBRE";
         aNCmp      = (#rem00100#aQueQuiero# + (" " * 20)) % 120;
         aAlfa1     = #rem00100#nCmp1#;
     |FINSI;

     |SI aDef2 = "clientes@";
         aNomb2     = "Datos cliente en la PI";
         aQueQuiero = "|C" + (("000" + nCmp2) % -103) + "NOMBRE";
         aNCmp      = (#clientes@#aQueQuiero# + (" " * 20)) % 120;
         aAlfa2     = #clientes@#nCmp2#;
     |FINSI;

     |SI aDef2 = "dsam0000";
         aNomb2     = "Datos cliente en la PI";
         aQueQuiero = "|C" + (("000" + nCmp2) % -103) + "NOMBRE";
         aNCmp      = (#dsam0000#aQueQuiero# + (" " * 20)) % 120;
         aAlfa2     = #dsam0000#nCmp2#;
     |FINSI;

     |SI aDef2 = "dsam0004";
         aNomb2     = "Datos familiares PI";
         aQueQuiero = "|C" + (("000" + nCmp2) % -103) + "NOMBRE";
         aNCmp      = (#dsam0004#aQueQuiero# + (" " * 20)) % 120;
         aAlfa2     = #dsam0004#nCmp2#;
     |FINSI;

     nLinDif = nLinDif + 1;

     #rew99995#0 = nLinDif + 1;
     #rew99995#1 = aNCmp;
     #rew99995#2 = aNomb1;
     #rew99995#3 = aAlfa1;
     #rew99995#4 = aNomb2;
     #rew99995#5 = aAlfa2;

     |GRABA 020#rew99995.n;
     |LIBERA #rew99995;
|FPRC;

|PROCESO GrabaFamiliar;
     #rem00101#0 = #dsam0004#0;
     #rem00101#1 = #dsam0004#1;
     |LEE 101#rem00101.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00101;
         #rem00101#0 = #dsam0004#0;
         #rem00101#1 = #dsam0004#1;
         |GRABA 020#rem00101.b;
     |FINSI;

     |SI nCompara = 1;
         aDef1 = "rem00101";
         aDef2 = "dsam0004";

         |PARA nCmp1 = 2;  |SI nCmp1 [ 15;  |HACIENDO nCmp1 = nCmp1 + 1;
               nCmp2 = nCmp1;

               |SI #rem00101#nCmp1# ! #dsam0004#nCmp2#;
                   |HAZ GrabaDife;
                   nRegraba = 1;
               |FINSI;
         |SIGUE;

         |PARA nCmp1 = 17;  |SI nCmp1 [ 24;  |HACIENDO nCmp1 = nCmp1 + 1;
               nCmp2 = nCmp1 - 1;

               |SI #rem00101#nCmp1# ! #dsam0004#nCmp2#;
                   |HAZ GrabaDife;
                   nRegraba = 1;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nCompara = 0;
         |PARA nCampo = 2;  |SI nCampo [ 15;  |HACIENDO nCampo = nCampo + 1;
               #rem00101#nCampo# = #dsam0004#nCampo#;
         |SIGUE;

         #rem00101#17 = #dsam0004#16;
         #rem00101#18 = #dsam0004#17;
         #rem00101#19 = #dsam0004#18;
         #rem00101#20 = #dsam0004#19;
         #rem00101#21 = #dsam0004#20;
         #rem00101#22 = #dsam0004#21;
         #rem00101#23 = #dsam0004#22;
         #rem00101#24 = #dsam0004#23;

         eaCta = #rem00101#10;  |HAZ CalcuIBAN;  #rem00101#25 = eaIBAN;
     |FINSI;

     |SI nRegraba = 0;
         |GRABA 020#rem00101.a;
     |FINSI;
     |LIBERA #rem00101;
|FPRC;

|DEFBUCLE dsam0004;
     #dsam0004#1;
     ;
     #reacceso#0, 00;
     #reacceso#0, 99;
     ;
     NULL, GrabaFamiliar;
|FIN;

|PROCESO BorraFamiliar;
     |SI nCompara = 0;
         |BORRA 020#rem00101.a;
         |LIBERA #rem00101;
     |FINSI;

     |SI nCompara = 1;
         |ABRE #dsam0004;
         #dsam0004#0 = #rem00101#0;
         #dsam0004#1 = #rem00101#1;
         |LEE 040#dsam0004.=;
         |SI FSalida ! 0;
             nRegraba = 1;
             |ACABA;
         |FINSI;

         aDef1 = "rem00101";
         aDef2 = "dsam0004";

         |PARA nCmp1 = 2;  |SI nCmp1 [ 15;  |HACIENDO nCmp1 = nCmp1 + 1;
               nCmp2 = nCmp1;

               |SI #rem00101#nCmp1# ! #dsam0004#nCmp2#;
                   |HAZ GrabaDife;
                   nRegraba = 1;
               |FINSI;
         |SIGUE;

         |PARA nCmp1 = 17;  |SI nCmp1 [ 24;  |HACIENDO nCmp1 = nCmp1 + 1;
               nCmp2 = nCmp1 - 1;

               |SI #rem00101#nCmp1# ! #dsam0004#nCmp2#;
                   |HAZ GrabaDife;
                   nRegraba = 1;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101;
     #rem00101#1;
     ;
     #reacceso#0, 00;
     #reacceso#0, 99;
     ;
     NULL, BorraFamiliar;
|FIN;

|PROCESO ComparaSiglas;
    |QBF aAlfa;
    |SI aAlfa = "AL";  aAlfa = "ALAM ";  |FINSI;
    |SI aAlfa = "AD";  aAlfa = "ALDEA";  |FINSI;
    |SI aAlfa = "AP";  aAlfa = "APTOS";  |FINSI;
    |SI aAlfa = "AR";  aAlfa = "ARRAL";  |FINSI;
    |SI aAlfa = "AY";  aAlfa = "ARRY ";  |FINSI;
    |SI aAlfa = "AV";  aAlfa = "AVDA ";  |FINSI;
    |SI aAlfa = "BJ";  aAlfa = "BJADA";  |FINSI;
    |SI aAlfa = "BR";  aAlfa = "BRANC";  |FINSI;
    |SI aAlfa = "BO";  aAlfa = "BARRO";  |FINSI;
    |SI aAlfa = "BL";  aAlfa = "BLQUE";  |FINSI;
    |SI aAlfa = "CL";  aAlfa = "CALLE";  |FINSI;
    |SI aAlfa = "CJ";  aAlfa = "CLLJA";  |FINSI;
    |SI aAlfa = "CM";  aAlfa = "CMNO ";  |FINSI;
    |SI aAlfa = "CR";  aAlfa = "CTRA ";  |FINSI;
    |SI aAlfa = "CS";  aAlfa = "CSRIO";  |FINSI;
    |SI aAlfa = "CO";  aAlfa = "COL  ";  |FINSI;
    |SI aAlfa = "CN";  aAlfa = "CJTO ";  |FINSI;
    |SI aAlfa = "CT";  aAlfa = "CUSTA";  |FINSI;

    |SI aAlfa = "CH";  aAlfa = "CHLET";  |FINSI;
    |SI aAlfa = "ED";  aAlfa = "EDIFC";  |FINSI;
    |SI aAlfa = "EN";  aAlfa = "ENTD ";  |FINSI;
    |SI aAlfa = "ES";  aAlfa = "ESCAL";  |FINSI;
    |SI aAlfa = "EX";  aAlfa = "EXPLA";  |FINSI;
    |SI aAlfa = "EM";  aAlfa = "EXTRM";  |FINSI;
    |SI aAlfa = "ER";  aAlfa = "EXTRR";  |FINSI;
    |SI aAlfa = "GL";  aAlfa = "GTA  ";  |FINSI;
    |SI aAlfa = "GV";  aAlfa = "G.V. ";  |FINSI;
    |SI aAlfa = "GR";  aAlfa = "GRUPO";  |FINSI;
    |SI aAlfa = "JR";  aAlfa = "JDIN ";  |FINSI;
    |SI aAlfa = "LG";  aAlfa = "LUGAR";  |FINSI;
    |SI aAlfa = "MS";  aAlfa = "MASIA";  |FINSI;
    |SI aAlfa = "MC";  aAlfa = "MERC ";  |FINSI;
    |SI aAlfa = "MT";  aAlfa = "MONTE";  |FINSI;
    |SI aAlfa = "ML";  aAlfa = "MUELL";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PD";  aAlfa = "PTDA ";  |FINSI;
    |SI aAlfa = "PJ";  aAlfa = "PSAJE";  |FINSI;
    |SI aAlfa = "PS";  aAlfa = "PASEO";  |FINSI;
    |SI aAlfa = "PZ";  aAlfa = "PLAZA";  |FINSI;
    |SI aAlfa = "PB";  aAlfa = "PBDO ";  |FINSI;
    |SI aAlfa = "PG";  aAlfa = "POLIG";  |FINSI;
    |SI aAlfa = "PR";  aAlfa = "PROL ";  |FINSI;
    |SI aAlfa = "PT";  aAlfa = "PNTE ";  |FINSI;
    |SI aAlfa = "PU";  aAlfa = "PTA  ";  |FINSI;
    |SI aAlfa = "RM";  aAlfa = "RAMAL";  |FINSI;
    |SI aAlfa = "RB";  aAlfa = "RBLA ";  |FINSI;
    |SI aAlfa = "RP";  aAlfa = "RAMPA";  |FINSI;
    |SI aAlfa = "RR";  aAlfa = "RIERA";  |FINSI;
    |SI aAlfa = "RC";  aAlfa = "RCON ";  |FINSI;
    |SI aAlfa = "RD";  aAlfa = "RONDA";  |FINSI;
    |SI aAlfa = "RU";  aAlfa = "RUA  ";  |FINSI;
    |SI aAlfa = "SC";  aAlfa = "SECT ";  |FINSI;
    |SI aAlfa = "SD";  aAlfa = "SENDA";  |FINSI;
    |SI aAlfa = "SB";  aAlfa = "SBIDA";  |FINSI;
    |SI aAlfa = "TO";  aAlfa = "TRRNT";  |FINSI;
    |SI aAlfa = "TR";  aAlfa = "TRVA ";  |FINSI;
    |SI aAlfa = "UR";  aAlfa = "URB  ";  |FINSI;
    |SI aAlfa = "VI";  aAlfa = "VIA  ";  |FINSI;
    |SI aAlfa = "VP";  aAlfa = "VIA  ";  |FINSI;
|FPRC;

|PROCESO MiraSiglas;
     aAlfa = #clientes@#14;  |HAZ ComparaSiglas;  #clientes@#14 = aAlfa;
     aAlfa = #clientes@#24;  |HAZ ComparaSiglas;  #clientes@#24 = aAlfa;
     aAlfa = #clientes@#44;  |HAZ ComparaSiglas;  #clientes@#44 = aAlfa;
|FPRC;

|PROCESO CargaCampos;
     |HAZ MiraSiglas;

     |SI nCompara = 1;
         aDef1 = "rem00100";
         aDef2 = "clientes@";

         |PARA nCmp1 = 0;  |SI nCmp1 [ 60;  |HACIENDO nCmp1 = nCmp1 + 1;
               nCmp2 = nCmp1;
               |SI nCmp1 ! 24;  |Y nCmp1 ! 56;  |Y nCmp1 ! 57;
                                |Y nCmp1 ! 58;
                   |SI #rem00100#nCmp1# ! #clientes@#nCmp2#;
                       |HAZ GrabaDife;
                       nRegraba = 1;
                   |FINSI;
               |FINSI;
         |SIGUE;

         aDef1 = "rem00100";
         aDef2 = "clientes@";

         |SI #rem00100#94  ! #clientes@#64;
             nCmp1 = 94;
             nCmp2 = 64;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#103  ! #clientes@#67;
             nCmp1 = 103;
             nCmp2 = 67;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#104  ! #clientes@#68;
             nCmp1 = 104;
             nCmp2 = 68;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#105  ! #clientes@#69;
             nCmp1 = 105;
             nCmp2 = 69;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#106  ! #clientes@#70;
             nCmp1 = 106;
             nCmp2 = 70;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#109  ! #clientes@#71;
             nCmp1 = 109;
             nCmp2 = 71;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#110  ! #clientes@#72;
             nCmp1 = 110;
             nCmp2 = 72;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#111  ! #clientes@#73;
             nCmp1 = 111;
             nCmp2 = 73;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |PARA nCmp2 = 74;  |SI nCmp2 [ 106;  |HACIENDO nCmp2 = nCmp2 + 1;
               nCmp1 = nCmp2 + 38;
               |SI #rem00100#nCmp1# ! #clientes@#nCmp2#;
                   |HAZ GrabaDife;
                   nRegraba = 1;
               |FINSI;
         |SIGUE;

         aDef1 = "rem00100";
         aDef2 = "dsam0000";

         |SI #rem00100#69  ! #dsam0000#15;
             nCmp1 = 69;
             nCmp2 = 15;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         |SI #rem00100#70  ! #dsam0000#16;
             nCmp1 = 70;
             nCmp2 = 16;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         aAlfa1 = #rem00100#71;  |QBF aAlfa1;
         aAlfa2 = #dsam0000#17;  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;
             nCmp1 = 71;
             nCmp2 = 17;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;

         aAlfa1 = #rem00100#72;    |QBF aAlfa1;
         aAlfa2 = #dsam0000#18;    |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;
             nCmp1 = 72;
             nCmp2 = 18;
             |HAZ GrabaDife;
             nRegraba = 1;
         |FINSI;
     |FINSI;

     |SI nCompara = 0;
         |PARA nCampo = 0;  |SI nCampo [ 60;  |HACIENDO nCampo = nCampo + 1;
               #rem00100#nCampo# = #clientes@#nCampo#;
         |SIGUE;

         #rem00100#93  = #clientes@#63;
         #rem00100#94  = #clientes@#64;
         #rem00100#95  = #clientes@#65;
         #rem00100#69  = #dsam0000#15;
         #rem00100#70  = #dsam0000#16;
         #rem00100#71  = #dsam0000#17;
         #rem00100#72  = #dsam0000#18;
         #rem00100#103 = #clientes@#67;
         #rem00100#104 = #clientes@#68;
         #rem00100#105 = #clientes@#69;
         #rem00100#106 = #clientes@#70;
         #rem00100#109 = #clientes@#71;
         #rem00100#110 = #clientes@#72;
         #rem00100#111 = #clientes@#73;

         |PARA nCampo = 74;  |SI nCampo [ 106;  |HACIENDO nCampo = nCampo + 1;
               nCampo1    = nCampo + 38;
               #rem00100#nCampo1#  = #clientes@#nCampo#;
         |SIGUE;

         eaCta = #rem00100#53;  |HAZ CalcuIBAN;  #rem00100#147 = eaIBAN;
         eaCta = #rem00100#54;  |HAZ CalcuIBAN;  #rem00100#148 = eaIBAN;
         eaCta = #rem00100#55;  |HAZ CalcuIBAN;  #rem00100#149 = eaIBAN;

         |BUCLE rem00101;
     |FINSI;

     |SI nRegraba = 0;  |BUCLE rem00101;  |FINSI;

     |ABRE #rem00101;
     |SI nRegraba = 0;  |BUCLE dsam0004;  |FINSI;
     |CIERRA #rem00101;
|FPRC;

|PROCESO AltaPI;
     |SUB_EJECUTA ":integral/dsxz0001;MIRAMODO";
     |SI eaModoMac = "9";
         aLanza = "*:ren2018/zacceso9;" + (("00000" + #reacceso#0) % -105) + "ALTACLIENTE";
         |SUB_EJECUTA aLanza;
     |SINO;
         enEmpresa = #reacceso#0;
         eaNombre  = #reacceso#1;
         eaNif     = #reacceso#2;
         |SUB_EJECUTA ":integral/dsxz0001;MODORENTA";
     |FINSI;
|FPRC;

|PROCESO MenuPI;
     |VENTANA 0501, 1260, -1, 16, "Datos personales por actualizar";
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PARA; |SI; |HACIENDO;
            |MENUG aDatPer;
            aDatPer2 = FSalida;

            |SI aDatPer2 = "1";
                |CONSULTA_CLAVE #1#rew99995;
            |FINSI;

            |SI aDatPer2 = "2";
                nCompara = 0;
                nRegraba = 0;
                |HAZ CargaCampos;

                |GRABA 020#rem00100.a;

                #reacceso#1   = #clientes@#5;
                #reacceso#2   = #clientes@#1;
                #reacceso#21  = #rem00100#35;
                #reacceso#22  = #rem00100#39;

                |SAL;
            |FINSI;

            |SI aDatPer2 = "3";
                |SAL;
            |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;
|FPRC;

|PROCESO MiraIntegrada;
     nLinDif = 0;
     aFicTmp = "rew99995" + Usuario;
     |NOME_DAT #rew99995#aFicTmp#;
     |ABRE #rew99995;  |CIERRA #rew99995;  |DELINDEX #rew99995;

     |ABRE #rew99995;

     |ABRE #clientes@;
     #clientes@#0 = #reacceso#0;

     |LIBERA #clientes@;
     |LEE 000#clientes@.=;
     |SI FSalida ! 0;
         |MENAV "     No existe datos personales en el cliente ";
         |CONFI "0000SDesea introducirlos ";
         |SI FSalida = 0;
             |HAZ AltaPI;

             #clientes@#0 = #reacceso#0;
             |LIBERA #clientes@;
             |LEE 040#clientes@.=;
             |SI FSalida ! 0;
                 |MENAV "     No existe datos personales en el cliente ";
                 |CIERRA #clientes@;
             |FINSI;
         |SINO;
             |CIERRA #clientes@;
         |FINSI;
     |FINSI;
     |CIERRA #clientes@;

     |ABRE #dsam0000;
     #dsam0000#0 = #clientes@#0;
     |LEE 101#dsam0000.=;
     |SI FSalida = 0;
         #dsam0000#68 = "S";
         |GRABA 020#dsam0000.a;
         |LIBERA #dsam0000;
     |FINSI;
     |CIERRA #dsam0000;

     nCompara = 1;
     nRegraba = 0;
     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 101#rem00100.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00100;
         nCompara = 0;
         nRegraba = 0;

         #rem00100#0     = #reacceso#0;
         #rem00100#1     = #reacceso#2;
         #rem00100#5     = #reacceso#1;

         |HAZ Separa;

         |GRABA 020#rem00100.b;

         |HAZ CargaCampos;

         nRegraba = 0;
     |SINO;
         |HAZ CargaCampos;
     |FINSI;

     |SI nRegraba = 1;
         |HAZ MenuPI;
     |SINO;
         |GRABA 020#rem00100.a;

         #reacceso#1   = #clientes@#5;
         #reacceso#2   = #clientes@#1;
         #reacceso#21  = #rem00100#35;
         #reacceso#22  = #rem00100#39;
     |FINSI;

     |LIBERA #rem00100;

     |CIERRA #rew99995;
     |DELINDEX #rew99995;

     eaPrograma   = "rem00100";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Separa;
     Cadena = #rem00100#5;
     |SI Cadena ! "";
         |HAZ SeparaNombre;
         #rem00100#2 = Cadena1;
         #rem00100#3 = Cadena2;
         #rem00100#4 = Cadena3;
     |FINSI;
|FPRC;

|PROCESO AltaCliente;
     nLinDif = 0;
     aFicTmp = "rew99995" + Usuario;
     |NOME_DAT #rew99995#aFicTmp#;
     |ABRE #rew99995;  |CIERRA #rew99995;  |DELINDEX #rew99995;

     |ABRE #rew99995;

     enCodCli = #reacceso#0;
     |HAZ LeePersona;
     |SI enError = 1;
         |SI enSwDeDonde = 1;
              |CONFI "0000NDesea dar de alta en estos momentos al cliente ";
              |SI FSalida = 0;
                  |HAZ AltaPI;

                  enCodCli = #reacceso#0;
                  |HAZ LeePersona;
                  |SI enError = 1;  |ACABA;  |FINSI;
              |SINO;
                   enError = 1;
                  |ACABA;
              |FINSI;
         |FINSI;
     |FINSI;

     enError  = 0;
     nCompara = 1;
     nRegraba = 0;

     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 101#rem00100.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00100;
         nCompara = 0;
         nRegraba = 0;
         #rem00100#0     = #reacceso#0;
         #rem00100#1     = #reacceso#2;
         #rem00100#5     = #reacceso#1;

         |HAZ Separa;

         |GRABA 020#rem00100.b;

         |HAZ CargaCampos;
         nRegraba = 0;
     |SINO;
         |HAZ CargaCampos;
     |FINSI;
     |CIERRA #rem00100;

     |CIERRA #rew99995;
     |DELINDEX #rew99995;
|FPRC;

|PROCESO Modicli;
     enCodCli = #reacceso#0;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         |SI #reacceso#2 ! #clientes@#1;
            |MENAV "     D.N.I. del Cliente es distinto al D.N.I. del Cliente General";
         |FINSI;

         |ABRE #rem00101;
         |HAZ MiraIntegrada;
         |CIERRA #rem00101;
     |SINO;
         |SI #reacceso#2 ! #clientes@#13;
            |MENAV "     D.N.I. del Cliente es distinto al D.N.I. del Cliente General";
         |FINSI;
     |FINSI;

     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI #rem00100#90 = "S";
         |SI #rem00100#92 < "01.01.2018";
             |SI #rem00100#91 = "T";
                 |MENAV "0000El TITULAR esta fallecido antes del 01.01.2018 por favor revise los datos.";
             |SINO;
                 |MENAV "0000El CONYUGE esta fallecido antes del 01.01.2018 por favor revise los datos.";
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|| ----------------------------------------------------------------------------

|PROCESO Lectura;
     aAlfa = "";
     #rem99999#0  = #reacceso#0;
     #rem99999#2  = aVariable % 902;
     #rem99999#1  = aVariable % 108;
     |SI #rem99999#2 ! "  ";
         |SI #rem99999#1 ! "rem00058";  |Y  #rem99999#1 ! "rem00065";  |Y  #rem99999#1 ! "rem00056";
             #rem99999#1 = "rem00099";
         |FINSI;
     |FINSI;

     |LEE 000#rem99999.=;
     |SI FSalida = 0;
         aAlfa = " [*]";

         |SI #rem99999#1 = "rem00100";  #reacceso#3  = "*";  |FINSI;
         |SI #rem99999#1 = "rem00020";  #reacceso#4  = "*";  |FINSI;
         |SI aCap = "REN-B ";    #reacceso#5  = "*";  |FINSI;
         |SI #rem99999#1 = "rem00021";  #reacceso#6  = "*";  |FINSI;
         |SI aCap = "REN-E ";    #reacceso#7  = "*";  |FINSI;
         |SI aCap = "REN-F ";    #reacceso#8  = "*";  |FINSI;
         |SI aCap = "REN-I ";    #reacceso#8  = "*";  |FINSI;
         |SI aCap = "REN-G1";    #reacceso#9  = "*";  |FINSI;
         |SI aCap = "REN-G2";    #reacceso#9  = "*";  |FINSI;
         |SI aCap = "REN-G4";    #reacceso#9  = "*";  |FINSI;
         |SI aCap = "REN-N ";    #reacceso#10 = "*";  |FINSI;
         |SI aCap = "PAT-TO";    #reacceso#11 = "*";  |FINSI;
         |SI #rem99999#1 = "rem01001";  #reacceso#12 = "*";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonAsterisco;
     |ABRE #rem99999;

     aCap      = aContenido % 103;
     aVariable = aContenido;
     aAlfa     = aVariable % 108;

     |SI aAlfa = "DATPER  ";  aVariable = "rem00100  ";  |FINSI;
     |SI aAlfa = "rezcalcu";  aVariable = "rem01001  ";  |FINSI;

     |SI aCap ! "REN";  |Y aCap ! "PAT";
         |HAZ Lectura;
         |ACABA;
     |FINSI;

     aCap  = aContenido % 106;

     |SI aCap = "REN-A ";
                           aVariable = "rem00020  ";  |HAZ Lectura;
     |FINSI;

     |SI aCap = "REN-B ";
                           aVariable = "rem00022  ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00023  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00024  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00051  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00052  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00055  ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "REN-E ";
                           aVariable = "rem00025  ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00026  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00027  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00028  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00031  ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "REN-F ";
                           aVariable = "rem000581 ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem000582 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000583 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000584 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00032  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00033  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00034  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00035  ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "REN-G1";
                           aVariable = "rem00037  ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00030  ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "REN-G2";
                           aVariable = "rem00036  ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00059  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00041  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00056G2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00042  ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "REN-I ";
                           aVariable = "rem00061  ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00053  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00054  ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "REN-N ";
                           aVariable = "rem00046  ";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00045  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00047  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00048  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00063  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00056  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00044  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00062  ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000651 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000652 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000653 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000654 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000655 ";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem000656 ";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "PAT-C ";
                           aVariable = "rem00099C1";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00099C2";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "PAT-F ";
                           aVariable = "rem00099F1";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00099F2";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "PAT-G ";
                           aVariable = "rem00099G1";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00099G2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099G3";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099G4";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "PAT-H ";
                           aVariable = "rem00099H1";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00099H2";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "PAT-V ";
                           aVariable = "rem00099V1";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00099V2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V3";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V4";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V5";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V6";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V7";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V8";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V9";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |SI aCap = "PAT-TO";
                           aVariable = "rem00099A1";  |HAZ Lectura;
          |SI aAlfa = "";  aVariable = "rem00099B1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099C1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099C2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099D1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099E1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099F1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099F2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099G1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099G2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099G3";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099G4";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099H1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099H2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099I1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099J1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099K1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099L1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099M1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099N1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099O1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099P1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099Q1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099U1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V1";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V2";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V3";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V4";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V5";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V6";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V7";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V8";  |HAZ Lectura;  |FINSI;
          |SI aAlfa = "";  aVariable = "rem00099V9";  |HAZ Lectura;  |FINSI;
     |FINSI;

     |CIERRA #rem99999;
|FPRC;

|PROCESO rem00900;
     |SI #rem00900#0 = 5;  |Y #rem00900#1 = 6;
         |SI #reacceso#7 = " ";  |ACABA; |FINSI;
     |FINSI;

     aAlfa      = "";

     aContenido = #rem00900#4 + #rem00900#5;
     |HAZ PonAsterisco;

                       aAlfa2 = "{{" + aContenido + "}}";
                       aAlfa1 = #rem00900#0;
     |SI #rem00900#1 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00900#1;  |FINSI;
     |SI #rem00900#2 ! 0;  aAlfa1 = aAlfa1 + "," + #rem00900#2;  |FINSI;

     aAlfa1 = aAlfa1 + ":" + #rem00900#3;  |QBF aAlfa1;

     aAlfa1 = aAlfa1 + " " + aAlfa + " " + aAlfa2 + &13 + &10;
     |XGRABA nHandle2, aAlfa1;
|FPRC;

|DEFBUCLE rem00900;
     #rem00900#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00900;
|FIN;

|PROCESO TraeTxtComprimido;
     aAlfa = aPathRenta + aFichero + ".tar " + aFichero + ".txt";
     |ATAR aAlfa, aPathRenta;

     aAlfa = aPathRenta + aFichero + ".tar";
     |COMPRIME aAlfa;

     aAlfa = aPathRenta + aFichero + ".tar";  |FBORRA aAlfa;
     aAlfa = aPathRenta + aFichero + ".txt";  |FBORRA aAlfa;

     aOrigen  = aPathRenta + aFichero + ".tgz";
     aDestino = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".tgz";

     |RFBORRA aDestino;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     Pos    = -1;
     aAlfa  = eaUnidadBasico + "\MODELOS\TMP\" + aFichero + ".tgz";
     aAlfa1 = eaUnidadBasico + "\MODELOS\TMP\";
     |RDESCOMPRIME aAlfa;
     |RDETAR aAlfa, aAlfa1;

     aAlfa = aPathRenta + aFichero + ".tgz";         |FBORRA aAlfa;
     aAlfa = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".tgz";  |RFBORRA aAlfa;
     aAlfa = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".tar";  |RFBORRA aAlfa;
|FPRC;

|PROCESO CreaFicheros;
     aFichero = "001" + (("00000" + #reacceso#0) % -105);

     |DBASE aPathRenta;  |QBT aPathRenta;
     aPathRenta = aPathRenta + "tmp";  |MKDIR aPathRenta;
     aPathRenta = aPathRenta + "/";

     aOrigen    = aPathRenta + aFichero + ".txt";

     #reacceso#3  = "";
     #reacceso#4  = "";
     #reacceso#5  = "";
     #reacceso#6  = "";
     #reacceso#7  = "";
     #reacceso#8  = "";
     #reacceso#9  = "";
     #reacceso#10 = "";
     #reacceso#11 = "";
     #reacceso#12 = "";

     |XABRE "WB", aOrigen, nHandle2;
     |BUCLE rem00900;
     |XCIERRA nHandle2;

     |HAZ TraeTxtComprimido;

     aDestino = eaUnidadBasico + "\MODELOS";      |RMKDIR aDestino;
     aDestino = eaUnidadBasico + "\MODELOS\TMP";  |RMKDIR aDestino;
     aDestino = eaUnidadBasico + "\MODELOS\TMP\"  + aFichero + ".TXT";
|FPRC;

|PROCESO rem00101Cheq;
     |SI #rem00101#17 = "01.01.0000";  |Y #rem00101#18 = "01.01.0000";
         nContinuar = 1;
         |ERROR10;
     |FINSI;

     |SI #rem00101#21 ] "01.01.2000";
         |SI #rem00101#21 < "01.01.2018";
             nContinuar = 2;
             |ERROR10;
             |ACABA;
         |FINSI;

         |SI #rem00101#21 > "31.12.2018";
             nContinuar = 2;
             |ERROR10;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101Cheq;
     #rem00101#1;
     ;
     #reacceso#0, 00;
     #reacceso#0, 99;
     ;
     NULL, rem00101Cheq;
|FIN;

|PROCESO rem00102Arrend;
     nHayArrend = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00102Arrend;
     #rem00102#1;
     9;
     #reacceso#0, 01, "3";
     #reacceso#0, 99, "3";
     ;
     NULL,  rem00102Arrend;
|FIN;

|PROCESO rem00021Cheq;
     |SI #rem00021#30 = 0;  |ACABA;  |FINSI;

     nError = 0;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00021Cheq;
     #rem00021#1;
     14;
     #reacceso#0, 01, #rem00102#11;
     #reacceso#0, 99, #rem00102#11;
     ;
     NULL, rem00021Cheq;
|FIN;

|PROCESO rem00102Cheq;
     nError = 1;
     |BUCLE rem00021Cheq;
     |SI nError = 0;  |ACABA;  |FINSI;

     aAlfa = "LABEL,{{15}}No existe la Referencia Catastral: " + #rem00102#11;  |QBF aAlfa;
     aAlfa = aAlfa + " informada";
     |CONTROL_SIMPLE 0, aAlfa, 1215, 1298, NULL;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}en los datos adicionales de la vivienda habitual en el inmobiliario.", 1315, 1398, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{15}}Por favor inf¢rmelo.", 1415, 1498, NULL;

     |LEETECLA  aAlfa;

     nContinuar = 1;
|FPRC;

|DEFBUCLE rem00102Cheq;
     #rem00102#1;
     9;
     #reacceso#0, 01, "1";
     #reacceso#0, 99, "2";
     ;
     NULL,  rem00102Cheq;
|FIN;

|PROCESO ChequeaLiquidacion;
     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     nContinuar = 0;

     |SI #rem00100#103 = "01.01.0000";
         |MENAV "0000 Fecha nacimiento contribuyente sin informar.";
         nContinuar = 1;
         |ACABA;
     |FINSI;

     |SI #rem00100#6 = "C";
         |SI #rem00100#104 = "01.01.0000";
             |MENAV "0000 Fecha nacimiento conyuge sin informar.";
             nContinuar = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #rem00100#92 ] "01.01.2000";
         |SI #rem00100#92 < "01.01.2018";
             |MENAV "0000 Fecha fallecimiento err¢nea.";
             nContinuar = 1;
             |ACABA;
         |FINSI;

         |SI #rem00100#92 > "31.12.2018";
             |MENAV "0000 Fecha fallecimiento err¢nea.";
             nContinuar = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |BUCLE rem00101Cheq;

     |SI nContinuar = 1;
         |MENAV "0000 Fecha nacimiento de familiares sin informar.";
         |ACABA;
     |FINSI;

     |SI nContinuar = 2;
         |MENAV "0000 Fecha defunci¢n de familiar err¢nea.";
         |ACABA;
     |FINSI;

     |ABRE #rem00044;
     #rem00044#0 = #reacceso#0;
     #rem00044#1 = 0;
     |LEE 000#rem00044.];
     |SI FSalida ! 0;  |O #rem00044#0 ! #reacceso#0;
         |CONFI "0000SNo hay deducciones auton¢micas. Continuar.";
         |SI FSalida ! 0;
             |CIERRA #rem00044;
             nContinuar = 1;
             |ACABA;
         |SINO;
             |CONFI "0000SMostrar la pregunta anterior la pr¢xima vez que se liquide esta renta";
             |SI FSalida ! 0;
                 #rem00044#0 = #reacceso#0;
                 #rem00044#1 = 0;
                 |GRABA 020#rem00044.n;
                 |LIBERA #rem00044;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #rem00044;

     |SI #rem00100#94 = "S";  |ACABA;  |FINSI;

     |ABRE #rem00102;
     #rem00102#0 = #reacceso#0;
     #rem00102#1 = 1;
     |LEE 000#rem00102.];
     |SI FSalida ! 0;  |O #rem00102#0 ! #reacceso#0;
         |CIERRA #rem00102;
         |MENAV "0000 No hay Datos Adicionales de la Vivienda, por favor introduzcalas.";
         nContinuar = 1;
         |ACABA;
     |FINSI;
     |CIERRA #rem00102;

     |BUCLE rem00102Cheq;
|FPRC;

|PROCESO LanzaPrograma;
     |PULSATECLA;

     aAlfa  = aPrograma % 108;
     aAlfa1 = aPrograma % 902;
     |SI aAlfa1 ! "  ";
         eaLetra = aAlfa1;
     |FINSI;

     |SI aAlfa ! "rezcalcu";
         |SUB_EJECUTA_NP aAlfa;

         |SI aAlfa = "rew00200";
             |ABRE #rem00100;
             #rem00100#0 = #reacceso#0;
             |LEE 040#rem00100.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
             |CIERRA #rem00100;

             #reacceso#1 = #rem00100#5;

             aTitulo   = (("00000" + #reacceso#0) % -105) + " " + #reacceso#1;
         |FINSI;

         |HAZ CreaFicheros;
     |SINO;
         nContinuar = 0;

         |SI enModo ! 4;
             |VENTANA 0501, 3599, -1, 0, "";
             nVentana = FSalida;

             |PTEC 802;  |PAUSA;

             |HAZ ChequeaLiquidacion;

             |SI nContinuar = 0;
                 enPatrimonio = 0;

                 |SUB_EJECUTA_NP "rezcalcu";
             |FINSI;

             |FINVENTANA nVentana;

             |PULSATECLA;
         |FINSI;

         |SI nContinuar = 0;
             |SI enModo = 4;
                 |SI #reacceso#12 = " ";
                     |MENAV "0000Est  en modo consulta y esta renta no se ha calculado.";
                     aPrograma = "";

                     |ACABA;
                 |FINSI;
             |FINSI;

             |SUB_EJECUTA_NP "rem01001";
             aPrograma = "";
         |FINSI;
     |FINSI;

     eaContri = "";
|FPRC;

|PROCESO CreaMenu;
     |HAZ CreaFicheros;

     aPrograma = "";
     aTitulo   = (("00000" + #reacceso#0) % -105) + " " + #reacceso#1;
     |PARA;  |SI;  |HACIENDO;
          aAbre = eaUnidadBasico + "\MODELOS\TMP\"  + "000" + (("00000" + #reacceso#0) % -105) + ".TXT";
          |XABRE "WCB", aAbre, nHandle;

          aAlfa = ((aDestino + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = ((aTitulo + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;

          aAlfa = ((aPrograma + (" " * 99)) % 198) + &13 + &10;
          |XGRABA nHandle, aAlfa;
          |XCIERRA nHandle;

          aAlfa    = "rez99999;" + aAbre;
          |SUB_EJECUTA_NP aAlfa;

          nLinea = 1;
          |XABRE "ABC",  aAbre,  nHandle;
          |PARA;  |SI;  |HACIENDO;
              |XLEE nHandle, 100, aAlfa;
              |SI FSalida [ 0;  |SAL;  |FINSI;

              |SI nLinea = 1;  aAbre     = aAlfa % 198;  |FINSI;
              |SI nLinea = 2;  aTitulo   = aAlfa % 198;  |FINSI;
              |SI nLinea = 3;  aPrograma = aAlfa % 198;  |FINSI;

              nLinea = nLinea + 1;
          |SIGUE;
          |XCIERRA nHandle;

          |QBF aAbre;
          |QBF aTitulo;
          |QBF aPrograma;

          |SI aPrograma = "";  |SAL;  |FINSI;

          |SI aPrograma ! "rem05000";
              |HAZ LanzaPrograma;
          |FINSI;

          |SI aPrograma = "rem05000";
              aAlfa     = "rem05000;" + (("00000" + #reacceso#0) % -105) + enModo;
              |SUB_EJECUTA_NP aAlfa;

              enCodCli  = #reacceso#0;
              |SUB_EJECUTA_NP "rezprogr";
              |HAZ CreaFicheros;
          |FINSI;

          |SI aPrograma = "";
              |HAZ CreaFicheros;
              |SAL;
          |FINSI;
     |SIGUE;

     aAbre = eaUnidadBasico + "\MODELOS\TMP\"  + "000" + (("00000" + #reacceso#0) % -105) + ".TXT";
     |RFBORRA aAbre;

     aAbre = eaUnidadBasico + "\MODELOS\TMP\"  + "001" + (("00000" + #reacceso#0) % -105) + ".TXT";
     |RFBORRA aAbre;
|FPRC;

|PROCESO Pantalla;
     enEmpresa        = #reacceso#0;
     eaNombre         = #reacceso#1;
     eaNif            = #reacceso#2;
     enComplementaria = 0;

     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI #rem00100#10 = "S";
        eaExtr = "N";
     |SINO;
        eaExtr = "S";
     |FINSI;

     |SI #reparame#20 = "S";  #reacceso#16 = Usuario % 810;  |FINSI;

     |HAZ CreaMenu;
|FPRC;

|PROCESO MiraImpre;
     |SI #rem01001#5 = "   ";  |ACABA;  |FINSI;

     |SI #rem01001#5 ! "714";
         |SI #reacceso#14 = "INACTIVO  ";
             #reacceso#14 = "NO IMPRESO";
         |FINSI;

         |SI #rem01001#6 = "S";  |Y #reacceso#14 = "NO IMPRESO";
             #reacceso#14 = "IMPRESO";
         |FINSI;

         |SI #rem01001#6 = "N";  |Y #reacceso#14 = "IMPRESO   ";
              #reacceso#14 = "PARCIAL";
         |FINSI;
     |FINSI;

     |SI #rem01001#5 = "714";
         |SI #reacceso#15 = "INACTIVO  ";
             #reacceso#15 = "NO IMPRESO";
         |FINSI;

         |SI #rem01001#6 = "S";  |Y #reacceso#15 = "NO IMPRESO";
             #reacceso#15 = "IMPRESO";
         |FINSI;

         |SI #rem01001#6 = "N";  |Y #reacceso#15 = "IMPRESO   ";
             #reacceso#15 = "PARCIAL";
         |FINSI;
     |FINSI;

                                       #reacceso#20 = "";
     |SI #reacceso#12 = "*";           #reacceso#20 = eaAzul;   |FINSI;
     |SI #reacceso#14 = "IMPRESO   ";  #reacceso#20 = eaVerde;  |FINSI;
     |SI #reacceso#19 = "S";           #reacceso#20 = eaRosa;   |FINSI;
     |SI #reacceso#23 = "S";           #reacceso#20 = eaRojo;   |FINSI;
     |SI #reacceso#24 = "S";           #reacceso#20 = eaMarron; |FINSI;

     eaImpreso = "N";
     aAlfa = #reacceso#20;  |QBF aAlfa;
     |SI aAlfa = eaVerde;
         eaImpreso = "S";      || Para la auditoria
     |FINSI;
|FPRC;

|DEFBUCLE rem01001;
     #rem01001#1;
     ;
     #reacceso#0, 00, "          ";
     #reacceso#0, 00, "zzzzzzzzzz";
     ;
     NULL, MiraImpre;
|FIN;

|PROCESO DatosPantalla;
     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 040#rem00100.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100;  |FINSI;
     |CIERRA #rem00100;

     |SI #rem00100#10 = "S";
        eaExtr = "N";
     |SINO;
        eaExtr = "S";
     |FINSI;

     |SI #rem00100#56 = "X";  #reacceso#13 = "INDIVIDUAL";  |FINSI;
     |SI #rem00100#57 = "X";  #reacceso#13 = "CONJUNTA  ";  |FINSI;
     |SI #rem00100#58 = "X";  #reacceso#13 = "SEPARADA  ";  |FINSI;

     #reacceso#14 = "INACTIVO";
     #reacceso#15 = "INACTIVO";
     #reacceso#21  = #rem00100#35;
     #reacceso#22  = #rem00100#39;

     |BUCLE rem01001;
|FPRC;

|PROCESO Modificar;
     #reacceso#0 = enEmpresa;
     |LEE 101#reacceso.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aUsuario1  = #reacceso#16;  |QBF aUsuario1;
     |SI #reparame#20 = "S";  |O aUsuario1 ! "";
         aUsuario2 = Usuario % 810;  |QBF aUsuario2;

         |SI aUsuario1 ! aUsuario2;  |Y aUsuario1 ! "";
             |MENAV "0000 No tiene permiso para entrar en esta Renta.";
             |LIBERA #reacceso;
             |ACABA;
         |FINSI;
     |FINSI;

     enEmpresa = #reacceso#0;
     enModo    = 2;

     |ABRE #rem99999;
     #rem99999#0 = #reacceso#0;
     #rem99999#1 = "rem01001";
     #rem99999#2 = "";
     |LEE 000#rem99999.=;
     nLiquida = FSalida;
     |CIERRA #rem99999;

     |SI nLiquida = 0;  |Y enModo ! 4;
         |CONFI "0000NRenta ya calculada, desea anular calculo ";
         |SI FSalida ! 0;
             |LIBERA #reacceso;
             |ACABA;
         |FINSI;

         |HAZ BorraLiquidacion;
         eaPrograma   = "rem01001";
         |HAZ ProgramaActivo;
     |FINSI;

     |PULSATECLA;
     |SUB_EJECUTA_NP "rezcaptu";
     |PULSATECLA;

     enCodCli  = #reacceso#0;
     |SUB_EJECUTA_NP "rezprogr";
     |PULSATECLA;

     |SI enModo = 1; |O enModo = 2;
         #reacceso#23 = "N";
         #reacceso#24 = "N";
         #reacceso#25 = "";
         #reacceso#26 = "01.01.0000";
         #reacceso#27 = "";

         |GRABA 020#reacceso.a;
         |LIBERA #reacceso;

         |LEE 101#reacceso.=;
         |HAZ Pantalla;
         |HAZ DatosPantalla;
     |FINSI;

                                       #reacceso#20 = "";
     |SI #reacceso#12 = "*";           #reacceso#20 = eaAzul;    |FINSI;
     |SI #reacceso#14 = "IMPRESO   ";  #reacceso#20 = eaVerde;   |FINSI;
     |SI #reacceso#19 = "S";           #reacceso#20 = eaRosa;    |FINSI;
     |SI #reacceso#23 = "S";           #reacceso#20 = eaRojo;    |FINSI;
     |SI #reacceso#24 = "S";           #reacceso#20 = eaMarron;  |FINSI;

     eaImpreso = "N";
     aAlfa = #reacceso#20;  |QBF aAlfa;
     |SI aAlfa = eaVerde;
         eaImpreso = "S";      || Para la auditoria
     |FINSI;

     enEmpresa = #reacceso#0;

     |GRABA 020#reacceso.a;
     |LIBERA #reacceso;

     |PULSATECLA;
|FPRC;

|PROCESO Consultar;
     enModo = 4;

     |HAZ Pantalla;
|FPRC;
