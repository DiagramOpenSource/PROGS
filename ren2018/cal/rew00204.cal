|FICHEROS;
     rem00100;
     rew00204;

     &haciend@;
|FIN;

|VARIABLES;
     aAlfa      = "";
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;
     nCampo4    = 0;
     nCampo5    = 0;
     nCampo6    = 0;
     nCampo7    = 0;
     nCampo8    = 0;
     nCampo9    = 0;

     &enCodProv  = 0;
     &enCodPobl  = 0;
     &eaCta      = "";
     &eaIBAN     = "";
     &eaEntidad  = "";
     &eaSucursal = "";
     &eaDC       = "";
     &eaCuenta   = "";
|FIN;

|PROCESO Tipo12Fw204;  |TIPO 12;
     |SI #rew00204#0 = "N";  #rew00204#0 = " ";  |FINSI;
     |SI #rew00204#0 = "S";  #rew00204#0 = "X";  |FINSI;
     |SI #rew00204#1 = "N";  #rew00204#1 = " ";  |FINSI;
     |SI #rew00204#1 = "S";  #rew00204#1 = "X";  |FINSI;
     |SI #rew00204#2 = "N";  #rew00204#2 = " ";  |FINSI;
     |SI #rew00204#2 = "S";  #rew00204#2 = "X";  |FINSI;

     #rew00204#11 = #rew00204#28 + #rew00204#29 + #rew00204#30 + #rew00204#31;
     #rew00204#12 = #rew00204#32 + #rew00204#33 + #rew00204#34 + #rew00204#35;
     #rew00204#13 = #rew00204#36 + #rew00204#37 + #rew00204#38 + #rew00204#39;
|FPRC;

|PROCESO IBAN;  |TIPO 0;
     |SI Campo = 31;
         |C_M #rew00204#49, 1, "N";

         eaCta = #rew00204#28 + #rew00204#29 + #rew00204#30 + #rew00204#31;
         |QBF eaCta;
         |SI eaCta = "";
             |C_M #rew00204#49, 1, "S";

             |ACABA;
         |FINSI;

         eaEntidad  = #rew00204#28;
         eaSucursal = #rew00204#29;
         eaDC       = #rew00204#30;
         eaCuenta   = #rew00204#31;
         |HAZ CalculoDC;
         |SI eaDC ! #rew00204#30;
             aAlfa = "0000El D¡gito de Control deberia ser " + eaDC;
             |MENAV aAlfa;
         |FINSI;

         |HAZ CalcuIBAN;
         #rew00204#49 = eaIBAN;  |PINTA #rew00204#49;
     |FINSI;

     |SI Campo = 35;
         |C_M #rew00204#50, 1, "N";

         eaCta = #rew00204#32 + #rew00204#33 + #rew00204#34 + #rew00204#35;
         |QBF eaCta;
         |SI eaCta = "";
             |C_M #rew00204#50, 1, "S";

             |ACABA;
         |FINSI;

         eaEntidad  = #rew00204#32;
         eaSucursal = #rew00204#33;
         eaDC       = #rew00204#34;
         eaCuenta   = #rew00204#35;
         |HAZ CalculoDC;
         |SI eaDC ! #rew00204#34;
             aAlfa = "0000El D¡gito de Control deberia ser " + eaDC;
             |MENAV aAlfa;
         |FINSI;

         |HAZ CalcuIBAN;
         #rew00204#50 = eaIBAN;  |PINTA #rew00204#50;
     |FINSI;

     |SI Campo = 39;
         |C_M #rew00204#51, 1, "N";

         eaCta = #rew00204#36 + #rew00204#37 + #rew00204#38 + #rew00204#39;
         |QBF eaCta;
         |SI eaCta = "";
             |C_M #rew00204#51, 1, "S";

             |ACABA;
         |FINSI;

         eaEntidad  = #rew00204#36;
         eaSucursal = #rew00204#37;
         eaDC       = #rew00204#38;
         eaCuenta   = #rew00204#39;
         |HAZ CalculoDC;
         |SI eaDC ! #rew00204#38;
             aAlfa = "0000El D¡gito de Control deberia ser " + eaDC;
             |MENAV aAlfa;
         |FINSI;

         |HAZ CalcuIBAN;
         #rew00204#51 = eaIBAN;  |PINTA #rew00204#51;
     |FINSI;
|FPRC;

|PROCESO Tipo0C0Fw204;  |TIPO 0;
     |SI #rew00204#0 = "S";
         #rew00204#1 = "N";   |PINTA #rew00204#1;
         #rew00204#2 = "N";   |PINTA #rew00204#2;
     |FINSI;
|FPRC;

|PROCESO Tipo0C1Fw204;  |TIPO 0;
     |SI #rew00204#1 = "S";
         #rew00204#0 = "N";   |PINTA #rew00204#0;
         #rew00204#2 = "N";   |PINTA #rew00204#2;
     |FINSI;
|FPRC;

|PROCESO Tipo0C2Fw204;  |TIPO 0;
     |SI #rew00204#2 = "S";
         #rew00204#0 = "N";   |PINTA #rew00204#0;
         #rew00204#1 = "N";   |PINTA #rew00204#1;
     |FINSI;
|FPRC;

|PROCESO Tipo7C5Fw204;  |TIPO 7;
     |C_M #rew00204#5, 1, "S";
     |SI #rem00100#6 = "S"; |O #rem00100#6 = "V";  |O #rem00100#6 = "L";
         |C_M #rew00204#5, 1, "N";
         #rew00204#5 = "";  |PINTA #rew00204#5;
     |FINSI;
|FPRC;

|PROCESO Tipo0C7Fw204;  |TIPO 0;
     |SI #rew00204#7 = " ";
         #rew00204#6 = "N";
         |C_M #rew00204#8, 1, "N"; #rew00204#8 = "01.01.0000";  |PINTA #rew00204#8;
                              #rew00204#9 = 0;
         |ACABA;
     |FINSI;

     #rew00204#6 = "S";
     |C_M #rew00204#8, 1, "S";
|FPRC;

|PROCESO Tipo0C8Fw204;  |TIPO 0;
     |C_M #rew00204#8, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #rew00204#8 < "01.01.2018";  |O #rew00204#8 > "31.12.2018";
         |MENAV "0000 Fecha erronea";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #rew00204#8 > "01.01.0000";
         #rew00204#9 = 2;
     |FINSI;
|FPRC;
