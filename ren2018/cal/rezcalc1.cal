|FICHEROS;
      rew99999;
      rem00903;
      rem00015;

      rem01010@;
      rem01011@;
      rem01012@;
      rem01013@;
      rem01015@;
      rem01018@;
      rem01041@;
      rem01052@;
      rem01055@;

      datfic0@ #0;

     &refere1@ #100;
     &refere2@ #200;
     &refere3@ #300;
|FIN;

|VARIABLES;
      aDef             = "";
      aAlfa            = "";
      aFichero         = "";
      aContri          = "";
      aTipoUso         = "";
      aAlfa1           = "";
      aAlfa2           = "";
      aAlfa3           = "";
      aAlfa4           = "";
      aAlfa5           = "";
      aAlfa6           = "";
      aTit             = "";
      aCas             = "";
      a0075            = "";
      a0076            = "";
      a0077            = "";
      a0078            = "";

      nLinea           = 0;
      nLinea61         = 0;
      nPorce           = 0;
      nCoefi           = 0;
      nSwFich          = 0;
      nFactor          = 0;
      nCampo16         = 0;
      nValor           = 0;
      nValor1          = 0;
      nValor2          = 0;
      nValor3          = 0;
      nCatastral       = 0;
      nCampo3          = 0;
      nCampo4          = 0;
      nCampo5          = 0;
      nCampo7          = 0;
      nCampo9          = 0;
      nCampo10         = 0;
      nCampo11         = 0;
      nCampo12         = 0;
      nCampo13         = 0;
      nCampo23         = 0;
      nDiasAlq         = 0;
      nDiasUso         = 0;
      nTotalDias       = 0;
      nTotal           = 0;
      nCoefiAnt        = 0;
      nSuma            = 0;
      nTotAlq          = 0;
      nIngresos1       = 0;
      nIngresos2       = 0;
      nIrregular       = 0;
      nTGtos           = 0;
      nGtos61          = 0;
      nGtos62          = 0;
      nGtos63          = 0;
      nGtos64          = 0;
      nGtos65          = 0;
      nGtos66          = 0;
      nGtos67          = 0;
      nGtos68          = 0;
      nGtos69          = 0;
      nGtosEj1         = 0;
      nGtosEj2         = 0;
      nGtosEj3         = 0;
      nGtosEj4         = 0;
      nImputa          = 0;
      nResta           = 0;
      nExc             = 0;
      nPorc            = 0;
      nCoefi1          = 0;
      nCoefi2          = 0;
      nCoefi3          = 0;
      nCoefi4          = 0;
      nCoefi5          = 0;
      nCoefi6          = 0;
      nPas             = 0;
      nArrd            = 0;
      nEmp             = 0;
      nLin             = 0;
      nCon             = 0;
      nPag             = 0;
      nCmp             = 0;
      nPagT            = 0;
      nPagC            = 0;
      nPag1            = 0;
      nPag2            = 0;
      nPag3            = 0;
      nPag4            = 0;
      nPagIT           = 0;
      nPagIC           = 0;
      nPagI1           = 0;
      nPagI2           = 0;
      nPagI3           = 0;
      nPagI4           = 0;

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaPathDef        = "";
     &eaContri         = "";
     &enMinusvalia     = 0;
     &eaMinuAyuda      = "";
     &eaCasilla        = "";
     &enImporte        = 0;
     &eaColImp         = "";
     &enSwAcum         = 0;
     &enNomeDat        = 0;
     &enNomeAgr        = 0;

     &eaMuerto         = "";
     &efFechaMuerto    = @;
     &enCalcuMuerto    = 0;
     &enParte1         = 0;
     &enParte2         = 0;
     &enTipoLiquida    = 0;
     &eaPaisano        = "";
     &eaReside         = "";

     &eaPrograma       = "";
     &enLinea          = 0;
     &eaObserva        = "";
     &enRedon          = 0;
|FIN;

|PROCESO GrabaExcesos_1;
     aCas = aCas % 104;

     |SELECT #2#rem01055@;
     #rem01055@#0  = #refere1@#0;
     #rem01055@#1  = #refere1@#1;
     #rem01055@#2  = #refere1@#2;
     #rem01055@#3  = #rem01011@#3;
     #rem01055@#7  = aCas;
     |LEE 101#rem01055@.=;
     |SI FSalida ! 0;
         #rem00903#2 = aCas;
         |LEE 000#rem00903.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |DDEFECTO #rem01055@;

         |SELECT #1#rem01055@;
         #rem01055@#0  = #refere1@#0;
         #rem01055@#1  = #refere1@#1;
         #rem01055@#2  = #refere1@#2;
         #rem01055@#3  = #rem01011@#3;
         #rem01055@#4  = #rem00903#0;
         #rem01055@#5  = #rem01011@#4;
         #rem01055@#6  = #rem00903#1;
         #rem01055@#7  = #rem00903#2;
         #rem01055@#9  = #rem00903#3;
         #rem01055@#11 = #rem00903#4;
         #rem01055@#13 = #rem00903#5;

         |GRABA 020#rem01055@.b;
     |FINSI;

     #rem01055@#8 = (N\ #rem01055@#8 + ((nExc % nCoefi) + enRedon));

     |GRABA 020#rem01055@.a;
     |LIBERA #rem01055@;
|FPRC;

|PROCESO LiquidaA1;
     || datfic0 = "rem00020";

     #rem01010@#0 = #refere1@#0;
     #rem01010@#1 = #refere1@#1;
     #rem01010@#2 = #refere1@#2;
     |LEE 101#rem01010@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01010@;
         #rem01010@#0 = #refere1@#0;
         #rem01010@#1 = #refere1@#1;
         #rem01010@#2 = #refere1@#2;
         |GRABA 020#rem01010@.b;
     |FINSI;

     #rem01010@#3  = (N\ #rem01010@#3  + ((#datfic0@#7  % nCoefi) + enRedon));
     #rem01010@#3  = (N\ #rem01010@#3  + ((#datfic0@#28 % nCoefi) + enRedon));
     #rem01010@#4  = (N\ #rem01010@#4  + ((#datfic0@#9  % nCoefi) + enRedon));
     #rem01010@#5  = (N\ #rem01010@#5  + ((#datfic0@#10 % nCoefi) + enRedon));
     #rem01010@#6  = (N\ #rem01010@#6  + ((#datfic0@#11 % nCoefi) + enRedon));
     #rem01010@#7  = (N\ #rem01010@#7  + ((#datfic0@#12 % nCoefi) + enRedon));

     |SI #datfic0@#35 = "N";
         #rem01010@#8  = (N\ #rem01010@#8  + ((#datfic0@#16 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#35 = "S";
         #rem01010@#9 = (N\ #rem01010@#9 + ((#datfic0@#16 % nCoefi) + enRedon));
     |FINSI;

     #rem01010@#10 = (N\ #rem01010@#10 + ((#datfic0@#34 % nCoefi) + enRedon));
     #rem01010@#11 = (N\ #rem01010@#11 + ((#datfic0@#18 % nCoefi) + enRedon));
     #rem01010@#12 = (N\ #rem01010@#3  + #rem01010@#7 + #rem01010@#8 + #rem01010@#9 + #rem01010@#10 - #rem01010@#11);

     #rem01010@#13 = (N\ #rem01010@#13 + ((#datfic0@#19 % nCoefi) + enRedon));
     #rem01010@#14 = (N\ #rem01010@#14 + ((#datfic0@#20 % nCoefi) + enRedon));
     #rem01010@#15 = (N\ #rem01010@#15 + ((#datfic0@#21 % nCoefi) + enRedon));
     |SI #rem01010@#15 > 500;  #rem01010@#15 = 500;  |FINSI;

     #rem01010@#16 = (N\ #rem01010@#16 + ((#datfic0@#22 % nCoefi) + enRedon));
     |SI #rem01010@#16 > 300;  #rem01010@#16 = 300;  |FINSI;

     #rem01010@#17 = (N\ #rem01010@#12 - #rem01010@#13 - #rem01010@#14 - #rem01010@#15 - #rem01010@#16);

     |SI #datfic0@#27 = "S";
         #rem01010@#19 = (N\ #rem01010@#19 + ((#datfic0@#37 % nCoefi) + enRedon));
         |SI #rem01010@#19 > 2000; #rem01010@#19 = 2000;  |FINSI;
     |FINSI;

     |SI #datfic0@#29 = "S";
         |ABRE #rew99999;
         |SELECT #2#rew99999;
         #rew99999#1 = #datfic0@#2;
         |LEE 040#rew99999.=;
         |SI FSalida  ! 0;  |DDEFECTO #rew99999;  |FINSI;
         |CIERRA #rew99999;

         #rem01010@#20 = (N\ #rem01010@#20 + ((#datfic0@#37 % nCoefi) + enRedon));

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
             |SI #rew99999#4 = "N";
                 |SI #rem01010@#20 > 3500; #rem01010@#20 = 3500;  |FINSI;
             |SINO;
                 |SI #rem01010@#20 > 7750; #rem01010@#20 = 7750;  |FINSI;
             |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65;
             |SI #rem01010@#20 > 7750; #rem01010@#20 = 7750;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem01010@#19 < 0; #rem01010@#19 = 0;  |FINSI;
     |SI #rem01010@#20 < 0; #rem01010@#20 = 0;  |FINSI;

     #rem01010@#21 = (N\ #rem01010@#17 - #rem01010@#18 - #rem01010@#19 - #rem01010@#20);
     #rem01010@#24 = (N\ #rem01010@#21 - #rem01010@#22);

     #rem01010@#25 = (N\ #rem01010@#25 + ((#datfic0@#6  % nCoefi) + enRedon));
     #rem01010@#25 = (N\ #rem01010@#25 + ((#datfic0@#10 % nCoefi) + enRedon));

     #rem01010@#31 = "0";
     |SI #datfic0@#39 = "S";
         #rem01010@#31 = "1";
     |FINSI;

     enSwAcum  = 0;
     eaCasilla = "01-0003-LIQ18";  enImporte = #rem01010@#3;   |HAZ GrabaLineal;
     eaCasilla = "01-0004-LIQ18";  enImporte = #rem01010@#4;   |HAZ GrabaLineal;
     eaCasilla = "01-0005-LIQ18";  enImporte = #rem01010@#5;   |HAZ GrabaLineal;
     eaCasilla = "01-0006-LIQ18";  enImporte = #rem01010@#6;   |HAZ GrabaLineal;
     eaCasilla = "01-0007-LIQ18";  enImporte = #rem01010@#7;   |HAZ GrabaLineal;
     eaCasilla = "01-0008-LIQ18";  enImporte = #rem01010@#8;   |HAZ GrabaLineal;
     eaCasilla = "01-0009-LIQ18";  enImporte = #rem01010@#9;   |HAZ GrabaLineal;
     eaCasilla = "01-0010-LIQ18";  enImporte = #rem01010@#10;  |HAZ GrabaLineal;
     eaCasilla = "01-0011-LIQ18";  enImporte = #rem01010@#11;  |HAZ GrabaLineal;
     eaCasilla = "01-0012-LIQ18";  enImporte = #rem01010@#12;  |HAZ GrabaLineal;
     eaCasilla = "01-0013-LIQ18";  enImporte = #rem01010@#13;  |HAZ GrabaLineal;
     eaCasilla = "01-0014-LIQ18";  enImporte = #rem01010@#14;  |HAZ GrabaLineal;
     eaCasilla = "01-0015-LIQ18";  enImporte = #rem01010@#15;  |HAZ GrabaLineal;
     eaCasilla = "01-0016-LIQ18";  enImporte = #rem01010@#16;  |HAZ GrabaLineal;
     eaCasilla = "01-0017-LIQ18";  enImporte = #rem01010@#17;  |HAZ GrabaLineal;
     eaCasilla = "01-0018-LIQ18";  enImporte = #rem01010@#17;  |HAZ GrabaLineal;

     eaCasilla = "01-0019-LIQ18";  enImporte = #rem01010@#18;  |HAZ GrabaLineal;
     eaCasilla = "01-0020-LIQ18";  enImporte = #rem01010@#19;  |HAZ GrabaLineal;
     eaCasilla = "01-0021-LIQ18";  enImporte = #rem01010@#20;  |HAZ GrabaLineal;
     eaCasilla = "01-0022-LIQ18";  enImporte = #rem01010@#21;  |HAZ GrabaLineal;
     eaCasilla = "01-0023-LIQ18";  enImporte = #rem01010@#22;  |HAZ GrabaLineal;
     eaCasilla = "01-0025-LIQ18";  enImporte = #rem01010@#24;  |HAZ GrabaLineal;

     eaCasilla = "42-0596-LIQ18";  enImporte = #rem01010@#25;  |HAZ GrabaLineal;

     |GRABA 020#rem01010@.a;
     |LIBERA #rem01010@;

     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 101#rem01018@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01018@;
         #rem01018@#0 = #refere1@#0;
         #rem01018@#1 = #refere1@#1;
         #rem01018@#2 = #refere1@#2;
         |GRABA 020#rem01018@.b;
     |FINSI;

     #rem01018@#15 = (N\ #rem01010@#21);

     #rem01018@#33 = (N\ #rem01018@#33 + 1);

     |SI #datfic0@#40 = "S";
         #rem01018@#35 = (N\ #rem01018@#35 + 1);
     |FINSI;

     |SI #datfic0@#41 = "S";
         #rem01018@#36 = (N\ #rem01018@#36 + 1);
     |FINSI;

     |SI #datfic0@#42 = "S";
         #rem01018@#37 = (N\ #rem01018@#37 + 1);
     |FINSI;

     |SI #datfic0@#43 = "S";
         #rem01018@#38 = (N\ #rem01018@#38 + 1);
     |FINSI;

     #rem01018@#39 = (N\ #rem01010@#11 + #rem01010@#12);

     |SI #rem01010@#2 ! "CONJUNTA  ";  |Y #rem01010@#2 ! "CONJUNTAE ";
         #rem01018@#34 = (N\ #rem01018@#34 + 1);

         || Bug de una version quitar al a¤o que viene tiene
         || que venir bien calculado
         #datfic0@#24 = #datfic0@#7  + #datfic0@#12 + #datfic0@#34 + #datfic0@#16 + #datfic0@#28;

         |SI #rem01010@#2 = "TITULAR   ";
             nPagT = nPagT + 1;
             |SI nPagT > 1;
                 #rem01018@#40 = (N\ #rem01018@#40 + ((#datfic0@#24 % nCoefi) + enRedon));

                 nPagIT = #rem01018@#40;
             |FINSI;
         |FINSI;

         |SI #rem01010@#2 = "CONYUGE   ";
             nPagC = nPagC + 1;
             |SI nPagC > 1;
                 #rem01018@#40 = (N\ #rem01018@#40 + ((#datfic0@#24 % nCoefi) + enRedon));

                 nPagIC = #rem01018@#40;
             |FINSI;
         |FINSI;

         |SI #rem01010@#2 = "1 FAMILIAR";
             nPag1 = nPag1 + 1;
             |SI nPag1 > 1;
                 #rem01018@#40 = (N\ #rem01018@#40 + ((#datfic0@#24 % nCoefi) + enRedon));

                 nPagI1 = #rem01018@#40;
             |FINSI;
         |FINSI;

         |SI #rem01010@#2 = "2 FAMILIAR";
             nPag2 = nPag2 + 1;
             |SI nPag2 > 1;
                 #rem01018@#40 = (N\ #rem01018@#40 + ((#datfic0@#24 % nCoefi) + enRedon));

                 nPagI2 = #rem01018@#40;
             |FINSI;
         |FINSI;

         |SI #rem01010@#2 = "3 FAMILIAR";
             nPag3 = nPag3 + 1;
             |SI nPag3 > 1;
                 #rem01018@#40 = (N\ #rem01018@#40 + ((#datfic0@#24 % nCoefi) + enRedon));

                 nPagI3 = #rem01018@#40;
             |FINSI;
         |FINSI;

         |SI #rem01010@#2 = "4 FAMILIAR";
             nPag4 = nPag4 + 1;
             |SI nPag4 > 1;
                 #rem01018@#40 = (N\ #rem01018@#40 + ((#datfic0@#24 % nCoefi) + enRedon));

                 nPagI4 = #rem01018@#40;
             |FINSI;
         |FINSI;
     |SINO;
                                     #rem01018@#34 = nPagT;
         |SI #rem01018@#34 < nPagC;  #rem01018@#34 = nPagC;  |FINSI;
         |SI #rem01018@#34 < nPag1;  #rem01018@#34 = nPag1;  |FINSI;
         |SI #rem01018@#34 < nPag2;  #rem01018@#34 = nPag2;  |FINSI;
         |SI #rem01018@#34 < nPag3;  #rem01018@#34 = nPag3;  |FINSI;
         |SI #rem01018@#34 < nPag4;  #rem01018@#34 = nPag4;  |FINSI;

         #rem01018@#40 = (N\ nPagIT + nPagIC + nPagI1 + nPagI2 + nPagI3 + nPagI4);
     |FINSI;

     |GRABA 020#rem01018@.a;
     |LIBERA #rem01018@;
|FPRC;

|PROCESO GrabaCasillasB;
     enSwAcum  = 0;
     eaCasilla = "02-0027-LIQ18";  enImporte = #rem01012@#3;   |HAZ GrabaLineal;
     eaCasilla = "02-0028-LIQ18";  enImporte = #rem01012@#19;  |HAZ GrabaLineal;
     eaCasilla = "02-0029-LIQ18";  enImporte = #rem01012@#4;   |HAZ GrabaLineal;
     eaCasilla = "02-0030-LIQ18";  enImporte = #rem01012@#5;   |HAZ GrabaLineal;
     eaCasilla = "02-0031-LIQ18";  enImporte = #rem01012@#6;   |HAZ GrabaLineal;
     eaCasilla = "02-0032-LIQ18";  enImporte = #rem01012@#7;   |HAZ GrabaLineal;
     eaCasilla = "02-0033-LIQ18";  enImporte = #rem01012@#20;  |HAZ GrabaLineal;
     eaCasilla = "02-0034-LIQ18";  enImporte = #rem01012@#31;  |HAZ GrabaLineal;
     eaCasilla = "02-0035-LIQ18";  enImporte = #rem01012@#18;  |HAZ GrabaLineal;
     eaCasilla = "02-0036-LIQ18";  enImporte = #rem01012@#9;   |HAZ GrabaLineal;
     eaCasilla = "02-0037-LIQ18";  enImporte = #rem01012@#10;  |HAZ GrabaLineal;
     eaCasilla = "02-0038-LIQ18";  enImporte = #rem01012@#13;  |HAZ GrabaLineal;
     eaCasilla = "02-0039-LIQ18";  enImporte = #rem01012@#15;  |HAZ GrabaLineal;
     eaCasilla = "02-0040-LIQ18";  enImporte = #rem01012@#16;  |HAZ GrabaLineal;
     eaCasilla = "02-0041-LIQ18";  enImporte = #rem01012@#16;  |HAZ GrabaLineal;

     eaCasilla = "03-0046-LIQ18";  enImporte = #rem01012@#21;  |HAZ GrabaLineal;
     eaCasilla = "03-0047-LIQ18";  enImporte = #rem01012@#22;  |HAZ GrabaLineal;
     eaCasilla = "03-0048-LIQ18";  enImporte = #rem01012@#23;  |HAZ GrabaLineal;
     eaCasilla = "03-0050-LIQ18";  enImporte = #rem01012@#24;  |HAZ GrabaLineal;
     eaCasilla = "03-0051-LIQ18";  enImporte = #rem01012@#8;   |HAZ GrabaLineal;
     eaCasilla = "03-0052-LIQ18";  enImporte = #rem01012@#25;  |HAZ GrabaLineal;
     eaCasilla = "03-0053-LIQ18";  enImporte = #rem01012@#26;  |HAZ GrabaLineal;
     eaCasilla = "03-0054-LIQ18";  enImporte = #rem01012@#27;  |HAZ GrabaLineal;
     eaCasilla = "03-0055-LIQ18";  enImporte = #rem01012@#14;  |HAZ GrabaLineal;
     eaCasilla = "03-0056-LIQ18";  enImporte = #rem01012@#28;  |HAZ GrabaLineal;
     eaCasilla = "03-0060-LIQ18";  enImporte = #rem01012@#28;  |HAZ GrabaLineal;
|FPRC;

|PROCESO LiquidaB1;
     || datfic0 = "rem00022";

     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 101#rem01012@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01012@;
         #rem01012@#0 = #refere1@#0;
         #rem01012@#1 = #refere1@#1;
         #rem01012@#2 = #refere1@#2;
         |GRABA 020#rem01012@.b;
     |FINSI;

     #rem01012@#4  = (N\ #rem01012@#4  +  ((#datfic0@#22 % nCoefi) + enRedon));

     #rem01012@#9  = (N\ #rem01012@#3  + #rem01012@#19 + #rem01012@#4);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#5 + #rem01012@#6);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#7 + #rem01012@#20);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#31 + #rem01012@#18);

     #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#27 % nCoefi) + enRedon));

     #rem01012@#13 = (N\ #rem01012@#9  - #rem01012@#10);
     #rem01012@#16 = (N\ #rem01012@#13 - #rem01012@#15);

     #rem01012@#25 = (N\ #rem01012@#21 + #rem01012@#22 + #rem01012@#23);
     #rem01012@#25 = (N\ #rem01012@#25 + #rem01012@#24 + #rem01012@#8);

     #rem01012@#27 = (N\ #rem01012@#25 - #rem01012@#26);
     #rem01012@#28 = (N\ #rem01012@#27 - #rem01012@#14);

     |GRABA 020#rem01012@.a;
     |LIBERA #rem01012@;

     |HAZ GrabaCasillasB;

     enSwAcum  = 1;
     eaCasilla = "42-0597-LIQ18";  enImporte = #datfic0@#24 % nCoefi;  |HAZ GrabaLineal;

     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 101#rem01018@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01018@;
         #rem01018@#0 = #refere1@#0;
         #rem01018@#1 = #refere1@#1;
         #rem01018@#2 = #refere1@#2;
         |GRABA 020#rem01018@.b;
     |FINSI;

     #rem01018@#16 = (N\ #rem01012@#13);

     |GRABA 020#rem01018@.a;
     |LIBERA #rem01018@;
|FPRC;

|PROCESO LiquidaB2;
     || datfic0 = "rem00023";

     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 101#rem01012@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01012@;
         #rem01012@#0 = #refere1@#0;
         #rem01012@#1 = #refere1@#1;
         #rem01012@#2 = #refere1@#2;
         |GRABA 020#rem01012@.b;
     |FINSI;

     |SI #datfic0@#19 = "I";
         #rem01012@#3  = (N\ #rem01012@#3  + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#23 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "P";
         #rem01012@#18 = (N\ #rem01012@#18 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#23 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "B";
         #rem01012@#19 = (N\ #rem01012@#19 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#23 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "B";  |O #datfic0@#19 = "F";
         |SI #datfic0@#36 ! 0;
             enSwAcum  = 1;
             eaCasilla = "41-0591-LIQ18";
             enImporte = (#datfic0@#36 % nCoefi) - (#datfic0@#22 % nCoefi);
             |HAZ GrabaLineal;
         |FINSI;
     |FINSI;

     |SI #datfic0@#19 = "C";
         #rem01012@#6  = (N\ #rem01012@#6  + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#6  = (N\ #rem01012@#6  + ((#datfic0@#29 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#32 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "5";
         #rem01012@#20 = (N\ #rem01012@#20 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#20 = (N\ #rem01012@#20 + ((#datfic0@#29 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#32 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "O";  |O #datfic0@#19 = "F";
         #rem01012@#8  = (N\ #rem01012@#8  + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#8  = (N\ #rem01012@#8  + ((#datfic0@#29 % nCoefi) + enRedon));
         #rem01012@#26 = (N\ #rem01012@#26 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#14 = (N\ #rem01012@#14 + ((#datfic0@#26 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "1";
         #rem01012@#21 = (N\ #rem01012@#21 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#26 = (N\ #rem01012@#26 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#14 = (N\ #rem01012@#14 + ((#datfic0@#26 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "2";
         #rem01012@#22 = (N\ #rem01012@#22 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#26 = (N\ #rem01012@#26 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#14 = (N\ #rem01012@#14 + ((#datfic0@#26 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "3";
         #rem01012@#23 = (N\ #rem01012@#23 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#26 = (N\ #rem01012@#26 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#14 = (N\ #rem01012@#14 + ((#datfic0@#26 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "4";
         #rem01012@#24 = (N\ #rem01012@#24 + ((#datfic0@#20 % nCoefi) + enRedon));
         #rem01012@#26 = (N\ #rem01012@#26 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#14 = (N\ #rem01012@#14 + ((#datfic0@#26 % nCoefi) + enRedon));
     |FINSI;

     |SI #datfic0@#19 = "S";
         nValor = (#datfic0@#20 % nCoefi) + (#datfic0@#29 % nCoefi);
         #rem01012@#31  = (N\ #rem01012@#31 + nValor);

         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#23 % nCoefi) + enRedon));
         #rem01012@#10 = (N\ #rem01012@#10 + ((#datfic0@#32 % nCoefi) + enRedon));
     |FINSI;

     #rem01012@#9  = (N\ #rem01012@#3  + #rem01012@#19 + #rem01012@#4);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#5 + #rem01012@#6);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#7 + #rem01012@#20);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#31 + #rem01012@#18);

     #rem01012@#13 = (N\ #rem01012@#9  - #rem01012@#10);
     #rem01012@#16 = (N\ #rem01012@#13 - #rem01012@#15);

     #rem01012@#25 = (N\ #rem01012@#21 + #rem01012@#22 + #rem01012@#23);
     #rem01012@#25 = (N\ #rem01012@#25 + #rem01012@#24 + #rem01012@#8);

     #rem01012@#27 = (N\ #rem01012@#25 - #rem01012@#26);
     #rem01012@#28 = (N\ #rem01012@#27 - #rem01012@#14);

     #rem01012@#32 = "0";
     |SI #datfic0@#38 = "S";
         #rem01012@#32 = "1";
     |FINSI;

     |GRABA 020#rem01012@.a;
     |LIBERA #rem01012@;

     |HAZ GrabaCasillasB;

     enSwAcum  = 1;
     eaCasilla = "42-0597-LIQ18";
     enImporte = (#datfic0@#22 % nCoefi) + (#datfic0@#31 % nCoefi);
     |HAZ GrabaLineal;

     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 101#rem01018@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01018@;
         #rem01018@#0 = #refere1@#0;
         #rem01018@#1 = #refere1@#1;
         #rem01018@#2 = #refere1@#2;
         |GRABA 020#rem01018@.b;
     |FINSI;

     #rem01018@#16 = (N\ #rem01012@#13);

     |GRABA 020#rem01018@.a;
     |LIBERA #rem01018@;
|FPRC;

|PROCESO LiquidaB3;
     || datfic0 = "rem00024";

     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 101#rem01012@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01012@;
         #rem01012@#0 = #refere1@#0;
         #rem01012@#1 = #refere1@#1;
         #rem01012@#2 = #refere1@#2;
         |GRABA 020#rem01012@.b;
     |FINSI;

     #rem01012@#7  = (N\ #rem01012@#7  + ((#datfic0@#18 % nCoefi) + enRedon));

     |SI #datfic0@#13 = "S";
         #rem01012@#17  = (N\ #rem01012@#17  + ((#datfic0@#18 % nCoefi) + enRedon));
     |FINSI;

     #rem01012@#15 = (N\ #rem01012@#15 + ((#datfic0@#24 % nCoefi) + enRedon));

     #rem01012@#9  = (N\ #rem01012@#3  + #rem01012@#19 + #rem01012@#4);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#5 + #rem01012@#6);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#7 + #rem01012@#20);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#31 + #rem01012@#18);

     #rem01012@#13 = (N\ #rem01012@#9  - #rem01012@#10);
     #rem01012@#16 = (N\ #rem01012@#13 - #rem01012@#15);

     #rem01012@#25 = (N\ #rem01012@#21 + #rem01012@#22 + #rem01012@#23);
     #rem01012@#25 = (N\ #rem01012@#25 + #rem01012@#24 + #rem01012@#8);

     #rem01012@#27 = (N\ #rem01012@#25 - #rem01012@#26);
     #rem01012@#28 = (N\ #rem01012@#27 - #rem01012@#14);

     |GRABA 020#rem01012@.a;
     |LIBERA #rem01012@;

     |HAZ GrabaCasillasB;

     enSwAcum  = 1;
     eaCasilla = "42-0597-LIQ18";
     enImporte = #datfic0@#20 % nCoefi;
     |HAZ GrabaLineal;

     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 101#rem01018@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01018@;
         #rem01018@#0 = #refere1@#0;
         #rem01018@#1 = #refere1@#1;
         #rem01018@#2 = #refere1@#2;
         |GRABA 020#rem01018@.b;
     |FINSI;

     #rem01018@#16 = (N\ #rem01012@#13);

     |GRABA 020#rem01018@.a;
     |LIBERA #rem01018@;
|FPRC;

|PROCESO LiquidaB4;
     || datfic0 = "rem00051";

     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 101#rem01012@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01012@;
         #rem01012@#0 = #refere1@#0;
         #rem01012@#1 = #refere1@#1;
         #rem01012@#2 = #refere1@#2;
         |GRABA 020#rem01012@.b;
     |FINSI;

     #rem01012@#20 = (N\ #rem01012@#20  + ((#datfic0@#26 % nCoefi) + enRedon));

     #rem01012@#9  = (N\ #rem01012@#3  + #rem01012@#19 + #rem01012@#4);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#5 + #rem01012@#6);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#7 + #rem01012@#20);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#31 + #rem01012@#18);

     #rem01012@#13 = (N\ #rem01012@#9  - #rem01012@#10);
     #rem01012@#16 = (N\ #rem01012@#13 - #rem01012@#15);

     #rem01012@#25 = (N\ #rem01012@#21 + #rem01012@#22 + #rem01012@#23);
     #rem01012@#25 = (N\ #rem01012@#25 + #rem01012@#24 + #rem01012@#8);

     #rem01012@#27 = (N\ #rem01012@#25 - #rem01012@#26);
     #rem01012@#28 = (N\ #rem01012@#27 - #rem01012@#14);

     |GRABA 020#rem01012@.a;
     |LIBERA #rem01012@;

     |HAZ GrabaCasillasB;

     enSwAcum  = 1;
     eaCasilla = "42-0597-LIQ18";
     enImporte = #datfic0@#29;
     |HAZ GrabaLineal;

     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 101#rem01018@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01018@;
         #rem01018@#0 = #refere1@#0;
         #rem01018@#1 = #refere1@#1;
         #rem01018@#2 = #refere1@#2;
         |GRABA 020#rem01018@.b;
     |FINSI;

     #rem01018@#16 = (N\ #rem01012@#13);

     |GRABA 020#rem01018@.a;
     |LIBERA #rem01018@;
|FPRC;

|PROCESO LiquidaB5;
     || datfic0 = "rem00052";

     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 101#rem01012@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01012@;
         #rem01012@#0 = #refere1@#0;
         #rem01012@#1 = #refere1@#1;
         #rem01012@#2 = #refere1@#2;
         |GRABA 020#rem01012@.b;
     |FINSI;

     #rem01012@#5  = (N\ #rem01012@#5  + ((#datfic0@#24 % nCoefi) + enRedon));
     #rem01012@#5  = (N\ #rem01012@#5  - ((#datfic0@#22 % nCoefi) + enRedon));

     #rem01012@#9  = (N\ #rem01012@#3  + #rem01012@#19 + #rem01012@#4);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#5 + #rem01012@#6);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#7 + #rem01012@#20);
     #rem01012@#9  = (N\ #rem01012@#9  + #rem01012@#31 + #rem01012@#18);

     #rem01012@#13 = (N\ #rem01012@#9  - #rem01012@#10);
     #rem01012@#16 = (N\ #rem01012@#13 - #rem01012@#15);

     #rem01012@#25 = (N\ #rem01012@#21 + #rem01012@#22 + #rem01012@#23);
     #rem01012@#25 = (N\ #rem01012@#25 + #rem01012@#24 + #rem01012@#8);

     #rem01012@#27 = (N\ #rem01012@#25 - #rem01012@#26);
     #rem01012@#28 = (N\ #rem01012@#27 - #rem01012@#14);

     |GRABA 020#rem01012@.a;
     |LIBERA #rem01012@;

     |HAZ GrabaCasillasB;
|FPRC;

|PROCESO GrabaC2;
     #rem01015@#0 = #refere1@#0;
     #rem01015@#1 = #refere1@#1;
     #rem01015@#2 = #refere1@#2;
     #rem01015@#3 = 999;
     |LEE 040#rem01015@.];
     |SI FSalida = 0;
         |LEE 040#rem01015@.a;
     |SINO;
         |LEE 040#rem01015@.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem01015@#0 = #refere1@#0;
                      |Y #rem01015@#1 = #refere1@#1;
                      |Y #rem01015@#2 = #refere1@#2;
         nLinea = #rem01015@#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #rem01015@;
     #rem01015@#0  = #refere1@#0;
     #rem01015@#1  = #refere1@#1;
     #rem01015@#2  = #refere1@#2;
     #rem01015@#3  = nLinea;
     #rem01015@#4  = aContri;
     #rem01015@#5  = #datfic0@#138;
     #rem01015@#6  = #datfic0@#139 % nCoefi;
     #rem01015@#8  = #datfic0@#125;
     #rem01015@#9  = #datfic0@#14;

                        #rem01015@#7  = "1";
     |SI #datfic0@#18 = "R";   #rem01015@#7  = "2";  |FINSI;
     |SI #datfic0@#18 = "T";   #rem01015@#7  = "2";  |FINSI;

     |SI #datfic0@#145 = "N";
         #rem01015@#10 = "X";
     |FINSI;

     |GRABA 020#rem01015@.n;
     |LIBERA #rem01015@;
|FPRC;

|PROCESO MiraElC2;
     aContri   = eaContri;
     nCoefiAnt = nCoefi;

     |SI #refere1@#2 = "CONJUNTA  ";
         aContri = #datfic0@#2;

         |SI aContri = "GANANCIAL ";
             nCoefi = 50;  aContri = "TITULAR   ";  |HAZ GrabaC2;
             nCoefi = 50;  aContri = "CONYUGE   ";  |HAZ GrabaC2;

             nCoefi = nCoefiAnt;
             |ACABA;
         |FINSI;

         |SI #datfic0@#2 ! "VARIOS    ";                || SI es TITULAR O CONYUGE;
             |HAZ GrabaC2;

             nCoefi = nCoefiAnt;
             |ACABA;
         |FINSI;

         |SI #datfic0@#5  ! 0; nCoefi = #datfic0@#5;   aContri = "TITULAR   ";  |HAZ GrabaC2;  |FINSI;
         |SI #datfic0@#6  ! 0; nCoefi = #datfic0@#6;   aContri = "CONYUGE   ";  |HAZ GrabaC2;  |FINSI;
         |SI #datfic0@#7  ! 0; nCoefi = #datfic0@#7;   aContri = "1 FAMILIAR";  |HAZ GrabaC2;  |FINSI;
         |SI #datfic0@#8  ! 0; nCoefi = #datfic0@#8;   aContri = "2 FAMILIAR";  |HAZ GrabaC2;  |FINSI;
         |SI #datfic0@#9  ! 0; nCoefi = #datfic0@#9;   aContri = "3 FAMILIAR";  |HAZ GrabaC2;  |FINSI;
         |SI #datfic0@#10 ! 0; nCoefi = #datfic0@#10;  aContri = "4 FAMILIAR";  |HAZ GrabaC2;  |FINSI;
     |SINO;
         |HAZ GrabaC2;
     |FINSI;

     nCoefi = nCoefiAnt;
|FPRC;

|PROCESO GrabaD;
     #rem01013@#0 = #refere1@#0;
     #rem01013@#1 = #refere1@#1;
     #rem01013@#2 = #refere1@#2;
     #rem01013@#3 = 999;
     |LEE 040#rem01013@.];
     |SI FSalida = 0;
         |LEE 040#rem01013@.a;
     |SINO;
         |LEE 040#rem01013@.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem01013@#0 = #refere1@#0;
                      |Y #rem01013@#1 = #refere1@#1;
                      |Y #rem01013@#2 = #refere1@#2;
         nLinea = #rem01013@#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #rem01013@;
     #rem01013@#0  = #refere1@#0;
     #rem01013@#1  = #refere1@#1;
     #rem01013@#2  = #refere1@#2;
     #rem01013@#3  = nLinea;
     #rem01013@#4  = aContri;

     |SI #datfic0@#104 ! "U";
         #rem01013@#5  = nCoefi;
     |FINSI;

     |SI #datfic0@#104 = "U";
         #rem01013@#7  = nCoefi;
     |FINSI;

     #rem01013@#6  = #datfic0@#14;
     #rem01013@#9  = #datfic0@#125;
                          #rem01013@#8 = 1;
     |SI nDiasAlq ! 0;    #rem01013@#8 = 2;  |FINSI;
     |SI #datfic0@#128   = "a";  #rem01013@#8 = 2;  |FINSI;

     |GRABA 020#rem01013@.n;
     |LIBERA #rem01013@;
|FPRC;

|PROCESO MiraElD;
     aContri   = eaContri;
     nCoefiAnt = nCoefi;

     |SI #refere1@#2 = "CONJUNTA  ";
         aContri = #datfic0@#2;
         |SI aContri = "GANANCIAL ";  aContri = "COMUNES";  |FINSI;

         |SI #datfic0@#2 ! "VARIOS    ";                || SI es TITULAR O CONYUGE;
             |HAZ GrabaD;
         |SINO;
             |SI #datfic0@#5  ! 0; nCoefi = #datfic0@#5;   aContri = "TITULAR   ";  |HAZ GrabaD;  |FINSI;
             |SI #datfic0@#6  ! 0; nCoefi = #datfic0@#6;   aContri = "CONYUGE   ";  |HAZ GrabaD;  |FINSI;
             |SI #datfic0@#7  ! 0; nCoefi = #datfic0@#7;   aContri = "1 FAMILIAR";  |HAZ GrabaD;  |FINSI;
             |SI #datfic0@#8  ! 0; nCoefi = #datfic0@#8;   aContri = "2 FAMILIAR";  |HAZ GrabaD;  |FINSI;
             |SI #datfic0@#9  ! 0; nCoefi = #datfic0@#9;   aContri = "3 FAMILIAR";  |HAZ GrabaD;  |FINSI;
             |SI #datfic0@#10 ! 0; nCoefi = #datfic0@#10;  aContri = "4 FAMILIAR";  |HAZ GrabaD;  |FINSI;
         |FINSI;
     |SINO;
         |HAZ GrabaD;
     |FINSI;

     nCoefi = nCoefiAnt;
|FPRC;

|PROCESO CargaAnexo1;
     #rem01041@#55  = (N\ #rem01041@#55 + (((#datfic0@#95 % #datfic0@#134) % nCoefi) + enRedon));
     #rem01041@#56  = (N\ #rem01041@#56 + (((#datfic0@#96 % #datfic0@#134) % nCoefi) + enRedon));
     #rem01041@#57  = (N\ #rem01041@#57 + ((#datfic0@#97  % nCoefi) + enRedon));
     #rem01041@#58  = (N\ #rem01041@#58 + ((#datfic0@#98  % nCoefi) + enRedon));

     #rem01041@#59  = (N\ #rem01041@#59  + (((#datfic0@#99  % #datfic0@#134) % nCoefi) + enRedon));
     #rem01041@#60  = (N\ #rem01041@#60  + (((#datfic0@#100 % #datfic0@#134) % nCoefi) + enRedon));
     #rem01041@#61  = (N\ #rem01041@#61  + ((#datfic0@#101 % nCoefi) + enRedon));
     #rem01041@#62  = (N\ #rem01041@#62  + ((#datfic0@#102 % nCoefi) + enRedon));

     |SI #datfic0@#30 ! 0;  |O #datfic0@#33 ! 0;
         |SI #datfic0@#23 ! 0;  |O #datfic0@#126 ! 0;
             #rem01041@#63 = (N\ #rem01041@#63 + ((#datfic0@#22 % nCoefi) + enRedon));
             #rem01041@#64 = (N\ #rem01041@#64 + ((#datfic0@#23 % nCoefi) + enRedon));

             |SI #rem01041@#19 = "01.01.0000";
                 #rem01041@#19 = #datfic0@#25;

                 aAlfa   = #rem01041@#20;  |QBT aAlfa;
                 |SI aAlfa = "";
                     #rem01041@#20 = #datfic0@#116;
                 |FINSI;
             |SINO;
                 #rem01041@#20 = "";
                 #rem01041@#21 = 0;
             |FINSI;

             |SI #datfic0@#25 < #rem01041@#19;  |Y #datfic0@#25 ! "01.01.0000";
                 #rem01041@#19 = #datfic0@#25;
             |FINSI;

             |SI #datfic0@#25 < "19.01.2006";  |Y #datfic0@#25 ! "01.01.0000";
                 #rem01041@#65  = (N\ #rem01041@#65 + ((#datfic0@#95 % #datfic0@#134) % nCoefi));
                 #rem01041@#66  = (N\ #rem01041@#66 + ((#datfic0@#96 % #datfic0@#134) % nCoefi));
                 #rem01041@#67  = (N\ #rem01041@#67 + ((#datfic0@#97  % nCoefi) + enRedon));
             |FINSI;

             #rem01041@#17  = (N\ #rem01041@#17 + ((#datfic0@#126 % nCoefi) + enRedon));

             aAlfa = #rem01041@#18;  |QBT aAlfa;
             |SI aAlfa = "";   #rem01041@#18  = #datfic0@#127;   |FINSI;

             |SI #rem01041@#21 = 0;
                 |SI #rem01041@#20 ! "                    ";
                     #rem01041@#21 = #datfic0@#134;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #datfic0@#30 ! 0;  |O #datfic0@#33 ! 0;
         |SI #rem01041@#68 = "N";  |O #rem01041@#68 = " ";
             #rem01041@#68 = #datfic0@#119;
         |FINSI;

         |SI #datfic0@#2 = "GANANCIAL ";
             |SI #rem01041@#2 = "TITULAR   ";
                 |SI #rem01041@#69 = " ";  #rem01041@#69 = #datfic0@#120;  |FINSI;
                 |SI #rem01041@#69 = "1";  |Y #datfic0@#120 = "2";
                     #rem01041@#69 = #datfic0@#120;
                 |FINSI;
             |FINSI;

             |SI #rem01041@#2 = "CONYUGE   ";
                 |SI #rem01041@#69 = " ";  #rem01041@#69 = #datfic0@#121;  |FINSI;
                 |SI #rem01041@#69 = "1";  |Y #datfic0@#121 = "2";
                     #rem01041@#69 = #datfic0@#121;
                 |FINSI;
             |FINSI;

             |SI #rem01041@#2 = "CONJUNTA  ";  |O #rem01041@#2 = "CONJUNTAE ";
                 |SI #rem01041@#69 = " ";  #rem01041@#69 = #datfic0@#120;  |FINSI;
                 |SI #rem01041@#69 = "1";  |Y #datfic0@#120 = "2";
                     #rem01041@#69 = #datfic0@#120;
                 |FINSI;

                 |SI #rem01041@#69 = " ";  #rem01041@#69 = #datfic0@#121;  |FINSI;
                 |SI #rem01041@#69 = "1";  |Y #datfic0@#121 = "2";
                     #rem01041@#69 = #datfic0@#121;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI #rem01041@#69 = " ";  #rem01041@#69 = #datfic0@#120;  |FINSI;
             |SI #rem01041@#69 = "1";  |Y #datfic0@#120 = "2";
                 #rem01041@#69 = #datfic0@#120;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rew99999#7 = 9;  |Y #rem01041@#69 = " ";
         #rem01041@#69 = "1";
     |FINSI;

     |SI #rew99999#7 = 5;
         |SI #rem01041@#70 = " ";  #rem01041@#70 = "N";  |FINSI;
         |SI #datfic0@#97 ! 0;  |O #datfic0@#101 ! 0;
             #rem01041@#70 = "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO InversionD;
     |ABRE #rew99999;
     |SELECT #2#rew99999;
     #rew99999#1 = #datfic0@#2;
     |LEE 040#rew99999.=;
     |SI FSalida  ! 0;  |DDEFECTO #rew99999;  |FINSI;
     |CIERRA #rew99999;

     #rem01041@#0 = #refere1@#0;
     #rem01041@#1 = #refere1@#1;
     #rem01041@#2 = #refere1@#2;
     |LEE 101#rem01041@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01041@;
         #rem01041@#0 = #refere1@#0;
         #rem01041@#1 = #refere1@#1;
         #rem01041@#2 = #refere1@#2;
         |GRABA 020#rem01041@.b;
     |FINSI;

     |HAZ CargaAnexo1;

     |GRABA 020#rem01041@.a;
     |LIBERA #rem01041@;
|FPRC;

|PROCESO ComputaGastos;
     nGtos61  = (#datfic0@#140 % nCoefi);
     nGtosEj1 = (#datfic0@#159 % nCoefi);
     nGtosEj2 = (#datfic0@#158 % nCoefi);
     nGtosEj3 = (#datfic0@#157 % nCoefi);
     nGtosEj4 = (#datfic0@#156 % nCoefi);
     nTGtos   = nGtos61 + nGtos62;

     nValor1 = #rem01011@#13;
     |SI nValor1 ] nTGtos;
         nGtos63  = 0;
         nGtosEj1 = 0;
         nGtosEj2 = 0;
         nGtosEj3 = 0;
         nGtosEj4 = 0;

         |ACABA;
     |FINSI;

     nGtos61 = 0;
     |SI nGtosEj1 ] nValor1;
         nGtosEj1 = nGtosEj1 - nValor1;
         nGtos61  = nValor1;
         nGtos63  = nGtos62;
         nGtos62  = 0;

         |ACABA;
     |FINSI;

     nGtos61  = nGtos61 + nGtosEj1;
     nValor1  = nValor1 - nGtosEj1;
     nGtosEj1 = 0;

     |SI nGtosEj2 ] nValor1;
         nGtosEj2 = nGtosEj2 - nValor1;
         nGtos61  = nGtos61 + nValor1;
         nGtos63  = nGtos62;
         nGtos62  = 0;

         |ACABA;
     |FINSI;
     nGtos61  = nGtos61 + nGtosEj2;
     nValor1  = nValor1 - nGtosEj2;
     nGtosEj2 = 0;

     |SI nGtosEj3 ] nValor1;
         nGtosEj3 = nGtosEj3 - nValor1;
         nGtos61  = nGtos61 + nValor1;
         nGtos63  = nGtos62;
         nGtos62  = 0;

         |ACABA;
     |FINSI;
     nGtos61  = nGtos61 + nGtosEj3;
     nValor1  = nValor1 - nGtosEj3;
     nGtosEj3 = 0;

     |SI nGtosEj4 ] nValor1;
         nGtosEj4 = nGtosEj4 - nValor1;
         nGtos61  = nGtos61 + nValor1;
         nGtos63  = nGtos62;
         nGtos62  = 0;

         |ACABA;
     |FINSI;
     nGtos61  = nGtos61 + nGtosEj4;
     nValor1  = nValor1 - nGtosEj4;
     nGtosEj4 = 0;

     |SI nGtos62 ] nValor1;
         nGtos63 = nGtos62 - nValor1;
         nGtos62 = nValor1;

         |ACABA;
     |FINSI;

     nGtos63 = 0;
     nValor1 = nValor1 - nGtos62;
|FPRC;

|PROCESO GrabaNIFAlquiler;
     nLinea = nLinea + 1;

     #rem01011@#3   = nLinea;

     #rem01011@#34 = a0075;
     |SI a0076 = "N";
         #rem01011@#35 = "X";
     |FINSI;

     #rem01011@#36 = a0077;
     |SI a0078 = "N";
         #rem01011@#37 = "X";
     |FINSI;

     |PARA nCmp = 10;  |SI nCmp [ 22;  |HACIENDO nCmp = nCmp + 1;
           #rem01011@#nCmp#  = 0;
     |SIGUE;

     |PARA nCmp = 24;  |SI nCmp [ 31;  |HACIENDO nCmp = nCmp + 1;
           #rem01011@#nCmp#  = 0;
     |SIGUE;

     |GRABA 020#rem01011@.n;
     |LIBERA #rem01011@;
|FPRC;

|PROCESO rem00015;
     |SI nPas = 0;
         nArrd = nArrd + 1;

         |SI a0075 = "";
             a0075 = #rem00015#2;
             a0076 = #rem00015#4;
             |ACABA;
         |FINSI;

         |SI a0077 = "";
             a0077 = #rem00015#2;
             a0078 = #rem00015#4;
         |FINSI;

         |ACABA;
     |FINSI;

     nCon = nCon + 1;
     |SI nCon [ 2;  |ACABA;  |FINSI;

     |SI a0075 = "";
         a0075 = #rem00015#2;
         a0076 = #rem00015#4;
         |ACABA;
     |FINSI;

     |SI a0077 = "";
         a0077 = #rem00015#2;
         a0078 = #rem00015#4;
     |FINSI;

     |HAZ GrabaNIFAlquiler;

     a0075 = "";
     a0076 = "";
     a0077 = "";
     a0078 = "";
|FPRC;

|DEFBUCLE rem00015;
     #rem00015#1;
     ;
     nEmp, nLin, "";
     nEmp, nLin, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, rem00015;
|FIN;

|PROCESO MasArrend;
     a0075 = "";
     a0076 = "";
     a0077 = "";
     a0078 = "";
     nCon  = 0;
     nPas  = 1;

     |BUCLE rem00015;

     |SI a0075 ! "";
         |HAZ GrabaNIFAlquiler;
     |FINSI;
|FPRC;

|PROCESO GrabaElC;
     |SI #datfic0@#104 = "N";  |ACABA;  |FINSI;

     |SI #datfic0@#18 = "S";  |O #datfic0@#18 = "T";
         |ACABA;
     |FINSI;

     aContri   = eaContri;

     |SI #refere1@#2 = "CONJUNTA  ";
         aContri = #datfic0@#2;

         |SI aContri = "GANANCIAL ";
             aContri = "COMUNES";
         |FINSI;

         |SI aContri = "VARIOS    ";
             nSuma   = #datfic0@#5 + #datfic0@#6 + #datfic0@#7 + #datfic0@#8 + #datfic0@#9 + #datfic0@#10;

             aContri = "COMUNES";

             |SI #datfic0@#5  = nSuma;  aContri = "TITULAR";     |FINSI;
             |SI #datfic0@#6  = nSuma;  aContri = "CONYUGE";     |FINSI;
             |SI #datfic0@#7  = nSuma;  aContri = "1 FAMILIAR";  |FINSI;
             |SI #datfic0@#8  = nSuma;  aContri = "2 FAMILIAR";  |FINSI;
             |SI #datfic0@#9  = nSuma;  aContri = "3 FAMILIAR";  |FINSI;
             |SI #datfic0@#10 = nSuma;  aContri = "4 FAMILIAR";  |FINSI;
         |FINSI;
     |FINSI;

     #rem01011@#0 = #refere1@#0;
     #rem01011@#1 = #refere1@#1;
     #rem01011@#2 = #refere1@#2;
     #rem01011@#3 = 999;
     |LEE 040#rem01011@.];
     |SI FSalida = 0;
         |LEE 040#rem01011@.a;
     |SINO;
         |LEE 040#rem01011@.u;
     |FINSI;

     |SI FSalida = 0; |Y #rem01011@#0 = #refere1@#0;
                      |Y #rem01011@#1 = #refere1@#1;
                      |Y #rem01011@#2 = #refere1@#2;
         nLinea   = #rem01011@#3  + 1;
         nLinea61 = #rem01011@#38 + 1;
     |SINO;
         nLinea   = 1;
         nLinea61 = 1;
     |FINSI;

     |DDEFECTO #rem01011@;
     #rem01011@#0  = #refere1@#0;
     #rem01011@#1  = #refere1@#1;
     #rem01011@#2  = #refere1@#2;
     #rem01011@#3  = nLinea;
     #rem01011@#38 = nLinea61;    || Casilla 0061 pueden haber inmuebles
     #rem01011@#4  = aContri;    || si hay mas de dos arrendadores

     |SI #datfic0@#104 ! "U";
         #rem01011@#5  = nCoefi;
     |FINSI;

     |SI #datfic0@#104 = "U";
         #rem01011@#23  = nCoefi;
     |FINSI;

                               #rem01011@#6  = "1";
     |SI #datfic0@#18 = "R";   #rem01011@#6  = "2";  |FINSI;
     |SI #datfic0@#18 = "T";   #rem01011@#6  = "2";  |FINSI;

     nImputa     = 0;
     nDiasAlq    = #datfic0@#31;
     |SI eaMuerto ! "";
         nDiasAlq = #datfic0@#31 + #datfic0@#34;
     |FINSI;

     nDiasUso = #datfic0@#32;
     |SI eaMuerto ! "";
         nDiasUso = #datfic0@#32 + #datfic0@#35;
     |FINSI;

     nTotalDias =  #datfic0@#30 + #datfic0@#31 + #datfic0@#32 + #datfic0@#33 + #datfic0@#34 + #datfic0@#35;

     |SI #refere1@#2 = "CONJUNTA  ";  |Y eaMuerto ! "";
         nDiasAlq = #datfic0@#31 + #datfic0@#34;
         nDiasUso = #datfic0@#32 + #datfic0@#35;
     |FINSI;

     |SI #refere1@#2 = "TITULAR   ";  |Y eaMuerto = "T";
         nDiasAlq   = #datfic0@#31;
         nDiasUso   = #datfic0@#32;
         nTotalDias = #datfic0@#30 + #datfic0@#31 + #datfic0@#32;
     |FINSI;

     |SI #refere1@#2 = "CONYUGE   ";  |Y eaMuerto = "C";
         nDiasAlq   = #datfic0@#31;
         nDiasUso   = #datfic0@#32;
         nTotalDias = #datfic0@#30 + #datfic0@#31 + #datfic0@#32;
     |FINSI;

     aTipoUso = #datfic0@#141;   |QBF aTipoUso;

     |SI nDiasUso ! 0;  |O nDiasAlq ! 0;
         |SI #datfic0@#104 ! "N";
             |SI #datfic0@#15 ! 0;
                 |SI #datfic0@#17 = "S";
                     nImputa = (((#datfic0@#15 % 1.1) * (nDiasUso / 365)) % #datfic0@#136) % nCoefi;
                 |SINO;
                     nImputa = (((#datfic0@#15 % 2) * (nDiasUso / 365)) % #datfic0@#136) % nCoefi;
                 |FINSI;
             |SINO;
                 nValor     = #datfic0@#26;
                 |SI nValor < #datfic0@#27;  nValor = #datfic0@#27;  |FINSI;

                 nImputa = ((((nValor % 50) % 1.1) * (nDiasUso / 365)) % #datfic0@#136) % nCoefi;
             |FINSI;

             |SI nDiasAlq = nTotalDias;
                 nImputa   = 0;
             |FINSI;

             |SI #datfic0@#128 = "A";  |O #datfic0@#128 = "a";
                 |SI nDiasUso = nTotalDias;
                     nImputa   = 0;
                 |FINSI;
             |FINSI;

             |SI nDiasUso ! 0;  |Y nDiasAlq ! 0;
                 |SI #datfic0@#128 = "A";  |O #datfic0@#128 = "a";
                     nImputa   = 0;
                 |FINSI;
             |FINSI;

             |SI nDiasAlq = nTotalDias;  |Y aTipoUso = "";
                 aTipoUso  = "1";
             |FINSI;

             |SI #datfic0@#128 = "A";  |O #datfic0@#128 = "a";
                 |SI nDiasAlq ! 0;  |Y nDiasUso ! 0;  |Y aTipoUso = "";
                     aTipoUso  = "1";
                 |FINSI;
             |FINSI;

             |SI nDiasAlq ! 0;  |Y nDiasUso ! 0;  |Y #datfic0@#128 = "D";  |Y aTipoUso = "";
                 aTipoUso  = "3";
             |FINSI;

             |SI nDiasAlq ! 0;  |Y nDiasUso ! 0;  |Y #datfic0@#128 = "P";  |Y aTipoUso = "";
                 aTipoUso  = "3";
             |FINSI;

             |SI nDiasUso ! 0;  |Y nDiasAlq = 0;  |Y #datfic0@#128 = "D";  |Y aTipoUso = "";
                 aTipoUso  = "2";
             |FINSI;

             |SI nDiasUso ! 0;  |Y nDiasAlq = 0;  |Y #datfic0@#128 = "P";  |Y aTipoUso = "";
                 aTipoUso  = "2";
             |FINSI;

             |SI aTipoUso = "";  |Y nDiasAlq ! 0;
                 aTipoUso  = "1";
             |FINSI;

             nDiasUso = #datfic0@#32;
             |SI eaMuerto ! "";
                 nDiasUso = #datfic0@#32 + #datfic0@#35;
             |FINSI;

             |SI #refere1@#2 = "CONJUNTA  ";  |Y eaMuerto ! "";
                 nDiasUso = #datfic0@#32 + #datfic0@#35;
             |FINSI;

             |SI #refere1@#2 = "TITULAR   ";  |Y eaMuerto = "T";
                 nDiasUso = #datfic0@#32;
             |FINSI;

             |SI #refere1@#2 = "CONYUGE   ";  |Y eaMuerto = "C";
                 nDiasUso = #datfic0@#32;
             |FINSI;

             #rem01011@#10 = (N\ #datfic0@#136);
             #rem01011@#11 = 0;
             |SI nImputa ! 0;
                 #rem01011@#11 = (N\ nDiasUso);
             |FINSI;
             #rem01011@#12 = (N\ nImputa);
         |FINSI;
     |FINSI;

     nIngresos1  = 0;
     nIngresos2  = 0;
     nIrregular  = 0;
     nCatastral  = 0;
     nTGtos      = 0;
     nGtos61     = 0;
     nGtos62     = 0;
     nGtos64     = 0;
     nGtos65     = 0;
     nGtos66     = 0;
     nGtos67     = 0;
     nGtos68     = 0;
     nGtos69     = 0;

     |SI nDiasAlq ! 0;
         |SI #datfic0@#37 = "A";
             nIngresos1 = (nIngresos1  + (#datfic0@#38 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nIngresos1 = (nIngresos1  + (#datfic0@#38 % nCoefi));
         |FINSI;

         |SI #datfic0@#39 = "A";
             nIngresos2 = (nIngresos2  + (#datfic0@#40 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nIngresos2 = (nIngresos2  + (#datfic0@#40 % nCoefi));
         |FINSI;

         |SI #datfic0@#41 = "A";
             nIngresos2 = (nIngresos2  + (#datfic0@#42 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nIngresos2 = (nIngresos2  + (#datfic0@#42 % nCoefi));
         |FINSI;

         |SI #datfic0@#43 = "A";
             nIngresos1 = (nIngresos1 + (#datfic0@#44 * (nDiasAlq / 365) % nCoefi));
             nIrregular = ((#datfic0@#44 * 0.3) * (nDiasAlq / 365) % nCoefi);
         |SINO;
             nIngresos1 = (nIngresos1 + (#datfic0@#44 % nCoefi));
             nIrregular = (#datfic0@#44 * 0.3) % nCoefi;
         |FINSI;

         |SI #datfic0@#48 = "A";
             nGtos62  = (nGtos62 + (#datfic0@#22 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos62  = (nGtos62 + (#datfic0@#22 % nCoefi));
         |FINSI;

         |SI #datfic0@#130 = "A";
             nGtos62  = (nGtos62 + (#datfic0@#131 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos62  = (nGtos62 + (#datfic0@#131 % nCoefi));
         |FINSI;

         |SI nDiasAlq ! 0;
             |SI #datfic0@#49 = "A";
                 nGtos64  = (nGtos64 + (#datfic0@#21 * (nDiasAlq / 365) % nCoefi));
             |SINO;
                 nGtos64  = (nGtos64 + (#datfic0@#21 % nCoefi));
             |FINSI;
         |FINSI;

         |SI #datfic0@#50 = "A";
             nGtos64  = (nGtos64  + (#datfic0@#51 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos64  = (nGtos64  + (#datfic0@#51 % nCoefi));
         |FINSI;

         |SI #datfic0@#132 = "A";
             nGtos65  = (nGtos65 + (#datfic0@#133 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos65  = (nGtos65 + (#datfic0@#133 % nCoefi));
         |FINSI;

         |SI #datfic0@#54 = "A";
             nGtos66 = (nGtos66 + (#datfic0@#55 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos66 = (nGtos66 + (#datfic0@#55 % nCoefi));
         |FINSI;

         |SI #datfic0@#59 = "A";
             nGtos67 = (nGtos67 + (#datfic0@#115 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos67 = (nGtos67 + (#datfic0@#115 % nCoefi));
         |FINSI;

         nGtos68 = (nGtos68 + (#datfic0@#114 % nCoefi));

         |SI #datfic0@#52 = "A";
             nGtos69 = (nGtos69 + (#datfic0@#53 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos69 = (nGtos69 + (#datfic0@#53 % nCoefi));
         |FINSI;

         |SI #datfic0@#56 = "A";
             nGtos69 = (nGtos69 + (#datfic0@#57 * (nDiasAlq / 365) % nCoefi));
         |SINO;
             nGtos69 = (nGtos69 + (#datfic0@#57 % nCoefi));
         |FINSI;

         |SI #datfic0@#36 = "S";
             nTGtos = nGtos64 + nGtos65 + nGtos66 + nGtos67 + nGtos68 + nGtos69;
             nValor   = nIngresos1 - (nGtos62 + nTGtos);

             nPorce = 2;
             |SI #datfic0@#17 = "S";  nPorce = 1.1;  |FINSI;

             |SI #datfic0@#15 > 0;
                 nCatastral = ((#datfic0@#15 % nPorce) * (nDiasAlq / 365)) % nCoefi;
             |SINO;
                 nCatastral = #datfic0@#27;
                 |SI nCatastral < #datfic0@#26;  nCatastral = #datfic0@#26;  |FINSI;
                 nCatastral = (((nCatastral % 50) % 1.1) * (nDiasAlq / 365)) % nCoefi;
             |FINSI;
         |FINSI;

         #rem01011@#13 = (N\ nIngresos1 + nIngresos2);

         |HAZ ComputaGastos;

         #rem01011@#14 = (N\ nGtos62);
         #rem01011@#15 = (N\ nGtos63);
         #rem01011@#22 = (N\ nGtos61);
         #rem01011@#24 = (N\ nGtos64);
         #rem01011@#25 = (N\ nGtos65);
         #rem01011@#26 = (N\ nGtos66);
         #rem01011@#27 = (N\ nGtos67);
         #rem01011@#28 = (N\ nGtos68);
         #rem01011@#16 = (N\ nGtos69);
         #rem01011@#29 = (N\ nGtosEj2);
         #rem01011@#30 = (N\ nGtosEj3);
         #rem01011@#31 = (N\ nGtosEj4);

         #rem01011@#17 = (N\ #rem01011@#13 - #rem01011@#22 - #rem01011@#14);
         #rem01011@#17 = (N\ #rem01011@#17 - #rem01011@#24 - #rem01011@#25);
         #rem01011@#17 = (N\ #rem01011@#17 - #rem01011@#26 - #rem01011@#27);
         #rem01011@#17 = (N\ #rem01011@#17 - #rem01011@#28 - #rem01011@#16);

         #rem01011@#18 = 0;
         |SI #rem01011@#17 > 0;
             |SI #datfic0@#18 = "U";
                 #rem01011@#18 = (N\ #rem01011@#17 % 60);
             |FINSI;
         |FINSI;

         |SI nIrregular ! 0;
              #rem01011@#19  = (N\ (#rem01011@#17 - #rem01011@#18) % 30);
              |SI #rem01011@#19 > 90000;  #rem01011@#19 = 90000;  |FINSI;
         |FINSI;

         |SI #datfic0@#36 = "S";
             #rem01011@#20  = (N\ nCatastral);
         |FINSI;

         #rem01011@#21 = #rem01011@#17 - #rem01011@#18 - #rem01011@#19;
         |SI #rem01011@#20 ! 0;
             nValor1 = #rem01011@#17 - #rem01011@#18 - #rem01011@#19;
             nValor2 = #rem01011@#20;
             #rem01011@#21   = nValor1;
             |SI nValor2 > nValor1;
                 #rem01011@#21   = nValor2;
             |FINSI;
         |FINSI;
     |FINSI;

     #rem01011@#7  = aTipoUso;
     #rem01011@#8  = #datfic0@#125;
     #rem01011@#9  = #datfic0@#14;
     #rem01011@#32 = #datfic0@#160;
     #rem01011@#33 = #datfic0@#13;

     |SI  #rem01011@#12 = 0;  |Y  #rem01011@#13 = 0;  |Y  #rem01011@#22 = 0;  |Y  #rem01011@#14 = 0;
      |Y  #rem01011@#15 = 0;  |Y  #rem01011@#16 = 0;  |Y  #rem01011@#17 = 0;  |Y  #rem01011@#18 = 0;
      |Y  #rem01011@#19 = 0;  |Y  #rem01011@#20 = 0;  |Y  #rem01011@#21 = 0;
      |Y  #datfic0@#141 ! "6";  |Y  #datfic0@#141 ! "4";
          |ACABA;
     |FINSI;

     nArrd   = 0;
     nPag    = 1;
     nPas    = 0;
     a0075   = "";
     a0076   = "";
     a0077   = "";
     a0078   = "";
     nEmp    = #datfic0@#0;
     nLin    = #datfic0@#1;
     |BUCLE rem00015;

     #rem01011@#34 = a0075;
     |SI a0076 = "N";
         #rem01011@#35 = "X";
     |FINSI;

     #rem01011@#36 = a0077;
     |SI a0078 = "N";
         #rem01011@#37 = "X";
     |FINSI;

     |GRABA 020#rem01011@.n;
     |LIBERA #rem01011@;

     #rem01018@#17 = (N\ #rem01018@#17 + #rem01011@#13);
     #rem01018@#19 = (N\ #rem01018@#19 + #rem01011@#17);
     #rem01018@#28 = (N\ #rem01018@#28 + #rem01011@#20);

     nValor1   = #rem01011@#17;
     nValor2   = #rem01011@#20;
     |SI nValor1 ] nValor2;
         #rem01018@#14 = (N\ #rem01018@#14 + nValor1);
     |SINO;
         #rem01018@#14 = (N\ #rem01018@#14 + nValor2);
     |FINSI;

     enSwAcum  = 1;

     eaCasilla = "04-0094-LIQ18";  enImporte = #rem01011@#12;  |HAZ GrabaLineal;
     eaCasilla = "04-0095-LIQ18";  enImporte = #rem01011@#21;  |HAZ GrabaLineal;

     |SI #datfic0@#159 ! 0; nExc = #datfic0@#159;  aCas = "1213-LIQ18";  |HAZ GrabaExcesos_1;  |FINSI;
     |SI #datfic0@#158 ! 0; nExc = #datfic0@#158;  aCas = "1215-LIQ18";  |HAZ GrabaExcesos_1;  |FINSI;
     |SI #datfic0@#157 ! 0; nExc = #datfic0@#157;  aCas = "1218-LIQ18";  |HAZ GrabaExcesos_1;  |FINSI;
     |SI #datfic0@#156 ! 0; nExc = #datfic0@#156;  aCas = "1221-LIQ18";  |HAZ GrabaExcesos_1;  |FINSI;

     |SI nArrd > 2;
||         |HAZ MasArrend;
     |FINSI;
|FPRC;

|PROCESO GrabaAnexoC2_c1;
     #rem01052@#0  = #refere1@#0;
     #rem01052@#1  = #refere1@#1;
     #rem01052@#2  = #refere1@#2;
     #rem01052@#3  = aTit;
     |LEE 101#rem01052@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01052@;
         #rem01052@#0  = #refere1@#0;
         #rem01052@#1  = #refere1@#1;
         #rem01052@#2  = #refere1@#2;
         #rem01052@#3  = aTit;
         |GRABA 020#rem01052@.b;
     |FINSI;

     #rem01052@#6  = (N\ #rem01052@#6 + ((#datfic0@#109 % nPorc) + enRedon));
     #rem01052@#7  = (N\ #rem01052@#7 + ((#datfic0@#110 % nPorc) + enRedon));
     #rem01052@#8  = (N\ #rem01052@#8 + ((#datfic0@#152  % nPorc) + enRedon));

     |SI #datfic0@#109 ! 0;  |O #datfic0@#110 ! 0;
         nValor = #datfic0@#71 % nPorc;
         nValor = nValor - (#datfic0@#67 % nPorc);
         nValor = nValor - (#datfic0@#73  % nPorc);

         #rem01052@#5 = (N\ #rem01052@#5 + nValor);
         #rem01052@#4 = (N\ #rem01052@#4 + (((#datfic0@#69 - #datfic0@#111) + enRedon) % nPorc));
     |FINSI;

     |GRABA 020#rem01052@.a;
     |LIBERA #rem01052@;
|FPRC;

|PROCESO AnexoC2_c1;
     |SI #datfic0@#109 = 0;  |Y #datfic0@#110 = 0;
         |ACABA;
     |FINSI;

     aTit  = eaContri;
     nPorc = nCoefi;

     |SI #refere1@#2 = "CONJUNTA  ";
         aTit = #datfic0@#2;

         |SI aTit = "VARIOS    ";
             |SI nCoefi1 ! 0; nPorc = nCoefi1;  aTit = "TITULAR   "; |HAZ GrabaAnexoC2_c1;  |FINSI;
             |SI nCoefi2 ! 0; nPorc = nCoefi2;  aTit = "CONYUGE   "; |HAZ GrabaAnexoC2_c1;  |FINSI;
             |SI nCoefi3 ! 0; nPorc = nCoefi3;  aTit = "1 FAMILIAR"; |HAZ GrabaAnexoC2_c1;  |FINSI;
             |SI nCoefi4 ! 0; nPorc = nCoefi4;  aTit = "2 FAMILIAR"; |HAZ GrabaAnexoC2_c1;  |FINSI;
             |SI nCoefi5 ! 0; nPorc = nCoefi5;  aTit = "3 FAMILIAR"; |HAZ GrabaAnexoC2_c1;  |FINSI;
             |SI nCoefi6 ! 0; nPorc = nCoefi6;  aTit = "4 FAMILIAR"; |HAZ GrabaAnexoC2_c1;  |FINSI;

             |ACABA;
         |FINSI;

         |SI aTit = "GANANCIAL ";
             nPorc = 50;
             aTit  = "TITULAR   "; |HAZ GrabaAnexoC2_c1;
             aTit  = "CONYUGE   "; |HAZ GrabaAnexoC2_c1;

             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ GrabaAnexoC2_c1;
|FPRC;

|PROCESO LiquidaC1;
     || datfic0 = "rem00021";

     nDiasAlq    = #datfic0@#31;
     |SI eaMuerto ! "";
         nDiasAlq = #datfic0@#31 + #datfic0@#34 + #datfic0@#34;
     |FINSI;

     nDiasUso = #datfic0@#32;
     |SI eaMuerto ! "";
         nDiasUso = #datfic0@#32 + #datfic0@#35 + #datfic0@#35;
     |FINSI;

     |SI #refere1@#2 = "CONJUNTA  ";  |Y eaMuerto ! "";
         nDiasAlq = #datfic0@#31 + #datfic0@#34;
     |FINSI;

     |SI #refere1@#2 = "TITULAR   ";  |Y eaMuerto = "T";
         nDiasAlq = #datfic0@#31;
     |FINSI;

     |SI #refere1@#2 = "CONYUGE   ";  |Y eaMuerto = "C";
         nDiasAlq = #datfic0@#31;
     |FINSI;

     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 101#rem01018@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01018@;
         #rem01018@#0 = #refere1@#0;
         #rem01018@#1 = #refere1@#1;
         #rem01018@#2 = #refere1@#2;
         |GRABA 020#rem01018@.b;
     |FINSI;

     |SI #datfic0@#137 = "S";
         |HAZ MiraElC2;
     |FINSI;

     |SI #datfic0@#128 = "P";
         |HAZ MiraElD;
     |FINSI;

     |SI #datfic0@#128 = "A";  |O #datfic0@#128 = "a";
         |HAZ MiraElD;

         |SI nDiasAlq ! 0;  |HAZ GrabaElC;  |FINSI;
     |SINO;
         |SI #datfic0@#30 ! 0;  |O #datfic0@#33 ! 0;
             |SI #datfic0@#25 < "04.05.1998";  |Y #datfic0@#25 ! "01.01.0000"; |Y #datfic0@#23 ! 0;
                 #rem01018@#24 = (N\ #rem01018@#24 + ((#datfic0@#21 % nCoefi) + enRedon));
                 |SI #datfic0@#17 = "S";
                     #rem01018@#25 = (N\ #rem01018@#25 + (((#datfic0@#15 % nCoefi) + enRedon) % 1.1));
                 |SINO;
                     #rem01018@#25 = (N\ #rem01018@#25 + (((#datfic0@#15 % nCoefi) + enRedon) % 2));
                 |FINSI;
                 #rem01018@#23 = #datfic0@#25;
             |FINSI;

             |SI nDiasAlq ! 0; |O nDiasUso ! 0;
                 |HAZ GrabaElC;
             |FINSI;

            |SI #datfic0@#141 = "4";  |HAZ GrabaElC;  |FINSI;
            |SI #datfic0@#141 = "6";  |HAZ GrabaElC;  |FINSI;
         |SINO;
             |HAZ GrabaElC;
         |FINSI;
     |FINSI;

     |GRABA 020#rem01018@.a;
     |LIBERA #rem01018@;

     |SI nDiasAlq ! 0;
         enSwAcum  = 1;
         eaCasilla = "42-0598-LIQ18";

         |SI #datfic0@#46 = "A";
             enImporte = (#datfic0@#47 * (nDiasAlq / 365)) % nCoefi;
         |SINO;
             enImporte = #datfic0@#47 % nCoefi;
         |FINSI;

         |HAZ GrabaLineal;
     |FINSI;

     |HAZ InversionD;

     |SI #datfic0@#24 = "S";
         |SI #datfic0@#30 ! 0;  |O #datfic0@#33 ! 0;
             |HAZ AnexoC2_c1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Liquida1;
     |HAZ CreaLiquida;               || En el rezcalut

     |SI nSwFich = 1;  |HAZ LiquidaA1;  |FINSI;
     |SI nSwFich = 3;  |HAZ LiquidaB1;  |FINSI;
     |SI nSwFich = 4;  |HAZ LiquidaB2;  |FINSI;
     |SI nSwFich = 5;  |HAZ LiquidaB3;  |FINSI;
     |SI nSwFich = 6;  |HAZ LiquidaB4;  |FINSI;
     |SI nSwFich = 7;  |HAZ LiquidaB5;  |FINSI;
     |SI nSwFich = 2;  |HAZ LiquidaC1;  |FINSI;
|FPRC;

|PROCESO Seleccion1;
     |SI #datfic0@#2 = "GANANCIAL ";                || Si es Ganancial
         nCoefi = 50;  eaContri = "TITULAR   ";   |HAZ Liquida1;
         nCoefi = 50;  eaContri = "CONYUGE   ";   |HAZ Liquida1;

         nCoefi1 = 50;
         nCoefi2 = 50;
         nCoefi3 = 0;
         nCoefi4 = 0;
         nCoefi5 = 0;
         nCoefi6 = 0;
         nCoefi = 100; eaContri = "CONJUNTA  ";   |HAZ Liquida1;

         |SI eaMuerto ! "";
             |SI eaMuerto = "T";  nCoefi1 = 0;  |FINSI;
             |SI eaMuerto = "C";  nCoefi2 = 0;  |FINSI;

             nCoefi = 50;  eaContri = "CONJUNTAE ";   |HAZ Liquida1;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #datfic0@#2 ! "VARIOS    ";                || SI es TITULAR O CONYUGE;
         nCoefi = 100;  eaContri = #datfic0@#2;   |HAZ Liquida1;
         nCoefi = 100;  eaContri = "CONJUNTA  ";  |HAZ Liquida1;

         |SI eaMuerto = "T";  |Y #datfic0@#2 ! "TITULAR   ";
             nCoefi = 100;  eaContri = "CONJUNTAE ";   |HAZ Liquida1;
         |FINSI;

         |SI eaMuerto = "C";  |Y #datfic0@#2 ! "CONYUGE   ";
             nCoefi = 100;  eaContri = "CONJUNTAE ";   |HAZ Liquida1;
         |FINSI;

         |ACABA;
     |FINSI;
                                             || SI es Varios

     |SI #datfic0@#5  ! 0; nCoefi = #datfic0@#5;   eaContri = "TITULAR   ";  |HAZ Liquida1;  |FINSI;
     |SI #datfic0@#6  ! 0; nCoefi = #datfic0@#6;   eaContri = "CONYUGE   ";  |HAZ Liquida1;  |FINSI;
     |SI #datfic0@#7  ! 0; nCoefi = #datfic0@#7;   eaContri = "1 FAMILIAR";  |HAZ Liquida1;  |FINSI;
     |SI #datfic0@#8  ! 0; nCoefi = #datfic0@#8;   eaContri = "2 FAMILIAR";  |HAZ Liquida1;  |FINSI;
     |SI #datfic0@#9  ! 0; nCoefi = #datfic0@#9;   eaContri = "3 FAMILIAR";  |HAZ Liquida1;  |FINSI;
     |SI #datfic0@#10 ! 0; nCoefi = #datfic0@#10;  eaContri = "4 FAMILIAR";  |HAZ Liquida1;  |FINSI;

     nCoefi1  = #datfic0@#5;
     nCoefi2  = #datfic0@#6;
     nCoefi3  = #datfic0@#7;
     nCoefi4  = #datfic0@#8;
     nCoefi5  = #datfic0@#9;
     nCoefi6  = #datfic0@#10;

     nCoefi   = #datfic0@#5 + #datfic0@#6 + #datfic0@#7 + #datfic0@#8 + #datfic0@#9 + #datfic0@#10;
     eaContri = "CONJUNTA  "; |HAZ Liquida1;

     |SI eaMuerto = "T";
         nCoefi1  = 0;
         nCoefi2  = #datfic0@#6;
         nCoefi3  = #datfic0@#7;
         nCoefi4  = #datfic0@#8;
         nCoefi5  = #datfic0@#9;
         nCoefi6  = #datfic0@#10;

         nCoefi  = #datfic0@#6 + #datfic0@#7 + #datfic0@#8 + #datfic0@#9 + #datfic0@#10;
         eaContri = "CONJUNTAE "; |HAZ Liquida1;
     |FINSI;

     |SI eaMuerto = "C";
         nCoefi1  = #datfic0@#5;
         nCoefi2  = 0;
         nCoefi3  = #datfic0@#7;
         nCoefi4  = #datfic0@#8;
         nCoefi5  = #datfic0@#9;
         nCoefi6  = #datfic0@#10;

         nCoefi  = #datfic0@#5 + #datfic0@#7 + #datfic0@#8 + #datfic0@#9 + #datfic0@#10;
         eaContri = "CONJUNTAE "; |HAZ Liquida1;
     |FINSI;
|FPRC;

|PROCESO PuntoA1;
     nPagT            = 0;
     nPagC            = 0;
     nPag1            = 0;
     nPag2            = 0;
     nPag3            = 0;
     nPag4            = 0;
     nPagIT           = 0;
     nPagIC           = 0;
     nPagI1           = 0;
     nPagI2           = 0;
     nPagI3           = 0;
     nPagI4           = 0;

     nSwFich = 1;
     aDef    = eaPathDef + "rem00020.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, rem01010@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01010@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     nCampo16 = 0;

     |ABRE #rem01018@;
     |ABRE #rem01010@;
     |ABRE #datfic0@;
     |DDEFECTO #datfic0@;
     |SELECT #3#datfic0@;
     #datfic0@#0  = enEmpresa;
     #datfic0@#2  = "";
     #datfic0@#24 = 9999999999;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00020";
                enLinea    = #datfic0@#1;
                eaObserva  = "(A) RENDIMIENTOS DEL TRABAJO";
                |HAZ Graba1003;
            |FINSI;

            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #rem01018@;
     |CIERRA #rem01010@;
     |CIERRA #datfic0@;

     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01010@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoB1;
     nSwFich = 3;
     aDef    = eaPathDef + "rem00022.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     |ABRE #datfic0@;
     |ABRE #rem01012@;
     |ABRE #rem01018@;
     |DDEFECTO #datfic0@;
     #datfic0@#0 = enEmpresa;
     #datfic0@#1 = 1;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00022";
                enLinea    = #datfic0@#1;
                eaObserva  = "(B1) PARTICIPACIONES EN FONDOS PROPIOS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #datfic0@;
     |CIERRA #rem01012@;
     |CIERRA #rem01018@;

     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoB2;
     nSwFich = 4;
     aDef    = eaPathDef + "rem00023.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     |ABRE #datfic0@;
     |ABRE #rem01012@;
     |ABRE #rem01018@;
     |DDEFECTO #datfic0@;
     #datfic0@#0 = enEmpresa;
     #datfic0@#1 = 1;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00023";
                enLinea    = #datfic0@#1;
                eaObserva  = "(B2) CESION A TERCEROS Y OTROS RENDIMIENTOS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #datfic0@;
     |CIERRA #rem01012@;
     |CIERRA #rem01018@;

     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoB3;
     nSwFich = 5;
     aDef    = eaPathDef + "rem00024.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     |ABRE #datfic0@;
     |ABRE #rem01012@;
     |ABRE #rem01018@;
     |DDEFECTO #datfic0@;
     #datfic0@#0 = enEmpresa;
     #datfic0@#1 = 1;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00024";
                enLinea    = #datfic0@#1;
                eaObserva  = "(B3) CONTRATO DE SEGUROS, CAPITAL DIFERIDO";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #datfic0@;
     |CIERRA #rem01012@;
     |CIERRA #rem01018@;

     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoB4;
     nSwFich = 6;
     aDef    = eaPathDef + "rem00051.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     |ABRE #datfic0@;
     |ABRE #rem01012@;
     |ABRE #rem01018@;
     |DDEFECTO #datfic0@;
     #datfic0@#0 = enEmpresa;
     #datfic0@#1 = 1;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00051";
                enLinea    = #datfic0@#1;
                eaObserva  = "(B4) RENTAS TEMPORALES Y VITALICIAS";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #datfic0@;
     |CIERRA #rem01012@;
     |CIERRA #rem01018@;

     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoB5;
     nSwFich = 7;
     aDef    = eaPathDef + "rem00052.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     |ABRE #datfic0@;
     |ABRE #rem01012@;
     |DDEFECTO #datfic0@;
     #datfic0@#0 = enEmpresa;
     #datfic0@#1 = 1;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00052";
                enLinea    = #datfic0@#1;
                eaObserva  = "(B5) DEUDA PUBLICA";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #datfic0@;
     |CIERRA #rem01012@;

     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO PuntoC1;
     nSwFich = 2;
     aDef    = eaPathDef + "rem00021.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, rem01011@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01011@#"zdat1011"#;  |FINSI;

     aDef    = eaPathDef + "rem01013.mas";
     |CARGA_DEF aDef, rem01013@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01013@#"zdat1013"#;  |FINSI;

     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, rem01041@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01041@#"zdat1041"#;  |FINSI;

     aDef    = eaPathDef + "rem01052.mas";
     |CARGA_DEF aDef, rem01052@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01052@#"zdat1052"#;  |FINSI;

     nCoefiAnt = nCoefi;
     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01015.mas";
     |CARGA_DEF aDef, rem01015@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01015@#"zdat1015"#;  |FINSI;

     aDef    = eaPathDef + "rem01055.mas";
     |CARGA_DEF aDef, rem01055@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01055@#"zdat1055"#;  |FINSI;

     |ABRE #datfic0@;
     |ABRE #rem01011@;
     |ABRE #rem01013@;
     |ABRE #rem01041@;
     |ABRE #rem01018@;
     |ABRE #rem01015@;
     |ABRE #rem01052@;
     |ABRE #rem01055@;
     |DDEFECTO #datfic0@;
     #datfic0@#0 = enEmpresa;
     #datfic0@#1 = 1;
     |LEE 040#datfic0@.];
     |PARA; |SI FSalida = 0;  |Y #datfic0@#0 = enEmpresa;  |HACIENDO;
            |SI #datfic0@#3 = "R";  |O #datfic0@#3 = "A";
                |HAZ Seleccion1;
            |FINSI;

            |SI #datfic0@#3 = "X";
                eaPrograma = "rem00021";
                enLinea    = #datfic0@#1;
                eaObserva  = "(D) RENDIMIENTOS DEL CAPITAL INMOBILIARIO";
                |HAZ Graba1003;
            |FINSI;
            |LEE 040#datfic0@.s;
     |SIGUE;
     |CIERRA #datfic0@;
     |CIERRA #rem01011@;
     |CIERRA #rem01013@;
     |CIERRA #rem01041@;
     |CIERRA #rem01018@;
     |CIERRA #rem01015@;
     |CIERRA #rem01052@;
     |CIERRA #rem01055@;

     |DESCARGA_DEF #rem01055@;
     |DESCARGA_DEF #rem01015@;
     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01052@;
     |DESCARGA_DEF #rem01041@;
     |DESCARGA_DEF #rem01013@;
     |DESCARGA_DEF #rem01011@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO GrabaContriA;
     eaCasilla = "01-0003-LIQ18";  enImporte = #rem01010@#3;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0004-LIQ18";  enImporte = #rem01010@#4;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0005-LIQ18";  enImporte = #rem01010@#5;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0006-LIQ18";  enImporte = #rem01010@#6;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0007-LIQ18";  enImporte = #rem01010@#7;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0008-LIQ18";  enImporte = #rem01010@#8;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0009-LIQ18";  enImporte = #rem01010@#9;   |HAZ GrabaLinealContri;
     eaCasilla = "01-0010-LIQ18";  enImporte = #rem01010@#10;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0011-LIQ18";  enImporte = #rem01010@#11;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0012-LIQ18";  enImporte = #rem01010@#12;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0013-LIQ18";  enImporte = #rem01010@#13;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0014-LIQ18";  enImporte = #rem01010@#14;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0015-LIQ18";  enImporte = #rem01010@#15;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0016-LIQ18";  enImporte = #rem01010@#16;  |HAZ GrabaLinealContri;
     eaCasilla = "01-0017-LIQ18";  enImporte = #rem01010@#17;  |HAZ GrabaLinealContri;
|FPRC;

|PROCESO SeparaAConjuta;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, rem01010@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01010@#"zdat1010"#;  |FINSI;

     |ABRE #rem01010@;

     #rem01010@#0 = enEmpresa;
     #rem01010@#1 = enComplementaria;
     #rem01010@#2 = "";
     |LEE 000#rem01010@.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #rem01010@#0 ! enEmpresa;  |SAL;         |FINSI;
          |SI #rem01010@#1 ! enComplementaria;  |SAL;  |FINSI;

          aAlfa1 = "0";
          aAlfa2 = "0";
          aAlfa3 = "0";
          aAlfa4 = "0";
          aAlfa5 = "0";
          aAlfa6 = "0";

          |SI #rem01010@#2 = "TITULAR   "; aAlfa1 = "1";  |FINSI;
          |SI #rem01010@#2 = "CONYUGE   "; aAlfa2 = "1";  |FINSI;
          |SI #rem01010@#2 = "1 FAMILIAR"; aAlfa3 = "1";  |FINSI;
          |SI #rem01010@#2 = "2 FAMILIAR"; aAlfa4 = "1";  |FINSI;
          |SI #rem01010@#2 = "3 FAMILIAR"; aAlfa5 = "1";  |FINSI;
          |SI #rem01010@#2 = "4 FAMILIAR"; aAlfa6 = "1";  |FINSI;


          eaColImp = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + aAlfa5 + aAlfa6;

          |SI eaColImp ! "000000";
              #refere1@#0 = enEmpresa;
              #refere1@#1 = enComplementaria;
              #refere1@#2 = "CONJUNTA";
              |HAZ GrabaContriA;
          |FINSI;

          |SI eaMuerto = "T";  aAlfa1 = "0";  |FINSI;
          |SI eaMuerto = "C";  aAlfa2 = "0";  |FINSI;

          eaColImp = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + aAlfa5 + aAlfa6;

          |SI eaColImp ! "000000";
              #refere1@#0 = enEmpresa;
              #refere1@#1 = enComplementaria;
              #refere1@#2 = "CONJUNTAE";
              |HAZ GrabaContriA;
          |FINSI;

          |LEE 000#rem01010@.s;
     |SIGUE;

     |CIERRA #rem01010@;

     |DESCARGA_DEF #rem01010@;
|FPRC;

|PROCESO GrabaContriB;
     eaCasilla = "02-0027-LIQ18";  enImporte = #rem01012@#3;   |HAZ GrabaLinealContri;
     eaCasilla = "02-0028-LIQ18";  enImporte = #rem01012@#19;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0029-LIQ18";  enImporte = #rem01012@#4;   |HAZ GrabaLinealContri;
     eaCasilla = "02-0030-LIQ18";  enImporte = #rem01012@#5;   |HAZ GrabaLinealContri;
     eaCasilla = "02-0031-LIQ18";  enImporte = #rem01012@#6;   |HAZ GrabaLinealContri;
     eaCasilla = "02-0032-LIQ18";  enImporte = #rem01012@#7;   |HAZ GrabaLinealContri;
     eaCasilla = "02-0033-LIQ18";  enImporte = #rem01012@#20;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0034-LIQ18";  enImporte = #rem01012@#31;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0035-LIQ18";  enImporte = #rem01012@#18;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0036-LIQ18";  enImporte = #rem01012@#9;   |HAZ GrabaLinealContri;
     eaCasilla = "02-0037-LIQ18";  enImporte = #rem01012@#10;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0038-LIQ18";  enImporte = #rem01012@#13;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0039-LIQ18";  enImporte = #rem01012@#15;  |HAZ GrabaLinealContri;
     eaCasilla = "02-0040-LIQ18";  enImporte = #rem01012@#16;  |HAZ GrabaLinealContri;

     eaCasilla = "03-0046-LIQ18";  enImporte = #rem01012@#21;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0047-LIQ18";  enImporte = #rem01012@#22;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0048-LIQ18";  enImporte = #rem01012@#23;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0050-LIQ18";  enImporte = #rem01012@#24;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0051-LIQ18";  enImporte = #rem01012@#8;   |HAZ GrabaLinealContri;
     eaCasilla = "03-0052-LIQ18";  enImporte = #rem01012@#25;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0053-LIQ18";  enImporte = #rem01012@#26;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0054-LIQ18";  enImporte = #rem01012@#27;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0055-LIQ18";  enImporte = #rem01012@#14;  |HAZ GrabaLinealContri;
     eaCasilla = "03-0056-LIQ18";  enImporte = #rem01012@#28;  |HAZ GrabaLinealContri;
|FPRC;

|PROCESO SeparaBConjuta;
     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     |ABRE #rem01012@;

     #rem01012@#0 = enEmpresa;
     #rem01012@#1 = enComplementaria;
     #rem01012@#2 = "";
     |LEE 000#rem01012@.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #rem01012@#0 ! enEmpresa;  |SAL;         |FINSI;
          |SI #rem01012@#1 ! enComplementaria;  |SAL;  |FINSI;

          aAlfa1 = "0";
          aAlfa2 = "0";
          aAlfa3 = "0";
          aAlfa4 = "0";
          aAlfa5 = "0";
          aAlfa6 = "0";

          |SI #rem01012@#2 = "TITULAR   "; aAlfa1 = "1";  |FINSI;
          |SI #rem01012@#2 = "CONYUGE   "; aAlfa2 = "1";  |FINSI;
          |SI #rem01012@#2 = "1 FAMILIAR"; aAlfa3 = "1";  |FINSI;
          |SI #rem01012@#2 = "2 FAMILIAR"; aAlfa4 = "1";  |FINSI;
          |SI #rem01012@#2 = "3 FAMILIAR"; aAlfa5 = "1";  |FINSI;
          |SI #rem01012@#2 = "4 FAMILIAR"; aAlfa6 = "1";  |FINSI;

          eaColImp = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + aAlfa5 + aAlfa6;

          |SI eaColImp ! "000000";
              #refere1@#0 = enEmpresa;
              #refere1@#1 = enComplementaria;
              #refere1@#2 = "CONJUNTA";
              |HAZ GrabaContriB;
          |FINSI;

          |SI eaMuerto = "T";  aAlfa1 = "0";  |FINSI;
          |SI eaMuerto = "C";  aAlfa2 = "0";  |FINSI;

          eaColImp = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + aAlfa5 + aAlfa6;

          |SI eaColImp ! "000000";
              #refere1@#0 = enEmpresa;
              #refere1@#1 = enComplementaria;
              #refere1@#2 = "CONJUNTAE";
              |HAZ GrabaContriB;
          |FINSI;

          |LEE 000#rem01012@.s;
     |SIGUE;

     |CIERRA #rem01012@;

     |DESCARGA_DEF #rem01012@;
|FPRC;

|PROCESO Bloque1;
     |ABRE #rem00903;  |SELECT #2#rem00903;

     |HAZ PuntoA1;
     |HAZ PuntoB1;
     |HAZ PuntoB2;
     |HAZ PuntoB3;
     |HAZ PuntoB4;
     |HAZ PuntoB5;
     |HAZ PuntoC1;

     |CIERRA #rem00903;

     |HAZ SeparaAConjuta;
     |HAZ SeparaBConjuta;
|FPRC;
