|FICHEROS;
     rey00003;
     reacceso;
     rem00100;
     rem00101;
     rem00901;
     rem00902;
     rem01001;
     rem01002;

     rew00001,MANTE;
     rew00002;
|FIN;

|VARIABLES;
     &enSw     = 0;
     sw        = 0;
     aMax      = "";
     aMin      = "";
     aFicDes   = "";
     aCaracter = "";
     aCadena   = "";
     aLen      = "";
     aNomImp   = "";
     aAlfa1    = "";
     aAlfa2    = "";
     aAlfa3    = "";
     aAlfa4    = "";
     aFicEnvio = "";
     aTitulo0  = "";
     aTitulo1  = "";
     aTitulo   = "";
     aBloque   = "";
     aFichero  = "";
     aEsc1     = "";
     aEsc2     = "";
     aRetu     = "";
     aTecla    = "";

     nLen      = 0;
     nPos      = 0;
     nHandle   = 0;
     nHandle1  = 0;
     nSalida   = 0;
     nCopia    = 0;
     nNume     = 0;
     nSwErr    = 0;
     nGuarda   = 0;
     nResto    = 0;
     nCampo    = 0;
     nLinPan   = 0;
     nModo     = 0;
     nPan      = 0;
     nNumPanta = 0;
     nNumCampos= 0;
     nLinea    = 0;
     nEmpre    = 0;
     nHcodi    = 0;
     nDcodi    = 0;
     nBloque   = 0;
     i         = 0;
     xxx       = 0;
     nSwTodos  = 0;
     nSwAlguno = 0;
     nRango    = 0;
     nVentana  = 0;
     nGrid     = 0;

     aOrg      = "";
     aDes      = "";
     aQueQuiero= "";
     aNumPanta = "";
     aNumCampos= "";
     aDef      = "";
     aBase     = "";
     aAlfa     = "";
     aSalto    = "";
     aRaya     = "";

     &aI       = "";
     &aF       = "";
     &aG       = "";
     &aS       = "";
     &aO       = "";
     &nTip     = 0;

     &enCodProv = 0;
     &enCodPobl = 0;
     &eaVacio   = "   ";
|FIN;

|PROCESO ImpreWord; |TIPO 0;
     aAlfa = #rey00003#49;
     |C_M #rey00003#50, 1 , aAlfa;
     |C_M #rey00003#52, 1 , aAlfa;
     |SI aAlfa = "S";
          #rey00003#48 = "S";
          |PINTA #rey00003#48;
     |FINSI;
|FPRC;

|PROCESO seleccion; |TIPO 0;
     |SI #rey00003#0 = "S";
         |CAMPO_MODIFICA #rey00003#01, 1, "S";
         |CAMPO_MODIFICA #rey00003#02, 1, "S";

         |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
               #rey00003#xxx# = 0; |PINTA #rey00003#xxx#;
               |CAMPO_MODIFICA #rey00003#xxx#, 1, "N";
         |SIGUE;
     |SINO;
         #rey00003#1 = 00001; |PINTA #rey00003#1;    |CAMPO_MODIFICA #rey00003#01, 1, "N";
         #rey00003#2 = 99999; |PINTA #rey00003#2;    |CAMPO_MODIFICA #rey00003#02, 1, "N";

         |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
               |CAMPO_MODIFICA #rey00003#xxx#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Longi; |TIPO 0;
     |C_M #rey00003#38, 1, "S";
     |C_M #rey00003#40, 1, "S";
     |SI #rey00003#37 = "S";
         |C_M #rey00003#38, 1, "N";
         |C_M #rey00003#40, 1, "N";
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Cabecera;
     |ACABA;
     |SI #rey00003#49 = "S"; |Y nLinea > 1; |ACABA; |FINSI;

     nLinea = nLinea + 3;

     aAlfa = "COMPROBACION RENTA       CONTRIBUYENTE:" + #reacceso#0 + " " + #reacceso#1;
     aAlfa = aAlfa % 180;
     |IMPRIME aAlfa;

     aAlfa = (" " * 60) + " N.I.F.:" + #reacceso#2;
     |IMPRIME aAlfa;

     aAlfa = aRaya * 80;
     |IMPRIME aAlfa;
|FPRC;

|PROCESO Pie;
     |SI #rey00003#49 = "S"; |ACABA; |FINSI;

     |PARA i = nLinea; |SI i < #rey00003#38; |HACIENDO i = i + 1;
          |IMPRIME "";
     |SIGUE;
     |SI #rey00003#40 = "S"; |IMPRIME aSalto; |FINSI;
     nLinea = 0;
|FPRC;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO rem00101;
     enSw = 2;
     |PRINT;
|FPRC;

|DEFBUCLE rem00101;
     #rem00101#1;
     ;
     #rem00100#0, 01
     #rem00100#0, 99;
     ;
     NULL, rem00101;
|FIN;

|PROCESO Opcion0;
     |ABRE #rem00100;
     #rem00100#0 = #reacceso#0;
     |LEE 000#rem00100.=;
     |CIERRA #rem00100;
     |INFOR "rey00003";
     |SI FSalida = 0;
        enCodProv = #rem00100#20;
        enCodPobl = #rem00100#21;
        |HAZ LeePoblacion;

        nTip = 1;  |PRINT;
        nTip =2;
        |BUCLE rem00101;
        nTip = 3;
        aI = "";
        aF = "";
        aG = "";
        aS = "";
        aO = "";
        |SI #rem00100#59 = "I";
          aI = "X";
          aF = " ";
        |FINSI;
        |SI #rem00100#59 = "O";
          aI = " ";
          aF = "X";
        |FINSI;
        |SI #rem00100#59 = "D";
          aI = "X";
          aF = "X";
        |FINSI;
        |SI #rem00100#93 = "G";
          aG = "X";
          aS = " ";
          aO = " ";
        |FINSI;
        |SI #rem00100#93 = "S";
          aG = " ";
          aS = "X";
          aO = " ";
        |FINSI;
        |SI #rem00100#93 = "O";
          aG = " ";
          aS = " ";
          aO = "X";
        |FINSI;
        |PRINT;
        |PIEINF;
        |FININF;
    |FINSI;
    nTip = 0;
|FPRC;

|PROCESO ImprimeLiq;
     |PRINT;
|FPRC;

|DEFBUCLE rew00002;
     #rew00002#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, ImprimeLiq;
|FIN;

|PROCESO rem01002;
     nLinea  = nLinea + 1;

     |DDEFECTO #rew00002;
     #rew00002#0 = nLinea;
     #rew00002#1 = #rem01002#5;
     #rew00002#2 = "     " + #rem01002#6;
     #rew00002#3 = #rem01002#7;

     |GRABA 020#rew00002.n;
     |LIBERA #rew00002;
|FPRC;

|DEFBUCLE rem01002;
     #rem01002#1;
     ;
     #rem01001#0, #rem01001#1, #rem01001#2, nBloque, 000;
     #rem01001#0, #rem01001#1, #rem01001#2, nBloque, 999;
     ;
     NULL, rem01002;
|FIN;

|PROCESO rem00901;
     aAlfa = #rem00901#5 % 103;

     |SI aAlfa = "TIT";
         nLinea = nLinea + 1;

         #rew00002#0 = nLinea;
         #rew00002#1 = "";
         #rew00002#2 = #rem00901#4 > "";
         #rew00002#3 = 0;
         |GRABA 020#rew00002.n;
         |LIBERA #rew00002;
     |FINSI;

     |SI aAlfa = "LIQ";
         aAlfa = #rem00901#5;  |QBF aAlfa;
         aAlfa = aAlfa % -102;
         nBloque = aAlfa;
         |SI nBloque ] 60;  |Y nBloque [ 74;
             |ACABA;
         |FINSI;

         aAlfa   = #rem00901#5 % 103;
         aBloque = #rem00901#5 % 502;
         nBloque = aBloque;
         |BUCLE rem01002;
     |FINSI;
|FPRC;

|DEFBUCLE rem00901;
     #rem00901#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00901;
|FIN;

|PROCESO rem00902;
     aAlfa = #rem00902#5;  |QBF aAlfa;
     aAlfa = aAlfa % -102;
     nBloque = aAlfa;
     |SI nBloque ] 60;  |Y nBloque [ 74;
         |ACABA;
     |FINSI;

     aAlfa = #rem00902#5 % 103;

     |SI aAlfa = "TIT";
         nLinea = nLinea + 1;

         #rew00002#0 = nLinea;
         #rew00002#1 = "";
         #rew00002#2 = #rem00902#4 > "";
         #rew00002#3 = 0;
         |GRABA 020#rew00002.n;
         |LIBERA #rew00002;
     |FINSI;

     |SI aAlfa = "LIQ";
         aBloque = #rem00902#5 % 502;
         nBloque = aBloque;
         |BUCLE rem01002;
     |FINSI;
|FPRC;

|DEFBUCLE rem00902;
     #rem00902#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rem00902;
|FIN;

|PROCESO rem01001;
     |INFOR "rey00001";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = ("TC" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #rew00002#aFichero#;

     |ABRE #rew00002;  |CIERRA #rew00002;  |DELINDEX #rew00002;

     nLinea = 0;
     |ABRE #rew00002;
     aAlfa = #rem01001#2 % 101;
     |SI aAlfa ! "Z";
         |BUCLE rem00901;
     |SINO;
         |BUCLE rem00902;
     |FINSI;
     |CIERRA #rew00002;

     |BUCLE rew00002;

     |PIEINF;
     |FININF;

     |DELINDEX #rew00002;
|FPRC;

|DEFBUCLE rem01001;
     #rem01001#1;
     ;
     #reacceso#0, 00, "          ";
     #reacceso#0, 99, "zOOOOOOOOO";
     ;
     NULL, rem01001;
|FIN;

|PROCESO Opcion9;
     |BUCLE rem01001;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Temporal;
     #reacceso#0 = #rew00001#0;
     |LEE 000#reacceso.=;

     |PARA nCopia = 1; |SI nCopia [ #rew00001#4; |HACIENDO nCopia = nCopia + 1;
          |HAZ Cabecera;
          |HAZ Opcion0;
          |HAZ Opcion9;
          |HAZ Pie;
     |SIGUE;
|FPRC;

|DEFBUCLE Temporal;
     #rew00001#1;
     11;
     00000, " ", "*";
     99999, "z", "*";
     ;
     NULL, Temporal;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO funcion1; |TIPO 11;
     |SI FSalida = 9;
          nNume = Contenido;
          |SI nNume = #rew00001#Campo#;
               |SI #rew00001#11 = " ";
                    #rew00001#11 = "*";
               |SINO;
                    #rew00001#11 = " ";
               |FINSI;
               |PINTA #rew00001#11;
               |GRABA 020#rew00001.a;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min;
     #rew00001#0 = 1;
|FPRC;

|PROCESO Max;
     #rew00001#0 = 99999;
|FPRC;

|PROCESO reacceso;
     |DDEFECTO #rew00001;
     #rew00001#0 = #reacceso#0; || codigo
     #rew00001#2 = #reacceso#2; || NIF
     #rew00001#3 = #reacceso#1; || apellidos y nombre
     #rew00001#4 = 1;    || numero de copias
     #rew00001#11 = " ";
     |SI nSwTodos = 0;
          #rew00001#11 = "*";
     |FINSI;
     |GRABA 000#rew00001.n;
     |SI FSalida = 0;
          nSwAlguno = 1;
     |FINSI;
|FPRC;

|DEFBUCLE reacceso;
     #reacceso#1;
     ;
     nDcodi;
     nHcodi;
     ;
     NULL, reacceso;
|FIN;

|PROCESO Evento;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#rew00001.=;
   |FINSI;

   |SI FSalida = 4;
      |SI #rew00001#11 = " ";
          #rew00001#11 = "*";
      |SINO;
         #rew00001#11 = " ";
      |FINSI;
      |GRABA 020#rew00001.a;
      |LIBERA #rew00001;

      |PINTA #rew00001#11;
   |FINSI;
|FPRC;

|PROCESO CargaTmp;
     |SI #rey00003#33 = "S";
          |CONFI "0000SMarcar todos: ";
          nSwTodos = FSalida;
     |SINO;
          nSwTodos = 0;
     |FINSI;

     aAlfa = Usuario; |QBF aAlfa;
     |NOME_DAT #rew00001#aAlfa#;
     |DELINDEX #rew00001;
     |ABRE #rew00001;
     |SI #rey00003#0 = "S";
          nDcodi = #rey00003#1;
          nHcodi = #rey00003#2;
          |BUCLE reacceso;
     |SINO;
          |PARA nCampo = 3; |SI i [ 32; |HACIENDO; i = i + 1;
               nDcodi = #rey00003#nCampo#;
               nHcodi = #rey00003#nCampo#;
               |BUCLE reacceso;
          |SIGUE;
     |FINSI;
     |CIERRA #rew00001;

     |SI nSwAlguno = 0;
          |MENAV "0000Seleccion vacia.";
          |ACABA;
     |FINSI;

     |SI #rey00003#33 = "S";         || Puntear
          |C_V #rew00001#4, 1, "N";

          |VENTANA 0501, 2399, -1, 16, "Selecci줻 de contribuyentes";
          nVentana = FSalida;

          |PTEC 802;  |PAUSA;

          |PINPA #0#rew00001;
          nRango = 4 + 8 + 16 + 32;

          |ABRE #rew00001;
          |LINEAL_SIMPLE #1#rew00001, nRango, 0502, 2198, Min, Max, Evento;
          nGrid = FSalida;

          aEsc1  = &255 + "806";
          aEsc2  = &255 + "807";
          aRetu  = &255 + "802";
          |PARA; |SI;  |HACIENDO;
               FSalida = "::{{001}}Salir," + nGrid;
               |LEETECLA aTecla;
               |SI aTecla = aEsc1; |SAL;  |FINSI;
               |SI aTecla = aEsc2; |SAL;  |FINSI;
               |SI aTecla = aRetu; |SAL;  |FINSI;
          |SIGUE;

          |CIERRA #rew00001;

          |FINVENTANA nVentana;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO EnviaFichero;

     |IP_REMOTO aAlfa1;  |QBT aAlfa1;
     |SI aAlfa1 ! "";
         |ENVIA_FICHERO aFicDes, aFicEnvio;
     |SINO;
         |COPIA_FICHERO aFicDes, aFicEnvio;
     |FINSI;
|FPRC;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO tipo_3; |TIPO 3;
     aSalto = &12;
     |DDEF aBase;

     |HAZ CargaTmp;

     |ABRE #rew00001;
     |SI #rey00003#49 = "S";
          aAlfa = #rey00003#52; |QBF aAlfa;
          Impresora = aAlfa;
          |IMPRE -1;
     |SINO;
          |IMPRE 0;
     |FINSI;
     |SI FSalida = 0;
          |ABRE #reacceso;
          |BUCLE Temporal;
          |CIERRA #reacceso;
          |FINIMP;
     |FINSI;
     |CIERRA #rew00001;
     |DELINDEX #rew00001;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 2499;
|FPRC;

|PROGRAMA;
     |HAZ PreparaInformes;

     aMax  = &175;
     aMin  = &223;
     aRaya = &196;

     |CLS;
     |ABRE #rey00003;
     |LEE 000#rey00003.p;
     |SI FSalida ! 0; |GRABA 020#rey00003.b; |FINSI;
     |PDEFECTO #rey00003, 1,50;
     |PINPA #0#rey00003;
     |PINDA #0#rey00003;
     |ENDATOS #1#rey00003;
     |SI FSalida = 0;
          |GRABA 020#rey00003.a;
     |FINSI;
     |CIERRA #rey00003;
|FPRO;
