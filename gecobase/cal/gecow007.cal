|FICHEROS;
     gecow003;
     gecow007,MANTE;

     gecom053;
     gecom059;
     gecom060;
|FIN;

|VARIABLES;
     n2Vent              = 0;
     nCmp                = 0;
     nDCmp               = 0;
     nHCmp               = 0;
     nOk                 = 0;

     aAlfa               = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &enModo3            = 0;
|FIN;

|PROCESO T12w007;  |TIPO 12;
     aAlfa = #gecow007#5 + #gecow007#14;   |QBF aAlfa;
     |SI aAlfa ! "";
         |SI #gecow007#4 = 0;
             |MENAV "0000Campo importe obligatorio.";

             |POSICIONATE #gecow007#4;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     aAlfa = #gecow007#3;   |QBF aAlfa;
     |SI aAlfa ! "";
         |SI #gecow007#4 = 0;
             |MENAV "0000Campo importe obligatorio.";

             |POSICIONATE #gecow007#4;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI aAlfa = "";
         |SI #gecow007#4 ! 0;
             |MENAV "0000M‚todo de pago obligatorio.";

             |POSICIONATE #gecow007#3;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;


     |ABRE #gecom060;

     aAlfa = #gecow007#5;  |QBF aAlfa;
     |SI aAlfa ! "";
         #gecom060#0 = #gecow007#5;
         |LEE 101#gecom060.=;
         |SI FSalida ! 0;
             |DDEFECTO #gecom060;
             #gecom060#0 = #gecow007#5;
             |GRABA 020#gecom060.b;
         |FINSI;

         #gecom060#1 = #gecow007#6;
         #gecom060#2 = #gecow007#7;
         #gecom060#3 = #gecow007#8;
         #gecom060#4 = #gecow007#9;
         #gecom060#5 = #gecow007#10;
         #gecom060#6 = #gecow007#11;
         #gecom060#7 = #gecow007#12;
         #gecom060#8 = #gecow007#13;

         |GRABA 020#gecom060.a;
         |LIBERA #gecom060;
     |FINSI;

     aAlfa = #gecow007#14;  |QBF aAlfa;
     |SI aAlfa ! "";
         #gecom060#0 = #gecow007#14;
         |LEE 101#gecom060.=;
         |SI FSalida ! 0;
             |DDEFECTO #gecom060;
             #gecom060#0 = #gecow007#14;
             |GRABA 020#gecom060.b;
         |FINSI;

         #gecom060#1 = #gecow007#15;
         #gecom060#2 = #gecow007#16;
         #gecom060#3 = #gecow007#17;
         #gecom060#4 = #gecow007#18;
         #gecom060#5 = #gecow007#19;
         #gecom060#6 = #gecow007#20;
         #gecom060#7 = #gecow007#21;
         #gecom060#8 = #gecow007#22;

         |GRABA 020#gecom060.a;
         |LIBERA #gecom060;
     |FINSI;

     |CIERRA #gecom060;
|FPRC;

|PROCESO T66C22w007;  |TIPO 66;
     |ABRE #gecom053;
     |SELECT #1#gecom053;
     #gecom053#0 = #gecow007#21;
     |LEE 000#gecom053.=;

     |CONSULTA_CLAVE #2#gecom053;
     |SI FSalida = 0;
         #gecow007#21 = #gecom053#0;
         #gecow007#22 = #gecom053#1;
     |FINSI;
     |CIERRA #gecom053;

     |PINTA #gecow007#22;
|FPRC;

|PROCESO T0C22w007;  |TIPO 0;
     aAlfa = #gecow007#22;  |QBF aAlfa;
     |SI aAlfa = "";
         |ACABA;
     |FINSI;

     |ABRE #gecom053;
     |SELECT #2#gecom053;
     #gecom053#1 = #gecow007#22;
     |LEE 000#gecom053.=;
     |SI FSalida ! 0;
         |MENAV "0000El pais no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom053;

     #gecow007#21 = #gecom053#0;
|FPRC;

|PROCESO T0C14w007;  |TIPO 0;
     |C_M #gecow007#16, 1, "S";
     |C_M #gecow007#17, 1, "S";
     |C_M #gecow007#18, 1, "S";
     |C_M #gecow007#19, 1, "S";
     |C_M #gecow007#20, 1, "S";
     |C_M #gecow007#21, 1, "S";
     |C_M #gecow007#22, 1, "S";

     aAlfa = #gecow007#14;  |QBF aAlfa;
     |SI aAlfa = "";
         |C_M #gecow007#15, 1, "N";  #gecow007#15 = "";   |PINTA #gecow007#15;
         |C_M #gecow007#16, 1, "N";  #gecow007#16 = "";   |PINTA #gecow007#16;
         |C_M #gecow007#17, 1, "N";  #gecow007#17 = "";   |PINTA #gecow007#17;
         |C_M #gecow007#18, 1, "N";  #gecow007#18 = "";   |PINTA #gecow007#18;
         |C_M #gecow007#19, 1, "N";  #gecow007#19 = "";   |PINTA #gecow007#19;
         |C_M #gecow007#20, 1, "N";  #gecow007#20 = "";   |PINTA #gecow007#20;
         |C_M #gecow007#21, 1, "N";  #gecow007#21 = "";   |PINTA #gecow007#21;
         |C_M #gecow007#22, 1, "N";  #gecow007#22 = "";   |PINTA #gecow007#22;

         |ACABA;
     |FINSI;

     |ABRE #gecom060;
     #gecom060#0 = #gecow007#14;
     |LEE 000#gecom060.=;
     |SI FSalida = 0;
         #gecow007#15 = #gecom060#1;
         #gecow007#16 = #gecom060#2;
         #gecow007#17 = #gecom060#3;
         #gecow007#18 = #gecom060#4;
         #gecow007#19 = #gecom060#5;
         #gecow007#20 = #gecom060#6;
         #gecow007#21 = #gecom060#7;
         #gecow007#22 = #gecom060#8;
     |FINSI;
     |CIERRA #gecom060;

     |PINTA #gecow007#15;
     |PINTA #gecow007#16;
     |PINTA #gecow007#17;
     |PINTA #gecow007#18;
     |PINTA #gecow007#19;
     |PINTA #gecow007#20;
     |PINTA #gecow007#21;
     |PINTA #gecow007#22;
|FPRC;

|PROCESO T0C5w007;  |TIPO 0;
     |C_M #gecow007#6,  1, "S";
     |C_M #gecow007#7,  1, "S";
     |C_M #gecow007#8,  1, "S";
     |C_M #gecow007#9,  1, "S";
     |C_M #gecow007#10, 1, "S";
     |C_M #gecow007#11, 1, "S";
     |C_M #gecow007#12, 1, "S";
     |C_M #gecow007#13, 1, "S";

     aAlfa = #gecow007#5;  |QBF aAlfa;
     |SI aAlfa = "";
         |C_M #gecow007#6,  1, "N";  #gecow007#6  = "";   |PINTA #gecow007#6;
         |C_M #gecow007#7,  1, "N";  #gecow007#7  = "";   |PINTA #gecow007#7;
         |C_M #gecow007#8,  1, "N";  #gecow007#8  = "";   |PINTA #gecow007#8;
         |C_M #gecow007#9,  1, "N";  #gecow007#9  = "";   |PINTA #gecow007#9;
         |C_M #gecow007#10, 1, "N";  #gecow007#10 = "";   |PINTA #gecow007#10;
         |C_M #gecow007#11, 1, "N";  #gecow007#11 = "";   |PINTA #gecow007#11;
         |C_M #gecow007#12, 1, "N";  #gecow007#12 = "";   |PINTA #gecow007#12;
         |C_M #gecow007#13, 1, "N";  #gecow007#13 = "";   |PINTA #gecow007#13;

         |ACABA;
     |FINSI;

     |ABRE #gecom060;
     #gecom060#0 = #gecow007#5;
     |LEE 000#gecom060.=;
     |SI FSalida = 0;
         #gecow007#6  = #gecom060#1;
         #gecow007#7  = #gecom060#2;
         #gecow007#8  = #gecom060#3;
         #gecow007#9  = #gecom060#4;
         #gecow007#10 = #gecom060#5;
         #gecow007#11 = #gecom060#6;
         #gecow007#12 = #gecom060#7;
         #gecow007#13 = #gecom060#8;
     |FINSI;
     |CIERRA #gecom060;

     |PINTA #gecow007#6;
     |PINTA #gecow007#7;
     |PINTA #gecow007#8;
     |PINTA #gecow007#9;
     |PINTA #gecow007#10;
     |PINTA #gecow007#11;
     |PINTA #gecow007#12;
     |PINTA #gecow007#13;
|FPRC;

|PROCESO T66C13w007;  |TIPO 66;
     |ABRE #gecom053;
     |SELECT #1#gecom053;
     #gecom053#0 = #gecow007#12;
     |LEE 000#gecom053.=;

     |CONSULTA_CLAVE #2#gecom053;
     |SI FSalida = 0;
         #gecow007#12 = #gecom053#0;
         #gecow007#13 = #gecom053#1;
     |FINSI;
     |CIERRA #gecom053;

     |PINTA #gecow007#13;
|FPRC;

|PROCESO T0C13w007;  |TIPO 0;
     aAlfa = #gecow007#13;  |QBF aAlfa;
     |SI aAlfa = "";
         |ACABA;
     |FINSI;

     |ABRE #gecom053;
     |SELECT #2#gecom053;
     #gecom053#1 = #gecow007#13;
     |LEE 000#gecom053.=;
     |SI FSalida ! 0;
         |MENAV "0000El pais no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom053;

     #gecow007#12 = #gecom053#0;
|FPRC;

|PROCESO T66C3w007;  |TIPO 66;
     |ABRE #gecom059;
     |SELECT #2#gecom059;
     #gecom059#0 = #gecow007#3;
     |LEE 000#gecom059.=;

     |CONSULTA_CLAVE #2#gecom059;
     |SI FSalida = 0;
         #gecow007#3 = #gecom059#1;
     |FINSI;
     |CIERRA #gecom059;

     |PINTA #gecow007#3;
|FPRC;

|PROCESO T0C3w007;  |TIPO 0;
     |ABRE #gecom059;
     |SELECT #2#gecom059;
     #gecom059#1 = #gecow007#3;
     |LEE 000#gecom059.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el medio de pago.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom059;
|FPRC;

|PROCESO PagCabecera;
     |VENTANA 0501, 3399, -1, 16, "Datos de pago";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow007;

     |DDEFECTO #gecow007;

     |PARA nDCmp = 0;  |SI nDCmp [ 22;  |HACIENDO nDCmp = nDCmp + 1;
           nHCmp = nDCmp + 73;
           #gecow007#nDCmp#  = #gecow003#nHCmp#;
     |SIGUE;

     |PINDA #0#gecow007;

     |SI enModo3 ! 4;
         |ENDATOS #1#gecow007;
         |SI FSalida = 0;
             |PARA nDCmp = 0;  |SI nDCmp [ 22;  |HACIENDO nDCmp = nDCmp + 1;
                   nHCmp = nDCmp + 73;
                   #gecow003#nHCmp# = #gecow007#nDCmp#;
             |SIGUE;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;
