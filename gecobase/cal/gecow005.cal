|FICHEROS;
     gecow003;
     gecow005,MANTE;

     gecom011;
     gecom054;
     gecom058;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     nId                 = 0;
     nCmp                = 0;
     nOk                 = 0;

     aAlfa               = "";
     aAlfa1              = "";
     aAlfa2              = "";
     aAlfa3              = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &enGrid11           = 0;
     &enTCmp11           = 0;
|FIN;

|PROCESO T12w005;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     aAlfa1 = #gecow005#12; |QBF aAlfa1;
     aAlfa2 = #gecow005#5;  |QBF aAlfa2;
     aAlfa3 = #gecow005#6;  |QBF aAlfa3;

     nOk = 0;
     |SI aAlfa1 ! "";  nOk = nOk + 1;  |FINSI;
     |SI aAlfa2 ! "";  nOk = nOk + 1;  |FINSI;
     |SI aAlfa3 ! "";  nOk = nOk + 1;  |FINSI;

     |SI nOk = 1;  |O nOk = 2;
         |MENAV "0000Si se introduce alg£n campo del emisor complete todos sus campos";
         |POSICIONATE #gecow005#3;
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1 = #gecow005#13; |QBF aAlfa1;
     aAlfa2 = #gecow005#9;  |QBF aAlfa2;
     aAlfa3 = #gecow005#10; |QBF aAlfa3;

     nOk = 0;
     |SI aAlfa1 ! "";  nOk = nOk + 1;  |FINSI;
     |SI aAlfa2 ! "";  nOk = nOk + 1;  |FINSI;
     |SI aAlfa3 ! "";  nOk = nOk + 1;  |FINSI;

     |SI nOk = 1;  |O nOk = 2;
         |MENAV "0000Si se introduce alg£n campo del receptor complete todos sus campos";
         |POSICIONATE #gecow005#7;
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #gecow005#11 = 0;
         |MENAV "0000Contenido obligatorio en el campo Importe";
         |POSICIONATE #gecow005#11;
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T66C9w005;  |TIPO 66;
     |ABRE #gecom054;
     |SELECT #1#gecom054;
     #gecom054#0 = #gecow005#8;
     |LEE 000#gecom054.=;

     |CONSULTA_CLAVE #2#gecom054;
     |SI FSalida = 0;
         #gecow005#8 = #gecom054#0;
         #gecow005#9 = #gecom054#1;
     |FINSI;
     |CIERRA #gecom054;

     |PINTA #gecow005#9;
|FPRC;

|PROCESO T0C9w005;  |TIPO 0;
     aAlfa = #gecow005#9;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |ABRE #gecom054;
     |SELECT #2#gecom054;
     #gecom054#1 = #gecow005#9;
     |LEE 000#gecom054.=;
     |SI FSalida ! 0;
         |MENAV "0000El tipo de residencia no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom054;

     #gecow005#8 = #gecom054#0;
|FPRC;

|PROCESO T66C13w005;  |TIPO 66;
     |ABRE #gecom058;
     |SELECT #1#gecom058;
     #gecom058#0 = #gecow005#7;
     |LEE 000#gecom058.=;

     |CONSULTA_CLAVE #2#gecom058;
     |SI FSalida = 0;
         #gecow005#7  = #gecom058#0;
         #gecow005#13 = #gecom058#1;
     |FINSI;
     |CIERRA #gecom058;

     |PINTA #gecow005#13;
|FPRC;

|PROCESO T0C13w005;  |TIPO 0;
     |ABRE #gecom058;
     |SELECT #2#gecom058;
     #gecom058#1 = #gecow005#13;
     |LEE 000#gecom058.=;
     |SI FSalida ! 0;
         |MENAV "0000El tipo de persona no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom058;

     #gecow005#7  = #gecom058#0;
|FPRC;

|PROCESO T66C5w005;  |TIPO 66;
     |ABRE #gecom054;
     |SELECT #1#gecom054;
     #gecom054#0 = #gecow005#4;
     |LEE 000#gecom054.=;

     |CONSULTA_CLAVE #2#gecom054;
     |SI FSalida = 0;
         #gecow005#4 = #gecom054#0;
         #gecow005#5 = #gecom054#1;
     |FINSI;
     |CIERRA #gecom054;

     |PINTA #gecow005#5;
|FPRC;

|PROCESO T0C5w005;  |TIPO 0;
     aAlfa = #gecow005#5;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |ABRE #gecom054;
     |SELECT #2#gecom054;
     #gecom054#1 = #gecow005#5;
     |LEE 000#gecom054.=;
     |SI FSalida ! 0;
         |MENAV "0000El tipo de residencia no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom054;
|FPRC;

|PROCESO T66C12w005;  |TIPO 66;
     |ABRE #gecom058;
     |SELECT #1#gecom058;
     #gecom058#0 = #gecow005#3;
     |LEE 000#gecom058.=;

     |CONSULTA_CLAVE #2#gecom058;
     |SI FSalida = 0;
         #gecow005#3  = #gecom058#0;
         #gecow005#12 = #gecom058#1;
     |FINSI;
     |CIERRA #gecom058;

     |PINTA #gecow005#12;
|FPRC;

|PROCESO T0C12w005;  |TIPO 0;
     |ABRE #gecom058;
     |SELECT #2#gecom058;
     #gecom058#1 = #gecow005#12;
     |LEE 000#gecom058.=;
     |SI FSalida ! 0;
         |MENAV "0000El tipo de persona no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom058;

     #gecow005#3  = #gecom058#0;
|FPRC;

|PROCESO PintaTipo;
     |ABRE #gecom058;
     |SELECT #1#gecom058;

     #gecom058#0 = #gecow005#3;
     |LEE 000#gecom058.=;
     |SI FSalida ! 0;  |DDEFECTO #gecom058;  |FINSI;
     #gecow005#12 = #gecom058#1;

     #gecom058#0 = #gecow005#7;
     |LEE 000#gecom058.=;
     |SI FSalida ! 0;  |DDEFECTO #gecom058;  |FINSI;
     #gecow005#13 = #gecom058#1;
     |CIERRA #gecom058;
|FPRC;

|PROCESO AltSuplido;
     |VENTANA 0501, 1658, -1, 16, "Nuevo suplido";
     n0Vent = FSalida;

     |PTEC 802; |PAUSA;

     |PINPA #0#gecow005;

     |DDEFECTO #gecow005;

     #gecom011#0 = #gecow003#0;
     #gecom011#1 = #gecow003#1;
     #gecom011#2 = 99;
     |LEE 000#gecom011.];
     |SI FSalida = 0;
         |LEE 000#gecom011.a;
     |SINO;
         |LEE 000#gecom011.u;
     |FINSI;

     nId = 1;
     |SI FSalida = 0;  |Y #gecom011#0 = #gecow003#0;
                       |Y #gecom011#1 = #gecow003#1;
         nId = #gecom011#2 + 1;
     |FINSI;

     #gecow005#0 = #gecow003#0;
     #gecow005#1 = #gecow003#1;
     #gecow005#2 = nId;

     |HAZ PintaTipo;

     |PINDA #0#gecow005;
     |ENDATOS #1#gecow005;
     |SI FSalida = 0;
         |PARA nCmp = 0;  |SI nCmp [ enTCmp11;  |HACIENDO nCmp = nCmp + 1;
               #gecom011#nCmp#  = #gecow005#nCmp#;
         |SIGUE;

         |GRABA 020#gecom011.n;
         |LIBERA #gecom011;
     |FINSI;

     |FINVENTANA n0Vent;

     |REFRESCACONTROL enGrid11;
     |FOCOTECLADO enGrid11;
|FPRC;

|PROCESO ModSuplido;
     |LEE 101#gecom011.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1658, -1, 16, "Modificaci¢n suplido";
     n0Vent = FSalida;

     |PTEC 802; |PAUSA;

     |PINPA #0#gecow005;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp11;  |HACIENDO nCmp = nCmp + 1;
           #gecow005#nCmp# = #gecom011#nCmp#;
     |SIGUE;

     |HAZ PintaTipo;

     |PINDA #0#gecow005;
     |ENDATOS #1#gecow005;
     |SI FSalida = 0;
         |PARA nCmp = 0;  |SI nCmp [ enTCmp11;  |HACIENDO nCmp = nCmp + 1;
               #gecom011#nCmp#  = #gecow005#nCmp#;
         |SIGUE;

         |GRABA 020#gecom011.a;
     |FINSI;
     |LIBERA #gecom011;

     |FINVENTANA n0Vent;

     |REFRESCACONTROL enGrid11;
     |FOCOTECLADO enGrid11;
|FPRC;

|PROCESO ConSuplido;
     |LEE 000#gecom011.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1658, -1, 16, "Consulta suplido";
     n0Vent = FSalida;

     |PTEC 802; |PAUSA;

     |PINPA #0#gecow005;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp11;  |HACIENDO nCmp = nCmp + 1;
           #gecow005#nCmp# = #gecom011#nCmp#;
     |SIGUE;

     |HAZ PintaTipo;

     |PINDA #0#gecow005;
     |PAUSA;

     |FINVENTANA n0Vent;

     |REFRESCACONTROL enGrid11;
     |FOCOTECLADO enGrid11;
|FPRC;

|PROCESO BorSuplido;
     |CONFI "0000NEst  seguro que quiere borrar el suplido seleccionado";
     |SI FSalida ! 0;
         |FOCOTECLADO enGrid11;
         |ACABA;
     |FINSI;

     |LEE 101#gecom011.=;
     |SI FSalida ! 0;
         |FOCOTECLADO enGrid11;
         |ACABA;
     |FINSI;

     |BORRA 020#gecom011.a;
     |LIBERA #gecom011;

     |REFRESCACONTROL enGrid11;
     |FOCOTECLADO enGrid11;
|FPRC;
