|FICHEROS;
     gecow102,MANTE;

     gecow103;
     gecow104;
|FIN;

|VARIABLES;
     n2Vent              = 0;
     nGrid103            = 0;
     nGrid104            = 0;
     nRango              = 0;

     aAlfa               = "";
     aAlfa1              = "";
     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";
|FIN;

|PROCESO T12w102;   |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |POSICIONATE #gecow102#0;
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T0C3w102;  |TIPO 0;
     aAlfa = #gecow102#3;  |QBF aAlfa;
     |SI aAlfa = "";
         |C_M #gecow102#5, 1, "N";
         |C_M #gecow102#7, 1, "N";
         |C_M #gecow102#8, 1, "N";

         #gecow102#4 = "";
         |PINTA #gecow102#4;
         |PINTA #gecow102#5;
         |PINTA #gecow102#7;
         |PINTA #gecow102#8;

         |ACABA;
     |FINSI;

     |C_M #gecow102#5, 1, "S";
     |C_M #gecow102#7, 1, "S";
     |C_M #gecow102#8, 1, "S";

     #gecow104#0 = #gecow102#3 % 208;
     #gecow104#1 = #gecow102#3 % 1103;
     |LEE 000#gecow104.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el campo introducido";
         |ERROR;
     |FINSI;

     #gecow102#4 = #gecow104#2;
     #gecow102#6 = #gecow104#3;

     |C_M #gecow102#7, 1, "S";
     |SI #gecow102#6 ! "N";
         |C_M #gecow102#7, 1, "N";
         #gecow102#7 = 0;
     |FINSI;

     |PINTA #gecow102#4;
     |PINTA #gecow102#6;
     |PINTA #gecow102#7;
|FPRC;

|PROCESO Baja104;
     #gecow104#0 = #gecow103#0;
     #gecow104#1 = "";
|FPRC;

|PROCESO Alta104;
     #gecow104#0 = #gecow103#0;
     #gecow104#1 = "zzz";
|FPRC;

|PROCESO Evnt104;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecow104.=;
     |FINSI;

     |SI FSalida = 4;
         #gecow102#3 = "#" + #gecow104#0 + "#" + #gecow104#1 + "#";
         #gecow102#4 = #gecow104#2;
         #gecow102#6 = #gecow104#3;

         |PINTA #gecow102#3;
         |PINTA #gecow102#4;
         |PINTA #gecow102#6;

         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Evnt103;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecow103.=;

         #gecow104#0 = #gecow103#0;
         #gecow104#1 = "000";
         |LEE 000#gecow104.=;

         |REFRESCACONTROL nGrid104;
     |FINSI;
|FPRC;

|PROCESO T66C3w102;  |TIPO 66;
     |VENTANA 0501, 3578, -1, 16, "Selecci¢n de campos";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 4 + 8 + 16 + 32 + 128 + 256;

     |LEE 000#gecow103.p;

     |LINEAL_SIMPLE #1#gecow103, nRango, 0602, 2035, NULL, NULL, Evnt103;
     nGrid103 = FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#gecow104, nRango, 0640, 3275, Baja104, Alta104, Evnt104;
     nGrid104 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid103;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO T0C1w102;  |TIPO 0;
     aAlfa = #gecow102#1;   |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Debes introducir el nombre de la etiqueta";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1 = aAlfa % 101;
     |SI aAlfa1 ! "<";
         |MENAV "0000Formato etiqueta err¢neo";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa1 = aAlfa % -101;
     |SI aAlfa1 ! ">";
         |MENAV "0000Formato etiqueta err¢neo";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #gecow102#0 = "1";  |ACABA;  |FINSI;

     #gecow102#2 = "</" + (aAlfa % 299);

     |PINTA #gecow102#2;
|FPRC;

|PROCESO T0C0w102;  |TIPO 0;
     |C_M #gecow102#3, 1, "S";

     |SI #gecow102#0 = "1";
         |C_M #gecow102#3, 1, "N";

         #gecow102#2 = "";
         #gecow102#3 = "";
         #gecow102#4 = "";
     |FINSI;

     |PINTA #gecow102#2;
     |PINTA #gecow102#3;
     |PINTA #gecow102#4;
|FPRC;
