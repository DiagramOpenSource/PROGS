|FICHEROS;
     gecow001,MANTE;
     gecow003;
     gecow004;
     gecow008;
     gecow010,MANTE;
     gecow013;

     gecom001;
     gecom002;
     gecom003;
     gecom004;
     gecom005;
     gecom010,MANTE;
     gecom011;
     gecom012;
     gecom013;

     gecom051;
     gecom052;
     gecom063;
     gecom064;
     gecom065;
     gecom500;
|FIN;

|VARIABLES;
     n1Vent              = 0;
     n2Vent              = 0;
     nPan3               = -1;
     nCmp                = 0;
     nCmpO               = 0;
     nCmpD               = 0;
     nOk                 = 0;
     nIRep               = 0;
     nIRet               = 0;
     nRango              = 0;
     nBtnMasEmi          = 0;
     nBtnMasRec          = 0;
     nBtnAlt             = 0;
     nBtnMod             = 0;
     nBtnCon             = 0;
     nBtnBor             = 0;

     aAlfa               = "";
     aContenido          = "";
     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aLong               = "";
     aCarac              = "";
     aTexto              = "";
     aQQ                 = "";
     aTipo               = "";
     aFic                = "";
     aHora               = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     {-1}sTree           = 0;
         sT_nID          = 0;
         sT_nOper        = 0;
         sT_aData        = "";

     {10} aPopup         = "";

     &enGrid2            = 0;
     &enGrid5            = 0;
     &enGrid11           = 0;
     &enGrid12           = 0;
     &enGrid13           = 0;
     &enModo3            = 0;
     &enBtnMod3          = -1;
     &enBtnCon3          = -1;
     &enBtnBor3          = -1;
     &enBtnOpc3          = -1;
     &enBtnEnv3          = -1;
     &enBtnAnu3          = -1;
     &enBtnRec3          = -1;
     &enBtnAlt5          = -1;
     &enBtnMod5          = -1;
     &enBtnCon5          = -1;
     &enBtnBor5          = -1;
     &enBtnSuj           = -1;
     &enEmp              = 0;
     &enTCmp3            = 0;
     &enTCmp5            = 0;
     &enTCmp51           = 0;
     &enMeteCentro       = 0;
     &eaIde              = "";
     &eaTip              = "";
     &eaSit              = "";
     &eaUnidadBasico     = "";
     &eaPathAdj          = "";
     &eaCmp0             = "";
     &eaCmp1             = "";
     &eaCmp4             = "";
     &eaCmp5             = "";
     &eaCmp7             = "";
     &eaCmp8             = "";
     &eaCmp9             = "";
     &eaCmp10            = "";
|FIN;

|| -------------------------------------------------------------------------

|PROCESO T7C6m010;  |TIPO 7;
     |SI #gecom010#5 ! 0;
         #gecom010#6 = #gecow003#98 % #gecom010#5;
     |FINSI;

     |PINTA #gecom010#6;
|FPRC;

|| -------------------------------------------------------------------------

|PROCESO gecom005Tot;
     |PARA nCmp = 0;  |SI nCmp [ enTCmp5;  |HACIENDO nCmp = nCmp + 1;
           #gecow004#nCmp# = #gecom005#nCmp#;
     |SIGUE;

     |HAZ CargaArtPanta;

     |HAZ Totalw004;

     |HAZ DescargaArtPanta;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp5;  |HACIENDO nCmp = nCmp + 1;
           #gecom005#nCmp# = #gecow004#nCmp#;
     |SIGUE;

     |GRABA 020#gecom005.a;
     |LIBERA #gecom005;

     #gecow003#98  = #gecow003#98  + #gecom005#8;
     #gecow003#102 = #gecow003#102 + #gecom005#9;
     #gecow003#103 = #gecow003#103 + #gecom005#10;
|FPRC;

|DEFBUCLE gecom005Tot;
     #gecom005#1;
     ;
     #gecom002#0, #gecom002#1, 0000;
     #gecom002#0, #gecom002#1, 9999;
     be;
     NULL, gecom005Tot;
|FIN;

|PROCESO gecom010Tot;
     |SI #gecom010#2 = "C";
         #gecow003#100 = #gecow003#100 + #gecom010#6;
     |FINSI;

     |SI #gecom010#2 = "D";
         #gecow003#99  = #gecow003#99  + #gecom010#6;
     |FINSI;
|FPRC;

|DEFBUCLE gecom010Tot;
     #gecom010#1;
     ;
     #gecom002#0, #gecom002#1, " ", 00;
     #gecom002#0, #gecom002#1, "z", 99;
     ;
     NULL, gecom010Tot;
|FIN;

|PROCESO gecom011Tot;
     #gecow003#106 = #gecow003#106 + #gecom011#11;
|FPRC;

|DEFBUCLE gecom011Tot;
     #gecom011#1;
     ;
     #gecom002#0, #gecom002#1, 00;
     #gecom002#0, #gecom002#1, 99;
     ;
     NULL, gecom011Tot;
|FIN;

|PROCESO Pintaw003;
     |PINTA #gecow003#98;
     |PINTA #gecow003#99;
     |PINTA #gecow003#100;
     |PINTA #gecow003#101;
     |PINTA #gecow003#102;
     |PINTA #gecow003#103;
     |PINTA #gecow003#104;
     |PINTA #gecow003#105;
     |PINTA #gecow003#106;
     |PINTA #gecow003#107;
     |PINTA #gecow003#108;
|FPRC;

|PROCESO Totalw003;
     #gecow003#98  = 0;
     #gecow003#99  = 0;
     #gecow003#100 = 0;
     #gecow003#101 = 0;
     #gecow003#102 = 0;
     #gecow003#103 = 0;
     #gecow003#104 = 0;
     #gecow003#106 = 0;
     #gecow003#108 = 0;

     |BUCLE gecom005Tot;
     |BUCLE gecom010Tot;
     |BUCLE gecom011Tot;

     nIRep = #gecow003#102;
     nIRet = #gecow003#103;

     #gecow003#101 = #gecow003#98  - #gecow003#99  + #gecow003#100;

     #gecow003#102 = (#gecow003#101 * nIRep) / #gecow003#98;
     #gecow003#103 = (#gecow003#101 * nIRet) / #gecow003#98;

     #gecow003#104 = #gecow003#101 + #gecow003#102 - #gecow003#103;
     #gecow003#108 = #gecow003#104 - #gecow003#105 + #gecow003#106;
     #gecow003#108 = #gecow003#108 + #gecow003#107;
|FPRC;

|PROCESO T12w003;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     |HAZ Totalw003;
|FPRC;

|PROCESO SacaEmisor;
     |PARA nCmpD = 11;  |SI nCmpD [ 41;  |HACIENDO nCmpD = nCmpD + 1;
           nCmpO = nCmpD - 11;

           #gecow001#nCmpO# = #gecow003#nCmpD#;
     |SIGUE;
|FPRC;

|PROCESO SacaReceptor;
     |PARA nCmpD = 42;  |SI nCmpD [ 72;  |HACIENDO nCmpD = nCmpD + 1;
           nCmpO = nCmpD - 42;

           #gecow001#nCmpO# = #gecow003#nCmpD#;
     |SIGUE;

     #gecow001#31 = #gecow003#109;
     #gecow001#32 = #gecow003#110;
|FPRC;

|PROCESO gecom052;
     #gecom004#0  = #gecow003#0;
     #gecom004#1  = #gecow003#1;
     #gecom004#2  = eaTip;

     |PARA nCmpD = 3;  |SI nCmpD [ 27;  |HACIENDO nCmpD = nCmpD + 1;
           nCmpO = nCmpD - 2;

           #gecom004#nCmpD# = #gecom052#nCmpO#;
     |SIGUE;

     |GRABA 020#gecom004.n;
     |LIBERA #gecom004;

     nOk = 1;
|FPRC;

|DEFBUCLE gecom052;
     #gecom052#1;
     ;
     #gecow001#0, "";
     #gecow001#0, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, gecom052;
|FIN;

|PROCESO gecom004Bw003;
     |BORRA 020#gecom004.a;
     |LIBERA #gecom004;
|FPRC;

|DEFBUCLE gecom004Bw003;
     #gecom004#1;
     ;
     #gecow003#0, #gecow003#1, eaTip, "";
     #gecow003#0, #gecow003#1, eaTip, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, gecom004Bw003;
|FIN;

|PROCESO MeteEmisor;
     |PARA nCmpD = 11;  |SI nCmpD [ 41;  |HACIENDO nCmpD = nCmpD + 1;
           nCmpO = nCmpD - 11;

           #gecow003#nCmpD# = #gecow001#nCmpO#;
     |SIGUE;

     |PINTA #gecow003#11;

     |SI enMeteCentro = 0;
         |ACABA;
     |FINSI;

     nOk   = 0;
     eaTip = "E";
     |BUCLE gecom004Bw003;
     |BUCLE gecom052;

     |SI nOk = 1;
         |MENAV "0000Se han incluido centros a la factura, rev¡selos en el bot¢n C";
     |FINSI;
|FPRC;

|PROCESO MeteReceptor;
     |PARA nCmpD = 42;  |SI nCmpD [ 72;  |HACIENDO nCmpD = nCmpD + 1;
           nCmpO = nCmpD - 42;

           #gecow003#nCmpD# = #gecow001#nCmpO#;
     |SIGUE;

     #gecow003#109 = #gecow001#31;
     #gecow003#110 = #gecow001#32;

     |PINTA #gecow003#11;
     |PINTA #gecow003#110;

     |SI enMeteCentro = 0;
         |ACABA;
     |FINSI;

     nOk   = 0;
     eaTip = "R";
     |BUCLE gecom004Bw003;
     |BUCLE gecom052;

     |SI nOk = 1;
         |MENAV "0000Se han incluido centros a la factura, rev¡selos en el bot¢n C";
     |FINSI;
|FPRC;

|PROCESO T66C110w003;  |TIPO 66;
     |ABRE #gecom063;
     |SELECT #1#gecom063;
     #gecom063#0 = #gecow003#110;
     |LEE 000#gecom063.=;

     |CONSULTA_CLAVE #2#gecom063;
     |SI FSalida = 0;
         #gecow003#109 = #gecom063#0;
         #gecow003#110 = #gecom063#1;
     |FINSI;
     |CIERRA #gecom063;

     |PINTA #gecow003#110;
|FPRC;

|PROCESO T0C110w003;  |TIPO 0;
     |ABRE #gecom063;
     |SELECT #2#gecom063;
     #gecom063#1 = #gecow003#110;
     |LEE 000#gecom063.=;
     |SI FSalida ! 0;
         |MENAV "0000El punto de env¡o no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom063;

     #gecow003#109 = #gecom063#0;

     |ESTADO_CONTROL enBtnSuj,  "DISABLE";
     |SI #gecow003#110 = "FACeB2B                       ";
         |ESTADO_CONTROL enBtnSuj,  "ENABLE";
     |FINSI;
|FPRC;

|PROCESO T0C42w003;  |TIPO 0;
     |SI #gecow003#42 = "                              ";
         |MENAV "0000Debe introducir un emisor";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #gecow003#42 = aContenido;
         |ACABA;
     |FINSI;

     #gecom051#0 = #gecow003#42;
     |LEE 000#gecom051.=;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp51;  |HACIENDO nCmp = nCmp + 1;
           #gecow001#nCmp#  = #gecom051#nCmp#;
     |SIGUE;

     enMeteCentro = 1;
     |HAZ MeteReceptor;
|FPRC;

|PROCESO T7C42w003;  |TIPO 7;
     aContenido = Contenido;
|FPRC;

|PROCESO T0C11w003;  |TIPO 0;
     |SI #gecow003#11 = "                              ";
         |MENAV "0000Debe introducir un emisor";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #gecow003#11 = aContenido;
         |ACABA;
     |FINSI;

     #gecom051#0 = #gecow003#11;
     |LEE 000#gecom051.=;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp51;  |HACIENDO nCmp = nCmp + 1;
           #gecow001#nCmp#  = #gecom051#nCmp#;
     |SIGUE;

     enMeteCentro = 1;
     |HAZ MeteEmisor;
|FPRC;

|PROCESO T7C11w003;  |TIPO 7;
     aContenido = Contenido;
|FPRC;

|PROCESO T0C8w003;  |TIPO 0;
     |C_M #gecow003#9,  1, "S";
     |C_M #gecow003#10, 1, "S";
     |SI #gecow003#8 = "N";
         |C_M #gecow003#9,  1, "N";  #gecow003#9  = "01.01.0000";
         |C_M #gecow003#10, 1, "N";  #gecow003#10 = "01.01.0000";
     |FINSI;

     |PINTA #gecow003#9;
     |PINTA #gecow003#10;
|FPRC;

|PROCESO T0C3w003;  |TIPO 0;
     |C_M #gecow003#3, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = #gecow003#2;  |QBF aAlfa;
     aAlfa = aAlfa + #gecow003#3;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Introduzca contenido en la Serie o Factura";
         |POSICIONATE #gecow003#2;
         |ACABA;
     |FINSI;

     #gecow003#1 = aAlfa;

     |SELECT #1#gecom002;
     #gecom002#0 = #gecow003#0;
     #gecom002#1 = #gecow003#1;
     |LEE 000#gecom002.=;
     |SI FSalida = 0;
         |MENAV "0000La factura ya est  introducida";
         |POSICIONATE #gecow003#2;
     |FINSI;
     |SELECT #2#gecom002;
|FPRC;

|PROCESO T0C2w003;  |TIPO 0;
     |C_M #gecow003#2, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI FSalida = 1;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Evnt2;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecom002.=;

         |ESTADO_CONTROL enBtnMod3, "DISABLE";
         |ESTADO_CONTROL enBtnBor3, "DISABLE";
         |ESTADO_CONTROL enBtnEnv3, "DISABLE";
         |ESTADO_CONTROL enBtnAnu3, "DISABLE";
         |ESTADO_CONTROL enBtnRec3, "DISABLE";
         |ESTADO_CONTROL enBtnOpc3, "ENABLE";
         |ESTADO_CONTROL enBtnCon3, "ENABLE";

         |SI #gecom002#7 = "P ";  |O #gecom002#7 = "RP";
          |O #gecom002#7 = "X ";  |O #gecom002#7 = "RX";
             |ESTADO_CONTROL enBtnMod3, "ENABLE";
             |ESTADO_CONTROL enBtnBor3, "ENABLE";
             |ESTADO_CONTROL enBtnEnv3, "ENABLE";
         |FINSI;

         |SI #gecom002#7 = "E ";  |O #gecom002#7 = "RE";
             |ESTADO_CONTROL enBtnAnu3, "ENABLE";
             |ESTADO_CONTROL enBtnRec3, "ENABLE";
         |FINSI;

         |SI #gecom002#7 = "R ";  |O #gecom002#7 = "RR";
             |ESTADO_CONTROL enBtnBor3, "ENABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ BtnCon3;
     |FINSI;
|FPRC;

|PROCESO Baja2;
     #gecom002#7  = eaSit;
     #gecom002#0  = #gecom001#0;
     #gecom002#1  = "";
|FPRC;

|PROCESO Alta2;
     #gecom002#7  = eaSit;
     #gecom002#0  = #gecom001#0;
     #gecom002#1  = "Ñ" * 60;
|FPRC;

|PROCESO NuevoEmisor;
     |VENTANA 0501, 3599, -1, 16, "Nuevo emisor";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |C_M #gecow001#0,  1, "S";
     |C_M #gecow001#1,  1, "S";
     |C_M #gecow001#32, 1, "N";

     |DDEFECTO #gecow001;

     |PINPA #0#gecow001;
     |PINDA #0#gecow001;
     |ENDATOS #1#gecow001;
     |SI FSalida = 0;
         |PARA nCmp = 0;  |SI nCmp [ enTCmp51;  |HACIENDO nCmp = nCmp + 1;
               #gecom051#nCmp#  = #gecow001#nCmp#;
         |SIGUE;

         |GRABA 020#gecom051.n;
         |LIBERA #gecom051;

         |CONFI "0000El emisor tiene centros";
         |SI FSalida = 0;
             |VENTANA 0501, 3599, -1, 0, "";
             n2Vent = FSalida;

             |PTEC 802;  |PAUSA;

             eaIde = #gecow001#0;
             |SUB_EJECUTA "gecom052";

             |FINVENTANA n2Vent;
         |FINSI;

         enMeteCentro = 1;
         |HAZ MeteEmisor;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO EditaEmisor;
     |VENTANA 0501, 3599, -1, 16, "Datos del emisor en la factura";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |C_M #gecow001#0,  1, "N";
     |C_M #gecow001#1,  1, "N";
     |C_M #gecow001#32, 1, "N";

     |DDEFECTO #gecow001;

     |HAZ SacaEmisor;

     |PINPA #0#gecow001;
     |PINDA #0#gecow001;

     |SI enModo3 ! 4;
         |ENDATOS #1#gecow001;
         |SI FSalida = 0;
             enMeteCentro = 0;
             |HAZ MeteEmisor;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO CentrosEmisor;
     |VENTANA 0501, 3599, -1, 0, "";
     n2Vent = FSalida;

     |PTEC 802;  |PAUSA;

     eaIde = #gecow003#1;
     eaTip = "E";
     |SUB_EJECUTA "gecom004";

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO NuevoReceptor;
     |VENTANA 0501, 3599, -1, 16, "Nuevo receptor";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |C_M #gecow001#0,  1, "S";
     |C_M #gecow001#1,  1, "S";
     |C_M #gecow001#32, 1, "S";

     |DDEFECTO #gecow001;

     |PINPA #0#gecow001;
     |PINDA #0#gecow001;
     |ENDATOS #1#gecow001;
     |SI FSalida = 0;
         |PARA nCmp = 0;  |SI nCmp [ enTCmp51;  |HACIENDO nCmp = nCmp + 1;
               #gecom051#nCmp#  = #gecow001#nCmp#;
         |SIGUE;

         |GRABA 020#gecom051.n;
         |LIBERA #gecom051;

         |CONFI "0000El receptor tiene centros";
         |SI FSalida = 0;
             |VENTANA 0501, 3599, -1, 0, "";
             n2Vent = FSalida;

             |PTEC 802;  |PAUSA;

             eaIde = #gecow001#0;
             |SUB_EJECUTA "gecom052";

             |FINVENTANA n2Vent;
         |FINSI;

         enMeteCentro = 1;
         |HAZ MeteReceptor;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO EditaReceptor;
     |VENTANA 0501, 3599, -1, 16, "Datos del receptor en la factura";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |C_M #gecow001#0,  1, "N";
     |C_M #gecow001#1,  1, "N";
     |C_M #gecow001#32, 1, "S";

     |DDEFECTO #gecow001;

     |HAZ SacaReceptor;

     |PINPA #0#gecow001;
     |PINDA #0#gecow001;

     |SI enModo3 ! 4;
         |ENDATOS #1#gecow001;
         |SI FSalida = 0;
             enMeteCentro = 0;
             |HAZ MeteReceptor;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO CentrosReceptor;
     |VENTANA 0501, 3599, -1, 0, "";
     n2Vent = FSalida;

     |PTEC 802;  |PAUSA;

     eaIde = #gecow003#1;
     eaTip = "R";
     |SUB_EJECUTA "gecom004";

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO Evnt5;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecom005.=;

         |ESTADO_CONTROL enBtnAlt5, "ENABLE";
         |ESTADO_CONTROL enBtnMod5, "ENABLE";
         |ESTADO_CONTROL enBtnBor5, "ENABLE";
         |ESTADO_CONTROL enBtnCon5, "ENABLE";

         |SI enModo3 = 4;
             |ESTADO_CONTROL enBtnAlt5, "DISABLE";
             |ESTADO_CONTROL enBtnMod5, "DISABLE";
             |ESTADO_CONTROL enBtnBor5, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja5;
     #gecom005#0  = #gecow003#0;
     #gecom005#1  = #gecow003#1;
     #gecom005#2  = 0;
|FPRC;

|PROCESO Alta5;
     #gecom005#0  = #gecow003#0;
     #gecom005#1  = #gecow003#1;
     #gecom005#2  = 9999;
|FPRC;

|PROCESO AltDet;
     |HAZ AltDetalle;
     |HAZ Totalw003;
     |HAZ Pintaw003;
|FPRC;

|PROCESO ModDet;
     |HAZ ModDetalle;
     |HAZ Totalw003;
     |HAZ Pintaw003;
|FPRC;

|PROCESO ConDet;
     |HAZ ConDetalle;
|FPRC;

|PROCESO BorDet;
     |HAZ BorDetalle;
     |HAZ Totalw003;
     |HAZ Pintaw003;
|FPRC;

|PROCESO Baja10;
     #gecom010#0  = #gecow003#0;
     #gecom010#1  = #gecow003#1;
     #gecom010#2  = aTipo;
     #gecom010#3  = 1;
|FPRC;

|PROCESO Alta10;
     #gecom010#0  = #gecow003#0;
     #gecom010#1  = #gecow003#1;
     #gecom010#2  = aTipo;
     #gecom010#3  = 99;
|FPRC;

|PROCESO DtoCabecera;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |VENTANA 2701, 3599, nPan3, 1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     aTipo = "D";

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo3 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom010, nRango, 2802, 3498, Baja10, Alta10, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |SI enModo3 ! 4;
         |HAZ Totalw003;
         |HAZ Pintaw003;
     |FINSI;
|FPRC;

|PROCESO CarCabecera;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |VENTANA 2701, 3599, nPan3, 1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     aTipo = "C";

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo3 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom010, nRango, 2802, 3498, Baja10, Alta10, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |SI enModo3 ! 4;
         |HAZ Totalw003;
         |HAZ Pintaw003;
     |FINSI;
|FPRC;

|PROCESO Baja11;
     #gecom011#0  = #gecow003#0;
     #gecom011#1  = #gecow003#1;
     #gecom011#2  = 1;
|FPRC;

|PROCESO Alta11;
     #gecom011#0  = #gecow003#0;
     #gecom011#1  = #gecow003#1;
     #gecom011#2  = 99;
|FPRC;

|PROCESO Evnt11;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecom011.=;

         |ESTADO_CONTROL nBtnCon, "ENABLE";

         |SI enModo3 ! 4;
             |ESTADO_CONTROL nBtnMod, "ENABLE";
             |ESTADO_CONTROL nBtnBor, "ENABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ ConSuplido;
     |FINSI;
|FPRC;

|PROCESO AltSup;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ AltSuplido;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";

     |SI enModo3 ! 4;
         |HAZ Totalw003;
         |HAZ Pintaw003;
     |FINSI;
|FPRC;

|PROCESO ConSup;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ ConSuplido;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO ModSup;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ ModSuplido;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";

     |SI enModo3 ! 4;
         |HAZ Totalw003;
         |HAZ Pintaw003;
     |FINSI;
|FPRC;

|PROCESO BorSup;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ BorSuplido;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";

     |SI enModo3 ! 4;
         |HAZ Totalw003;
         |HAZ Pintaw003;
     |FINSI;
|FPRC;

|PROCESO SupCabecera;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |VENTANA 2701, 3699, nPan3, 1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 3488, 3498, AltSup;
     nBtnAlt = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Consulta", 3474, 3486, ConSup;
     nBtnCon = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 3462, 3472, ModSup;
     nBtnMod = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3450, 3460, BorSup;
     nBtnBor = FSalida;

     |ESTADO_CONTROL nBtnMod, "DISABLE";
     |ESTADO_CONTROL nBtnCon, "DISABLE";
     |ESTADO_CONTROL nBtnBor, "DISABLE";

     |SI enModo3 = 4;
         |ESTADO_CONTROL nBtnAlt, "DISABLE";
     |FINSI;

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#gecom011, nRango, 2802, 3398, Baja11, Alta11, Evnt11;
     enGrid11 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + enGrid11;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |SI enModo3 ! 4;
         |HAZ Totalw003;
         |HAZ Pintaw003;
     |FINSI;
|FPRC;

|PROCESO Baja12;
     #gecom012#0  = #gecow003#0;
     #gecom012#1  = #gecow003#1;
     #gecom012#2  = 1;
|FPRC;

|PROCESO Alta12;
     #gecom012#0  = #gecow003#0;
     #gecom012#1  = #gecow003#1;
     #gecom012#2  = 99;
|FPRC;

|PROCESO Evnt12;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecom012.=;

         |ESTADO_CONTROL nBtnCon, "ENABLE";

         |SI enModo3 ! 4;
             |ESTADO_CONTROL nBtnMod, "ENABLE";
             |ESTADO_CONTROL nBtnBor, "ENABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ ConAdjunto;
     |FINSI;
|FPRC;

|PROCESO AltAdj;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ AltAdjunto;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO ConAdj;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ ConAdjunto;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO ModAdj;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ ModAdjunto;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO BorAdj;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ BorAdjunto;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO AdjCabecera;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |VENTANA 2701, 3699, nPan3, 1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 3488, 3498, AltAdj;
     nBtnAlt = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Consulta", 3474, 3486, ConAdj;
     nBtnCon = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 3462, 3472, ModAdj;
     nBtnMod = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3450, 3460, BorAdj;
     nBtnBor = FSalida;

     |ESTADO_CONTROL nBtnMod, "DISABLE";
     |ESTADO_CONTROL nBtnCon, "DISABLE";
     |ESTADO_CONTROL nBtnBor, "DISABLE";

     |SI enModo3 = 4;
         |ESTADO_CONTROL nBtnAlt, "DISABLE";
     |FINSI;

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#gecom012, nRango, 2802, 3398, Baja12, Alta12, Evnt12;
     enGrid12 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + enGrid12;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO GloCabecera;
     |VENTANA 2701, 3699, nPan3, 1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     #gecow008#0 = #gecow003#96;
     #gecow008#1 = #gecow003#97;
     #gecow008#2 = #gecow003#105;

     |PINPA #0#gecow008;
     |PINDA #0#gecow008;

     |SI enModo3 ! 4;
         |ENDATOS #1#gecow008;
         |SI FSalida = 0;
             #gecow003#96  = #gecow008#0;
             #gecow003#97  = #gecow008#1;
             #gecow003#105 = #gecow008#2;

             |HAZ Totalw003;
             |HAZ Pintaw003;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO Baja13;
     #gecom013#0  = #gecow003#0;
     #gecom013#1  = #gecow003#1;
     #gecom013#2  = 1;
|FPRC;

|PROCESO Alta13;
     #gecom013#0  = #gecow003#0;
     #gecom013#1  = #gecow003#1;
     #gecom013#2  = 999;
|FPRC;

|PROCESO Evnt13;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#gecom013.=;

         |ESTADO_CONTROL nBtnCon, "ENABLE";

         |SI enModo3 ! 4;
             |ESTADO_CONTROL nBtnMod, "ENABLE";
             |ESTADO_CONTROL nBtnBor, "ENABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ ConLiteral;
     |FINSI;
|FPRC;

|PROCESO AltLit;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ AltLiteral;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO ConLit;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ ConLiteral;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO ModLit;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ ModLiteral;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO BorLit;
     |ESTADO_CONTROL nBtnAlt, "HIDE";
     |ESTADO_CONTROL nBtnMod, "HIDE";
     |ESTADO_CONTROL nBtnCon, "HIDE";
     |ESTADO_CONTROL nBtnBor, "HIDE";

     |HAZ BorLiteral;

     |ESTADO_CONTROL nBtnAlt, "SHOW";
     |ESTADO_CONTROL nBtnMod, "SHOW";
     |ESTADO_CONTROL nBtnCon, "SHOW";
     |ESTADO_CONTROL nBtnBor, "SHOW";
|FPRC;

|PROCESO LitCabecera;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |VENTANA 2701, 3699, nPan3, 1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 3488, 3498, AltLit;
     nBtnAlt = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Consulta", 3474, 3486, ConLit;
     nBtnCon = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 3462, 3472, ModLit;
     nBtnMod = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3450, 3460, BorLit;
     nBtnBor = FSalida;

     |ESTADO_CONTROL nBtnMod, "DISABLE";
     |ESTADO_CONTROL nBtnCon, "DISABLE";
     |ESTADO_CONTROL nBtnBor, "DISABLE";

     |SI enModo3 = 4;
         |ESTADO_CONTROL nBtnAlt, "DISABLE";
     |FINSI;

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#gecom013, nRango, 2802, 3398, Baja13, Alta13, Evnt13;
     enGrid13 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + enGrid13;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO SujetaCto;
     |VENTANA 0501, 1099, -1, 16, "Factura sujeta a contrato";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow013;

     |DDEFECTO #gecow013;

     #gecow013#0 = #gecow003#111;
     #gecow013#1 = #gecow003#112;

     |PINDA #0#gecow013;
     |SI enModo3 = 2;
         |ENDATOS #1#gecow013;
         |SI FSalida = 0;
             #gecow003#111 = #gecow013#0;
             #gecow003#112 = #gecow013#1;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO DibujaFactura;
     |CONTROL_SIMPLE nPan3, "BOTON,+", 0854, 0856, NuevoEmisor;   nBtnMasEmi = FSalida;
     |CONTROL_SIMPLE nPan3, "BOTON,E", 0858, 0860, EditaEmisor;
     |CONTROL_SIMPLE nPan3, "BOTON,C", 0862, 0864, CentrosEmisor;

     |CONTROL_SIMPLE nPan3, "BOTON,+", 0886, 0888, NuevoReceptor; nBtnMasRec = FSalida;
     |CONTROL_SIMPLE nPan3, "BOTON,E", 0890, 0892, EditaReceptor;
     |CONTROL_SIMPLE nPan3, "BOTON,C", 0894, 0896, CentrosReceptor;

     |CONTROL_SIMPLE nPan3, "BOTON,Descuentos", 2713, 2723, DtoCabecera;
     |CONTROL_SIMPLE nPan3, "BOTON,Suplidos", 2725, 2733, SupCabecera;
     |CONTROL_SIMPLE nPan3, "BOTON,Cargos", 2735, 2742, CarCabecera;
     |CONTROL_SIMPLE nPan3, "BOTON,Adjuntos", 2744, 2752, AdjCabecera;
     |CONTROL_SIMPLE nPan3, "BOTON,Datos de pago", 2754, 2766, PagCabecera;
     |CONTROL_SIMPLE nPan3, "BOTON,Retenci¢n global", 2768, 2782, GloCabecera;
     |CONTROL_SIMPLE nPan3, "BOTON,Literales legales", 2784, 2797, LitCabecera;

     |CONTROL_SIMPLE nPan3, "BOTON,Pulse si est  sujeta a contrato", 1172, 1198, SujetaCto;
     enBtnSuj = FSalida;

     |CONTROL_SIMPLE nPan3, "BOTON,{{193}}Alta", 2488, 2498, AltDet;
     enBtnAlt5  = FSalida;

     |CONTROL_SIMPLE nPan3, "BOTON,{{197}}Consulta", 2474, 2486, ConDet;
     enBtnCon5  = FSalida;

     |CONTROL_SIMPLE nPan3, "BOTON,{{197}}Modificar", 2462, 2472, ModDet;
     enBtnMod5 = FSalida;

     |CONTROL_SIMPLE nPan3, "BOTON,{{199}}Borrar", 2450, 2460, BorDet;
     enBtnBor5 = FSalida;

     |ESTADO_CONTROL enBtnCon5, "DISABLE";
     |ESTADO_CONTROL enBtnMod5, "DISABLE";
     |ESTADO_CONTROL enBtnBor5, "DISABLE";
     |ESTADO_CONTROL enBtnSuj,  "DISABLE";

     |SI #gecom003#110 = "FACeB2B                       ";
         |ESTADO_CONTROL enBtnSuj,  "ENABLE";
     |FINSI;

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#gecom005, nRango, 1302, 2398, Baja5, Alta5, Evnt5;
     enGrid5 = FSalida;

     |SI enModo3 = 4;
         |ESTADO_CONTROL nBtnMasEmi, "DISABLE";
         |ESTADO_CONTROL nBtnMasRec, "DISABLE";
         |ESTADO_CONTROL enBtnAlt5,  "DISABLE";
     |FINSI;
|FPRC;

|PROCESO NuevaFactura;
     enModo3 = 1;

     |VENTANA 0501, 3799, -1, 16, "Nueva facturae";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |C_M #gecow003#2, 1, "S";
     |C_M #gecow003#3, 1, "S";

     |PINPA #0#gecow003;  nPan3 = FSalida;
     |HAZ DibujaFactura;

     |DDEFECTO #gecow003;

     #gecow003#0 = #gecom001#0;

     |PINDA #0#gecow003;
     |ENDATOS #1#gecow003;
     |SI FSalida = 0;
         |PARA nCmp = 0;  |SI nCmp [ enTCmp3;  |HACIENDO nCmp = nCmp + 1;
               #gecom003#nCmp#  = #gecow003#nCmp#;
         |SIGUE;

         |GRABA 020#gecom003.n;
         |LIBERA #gecom003;

         #gecom002#0  = #gecom003#0;
         #gecom002#1  = #gecom003#1;
         #gecom002#2  = #gecom003#4;
         #gecom002#3  = #gecom003#20;
         #gecom002#4  = #gecom003#51;
         #gecom002#5  = #gecom003#108;
         #gecom002#7  = "P";

         aAlfa = #gecom003#15;  |QBF aAlfa;
         |SI aAlfa ! "";
             #gecom002#3  = aAlfa;
         |FINSI;

         aAlfa = #gecom003#46;  |QBF aAlfa;
         |SI aAlfa ! "";
             #gecom002#4  = aAlfa;
         |FINSI;

         |ABRE #gecom500;
         |LEE 000#gecom500.u;
         |SI FSalida ! 0;  |DDEFECTO #gecom500;  |FINSI;
         |CIERRA #gecom500;

         #gecom002#6  = #gecom500#0;
         #gecom002#8  = #gecom003#110;

         |GRABA 020#gecom002.n;
         |LIBERA #gecom002;

         eaCmp0  = #gecom002#0;
         eaCmp1  = #gecom002#1;
         eaCmp4  = "Alta factura";
         eaCmp5  = #gecom002#7;
         eaCmp7  = "";
         eaCmp8  = "";
         eaCmp9  = "";
         eaCmp10 = Usuario % 810;
         |HAZ GrabaLog;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL enGrid2;
     |FOCOTECLADO enGrid2;
|FPRC;

|PROCESO PantaRecti;
     |LEE 101#gecom002.=;

     |VENTANA 0501, 2399, -1, 16, "Motivo de la rectificaci¢n";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow010;

     |DDEFECTO #gecow010;

     |ABRE #gecom065;
     #gecom065#0 = #gecom002#14;
     |LEE 000#gecom065.=;
     |CIERRA #gecom065;

     |ABRE #gecom064;
     #gecom064#0 = #gecom002#15;
     |LEE 000#gecom064.=;
     |CIERRA #gecom064;

     #gecow010#0 = #gecom002#14;
     #gecow010#1 = #gecom065#1;
     #gecow010#2 = #gecom002#15;
     #gecow010#3 = #gecom064#1;

     |PINDA #0#gecow010;
     |SI enModo3 = 2;
         |ENDATOS #1#gecow010;
         |SI FSalida = 0;
             #gecom002#14 = #gecow010#0;
             #gecom002#15 = #gecow010#2;

             |GRABA 020#gecom002.a;
             |LIBERA #gecom002;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO ConsOriginal;
     |SI #gecom002#7 = "RP";  |O #gecom002#7 = "RX";
      |O #gecom002#7 = "RE";  |O #gecom002#7 = "RA";
         #gecom003#0 = #gecom002#0;
         #gecom003#1 = #gecom002#13;
         |LEE 000#gecom003.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |VENTANA 0501, 3799, -1, 16, "Consulta facturae";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow003;  nPan3 = FSalida;
     |HAZ DibujaFactura;

     |DDEFECTO #gecow003;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp3;  |HACIENDO nCmp = nCmp + 1;
           #gecow003#nCmp#  = #gecom003#nCmp#;
     |SIGUE;

     |PINDA #0#gecow003;
     |PAUSA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO ConsRectificada;
     |HAZ PantaRecti;

     |VENTANA 0501, 3799, -1, 16, "Consulta facturae";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow003;  nPan3 = FSalida;
     |HAZ DibujaFactura;

     |DDEFECTO #gecow003;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp3;  |HACIENDO nCmp = nCmp + 1;
           #gecow003#nCmp#  = #gecom003#nCmp#;
     |SIGUE;

     |PINDA #0#gecow003;
     |PAUSA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO BtnCon3;
     #gecom003#0 = #gecom002#0;
     #gecom003#1 = #gecom002#1;
     |LEE 000#gecom003.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enModo3 = 4;

     |SI #gecom002#7 = "RP";  |O #gecom002#7 = "RX";
      |O #gecom002#7 = "RE";  |O #gecom002#7 = "RA";
         aPopup1  = enBtnCon3;
         aPopup2  = 2;
         aPopup3  = "Factura rectificada";
         aPopup4  = "Factura original";

         IaPopup  = aPopup1  <-;
         |ESPECIFICA "TRACKPOPUP", aPopup;
         |SI FSalida ! 0;
             |SI FSalida = 1;  |HAZ ConsRectificada;     |FINSI;
             |SI FSalida = 2;  |HAZ ConsOriginal;        |FINSI;
         |FINSI;
     |SINO;
         |HAZ ConsOriginal;
     |FINSI;

     |FOCOTECLADO enGrid2;
|FPRC;

|PROCESO BtnMod3;
     #gecom003#0 = #gecom002#0;
     #gecom003#1 = #gecom002#1;
     |LEE 101#gecom003.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enModo3 = 2;

     |SI #gecom002#7 = "RP";
         |HAZ PantaRecti;
     |FINSI;

     |VENTANA 0501, 3799, -1, 16, "Modificaci¢n facturae";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |C_M #gecow003#2, 1, "N";
     |C_M #gecow003#3, 1, "N";

     |PINPA #0#gecow003;  nPan3 = FSalida;
     |HAZ DibujaFactura;

     |DDEFECTO #gecow003;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp3;  |HACIENDO nCmp = nCmp + 1;
           #gecow003#nCmp#  = #gecom003#nCmp#;
     |SIGUE;

     |PINDA #0#gecow003;
     |ENDATOS #1#gecow003;
     |SI FSalida = 0;
         |PARA nCmp = 0;  |SI nCmp [ enTCmp3;  |HACIENDO nCmp = nCmp + 1;
               #gecom003#nCmp#  = #gecow003#nCmp#;
         |SIGUE;

         |GRABA 020#gecom003.a;
         |LIBERA #gecom003;

         |LEE 101#gecom002.=;
         |SI FSalida = 0;
             #gecom002#0  = #gecom003#0;
             #gecom002#1  = #gecom003#1;
             #gecom002#2  = #gecom003#4;
             #gecom002#3  = #gecom003#20;
             #gecom002#4  = #gecom003#51;
             #gecom002#5  = #gecom003#108;

             aAlfa = #gecom003#15;  |QBF aAlfa;
             |SI aAlfa ! "";
                 #gecom002#3  = aAlfa;
             |FINSI;

             aAlfa = #gecom003#46;  |QBF aAlfa;
             |SI aAlfa ! "";
                 #gecom002#4  = aAlfa;
             |FINSI;

             #gecom002#8  = #gecom003#110;

             |GRABA 020#gecom002.a;
             |LIBERA #gecom002;

             eaCmp0  = #gecom002#0;
             eaCmp1  = #gecom002#1;
             eaCmp4  = "Modificaci¢n factura";
             eaCmp5  = #gecom002#7;
             eaCmp7  = "";
             eaCmp8  = "";
             eaCmp9  = "";
             eaCmp10 = Usuario % 810;
             |HAZ GrabaLog;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL enGrid2;
     |FOCOTECLADO enGrid2;
|FPRC;

|PROCESO gecom004B;
     |BORRA 020#gecom004.a;
     |LIBERA #gecom004;
|FPRC;

|DEFBUCLE gecom004B;
     #gecom004#1;
     ;
     #gecom002#0, #gecom002#1, " ", "                              ";
     #gecom002#0, #gecom002#1, "z", "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, gecom004B;
|FIN;

|PROCESO gecom010B;
     |BORRA 020#gecom010.a;
     |LIBERA #gecom010;
|FPRC;

|DEFBUCLE gecom010B;
     #gecom010#1;
     ;
     #gecom002#0, #gecom002#1, " ", 00;
     #gecom002#0, #gecom002#1, "z", 99;
     be;
     NULL, gecom010B;
|FIN;

|PROCESO gecom011B;
     |BORRA 020#gecom011.a;
     |LIBERA #gecom011;
|FPRC;

|DEFBUCLE gecom011B;
     #gecom011#1;
     ;
     #gecom002#0, #gecom002#1, 00;
     #gecom002#0, #gecom002#1, 99;
     be;
     NULL, gecom011B;
|FIN;

|PROCESO gecom012B;
     aFic  = eaPathAdj + (("00000" + #gecom012#0) % -105);
     aFic  = aFic + #gecom012#1;  |QBF aFic;
     aFic  = aFic + (("00" + #gecom012#2) % -102);
     aFic  = aFic + "." + #gecom012#3;   |QBF aFic;
     |FBORRA aFic;

     aFic  = eaPathAdj + (("00000" + #gecom012#0) % -105);
     aFic  = aFic + #gecom012#1;  |QBF aFic;
     aFic  = aFic + (("00" + #gecom012#2) % -102);
     aFic  = aFic + ".b64";
     |FBORRA aFic;

     |BORRA 020#gecom012.a;
     |LIBERA #gecom012;
|FPRC;

|DEFBUCLE gecom012B;
     #gecom012#1;
     ;
     #gecom002#0, #gecom002#1, 00;
     #gecom002#0, #gecom002#1, 99;
     be;
     NULL, gecom012B;
|FIN;

|PROCESO gecom013B;
     |BORRA 020#gecom013.a;
     |LIBERA #gecom013;
|FPRC;

|DEFBUCLE gecom013B;
     #gecom013#1;
     ;
     #gecom002#0, #gecom002#1, 001;
     #gecom002#0, #gecom002#1, 999;
     be;
     NULL, gecom013B;
|FIN;

|PROCESO BtnBor3;
     |CONFI "0000NEst  seguro que quiere borrar la factura seleccionada";
     |SI FSalida ! 0;
         |FOCOTECLADO enGrid2;
         |ACABA;
     |FINSI;

     |LEE 101#gecom002.=;
     |SI FSalida ! 0;
         |FOCOTECLADO enGrid2;
         |ACABA;
     |FINSI;

     |HAZ BorraTodoDetalle;

     |BUCLE gecom004B;
     |BUCLE gecom010B;
     |BUCLE gecom011B;
     |BUCLE gecom012B;
     |BUCLE gecom013B;

     #gecom003#0 = #gecom002#0;
     #gecom003#1 = #gecom002#1;
     |LEE 101#gecom003.=;
     |SI FSalida = 0;
         |BORRA 020#gecom003.a;
         |LIBERA #gecom003;
     |FINSI;

     |BORRA 020#gecom002.a;
     |LIBERA #gecom002;

     aAlfa = #gecom002#19;  |QBF aAlfa;
     |SI aAlfa ! "";
         |DBASE aAlfa;
         aAlfa = aAlfa + "documentos";
         aAlfa = aAlfa + "/importacion";
         |SI #gecom002#7 = "R ";  |O #gecom002#7 = "RR";
             aAlfa = aAlfa + "/recibidas";
             aAlfa = aAlfa + "/" + (("00000" + #gecom001#0) % -105);
             aAlfa = aAlfa + "/recogidas/";
             aAlfa = aAlfa + #gecom002#19;  |QBF aAlfa;
         |SINO;
             aAlfa = aAlfa + "/emitidas";
             aAlfa = aAlfa + "/" + (("00000" + #gecom001#0) % -105);
             aAlfa = aAlfa + "/recogidas/";
             aAlfa = aAlfa + #gecom002#19;  |QBF aAlfa;
         |FINSI;

         |FBORRA aAlfa;
     |FINSI;

     |ESTADO_CONTROL enBtnCon5, "DISABLE";
     |ESTADO_CONTROL enBtnMod5, "DISABLE";
     |ESTADO_CONTROL enBtnBor5, "DISABLE";

     |REFRESCACONTROL enGrid2;
     |FOCOTECLADO enGrid2;
|FPRC;

|PROCESO BorraRestos;
     #gecom002#0 = enEmp;
     #gecom002#1 = eaIde;

     |HAZ BorraTodoDetalle;

     |BUCLE gecom004B;
     |BUCLE gecom010B;
     |BUCLE gecom011B;
     |BUCLE gecom012B;
     |BUCLE gecom013B;

     #gecom003#0 = #gecom002#0;
     #gecom003#1 = #gecom002#1;
     |LEE 101#gecom003.=;
     |SI FSalida = 0;
         |BORRA 020#gecom003.a;
         |LIBERA #gecom003;
     |FINSI;

     #gecom002#0 = enEmp;
     #gecom002#1 = eaIde;
     |LEE 101#gecom002.=;
     |SI FSalida = 0;
         |BORRA 020#gecom002.a;
         |LIBERA #gecom002;
     |FINSI;
|FPRC;
