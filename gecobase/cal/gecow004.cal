|FICHEROS;
     gecow003;
     gecow004,MANTE;

     gecom002;
     gecom005;
     gecom006,MANTE;
     gecom007,MANTE;
     gecom008,MANTE;
     gecom009,MANTE;

     gecom056;
     gecom057;
     gecom062;
|FIN;

|VARIABLES;
     n2Vent              = 0;
     n3Vent              = 0;
     nPan4               = -1;
     nCmp                = 0;
     nCmpO               = 0;
     nCmpD               = 0;
     nOk                 = 0;
     nRango              = 0;
     nId                 = 0;

     aAlfa               = "";
     aContenido          = "";
     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aLong               = "";
     aCarac              = "";
     aTexto              = "";
     aQQ                 = "";
     aTipo               = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     {-1}sTree           = 0;
         sT_nID          = 0;
         sT_nOper        = 0;
         sT_aData        = "";

     &enGrid2            = 0;
     &enGrid5            = 0;
     &enModo5            = 0;
     &enEmp              = 0;
     &enTCmp5            = 0;
     &enMeteCentro       = 0;
     &eaIde              = "";
     &eaTip              = "";
     &eaSit              = "";
     &eaUnidadBasico     = "";
|FIN;

|| -------------------------------------------------------------------------

|PROCESO CargaArtPanta;
     #gecow004#52 = #gecow004#3  % 150;
     #gecow004#53 = #gecow004#3  % 5150;
     #gecow004#54 = #gecow004#3  % 10150;
     #gecow004#55 = #gecow004#3  % 15150;
     #gecow004#56 = #gecow004#3  % 20150;

     #gecow004#57 = #gecow004#43 % 150;
     #gecow004#58 = #gecow004#43 % 5150;
     #gecow004#59 = #gecow004#43 % 10150;
     #gecow004#60 = #gecow004#43 % 15150;
     #gecow004#61 = #gecow004#43 % 20150;

     #gecow004#62 = #gecow004#44 % 150;
     #gecow004#63 = #gecow004#44 % 5150;
     #gecow004#64 = #gecow004#44 % 10150;
     #gecow004#65 = #gecow004#44 % 15150;
     #gecow004#66 = #gecow004#44 % 20150;

     #gecow004#67 = #gecow004#45 % 150;
     #gecow004#68 = #gecow004#45 % 5150;
     #gecow004#69 = #gecow004#45 % 10150;
     #gecow004#70 = #gecow004#45 % 15150;
     #gecow004#71 = #gecow004#45 % 20150;

     #gecow004#72 = #gecow004#46 % 150;
     #gecow004#73 = #gecow004#46 % 5150;
     #gecow004#74 = #gecow004#46 % 10150;
     #gecow004#75 = #gecow004#46 % 15150;
     #gecow004#76 = #gecow004#46 % 20150;

     #gecow004#77 = #gecow004#47 % 150;
     #gecow004#78 = #gecow004#47 % 5150;
     #gecow004#79 = #gecow004#47 % 10150;
     #gecow004#80 = #gecow004#47 % 15150;
     #gecow004#81 = #gecow004#47 % 20150;

     #gecow004#82 = #gecow004#48 % 150;
     #gecow004#83 = #gecow004#48 % 5150;
     #gecow004#84 = #gecow004#48 % 10150;
     #gecow004#85 = #gecow004#48 % 15150;
     #gecow004#86 = #gecow004#48 % 20150;

     #gecow004#87 = #gecow004#49 % 150;
     #gecow004#88 = #gecow004#49 % 5150;
     #gecow004#89 = #gecow004#49 % 10150;
     #gecow004#90 = #gecow004#49 % 15150;
     #gecow004#91 = #gecow004#49 % 20150;

     #gecow004#92 = #gecow004#50 % 150;
     #gecow004#93 = #gecow004#50 % 5150;
     #gecow004#94 = #gecow004#50 % 10150;
     #gecow004#95 = #gecow004#50 % 15150;
     #gecow004#96 = #gecow004#50 % 20150;

     #gecow004#97  = #gecow004#51 % 150;
     #gecow004#98  = #gecow004#51 % 5150;
     #gecow004#99  = #gecow004#51 % 10150;
     #gecow004#100 = #gecow004#51 % 15150;
     #gecow004#101 = #gecow004#51 % 20150;
|FPRC;

|PROCESO DescargaArtPanta;
     #gecow004#3  = #gecow004#052 + #gecow004#053 + #gecow004#054 + #gecow004#055 + #gecow004#056;
     #gecow004#43 = #gecow004#057 + #gecow004#058 + #gecow004#059 + #gecow004#060 + #gecow004#061;
     #gecow004#44 = #gecow004#062 + #gecow004#063 + #gecow004#064 + #gecow004#065 + #gecow004#066;
     #gecow004#45 = #gecow004#067 + #gecow004#068 + #gecow004#069 + #gecow004#070 + #gecow004#071;
     #gecow004#46 = #gecow004#072 + #gecow004#073 + #gecow004#074 + #gecow004#075 + #gecow004#076;
     #gecow004#47 = #gecow004#077 + #gecow004#078 + #gecow004#079 + #gecow004#080 + #gecow004#081;
     #gecow004#48 = #gecow004#082 + #gecow004#083 + #gecow004#084 + #gecow004#085 + #gecow004#086;
     #gecow004#49 = #gecow004#087 + #gecow004#088 + #gecow004#089 + #gecow004#090 + #gecow004#091;
     #gecow004#50 = #gecow004#092 + #gecow004#093 + #gecow004#094 + #gecow004#095 + #gecow004#096;
     #gecow004#51 = #gecow004#097 + #gecow004#098 + #gecow004#099 + #gecow004#100 + #gecow004#101;
|FPRC;

|PROCESO T7C6m008;  |TIPO 7;
     |SI #gecom008#5 ! 0;
         #gecom008#6 = #gecow004#8 % #gecom008#5;
     |FINSI;

     |PINTA #gecom008#6;
|FPRC;

|PROCESO T66C4m008;  |TIPO 66;
     |ABRE #gecom057;
     |SELECT #2#gecom057;
     #gecom057#1 = #gecom008#4;
     |LEE 000#gecom057.=;

     |CONSULTA_CLAVE #1#gecom057;
     |SI FSalida = 0;
         #gecom008#4 = #gecom057#1;
         #gecom008#7 = #gecom057#0;
     |FINSI;
     |CIERRA #gecom057;

     |PINTA #gecom008#4;
|FPRC;

|PROCESO T0C4m008;  |TIPO 0;
     |ABRE #gecom057;
     |SELECT #2#gecom057;
     #gecom057#1 = #gecom008#4;
     |LEE 000#gecom057.=;
     |SI FSalida ! 0;
         |MENAV "0000El impuesto introducido no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom057;

     #gecom008#7 = #gecom057#0;
|FPRC;

|| -------------------------------------------------------------------------

|PROCESO T7C8m007;  |TIPO 7;
     |SI #gecom007#7 ! 0;
         #gecom007#8 = #gecow004#8 % #gecom007#7;
     |FINSI;

     |PINTA #gecom007#8;
|FPRC;

|PROCESO T7C6m007;  |TIPO 7;
     |SI #gecom007#5 ! 0;
         #gecom007#6 = #gecow004#8 % #gecom007#5;
     |FINSI;

     |PINTA #gecom007#6;
|FPRC;

|PROCESO T66C4m007;  |TIPO 66;
     |ABRE #gecom057;
     |SELECT #2#gecom057;
     #gecom057#1 = #gecom007#4;
     |LEE 000#gecom057.=;

     |CONSULTA_CLAVE #1#gecom057;
     |SI FSalida = 0;
         #gecom007#4  = #gecom057#1;
         #gecom007#11 = #gecom057#0;
     |FINSI;
     |CIERRA #gecom057;

     |PINTA #gecom007#4;
|FPRC;

|PROCESO T0C4m007;  |TIPO 0;
     |ABRE #gecom057;
     |SELECT #2#gecom057;
     #gecom057#1 = #gecom007#4;
     |LEE 000#gecom057.=;
     |SI FSalida ! 0;
         |MENAV "0000El impuesto introducido no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom057;

     #gecom007#11 = #gecom057#0;
|FPRC;

|| -------------------------------------------------------------------------

|PROCESO T7C7m006;  |TIPO 7;
     |SI #gecom006#6 ! 0;
         #gecom006#7 = #gecow004#7 % #gecom006#6;
     |FINSI;

     |PINTA #gecom006#7;
|FPRC;

|| -------------------------------------------------------------------------

|PROCESO gecom006Tot;
     |SI #gecom006#6 ! 0;
         #gecom006#7 = #gecow004#7 % #gecom006#6;
     |FINSI;

     |GRABA 020#gecom006.a;
     |LIBERA #gecom006;

     |SI #gecom006#3 = "C";
         #gecow004#8 = #gecow004#8 + #gecom006#7;
     |FINSI;

     |SI #gecom006#3 = "D";
         #gecow004#8 = #gecow004#8 - #gecom006#7;
     |FINSI;
|FPRC;

|DEFBUCLE gecom006Tot;
     #gecom006#1;
     ;
     #gecow004#0, #gecow004#1, #gecow004#2, " ", 01;
     #gecow004#0, #gecow004#1, #gecow004#2, "z", 99;
     be;
     NULL, gecom006Tot;
|FIN;

|PROCESO gecom007Tot;
     |SI #gecom007#5 ! 0;
         #gecom007#6 = #gecow004#8 % #gecom007#5;
     |FINSI;

     |SI #gecom007#7 ! 0;
         #gecom007#8 = #gecow004#8 % #gecom007#7;
     |FINSI;

     |GRABA 020#gecom007.a;
     |LIBERA #gecom007;

     #gecow004#9 = #gecow004#9 + (#gecom007#6 + #gecom007#8);
|FPRC;

|DEFBUCLE gecom007Tot;
     #gecom007#1;
     ;
     #gecow004#0, #gecow004#1, #gecow004#2, 01;
     #gecow004#0, #gecow004#1, #gecow004#2, 99;
     be;
     NULL, gecom007Tot;
|FIN;

|PROCESO gecom008Tot;
     |SI #gecom008#5 ! 0;
         #gecom008#6 = #gecow004#8 % #gecom008#5;
     |FINSI;

     |GRABA 020#gecom008.a;
     |LIBERA #gecom008;

     #gecow004#10 = #gecow004#10 + #gecom008#6;
|FPRC;

|DEFBUCLE gecom008Tot;
     #gecom008#1;
     ;
     #gecow004#0, #gecow004#1, #gecow004#2, 01;
     #gecow004#0, #gecow004#1, #gecow004#2, 99;
     be;
     NULL, gecom008Tot;
|FIN;

|PROCESO Pintaw004;
     |PINTA #gecow004#7;
     |PINTA #gecow004#8;
     |PINTA #gecow004#9;
     |PINTA #gecow004#10;
     |PINTA #gecow004#11;
|FPRC;

|PROCESO Totalw004;
     #gecow004#7 = #gecow004#4 * #gecow004#6;

     #gecow004#8 = #gecow004#7;
     |BUCLE gecom006Tot;

     #gecow004#9 = 0;
     |BUCLE gecom007Tot;

     #gecow004#10 = 0;
     |BUCLE gecom008Tot;

     #gecow004#11 = #gecow004#8 + #gecow004#9 - #gecow004#10;
|FPRC;

|PROCESO T12w004;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     |SI #gecow004#4 = 0;
/*
         |MENAV "0000Contenido obligatorio en el campo Cantidad";
         |POSICIONATE #gecow004#4;
         |ERROR;
         |ACABA;
*/
     |FINSI;

     |SI #gecow004#6 = 0;
/*
         |MENAV "0000Contenido obligatorio en el campo Importe unitario";
         |POSICIONATE #gecow004#6;
         |ERROR;
         |ACABA;
*/
     |FINSI;

     #gecom007#0  = #gecow004#0;
     #gecom007#1  = #gecow004#1;
     #gecom007#2  = #gecow004#2;
     #gecom007#3  = 1;
     |LEE 000#gecom007.];
     |SI FSalida ! 0;  |O #gecom007#0 ! #gecow004#0;
                       |O #gecom007#1 ! #gecow004#1;
                       |O #gecom007#2 ! #gecow004#2;
         |MENAV "0000Debe introducir Impuestos repercutidos";
         |POSICIONATE #gecow004#4;
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T66C39w004;  |TIPO 66;
     |ABRE #gecom062;
     |SELECT #2#gecom062;
     #gecom062#1 = #gecow004#39;
     |LEE 000#gecom062.=;

     |CONSULTA_CLAVE #1#gecom062;
     |SI FSalida = 0;
         #gecow004#39 = #gecom062#1;
         #gecow004#42 = #gecom062#0;
     |FINSI;
     |CIERRA #gecom062;

     |PINTA #gecow004#39;
|FPRC;

|PROCESO T0C39w004;  |TIPO 0;
     |ABRE #gecom062;
     |SELECT #2#gecom062;
     #gecom062#1 = #gecow004#39;
     |LEE 000#gecom062.=;
     |SI FSalida ! 0;
         |MENAV "0000La medida introducida no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom062;

     #gecow004#42 = #gecom062#0;
|FPRC;

|PROCESO T0Combow004;  |TIPO 0;
     |C_M #gecow004#24,  1, "S";
     |C_M #gecow004#27,  1, "S";
     |C_M #gecow004#30,  1, "S";
     |C_M #gecow004#33,  1, "S";
     |C_M #gecow004#36,  1, "S";

     |SI #gecow004#23 = "N";
         |C_M #gecow004#24,  1, "N";  #gecow004#24  = "01.01.0000";
     |FINSI;

     |SI #gecow004#26 = "N";
         |C_M #gecow004#27,  1, "N";  #gecow004#27  = "01.01.0000";
     |FINSI;

     |SI #gecow004#29 = "N";
         |C_M #gecow004#30,  1, "N";  #gecow004#30  = "01.01.0000";
     |FINSI;

     |SI #gecow004#32 = "N";
         |C_M #gecow004#33,  1, "N";  #gecow004#33  = "01.01.0000";
     |FINSI;

     |SI #gecow004#35 = "N";
         |C_M #gecow004#36,  1, "N";  #gecow004#36  = "01.01.0000";
     |FINSI;

     |PINTA #gecow004#24;
     |PINTA #gecow004#27;
     |PINTA #gecow004#30;
     |PINTA #gecow004#33;
     |PINTA #gecow004#36;
|FPRC;

|PROCESO T66C5w004;  |TIPO 66;
     |ABRE #gecom056;
     |SELECT #2#gecom056;
     #gecom056#1 = #gecow004#5;
     |LEE 000#gecom056.=;

     |CONSULTA_CLAVE #1#gecom056;
     |SI FSalida = 0;
         #gecow004#5  = #gecom056#1;
         #gecow004#41 = #gecom056#0;
     |FINSI;
     |CIERRA #gecom056;

     |PINTA #gecow004#5;
|FPRC;

|PROCESO T0C5w004;  |TIPO 0;
     |ABRE #gecom056;
     |SELECT #2#gecom056;
     #gecom056#1 = #gecow004#5;
     |LEE 000#gecom056.=;
     |SI FSalida ! 0;
         |MENAV "0000La medida introducida no existe.";
         |ERROR;
     |FINSI;
     |CIERRA #gecom056;

     #gecow004#41 = #gecom056#0;
|FPRC;

|PROCESO Baja6;
     #gecom006#0  = #gecow004#0;
     #gecom006#1  = #gecow004#1;
     #gecom006#2  = #gecow004#2;
     #gecom006#3  = aTipo;
     #gecom006#4  = 1;
|FPRC;

|PROCESO Alta6;
     #gecom006#0  = #gecow004#0;
     #gecom006#1  = #gecow004#1;
     #gecom006#2  = #gecow004#2;
     #gecom006#3  = aTipo;
     #gecom006#4  = 99;
|FPRC;

|PROCESO DtoDetalle;
     |VENTANA 1302, 2098, -1, -1, "";
     n3Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     aTipo = "D";

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo5 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom006, nRango, 1302, 2398, Baja6, Alta6, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n3Vent;

     |HAZ Totalw004;
     |HAZ Pintaw004;
|FPRC;

|PROCESO CarDetalle;
     |VENTANA 1302, 2098, -1, -1, "";
     n3Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     aTipo = "C";

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo5 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom006, nRango, 1302, 2398, Baja6, Alta6, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n3Vent;

     |HAZ Totalw004;
     |HAZ Pintaw004;
|FPRC;

|PROCESO Baja7;
     #gecom007#0  = #gecow004#0;
     #gecom007#1  = #gecow004#1;
     #gecom007#2  = #gecow004#2;
     #gecom007#3  = 1;
|FPRC;

|PROCESO Alta7;
     #gecom007#0  = #gecow004#0;
     #gecom007#1  = #gecow004#1;
     #gecom007#2  = #gecow004#2;
     #gecom007#3  = 99;
|FPRC;

|PROCESO RepDetalle;
     |VENTANA 1302, 2098, -1, -1, "";
     n3Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo5 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom007, nRango, 1302, 2398, Baja7, Alta7, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n3Vent;

     |HAZ Totalw004;
     |HAZ Pintaw004;
|FPRC;

|PROCESO Baja8;
     #gecom008#0  = #gecow004#0;
     #gecom008#1  = #gecow004#1;
     #gecom008#2  = #gecow004#2;
     #gecom008#3  = 1;
|FPRC;

|PROCESO Alta8;
     #gecom008#0  = #gecow004#0;
     #gecom008#1  = #gecow004#1;
     #gecom008#2  = #gecow004#2;
     #gecom008#3  = 99;
|FPRC;

|PROCESO RetDetalle;
     |VENTANA 1302, 2098, -1, -1, "";
     n3Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo5 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom008, nRango, 1302, 2398, Baja8, Alta8, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n3Vent;

     |HAZ Totalw004;
     |HAZ Pintaw004;
|FPRC;

|PROCESO Baja9;
     #gecom009#0  = #gecow004#0;
     #gecom009#1  = #gecow004#1;
     #gecom009#2  = #gecow004#2;
     #gecom009#3  = 1;
|FPRC;

|PROCESO Alta9;
     #gecom009#0  = #gecow004#0;
     #gecom009#1  = #gecow004#1;
     #gecom009#2  = #gecow004#2;
     #gecom009#3  = 99;
|FPRC;

|PROCESO Albaranes;
     |VENTANA 1302, 2098, -1, -1, "";
     n3Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     nRango   = 1 + 2 + 4 + 8 + 16 + 128;
     |SI enModo5 = 4;
         nRango   = 2 + 4 + 8 + 16 + 128;
     |FINSI;
     |LINEAL_SIMPLE #1#gecom009, nRango, 1302, 2398, Baja9, Alta9, NULL;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n3Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n3Vent;
|FPRC;

|PROCESO DibujaDetalle;
     |CONTROL_SIMPLE nPan4, "BOTON,Descuentos", 1603, 1620, DtoDetalle;
     |CONTROL_SIMPLE nPan4, "BOTON,Cargos", 1703, 1720, CarDetalle;
     |CONTROL_SIMPLE nPan4, "BOTON,Impuestos repercutidos (*)", 1623, 1645, RepDetalle;
     |CONTROL_SIMPLE nPan4, "BOTON,Impuestos retenidos", 1723, 1745, RetDetalle;
     |CONTROL_SIMPLE nPan4, "BOTON,Albaranes", 1648, 1658, Albaranes;
|FPRC;

|PROCESO AltDetalle;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     enModo5 = 1;

     |VENTANA 0501, 3799, -1, 16, "Nuevo detalle";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow004;  nPan4 = FSalida;
     |HAZ DibujaDetalle;

     |DDEFECTO #gecow004;

     #gecom005#0 = #gecow003#0;
     #gecom005#1 = #gecow003#1;
     #gecom005#2 = 9999;
     |LEE 000#gecom005.];
     |SI FSalida = 0;
         |LEE 000#gecom005.a;
     |SINO;
         |LEE 000#gecom005.u;
     |FINSI;

     nId = 1;
     |SI FSalida = 0;  |Y #gecom005#0 = #gecow003#0;
                       |Y #gecom005#1 = #gecow003#1;
         nId = #gecom005#2 + 1;
     |FINSI;

     #gecow004#0 = #gecow003#0;
     #gecow004#1 = #gecow003#1;
     #gecow004#2 = nId;

     |PINDA #0#gecow004;
     |ENDATOS #1#gecow004;
     |SI FSalida = 0;
         |HAZ DescargaArtPanta;

         |PARA nCmp = 0;  |SI nCmp [ enTCmp5;  |HACIENDO nCmp = nCmp + 1;
               #gecom005#nCmp#  = #gecow004#nCmp#;
         |SIGUE;

         |GRABA 020#gecom005.n;
         |LIBERA #gecom005;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |REFRESCACONTROL enGrid5;
     |FOCOTECLADO enGrid5;
|FPRC;

|PROCESO ModDetalle;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |LEE 101#gecom005.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enModo5 = 2;

     |VENTANA 0501, 3799, -1, 16, "Modificaci¢n detalle";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |PINPA #0#gecow004;  nPan4 = FSalida;
     |HAZ DibujaDetalle;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp5;  |HACIENDO nCmp = nCmp + 1;
           #gecow004#nCmp# = #gecom005#nCmp#;
     |SIGUE;

     |HAZ CargaArtPanta;

     |PINDA #0#gecow004;
     |ENDATOS #1#gecow004;
     |SI FSalida = 0;
         |HAZ DescargaArtPanta;

         |PARA nCmp = 0;  |SI nCmp [ enTCmp5;  |HACIENDO nCmp = nCmp + 1;
               #gecom005#nCmp#  = #gecow004#nCmp#;
         |SIGUE;

         |GRABA 020#gecom005.a;
     |FINSI;
     |LIBERA #gecom005;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |REFRESCACONTROL enGrid5;
     |FOCOTECLADO enGrid5;
|FPRC;

|PROCESO ConDetalle;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     enModo5 = 4;

     |VENTANA 0501, 3799, -1, 16, "Consulta detalle";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |DDEFECTO #gecow004;

     |PARA nCmp = 0;  |SI nCmp [ enTCmp5;  |HACIENDO nCmp = nCmp + 1;
           #gecow004#nCmp# = #gecom005#nCmp#;
     |SIGUE;

     |HAZ CargaArtPanta;

     |PINPA #0#gecow004;  nPan4 = FSalida;
     |HAZ DibujaDetalle;

     |PINDA #0#gecow004;
     |PAUSA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |FOCOTECLADO enGrid5;
|FPRC;

|PROCESO gecom006Bor;
     |BORRA 020#gecom006.a;
     |LIBERA #gecom006;
|FPRC;

|DEFBUCLE gecom006Bor;
     #gecom006#1;
     ;
     #gecom005#0, #gecom005#1, #gecom005#2, " ", 01;
     #gecom005#0, #gecom005#1, #gecom005#2, "z", 99;
     be;
     NULL, gecom006Bor;
|FIN;

|PROCESO gecom007Bor;
     |BORRA 020#gecom007.a;
     |LIBERA #gecom007;
|FPRC;

|DEFBUCLE gecom007Bor;
     #gecom007#1;
     ;
     #gecom005#0, #gecom005#1, #gecom005#2, 01;
     #gecom005#0, #gecom005#1, #gecom005#2, 99;
     be;
     NULL, gecom007Bor;
|FIN;

|PROCESO gecom008Bor;
     |BORRA 020#gecom008.a;
     |LIBERA #gecom008;
|FPRC;

|DEFBUCLE gecom008Bor;
     #gecom008#1;
     ;
     #gecom005#0, #gecom005#1, #gecom005#2, 01;
     #gecom005#0, #gecom005#1, #gecom005#2, 99;
     be;
     NULL, gecom008Bor;
|FIN;

|PROCESO gecom009Bor;
     |BORRA 020#gecom009.a;
     |LIBERA #gecom009;
|FPRC;

|DEFBUCLE gecom009Bor;
     #gecom009#1;
     ;
     #gecom005#0, #gecom005#1, #gecom005#2, 01;
     #gecom005#0, #gecom005#1, #gecom005#2, 99;
     be;
     NULL, gecom009Bor;
|FIN;

|PROCESO BorDetalle;
     aAlfa = #gecow003#1;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     |CONFI "0000NEst  seguro que quiere borrar el detalle seleccionado";
     |SI FSalida ! 0;
         |FOCOTECLADO enGrid5;
         |ACABA;
     |FINSI;

     |LEE 101#gecom005.=;
     |SI FSalida ! 0;
         |FOCOTECLADO enGrid5;
         |ACABA;
     |FINSI;

     |BUCLE gecom006Bor;
     |BUCLE gecom007Bor;
     |BUCLE gecom008Bor;
     |BUCLE gecom009Bor;

     |BORRA 020#gecom005.a;
     |LIBERA #gecom005;

     |REFRESCACONTROL enGrid5;
     |FOCOTECLADO enGrid5;
|FPRC;

|PROCESO gecom005B;
     |BUCLE gecom006Bor;
     |BUCLE gecom007Bor;
     |BUCLE gecom008Bor;
     |BUCLE gecom009Bor;

     |BORRA 020#gecom005.a;
     |LIBERA #gecom005;
|FPRC;

|DEFBUCLE gecom005B;
     #gecom005#1;
     ;
     #gecom002#0, #gecom002#1, 0000;
     #gecom002#0, #gecom002#1, 9999;
     be;
     NULL, gecom005B;
|FIN;

|PROCESO BorraTodoDetalle;
     |BUCLE gecom005B;
|FPRC;
