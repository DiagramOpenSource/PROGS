|FICHEROS;
     gecom501;
     gecow101;
     gecow102;

     gecow103;
     gecow104;

     gecow101@;
     trabajo@;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     n1Vent              = 0;
     nTree               = -1;
     nHandle             = 0;
     nClave              = 0;
     nLong               = 0;
     nPos                = 0;
     nPosi               = 0;
     nCampo              = 0;
     nCargar             = 0;
     nEtiqueta           = 0;
     nEtiqueta0          = 0;
     nEtiqueta1          = 0;
     nEtiqueta2          = 0;
     nEtiqueta3          = 0;
     nEtiqueta4          = 0;
     nEtiqueta5          = 0;
     nEtiqueta6          = 0;
     nEtiqueta7          = 0;
     nEtiqueta8          = 0;
     nEtiqueta9          = 0;
     nCarp0              = 0;
     nCarp1              = 0;
     nCarp2              = 0;
     nCarp3              = 0;
     nCarp4              = 0;
     nCarp5              = 0;
     nCarp6              = 0;
     nCarp7              = 0;
     nCarp8              = 0;
     nCarp9              = 0;
     nDE0                = 0;
     nDE1                = 0;
     nDE2                = 0;
     nDE3                = 0;
     nDE4                = 0;
     nDE5                = 0;
     nDE6                = 0;
     nDE7                = 0;
     nDE8                = 0;
     nDE9                = 0;
     nHE0                = 0;
     nHE1                = 0;
     nHE2                = 0;
     nHE3                = 0;
     nHE4                = 0;
     nHE5                = 0;
     nHE6                = 0;
     nHE7                = 0;
     nHE8                = 0;
     nHE9                = 0;
     nNivel              = 0;
     nSit0               = 0;
     nSit1               = 0;
     nSit2               = 0;
     nSit3               = 0;
     nSit4               = 0;
     nSit5               = 0;
     nSit6               = 0;
     nSit7               = 0;
     nSit8               = 0;
     nSit9               = 0;
     nSitua              = 0;
     nOtro               = 0;
     nFSalida            = 0;
     nTCampo             = 0;
     nCmp                = 0;

     aFic                = "";
     aPath               = "";
     aAbreTxt            = "";
     aAbreXml            = "";

     aDef                = "";
     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aContenido          = "";
     aTexto              = "";
     aAlfa               = "";
     aAlfa1              = "";
     aAlfa2              = "";
     aLong               = "";
     aCarac              = "";
     aFicTmp             = "";
     aEtiqueta           = "";
     aBusca              = "";
     aRefresca           = "";
     aBase               = "";
     aMas                = "";
     aQQ                 = "";

  {10} aPopup            = "";

     {-1}sTree           = 0;
     sT_nID              = 0;
     sT_nOper            = 0;
     sT_aData            = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &eaVer              = "";
     &eaAlfa             = "";
|FIN;

|PROCESO GrabaTree;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO gecow101Txt;
     aAlfa = #gecow101#0;

     |SI #gecow101#1  ! 0;  aAlfa = aAlfa + "," + #gecow101#1;  |FINSI;
     |SI #gecow101#2  ! 0;  aAlfa = aAlfa + "," + #gecow101#2;  |FINSI;
     |SI #gecow101#3  ! 0;  aAlfa = aAlfa + "," + #gecow101#3;  |FINSI;
     |SI #gecow101#4  ! 0;  aAlfa = aAlfa + "," + #gecow101#4;  |FINSI;
     |SI #gecow101#5  ! 0;  aAlfa = aAlfa + "," + #gecow101#5;  |FINSI;
     |SI #gecow101#6  ! 0;  aAlfa = aAlfa + "," + #gecow101#6;  |FINSI;
     |SI #gecow101#7  ! 0;  aAlfa = aAlfa + "," + #gecow101#7;  |FINSI;
     |SI #gecow101#8  ! 0;  aAlfa = aAlfa + "," + #gecow101#8;  |FINSI;
     |SI #gecow101#9  ! 0;  aAlfa = aAlfa + "," + #gecow101#9;  |FINSI;

     aAlfa = aAlfa + ":" + #gecow101#11;  |QBF aAlfa;

     aAlfa1  = #gecow101#13;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #gecow101#13 + " " + #gecow101#14;  |QBF aAlfa;
     |FINSI;

     aAlfa1  = #gecow101#12;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #gecow101#12;  |QBF aAlfa;
     |FINSI;

     |SI #gecow101#15 = "1";  aAlfa = aAlfa + " (Obligatorio)";  |FINSI;
     |SI #gecow101#15 = "2";  aAlfa = aAlfa + " (Opcional)";     |FINSI;
     |SI #gecow101#15 = "3";  aAlfa = aAlfa + " (Selecci¢n)";    |FINSI;

     aAlfa = aAlfa + "{{";
     aAlfa = aAlfa + (("00"  + #gecow101#0) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#1) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#2) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#3) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#4) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#5) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#6) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#7) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#8) % -102);
     aAlfa = aAlfa + (("00"  + #gecow101#9) % -102);
     aAlfa = aAlfa + "}}";
     |HAZ GrabaTree;
|FPRC;

|DEFBUCLE gecow101Txt;
     #gecow101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gecow101Txt;
|FIN;

|PROCESO CreaTree;
     |SI nTree ! -1;
         aBusca =          (("00"  + #gecow101#0) % -102);
         aBusca = aBusca + (("00"  + #gecow101#1) % -102);
         aBusca = aBusca + (("00"  + #gecow101#2) % -102);
         aBusca = aBusca + (("00"  + #gecow101#3) % -102);
         aBusca = aBusca + (("00"  + #gecow101#4) % -102);
         aBusca = aBusca + (("00"  + #gecow101#5) % -102);
         aBusca = aBusca + (("00"  + #gecow101#6) % -102);
         aBusca = aBusca + (("00"  + #gecow101#7) % -102);
         aBusca = aBusca + (("00"  + #gecow101#8) % -102);
         aBusca = aBusca + (("00"  + #gecow101#9) % -102);

         |FIN_CONTROL_WINDOWS nTree;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 0;

     |XABRE "WBC", aAbreTxt, nHandle;
     |BUCLE gecow101Txt;
     |XCIERRA nHandle;

     aAlfa = "TREECTRL,Esquema {{" + aAbreTxt + "}}";
     |CONTROL_SIMPLE 0, aAlfa, 0502, 3598, EvntTree;
     nTree = FSalida;

     |SI aBusca ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBusca;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         aRefresca = ":" + FSalida;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;

     |ESPECIFICA "COMMANDCONTROL", sTree;
     |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO RecogeDeContenido;
     aAlfa = aContenido % 102;  nEtiqueta0 = aAlfa;
     aAlfa = aContenido % 302;  nEtiqueta1 = aAlfa;
     aAlfa = aContenido % 502;  nEtiqueta2 = aAlfa;
     aAlfa = aContenido % 702;  nEtiqueta3 = aAlfa;
     aAlfa = aContenido % 902;  nEtiqueta4 = aAlfa;
     aAlfa = aContenido % 1102; nEtiqueta5 = aAlfa;
     aAlfa = aContenido % 1302; nEtiqueta6 = aAlfa;
     aAlfa = aContenido % 1502; nEtiqueta7 = aAlfa;
     aAlfa = aContenido % 1702; nEtiqueta8 = aAlfa;
     aAlfa = aContenido % 1902; nEtiqueta9 = aAlfa;
|FPRC;

|PROCESO gecow101Renumera;
     |SI nCarp0 ! #gecow101#0;
         nEtiqueta0 = nEtiqueta0 + 1;

         nEtiqueta1 = 0;
         nEtiqueta2 = 0;
         nEtiqueta3 = 0;
         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp0    = #gecow101#0;
         nCarp1    = #gecow101#1;
         nCarp2    = #gecow101#2;
         nCarp3    = #gecow101#3;
         nCarp4    = #gecow101#4;
         nCarp5    = #gecow101#5;
         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp1 ! #gecow101#1;
         nEtiqueta1 = nEtiqueta1 + 1;

         nEtiqueta2 = 0;
         nEtiqueta3 = 0;
         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp1    = #gecow101#1;
         nCarp2    = #gecow101#2;
         nCarp3    = #gecow101#3;
         nCarp4    = #gecow101#4;
         nCarp5    = #gecow101#5;
         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp2 ! #gecow101#2;
         nEtiqueta2 = nEtiqueta2 + 1;

         nEtiqueta3 = 0;
         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp2    = #gecow101#2;
         nCarp3    = #gecow101#3;
         nCarp4    = #gecow101#4;
         nCarp5    = #gecow101#5;
         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp3 ! #gecow101#3;
         nEtiqueta3 = nEtiqueta3 + 1;

         nEtiqueta4 = 0;
         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp3    = #gecow101#3;
         nCarp4    = #gecow101#4;
         nCarp5    = #gecow101#5;
         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp4 ! #gecow101#4;
         nEtiqueta4 = nEtiqueta4 + 1;

         nEtiqueta5 = 0;
         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp4    = #gecow101#4;
         nCarp5    = #gecow101#5;
         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp5 ! #gecow101#5;
         nEtiqueta5 = nEtiqueta5 + 1;

         nEtiqueta6 = 0;
         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp5    = #gecow101#5;
         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp6 ! #gecow101#6;
         nEtiqueta6 = nEtiqueta6 + 1;

         nEtiqueta7 = 0;
         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp6    = #gecow101#6;
         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp7 ! #gecow101#7;
         nEtiqueta7 = nEtiqueta7 + 1;

         nEtiqueta8 = 0;
         nEtiqueta9 = 0;

         nCarp7    = #gecow101#7;
         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp8 ! #gecow101#8;
         nEtiqueta8 = nEtiqueta8 + 1;

         nEtiqueta9 = 0;

         nCarp8    = #gecow101#8;
         nCarp9    = #gecow101#9;
     |FINSI;

     |SI nCarp9 ! #gecow101#9;
         nEtiqueta9 = nEtiqueta9 + 1;

         nCarp9    = #gecow101#9;
     |FINSI;

     #gecow101@#0  = nEtiqueta0;
     #gecow101@#1  = nEtiqueta1;
     #gecow101@#2  = nEtiqueta2;
     #gecow101@#3  = nEtiqueta3;
     #gecow101@#4  = nEtiqueta4;
     #gecow101@#5  = nEtiqueta5;
     #gecow101@#6  = nEtiqueta6;
     #gecow101@#7  = nEtiqueta7;
     #gecow101@#8  = nEtiqueta8;
     #gecow101@#9  = nEtiqueta9;
     #gecow101@#10 = #gecow101#10;
     #gecow101@#11 = #gecow101#11;
     #gecow101@#12 = #gecow101#12;
     #gecow101@#13 = #gecow101#13;
     #gecow101@#14 = #gecow101#14;
     #gecow101@#15 = #gecow101#15;
     #gecow101@#16 = #gecow101#16;
     #gecow101@#17 = #gecow101#17;
     #gecow101@#18 = #gecow101#18;

     |GRABA 020#gecow101@.n;
     |LIBERA #gecow101@;

     |SI  #gecow101#0 = nSit0;  |Y  #gecow101#1 = nSit1;  |Y  #gecow101#2 = nSit2;
      |Y  #gecow101#3 = nSit3;  |Y  #gecow101#4 = nSit4;  |Y  #gecow101#5 = nSit5;
      |Y  #gecow101#6 = nSit6;  |Y  #gecow101#7 = nSit7;  |Y  #gecow101#8 = nSit8;
      |Y  #gecow101#9 = nSit9;
          nSit0 = #gecow101@#0;
          nSit1 = #gecow101@#1;
          nSit2 = #gecow101@#2;
          nSit3 = #gecow101@#3;
          nSit4 = #gecow101@#4;
          nSit5 = #gecow101@#5;
          nSit6 = #gecow101@#6;
          nSit7 = #gecow101@#7;
          nSit8 = #gecow101@#8;
          nSit9 = #gecow101@#9;
     |FINSI;
|FPRC;

|DEFBUCLE gecow101Renumera;
     #gecow101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gecow101Renumera;
|FIN;

|PROCESO reflejo;
     #gecow101#0  = #gecow101@#0;
     #gecow101#1  = #gecow101@#1;
     #gecow101#2  = #gecow101@#2;
     #gecow101#3  = #gecow101@#3;
     #gecow101#4  = #gecow101@#4;
     #gecow101#5  = #gecow101@#5;
     #gecow101#6  = #gecow101@#6;
     #gecow101#7  = #gecow101@#7;
     #gecow101#8  = #gecow101@#8;
     #gecow101#9  = #gecow101@#9;
     #gecow101#10 = #gecow101@#10;
     #gecow101#11 = #gecow101@#11;
     #gecow101#12 = #gecow101@#12;
     #gecow101#13 = #gecow101@#13;
     #gecow101#14 = #gecow101@#14;
     #gecow101#15 = #gecow101@#15;
     #gecow101#16 = #gecow101@#16;
     #gecow101#17 = #gecow101@#17;
     #gecow101#18 = #gecow101@#18;

     |GRABA 020#gecow101.n;
     |LIBERA #gecow101;
|FPRC;

|DEFBUCLE reflejo;
     #gecow101@#1010;
     ;
     00, 00, 00, 00, 00, 00, 00, 00, 00, 00;
     99, 99, 99, 99, 99, 99, 99, 99, 99, 99;
     be;
     NULL, reflejo;
|FIN;

|PROCESO Renumeracion;
     nEtiqueta0 = 0;
     nEtiqueta1 = 0;
     nEtiqueta2 = 0;
     nEtiqueta3 = 0;
     nEtiqueta4 = 0;
     nEtiqueta5 = 0;
     nEtiqueta6 = 0;
     nEtiqueta7 = 0;
     nEtiqueta8 = 0;
     nEtiqueta9 = 0;

     |DDEF aDef;  |QBF aDef;
     aDef = aDef + "gecow101.mas";
     |CARGA_DEF aDef, gecow101@;

     aFicTmp = "tmpw0101" + Usuario;
     |NOME_DAT #gecow101@#aFicTmp#;
     |ABRE #gecow101@;  |CIERRA #gecow101@;  |DELINDEX #gecow101@;

     |ABRE #gecow101@;
     |BUCLE gecow101Renumera;
     |CIERRA #gecow101@;

     |CIERRAT #gecow101;
     |DELINDEX #gecow101;

     |ABRET #gecow101;
     |BUCLE reflejo;

     |DELINDEX #gecow101@;
     |DESCARGA_DEF #gecow101@;
|FPRC;

|PROCESO gecow101SubeLista;
     #gecow101@#0 = #gecow101#0;
     #gecow101@#1 = #gecow101#1;
     #gecow101@#2 = #gecow101#2;
     #gecow101@#3 = #gecow101#3;
     #gecow101@#4 = #gecow101#4;
     #gecow101@#5 = #gecow101#5;
     #gecow101@#6 = #gecow101#6;
     #gecow101@#7 = #gecow101#7;
     #gecow101@#8 = #gecow101#8;
     #gecow101@#9 = #gecow101#9;

     |SI nNivel = 1;
         nOtro = nEtiqueta0 - 1;

         |SI #gecow101#0 = nEtiqueta0;
             #gecow101@#0 = #gecow101#0 - 1;
         |FINSI;

         |SI #gecow101#0 = nOtro;
             #gecow101@#0 = #gecow101#0 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 2;
         nOtro = nEtiqueta1 - 1;

         |SI #gecow101#1 = nEtiqueta1;
             #gecow101@#1 = #gecow101#1 - 1;
         |FINSI;

         |SI #gecow101#1 = nOtro;
             #gecow101@#1 = #gecow101#1 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 3;
         nOtro = nEtiqueta2 - 1;

         |SI #gecow101#2 = nEtiqueta2;
             #gecow101@#2 = #gecow101#2 - 1;
         |FINSI;

         |SI #gecow101#2 = nOtro;
             #gecow101@#2 = #gecow101#2 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 4;
         nOtro = nEtiqueta3 - 1;

         |SI #gecow101#3 = nEtiqueta3;
             #gecow101@#3 = #gecow101#3 - 1;
         |FINSI;

         |SI #gecow101#3 = nOtro;
             #gecow101@#3 = #gecow101#3 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 5;
         nOtro = nEtiqueta4 - 1;

         |SI #gecow101#4 = nEtiqueta4;
             #gecow101@#4 = #gecow101#4 - 1;
         |FINSI;

         |SI #gecow101#4 = nOtro;
             #gecow101@#4 = #gecow101#4 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 6;
         nOtro = nEtiqueta5 - 1;

         |SI #gecow101#5 = nEtiqueta5;
             #gecow101@#5 = #gecow101#5 - 1;
         |FINSI;

         |SI #gecow101#5 = nOtro;
             #gecow101@#5 = #gecow101#5 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 7;
         nOtro = nEtiqueta6 - 1;

         |SI #gecow101#6 = nEtiqueta6;
             #gecow101@#6 = #gecow101#6 - 1;
         |FINSI;

         |SI #gecow101#6 = nOtro;
             #gecow101@#6 = #gecow101#6 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 8;
         nOtro = nEtiqueta7 - 1;

         |SI #gecow101#7 = nEtiqueta7;
             #gecow101@#7 = #gecow101#7 - 1;
         |FINSI;

         |SI #gecow101#7 = nOtro;
             #gecow101@#7 = #gecow101#7 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 9;
         nOtro = nEtiqueta8 - 1;

         |SI #gecow101#8 = nEtiqueta8;
             #gecow101@#8 = #gecow101#8 - 1;
         |FINSI;

         |SI #gecow101#8 = nOtro;
             #gecow101@#8 = #gecow101#8 + 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 10;
         nOtro = nEtiqueta9 - 1;

         |SI #gecow101#9 = nEtiqueta9;
             #gecow101@#9 = #gecow101#9 - 1;
         |FINSI;

         |SI #gecow101#9 = nOtro;
             #gecow101@#9 = #gecow101#9 + 1;
         |FINSI;
     |FINSI;

     #gecow101@#10 = #gecow101#10;
     #gecow101@#11 = #gecow101#11;
     #gecow101@#12 = #gecow101#12;
     #gecow101@#13 = #gecow101#13;
     #gecow101@#14 = #gecow101#14;
     #gecow101@#15 = #gecow101#15;
     #gecow101@#16 = #gecow101#16;
     #gecow101@#17 = #gecow101#17;
     #gecow101@#18 = #gecow101#18;

     |GRABA 020#gecow101@.n;
     |LIBERA #gecow101@;

     |SI nSitua = 0;
         nSit0  = #gecow101@#0;
         nSit1  = #gecow101@#1;
         nSit2  = #gecow101@#2;
         nSit3  = #gecow101@#3;
         nSit4  = #gecow101@#4;
         nSit5  = #gecow101@#5;
         nSit6  = #gecow101@#6;
         nSit7  = #gecow101@#7;
         nSit8  = #gecow101@#8;
         nSit9  = #gecow101@#9;
         nSitua = 1;
     |FINSI;

     |BORRA 020#gecow101.a;
     |LIBERA #gecow101;
|FPRC;

|DEFBUCLE gecow101SubeLista;
     #gecow101#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     be;
     NULL, gecow101SubeLista;
|FIN;

|PROCESO DHSubirLista;
     |SI nEtiqueta1 = 0;
         |SI nEtiqueta0 = 1;  |ACABA;  |FINSI;

         nNivel = 1;
         nDE0   = nEtiqueta0 - 1;
         nHE0   = 99;

         nDE1   = 0; nHE1   = 99;
         nDE2   = 0; nHE2   = 99;
         nDE3   = 0; nHE3   = 99;
         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         |SI nEtiqueta1 = 1;  |ACABA;  |FINSI;

         nNivel = 2;
         nDE1   = nEtiqueta1 - 1;
         nHE1   = 99;

         nDE2   = 0; nHE2   = 99;
         nDE3   = 0; nHE3   = 99;
         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         |SI nEtiqueta2 = 1;  |ACABA;  |FINSI;

         nNivel = 3;
         nDE2   = nEtiqueta2 - 1;
         nHE2   = 99;

         nDE3   = 0; nHE3   = 99;
         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         |SI nEtiqueta3 = 1;  |ACABA;  |FINSI;

         nNivel = 4;
         nDE3   = nEtiqueta3 - 1;
         nHE3   = 99;

         nDE4   = 0; nHE4   = 99;
         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         |SI nEtiqueta4 = 1;  |ACABA;  |FINSI;

         nNivel = 5;
         nDE4   = nEtiqueta4 - 1;
         nHE4   = 99;

         nDE5   = 0; nHE5   = 99;
         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         |SI nEtiqueta5 = 1;  |ACABA;  |FINSI;

         nNivel = 6;
         nDE5   = nEtiqueta5 - 1;
         nHE5   = 99;

         nDE6   = 0; nHE6   = 99;
         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         |SI nEtiqueta6 = 1;  |ACABA;  |FINSI;

         nNivel = 7;
         nDE6   = nEtiqueta6 - 1;
         nHE6   = 99;

         nDE7   = 0; nHE7   = 99;
         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         |SI nEtiqueta7 = 1;  |ACABA;  |FINSI;

         nNivel = 8;
         nDE7   = nEtiqueta7 - 1;
         nHE7   = 99;

         nDE8   = 0; nHE8   = 99;
         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         |SI nEtiqueta8 = 1;  |ACABA;  |FINSI;

         nNivel = 9;
         nDE8   = nEtiqueta8 - 1;
         nHE8   = 99;

         nDE9   = 0; nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 1;  |ACABA;  |FINSI;

     nNivel = 10;
     nDE9   = nEtiqueta9 - 1;
     nHE9   = 99;
|FPRC;

|PROCESO SubirLista;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #gecow101#0 = nEtiqueta0;
     #gecow101#1 = nEtiqueta1;
     #gecow101#2 = nEtiqueta2;
     #gecow101#3 = nEtiqueta3;
     #gecow101#4 = nEtiqueta4;
     #gecow101#5 = nEtiqueta5;
     #gecow101#6 = nEtiqueta6;
     #gecow101#7 = nEtiqueta7;
     #gecow101#8 = nEtiqueta8;
     #gecow101#9 = nEtiqueta9;
     |LEE 000#gecow101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHSubirLista;

     |DDEF aDef;  |QBF aDef;
     aDef = aDef + "gecow101.mas";
     |CARGA_DEF aDef, gecow101@;

     aFicTmp = "tmpw0101" + Usuario;
     |NOME_DAT #gecow101@#aFicTmp#;
     |ABRE #gecow101@;  |CIERRA #gecow101@;  |DELINDEX #gecow101@;

     nSitua = 0;
     |ABRE #gecow101@;
     |BUCLE gecow101SubeLista;
     |CIERRA #gecow101@;

     |SI nSitua = 0;
         |DELINDEX #gecow101@;
         |DESCARGA_DEF #gecow101@;
         |ACABA;
     |FINSI;

     |BUCLE reflejo;
     |DELINDEX #gecow101@;
     |DESCARGA_DEF #gecow101@;

     |HAZ Renumeracion;

     #gecow101#0 = nSit0;
     #gecow101#1 = nSit1;
     #gecow101#2 = nSit2;
     #gecow101#3 = nSit3;
     #gecow101#4 = nSit4;
     #gecow101#5 = nSit5;
     #gecow101#6 = nSit6;
     #gecow101#7 = nSit7;
     #gecow101#8 = nSit8;
     #gecow101#9 = nSit9;
     |LEE 000#gecow101.=;

     |HAZ CreaTree;
|FPRC;

|PROCESO gecow101BajaLista;
     #gecow101@#0 = #gecow101#0;
     #gecow101@#1 = #gecow101#1;
     #gecow101@#2 = #gecow101#2;
     #gecow101@#3 = #gecow101#3;
     #gecow101@#4 = #gecow101#4;
     #gecow101@#5 = #gecow101#5;
     #gecow101@#6 = #gecow101#6;
     #gecow101@#7 = #gecow101#7;
     #gecow101@#8 = #gecow101#8;
     #gecow101@#9 = #gecow101#9;

     |SI nNivel = 1;
         nOtro = nEtiqueta0 + 1;

         |SI #gecow101#0 = nEtiqueta0;
             #gecow101@#0 = #gecow101#0 + 1;
         |FINSI;

         |SI #gecow101#0 = nOtro;
             #gecow101@#0 = #gecow101#0 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 2;
         nOtro = nEtiqueta1 + 1;

         |SI #gecow101#1 = nEtiqueta1;
             #gecow101@#1 = #gecow101#1 + 1;
         |FINSI;

         |SI #gecow101#1 = nOtro;
             #gecow101@#1 = #gecow101#1 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 3;
         nOtro = nEtiqueta2 + 1;

         |SI #gecow101#2 = nEtiqueta2;
             #gecow101@#2 = #gecow101#2 + 1;
         |FINSI;

         |SI #gecow101#2 = nOtro;
             #gecow101@#2 = #gecow101#2 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 4;
         nOtro = nEtiqueta3 + 1;

         |SI #gecow101#3 = nEtiqueta3;
             #gecow101@#3 = #gecow101#3 + 1;
         |FINSI;

         |SI #gecow101#3 = nOtro;
             #gecow101@#3 = #gecow101#3 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 5;
         nOtro = nEtiqueta4 + 1;

         |SI #gecow101#4 = nEtiqueta4;
             #gecow101@#4 = #gecow101#4 + 1;
         |FINSI;

         |SI #gecow101#4 = nOtro;
             #gecow101@#4 = #gecow101#4 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 6;
         nOtro = nEtiqueta5 + 1;

         |SI #gecow101#5 = nEtiqueta5;
             #gecow101@#5 = #gecow101#5 + 1;
         |FINSI;

         |SI #gecow101#5 = nOtro;
             #gecow101@#5 = #gecow101#5 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 7;
         nOtro = nEtiqueta6 + 1;

         |SI #gecow101#6 = nEtiqueta6;
             #gecow101@#6 = #gecow101#6 + 1;
         |FINSI;

         |SI #gecow101#6 = nOtro;
             #gecow101@#6 = #gecow101#6 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 8;
         nOtro = nEtiqueta7 + 1;

         |SI #gecow101#7 = nEtiqueta7;
             #gecow101@#7 = #gecow101#7 + 1;
         |FINSI;

         |SI #gecow101#7 = nOtro;
             #gecow101@#7 = #gecow101#7 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 9;
         nOtro = nEtiqueta8 + 1;

         |SI #gecow101#8 = nEtiqueta8;
             #gecow101@#8 = #gecow101#8 + 1;
         |FINSI;

         |SI #gecow101#8 = nOtro;
             #gecow101@#8 = #gecow101#8 - 1;
         |FINSI;
     |FINSI;

     |SI nNivel = 10;
         nOtro = nEtiqueta9 + 1;

         |SI #gecow101#9 = nEtiqueta9;
             #gecow101@#9 = #gecow101#9 + 1;
         |FINSI;

         |SI #gecow101#9 = nOtro;
             #gecow101@#9 = #gecow101#9 - 1;
         |FINSI;
     |FINSI;

     #gecow101@#10 = #gecow101#10;
     #gecow101@#11 = #gecow101#11;
     #gecow101@#12 = #gecow101#12;
     #gecow101@#13 = #gecow101#13;
     #gecow101@#14 = #gecow101#14;
     #gecow101@#15 = #gecow101#15;
     #gecow101@#16 = #gecow101#16;
     #gecow101@#17 = #gecow101#17;
     #gecow101@#18 = #gecow101#18;

     |GRABA 020#gecow101@.n;
     |LIBERA #gecow101@;

     |SI nSitua = 0;
         nSit0  = #gecow101@#0;
         nSit1  = #gecow101@#1;
         nSit2  = #gecow101@#2;
         nSit3  = #gecow101@#3;
         nSit4  = #gecow101@#4;
         nSit5  = #gecow101@#5;
         nSit6  = #gecow101@#6;
         nSit7  = #gecow101@#7;
         nSit8  = #gecow101@#8;
         nSit9  = #gecow101@#9;
         nSitua = 1;
     |FINSI;

     |BORRA 020#gecow101.a;
     |LIBERA #gecow101;
|FPRC;

|DEFBUCLE gecow101BajaLista;
     #gecow101#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     be;
     NULL, gecow101BajaLista;
|FIN;

|PROCESO DHBajarLista;
     |SI nEtiqueta1 = 0;
         nNivel = 1;
         nDE0   = nEtiqueta0;
         nHE0   = 99;

         nDE1   = 0;  nHE1   = 99;
         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         nNivel = 2;
         nDE1   = nEtiqueta1;
         nHE1   = 99;

         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         nNivel = 3;
         nDE2   = nEtiqueta2;
         nHE2   = 99;

         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         nNivel = 4;
         nDE3   = nEtiqueta3;
         nHE3   = 99;

         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         nNivel = 5;
         nDE4   = nEtiqueta4;
         nHE4   = 99;

         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         nNivel = 6;
         nDE5   = nEtiqueta5;
         nHE5   = 99;

         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         nNivel = 7;
         nDE6   = nEtiqueta6;
         nHE6   = 99;

         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         nNivel = 8;
         nDE7   = nEtiqueta7;
         nHE7   = 99;

         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         nNivel = 9;
         nDE8   = nEtiqueta8;
         nHE8   = 99;

         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     nNivel = 10;
     nDE9   = nEtiqueta9;
     nHE9   = 99;
|FPRC;

|PROCESO BajarLista;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #gecow101#0 = nEtiqueta0;
     #gecow101#1 = nEtiqueta1;
     #gecow101#2 = nEtiqueta2;
     #gecow101#3 = nEtiqueta3;
     #gecow101#4 = nEtiqueta4;
     #gecow101#5 = nEtiqueta5;
     #gecow101#6 = nEtiqueta6;
     #gecow101#7 = nEtiqueta7;
     #gecow101#8 = nEtiqueta8;
     #gecow101#9 = nEtiqueta9;
     |LEE 000#gecow101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHBajarLista;

     |DDEF aDef;  |QBF aDef;
     aDef = aDef + "gecow101.mas";
     |CARGA_DEF aDef, gecow101@;

     aFicTmp = "tmpw0101" + Usuario;
     |NOME_DAT #gecow101@#aFicTmp#;
     |ABRE #gecow101@;  |CIERRA #gecow101@;  |DELINDEX #gecow101@;

     nSitua = 0;
     |ABRE #gecow101@;
     |BUCLE gecow101BajaLista;
     |CIERRA #gecow101@;

     |SI nSitua = 0;
         |DELINDEX #gecow101@;
         |DESCARGA_DEF #gecow101@;
         |ACABA;
     |FINSI;

     |BUCLE reflejo;
     |DELINDEX #gecow101@;
     |DESCARGA_DEF #gecow101@;

     |HAZ Renumeracion;

     #gecow101#0 = nSit0;
     #gecow101#1 = nSit1;
     #gecow101#2 = nSit2;
     #gecow101#3 = nSit3;
     #gecow101#4 = nSit4;
     #gecow101#5 = nSit5;
     #gecow101#6 = nSit6;
     #gecow101#7 = nSit7;
     #gecow101#8 = nSit8;
     #gecow101#9 = nSit9;
     |LEE 000#gecow101.=;

     |HAZ CreaTree;
|FPRC;

|PROCESO gecow101Busca;
     |SI #gecow101#1 = 0;
         nEtiqueta0 = #gecow101#0 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#2 = 0;
         nEtiqueta1 = #gecow101#1 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#3 = 0;
         nEtiqueta2 = #gecow101#2 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#4 = 0;
         nEtiqueta3 = #gecow101#3 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#5 = 0;
         nEtiqueta4 = #gecow101#4 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#6 = 0;
         nEtiqueta5 = #gecow101#5 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#7 = 0;
         nEtiqueta6 = #gecow101#6 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#8 = 0;
         nEtiqueta7 = #gecow101#7 + 1;
         |ACABA;
     |FINSI;

     |SI #gecow101#9 = 0;
         nEtiqueta8 = #gecow101#8 + 1;
         |ACABA;
     |FINSI;

     nEtiqueta9 = #gecow101#9 + 1;
|FPRC;

|DEFBUCLE gecow101Busca;
     #gecow101#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     ;
     NULL, gecow101Busca;
|FIN;

|PROCESO DHCrea;
     |SI nEtiqueta1 = 0;
         nDE1   = 1;
         nHE1   = 99;
         nEtiqueta1 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         nDE2   = 1;
         nHE2   = 99;
         nEtiqueta2 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         nDE3   = 1;
         nHE3   = 99;
         nEtiqueta3 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         nDE4   = 1;
         nHE4   = 99;
         nEtiqueta4 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         nDE5   = 1;
         nHE5   = 99;
         nEtiqueta5 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         nDE6   = 1;
         nHE6   = 99;
         nEtiqueta6 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         nDE7   = 1;
         nHE7   = 99;
         nEtiqueta7 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         nDE8   = 1;
         nHE8   = 99;
         nEtiqueta8 = 1;
         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         nDE9   = 1;
         nHE9   = 99;
         nEtiqueta9 = 1;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CreaEtiqueta;
     |LEE 000#gecow101.p;
     |SI FSalida ! 0;
         #gecow101#0  = 1;
         #gecow101#1  = 0;
         #gecow101#2  = 0;
         #gecow101#3  = 0;
         #gecow101#4  = 0;
         #gecow101#5  = 0;
         #gecow101#6  = 0;
         #gecow101#7  = 0;
         #gecow101#8  = 0;
         #gecow101#9  = 0;
         #gecow101#10 = #gecow102#0;
         #gecow101#11 = #gecow102#1;
         #gecow101#12 = #gecow102#2;
         #gecow101#13 = #gecow102#3;
         #gecow101#14 = #gecow102#4;
         #gecow101#15 = #gecow102#5;
         #gecow101#16 = #gecow102#6;
         #gecow101#17 = #gecow102#7;
         #gecow101#18 = #gecow102#8;

         |GRABA 020#gecow101.n;
         |LIBERA #gecow101;

         |HAZ CreaTree;
         |ACABA;
     |FINSI;

     |SI aContenido = "";
         |PARA nEtiqueta = 1;  |SI nEtiqueta [ 100;  |HACIENDO nEtiqueta = nEtiqueta + 1;
               #gecow101#0 = nEtiqueta;
               #gecow101#1 = 0;
               #gecow101#2 = 0;
               #gecow101#3 = 0;
               #gecow101#4 = 0;
               #gecow101#5 = 0;
               #gecow101#6 = 0;
               #gecow101#7 = 0;
               #gecow101#8 = 0;
               #gecow101#9 = 0;
               |LEE 000#gecow101.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;

         |SI nEtiqueta ] 100;  |ACABA;  |FINSI;

         #gecow101#0 = nEtiqueta;
         #gecow101#1  = 0;
         #gecow101#2  = 0;
         #gecow101#3  = 0;
         #gecow101#4  = 0;
         #gecow101#5  = 0;
         #gecow101#6  = 0;
         #gecow101#7  = 0;
         #gecow101#8  = 0;
         #gecow101#9  = 0;
         #gecow101#10 = #gecow102#0;
         #gecow101#11 = #gecow102#1;
         #gecow101#12 = #gecow102#2;
         #gecow101#13 = #gecow102#3;
         #gecow101#14 = #gecow102#4;
         #gecow101#15 = #gecow102#5;
         #gecow101#16 = #gecow102#6;
         #gecow101#17 = #gecow102#7;
         #gecow101#18 = #gecow102#8;

         |GRABA 020#gecow101.n;
         |LIBERA #gecow101;

         |HAZ CreaTree;

         |ACABA;
     |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHCrea;

     |BUCLE gecow101Busca;

     #gecow101#0  = nEtiqueta0;
     #gecow101#1  = nEtiqueta1;
     #gecow101#2  = nEtiqueta2;
     #gecow101#3  = nEtiqueta3;
     #gecow101#4  = nEtiqueta4;
     #gecow101#5  = nEtiqueta5;
     #gecow101#6  = nEtiqueta6;
     #gecow101#7  = nEtiqueta7;
     #gecow101#8  = nEtiqueta8;
     #gecow101#9  = nEtiqueta9;
     #gecow101#10 = #gecow102#0;
     #gecow101#11 = #gecow102#1;
     #gecow101#12 = #gecow102#2;
     #gecow101#13 = #gecow102#3;
     #gecow101#14 = #gecow102#4;
     #gecow101#15 = #gecow102#5;
     #gecow101#16 = #gecow102#6;
     #gecow101#17 = #gecow102#7;
     #gecow101#18 = #gecow102#8;

     |GRABA 020#gecow101.n;
     |LIBERA #gecow101;

     |HAZ CreaTree;
|FPRC;

|PROCESO NuevaEtiqueta;
     |HAZ RecogeDeContenido;

     |SI nEtiqueta9 ! 0;
         |MENAV "0000Superado m ximo de agrupaciones";
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2399, -1, 16, "Nueva Etiqueta";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #gecow102;
     |PINPA #0#gecow102;
     |PINDA #0#gecow102;
     |ENDATOS #1#gecow102;
     nFSalida = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |SI nFSalida = 0;
         |HAZ CreaEtiqueta;
     |FINSI;
|FPRC;

|PROCESO ModificarEtiqueta;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #gecow101#0 = nEtiqueta0;
     #gecow101#1 = nEtiqueta1;
     #gecow101#2 = nEtiqueta2;
     #gecow101#3 = nEtiqueta3;
     #gecow101#4 = nEtiqueta4;
     #gecow101#5 = nEtiqueta5;
     #gecow101#6 = nEtiqueta6;
     #gecow101#7 = nEtiqueta7;
     #gecow101#8 = nEtiqueta8;
     #gecow101#9 = nEtiqueta9;
     |LEE 101#gecow101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 2399, -1, 16, "Modificar etiqueta";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #gecow102#0 = #gecow101#10;
     #gecow102#1 = #gecow101#11;
     #gecow102#2 = #gecow101#12;
     #gecow102#3 = #gecow101#13;
     #gecow102#4 = #gecow101#14;
     #gecow102#5 = #gecow101#15;
     #gecow102#6 = #gecow101#16;
     #gecow102#7 = #gecow101#17;
     #gecow102#8 = #gecow101#18;

     |PINPA #0#gecow102;
     |PINDA #0#gecow102;
     |ENDATOS #1#gecow102;
     nFSalida = FSalida;
     ||GRABA 020#gecow101.a;
     ||LIBERA #gecow101;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |SI nFSalida = 0;
         #gecow101#10 = #gecow102#0;
         #gecow101#11 = #gecow102#1;
         #gecow101#12 = #gecow102#2;
         #gecow101#13 = #gecow102#3;
         #gecow101#14 = #gecow102#4;
         #gecow101#15 = #gecow102#5;
         #gecow101#16 = #gecow102#6;
         #gecow101#17 = #gecow102#7;
         #gecow101#18 = #gecow102#8;

        |GRABA 020#gecow101.a;
        |LIBERA #gecow101;

        |HAZ CreaTree;
     |FINSI;
|FPRC;

|PROCESO gecow101B;
     |BORRA 020#gecow101.a;
     |LIBERA #gecow101;
|FPRC;

|DEFBUCLE gecow101B;
     #gecow101#1;
     ;
     nDE0, nDE1, nDE2, nDE3, nDE4, nDE5, nDE6, nDE7, nDE8, nDE9;
     nHE0, nHE1, nHE2, nHE3, nHE4, nHE5, nHE6, nHE7, nHE8, nHE9;
     be;
     NULL, gecow101B;
|FIN;

|PROCESO DHQuitar;
     |SI nEtiqueta1 = 0;
         nDE1   = 0;  nHE1   = 99;
         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta2 = 0;
         nDE2   = 0;  nHE2   = 99;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta3 = 0;
         nDE3   = 0;  nHE3   = 99;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta4 = 0;
         nDE4   = 0;  nHE4   = 99;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta5 = 0;
         nDE5   = 0;  nHE5   = 99;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta6 = 0;
         nDE6   = 0;  nHE6   = 99;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta7 = 0;
         nDE7   = 0;  nHE7   = 99;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta8 = 0;
         nDE8   = 0;  nHE8   = 99;
         nDE9   = 0;  nHE9   = 99;

         |ACABA;
     |FINSI;

     |SI nEtiqueta9 = 0;
         nDE9   = 0;  nHE9   = 99;
     |FINSI;
|FPRC;

|PROCESO QuitarEtiqueta;
     |SI aContenido = "";  |ACABA;  |FINSI;

     |HAZ RecogeDeContenido;

     #gecow101#0 = nEtiqueta0;
     #gecow101#1 = nEtiqueta1;
     #gecow101#2 = nEtiqueta2;
     #gecow101#3 = nEtiqueta3;
     #gecow101#4 = nEtiqueta4;
     #gecow101#5 = nEtiqueta5;
     #gecow101#6 = nEtiqueta6;
     #gecow101#7 = nEtiqueta7;
     #gecow101#8 = nEtiqueta8;
     #gecow101#9 = nEtiqueta9;
     |LEE 101#gecow101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDE0 = nEtiqueta0;  nHE0 = nEtiqueta0;
     nDE1 = nEtiqueta1;  nHE1 = nEtiqueta1;
     nDE2 = nEtiqueta2;  nHE2 = nEtiqueta2;
     nDE3 = nEtiqueta3;  nHE3 = nEtiqueta3;
     nDE4 = nEtiqueta4;  nHE4 = nEtiqueta4;
     nDE5 = nEtiqueta5;  nHE5 = nEtiqueta5;
     nDE6 = nEtiqueta6;  nHE6 = nEtiqueta6;
     nDE7 = nEtiqueta7;  nHE7 = nEtiqueta7;
     nDE8 = nEtiqueta8;  nHE8 = nEtiqueta8;
     nDE9 = nEtiqueta9;  nHE9 = nEtiqueta9;

     |HAZ DHQuitar;

     |BUCLE gecow101B;

     |HAZ Renumeracion;

     |HAZ CreaTree;
|FPRC;

|PROCESO MontaContenido;
     aAlfa       = Contenido;  |QBF aAlfa;
     aContenido  = "";
     aLong       = aAlfa % 0;
     nLong       = aLong;
     nCargar     = 0;
     |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
           nPos = (nPosi * 100) + 1;
           aCarac = aAlfa % nPos;

           |SI nCargar = 1;
               aContenido  = aContenido + aCarac;
           |FINSI;

           |SI aCarac = ":";  nCargar = 1; |FINSI;
     |SIGUE;
|FPRC;

|PROCESO EvntTree;
     |SI FEntrada = 0;
         |HAZ MontaContenido;

         aAlfa = "";
         aLong = Contenido % 0;
         nLong = aLong;
         |PARA nPosi = 1;  |SI nPosi [ nLong;  |HACIENDO nPosi = nPosi + 1;
               nPos = (nPosi * 100) + 1;
               aCarac = Contenido % nPos;
               |SI aCarac = ":";  |SAL;  |FINSI;
               aAlfa  = aAlfa + aCarac;
         |SIGUE;

         |QBT aAlfa;

         sT_nID   = nTree;
         sT_nOper = 4;
         sT_aData = ":" + aAlfa;

         |ESPECIFICA "COMMANDCONTROL", sTree;
         aTexto = Contenido;

         |ACABA;
     |FINSI;

     aPopup1  = nTree;  || Si fuera -1 en la posicion
     aPopup2  = 6;
     aPopup3  = "Agregar nueva etiqueta";
     aPopup4  = "Modificacion etiqueta";
     aPopup5  = "Quitar etiqueta";
     aPopup6  = "----------------------";
     aPopup7  = "Subir lista";
     aPopup8  = "Bajar lista";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         |SI FSalida = 1;  |HAZ NuevaEtiqueta;     |FINSI;
         |SI FSalida = 2;  |HAZ ModificarEtiqueta; |FINSI;
         |SI FSalida = 3;  |HAZ QuitarEtiqueta;    |FINSI;
         |SI FSalida = 5;  |HAZ SubirLista;        |FINSI;
         |SI FSalida = 6;  |HAZ BajarLista;        |FINSI;
     |FINSI;
|FPRC;

|PROCESO gecow101Xml;
     aAlfa = #gecow101#11;  |QBF aAlfa;
     |SI aAlfa = "<>";  |O aAlfa = "</>";
         |ACABA;
     |FINSI;

     aAlfa = "      ";

     |SI #gecow101#1  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#2  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#3  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#4  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#5  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#6  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#7  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#8  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;
     |SI #gecow101#9  ! 0;  aAlfa = aAlfa + "   ";  |FINSI;

     aAlfa1 = #gecow101#11 % 201;
     |SI aAlfa1 = "/";
         aAlfa = aAlfa - "   ";
     |FINSI;

     aAlfa = aAlfa + #gecow101#11;  |QBF aAlfa;

     eaAlfa  = #gecow101#14;  |HAZ QuitaRarosXml;
     aAlfa1  = #gecow101#13;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #gecow101#13 + " " + eaAlfa;  |QBF aAlfa;
     |FINSI;

     aAlfa1  = #gecow101#12;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = aAlfa + " " + #gecow101#12;  |QBF aAlfa;
     |FINSI;

     |HAZ GrabaTree;
|FPRC;

|DEFBUCLE gecow101Xml;
     #gecow101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gecow101Xml;
|FIN;

|PROCESO CabXml;
     aAlfa = "<?xml version=" + &34 + "1.0" + &34;
     aAlfa = aAlfa + " encoding=" + &34 + "UTF-8" + &34;
     aAlfa = aAlfa + " standalone=" + &34 + "yes" + &34 + "?>";
     |HAZ GrabaTree;

     aAlfa = "<fe:Facturae xmlns:fe=" + &34 + "http://www.facturae.es/Facturae/2014/v3.2.1/Facturae" + &34;
     aAlfa = aAlfa + " xmlns:ds=" + &34 + "http://www.w3.org/2000/09/xmldsig#" + &34 + ">";
     |HAZ GrabaTree;
|FPRC;

|PROCESO PieXml;
     aAlfa = "</fe:Facturae>";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Verifica;
     |XABRE "WBC", aAbreXml, nHandle;
     |HAZ CabXml;
     |BUCLE gecow101Xml;
     |HAZ PieXml;
     |XCIERRA nHandle;

     aAlfa = "0000Edita con el chrome el fichero " + aAbreXml;
     |MENAV aAlfa;

     |FOCOTECLADO nTree;
|FPRC;

|PROGRAMA;
     aAlfa = "Esquema XML";

     |VENTANA 0501, 3799, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 807;  |PAUSA;

     |HAZ CreaTree;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Verifica XML", 3602, 3615, Verifica;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nTree;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;

     |PULSATECLA;
|FPRO;

|PROCESO CreaLista;
     |GRABA 000#gecow103.n;

     |DBASE aBase;
     aMas = aBase + "def/" + #gecow103#0 + ".mas";
     |CARGA_DEF aMas, trabajo@;

     aQQ      = "|NC";
     aAlfa    = #trabajo@#aQQ#;
     nTCampo  = aAlfa;
     nTCampo  = nTCampo - 1;

     |PARA nCampo = 0;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aQQ    = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           aAlfa1 = (#trabajo@#aQQ# + (" " * 20)) % 120;  |QBF aAlfa1;

           aQQ   = "|C" + (("000" + nCampo) % -103) + "TIPO";
           aAlfa2 = #trabajo@#aQQ#;

           |SI aAlfa ! "Inhibido";
               #gecow104#0 = #gecow103#0;
               #gecow104#1 = ("000" + nCampo) % -103;
               #gecow104#2 = aAlfa1;
               #gecow104#3 = aAlfa2;
               |GRABA 000#gecow104.n;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CreaCmp;
     aFicTmp = "gecow103" + Usuario;
     |NOME_DAT #gecow103#aFicTmp#;
     |ABRE #gecow103;  |CIERRA #gecow103;  |DELINDEX #gecow103;

     aFicTmp = "gecow104" + Usuario;
     |NOME_DAT #gecow104#aFicTmp#;
     |ABRE #gecow104;  |CIERRA #gecow104;  |DELINDEX #gecow104;

     |ABRET #gecow103;
     |ABRET #gecow104;

     #gecow103#0 = "gecom001"; #gecow103#1 = "Empresas            "; |HAZ CreaLista;
     #gecow103#0 = "gecom002"; #gecow103#1 = "Facturae indice     "; |HAZ CreaLista;
     #gecow103#0 = "gecom003"; #gecow103#1 = "Facturae cabecera   "; |HAZ CreaLista;
     #gecow103#0 = "gecom004"; #gecow103#1 = "Facturae centros    "; |HAZ CreaLista;
     #gecow103#0 = "gecom005"; #gecow103#1 = "Facturae detalles   "; |HAZ CreaLista;
     #gecow103#0 = "gecom006"; #gecow103#1 = "Descuentos/Cargos  D"; |HAZ CreaLista;
     #gecow103#0 = "gecom007"; #gecow103#1 = "Imp.repercutidos    "; |HAZ CreaLista;
     #gecow103#0 = "gecom008"; #gecow103#1 = "Imp.retenidos       "; |HAZ CreaLista;
     #gecow103#0 = "gecom009"; #gecow103#1 = "Albaranes           "; |HAZ CreaLista;
     #gecow103#0 = "gecom010"; #gecow103#1 = "Descuentos/Cargos  C"; |HAZ CreaLista;
     #gecow103#0 = "gecom011"; #gecow103#1 = "Suplidos            "; |HAZ CreaLista;
     #gecow103#0 = "gecom012"; #gecow103#1 = "Adjuntos            "; |HAZ CreaLista;
     #gecow103#0 = "gecom013"; #gecow103#1 = "Literales legales   "; |HAZ CreaLista;
     #gecow103#0 = "gecom500"; #gecow103#1 = "Versiones GECOBASE  "; |HAZ CreaLista;
     #gecow103#0 = "gecow009"; #gecow103#1 = "Tmp de taxes        "; |HAZ CreaLista;
|FPRC;

|PROCESO T80;  |TIPO 80;
     aFicTmp = "gecow101" + Usuario;
     |NOME_DAT #gecow101#aFicTmp#;
     |ABRE #gecow101;  |CIERRA #gecow101;  |DELINDEX #gecow101;

     |HAZ CreaCmp;

     |ABRET #gecow101;
     |ABRE #gecom501;
     |ABRE #gecow104;

     |DDEFECTO #gecom501;
     #gecom501#0  = eaVer;
     |LEE 000#gecom501.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #gecom501#0 ! eaVer;  |SAL;  |FINSI;

          #gecow101#0  = #gecom501#1;
          #gecow101#1  = #gecom501#2;
          #gecow101#2  = #gecom501#3;
          #gecow101#3  = #gecom501#4;
          #gecow101#4  = #gecom501#5;
          #gecow101#5  = #gecom501#6;
          #gecow101#6  = #gecom501#7;
          #gecow101#7  = #gecom501#8;
          #gecow101#8  = #gecom501#9;
          #gecow101#9  = #gecom501#10;
          #gecow101#10 = #gecom501#11;
          #gecow101#11 = #gecom501#12;
          #gecow101#12 = #gecom501#13;
          #gecow101#13 = #gecom501#14;
          #gecow101#14 = #gecom501#15;
          #gecow101#15 = #gecom501#16;
          #gecow101#16 = #gecom501#18;
          #gecow101#17 = #gecom501#19;
          #gecow101#18 = #gecom501#20;

          #gecow104#0 = #gecow101#13 % 208;
          #gecow104#1 = #gecow101#13 % 1103;
          |LEE 000#gecow104.=;
          |SI FSalida ! 0;  |DDEFECTO #gecow104;  |FINSI;

          #gecow101#16 = #gecow104#3;

          |GRABA 020#gecow101.n;
          |LIBERA #gecow101;

          |LEE 000#gecom501.s;
     |SIGUE;

     |CIERRA #gecow104;
     |CIERRA #gecom501;

     aPath = "C:\documentos";     |RMKDIR aPath;
     aPath = "C:\documentos\tmp"; |RMKDIR aPath;
     aPath = "C:\documentos\tmp\";

     aFic  = "gecoz501" + Usuario + ".txt";
     aAbreTxt = aPath + aFic;

     aFic  = "gecoz501" + Usuario + ".xml";
     aAbreXml = aPath + aFic;
|FPRC;

|PROCESO gecow101Graba;
     #gecom501#0  = eaVer;
     #gecom501#1  = #gecow101#0;
     #gecom501#2  = #gecow101#1;
     #gecom501#3  = #gecow101#2;
     #gecom501#4  = #gecow101#3;
     #gecom501#5  = #gecow101#4;
     #gecom501#6  = #gecow101#5;
     #gecom501#7  = #gecow101#6;
     #gecom501#8  = #gecow101#7;
     #gecom501#9  = #gecow101#8;
     #gecom501#10 = #gecow101#9;
     #gecom501#11 = #gecow101#10;
     #gecom501#12 = #gecow101#11;
     #gecom501#13 = #gecow101#12;
     #gecom501#14 = #gecow101#13;
     #gecom501#15 = #gecow101#14;
     #gecom501#16 = #gecow101#15;
     #gecom501#18 = #gecow101#16;
     #gecom501#19 = #gecow101#17;
     #gecom501#20 = #gecow101#18;

     aAlfa = (("00" + #gecom501#1) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#2) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#3) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#4) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#5) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#6) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#7) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#8) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#9) % -102);
     aAlfa = aAlfa + (("00" + #gecom501#10) % -102);

     #gecom501#17 = aAlfa;

     |GRABA 020#gecom501.n;
     |LIBERA #gecom501;
|FPRC;

|DEFBUCLE gecow101Graba;
     #gecow101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gecow101Graba;
|FIN;

|PROCESO GeneraEsquema;
     |ABRE #gecom501;
     |DDEFECTO #gecom501;
     #gecom501#0  = eaVer;
     |LEE 101#gecom501.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #gecom501#0 ! eaVer;  |SAL;  |FINSI;

          |BORRA 020#gecom501.a;
          |LIBERA #gecom501;

          |LEE 101#gecom501.s;
     |SIGUE;
     |LIBERA #gecom501;

     |BUCLE gecow101Graba;

     |CIERRA #gecom501;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CONFI "0000SEsta seguro de grabar el esquema generado";
     |SI FSalida = 0;
         |HAZ GeneraEsquema;
     |FINSI;

     |CIERRAT #gecow101;  |DELINDEX #gecow101;
     |CIERRAT #gecow103;  |DELINDEX #gecow103;
     |CIERRAT #gecow104;  |DELINDEX #gecow104;

     |RFBORRA aAbreTxt;
     |RFBORRA aAbreXml;
|FPRC;
