|FICHEROS;
   rey00104 #0;
   rem00002 #1;
   rem00005 #2;
   rem01002 #3;
   rem00021 #4;
   retabla3 #5;
   reparame #13;
   rem00006 #20;

   rem00100 #100;
   rem00101 #101;

   &haciend@ #706;
|FIN;

|VARIABLES;
   Cont  = 0;
   Calc  = 0;
   Cont1 = 0;
   Comodin = "";
   Seleccion = "";
   Empresa = 0;
   Primero = 0;
   Parte   = 0;
   SwPatrim = 0;
   SwDatos  = 0;
   LinMax   = 0;
   nConta    = 0;
   nFamiliar = 0;

   Campo1 = 0;
   Campo2 = 0;
   Campo3 = 0;

{-1}formato    = "";
    formato1   = "2400";
    formato2   = "1";
    formato3   = "Elija tipo de papel : ";
    formato4   = "For";
    formato5   = " Formato 98/99 ";
    formato6   = " Formato 99/00 ";
    formato7   = " Formato 2004  ";

    Form  = 0;
    &enCodProv = 0;
    &enCodPobl = 0;
    aLong     = "";
    aAlfa     = "";
    aAlfa1    = "";
    aAlfa2    = "";
    Cadena    = "";
    TipoDato  = "";
    Vacio1    = "";
    Vacio2    = "";

    nSwError  = 0;
    nCalc     = 0;
    nCont1    = 0;
    Calc1     = 0;
    Calc2     = 0;
    nLong     = 0;
    Long      = 0;
    LongDec   = 0;
    Handle    = 0;
    nNegativo = 0;
|FIN;

|PROCESO CalcuPatri;
     |SI #reparame#15 = "S";
         |SI Seleccion = "TITULAR   "; Comodin = "ZPATRITIT"; |FINSI;
         |SI Seleccion = "CONYUGE   "; Comodin = "ZPATRICON"; |FINSI;
         |SI Seleccion = "CONJUNTA  ";
            |ABRE #rem01002;           || Busco las casillas de la liquidacion del patrimonio
            #rem01002#0 = Empresa;     || Codigo
            #rem01002#1 = 0;           || Complementaria
            #rem01002#2 = "ZPATRITIT"; || Tipo contribuyente
            #rem01002#3 = 16;          || Bloque
            #rem01002#4 = " 23";       || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #rem00006#20 = #rem00006#20 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#3 = 17;        || Bloque
            #rem01002#4 = " 24";        || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #rem00006#21 = #rem00006#21 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#0 = Empresa;        || Codigo
            #rem01002#1 = 0;           || Complementaria
            #rem01002#2 = "ZPATRICON"; || Tipo contribuyente
            #rem01002#3 = 16;          || Bloque
            #rem01002#4 = " 23";       || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #rem00006#20 = #rem00006#20 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#3 = 17;        || Bloque
            #rem01002#4 = " 24";        || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #rem00006#21 = #rem00006#21 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;
            |CIERRA #rem01002;
         |SINO;
            |ABRE #rem01002;           || Busco las casillas de la liquidacion del patrimonio
            #rem01002#0 = Empresa;     || Codigo
            #rem01002#1 = 0;           || Complementaria
            #rem01002#2 = Comodin;     || Tipo contribuyente
            #rem01002#3 = 16;          || Bloque
            #rem01002#4 = " 23";       || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #rem00006#20 = #rem00006#20 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;

            #rem01002#3 = 17;        || Bloque
            #rem01002#4 = " 24";        || Casilla
            |LEE 040#rem01002.=;
            |SI FSalida = 0;
               #rem00006#21 = #rem00006#21 + #rem01002#6;
            |SINO;
               |MENAV "    Debe hacer la liquidacion del modelo 714";
               |CIERRA #rem01002;
               |ACABA;
            |FINSI;
            |CIERRA #rem01002;
         |FINSI;
     |SINO;
         |SI #rem00021#15 ] #rem00021#26;
            #rem00006#20 = #rem00006#20 + (#rem00021#15 % Parte);
         |SINO;
            #rem00006#20 = #rem00006#20 + (#rem00021#26 % Parte);
         |FINSI;
/*
         |SI #rem00005#20 < #rem00021#26;  #rem00005#20 = #rem00021#26; |FINSI;
         |SI #rem00005#20 < #rem00021#27;  #rem00005#20 = #rem00021#27; |FINSI;
         |SI #rem00005#20 = 0; |ACABA; |FINSI;
*/
         #rem00006#21 = #rem00006#21 + ((#rem00021#22 + #rem00021#23 + #rem00021#29) % Parte);
     |FINSI;

     #rem00006#22 = #rem00006#20 - #rem00006#21;
     |PARA Campo1 = 8;  |SI Campo1 ] 1; |HACIENDO  Campo1 = Campo1 - 1;
           Campo2 = Campo1 + 8;
           Campo3 = Campo1 + 16;
           |SI #rem00006#22 > #retabla3#Campo1#;
               #rem00006#23 = #retabla3#Campo1#;
               #rem00006#25 = #retabla3#Campo2#;
               #rem00006#27 = #retabla3#Campo3#;
               #rem00006#24 = #rem00006#22 - #rem00006#23;
               #rem00006#26 = #rem00006#24 % #rem00006#27;
               #rem00006#28 = #rem00006#25 + #rem00006#26;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI #2#2 = "P";     |PDEFECTO #3, 29, 32;    |FINSI;   || solo patrimonio
|FPRC;

|PROCESO CalcuRenta;
    |SI #rem00021#30 ! 0;
       Calc = (#rem00021#15 * #rem00021#30) / 365;
       |SI #rem00021#17 = "S";
          Calc = Calc % 1.1;
       |SINO;
          Calc = Calc % 2;
       |FINSI;
       #rem00006#29 = #rem00006#29 + (Calc % Parte);
    |FINSI;
    |SI #rem00021#32 ! 0;
       Calc = (#rem00021#15 * #rem00021#32) / 365;
       |SI #rem00021#17 = "S";
          Calc = Calc % 1.1;
       |SINO;
          Calc = Calc % 2;
       |FINSI;
       #rem00006#29 = #rem00006#29 + (Calc % Parte);
    |FINSI;
    |SI #rem00021#31 ! 0;
       |SI #rem00021#37 = "A";
          #rem00006#29 = #rem00006#29 + (((#rem00021#38 * #rem00021#31) / 365) % Parte);
       |SINO;
          #rem00006#29 = #rem00006#29 + (#rem00021#38 % Parte);
       |FINSI;
    |FINSI;

    #rem00006#30 = 25;
    #rem00006#31 = #rem00006#29 % 25;

    |SI #2#2 = "R";     |PDEFECTO #3, 20, 29;    |FINSI;   || solo renta
|FPRC;

|PROCESO Familiar;
     nConta = nConta + 1;
     |SI nFamiliar = nConta;
         #rem00005#6 = #101#2;
         #rem00005#7 = #101#3;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101;
     #101#1;
     13;
     #100#0,  1, "S";
     #100#0, 99, "S";
     ;
     NULL, Familiar;
|FIN;

|PROCESO Imprime;
|ABRE #100;
#100#0 = #2#0;
|LEE 040#100=;
|SI FSalida ! 0;  |DDEFECTO  #100;  |FINSI;
|CIERRA #100;

   |SI Seleccion = "CONYUGE   ";
       #rem00005#6 = #100#35;
       #rem00005#7 = #100#39;
   |FINSI;

   |SI Seleccion = "CONYUGE   ";
       #rem00005#6 = #100#35;
       #rem00005#7 = #100#39;
   |FINSI;

   nConta = 0;
   |SI Seleccion = "1 FAMILIAR";
       nFamiliar = 1;
       |BUCLE rem00101;
   |FINSI;

   |SI Seleccion = "2 FAMILIAR";
       nFamiliar = 2;
       |BUCLE rem00101;
   |FINSI;

   |SI Seleccion = "3 FAMILIAR";
       nFamiliar = 3;
       |BUCLE rem00101;
   |FINSI;

   |SI Seleccion = "4 FAMILIAR";
       nFamiliar = 4;
       |BUCLE rem00101;
   |FINSI;

enCodProv = #100#69;
enCodPobl = #100#70;
|HAZ LeeHacienda;

|SI #rey00104#19 = "P";
   |SI Form = 1;
      |INFOR "m214h002";  |PRINT;   |PIEINF;  |FININF;
   |FINSI;
   |SI Form = 2;
      |INFOR "m214h001";  |PRINT;   |PIEINF;  |FININF;
   |FINSI;
   |SI Form = 3;
      |INFOR "m214h003";  |PRINT;   |PIEINF;  |FININF;
   |FINSI;
|SINO;
   aAlfa = "C:\MODELOS\RENTA\214\"; |RMKDIR aAlfa;
   aAlfa = aAlfa + "214" + (("00000" + #rem00005#0) % -105) + ".sec";
   |XABRE "WCB", aAlfa, Handle;
   |SI FSalida ] 0;
      Cadena = "214";
      TipoDato = "A"; LongDec = 0;
      Long = 16; aAlfa = #rem00100#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 20; aAlfa = #rem00100#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
      aAlfa = (("00" + #rem00100#69) % -102) + (("000" + #rem00100#70) % -103);
      TipoDato = "N";
      Long = 5;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";
      Long = 9;  aAlfa = #rem00100#1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 40; aAlfa = #rem00100#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 4;  aAlfa = #rem00005#2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      Cadena = Cadena + "0A";
      Long = 16; aAlfa = #rem00005#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00100#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 25; aAlfa = #rem00100#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      Long = 5;  aAlfa = #rem00100#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Cadena = Cadena + " "; TipoDato = "A";
      Long = 2;  aAlfa = #rem00100#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00100#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00100#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 20; aAlfa = #rem00100#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      aAlfa = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
      Long = 5;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";
      Long = 20; aAlfa = #rem00100#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      Long = 2;  aAlfa = #rem00100#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";
      Long = 14; aAlfa = #rem00100#78; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |XGRABA Handle, Cadena; Cadena = "";

      TipoDato = "N"; LongDec = 2;
      Long = 11; aAlfa = #rem00005#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 3;  aAlfa = #rem00005#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
      nCalc = #rem00005#25 + #rem00005#26;
      Long = 11; aAlfa = nCalc;        |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
      LongDec = 0;
      Long = 3;  aAlfa = #rem00005#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
      LongDec = 2;
      Long = 11; aAlfa = #rem00005#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 11; aAlfa = #rem00005#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |XGRABA Handle, Cadena; Cadena = ""; LongDec = 0;

      TipoDato = "A";
      Long = 2;  aAlfa = #rem00005#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 25; aAlfa = #rem00005#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      Long = 5;  aAlfa = #rem00005#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Cadena = Cadena + " ";
      TipoDato = "A";
      Long = 2;  aAlfa = #rem00005#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00005#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00005#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
      aAlfa = (("00" + #rem00100#40) % -102) + (("000" + #rem00100#41) % -103);
      TipoDato = "N";
      Long = 5;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";
      Long = 20; aAlfa = #rem00005#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      Long = 2;  aAlfa = #rem00005#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";
      Long = 20; aAlfa = #rem00005#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |XGRABA Handle, Cadena; Cadena = "";

      Long = 9;  aAlfa = #rem00005#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 40; aAlfa = #rem00005#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00005#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 25; aAlfa = #rem00005#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      Long = 5;  aAlfa = #rem00005#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Cadena = Cadena + " ";
      TipoDato = "A";
      Long = 2;  aAlfa = #rem00005#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00005#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 2;  aAlfa = #rem00005#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 20; aAlfa = #rem00005#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
      aAlfa = (("00" + #rem00005#54)  % -102) + (("000" + #rem00005#55) % -103);
      TipoDato = "N";
      Long = 5;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";
      Long = 20; aAlfa = #rem00005#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";
      Long = 2;  aAlfa = #rem00005#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
      |XGRABA Handle, Cadena; Cadena = "";

      Long = 99; aAlfa = #rem00005#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Cadena = Cadena + " ";
      Long = 9;  aAlfa = #rem00005#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 60; aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 60; aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      |XGRABA Handle, Cadena; Cadena = "";

      Long = 60; aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 60; aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 60; aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      Long = 50; aAlfa = "";           |HAZ Formateo; Cadena = Cadena + aAlfa;
      Cadena = Cadena + &13 + &10;
      |XGRABA Handle, Cadena; Cadena = "";

      |XCIERRA Handle;
   |SINO;
      nSwError  = 1;
      aAlfa = "    Problemas al generar el fichero de la empresa " + (("00000" + #rem00005#0) % -105);
      |MENAV aAlfa;
   |FINSI;
|FINSI;
|FPRC;

|PROCESO CargaDatos;
LinMax = #rem00002#1;
/*
   |SI #rem00002#4 = "GANANCIAL "; |O #rem00002#4 = "CONJUNTA  ";
      |SI Primero = 0;
         SwPatrim = 1;
         Primero = 1;
      |SINO;
         SwPatrim = 0;
      |FINSI;
   |SINO;
      SwPatrim = 1;
   |FINSI;
*/

   |ABRE #rem00021;
   |ABRE #rem00005;
   #rem00005#0 = #rem00002#0;
   #rem00005#1 = #rem00002#1;
   |LEE 010#rem00005.=;
   |SI FSalida = 0;
      SwDatos = 1;
      #rem00021#0 = #rem00002#0;
      #rem00021#1 = #rem00002#1;
      |LEE 010#rem00021.=;
      |SI FSalida = 0;
         |SI #rem00002#2 = "R"; |O #rem00002#2 = "A"; |HAZ CalcuRenta; |FINSI;
         |SI #reparame#15 = "S";
            |SI SwPatrim = 0;
               |SI #rem00002#2 = "P"; |O #rem00002#2 = "A";
                  |HAZ CalcuPatri;
                  SwPatrim = 1;
               |FINSI;
            |FINSI;
         |SINO;
            |SI #rem00002#2 = "P"; |O #rem00002#2 = "A"; |HAZ CalcuPatri; |FINSI;
         |FINSI;
         #rem00006#32 = #rem00006#28 + #rem00006#31;   || total a ingresar (punto 7)
      |FINSI;
   |FINSI;
   |CIERRA #rem00005;

|FPRC;

|PROCESO Carga214;
   |SI #rem00002#4 = "GANANCIAL "; |O #rem00002#4 = "CONJUNTA  ";
      |SI Seleccion ! "TITULAR   "; |Y Seleccion ! "CONYUGE   ";
         |ACABA;
      |SINO;
         Parte = 50;
      |FINSI;
   |SINO;
      |SI #rem00002#4 = "VARIOS    ";
         |SI Seleccion = "TITULAR   "; Parte = #rem00002#8;  |FINSI;
         |SI Seleccion = "CONYUGE   "; Parte = #rem00002#9;  |FINSI;
         |SI Seleccion = "1 FAMILIAR"; Parte = #rem00002#10; |FINSI;
         |SI Seleccion = "2 FAMILIAR"; Parte = #rem00002#11; |FINSI;
         |SI Seleccion = "3 FAMILIAR"; Parte = #rem00002#12; |FINSI;
         |SI Seleccion = "4 FAMILIAR"; Parte = #rem00002#13; |FINSI;
         |SI Parte = 0; |ACABA; |FINSI;
      |SINO;
         |SI Seleccion ! #rem00002#4; |ACABA; |SINO; Parte = 100; |FINSI;
      |FINSI;
   |FINSI;
   |HAZ CargaDatos;
|FPRC;

|DEFBUCLE Carga214;
#rem00002#1;
;
Empresa,001;
Empresa,999;
;
NULL,Carga214;
|FIN;

|PROCESO Empresas;
   Seleccion = "TITULAR   "; SwDatos = 0;
     SwPatrim = 0; |DDEFECTO #rem00006; |BUCLE Carga214;
     |SI SwDatos ! 0; |HAZ Imprime; |FINSI;
   Seleccion = "CONYUGE   "; SwDatos = 0;
     SwPatrim = 0; |DDEFECTO #rem00006; |BUCLE Carga214;
     |SI SwDatos ! 0; |HAZ Imprime; |FINSI;
   Seleccion = "1 FAMILIAR"; SwDatos = 0;
     SwPatrim = 0; |DDEFECTO #rem00006; |BUCLE Carga214;
     |SI SwDatos ! 0; |HAZ Imprime; |FINSI;
   Seleccion = "2 FAMILIAR"; SwDatos = 0;
     SwPatrim = 0; |DDEFECTO #rem00006; |BUCLE Carga214;
     |SI SwDatos ! 0; |HAZ Imprime; |FINSI;
   Seleccion = "3 FAMILIAR"; SwDatos = 0;
     SwPatrim = 0; |DDEFECTO #rem00006; |BUCLE Carga214;
     |SI SwDatos ! 0; |HAZ Imprime; |FINSI;
   Seleccion = "4 FAMILIAR"; SwDatos = 0;
     SwPatrim = 0; |DDEFECTO #rem00006; |BUCLE Carga214;
     |SI SwDatos ! 0; |HAZ Imprime; |FINSI;
|FPRC;

|PROGRAMA;
    |HAZ PreparaInformes;

    |CLS;
    |CABEZA "Impresion 214";
    |PINPA #0#0;
    |DDEFECTO #0;
    |PINDA #0#0; ||HAZ PintaMoneda;
    |ENDATOS #1#0;
    |SI FSalida = 0;

       |ABRE #reparame;  |LEE 010#reparame.p;  |CIERRA #reparame;
       |ABRE #retabla3;  |LEE 010#retabla3.p;  |CIERRA #retabla3;

       |SI #rey00104#19 = "P";
          |IMPRE 0;
          |SI FSalida < 0; |ACABA; |FINSI;

          |MENU formato;
          Form = FSalida;
          |SI Form < 1; |O Form > 3; |ACABA; |FINSI;
       |FINSI;

       nSwError = 0;
       |ABRE #rem00002;
       |PARA Cont = 0; |SI Cont [ 17; |HACIENDO Cont = Cont + 1;
          Empresa = #rey00104#Cont#;
          |SI Empresa ! 0;
             |HAZ Empresas;
          |FINSI;
       |SIGUE;
       |CIERRA #rem00002;

       |SI #rey00104#19 = "P";
          |FINIMP;
       |SINO;
          |SI nSwError = 0;
             |MENAV "    Ficheros generados correctamente.";
          |SINO;
             |MENAV "    Se han encontrado problemas al abir algunos ficheros.";
             |ERROR;
          |FINSI;
       |FINSI;
    |FINSI;
|FPRO;

|PROCESO PintaMoneda;
|VARIABLES;
  {-1}aMoneda   = "";
      aMoneda1  = "LEER";
      aMoneda2  = "";
|FIN;
     aAlfa = " Moneda de emision : ";
     IaMoneda = aMoneda1<-;
     |ESPECIFICA "MODO_VER_EURO", aMoneda;
     |SI aMoneda2 = "0";
         aAlfa = aAlfa + "PESETAS";
     |SINO;
         aAlfa = aAlfa + "EUROS  ";
     |FINSI;
     |ATRI I; |PINTA 1622, aAlfa; |ATRI N;
|FPRC;

|PROCESO Formateo;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |QBF aAlfa;
      |SI aAlfa = "";         aAlfa = "0" * 8; |FINSI;
      |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
|FPRC;
