|FICHEROS;
      rew99999 #999;

     &refere1@ #1001;
     &refere2@ #1002;

      refere3@ #0;
      refere4@ #1;
      refere5@ #2;
      refere6@ #3;
|FIN;

|VARIABLES;
      aDef             = "";
      aAlfa            = "";
      aAlfa1           = "";
      aFichero         = "";
      aCaracter        = "";
      aLong            = "";

      nCoefi           = 0;
      nSwFich          = 0;
      nLinea           = 0;
      nCampo           = 0;
      nCampo1          = 0;
      nCampo2          = 0;
      nCampo3          = 0;
      nResta           = 0;
      nValor           = 0;
      nConta           = 0;
      nMinFam          = 0;
      nMinFamE         = 0;
      nEdad            = 0;
      nTHijos          = 0;
      nHijos3          = 0;
      nHijos16         = 0;
      nHijosM33        = 0;
      nHijosM65        = 0;
      nTotalH          = 0;
      nTAscen          = 0;
      nAscenM33        = 0;
      nAscenM65        = 0;
      nImput           = 0;
      nResto           = 0;
      nAjuste          = 0;
      nAjuste2         = 0;
      nAjuste3         = 0;
      nAjuste4         = 0;
      nLimite          = 0;
      nLimitee         = 0;
      nLimiteT         = 0;
      nAcumLimite      = 0;
      nTipoMedio       = 0;
      nTipoMedio1      = 0;
      nTipoMedio2      = 0;
      nValor1          = 0;
      nValor2          = 0;
      nValor3          = 0;
      nValor4          = 0;
      nValor5          = 0;
      nValor6          = 0;
      nValor7          = 0;
      nValor8          = 0;
      nValor9          = 0;
      nValorP          = 0;
      nValor38         = 0;
      nValor43         = 0;
      nValor33         = 0;
      nValor32         = 0;
      nValor74         = 0;
      nValor47         = 0;
      nValor48         = 0;
      nValor49         = 0;
      nValor50         = 0;
      nValor51         = 0;
      nValor52         = 0;
      nValor53         = 0;
      nValor54         = 0;
      nValor79         = 0;
      nValor89         = 0;
      nValorA          = 0;
      nValorB          = 0;
      nValorC          = 0;
      nValorD          = 0;
      nValorE          = 0;
      nValorF          = 0;
      nValorG          = 0;
      nValorH          = 0;
      nValorP1         = 0;
      nValorP2         = 0;
      nValorB3         = 0;
      nValorC1         = 0;
      nValorC2         = 0;
      nParte1          = 0;
      nParte2          = 0;
      nTipo1           = 0;
      nTipo2           = 0;
      nCuota           = 0;
      nCuota44         = 0;
      nCuotaT          = 0;
      nCuota1          = 0;
      nCuotaAnt        = 0;
      nBaseEsp         = 0;
      nAnuHijos        = 0;
      nSumaAyer        = 0;
      nSumaHoy         = 0;
      nDiferencia      = 0;
      nBase            = 0;
      nBase1           = 0;
      nBase2           = 0;
      nBaseViv         = 0;
      nPorceBase       = 0;
      nFactor          = 0;
      nValorTit        = 0;
      nValorTit1       = 0;
      nValorTit2       = 0;
      nValorCon        = 0;
      nValorCon1       = 0;
      nValorCon2       = 0;
      nCuotaIntegra    = 0;
      nLimite1         = 0;
      nLimite2         = 0;
      nLimite25        = 0;
      nLimite35        = 0;
      nLimite70        = 0;
      nLimite50        = 0;
      nLimite100       = 0;
      nAcum            = 0;
      nAplicado        = 0;
      nDeducido        = 0;
      nImputT          = 0;
      nImputC          = 0;
      nTotalHT         = 0;
      nTotalHC         = 0;
      nExceso          = 0;
      nPagadores       = 0;
      nExcesoT         = 0;
      nExcesoC         = 0;
      nSwConyuge       = 0;
      nSwTitular       = 0;
      nSwBorrar        = 0;
      nConvi           = 0;
      nValencianaT     = 0;
      nValencianaC     = 0;
      nValenciana4     = 0;
      nValenciana10    = 0;
      nValenciana14    = 0;
      nSwConjunta      = 0;
      nSwConjuntaE     = 0;
      nCompeT          = 0;
      nCompeC          = 0;
      nLong            = 0;
      nSuma            = 0;
      nDeci            = 0;
      nPosi            = 0;
      nCaracter        = 0;
      nCompar          = 0;

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaPathDef        = "";
     &eaContri         = "";
     &enMinusvalia     = 0;
     &eaMinuAyuda      = "";
     &enBloque         = 0;
     &eaCasilla        = "";
     &enImporte        = 0;
     &enSwAcum         = 0;
     &eaLiquida        = "";
     &enNomeDat        = 0;
     &eaMuerto         = "";
|FIN;

|PROCESO CalcE;
     |SI #0#18 = "S";
         |SI nAnuHijos = 0;
             enBloque = 20; eaCasilla = " 51"; |HAZ SacaImporte; nValor51 = enImporte;
             enBloque = 21; eaCasilla = " 52"; |HAZ SacaImporte; nValor52 = enImporte;
         |SINO;
             enBloque = 27; eaCasilla = " 51"; |HAZ SacaImporte; nValor51 = enImporte;
             enBloque = 27; eaCasilla = " 52"; |HAZ SacaImporte; nValor52 = enImporte;
         |FINSI;

         enBloque = 29;  eaCasilla = " 53"; |HAZ SacaImporte; nValor53 = enImporte;
         enBloque = 29;  eaCasilla = " 54"; |HAZ SacaImporte; nValor54 = enImporte;
         enBloque = 33;  eaCasilla = " 79"; |HAZ SacaImporte; nValor79 = enImporte;
         enBloque = 37;  eaCasilla = " 89"; |HAZ SacaImporte; nValor89 = enImporte;
         enBloque = 13;  eaCasilla = " 38"; |HAZ SacaImporte; nValor38 = enImporte;

         nValorP = ((nValor51 + nValor52) / (nValor51 + nValor52 + nValor53 + nValor54)) * 100;
         nValor1 = nValor79 % nValorP;
         nValor2 = nValor89 % nValorP;

         nValor3 = ((nValor1 - nValor2) / nValor38) * 100;

         aAlfa  = nValor3;
         aLong  = aAlfa % 0;
         nLong  = aLong;
         nSuma  = 0;
         nDeci  = 0;
         aAlfa1 = "";
         |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
               nPosi = (nCaracter * 100) + 1;
               aCaracter = aAlfa % nPosi;
               |SI aCaracter = ".";
                   nSuma = 1;
               |SINO;
                   |SI nSuma = 1;  nDeci = nDeci + 1;  |FINSI;
                   |SI nDeci = 3;  |SAL;               |FINSI;
               |FINSI;
               aAlfa1 = aAlfa1 + aCaracter;
         |SIGUE;

         nValor3 = aAlfa1;
         nValor4 = (nValor3 * (#0#7 / #2#8) * nValor38)  / 100;

         #0#15 = (N\ #0#13 + #0#14);

         |SI nValor4 < #0#16;
             #0#15   = nValor4;
         |SINO;
             #0#17 = 0;
         |FINSI;
     |FINSI;

     enSwAcum  = 1;
     enBloque  = 38;
     eaCasilla = "102";
     enImporte = #0#15;
     |HAZ GrabaLineal;

     enSwAcum  = 1;
     enBloque  = 38;
     eaCasilla = "103";
     enImporte = #0#17;
     |HAZ GrabaLineal;

     #1#5 = (N\ #1#5 + #0#15);
|FPRC;

|PROCESO CalculaE;
     aDef    = eaPathDef + "rem01023.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1023"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1026"#;  |FINSI;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1034"#;  |FINSI;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;
     #1#5 = 0;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     #0#3 = 1;
     |LEE 101#0];
     |PARA;  |SI FSalida = 0;  |Y #0#0 = #1001#0;  |Y #0#1 = #1001#1; |Y #0#2 = #1001#2; |HACIENDO;
             |LIBERA #0;
             |HAZ CalcE;
             |GRABA 020#0a;
             |LIBERA #0;

             |LEE 101#0s;
     |SIGUE;
     |LIBERA #0;
     |CIERRA #0;

     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;

     nValor = 0;
     enBloque = 38; eaCasilla = " 96"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = " 97"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = " 98"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = " 99"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "100"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "101"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "102"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "103"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "104"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "105"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 38;
     eaCasilla = "106";
     enImporte = nValor;
      |HAZ GrabaLineal;

     nValor1 = enImporte;

     enBloque  = 37; eaCasilla = " 95"; |HAZ SacaImporte; nValor = enImporte - nValor;
     enSwAcum  = 0;
     enBloque  = 38;
     eaCasilla = "107";
     |SI nValor < 0;
          nValor2 = -nValor;
          |SI nValor2 > nValor1;
               nValor = -nValor1;
          |FINSI;
     |FINSI;
     enImporte = nValor;
     |HAZ GrabaLineal;

     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO CalculaF;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01013.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1013"#;  |FINSI;

     |ABRE #0;

     |ABRE #1;
     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = enComplementaria;
     #0#2 = "          ";
     |LEE 101#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |Y #0#1 = enComplementaria;  |HACIENDO;
            #1#0 = #0#0;
            #1#1 = #0#1;
            #1#2 = #0#2;
            |LEE 040#1=;
            |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

            #0#23  = (N\ #0#3 + #0#7  + #0#11 + #0#13 + #0#14 + #0#15 + #0#17);
            #0#24  = (N\ #0#4 + #0#12 + #0#16);
            nResta = #0#23 - #0#24;
            #0#25 = nResta;
            #0#26 = 0;
            |SI nResta < 0;
                #0#26 = -nResta;
                #0#25 = 0;
            |FINSI;

            #0#27  = (N\ #1#3 + #0#5 + #0#19 + #0#20 + #0#21);
            #0#28  = (N\ #1#4 + #0#6 + #0#18 + #0#22);
            nResta = #0#27 - #0#28;
            #0#29  = nResta;
            #0#30  = 0;
            |SI nResta < 0;
                #0#30 = -nResta;
                #0#29 = 0;
            |FINSI;

            |GRABA 020#0a;
            |LIBERA #0;

            #1001#0   = #0#0;
            #1001#1   = #0#1;
            #1001#2   = #0#2;

            enSwAcum  = 0;
            enBloque  = 8;
            eaCasilla = " 31";  enImporte = #0#25;   |HAZ GrabaLineal;

            enBloque  = 15;
            eaCasilla = " 39";  enImporte = #0#29;   |HAZ GrabaLineal;

            |LEE 101#0s;
     |SIGUE;
     |LIBERA #0;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO CalculaG;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     #0#3     = 0;
     enBloque = 1; eaCasilla = " 07"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 2; eaCasilla = " 11"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 3; eaCasilla = " 16"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 4; eaCasilla = " 17"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 4; eaCasilla = " 18"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 4; eaCasilla = " 19"; |HAZ SacaImporte; #0#3 = (N\ #0#3 - enImporte);
     enBloque = 4; eaCasilla = " 20"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 4; eaCasilla = " 22"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 5; eaCasilla = " 23"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 5; eaCasilla = " 24"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 5; eaCasilla = " 25"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 5; eaCasilla = " 26"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);
     enBloque = 5; eaCasilla = " 27"; |HAZ SacaImporte; #0#3 = (N\ #0#3 + enImporte);

     #0#4 = 0;
     |SI #0#3 > 0;
         |SI #1#26 > 0;       #0#4 = #1#26;   |FINSI;
          nValor   = #0#3 % 10;
         |SI #0#4  > nValor;  #0#4 = nValor;  |FINSI;
     |FINSI;

     nValor = #0#3 - #0#4;
     |SI #0#5 > nValor;
         #0#5 = nValor;
     |FINSI;
     |SI #0#5 < 0;  #0#5 = 0;  |FINSI;

     #0#6 = (N\ #0#3 - #0#4 - #0#5);
     ||SI #0#6 < 0;  #0#6 = 0;  |FINSI;

     enBloque = 8; eaCasilla = " 31"; |HAZ SacaImporte; #0#7 = (N\ enImporte);

     #0#8  = (N\ #0#6 +  #0#7);

     enBloque = 15; eaCasilla = " 39"; |HAZ SacaImporte; #0#9 = (N\ enImporte);

     |SI #0#10 > #0#9;
         #0#10 = #0#9;
     |FINSI;
     |SI #0#10 < 0;  #0#10 = 0;  |FINSI;

     #0#11 = (N\ #0#9 -  #0#10);

     enSwAcum  = 0;
     enBloque  = 6;
     eaCasilla = " 28";  enImporte = #0#3;   |HAZ GrabaLineal;

     enBloque  = 7;
     eaCasilla = " 29";  enImporte = #0#4;   |HAZ GrabaLineal;
     eaCasilla = " 30";  enImporte = #0#5;   |HAZ GrabaLineal;

     enBloque  = 8;
     eaCasilla = " 31";  enImporte = #0#7;   |HAZ GrabaLineal;

     enBloque  = 15;
     eaCasilla = " 39";  enImporte = #0#9;   |HAZ GrabaLineal;
     eaCasilla = " 40";  enImporte = #0#10;  |HAZ GrabaLineal;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO Familiar1;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #1001#0;
     #1#1 = 1;
     |LEE 040#1];
     |PARA; |SI FSalida = 0;  |Y #1#0 = #1001#0;  |HACIENDO;
            nImputT = 0;
            nImputC = 0;
            nCompar = #1#11 / 100;

            |SI nConta = 1;
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "2";  nImput = 0;    nImputC = 1;    |FINSI;
                |SI #1#7 = "1";  nImput = 1;    nImputT = 1;    |FINSI;
                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "2";  nImput = 0;        nImputC = nCompar; |FINSI;
                    |SI #1#7 = "1";  nImput = nCompar;  nImputT = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 2;
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 0;    nImputT = 1;    |FINSI;
                |SI #1#7 = "2";  nImput = 1;    nImputC = 1;    |FINSI;
                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "1";  nImput = 0;        nImputT = nCompar; |FINSI;
                    |SI #1#7 = "2";  nImput = nCompar;  nImputC = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 8;  |Y eaMuerto = "C";
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "2";  nImput = 0;    nImputC = 1;    |FINSI;
                |SI #1#7 = "1";  nImput = 1;    nImputT = 1;    |FINSI;
                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "2";  nImput = 0;        nImputC = nCompar; |FINSI;
                    |SI #1#7 = "1";  nImput = nCompar;  nImputT = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 8;  |Y eaMuerto = "T";
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 0;    nImputT = 1;    |FINSI;
                |SI #1#7 = "2";  nImput = 1;    nImputC = 1;    |FINSI;
                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "1";  nImput = 0;        nImputT = nCompar; |FINSI;
                    |SI #1#7 = "2";  nImput = nCompar;  nImputC = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 7;
                nImput = 1;
                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    nImput = nCompar;
                |FINSI;
            |FINSI;

            |SI #1#11 = -1;
                |SI #1#4 = "DESCENDIENTE";
                    |SI #1#5 > 0;
                        nEdad   = 1999 - #1#5;

                        |SI nEdad < 25;
                            |SI nEdad [ 17;
                                nSwConjunta = 1;

                                |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                    nSwConjuntaE = 1;
                                |FINSI;

                                |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                    nSwConjuntaE = 1;
                                |FINSI;
                            |FINSI;
                        |SINO;
                            |SI #1#6 ] 33;
                                nSwConjunta  = 1;

                                |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                    nSwConjuntaE = 1;
                                |FINSI;

                                |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                    nSwConjuntaE = 1;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;

                #1#4 = "";
            |FINSI;

            |SI #1#4 = "DESCENDIENTE";
                |SI #1#5 > 0;
                    nEdad   = 1999 - #1#5;

                    |SI nEdad < 25;
                        |SI nEdad [ 17;
                            nSwConjunta = 1;

                            |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                nSwConjuntaE = 1;
                            |FINSI;
                        |FINSI;

                        nTHijos  = nTHijos  + nImput;
                        nTotalH  = nTotalH  + 1;
                        nTotalHT = nTotalHT + nImputT;
                        nTotalHC = nTotalHC + nImputC;
                        |SI nTotalH > 2;  nExcesoT = nExcesoT + nImputT;  |FINSI;
                        |SI nTotalH > 2;  nExcesoC = nExcesoC + nImputC;  |FINSI;
                    |SINO;
                        |SI #1#6 ] 33;
                            nSwConjunta  = 1;

                            |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                nSwConjuntaE = 1;
                            |FINSI;

                            nTHijos     = nTHijos + nImput;
                            nTotalH     = nTotalH + 1;
                            nTotalHC    = nTotalHC + nImputC;
                            nTotalHT    = nTotalHT + nImputT;
                            |SI nTotalH > 2;  nExcesoT = nExcesoT + nImputT;  |FINSI;
                            |SI nTotalH > 2;  nExcesoC = nExcesoC + nImputC;  |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI #1#6 ] 65;
                        nHijosM65 = nHijosM65 + nImput;
                    |SINO;
                        |SI #1#6 ] 33;
                            nHijosM33 = nHijosM33 + nImput;
                        |FINSI;
                    |FINSI;

                    |SI nEdad < 3;
                        nHijos3 = nHijos3  + nImput;
                    |SINO;
                        |SI nEdad < 16;
                            nHijos16 = nHijos16 + nImput;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |SI #1#4 = "ASCENDIENTE ";
                |SI #1#5 > 0;
                    nEdad   = 1999 - #1#5;
                    |SI nEdad ] 65; nTAscen = nTAscen + nImput;  |FINSI;

                    |SI #1#6 ] 65;
                        |SI nEdad < 65; nTAscen = nTAscen + nImput;  |FINSI;
                        nAscenM65 = nAscenM65 + nImput;
                    |SINO;
                        |SI #1#6 ] 33;
                            |SI nEdad < 65; nTAscen = nTAscen + nImput;  |FINSI;
                            nAscenM33 = nAscenM33 + nImput;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |LEE 040#1s;
     |SIGUE;
     |CIERRA #1;

     |SI nConta ! 7;
         |SI nConta = 1;  nTotalH = nExcesoT;  |FINSI;
         |SI nConta = 2;  nTotalH = nExcesoC;  |FINSI;

         |SI nConta = 8;  |Y eaMuerto = "C";
             nTotalH = nExcesoT;
         |FINSI;

         |SI nConta = 8;  |Y eaMuerto = "T";
             nTotalH = nExcesoC;
         |FINSI;
     |SINO;
         nTotalH = nTHijos - 2;
     |FINSI;

     |SI nTotalH < 0;  nTotalH = 0;  |FINSI;
|FPRC;

|PROCESO CalculaH;
     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM65  = 0;
     nTAscen    = 0;
     nAscenM33  = 0;
     nAscenM65  = 0;
     nExcesoT   = 0;
     nExcesoC   = 0;
     nTotalHT   = 0;
     nTotalHC   = 0;
     nTotalH    = 0;

     aDef    = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1035"#;  |FINSI;

     aDef    = eaPathDef + "rem00101.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     |ABRE #2;
     #2#0 = #1001#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |SI #999#6 > 0;  |Y nConta < 7;
         nEdad = 1999 - #999#6;
         #0#3  = 550000;
         |SI nEdad   ] 65;  #0#3 = 650000;   |FINSI;
         |SI #999#3  ] 33;  #0#3 = 850000;   |FINSI;
         |SI #999#3  ] 65;  #0#3 = 1150000;  |FINSI;

         |SI nConta = 1;  |O nConta = 2;
             nMinFam = nMinFam + #0#3;

             |SI nConta = 1;  |Y eaMuerto = "C";
                 nMinFamE = nMinFamE + #0#3;
             |FINSI;

             |SI nConta = 2;  |Y eaMuerto = "T";
                 nMinFamE = nMinFamE + #0#3;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nConta = 7;  #0#3 = nMinFam;   |FINSI;
     |SI nConta = 8;  #0#3 = nMinFamE;  |FINSI;

     |SI nConta = 1;  |O nConta = 2;  |O nConta = 7;  |O nConta = 8;
         |HAZ Familiar1;
     |FINSI;

     |SI nConta = 1;
         |ABRE #999;
         |SELECT #2#999;
         #999#1 = "CONYUGE   ";
         |LEE 040#999=;
         |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
         |CIERRA #999;

         nConvi = 0;
         |SI #2#95 = "S";  nConvi = 1;  |FINSI;

         |SI #999#6  = 0; |Y nTHijos ! 0; |Y nConvi = 0;
             nMinFam = nMinFam + 350000;
         |FINSI;
     |FINSI;

     #0#4 = (N\ (nTHijos * 200000) + (nTotalH * 100000) + (nHijos3 * 50000));
     #0#4 = (N\ #0#4 + (nHijos16 * 25000) + (nHijosM33 * 300000) + (nHijosM65 * 600000));
     #0#5 = (N\ (nTAscen * 100000) + (nAscenM65 * 600000) + (nAscenM33 * 300000));
     #0#6 = (N\ #0#3 + #0#4 + #0#5);

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO CalculaI;
     aDef    = eaPathDef + "rem01036.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1036"#;  |FINSI;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1035"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     #0#3 = #1#8;
     #0#4 = #1#11;

     nResto = #0#3 - #2#6;
     |SI nResto < 0;
         nResto = -nResto;
     |SINO;
         nResto = 0;
     |FINSI;

     #0#5 = 0;
     |SI #0#3 > 0;
                          #0#5 = #2#6;
         |SI nResto ! 0;  #0#5 = (N\ #2#6 - nResto);   |FINSI;
         |SI #0#5 < 0;    #0#5 = 0;                    |FINSI;
     |FINSI;

     |SI #0#5 < #2#6;
         nResto = #2#6 - #0#5;
     |FINSI;

     #0#6 = nResto;
     |SI #0#6 > #0#4;  #0#6 = #0#4;  |FINSI;

     #0#7 = (N\ #0#3 - #0#5);
     #0#8 = (N\ #0#4 - #0#6);
     #0#9 = (N\ #0#7 + #0#8);

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum  = 0;
     enBloque  = 9;
     eaCasilla = " 32";  enImporte = #0#5;   |HAZ GrabaLineal;

     enBloque  = 10;
     eaCasilla = " 33";  enImporte = #0#7;   |HAZ GrabaLineal;

     enBloque  = 16;
     eaCasilla = " 42";  enImporte = #0#6;   |HAZ GrabaLineal;

     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO LimitePlan;
     |SI nEdad [ 52;  nLimite = 1100000;  |FINSI;
     |SI nEdad = 53;  nLimite = 1184615;  |FINSI;
     |SI nEdad = 54;  nLimite = 1269231;  |FINSI;
     |SI nEdad = 55;  nLimite = 1353846;  |FINSI;
     |SI nEdad = 56;  nLimite = 1438462;  |FINSI;
     |SI nEdad = 57;  nLimite = 1523077;  |FINSI;
     |SI nEdad = 58;  nLimite = 1607692;  |FINSI;
     |SI nEdad = 59;  nLimite = 1692308;  |FINSI;
     |SI nEdad = 60;  nLimite = 1776923;  |FINSI;
     |SI nEdad = 61;  nLimite = 1861538;  |FINSI;
     |SI nEdad = 62;  nLimite = 1946154;  |FINSI;
     |SI nEdad = 63;  nLimite = 2030769;  |FINSI;
     |SI nEdad = 64;  nLimite = 2115385;  |FINSI;
     |SI nEdad ] 65;  nLimite = 2200000;  |FINSI;
|FPRC;

|PROCESO CalculaJ;
     aDef    = eaPathDef + "rem01038.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef + " " + FSalida;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1038"#;  |FINSI;

     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, refere6@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere6@#"zdat1037"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     enBloque = 5;
     eaCasilla = " 24";
     |HAZ SacaImporte;

     |SI nConta = 1;
         |ABRE #999;
         |SELECT #2#999;
         #999#1 = #1001#2;
         |LEE 040#999=;
         |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
         |CIERRA #999;

         nValor = #1#15  + #2#7  + #2#8  + #2#9 + #2#10 + #2#11 + #2#12;
         nValor = nValor + #2#13 + #2#14 + enImporte;
         |SI nValor [ 0;  nValor = 0;  |FINSI;

         nValorTit  = nValor % 20;
         nEdad      = 1999 - #999#6;
         |HAZ LimitePlan;
         |SI nValorTit > nLimite;    nValorTit = nLimite;    |FINSI;

         |SI #0#3 ! 0;                    || Para la Conjunta
             nLimite1   = nValorTit;
             nValorTit2 = 0;
             nValorTit1 = #0#3;
             |SI #0#3 > nLimite1;
                 nValorTit2 = nValorTit1 - nLimite1;
                 nValorTit1 = nLimite1;
            |FINSI;
         |FINSI;

         |SI nValorTit > nLimite;    nValorTit = nLimite;    |FINSI;

         #0#4 = 0;
         |SI #0#3 > nValorTit;
             #0#4 = #0#3 - nValorTit;
             #0#3 = nValorTit;
         |FINSI;
     |FINSI;

     |SI nConta = 2;
         |ABRE #999;
         |SELECT #2#999;
         #999#1 = #1001#2;
         |LEE 040#999=;
         |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
         |CIERRA #999;

         nValor = #1#15  + #2#7  + #2#8  + #2#9 + #2#10 + #2#11 + #2#12;
         nValor = nValor + #2#13 + #2#14 + enImporte;
         |SI nValor [ 0;  nValor = 0;  |FINSI;

         nValorCon  = nValor % 20;
         nEdad      = 1999 - #999#6;
         |HAZ LimitePlan;
         |SI nValorCon > nLimite;    nValorCon = nLimite;    |FINSI;

         |SI #0#3 ! 0;                    || Para la Conjunta
             nLimite1   = nValorCon;
             nValorCon2 = 0;
             nValorCon1 = #0#3;
             |SI #0#3 > nLimite1;
                 nValorCon2 = nValorCon1 - nLimite1;
                 nValorCon1 = nLimite1;
            |FINSI;
         |FINSI;

         |SI nValorCon > nLimite;    nValorCon = nLimite;    |FINSI;

         #0#4 = 0;
         |SI #0#3 > nValorCon;
             #0#4 = #0#3 - nValorCon;
             #0#3 = nValorCon;
         |FINSI;
     |FINSI;

     |SI nConta = 7;
         #0#3     = (N\ nValorTit1 + nValorCon1);
         #0#4     = (N\ nValorTit2 + nValorCon2);

         |ABRE #3;
         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 1;
         |LEE 040#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         nValor1 = #3#8 + #3#9;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 2;
         |LEE 040#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         nValor2 = #3#8 + #3#9;
         |CIERRA #3;

         #0#5 = nValor1 + nValor2;
     |FINSI;

     |SI nConta = 8;
         |SI eaMuerto = "T";
             nLimite = nLimite2;
             #0#3 = (N\ nValorCon1);
             #0#4 = (N\ nValorCon2);
         |SINO;
             #0#3 = (N\ nValorTit1);
             #0#4 = (N\ nValorTit2);
         |FINSI;

         |ABRE #3;
         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 1;
         |LEE 040#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         nValor1 = #3#8 + #3#9;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 2;
         |LEE 040#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         nValor2 = #3#8 + #3#9;
         |CIERRA #3;

         #0#5 = nValor1 + nValor2;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum  = 0;
     enBloque  = 11;
     eaCasilla = " 34";  enImporte = #0#3;   |HAZ GrabaLineal;
     eaCasilla = " 35";  enImporte = #0#5;   |HAZ GrabaLineal;

     |DESCARGA_DEF #refere6@;
     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO CalculaK;
     aDef    = eaPathDef + "rem01039.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1039"#;  |FINSI;

     aDef    = eaPathDef + "rem01036.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1036"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     #0#3 = #1#7;
     #0#8 = #1#8;
     #0#9 = #1#8;

     enBloque = 11; eaCasilla = " 34"; |HAZ SacaImporte; #0#4 = (N\ #0#4 + enImporte);
     enBloque = 11; eaCasilla = " 35"; |HAZ SacaImporte; #0#4 = (N\ #0#4 + enImporte);
     enBloque = 11; eaCasilla = " 36"; |HAZ SacaImporte; #0#4 = (N\ #0#4 + enImporte);

     #0#5 = (N\ #0#3 - #0#4);

     |SI #0#6 > #0#5;  #0#6 = #0#5;  |FINSI;
     |SI #0#6 < 0;  #0#6 = 0;  |FINSI;

     #0#7  = (N\ #0#5 - #0#6);
     #0#10 = (N\ #0#7 + #0#9);

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum  = 0;
     enBloque  = 10;
     eaCasilla = " 33";  enImporte = #0#3;   |HAZ GrabaLineal;

     enBloque  = 12;
     eaCasilla = " 37";  enImporte = #0#6;   |HAZ GrabaLineal;

     enBloque  = 13;
     eaCasilla = " 38";  enImporte = #0#7;   |HAZ GrabaLineal;

     enBloque  = 17;
     eaCasilla = " 43";  enImporte = #0#9;   |HAZ GrabaLineal;

     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO CalculaL;
     aDef    = eaPathDef + "rem01040.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1040"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1033"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     enBloque = 7; eaCasilla = " 29"; |HAZ SacaImporte;
     #0#3 = (N\ #1#26 - enImporte);
     #0#4 = (N\ #1#30);
     enBloque = 13; eaCasilla = " 38"; |HAZ SacaImporte;
     |SI enImporte < 0;  #0#5 = (N\ enImporte);  |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO Ajusta1;
     nAcumLimite = nAcumLimite + nAjuste;
     |SI nLimite < nAcumLimite;
         nAjuste     = nAjuste - (nAcumLimite - nLimite);
         nAcumLimite = nLimite;
     |FINSI;
|FPRC;

|PROCESO CalculaM;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     nAcumLimite = 0;
     nLimite     = 1500000;

     nAjuste = #0#12;  |HAZ Ajusta1;  #0#12 = nAjuste;
     nAjuste = #0#14;  |HAZ Ajusta1;  #0#14 = nAjuste;
     nAjuste = #0#17;  |HAZ Ajusta1;  #0#17 = nAjuste;
     nAjuste = #0#19;  |HAZ Ajusta1;  #0#19 = nAjuste;
     nAjuste = #0#28;  |HAZ Ajusta1;  #0#28 = nAjuste;

     nAjuste  = #0#12;
     nAjuste2 = 0;
     |SI #0#12 > 750000;  nAjuste = 750000;  nAjuste2 = #0#12 - 750000; |FINSI;
     #0#13   = (N\ (nAjuste % 25) + (nAjuste2 % 15));

     nAjuste  = #0#14;
     nAjuste2 = 0;
     nLimitee = 750000 - #0#12;
     |SI nLimitee < 0;  nLimitee = 0;  |FINSI;
     |SI #0#14 > nLimitee;  nAjuste = nLimitee;  nAjuste2 = #0#14 - nLimitee; |FINSI;
     #0#15   = (N\ (nAjuste % 20) + (nAjuste2 % 15));

     #0#18   = (N\ #0#17 % 15);
     #0#20   = (N\ #0#19 % 15);

     nAjuste  = #0#21;
     nAjuste2 = 0;
     |SI #0#21    > 1000000;
         nAjuste  = 1000000;
         nAjuste2 = #0#21 - 1000000;
     |FINSI;

     |SI nAjuste2 > 1000000;
         nAjuste2 = 1000000;
     |FINSI;

     #0#22 = (N\ (nAjuste % 25) + (nAjuste2 % 15));

     nAjuste3  = nAjuste + nAjuste2;

     nAjuste4 = nAjuste3 + #0#23;
     |SI nAjuste4 > 2000000;
         nAjuste4 = 2000000;
     |FINSI;

     nAjuste   = nAjuste4 - nAjuste3;
     nAjuste2  = 0;
     |SI nAjuste > 1000000;
         nAjuste2 = nAjuste - 1000000;
         nAjuste  = 1000000;
     |FINSI;

     #0#24    = (N\ (nAjuste % 20) + (nAjuste2 % 15));

     nAjuste4 = nAjuste  + nAjuste2;
     nAjuste3 = nAjuste3 + nAjuste4;

     nAjuste4 = nAjuste3 + #0#26;
     |SI nAjuste4 > 2000000;  nAjuste4 = 2000000;  |FINSI;
     nAjuste2 = nAjuste4 - nAjuste3;
     |SI #0#26 ! 0;
         #0#27 = (N\ nAjuste2 % 15);
     |FINSI;

     #0#29    = (N\ #0#28 % 15);

     #0#16    = (N\ #0#13 + #0#15);
     #0#25    = (N\ #0#22 + #0#24);

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 61";  enImporte = #0#16;   |HAZ GrabaLineal;
     eaCasilla = " 62";  enImporte = #0#18;   |HAZ GrabaLineal;
     eaCasilla = " 63";  enImporte = #0#20;   |HAZ GrabaLineal;
     eaCasilla = " 64";  enImporte = #0#25;   |HAZ GrabaLineal;
     eaCasilla = " 65";  enImporte = #0#27;   |HAZ GrabaLineal;
     eaCasilla = " 66";  enImporte = #0#29;   |HAZ GrabaLineal;

     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO Trabajo;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1010"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     nValor = 0;
     enBloque = 6;  eaCasilla = " 28"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 18; eaCasilla = " 44"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 8;  eaCasilla = " 31"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 15; eaCasilla = " 39"; |HAZ SacaImporte; nValor = nValor + enImporte;

     #1#16 = 0;
     |SI #1#15 > 2000000; |O nValor > 1000000;
         #1#16 = 375000;
     |SINO;
         |SI #1#15 < 1350001;
             #1#16 = 500000;
         |SINO;
             #1#16 = (N\ 500000 - (0.1923 * (#1#15 - 1350001)));
         |FINSI;
     |FINSI;

     nFactor = 1;
     |SI #1#20 = 1;  nFactor = 1.75;  |FINSI;
     |SI #1#20 = 2;  nFactor = 2.25;  |FINSI;
     |SI #1#20 = 3;  nFactor = 2.75;  |FINSI;

     #1#16 = (N\ #1#16 * nFactor);

     |SI #1#15 < #1#16;  #1#16 = #1#15;  |FINSI;
     |SI #1#16 [ 0;      #1#16 = 0;      |FINSI;

     #1#17 = (N\ #1#15 - #1#16);

     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;

     nPagadores = #1#19;

     enSwAcum  = 0;
     enBloque  = 1;
     eaCasilla = " 06";
     enImporte = #1#16;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 1;
     eaCasilla = " 07";
     enImporte = #1#17;
     |HAZ GrabaLineal;

     nValenciana4 = #1#9 + #1#16;
     |SI enImporte = 0;
         nValenciana4 = 0;
     |SINO;
         |SI nValenciana4 > enImporte;
             nValenciana4 = enImporte;
         |FINSI;
     |FINSI;

     enBloque = 2; eaCasilla = " 10"; |HAZ SacaImporte;  nValenciana10 = enImporte;
     enBloque = 2; eaCasilla = " 11"; |HAZ SacaImporte;
     |SI enImporte [ 0;
         nValenciana10 = 0;
     |SINO;
         |SI nValenciana10 > enImporte;
             nValenciana10 = enImporte;
         |FINSI;
     |FINSI;

     nValenciana14 = 0;
     enBloque = 3; eaCasilla = " 14"; |HAZ SacaImporte;  nValenciana14 = nValenciana14 + enImporte;
     enBloque = 3; eaCasilla = " 15"; |HAZ SacaImporte;  nValenciana14 = nValenciana14 + enImporte;
     enBloque = 3; eaCasilla = " 16"; |HAZ SacaImporte;
     |SI enImporte = 0;
         nValenciana14 = 0;
     |SINO;
         |SI nValenciana14 > enImporte;
             nValenciana14 = enImporte;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO AjusteAutono;
     aDef    = eaPathDef + "rem01043.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1043"#;  |FINSI;

     aDef    = eaPathDef + "rem01039.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1039"#;  |FINSI;

     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, refere6@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere6@#"zdat1041"#;  |FINSI;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #3;
     #3#0 = #1001#0;
     #3#1 = #1001#1;
     #3#2 = #1001#2;
     |LEE 040#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |CIERRA #3;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;                 || Ajustes Autonomias;
         |SI #1#15 ! 0;
             nValor = #2#10 % 5;
             |SI #1#15 > nValor;  #1#15 = nValor;  |FINSI;
         |FINSI;

         |SI #1#21 ! 0;
             nValor = #2#10 % 10;
             |SI #1#21 > nValor;  #1#21 = nValor;  |FINSI;
         |FINSI;

         nBase    = 0;
         nBaseViv = #3#12 + #3#14 + #3#17 + #3#19 + #3#21 + #3#23 + #3#26 + #3#28;
         |SI #1#25 ! 0;
             enBloque  = 13;
             eaCasilla = " 38";
             |HAZ SacaImporte;
             nValor1 = enImporte;

             enBloque  = 17;
             eaCasilla = " 43";
             |HAZ SacaImporte;
             nValor2 = enImporte;

             nBase      = #1#25 * 50;
             nPorceBase = 2;
             |SI nValor1 < 2500000;  |Y nValor2 [ 250000;
                 #1#25 = nBase % 3;
                 nPorceBase = 3;
             |FINSI;
         |FINSI;

         |SI #1#27 ! 0;
             nValor  = nBase + (#1#26 * 10);
             nLimite = 1500000 - nBaseViv;
             |SI nLimite < 0;  nLimite = 0;  |FINSI;

             |SI nValor > nLimite;
                 nValor1 = nValor - nLimite;
                 nValor2 = #1#26 * 10;
                 |SI nBase ] nValor1;
                     nBase = nBase - nValor1;
                     nValor1 = 0;
                 |SINO;
                     nValor1 = nValor1 - nBase;
                     nBase   = 0;
                     nValor2 = (#1#26 * 10) - nValor1;
                 |FINSI;

                 #1#25 = (N\ (nBase % nPorceBase));
                 #1#26 = (N\ (nValor2 % 10));
                 #1#27 = (N\ #1#25 + #1#26);
                 |SI #1#27 > 40000;  #1#27 = 40000;  |FINSI;
             |SINO;
                 #1#27 = (N\ #1#25 + #1#26);
                 |SI #1#27 > 40000;  #1#27 = 40000;  |FINSI;
             |FINSI;
         |FINSI;

         |SI #1#24 ! 0;
             nBase1  = ((#1#22 * 100) / 3) ! 0;
             nBase2  = ((#1#23 * 100) / 7) ! 0;
             nValor  = nBase1 + nBase2;
             nLimite = 1500000 - nBaseViv;
             |SI nLimite < 0;  nLimite = 0;  |FINSI;

             |SI nValor > nLimite;
                 nValor1 = nValor - nLimite;
                 |SI nBase1 ] nValor1;
                     nBase1  = nBase1 - nValor1;
                     nValor1 = 0;
                 |SINO;
                     nValor1 = nValor1 - nBase1;
                     nBase1  = 0;
                     nBase2  = nBase2  - nValor1;
                 |FINSI;

                 #1#22 = (N\ (nBase1 % 3));
                 #1#23 = (N\ (nBase2 % 7));
                 |SI #1#23 > 75000;  #1#23 = 75000;  |FINSI;

                 #1#24 = (N\ #1#22 + #1#23);
             |FINSI;
         |FINSI;

         |SI #1#28 ! 0;
             nValor = #2#10 % 10;
             |SI #1#28 > nValor;  #1#28 = nValor;  |FINSI;
         |FINSI;

         |SI #1#31 ! 0;
             enBloque  = 10;
             eaCasilla = " 33";
             |HAZ SacaImporte;
             nValor1 = enImporte;

             enBloque  = 9;
             eaCasilla = " 32";
             |HAZ SacaImporte;
             nValor2 = enImporte;

             nValor = nValor1 + nValor2 + nValenciana4 + nValenciana10 + nValenciana14;
             |SI nValor > 1939560;
                 #1#31 = 0;
             |FINSI;

             |SI #1#2 = "TITULAR   ";
                 nValencianaT = #1#31;
             |FINSI;

             |SI #1#2 = "CONYUGE   ";
                 nValencianaC = #1#31;
             |FINSI;

             |SI #1#2 = "CONJUNTA  ";
                 #1#31 = nValencianaT + nValencianaC;
             |FINSI;

             |SI #1#2 = "CONJUNTAE  ";
                 |SI eaMuerto = "T";
                     #1#31 = nValencianaC;
                 |SINO;
                     #1#31 = nValencianaT;
                 |FINSI;
             |FINSI;

             #1#36 = (N\ #1#29 + #1#30 + #1#31 + #1#32 + #1#33 + #1#34 + #1#35);
         |FINSI;

         |SI #1#37 ! 0;
             nValor = #2#10 % 20;
             |SI #1#37 > nValor;  #1#37 = nValor;  |FINSI;
         |FINSI;

         |GRABA 020#1a;
         |LIBERA #1;
     |FINSI;
     |CIERRA #1;

     |SI #1#8 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#8;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#12 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#12;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#16 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#16;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#17 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#17;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#20 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#20;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#24 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#24;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#27 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#27;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#36 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 75";
         enImporte = #1#36;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#15 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 76";
         enImporte = #1#15;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#21 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 76";
         enImporte = #1#21;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#28 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 76";
         enImporte = #1#28;
         |HAZ GrabaLineal;
     |FINSI;

     |SI #1#37 ! 0;
         enSwAcum  = 0;
         enBloque  = 32;
         eaCasilla = " 76";
         enImporte = #1#37;
         |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #refere6@;
     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO Tabla;
     nParte1 = 3326030;
     nParte2 = 617970;
     nResta  = 11000000;
     nTipo1  = 39.60;
     nTipo2  = 8.40;

     |SI nCuotaT [ 11000000;  |Y nCuotaT > 6600000;
         nParte1 = 1650950;
         nParte2 = 313050;
         nResta  = 6600000;
         nTipo1  = 38.07;
         nTipo2  = 6.93;
     |FINSI;

     |SI nCuotaT [ 6600000;  |Y nCuotaT > 4100000;
         nParte1 = 863950;
         nParte2 = 170050;

         nResta  = 4100000;
         nTipo1  = 31.48;
         nTipo2  = 5.72;
     |FINSI;

     |SI nCuotaT [ 4100000;  |Y nCuotaT > 2100000;
         nParte1  = 392550;
         nParte2  = 75450;

         nResta   = 2100000;
         nTipo1   = 23.57;
         nTipo2   = 4.73;
     |FINSI;

     |SI nCuotaT [ 2100000;  |Y nCuotaT > 600000;
         nParte1 = 90000;
         nParte2 = 18000;
         nResta  = 600000;
         nTipo1  = 20.17;
         nTipo2  = 3.83;
     |FINSI;

     |SI nCuotaT [ 600000;
         nParte1 = 0;
         nParte2 = 0;
         nResta  = 0;
         nTipo1  = 15;
         nTipo2  = 3;
     |FINSI;
|FPRC;

|PROCESO TipoMedio;
     enBloque = 24; eaCasilla = " 45"; |HAZ SacaImporte; nAnuHijos = enImporte;
     enBloque = 13; eaCasilla = " 38"; |HAZ SacaImporte; nCuota    = enImporte;
     enBloque = 18; eaCasilla = " 44"; |HAZ SacaImporte; nCuota44  = enImporte;
     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         |SI nCuota44 ! 0;
             nCuotaT = nCuota + nCuota44;
         |SINO;
             nCuotaT = nCuota;
         |FINSI;

         |HAZ Tabla;

         enSwAcum  = 0;
         enBloque  = 20;
         eaCasilla = " 38";
         enImporte = nCuota;
         |HAZ GrabaLineal;

         |SI nCuota < 0;  nCuota = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 20;
         eaCasilla = " 51";
         nValor2   = (nParte1 + (((nCuotaT - nResta) * nTipo1) / 100)) ! 0;
         enImporte = nValor2 ! 0;
         |SI nCuota44 ! 0;
             nValor2   = (((nValor2 * 100) / nCuotaT) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
             enImporte = nValor1 ! 0;
         |FINSI;
         |HAZ GrabaLineal;
         nValor51  = enImporte;

         enSwAcum  = 0;
         enBloque  = 21;
         eaCasilla = " 38";
         enImporte = nCuota;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 21;
         eaCasilla = " 52";
         nValor2   = (nParte2 + (((nCuotaT - nResta) * nTipo2) / 100)) ! 0;
         enImporte = nValor2 ! 0;
         |SI nCuota44 ! 0;
             nValor2   = (((nValor2 * 100) / nCuotaT) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
             enImporte = nValor1 ! 0;
         |FINSI;
         |HAZ GrabaLineal;
         nValor52   = enImporte;

         enSwAcum  = 0;
         enBloque  = 22;
         eaCasilla = "TME";
         enImporte = (((nValor51 * 100) / nCuota) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 22;
         eaCasilla = "TMA";
         enImporte = (((nValor52 * 100) / nCuota) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         |SI nAnuHijos ! 0;
             enSwAcum  = 0;
             enBloque  = 24;
             eaCasilla = " 38";
             enImporte = 0;
             |HAZ GrabaLineal;

             enSwAcum  = 0;
             enBloque  = 24;
             eaCasilla = " 45";
             enImporte = 0;
             |HAZ GrabaLineal;

             enSwAcum  = 0;
             enBloque  = 25;
             eaCasilla = " 45";
             enImporte = 0;
             |HAZ GrabaLineal;

             enSwAcum  = 0;
             enBloque  = 26;
             eaCasilla = " 45";
             enImporte = 0;
             |HAZ GrabaLineal;
         |FINSI;
         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         enSwAcum  = 0;
         enBloque  = 24;
         eaCasilla = " 38";
         enImporte = nCuota;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 24;
         eaCasilla = " 45";
         enImporte = nAnuHijos;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 25;
         eaCasilla = " 45";
         enImporte = nAnuHijos;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 26;
         eaCasilla = " 45";
         enImporte = nAnuHijos;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 24;
         eaCasilla = " 46";
         enImporte = nCuota - nAnuHijos;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 25;
         eaCasilla = " 46";
         enImporte = nCuota - nAnuHijos;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 26;
         eaCasilla = " 46";
         enImporte = nCuota - nAnuHijos;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         nCuota1 = enImporte;

         nCuotaAnt = nCuota;
         nCuota    = nAnuHijos;
         nCuotaT   = nAnuHijos;
         |HAZ Tabla;

         || Calcula de la 47

         enSwAcum  = 0;
         enBloque  = 25;
         eaCasilla = " 47";
         nValor1   = (nParte1 + (((nCuota - nResta) * nTipo1) / 100)) ! 0;
         |SI nCuota44 ! 0;
             nBase1   = (nAnuHijos + (nCuota44 * (nAnuHijos / nCuotaAnt))) ! 0;
             nCuotaT  = nBase1;
             |HAZ Tabla;

             nValor1   = (nParte1 + (((nBase1 - nResta) * nTipo1) / 100)) ! 0;
             nValor2   = (((nValor1 * 100) / nBase1) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
         |FINSI;
         enImporte = nValor1 ! 0;
         |HAZ GrabaLineal;
         nValor47 = enImporte;

         || Calcula de la 49

         enSwAcum  = 0;
         enBloque  = 26;
         eaCasilla = " 49";
         nValor1   = (nParte2 + (((nCuota - nResta) * nTipo2) / 100)) ! 0;
         |SI nCuota44 ! 0;
             nValor1   = (nParte2 + (((nBase1 - nResta) * nTipo2) / 100)) ! 0;
             nValor2   = (((nValor1 * 100) / nBase1) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
         |FINSI;
         enImporte = nValor1 ! 0;
         |HAZ GrabaLineal;
         nValor49 = enImporte;

         || Calcula de la 48

         nCuota   = nCuota1;
         nCuotaT  = nCuota1;
         |HAZ Tabla;

         enSwAcum  = 0;
         enBloque  = 25;
         eaCasilla = " 48";
         nValor1  = (nParte1 + (((nCuota - nResta) * nTipo1) / 100)) ! 0;
         |SI nCuota44 ! 0;
             nBase2    = (nCuota1 + (nCuota44 * (nCuota1 / nCuotaAnt))) ! 0;
             nCuotaT   = nBase2;
             |HAZ Tabla;

             nValor1   = (nParte1 + (((nBase2 - nResta) * nTipo1) / 100)) ! 0;
             nValor2   = (((nValor1 * 100) / nBase2) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota1 % nValor2;
         |FINSI;
         enImporte = nValor1 ! 0;
         |HAZ GrabaLineal;
         nValor48 = enImporte;

         || Calcula de la 50

         enSwAcum  = 0;
         enBloque  = 26;
         eaCasilla = " 50";
         nValor1   = (nParte2 + (((nCuota - nResta) * nTipo2) / 100)) ! 0;
         |SI nCuota44 ! 0;
             nValor1   = (nParte2 + (((nBase2 - nResta) * nTipo2) / 100)) ! 0;
             nValor2   = (((nValor1 * 100) / nBase2) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
         |FINSI;
         enImporte = nValor1 ! 0;
         |HAZ GrabaLineal;
         nValor50 = enImporte;

         enSwAcum  = 0;
         enBloque  = 27;
         eaCasilla = " 51";
         enImporte = (nValor47 + nValor48) ! 0;
         nValor51  = enImporte;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 27;
         eaCasilla = " 52";
         enImporte = (nValor49 + nValor50) ! 0;
         nValor52  = enImporte;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 28;
         eaCasilla = "TME";
         enImporte = (((nValor51 * 100) / nCuotaAnt) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 28;
         eaCasilla = "TMA";
         enImporte = (((nValor52 * 100) / nCuotaAnt) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|PROCESO Deduce;
     |SI nAcum = 0;  nAplicado = 0;  |ACABA;  |FINSI;
     |SI nLimiteT [ 0;               |ACABA;  |FINSI;

     nAcum = nAcum - nDeducido;
     |SI nAcum ] 0
         nAplicado = nDeducido;
     |SINO;
         nAplicado = nDeducido + nAcum;
         nAcum     = 0;
     |FINSI;

     nLimiteT = nLimiteT - nAplicado;
     |SI nLimiteT < 0;
         nAplicado = nAplicado + nLimiteT;
         nLimiteT  = 0;
     |FINSI;
|FPRC;

|PROCESO AjustaGeneral;
     nValor   = 0;
     enBloque = 30; eaCasilla = " 58"; |HAZ SacaImporte; nValor = nValor + enImporte;
     nLimiteT = enImporte;
     enBloque = 31; eaCasilla = " 59"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 31; eaCasilla = " 61"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 31; eaCasilla = " 62"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 31; eaCasilla = " 63"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 31; eaCasilla = " 64"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 31; eaCasilla = " 65"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 31; eaCasilla = " 66"; |HAZ SacaImporte; nValor = nValor - enImporte;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     nLimite25  = (nValor % 25) ! 0;
     nLimite35  = (nValor % 35) ! 0;
     nLimite50  = (nValor % 50) ! 0;
     nLimite70  = (nValor % 70) ! 0;
     nLimite100 = nValor;

     nAcum    = nLimite35;
     nDeducido = #1#4;  |HAZ Deduce;  #1#4  = nAplicado;
     nDeducido = #1#6;  |HAZ Deduce;  #1#6  = nAplicado;
     nDeducido = #1#9;  |HAZ Deduce;  #1#9  = nAplicado;

     nAcum   = nLimite35;
     nDeducido = #1#39; |HAZ Deduce;  #1#39 = nAplicado;
     nDeducido = #1#12; |HAZ Deduce;  #1#12 = nAplicado;
     nDeducido = #1#15; |HAZ Deduce;  #1#15 = nAplicado;
     nDeducido = #1#27; |HAZ Deduce;  #1#27 = nAplicado;
     nDeducido = #1#24; |HAZ Deduce;  #1#24 = nAplicado;
     nDeducido = #1#33; |HAZ Deduce;  #1#33 = nAplicado;
     nDeducido = #1#42; |HAZ Deduce;  #1#42 = nAplicado;
     nDeducido = #1#45; |HAZ Deduce;  #1#45 = nAplicado;
     nDeducido = #1#18; |HAZ Deduce;  #1#18 = nAplicado;
     nDeducido = #1#30; |HAZ Deduce;  #1#30 = nAplicado;
     nDeducido = #1#36; |HAZ Deduce;  #1#36 = nAplicado;
     nDeducido = #1#21; |HAZ Deduce;  #1#21 = nAplicado;

     nAcum   = nLimite70;
     nDeducido = #1#51; |HAZ Deduce;  #1#51 = nAplicado;
     nDeducido = #1#53; |HAZ Deduce;  #1#53 = nAplicado;
     nDeducido = #1#56; |HAZ Deduce;  #1#56 = nAplicado;
     nDeducido = #1#59; |HAZ Deduce;  #1#59 = nAplicado;

     nAcum   = nLimite70;
     nDeducido = #1#62; |HAZ Deduce;  #1#62 = nAplicado;
     nDeducido = #1#65; |HAZ Deduce;  #1#65 = nAplicado;
     nDeducido = #1#68; |HAZ Deduce;  #1#68 = nAplicado;
     nDeducido = #1#71; |HAZ Deduce;  #1#71 = nAplicado;
     nDeducido = #1#74; |HAZ Deduce;  #1#74 = nAplicado;
     nDeducido = #1#77; |HAZ Deduce;  #1#77 = nAplicado;
     nDeducido = #1#80; |HAZ Deduce;  #1#80 = nAplicado;
     nDeducido = #1#83; |HAZ Deduce;  #1#83 = nAplicado;
     nDeducido = #1#86; |HAZ Deduce;  #1#86 = nAplicado;

     nAcum   = nLimite50;
     nDeducido = #1#89; |HAZ Deduce;  #1#89 = nAplicado;

     nAcum   = nLimite25;
     nDeducido = #1#95;  |HAZ Deduce;  #1#95  = nAplicado;
     nDeducido = #1#97;  |HAZ Deduce;  #1#97  = nAplicado;
     nDeducido = #1#100; |HAZ Deduce;  #1#100 = nAplicado;

     nAcum   = nLimite25;
     nDeducido = #1#103; |HAZ Deduce;  #1#103 = nAplicado;
     nDeducido = #1#105; |HAZ Deduce;  #1#105 = nAplicado;
     nDeducido = #1#108; |HAZ Deduce;  #1#108 = nAplicado;
     nDeducido = #1#111; |HAZ Deduce;  #1#111 = nAplicado;
     nDeducido = #1#114; |HAZ Deduce;  #1#114 = nAplicado;

     nAcum   = nLimite100;
     nDeducido = #1#120; |HAZ Deduce;  #1#120 = nAplicado;
     nDeducido = #1#122; |HAZ Deduce;  #1#122 = nAplicado;
     nDeducido = #1#128; |HAZ Deduce;  #1#128 = nAplicado;
     nDeducido = #1#131; |HAZ Deduce;  #1#131 = nAplicado;

     #1#47 = #1#3;
     #1#48 = #1#4;
     #1#49 = 0;
     |PARA nCampo1 = 5;  |SI nCampo1 [ 44;  |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2   = nCampo1 + 1;
           nCampo3   = nCampo1 + 2;
           #1nCampo3 = (N\ #1nCampo1 - #1nCampo2);
           #1#47     = (N\ #1#47 + #1nCampo1);
           #1#48     = (N\ #1#48 + #1nCampo2);
           #1#49     = (N\ #1#49 + #1nCampo3);
     |SIGUE;

     #1#91 = #1#50;
     #1#92 = #1#51;
     #1#93 = 0;
     |PARA nCampo1 = 52;  |SI nCampo1 [ 88;  |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2   = nCampo1 + 1;
           nCampo3   = nCampo1 + 2;
           #1nCampo3 = (N\ #1nCampo1 - #1nCampo2);
           #1#91     = (N\ #1#91 + #1nCampo1);
           #1#92     = (N\ #1#92 + #1nCampo2);
           #1#93     = (N\ #1#93 + #1nCampo3);
     |SIGUE;

     #1#116 = #1#94;
     #1#117 = #1#95;
     #1#118 = 0;
     |PARA nCampo1 = 96;  |SI nCampo1 [ 99;  |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2   = nCampo1 + 1;
           nCampo3   = nCampo1 + 2;
           #1nCampo3 = (N\ #1nCampo1 - #1nCampo2);
           #1#116    = (N\ #1#116 + #1nCampo1);
           #1#117    = (N\ #1#117 + #1nCampo2);
           #1#118    = (N\ #1#118 + #1nCampo3);
     |SIGUE;

     #1#116 = (N\ #1#116 + #1#102);
     #1#117 = (N\ #1#117 + #1#103);
     |PARA nCampo1 = 104; |SI nCampo1 [ 113;  |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2   = nCampo1 + 1;
           nCampo3   = nCampo1 + 2;
           #1nCampo3 = (N\ #1nCampo1 - #1nCampo2);
           #1#116    = (N\ #1#116 + #1nCampo1);
           #1#117    = (N\ #1#117 + #1nCampo2);
           #1#118    = (N\ #1#118 + #1nCampo3);
     |SIGUE;

     #1#123 = (N\ #1#121 - #1#122);
     #1#124 = (N\ #1#119 + #1#121);
     #1#125 = (N\ #1#120 + #1#122);
     #1#126 = #1#123;

     #1#133 = (N\ #1#130 - #1#131);
     #1#134 = (N\ #1#127 + #1#130);

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 67";
     enImporte = #1#48;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 68";
     enImporte = #1#92;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 69";
     enImporte = #1#117;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 70";
     enImporte = #1#125;
     |HAZ GrabaLineal;
|FPRC;


|PROCESO AjustaDona;
     #1#11 = (N\ (#2#10 % 10) ! 0);
     |SI #1#11 < 0;  #1#11 = 0;  |FINSI;

     nExceso = #1#11;

     nValor1 = #1#53;
     nExceso = nExceso - #1#53;
     |SI nExceso [ 0;
         nValor1 = #1#53 + nExceso;
         nExceso = 0;
     |FINSI;

     nValor2 = #1#52;
     nExceso = nExceso - #1#52;
     |SI nExceso [ 0;
         nValor2 = #1#52 + nExceso;
         nExceso = 0;
     |FINSI;

     #1#4 = #1#3;
     nExceso = nExceso - #1#4;
     |SI nExceso [ 0;
         #1#4 = (N\ #1#4 + nExceso);
         nExceso = 0;
     |FINSI;

     nValor3 = #1#51;
     nExceso = nExceso - #1#51;
     |SI nExceso [ 0;
         nValor3 = #1#51 + nExceso;
         nExceso = 0;
     |FINSI;

     #1#7 = (N\ nValor1 + nValor2 + nValor3);
     #1#5 = (N\ (#1#4 % 15) ! 0);
     #1#9 = (N\ ((nValor1 % 25) + (nValor2 % 20) + (nValor3 % 10)) ! 0);

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 59";
     enImporte = #1#5;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 60";
     enImporte = #1#9;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO Deducciones;
     aDef    = eaPathDef + "rem01042.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1042"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ AjustaGeneral;
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     |DESCARGA_DEF #refere4@;

     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1041"#;  |FINSI;

     aDef    = eaPathDef + "rem01039.mas";
     |CARGA_DEF aDef, refere5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere5@#"zdat1039"#;  |FINSI;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ AjustaDona;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     |DESCARGA_DEF #refere5@;
     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO AjustaDivid;
     enBloque = 33; eaCasilla = " 79"; |HAZ SacaImporte; nLimite = enImporte;

     |SI #1#42 ! 0;
         #1#43 = #1#42;
         |SI #1#43 > nLimite;
             #1#43 = nLimite;
             #1#44 = (N\ #1#42 - #1#43);
             nLimite = 0;
         |SINO;
             nLimite = nLimite - #1#43;
         |FINSI;
     |FINSI;

     |SI #1#45 ! 0;
         #1#46 = #1#45;
         |SI #1#46 > nLimite;
             #1#46   = nLimite;
             #1#47   = (N\ #1#45 - #1#46);
             nLimite = 0;
         |SINO;
             nLimite = nLimite - #1#46;
         |FINSI;
     |FINSI;

     #1#48 = (N\ #1#43 + #1#46);

     enSwAcum  = 0;
     enBloque  = 37;
     eaCasilla = " 89";
     enImporte = #1#48;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO DeducDivid;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1041"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |SI #1#42 ! 0;  |O #1#45 ! 0;
             |HAZ AjustaDivid;
             |GRABA 020#1a;
         |FINSI;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO GravamenEsp;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     enSwAcum  = 0;
     enBloque  = 29;
     eaCasilla = " 53";
     enImporte = 0;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 29;
     eaCasilla = " 54";
     enImporte = 0;
     |HAZ GrabaLineal;

     enSwAcum  = 0;
     enBloque  = 29;
     eaCasilla = " 55";
     enImporte = 0;
     |HAZ GrabaLineal;

     enBloque = 17; eaCasilla = " 43"; |HAZ SacaImporte; nBaseEsp = enImporte;

     |SI #1#94 = "N";
         enSwAcum  = 0;
         enBloque  = 29;
         eaCasilla = " 53";
         enImporte = nBaseEsp % 17;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 29;
         eaCasilla = " 54";
         enImporte = nBaseEsp % 3;
         |HAZ GrabaLineal;
     |SINO;
         enSwAcum  = 0;
         enBloque  = 29;
         eaCasilla = " 55";
         enImporte = nBaseEsp % 20;
         |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO AdqVivienda;
     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1011"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#16 < "04.05.1998";  |Y #1#16 ! "01.01.0000";
         enBloque   = 20; eaCasilla = " 51";  |HAZ SacaImporte;
         |SI enImporte = 0;
             enBloque   = 27; eaCasilla = " 51";  |HAZ SacaImporte;
         |FINSI;
         nValor1 = enImporte;

         enBloque   = 21; eaCasilla = " 52";  |HAZ SacaImporte;
         |SI enImporte = 0;
             enBloque   = 27; eaCasilla = " 52";  |HAZ SacaImporte;
         |FINSI;
         nValor2 = enImporte;

         enBloque    = 13; eaCasilla = " 38";  |HAZ SacaImporte;
         nTipoMedio1 = (((nValor1) * 100 / enImporte) - 0.0049) ! 2;
         |SI nTipoMedio1 < 0;  nTipoMedio1 = 0;  |FINSI;

         nTipoMedio2 = (((nValor2) * 100 / enImporte) - 0.0049) ! 2;
         |SI nTipoMedio2 < 0;  nTipoMedio2 = 0;  |FINSI;

         nTipoMedio  = nTipoMedio1 + nTipoMedio2;

         nValor  = #0#49;

         nLimite = 800000;
         |SI nConta ] 7;        nLimite = 1000000;  |FINSI;
         |SI nValor > nLimite;  nValor  = nLimite;  |FINSI;

         nValor  = (nValor + #1#14 - #1#15) % nTipoMedio;

         nValor2    = 0;
         enBloque   = 17; eaCasilla = " 43";  |HAZ SacaImporte;
         nValor2    = nValor2 + enImporte;

         enBloque   = 13; eaCasilla = " 38";  |HAZ SacaImporte;
         nValor2    = nValor2 + enImporte;

         enBloque   = 9; eaCasilla = " 32";  |HAZ SacaImporte;
         nValor2    = nValor2 + enImporte;
         nLimite    = nValor2 % 30;
         |SI nLimite < 0;  nLimite = 0;  |FINSI;

         nValorA    = #0#50 - #0#49;
         |SI nLimite < nValorA;  nValorA = nLimite;  |FINSI;

         nValor1    = nValorA % 15;

         nSumaAyer   = nValor + nValor1;
         nSumaHoy    = #0#16 + #0#18 + #0#20 + #0#25 + #0#27;

         nDiferencia = nSumaAyer - nSumaHoy;
         |SI nDiferencia < 0;  nDiferencia = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 37;
         eaCasilla = " 94";  enImporte = nDiferencia;   |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO DobleInternacional;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1034"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nValor = #1#12 + #1#13 + #1#14 + #1#15;
     |SI nValor ! 0;
         enBloque   = 13; eaCasilla = " 38";  |HAZ SacaImporte; nValor38 = enImporte;
         enBloque   = 17; eaCasilla = " 43";  |HAZ SacaImporte; nValor43 = enImporte;

         |SI nAnuHijos = 0;
             enBloque = 20; eaCasilla = " 51"; |HAZ SacaImporte; nValorA = enImporte;
             enBloque = 21; eaCasilla = " 52"; |HAZ SacaImporte; nValorB = enImporte;
         |SINO;
             enBloque = 27; eaCasilla = " 51"; |HAZ SacaImporte; nValorA = enImporte;
             enBloque = 27; eaCasilla = " 52"; |HAZ SacaImporte; nValorB = enImporte;
         |FINSI;
         enBloque   = 10; eaCasilla = " 33";  |HAZ SacaImporte; nValor33 = enImporte;
         enBloque   = 9;  eaCasilla = " 32";  |HAZ SacaImporte; nValor32 = enImporte;
         enBloque   = 29; eaCasilla = " 53";  |HAZ SacaImporte; nValorC  = enImporte;
         enBloque   = 29; eaCasilla = " 54";  |HAZ SacaImporte; nValorD  = enImporte;
         enBloque   = 31; eaCasilla = " 74";  |HAZ SacaImporte; nValor74 = enImporte;

         nValorE = nValorA + nValorB;
         nValorF = nValorC + nValorD;
         nValorG = nValorE + nValorF;
         nValorH = nValorG - nValor74;
         |SI nValorH < 0;  nValorH = 0;  |FINSI;

         nValorP1 = ((nValorH * (nValorE / nValorG)) * 100) / nValor38;
         nValorP2 = ((nValorH * (nValorF / nValorG)) * 100) / nValor43;
         nValorB3 = (nValor38 * #1#12) / (nValor33 + nValor32);
         nValorC1 = #1#13;
         nValor   = nValorB3 % nValorP1;
         |SI nValor < nValorC1;
             nValorC1 = nValor;
         |FINSI;

         nValorC2 = #1#15;
         nValor   = #1#14 % nValorP2;
         |SI nValor < nValorC2;
             nValorC2 = nValor;
         |FINSI;

         enImporte = (nValorC1 + nValorC2) ! 0;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         enSwAcum  = 0;
         enBloque = 37;
         eaCasilla = " 90";
         |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #refere4@;
|FPRC;

|PROCESO CompensacionAlq;
     nValor = enImporte;

||---- Primer Condicionante

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nValor1 = #1#15   + #1#16 + #1#17 + #1#18 - #1#19 + #1#7  + #1#8;
     nValor1 = nValor1 + #1#9  + #1#10 + #1#11 + #1#12 - #1#13 + #1#14;
     nValor1 = nValor1 % 10;

     |SI #1#20 < nValor1;  nValor = 0;  |FINSI;

     |DESCARGA_DEF #refere4@;

||---- Segundo Condicionante

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere4@#"zdat1034"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI nConta = 1;  nCompeT = nValor;  |FINSI;
     |SI nConta = 2;  nCompeC = nValor;  |FINSI;
     |SI nConta = 7;  nValor  = nCompeT + nCompeC;  |FINSI;
     |SI nConta = 8;
         |SI eaMuerto = "T";
             nValor  = nCompeC;
         |SINO;
             nValor  = nCompeT;
         |FINSI;
     |FINSI;

     nValor1 = #1#8 + #1#11;

     |SI nConta < 7;
         |SI nValor1 ] 3500000;  nValor = 0;  |FINSI;
     |SINO;
         |SI nValor1 ] 5000000;  nValor = 0;  |FINSI;
     |FINSI;

     |DESCARGA_DEF #refere4@;

     enSwAcum  = 0;
     enBloque  = 37;
     eaCasilla = " 93";
     enImporte = nValor;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO SeleccionRenta;
     #1001#5 = "101";
     #1001#6 = "N";
     #1001#4 = "N";

     nValor = 0;
     enBloque = 1; eaCasilla = " 01"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = " 02"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = " 03"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     |SI nPagadores [ 1;
         |SI nValor > 3500000;  #1001#4 = "S";  |FINSI;
     |SINO;
         |SI nValor > 1250000;  #1001#4 = "S";  |FINSI;
     |FINSI;

     enBloque = 2; eaCasilla = " 11"; |HAZ SacaImporte;
     |SI enImporte > 50000;  #1001#4 = "S";  |FINSI;

     enBloque = 3; eaCasilla = " 16"; |HAZ SacaImporte;
     |SI enImporte > 250000;  #1001#4 = "S";  |FINSI;

     enBloque = 4; eaCasilla = " 17"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 4; eaCasilla = " 18"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 4; eaCasilla = " 19"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 4; eaCasilla = " 20"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 4; eaCasilla = " 21"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     enBloque = 4; eaCasilla = " 22"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 5; eaCasilla = " 23"; |HAZ SacaImporte;
     |SI enImporte > 50000;  #1001#4 = "S";  |FINSI;

     enBloque = 5; eaCasilla = " 24"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 5; eaCasilla = " 25"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 5; eaCasilla = " 26"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 5; eaCasilla = " 27"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 7; eaCasilla = " 30"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 8; eaCasilla = " 31"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     enBloque = 11; eaCasilla = " 34"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     enBloque = 11; eaCasilla = " 35"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     enBloque = 11; eaCasilla = " 36"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     enBloque = 18; eaCasilla = " 44"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 24; eaCasilla = " 45"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 31; eaCasilla = " 67"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 31; eaCasilla = " 68"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 31; eaCasilla = " 69"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 31; eaCasilla = " 70"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 31; eaCasilla = " 71"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 31; eaCasilla = " 72"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 35; eaCasilla = " 80"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 35; eaCasilla = " 81"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 35; eaCasilla = " 82"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 35; eaCasilla = " 83"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 36; eaCasilla = " 84"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 36; eaCasilla = " 85"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 37; eaCasilla = " 91"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 37; eaCasilla = " 92"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 38; eaCasilla = " 99"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 38; eaCasilla = "100"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 38; eaCasilla = "102"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 38; eaCasilla = "103"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 38; eaCasilla = "104"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     enBloque = 38; eaCasilla = "105"; |HAZ SacaImporte;
     |SI enImporte ! 0;  #1001#5 = "100";  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |SI #0#19 ! 0;  #1001#5 = "100";  |FINSI;
     |SI #0#20 ! 0;  #1001#5 = "100";  |FINSI;
     |SI #0#21 ! 0;  #1001#5 = "100";  |FINSI;
     |SI #0#22 ! 0;  #1001#5 = "100";  |FINSI;

     |DESCARGA_DEF #refere3@;

     aDef    = eaPathDef + "rem01028.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1028"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     #0#3 = 1;
     |LEE 040#0];
     |SI FSalida = 0; |Y #0#0 = #1001#0;  |Y #0#1 = #1001#1; |Y #0#2 = #1001#2;
         #1001#5 = "100";
     |FINSI;
     |CIERRA #0;

     |DESCARGA_DEF #refere3@;

     aDef    = eaPathDef + "rem01029.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1029"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     #0#3 = 1;
     |LEE 040#0];
     |SI FSalida = 0; |Y #0#0 = #1001#0;  |Y #0#1 = #1001#1; |Y #0#2 = #1001#2;
         #1001#5 = "100";
     |FINSI;
     |CIERRA #0;

     |DESCARGA_DEF #refere3@;

     aDef    = eaPathDef + "rem01030.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1030"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     #0#3 = 1;
     |LEE 040#0];
     |SI FSalida = 0; |Y #0#0 = #1001#0;  |Y #0#1 = #1001#1; |Y #0#2 = #1001#2;
         #1001#5 = "100";
     |FINSI;
     |CIERRA #0;

     |DESCARGA_DEF #refere3@;

     aDef    = eaPathDef + "rem01031.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1031"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     #0#3 = 1;
     |LEE 040#0];
     |SI FSalida = 0; |Y #0#0 = #1001#0;  |Y #0#1 = #1001#1; |Y #0#2 = #1001#2;
         #1001#5 = "100";
     |FINSI;
     |CIERRA #0;

     |DESCARGA_DEF #refere3@;

     aDef    = eaPathDef + "rem01032.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1032"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     #0#3 = 1;
     |LEE 040#0];
     |SI FSalida = 0; |Y #0#0 = #1001#0;  |Y #0#1 = #1001#1; |Y #0#2 = #1001#2;
         #1001#5 = "100";
     |FINSI;
     |CIERRA #0;

     |DESCARGA_DEF #refere3@;

     #1001#13 = #1001#5;
|FPRC;


|PROCESO Final;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |HAZ TipoMedio;
     |HAZ GravamenEsp;

     nValor = 0;
     |SI nAnuHijos = 0;
         enBloque = 20; eaCasilla = " 51"; |HAZ SacaImporte; nValor = nValor + enImporte;
     |SINO;
         enBloque = 27; eaCasilla = " 51"; |HAZ SacaImporte; nValor = nValor + enImporte;
     |FINSI;

     enBloque = 29; eaCasilla = " 53"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 29; eaCasilla = " 55"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 30;
     eaCasilla = " 56";
     enImporte = nValor ! 0;
     |HAZ GrabaLineal;

     nValor = 0;
     |SI nAnuHijos = 0;
         enBloque = 21; eaCasilla = " 52"; |HAZ SacaImporte; nValor = nValor + enImporte;
     |SINO;
         enBloque = 27; eaCasilla = " 52"; |HAZ SacaImporte; nValor = nValor + enImporte;
     |FINSI;
     enBloque = 29; eaCasilla = " 54"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 30;
     eaCasilla = " 57";
     enImporte = nValor ! 0;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 30; eaCasilla = " 56"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 30; eaCasilla = " 57"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 30;
     eaCasilla = " 58";
     enImporte = nValor;
     |HAZ GrabaLineal;
     nCuotaIntegra = nValor;

     enBloque = 31; eaCasilla = " 73"; |HAZ SacaImporte;
     nValor = nValor % 50;
     |SI enImporte > nValor;
         enBloque  = 31;
         eaCasilla = " 73";
         enImporte = nValor;
         |HAZ GrabaLineal;
     |FINSI;

     |HAZ Deducciones;

     nValor = 0;
     enBloque = 31; eaCasilla = " 59"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 60"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 61"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 62"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 63"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 64"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 65"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 66"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 67"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 68"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 69"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 70"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 71"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 72"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 73"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 31;
     eaCasilla = " 74";
     enImporte = nValor;
     |HAZ GrabaLineal;

     |HAZ AjusteAutono;

     nValor = 0;
     enBloque = 30; eaCasilla = " 56"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 74"; |HAZ SacaImporte; nValor = nValor - (enImporte % 85);
     |SI nValor < 0;  nValor = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 33;
     eaCasilla = " 77";
     enImporte = nValor;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 30; eaCasilla = " 57"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 31; eaCasilla = " 74"; |HAZ SacaImporte; nValor = nValor - (enImporte % 15);
     enBloque = 32; eaCasilla = " 75"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 32; eaCasilla = " 76"; |HAZ SacaImporte; nValor = nValor - enImporte;
     |SI nValor < 0;  nValor = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 33;
     eaCasilla = " 78";
     enImporte = nValor;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 33; eaCasilla = " 77"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 33; eaCasilla = " 78"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 33;
     eaCasilla = " 79";
     enImporte = nValor;
     |HAZ GrabaLineal;

     |HAZ DeducDivid;

     nValor = 0;
     enBloque = 33; eaCasilla = " 77"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 35; eaCasilla = " 82"; |HAZ SacaImporte; nValor = nValor + (enImporte % 85);
     enBloque = 35; eaCasilla = " 83"; |HAZ SacaImporte; nValor = nValor + (enImporte % 85);
     enBloque = 35; eaCasilla = " 80"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 35; eaCasilla = " 81"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 36;
     eaCasilla = " 86";
     enImporte = nValor;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 33; eaCasilla = " 78"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 35; eaCasilla = " 82"; |HAZ SacaImporte; nValor = nValor + (enImporte % 15);
     enBloque = 35; eaCasilla = " 83"; |HAZ SacaImporte; nValor = nValor + (enImporte % 15);
     enBloque = 36; eaCasilla = " 84"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = " 85"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 36;
     eaCasilla = " 87";
     enImporte = nValor;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 36; eaCasilla = " 86"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 36; eaCasilla = " 87"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 36;
     eaCasilla = " 88";
     enImporte = nValor;
     |HAZ GrabaLineal;

     |HAZ AdqVivienda;

     enBloque = 37; eaCasilla = " 90"; |HAZ SacaImporte;
     |SI enImporte = 0;
         |HAZ DobleInternacional;
     |FINSI;

     enBloque = 37; eaCasilla = " 93"; |HAZ SacaImporte;
     |SI enImporte ! 0;
         |HAZ CompensacionAlq;
     |FINSI;

     nValor = 0;
     enBloque = 36; eaCasilla = " 88"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 37; eaCasilla = " 89"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = " 90"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = " 91"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = " 92"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = " 93"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 37; eaCasilla = " 94"; |HAZ SacaImporte; nValor = nValor - enImporte;
     |SI nValor < 0;  nValor = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 37;
     eaCasilla = " 95";
     enImporte = nValor;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 38; eaCasilla = " 96"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = " 97"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = " 98"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = " 99"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "100"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "101"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "102"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "103"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "104"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 38; eaCasilla = "105"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum  = 0;
     enBloque  = 38;
     eaCasilla = "106";
     enImporte = nValor;
     |HAZ GrabaLineal;

     enBloque  = 37; eaCasilla = " 95"; |HAZ SacaImporte; nValor = enImporte - nValor;

     enSwAcum  = 0;
     enBloque  = 38;
     eaCasilla = "107";
     enImporte = nValor;
     |HAZ GrabaLineal;

     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO EsIndividual;
     aDef    = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, refere3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #refere3@#"zdat1035"#;  |FINSI;

     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, refere4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |ABRE #1;
     #1#0 = #1001#0;
     |LEE 101#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI nSwConjunta = 0;  |Y #1#40 = "    ";  |Y nConta = 7;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI nSwConjuntaE = 0;  |Y nConta = 8;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |DESCARGA_DEF #refere4@;
     |DESCARGA_DEF #refere3@;
|FPRC;

|PROCESO Bloque6;
     |HAZ CalculaF;

     nMinFam = 0;

     |ABRE #999;

     |SELECT #2#999;
     #999#1 = "CONYUGE   ";
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;

     nSwConyuge = 0;
     |SI #999#6 ! 0;  nSwConyuge = 1;  |FINSI;

     |SELECT #2#999;
     #999#1 = "TITULAR   ";
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;

     nSwTitular = 0;
     |SI #999#6 ! 0;  nSwTitular = 1;  |FINSI;

     |CIERRA #999;

     |DDEFECTO #1001;
     FSalida      = 0;
     #1001#0      = enEmpresa;
     #1001#1      = enComplementaria;
     nLimite1     = 0;
     nLimite2     = 0;
     nValorTit    = 0;
     nValorCon    = 0;
     nCompeT      = 0;
     nCompeC      = 0;
     nSwConjunta  = 0;
     nSwConjuntaE = 0;
     nValencianaT = 0;
     nValencianaC = 0;
     nMinFamE     = 350000;
     |PARA nConta = 1;  |SI nConta [ 8;  |HACIENDO nConta = nConta + 1;
           nSwBorrar  = 0;
           |SI nConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI nConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI nConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI nConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI nConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI nConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI nConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI nConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;
           |LEE 101#1001=;
           |SI FSalida ! 0;  |Y nConta = 2;  |Y nSwConyuge = 1;
                #1001#0   = enEmpresa;
                #1001#1   = enComplementaria;
                #1001#2   = "CONYUGE   ";
                nSwBorrar = 1;
                |GRABA 020#1001b;
            |FINSI;

            |SI FSalida ! 0;  |Y nConta = 1;  |Y nSwTitular = 1;
                #1001#0   = enEmpresa;
                #1001#1   = enComplementaria;
                #1001#2   = "TITULAR   ";
                nSwBorrar = 1;
                |GRABA 020#1001b;
            |FINSI;

            |SI FSalida = 0;
                |HAZ CalculaG;
                |HAZ Trabajo;
                |HAZ CalculaG;
                |HAZ CalculaH;
                |HAZ CalculaI;
                |HAZ CalculaJ;
                |HAZ CalculaK;
                |HAZ CalculaL;
                |HAZ CalculaM;
                |HAZ Final;
                |HAZ CalculaE;
                |HAZ SeleccionRenta;

                enBloque  = 38; eaCasilla = "107"; |HAZ SacaImporte;
                #1001#3  = enImporte;
                #1001#15 = enImporte;

                |GRABA 020#1001a;
                |LIBERA #1001;

                |SI nConta ] 7;
                    |HAZ EsIndividual;
                |FINSI;
            |FINSI;

            |SI nSwBorrar = 1;
                eaLiquida = #1001#2;
                |HAZ BorraLiquidacion;
                eaLiquida = "";
            |FINSI;
     |SIGUE;
|FPRC;
