|FICHEROS;
     rem00101 #1;
     repant17 #917,MANTE;
     recofisc #10;
     rew00039 #939;
|FIN;

|VARIABLES;
     nCampo1   = 0;
     nTecla    = 0;

     aComa     = "";
     aAlfa     = "";
     aAlfa1    = "";
     aAlfa2    = "";
     aAlfa3    = "";

     &eaVarDni = "";
|FIN;

|PROCESO Tipo12w17;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!
|FPRC;

|PROCESO MayusPant17;
     #917Campo = #917Campo > #917Campo;
     |PINTA #917Campo;
|FPRC;

|PROCESO Minusvalido;
     nCampo1 = Campo + 1;
     |C_M #917nCampo1, 1, "S";
     |SI #917Campo = 0;
         |C_M #917nCampo1, 1, "N";
         #917nCampo1 = "N";  |PINTA #917nCampo1;
     |FINSI;
|FPRC;

|PROCESO Convivencia;
     |C_M #917#60, 1, "S";
     |SI #917#6 ! "L"; |Y #917#6 ! "S";
         #917#60 = " ";  |PINTA #917#60;
         |C_M #917#60, 1, "N";
     |FINSI;
|FPRC;

|PROCESO HayConyuge;
     |PARA nCampo1 = 35;  |SI nCampo1 [ 52;  |HACIENDO nCampo1 = nCampo1 + 1;
           |C_M #917nCampo1, 1, "S";
     |SIGUE;
     |C_M #917#58, 1, "S";
     |C_M #917#39, 1, "N";
     |SI #917#6 ! "C";
         |PARA nCampo1 = 35;  |SI nCampo1 [ 52;  |HACIENDO nCampo1 = nCampo1 + 1;
               |C_M #917nCampo1, 1, "N";
         |SIGUE;
         |C_M #917#58, 1, "N";
         |PDEFECTO #917, 35, 53;
         |PDEFECTO #917, 54, 55;
     |FINSI;
|FPRC;

|PROCESO Autonomia;
     nTecla = FSalida;
     |SI Campo = 20;  nCampo1 = 11;  |FINSI;
     |SI Campo = 50;  nCampo1 = 43;  |FINSI;

     |ABRE #10;
     #10#0 = #917Campo;
     |LEE 040#10=;
     |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;
     |CIERRA #10;

     |SI #917#59 = "S";
        #917nCampo1 = "20";
     |SINO;
        #917nCampo1 = #10#3;
     |FINSI;

     FSalida = nTecla;
|FPRC;

|PROCESO NombreEntero;
     nCampo1   = Campo - 3;  aAlfa1 = #917nCampo1;  |QBF aAlfa1;
     nCampo1   = Campo - 2;  aAlfa2 = #917nCampo1;  |QBF aAlfa2;
     nCampo1   = Campo - 1;  aAlfa3 = #917nCampo1;  |QBF aAlfa3;
     |SI aAlfa1 ! "";  |O aAlfa2 ! "";  |O aAlfa3 ! "";
         aComa = ",";
     |SINO;
         aComa = "";
     |FINSI;

     aAlfa     = aAlfa1 + " " + aAlfa2 + aComa + " " + aAlfa3;
     #917Campo = aAlfa;
     |PINTA #917Campo;
|FPRC;

|PROCESO Envio;
     nCampo1 = Campo + 10;
     aAlfa1  = #917Campo;    |QBF aAlfa1;
     aAlfa2  = Contenido;    |QBF aAlfa2;
     aAlfa3  = #917nCampo1;  |QBF aAlfa3;
     |SI aAlfa1 ! aAlfa2;
         #917nCampo1 = #917Campo;
         |PINTA #917nCampo1;
     |SINO;
          |SI aAlfa3 = "";  |O aAlfa3 = "0";
              #917nCampo1 = #917Campo;
              |PINTA #917nCampo1;
          |FINSI;
     |FINSI;

     |SI #917#6 = "C";
         nCampo1 = Campo + 30;
         aAlfa1  = #917Campo;    |QBF aAlfa1;
         aAlfa2  = Contenido;    |QBF aAlfa2;
         aAlfa3  = #917nCampo1;  |QBF aAlfa3;
         |SI aAlfa1 ! aAlfa2;
             #917nCampo1 = #917Campo;
         |SINO;
              |SI aAlfa3 = "";  |O aAlfa3 = "0";
                  #917nCampo1 = #917Campo;
              |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LetraNifPant17;  |TIPO 6;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaVarDni = #917Campo;
     |HAZ CalculoDNI;
     #917Campo = eaVarDni;
     |PINTA #917Campo;
     |ERROR;
|FPRC;

|PROCESO CtasCtes;
     |SI Campo = 54;  |Y #917#6 ! "C";  |ACABA;  |FINSI;

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #939#0 = #917Campo % 104;
     #939#1 = #917Campo % 504;
     #939#2 = #917Campo % 902;
     #939#3 = #917Campo % 1110;

     |PUSHV 0501 2380;
     |PINPA #0#939;

     |ATRI R;
     |SI Campo = 53;  |PINTA 1116, "            CUENTA CONTRIBUYENTE 1          ";  |FINSI;
     |SI Campo = 54;  |PINTA 1116, "            CUENTA CONTRIBUYENTE 2          ";  |FINSI;
     |SI Campo = 55;  |PINTA 1116, "               CUENTA CONJUNTA              ";  |FINSI;
     |ATRI r;

     |PINDA #0#939;
     |ENDATOS #1#939;
     |SI FSalida = 0;
         aAlfa     = #939#0 + #939#1 + #939#2 + #939#3;
         #917Campo = aAlfa;
     |FINSI;
     |POPV;
     |PINTA #917Campo;
|FPRC;

|RUTINA ClaveBaja1;
     #1#0 = #917#0;
     #1#1 = 1;
|FRUT;

|RUTINA ClaveAlta1;
     #1#0 = #917#0;
     #1#1 = 99;
|FRUT;

|PROCESO Tipo14Pant17; |TIPO 14;
     |ENTLINEAL #1#1, -2, 1, 22, 0, ClaveBaja1, ClaveAlta1;
|FPRC;
