|FICHEROS;
     reaccdev #0;
     rem00100 #100;
     rem00101 #101;
     rem00102 #102;
     rew00040 #940;
     rew00041 #941;
|FIN;

|VARIABLES;
     nCampo      = 0;
     nCampo1     = 0;
     nPorce      = 0;
     nSwFamiliar = 0;
     nLinea      = 0;

     &enSwPintas = 0;
|FIN;

|PROCESO CargaConjunta;
     |SI #102#128 ! 2;
         #941#6   = #941#6   + #102#6;
         #941#7   = #941#7   + #102#7;
         #941#8   = #941#8   + #102#8;
         #941#9   = #941#9   + #102#9;
     |SINO;
         #941#13  = #941#13  + #102#6;
         #941#14  = #941#14  + #102#7;
         #941#15  = #941#15  + #102#8;
         #941#16  = #941#16  + #102#9;
     |FINSI;
     #941#60  = #941#60  + #102#60;
     #941#61  = #941#61  + #102#61;
     #941#63  = #941#63  + #102#63;
     #941#64  = #941#64  + #102#64;
     #941#66  = #941#66  + #102#66;
     #941#67  = #941#67  + #102#67;
     #941#69  = #941#69  + #102#69;
     #941#70  = #941#70  + #102#70;
     #941#72  = #941#72  + #102#72;
     #941#73  = #941#73  + #102#73;
     #941#74  = #941#74  + #102#74;
     #941#75  = #941#75  + #102#75;
     #941#76  = #941#76  + #102#76;
     #941#81  = #941#81  + #102#81;
     #941#85  = #941#85  + #102#85;
     #941#86  = #941#86  + #102#86;
     #941#91  = #941#91  + #102#91;
     #941#95  = #941#95  + #102#95;
     #941#97  = #941#97  + #102#97;
     #941#99  = #941#99  + #102#99;
     #941#101 = #941#101 + #102#101;
     #941#103 = #941#103 + #102#103;
     #941#105 = #941#105 + #102#105;
     #941#107 = #941#107 + #102#107;
     #941#109 = #941#109 + #102#109;
     #941#111 = #941#111 + #102#111;
     #941#117 = #941#117 + #102#117;
     #941#119 = #941#119 + #102#119;
     #941#120 = #941#120 + #102#120;
     #941#121 = #941#121 + #102#121;
     #941#123 = #941#123 + #102#123;
     #941#124 = #941#124 + #102#124;
     #941#125 = #941#125 + #102#125;
     #941#150 = #941#150 + #102#150;
|FPRC;

|DEFBUCLE rem00102;
     #102#1;
     ;
     #0#0, 01;
     #0#0, 98;
     ;
     NULL, CargaConjunta;
|FIN;

|PROCESO PantaCalculo;  |TIPO 11;
      |SI FSalida ! 10;  |ACABA;  |FINSI;

      |LEE 101#102=;

      enSwPintas = 0;
      nLinea     = #102#128;
      |PARA nCampo = 0;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
            #941nCampo = #102nCampo;
      |SIGUE;

      |PARA nCampo = 57;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
            nCampo1 = nCampo - 57;
            #940nCampo1 = #941nCampo;
      |SIGUE;

      |PUSHV 0501 2380;
      |HAZ Calculo;
      |PINPA #0#941;
      |PINDA #0#941;

      |SI #102#2 ! "CONJUNTA    ";
          |ATRI R;  |PINTA 0760, "INDIVIDUAL"; |ATRI r;
      |SINO;
          |ATRI R;  |PINTA 0760, "CONJUNTA  "; |ATRI r;
      |FINSI;

      |ENDATOS #1#941;
      |SI FSalida = 0;
          |PARA nCampo = 0;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
                #102nCampo = #941nCampo;
          |SIGUE;

          |GRABA 020#102a;
      |FINSI;
      |POPV;

      |LIBERA #102;

      |SI #102#128 = 99;  |ACABA;  |FINSI;

      #102#0   = #0#0;
      #102#128 = 99;
      |LEE 000#102=;
      |PARA nCampo = 0;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
            #941nCampo = #102nCampo;
      |SIGUE;

      |PDEFECTO #941, 6,   10;
      |PDEFECTO #941, 13,  17;
      |PDEFECTO #941, 57,  128;
      |PDEFECTO #941, 129, 153;

      |CIERRA #102;
      |BUCLE rem00102;
      |ABRE #102;

      #940#72 = 0;
      |PARA nCampo = 57;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
            nCampo1     = nCampo - 57;
            #940nCampo1 = #941nCampo;
      |SIGUE;
      enSwPintas = 1;
      |HAZ Calculo;
      |PARA nCampo = 57;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
            nCampo1     = nCampo - 57;
            #941nCampo  = #940nCampo1;
      |SIGUE;

      #102#0   = #0#0;
      #102#128 = 99;
      |LEE 101#102=;

      |PARA nCampo = 0;  |SI nCampo [ 127;  |HACIENDO nCampo = nCampo + 1;
            #102nCampo = #941nCampo;
      |SIGUE;
      #102#150 = #941#150;

      |GRABA 020#102a;
      |LIBERA #102;

      #102#0   = #0#0;
      #102#128 = nLinea;
      |LEE 000#102=;

      |PTEC 802;
      |PTEC 806;
|FPRC;

|RUTINA ClaveBaja102;
     #102#0   = #0#0;
     #102#128 = 1;
|FRUT;

|RUTINA ClaveAlta102;
     #102#0   = #0#0;
     #102#128 = 99;
|FRUT;

|PROCESO CogeFamiliares;
     |SI nSwFamiliar = 0;
         |SI nCampo ] 56;  |ERROR10;  |ACABA;  |FINSI;

         |SI #102#128 = 1;
             |SI #101#7 = " ";  |O #101#7 = "1";
                 nPorce = 100;
                 |SI #101#7 = " ";  |Y #102#10 ! "    ";
                     nPorce = 50;
                 |FINSI;
                 nCampo = nCampo + 1;  #102nCampo = #101#5;
                 nCampo = nCampo + 1;  #102nCampo = #101#6;
                 nCampo = nCampo + 1;  #102nCampo = nPorce;
                 nCampo = nCampo + 1;  #102nCampo = #101#4;
             |FINSI;
         |FINSI;

         |SI #102#128 = 2;
             |SI #101#7 = " ";  |O #101#7 = "2";
                 nPorce = 100;
                 |SI #101#7 = " ";  |Y #102#10 ! "    ";
                     nPorce = 50;
                 |FINSI;
                 nCampo = nCampo + 1;  #102nCampo = #101#5;
                 nCampo = nCampo + 1;  #102nCampo = #101#6;
                 nCampo = nCampo + 1;  #102nCampo = nPorce;
                 nCampo = nCampo + 1;  #102nCampo = #101#4;
             |FINSI;
         |FINSI;

         |SI #102#128 = 99;
             nPorce = 100;
             nCampo = nCampo + 1;  #102nCampo = #101#5;
             nCampo = nCampo + 1;  #102nCampo = #101#6;
             nCampo = nCampo + 1;  #102nCampo = nPorce;
             nCampo = nCampo + 1;  #102nCampo = #101#4;
         |FINSI;
     |FINSI;

     |SI nSwFamiliar = 1;
         nLinea = nLinea + 1;
         #102#0   = #100#0;
         #102#128 = nLinea;
         |LEE 101#102=;
         |SI FSalida ! 0;
             |SI #101#13 = "N";  |ACABA;  |FINSI;
             |DDEFECTO #102;
             #102#0   = #100#0;
             #102#128 = nLinea;
             |GRABA 020#102b;
         |FINSI;

         |SI #101#13 = "N";  |BORRA 020#102a;  |ACABA;  |FINSI;

         #102#1 = #101#3;
         #102#2 = #101#2;
         #102#3 = #101#5;
         #102#5 = #100#6;

         |GRABA 020#102a;
         |LIBERA #102;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101;
     #101#1;
     ;
     #0#0, 1;
     #0#0, 99;
     ;
     NULL, CogeFamiliares;
|FIN;

|PROCESO Graba102;
     |SI #102#128 = 1;
         #102#1  = #100#5;
         #102#2  = #100#1;
         #102#3  = #100#7;
         #102#4  = #100#9;
         #102#5  = #100#8;
         #102#10 = #100#40;
         nCampo = 16;
         |PDEFECTO #102, 17, 57;
         |BUCLE rem00101;
     |FINSI;

     |SI #102#128 = 2;
         #102#1  = #100#39;
         #102#2  = #100#35;
         #102#3  = #100#40;
         #102#4  = #100#42;
         #102#5  = #100#41;
         #102#10 = #100#7;
         nCampo = 16;
         |PDEFECTO #102, 17, 57;
         |BUCLE rem00101;
     |FINSI;

     |SI #102#128 = 99;
         #102#1  = #100#5;
         #102#2  = "CONJUNTA";
         #102#3  = #100#7;
         #102#4  = #100#9;
         #102#5  = #100#8;
         #102#10 = #100#40;
         #102#11 = #100#42;
         #102#12 = #100#41;
         nCampo = 16;
         |PDEFECTO #102, 17, 57;
         |BUCLE rem00101;
     |FINSI;

     |GRABA 020#102a;
|FPRC;

|PROCESO ImportesRentas;
     |ABRE #100;
     #100#0 = #0#0;
     |LEE 040#100=;
     |SI FSalida ! 0;
         |MENAV  "      No existe datos de los Contribuyentes";
         |CIERRA #100;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     nSwFamiliar = 0;

     |ABRE #102;
     #102#0   = #100#0;
     #102#128 = 1;
     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0   = #100#0;
         #102#128 = 1;
         |GRABA 020#102b;
     |FINSI;
     |HAZ Graba102;
     |LIBERA #102;

     |SI #100#6 = "C";
         #102#0   = #100#0;
         #102#128 = 2;
         |LEE 101#102=;
         |SI FSalida ! 0;
             |DDEFECTO #102;
             #102#0   = #100#0;
             #102#128 = 2;
             |GRABA 020#102b;
         |FINSI;
         |HAZ Graba102;
         |LIBERA #102;
     |SINO;
         #102#0   = #100#0;
         #102#128 = 2;
         |LEE 101#102=;
         |SI FSalida = 0;
             |BORRA 020#102a;
             |LIBERA #102;
         |FINSI;
     |FINSI;

     nLinea      = 2;
     nSwFamiliar = 1;
     |BUCLE rem00101;

     nSwFamiliar = 0;

     #102#0   = #100#0;
     #102#128 = 99;
     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0   = #100#0;
         #102#128 = 99;
         |GRABA 020#102b;
     |FINSI;
     |HAZ Graba102;
     |LIBERA #102;
     |CIERRA #102;

     |PUSHV 0501 2380;
     |ENTLINEAL #1#102, 2, 4, 22, 1, ClaveBaja102, ClaveAlta102;
     |POPV;
|FPRC;
