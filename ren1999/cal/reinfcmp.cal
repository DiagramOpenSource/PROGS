|FICHEROS;
     reinfcmp #0;
     rem00100 #1;   || Datos contribuyentes
     referen@ #2;   || Referencia para lectura de datos de la renta del a¤o 98

     &poblaci@ #703;
|FIN;

|VARIABLES;
   DEmpre = 0;
   HEmpre = 0;
   Cont = 0;

   Dia = "";
   Mes = 0;
   anyo = "";
   MesAlfa = "";
   Comodin = "";
   &FechAlfa = "";

   Fichero = "";
   Primero = 0;
   Desc    = 0;
   &LinAlfa = "";
   &NLin = 0;
   Path    = "";
   NumLin  = 0;

   &enCodProv = 0;
   &enCodPobl = 0;
|FIN;

|PROCESO Seleccion;
   |SI #0#0 = "S";
      |C_M #0#1,1,"S";
      |C_M #0#2,1,"S";
      |PARA Cont = 3; |SI Cont [ 23; |HACIENDO Cont = Cont + 1;
         |C_M #0#Cont#,1,"N";
      |SIGUE;
   |SINO;
      |C_M #0#1,1,"N";
      |C_M #0#2,1,"N";
      |PARA Cont = 3; |SI Cont [ 23; |HACIENDO Cont = Cont + 1;
         |C_M #0#Cont#,1,"S";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO Emision;
   Comodin = #0#24 % 0102;
   Dia = Comodin;

   Comodin = #0#24 % 0402;
   Mes  = Comodin;

   anyo = #0#24 % 0704;
   |HAZ AlfaMes;
   FechAlfa = Dia + " de " + MesAlfa + " de "+ anyo;

   enCodProv = #1#20;
   enCodPobl = #1#21;
   |HAZ LeePoblacion;

   |INFOR "reinfcm1";
   |SI FSalida < 0; |ACABA; |FINSI;
   |PRINT;
   |PIEINF;
   |FININF;

   |INFOR "reinfcm2";
   |SI FSalida < 0; |ACABA; |FINSI;

   LinAlfa = "IDENTIFICACION";                            |PRINT;
   LinAlfa = " ";                                         |PRINT;
   LinAlfa = "- Etiquetas de Hacienda o Fotocopia del D.N.I."; |PRINT;
   LinAlfa = " ";                                         |PRINT;


   Fichero = "rerendtr.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "recapinm.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "revalore.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "revalono.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "rectacor.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "rem00010.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "rem00011.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "rem00012.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "rem00013.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "reempmod.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "rem00014.mas"; Primero = 0; |HAZ BuscaDatos;
   Fichero = "reactafe.mas"; Primero = 0; |HAZ BuscaDatos;
   |PIEINF;
   |FININF;

|FPRC

|DEFBUCLE Emision;
#rem00100#1;
;
DEmpre;
HEmpre;
;
NULL,Emision;
|FIN;

|PROCESO MiraSiDatos;
   |SI Primero = 0;
      |SI Fichero = "rerendtr.mas";
         Desc = 4;
         |SI NLin ] 52; |PIEINF; NLin = 0; |FINSI;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "RENDIMIENTOS DEL TRABAJO";                  |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "- Certificado de rendimientos y retenciones"; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "En el a¤o 1999 declaro los siguientes rendimientos "; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
      |FINSI;
      |SI Fichero = "recapinm.mas";
         Desc = 5;
         |SI NLin ] 52; |PIEINF; NLin = 0; |FINSI;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "RENDIMIENTOS DEL CAPITAL INMOBILIARIO";     |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "- Recibo del Impuesto sobre Bienes Inmuebles (Ant.Contrib.):"; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "En el a¤o 1999 declaro los siguientes rendimientos "; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
      |FINSI;
      |SI Fichero = "revalore.mas"; |O Fichero = "revalono.mas";
      |O  Fichero = "rectacor.mas";
         |SI NLin ] 50; |PIEINF; NLin = 0; |FINSI;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "RENDIMIENTOS DEL CAPITAL MOBILIARIO";       |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "- Certificado de rendimientos y retenciones"; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "En el a¤o 1999 declaro los siguientes rendimientos "; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         |SI Fichero = "revalore.mas";
            Desc = 14;
            LinAlfa = "      * Acciones bolsa";                    |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "revalono.mas";
            Desc = 14;
            LinAlfa = "      * Acciones no bolsa y fondos de inversiones";   |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "rectacor.mas";
            Desc = 14;
            LinAlfa = "      * Cuentas corrientes y otros";        |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
      |FINSI;
      |SI Fichero = "rem00010.mas"; |O Fichero = "rem00011.mas";
      |O  Fichero = "rem00012.mas"; |O Fichero = "rem00013.mas";
      |O  Fichero = "reempmod.mas"; |O Fichero = "rem00014.mas";
      |O  Fichero = "reactafe.mas";
         |SI NLin ] 50; |PIEINF; NLin = 0; |FINSI;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "RENDIMIENTOS POR ACTIVIDADES PROFESIONALES, EMPRESARIALES O AGRICOLAS";       |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         LinAlfa = "En el a¤o 1999 declaro los siguientes rendimientos "; |PRINT; NLin = NLin + 1;
         LinAlfa = " ";                                         |PRINT; NLin = NLin + 1;
         |SI Fichero = "rem00010.mas";
            Desc = 14;
            LinAlfa = "      * Profesionales modalidad normal";       |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "rem00011.mas";
            Desc = 14;
            LinAlfa = "      * Profesionales modalidad simplificada"; |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "rem00012.mas";
            Desc = 14;
            LinAlfa = "      * Empresariales modalidad normal";       |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "rem00013.mas";
            Desc = 14;
            LinAlfa = "      * Empresariales modalidad simplificada"; |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "reempmod.mas";
            Desc = 19;
            LinAlfa = "      * Empresariales por modulos";            |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "rem00014.mas";
            Desc = 14;
            LinAlfa = "      * Agricolas y ganaderas";                |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
         |SI Fichero = "reactafe.mas";
            Desc = 6;
            LinAlfa = "      * Activos afectos a la actividad";       |PRINT; NLin = NLin + 1;
            LinAlfa = " ";                                      |PRINT; NLin = NLin + 1;
         |FINSI;
      |FINSI;
      Primero = 1;
   |FINSI;
   LinAlfa = "             " + #referen@#Desc#; |PRINT; NLin = NLin + 1;
|FPRC;

|DEFBUCLE MiraSiDatos;
#referen@#1002;
;
#rem00100#0,01;
#rem00100#0,99;
;
NULL,MiraSiDatos;
|FIN;

|PROCESO BuscaDatos;
   |DBASS Comodin; |QBF Comodin;
   Path = Comodin + "ren1998/def/";
   Path = Path + Fichero;
   |CARGA_DEF Path, referen@;
   Path = Comodin + "ren1998/fich/";
   |PATH_DAT #2 Path;
   |ABRE #referen@;
   Primero = 0;
   |BUCLE MiraSiDatos;
   |CIERRA #referen@;
   |DESCARGA_DEF #referen@;
|FPRC;

|PROCESO AlfaMes;
   |SI Mes = 1;  MesAlfa = "Enero";      |FINSI;
   |SI Mes = 2;  MesAlfa = "Febrero";    |FINSI;
   |SI Mes = 3;  MesAlfa = "Marzo";      |FINSI;
   |SI Mes = 4;  MesAlfa = "Abril";      |FINSI;
   |SI Mes = 5;  MesAlfa = "Mayo";       |FINSI;
   |SI Mes = 6;  MesAlfa = "Junio";      |FINSI;
   |SI Mes = 7;  MesAlfa = "Julio";      |FINSI;
   |SI Mes = 8;  MesAlfa = "Agosto";     |FINSI;
   |SI Mes = 9;  MesAlfa = "Septiembre"; |FINSI;
   |SI Mes = 10; MesAlfa = "Octubre";    |FINSI;
   |SI Mes = 11; MesAlfa = "Noviembre";  |FINSI;
   |SI Mes = 12; MesAlfa = "Diciembre";  |FINSI;
|FPRC;

|PROGRAMA;
   |HAZ PreparaInformes;

   |CLS;
   |CABEZA "Emision informe comprobacion";
   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |IMPRE 0;
      |SI FSalida < 0; |ACABA; |FINSI;
      |SI #0#0 = "S";
         DEmpre = #0#1;
         HEmpre = #0#2;
         |BUCLE Emision;
      |SINO;
         |PARA Cont = 3; |SI Cont [ 23; |HACIENDO Cont = Cont + 1;
            DEmpre = #0#Cont#;
            HEmpre = #0#Cont#;
            |BUCLE Emision;
         |SIGUE;
      |FINSI;
      |FINIMP;
   |FINSI;
|FPRO;
