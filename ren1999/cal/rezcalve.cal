|FICHEROS;
     rezcalve #0;
     rem01001 #1001;
     rem01002 #1002;
     rem00028 #28;
     rem00099 #99;
     rem00100 #100;
     rem00024 #24;
     rem00050 #50;
     rem00055 #55;
     rem00036 #36;
     reparame #150;

     calcul01@ #1;   || zdat1001
     calcul02@ #2;   || zdat1002
     calcul03@ #3;   || rem01001
     calcul04@ #4;   || rem01002
     referenc@ #20;  || Mantenimientos donde se graba patrimonios
|FIN;

|VARIABLES;
      aDirDatos  = "";
      aBorrar    = "";
      aFichero   = "";
      aDef       = "";
      aPathRenta = "";
      aPathBase  = "";
      aAlfa      = "";
      aMenu      = "";
      aAlfa1     = "";
      aAlfa2     = "";

      nCanti      = 0;
      nCanti1     = 0;
      nCanti2     = 0;
      nRdto97     = 0;
      nSwPrint    = 0;
      nConta      = 0;
      nValor      = 0;
      nHandle     = 0;
      nDiferencia = 0;
      nLinea      = 0;
      nCampo      = 0;
      nPorce      = 0;


     &enEmpresa    = 0;
     &enNomeDat    = 0;
     &enAnt        = 0;
     &eaPrograma   = "";
     &eaPunto      = "";
     &eaDeclarante = "";
     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaEdadDec    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr16_1   = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
|FIN;

|PROCESO Repasa;
     |SI enEmpresa = #1001#0;  |ACABA;  |FINSI;

     enEmpresa = #1001#0;
     |SUB_EJECUTA_NP "rezcalcu";
|FPRC;

|DEFBUCLE rem01001P;
     #1001#1;
     5;
     00001, 00, "          ", "100";
     99999, 99, "zzzzzzzzzz", "714";
     ;
     NULL, Repasa;
|FIN;

|PROCESO BuscaIncidencias;
     #2#0 = #4#0;
     #2#1 = #4#1;
     #2#2 = #4#2;
     #2#3 = #4#3;
     #2#4 = #4#4;
     |LEE 040#2=;
     |SI FSalida ! 0;   |DDEFECTO #2;  |FINSI;

     |SI #2#4 = "108";  |ACABA;  |FINSI;
     |SI #2#4 = "109";  |ACABA;  |FINSI;
     |SI #2#4 = "110";  |ACABA;  |FINSI;

     |SI #2#4 = "TME";  |O #2#4 = "TMA";
         |SI #3#5 ! "714";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #2#6 ! #4#6;
         #1001#0 = #3#0;
         #1001#1 = #3#1;
         #1001#2 = #3#2;
         #1001#5 = #3#5;
         #1001#7 = #3#7;
         #1002#4 = #4#4;
         #1002#5 = #4#5;
         #1002#6 = #4#6;
         enAnt   = #2#6;
         |PRINT;
         nSwPrint = 1;
     |FINSI;
|FPRC;

|DEFBUCLE rem01002;
     #4#1005;
     ;
     #3#0, #3#1, #3#2, 00, "   ";
     #3#0, #3#1, #3#2, 99, "zzz";
     ;
     NULL, BuscaIncidencias;
|FIN;

|PROCESO Incidencias;
     |BUCLE rem01002;
|FPRC;

|DEFBUCLE rem01001S;
     #3#1003;
     5;
     00001, 00, "          ", "100";
     99999, 99, "zzzzzzzzzz", "101";
     ;
     NULL, Incidencias;
|FIN;

|DEFBUCLE rem01001T;
     #3#1003;
     5;
     00001, 00, "          ", "714";
     99999, 99, "zzzzzzzzzz", "714";
     ;
     NULL, Incidencias;
|FIN;

|PROCESO Borra;
     aBorrar  = aDirDatos + aFichero + ".dat";  |FBORRA aBorrar;
     aBorrar  = aDirDatos + aFichero + ".ddx";  |FBORRA aBorrar;
     aBorrar  = aDirDatos + aFichero + ".ixx";  |FBORRA aBorrar;
|FPRC;

|PROCESO BorraLiquiMala;
     aFichero = "zdat1001";  |HAZ Borra;
     aFichero = "zdat1002";  |HAZ Borra;
     aFichero = "zdat1010";  |HAZ Borra;
     aFichero = "zdat1011";  |HAZ Borra;
     aFichero = "zdat1012";  |HAZ Borra;
     aFichero = "zdat1013";  |HAZ Borra;
     aFichero = "zdat1014";  |HAZ Borra;
     aFichero = "zdat1015";  |HAZ Borra;
     aFichero = "zdat1016";  |HAZ Borra;
     aFichero = "zdat1017";  |HAZ Borra;
     aFichero = "zdat1018";  |HAZ Borra;
     aFichero = "zdat1019";  |HAZ Borra;
     aFichero = "zdat1020";  |HAZ Borra;
     aFichero = "zdat1021";  |HAZ Borra;
     aFichero = "zdat1022";  |HAZ Borra;
     aFichero = "zdat1023";  |HAZ Borra;
     aFichero = "zdat1024";  |HAZ Borra;
     aFichero = "zdat1025";  |HAZ Borra;
     aFichero = "zdat1026";  |HAZ Borra;
     aFichero = "zdat1027";  |HAZ Borra;
     aFichero = "zdat1028";  |HAZ Borra;
     aFichero = "zdat1029";  |HAZ Borra;
     aFichero = "zdat1030";  |HAZ Borra;
     aFichero = "zdat1031";  |HAZ Borra;
     aFichero = "zdat1032";  |HAZ Borra;
     aFichero = "zdat1033";  |HAZ Borra;
     aFichero = "zdat1034";  |HAZ Borra;
     aFichero = "zdat1035";  |HAZ Borra;
     aFichero = "zdat1036";  |HAZ Borra;
     aFichero = "zdat1037";  |HAZ Borra;
     aFichero = "zdat1038";  |HAZ Borra;
     aFichero = "zdat1039";  |HAZ Borra;
     aFichero = "zdat1040";  |HAZ Borra;
     aFichero = "zdat1041";  |HAZ Borra;
     aFichero = "zdat1042";  |HAZ Borra;
     aFichero = "zdat1043";  |HAZ Borra;
|FPRC;

|PROCESO CalculaAgraria;
     #28#30 = #28#26 + #28#27;
     #28#34 = #28#30 - #28#33;

     |SI #28#53 ! 0;
         nPorce = (#28#53 / #28#25) * 100;
         #28#36 = 1;
         |SI nPorce ] 10; #28#36 = 0.90; |FINSI;
         |SI nPorce ] 20; #28#36 = 0.85; |FINSI;
         |SI nPorce ] 30; #28#36 = 0.80; |FINSI;
         |SI nPorce ] 40; #28#36 = 0.75; |FINSI;
     |FINSI;

     nCanti1 = #28#28;
     |SI #28#35 ! 0;  nCanti1 = nCanti1 * #28#35;  |FINSI;
     |SI #28#36 ! 0;  nCanti1 = nCanti1 * #28#36;  |FINSI;
     |SI #28#38 ! 0;  nCanti1 = nCanti1 * #28#38;  |FINSI;

     nCanti2 = #28#29;
     |SI #28#35 ! 0;  nCanti2 = nCanti2 * #28#35;  |FINSI;
     |SI #28#36 ! 0;  nCanti2 = nCanti2 * #28#36;  |FINSI;
     |SI #28#38 ! 0;  nCanti2 = nCanti2 * #28#38;  |FINSI;

     nRdto97 = (nCanti1 + nCanti2) * 1.05;

     nCanti1 = #28#26 - #28#31;
     |SI #28#35 ! 0;  nCanti1 = nCanti1 * #28#35;  |FINSI;
     |SI #28#36 ! 0;  nCanti1 = nCanti1 * #28#36;  |FINSI;
     |SI #28#38 ! 0;  nCanti1 = nCanti1 * #28#38;  |FINSI;
     |SI #28#39 ! 0;  nCanti1 = nCanti1 * #28#39;  |FINSI;

     nCanti2 = #28#27 - #28#32;
     |SI #28#35 ! 0;  nCanti2 = nCanti2 * #28#35;  |FINSI;
     |SI #28#36 ! 0;  nCanti2 = nCanti2 * #28#36;  |FINSI;
     |SI #28#37 ! 0;  nCanti2 = nCanti2 * #28#37;  |FINSI;
     |SI #28#38 ! 0;  nCanti2 = nCanti2 * #28#38;  |FINSI;
     |SI #28#39 ! 0;  nCanti2 = nCanti2 * #28#39;  |FINSI;

     nCanti = nCanti1 + nCanti2;
     |SI nCanti > 0;
         #28#40 = (nCanti1 + nCanti2) - ((nCanti1 + nCanti2) % 2);
     |SINO;
         #28#40 = (nCanti1 + nCanti2) ! 0;
     |FINSI;

     #28#42 = #28#40;
     |SI nRdto97 < #28#42;  |Y nRdto97 ! 0;
         #28#42 = nRdto97;
     |FINSI;
     #28#41 = #28#40 - #28#42;
     #28#44 = #28#42 - #28#43;

     #28#46 = #28#44 % #28#45;
     #28#48 = #28#44 % #28#47;
     #28#49 = #28#44 - #28#46 - #28#48;
     |SI #28#49 < 0;
         |SI #28#35 ! 0;  |O #28#36 ! 0;  |O #28#37 ! 0;  |O #28#38 ! 0;
          |O #28#39 ! 0;  |O #28#45 ! 0;  |O #28#46 ! 0;
             #28#49 = 0;
         |FINSI;
     |FINSI;

     #28#51 = 0;
     |SI #28#50 = "S";
         #28#51 = #28#49 % 30;
     |FINSI;

     #28#52 = #28#49 - #28#51;

     |GRABA 020#28a;
     |LIBERA #28;
|FPRC;

|DEFBUCLE rem00028;
     #28#1;
     ;
     00000, 01;
     99999, 99;
     be;
     NULL, CalculaAgraria;
|FIN;

|PROCESO BorraPatri;
     enEmpresa = #99#0;

     |SI #99#0 ! 0;
         |SI #99#4 = "  ";  |Y #99#5 = 0;  |ACABA;  |FINSI;
     |FINSI;

     |BORRA 020#99a;
     |LIBERA #99;

     eaPrograma   = "rem00099";
     eaPunto      = #99#1;
     eaLetra      = #99#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00099;
     #99#1;
     ;
     -9999, "  ", -999;
     99999, "zz", 999;
     be;
     NULL, BorraPatri;
|FIN;

|PROCESO GrabaPat;
     |ABRE #100;
     #100#0 = #20#0;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     eaEdadDec = #100#7;
     |SI #20#2 = "CONYUGE   ";  eaEdadDec = #100#40;  |FINSI;

     |SI nConta = 1;
          |SI #20#3  = "R";           |ACABA;  |FINSI;
          |SI #20#3  = "X";           |ACABA;  |FINSI;
          |SI #20#24 = "S";           |ACABA;  |FINSI;
          |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
          |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
          |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
          |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;

          |HAZ LimpiaPatrim;

          eaDeDonde  = "B1";
          eaLinDonde = #20#1;
          eaAnyoUsu  = #20#16;
          eaPatr08   = #20#105;
          eaPatr09   = #20#106;
          eaPatr16   = #20#104;
          eaPatr17   = #20#14;
          nValor     = #20#26;

          |SI #150#16 = "N";  |Y #150#17 = "S";
              nValor = #20#26 + #20#29;
          |FINSI;

          |SI nValor < #20#27;  nValor = #20#27;  |FINSI;
          |SI nValor < #20#15;  nValor = #20#15;  |FINSI;

          eaPatr10   = nValor;

          |SI #20#18 = "R";
              eaLetra    = "B1";
              eaPatr11   = #20#19;
              eaPatr12   = #20#20;
          |SINO;
              eaLetra    = "A1";
              eaPatr06   = #20#13;
              eaPatr19   = "V";
              |SI #20#18 = "L";  eaPatr19   = "L";  |FINSI;
              |SI #20#18 = "O";  eaPatr19   = "O";  |FINSI;
          |FINSI;

          |SI #20#104 = "U";
              eaLetra    = "M1";
              eaPatr06   = "";
              eaPatr15   = #20#13;
              eaPatr14   = nValor;
          |FINSI;

          eaPatr20 = #20#5;
          eaPatr21 = #20#6;

          |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 2;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#15 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = #20#11;
         eaDeDonde  = "C0";
         eaLinDonde = #20#1;
         eaAnyoUsu  = #20#14;
         eaPatr06   = #20#17;
         eaPatr16   = #20#13;
         eaPatr10   = #20#15;
         |SI #20#11 = "E1";  eaPatr13 = #20#18;  |FINSI;
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 3;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#15 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = #20#11;
         eaDeDonde  = "C1";
         eaLinDonde = #20#1;
         eaAnyoUsu  = #20#14;
         eaPatr06   = #20#17;
         eaPatr16   = #20#13;
         eaPatr10   = #20#15;
         |SI #20#11 = "E1";  eaPatr13 = #20#18;  |FINSI;
         eaPatr20 = #20#5;
         eaPatr21 = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 4;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#11 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = "C1";
         eaDeDonde  = "D0";
         eaLinDonde = #20#1;
         eaAnyoUsu  = 0;
         eaPatr06   = #20#25;
         eaPatr08   = #20#23;
         eaPatr09   = #20#24;
         eaPatr15   = #20#22;
         eaPatr18   = #20#19;
         nValor     = #20#11 % #20#15;
         eaPatr10   = nValor;
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 5;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#11 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = "C1";
         eaDeDonde  = "D1";
         eaLinDonde = #20#1;
         eaAnyoUsu  = 0;
         eaPatr06   = #20#25;              || Domicilio
         eaPatr08   = #20#23;              || Codigo Postal 1
         eaPatr09   = #20#24;              || Codigo Postal 2
         eaPatr15   = #20#22;              || Actividad
         eaPatr18   = #20#19;              || Epigrafe
         nValor     = #20#11 % #20#15;     || Valor Patrimonial
         eaPatr10   = nValor;              || Valor Patrimonial
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 6;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#11 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = "C1";
         eaDeDonde  = "D3";
         eaLinDonde = #20#1;
         eaAnyoUsu  = 0;
         eaPatr06   = #20#23;              || Domicilio
         eaPatr08   = #20#21;              || Codigo Postal 1
         eaPatr09   = #20#22;              || Codigo Postal 2
         eaPatr15   = #20#20;              || Actividad
         eaPatr18   = #20#17;              || Epigrafe
         nValor     = #20#11 % #20#15;     || Valor Patrimonial
         eaPatr10   = nValor;              || Valor Patrimonial
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 7;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#11 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = "C1";
         eaDeDonde  = "D4";
         eaLinDonde = #20#1;
         eaAnyoUsu  = 0;
         eaPatr06   = #20#24;              || Domicilio
         eaPatr08   = #20#22;              || Codigo Postal 1
         eaPatr09   = #20#23;              || Codigo Postal 2
         eaPatr15   = #20#21;              || Actividad
         eaPatr18   = #20#19;              || Epigrafe
         nValor     = #20#11 % #20#15;     || Valor Patrimonial
         eaPatr10   = nValor;              || Valor Patrimonial
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 8;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#15 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = #20#11;
         eaDeDonde  = "C3";
         eaLinDonde = #20#1;
         eaAnyoUsu  = #20#14;
         eaPatr06   = #20#17;
         eaPatr16   = #20#13;
         eaPatr16_1 = #20#19;
         eaPatr10   = #20#15;
         eaPatr14   = #20#24;
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 9;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#15 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = #20#11;
         eaDeDonde  = "C4";
         eaLinDonde = #20#1;
         eaAnyoUsu  = #20#14;
         eaPatr06   = #20#16;
         eaPatr16   = #20#13;
         eaPatr10   = #20#15;
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI nConta = 10;
         |SI #20#3  = "R";           |ACABA;  |FINSI;
         |SI #20#3  = "X";           |ACABA;  |FINSI;
         |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
         |SI #20#15 = 0;             |ACABA;  |FINSI;

         |HAZ LimpiaPatrim;

         eaLetra    = #20#11;
         eaDeDonde  = "C5";
         eaLinDonde = #20#1;
         eaAnyoUsu  = #20#14;
         eaPatr06   = #20#16;
         eaPatr16   = #20#13;
         eaPatr10   = #20#15;
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;

         |HAZ GrabaPatrimonio;
     |FINSI;
|FPRC;

|PROCESO Patrimonio;
     |PARA nConta = 1;  |SI nConta [ 10;  |HACIENDO nConta = nConta + 1;
           |SI nConta = 1;
               eaDeDonde = "B1";  aDef    = aPathRenta + "rem00021.mas";
           |FINSI;
           |SI nConta = 2;
               eaDeDonde = "C0";  aDef    = aPathRenta + "rem00022.mas";
           |FINSI;
           |SI nConta = 3;
               eaDeDonde = "C1";  aDef    = aPathRenta + "rem00023.mas";
           |FINSI;
           |SI nConta = 4;
               eaDeDonde = "D0";  aDef    = aPathRenta + "rem00025.mas";
           |FINSI;
           |SI nConta = 5;
               eaDeDonde = "D1";  aDef    = aPathRenta + "rem00026.mas";
           |FINSI;
           |SI nConta = 6;
               eaDeDonde = "D3";  aDef    = aPathRenta + "rem00027.mas";
           |FINSI;
           |SI nConta = 7;
               eaDeDonde = "D4";  aDef    = aPathRenta + "rem00028.mas";
           |FINSI;
           |SI nConta = 8;
               eaDeDonde = "C3";  aDef    = aPathRenta + "rem00051.mas";
           |FINSI;
           |SI nConta = 9;
               eaDeDonde = "C4";  aDef    = aPathRenta + "rem00052.mas";
           |FINSI;
           |SI nConta = 10;
               eaDeDonde = "C5";  aDef    = aPathRenta + "rem00055.mas";
           |FINSI;

           |CARGA_DEF aDef, referenc@;
           |SI FSalida ! 0;
               aAlfa = "     Error en cargar el Def " + aDef;
               |MENAV aAlfa;
               |ACABA;
           |FINSI;

           |ABRE #150;
           |LEE 040#150p;
           |SI FSalida ! 0;  |DDEFECTO #150;  |FINSI;
           |CIERRA #150;

           |ABRE #20;
           |LEE 040#20p;
           |PARA; |SI FSalida = 0;  |HACIENDO;
                  enEmpresa    = #20#0;
                  eaDeclarante = #20#2;
                  |HAZ GrabaPat;
                  |LEE 040#20s;
           |SIGUE;
           |CIERRA #20;
           |DESCARGA_DEF #referenc@;
     |SIGUE;
|FPRC;

|PROCESO Pasa50;
     #50#9  = (#50#5 - #50#7)  % #50#8;         |PINTA #50#9;
     |GRABA 020#50a;
     |LIBERA #50;

     #24#24 = #24#24 + #50#9;
|FPRC;

|DEFBUCLE rem00050;
     #50#1;
     ;
     #24#0, #24#1, 1900;
     #24#0, #24#1, 2999;
     be;
     NULL, Pasa50;
|FIN;

|PROCESO Pasa24;
     |SI #24#12 ] 1;  |Y #24#12 [ 12;
         #24#24 = 0;
         |BUCLE rem00050;
     |SINO;
         #24#24 = (#24#18 - #24#22) % #24#23;
     |FINSI;
     |GRABA 020#24a;
     |LIBERA #24;
|FPRC;

|DEFBUCLE rem00024;
     #24#1;
     ;
     00000, 00;
     99999, 99;
     be;
     NULL, Pasa24;
|FIN;

|PROCESO Borra36;
     |BORRA 020#36a;
     |LIBERA #36;

     enEmpresa    = #36#0;
     eaPrograma   = "rem00036";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00036;
     #36#1;
     16, 17;
     #55#0, 01, "C5", #55#1;
     #55#0, 99, "C5", #55#1;
     be;
     NULL, Borra36;
|FIN;

|PROCESO Pasa55;
     |BUCLE rem00036;

     |SI #55#20 = 0;  |Y #55#21 = 0;  |ACABA;  |FINSI;

     aAlfa1      = #55#18 % -104;
     aAlfa2      = #55#19 % -104;
     nDiferencia = (#55#19 - #55#18) + 1;

     |ABRE #36;
     #36#0 = #55#0;
     #36#1 = 99;
     |LEE 040#36];
     |SI FSalida = 0;
         |LEE 040#36a;
     |SINO;
         |LEE 040#36u;
     |FINSI;

     |SI FSalida = 0; |Y #36#0 = #55#0;
         nLinea = #36#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #36;
     #36#0  = #55#0;
     #36#1  = nLinea;
     |PARA nCampo = 2;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           #36nCampo = #55nCampo;
     |SIGUE;
     #36#3  = "R";
     |SI #55#3 = "X";  #36#3 = "X";  |FINSI;

     |SI nDiferencia [ 730;
         #36#12 = #55#24;
         #36#13 = #55#23;
     |SINO;
         #36#14 = #55#24;
         #36#15 = #55#23;
     |FINSI;

     #36#11 = #55#17;
     #36#16 = "C5";
     #36#17 = #55#1;
     #36#18 = #55#16;

     |GRABA 020#36n;
     |LIBERA #36;
     |CIERRA #36;

     enEmpresa    = #36#0;
     eaPrograma   = "rem00036";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00055;
     #55#1;
     ;
     00000, 00;
     99999, 99;
     ;
     NULL, Pasa55;
|FIN;

|PROCESO CogeVersion;
     aMenu = aPathBase + "ren1999.men";
     |XABRE "U", aMenu, nHandle;
     |SI FSalida ] 0;
         |XLEE nHandle, 250, aAlfa;
         aAlfa = aAlfa % 403;
     |FINSI;
     |XCIERRA nHandle;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |DBASE aPathRenta;  |QBT aPathRenta;
     aPathBase  = aPathRenta;
     aPathRenta = aPathRenta + "def/";

     |ABRE #0;
     #0#0 = 1;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 1;
         |GRABA 020#0b;
     |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "rezcalve";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI #0#1 = 9;
         |BUCLE rem00024;
         |BUCLE rem00055;
     |FINSI;

     |SI #0#1 [ 26;
         |BUCLE rem00028;
     |FINSI;

     |BUCLE rem00099;
     |ABRE #99;
     |HAZ Patrimonio;
     |CIERRA #99;

     |HAZ CogeVersion;
     #0#1 = aAlfa;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DFICE aDirDatos;  |QBT aDirDatos;

     |HAZ BorraLiquiMala;

     enEmpresa = 0;
     enNomeDat = 1;
     |BUCLE rem01001P;

     aDef    = aPathRenta + "rem01001.mas";
     |CARGA_DEF aDef, calcul01@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |FININF;
         |FINIMP;
         |ACABA;
     |FINSI;

     aDef    = aPathRenta + "rem01002.mas";
     |CARGA_DEF aDef, calcul02@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |FININF;
         |FINIMP;
         |ACABA;
     |FINSI;

     aDef    = aPathRenta + "rem01001.mas";
     |CARGA_DEF aDef, calcul03@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |FININF;
         |FINIMP;
         |ACABA;
     |FINSI;

     aDef    = aPathRenta + "rem01002.mas";
     |CARGA_DEF aDef, calcul04@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |FININF;
         |FINIMP;
         |ACABA;
     |FINSI;

     |NOME_DAT #calcul01@#"zdat1001"#;
     |NOME_DAT #calcul02@#"zdat1002"#;
     |NOME_DAT #calcul03@#"rem01001"#;
     |NOME_DAT #calcul04@#"rem01002"#;

     |ABRE #1;
     |ABRE #2;

     |BUCLE rem01001S;
     |SI nSwPrint = 1;  |PIEINF; |FINSI;

     nSwPrint   = 0;
     |BUCLE rem01001T;
     |SI nSwPrint = 1;  |PIEINF; |FINSI;

     |CIERRA #1;
     |CIERRA #2;

     |DESCARGA_DEF #calcul04@;
     |DESCARGA_DEF #calcul03@;
     |DESCARGA_DEF #calcul02@;
     |DESCARGA_DEF #calcul01@;

     |HAZ BorraLiquiMala;

     |FININF;
     |FINIMP;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Verificacion  de Version";
     |PINPA #0#0;
     |ENDATOS #1#0;
|FPRO;
