|FICHEROS;
     reemi101 #0;
     rem01001 #1;

     rem00100 #91;
     rem00101 #92;
     rem01002 #93;

     rew00001 #99,MANTE;

     rew00010 #600;
     rew00011 #601;
     rew00050 #602;
     rew00051 #603;
     rew00052 #604;
     rew00053 #605;
     rew00054 #606;
     rew00026 #607;

     defdata@ #650;
     &poblaci@ #703;
     &haciend@ #706;
|FIN;

|VARIABLES;
     Direc = "";
     Path  = "";
     Nombre = "";
     Handle = 0;
     Calc = 0;
     Calc1 = 0;
     nCont = 0;

     Caracter = "";
     aParte1 = "";
     aParte2 = "";
     nParte1 = 0;
     nParte2 = 0;
     NombreTit = "";
     NombreCon = "";
     NifTit    = "";
     NifCon    = "";
     &Tipo01 = ""; &Tipo02 = ""; &Tipo03 = ""; &Tipo04 = "";
     &Tipo05 = ""; &Tipo06 = ""; &Tipo07 = ""; &Tipo08 = "";
     TipoContr = 0;
     NCampo  = 0;
     NHoja   = 0;

     Comodin = "";
     Comodin1 = "";
     Comodin2 = "";
     Comodin3 = "";
     Linea = 0;
     LinComp = 0;
     LinComp2 = 0;
     FEstado = 0;
     ||Acts = 0;
     Ents = 0;

     Comod  = "";
     Comod1 = "";
     Comod2 = "";
     ComodNum2 = 0;
     Valor  = 0;
     ValorEnt = "";
     ValorDec = "";
     NDigEnt  = 0;
     NDigDec  = 0;
     Sigue    = 0;

     Tipo = 0;
     Lineal = 0;
     LinTipo1 = 0;
     LinTipo2 = 0;
     LinTipo3 = 0;
     Tipo1 = 0;
     Tipo2 = 0;
     Tipo3 = 0;
     Cont = 0;
     Cont1 = 0;
     MaxTipo = 0;
     Perce = "";

     XCampos = 0;
     Modifica = "";
     Hoja = 0;
     VEmpresa = 0;
     VTipo = "";
     NCopia = 0;
     eaCuenta = "";
     DiaInf   = "";
     MesNum   = "";
     MesInf   = "";
     EjerInf  = "";
     DEmpre   = 0;
     HEmpre   = 0;
     SwEstar = 0;
     NombreImpre = "";
     alguno = 0;

     SwError = 0;
     Casilla = "";
     Bloque  = 0;
     Valfa1  = "";
     Valfa2  = "";

     ComodNum = 0;
     ComodNum1 = 0;
     ParteEnt = 0;
     ParteDec = 0;
     Formato = 0;
     DReimp  = "";
     HReimp  = "";

     HayDatos = 0;
     H02 = 0;
     H03 = 0;
     H04 = 0;
     H05 = 0;
     Separada = 0;
     nEdad    = 0;

     &eaTipoSec   = "";

     &enCodProv = 0;
     &enCodPobl = 0;

{200}&NEmpresas   = "";
|FIN;
|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************


|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|PROCESO Seleccion; |TIPO 0;
  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            #0XCampos = 0; |PINTA #0XCampos;
            |CAMPO_MODIFICA #0XCampos, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |CAMPO_MODIFICA #0XCampos, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO SelecTipo;  |TIPO 0;

  Modifica = "S";
  |SI #0Campo = "L";
     Modifica = "N";
     #reemi101#54 = "S";
     #reemi101#55 = "N";
     |PINTA #reemi101#54;
     |PINTA #reemi101#55;
     |C_M #reemi101#54,1,"N";
     |C_M #reemi101#55,1,"N";
  |SINO;
     |C_M #reemi101#54,1,"S";
     |C_M #reemi101#55,1,"S";
  |FINSI;
/*
  |PARA XCampos = 37; |SI XCampos [ 54; |HACIENDO XCampos = XCampos + 1;
        |C_M #0XCampos, 1, "S";
        #0XCampos = "S";  |PINTA #0XCampos;
        |C_M #0XCampos, 1, Modifica;   || esto quita el REM
  |SIGUE;
*/
  #0#57 = "S";
  |C_M #0#57, 1, Modifica;

  #0#37 = 1;  |PINTA #0#37;
|FPRC;

|PROCESO TipoPapel;  |TIPO 0;
  |C_M #0#56, 1, "S";
  |SI #0#34 = "L";  |Y #0#55 = "N";
      |C_M #0#56, 1, "N";
  |FINSI;
|FPRC;

||********************************
|| PROCESOS DE LECTURAS Y REPARTOS
||********************************

|PROCESO CargaHojas;
|ABRE #rem01002;

  |HAZ Hoja1;
  HayDatos = 0; |HAZ Hoja2; H02 = HayDatos;
  HayDatos = 0; |HAZ Hoja3; H03 = HayDatos;
  HayDatos = 0; |HAZ Hoja4; H04 = HayDatos;
  HayDatos = 0; |HAZ Hoja5; H05 = HayDatos;
  |HAZ Hoja6;
  |HAZ Hoja7;
  |HAZ Hoja8;

|CIERRA #rem01002;
|FPRC;

|PROCESO Hoja102;
   Hoja = 19;  |HAZ Impresion;
|FPRC;

|PROCESO ImprimeLos;

  |DELINDEX #rew00010;
  |DELINDEX #rew00011;
  |DELINDEX #rew00050;
  |DELINDEX #rew00051;
  |DELINDEX #rew00052;
  |DELINDEX #rew00053;
  |DELINDEX #rew00054;
  |DELINDEX #rew00026;

  |DDEFECTO #rew00010;
  |DDEFECTO #rew00011;
  |DDEFECTO #rew00050;
  |DDEFECTO #rew00051;
  |DDEFECTO #rew00052;
  |DDEFECTO #rew00053;
  |DDEFECTO #rew00054;
  |DDEFECTO #rew00026;

  |ABRE #rew00010;
  |ABRE #rew00011;
  |ABRE #rew00050;
  |ABRE #rew00051;
  |ABRE #rew00052;
  |ABRE #rew00053;
  |ABRE #rew00054;
  |ABRE #rew00026;

  VEmpresa = #99#0;
  VTipo    = #99#2;
  |HAZ CargaHojas;

  |SI #0#34 = "L"; |HAZ EscribeAscii; |FINSI;

  |SI #0#34 = "P"; |HAZ EmiteOficial; |FINSI;

  |CIERRA #rew00026;
  |CIERRA #rew00054;
  |CIERRA #rew00053;
  |CIERRA #rew00052;
  |CIERRA #rew00051;
  |CIERRA #rew00050;
  |CIERRA #rew00011;
  |CIERRA #rew00010;

  #rem01001#6 = "S"; |GRABA 020#rem01001.a;
|FPRC;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO CargaFecha;
||  eaCuenta = #0#58;
  DiaInf   = #0#33 % 102;
  MesNum   = #0#33 % 402;
  MesInf   = #0#33 % 402;
  EjerInf  = #0#33 % -104;

  |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
  |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
  |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
  |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
  |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
  |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
  |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
  |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
  |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
  |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
  |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
  |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

  MesInf = MesInf > MesInf;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
   #99#0 = #rem01001#0;
   #99#1 = "";
   #99#2 = #rem01001#2;
   Comodin = #99#2 % 0101;
   |SI #99#2 = "CONJUNTA     ";
      Comodin = "J";
   |FINSI;
   |SI #99#2 = "CONJUNTAE    ";
      Comodin = "N";
   |FINSI;
   #99#1 = Comodin;
   #99#3 = #rem01001#7;
   #99#4 = 1;
   #99#5 = "S";
   #99#6 = 1;
   #99#7 = "";
   |GRABA 000#99n;
   |SI FSalida = 0;
        SwEstar = 1;
   |FINSI;
|FPRC;

|DEFBUCLE DatosContrib;
  #rem01001#1;
  5,6;
  DEmpre,00,"          ","101",DReimp;
  HEmpre,99,"zzzzzzzzzz","101",HReimp;
  ;
  NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|PROCESO CargaTempo;
  |DELINDEX #99;

  SwEstar = 0;

  |ABRE #99;
  |SI #0#36 = "S";
     DReimp = "N"; HReimp = "S";
  |SINO;
     DReimp = "N"; HReimp = "N";
  |FINSI;
  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE DatosContrib;
  |SINO;
      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |SI #0XCampos ! 0;
                DEmpre = #0XCampos;
                HEmpre = #0XCampos;
                |BUCLE DatosContrib;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwEstar = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, 1, 4, 19, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |SI #0#34 = "P";  |O #0#55 = "S";
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      NombreImpre = Impresora;
      |SI #0#56 = "H";  |FINIMP;  |FINSI;
  |FINSI;

  Nombre = "si" + Usuario;
  |NOME_DAT #99 Nombre;

  |ABRE #rem01001;
  |HAZ CargaFecha;
  |HAZ CargaTempo;

  INEmpresas = NEmpresas1<-;
  |BUCLE rew00001;

  |HAZ Emision;

  |SI #0#34 = "P";  |O #0#55 = "S";
      |SI #0#56 = "C";   |FINIMP;  |FINSI;
  |FINSI;
  |CIERRA #rem01001;

|FPRC;


*****************************************************************************
*****************************************************************************
**            CARGA DE DATOS EN TEMPORALES PARA EMISIONES                  **
*****************************************************************************
*****************************************************************************

|PROCESO Hoja1;
   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 010#rem00100.=;
   |SI FSalida = 0;
      |SI #rem00100#57 = "X";
         Separada = 0;
      |SINO;
         Separada = 1;
      |FINSI;
      |DDEFECTO #rew00010;
      Comodin = (("00" + #rem00100#69) % -102);
      Comodin = Comodin + (("000" + #rem00100#70) % -103);
      #rew00010#1  = "101";
      #rew00010#2  = "01";
      #rew00010#3  = " ";
      #rew00010#4  = Comodin;

      Comodin = VTipo; |QBF Comodin;
      |SI Comodin = "CONJUNTAE";
         |SI #rem00100#91 = "C";
            #rew00010#5  = #rem00100#1;
            #rew00010#6  = #rem00100#2;
            #rew00010#7  = #rem00100#3;
            #rew00010#8  = #rem00100#4;
            #rew00010#9  = #rem00100#15;
            Comodin = "    " + #rem00100#16; |QBF Comodin;
            Comodin = Comodin % -104;
            #rew00010#10 = Comodin;
            Comodin = "   " + #rem00100#17; |QBF Comodin;
            Comodin = Comodin % -103;
            #rew00010#11 = Comodin;
            Comodin = "  " + #rem00100#18; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#12 = Comodin;
            Comodin = "  " + #rem00100#19; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#13 = Comodin;
            #rew00010#14 = #rem00100#22;

            enCodProv = #rem00100#20;
            enCodPobl = #rem00100#21;
            |HAZ LeePoblacion;
            #rew00010#15 = #703#2;

            #rew00010#16 = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
            #rew00010#19 = #rem00100#7;
            Comodin = ("00" + #rem00100#8) % -102;
            #rew00010#20 = Comodin;
            #rew00010#21 = #rem00100#12;
         |FINSI;
         |SI #rem00100#91 = "T";
            #rew00010#5  = #rem00100#35;
            #rew00010#6  = #rem00100#36;
            #rew00010#7  = #rem00100#37;
            #rew00010#8  = #rem00100#38;
            #rew00010#9  = #rem00100#45;
            Comodin = "    " + #rem00100#46; |QBF Comodin;
            Comodin = Comodin % -104;
            #rew00010#10 = Comodin;
            Comodin = "   " + #rem00100#47; |QBF Comodin;
            Comodin = Comodin % -103;
            #rew00010#11 = Comodin;
            Comodin = "  " + #rem00100#48; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#12 = Comodin;
            Comodin = "  " + #rem00100#49; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#13 = Comodin;
            #rew00010#14 = #rem00100#52;

            enCodProv = #rem00100#50;
            enCodPobl = #rem00100#51;
            |HAZ LeePoblacion;
            #rew00010#15 = #703#2;

            #rew00010#16 = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
            #rew00010#19 = #rem00100#40;
            Comodin = ("00" + #rem00100#41) % -102;
            #rew00010#20 = Comodin;
            #rew00010#21 = #rem00100#12;
         |FINSI;
      |FINSI;

      |SI Comodin = "TITULAR"; |O Comodin = "CONJUNTA";
         #rew00010#5  = #rem00100#1;
         #rew00010#6  = #rem00100#2;
         #rew00010#7  = #rem00100#3;
         #rew00010#8  = #rem00100#4;
         #rew00010#9  = #rem00100#15;
         Comodin = "    " + #rem00100#16; |QBF Comodin;
         Comodin = Comodin % -104;
         #rew00010#10 = Comodin;
         Comodin = "   " + #rem00100#17; |QBF Comodin;
         Comodin = Comodin % -103;
         #rew00010#11 = Comodin;
         Comodin = "  " + #rem00100#18; |QBF Comodin;
         Comodin = Comodin % -102;
         #rew00010#12 = Comodin;
         Comodin = "  " + #rem00100#19; |QBF Comodin;
         Comodin = Comodin % -102;
         #rew00010#13 = Comodin;
         #rew00010#14 = #rem00100#22;

         enCodProv = #rem00100#20;
         enCodPobl = #rem00100#21;
         |HAZ LeePoblacion;
         #rew00010#15 = #703#2;

         #rew00010#16 = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
         #rew00010#19 = #rem00100#7;
         Comodin = ("00" + #rem00100#8) % -102;
         #rew00010#20 = Comodin;
         #rew00010#21 = #rem00100#12;
      |FINSI;
      |SI Comodin = "CONYUGE";
         #rew00010#5  = #rem00100#35;
         #rew00010#6  = #rem00100#36;
         #rew00010#7  = #rem00100#37;
         #rew00010#8  = #rem00100#38;
         #rew00010#9  = #rem00100#45;
         Comodin = "    " + #rem00100#46; |QBF Comodin;
         Comodin = Comodin % -104;
         #rew00010#10 = Comodin;
         Comodin = "   " + #rem00100#47; |QBF Comodin;
         Comodin = Comodin % -103;
         #rew00010#11 = Comodin;
         Comodin = "  " + #rem00100#48; |QBF Comodin;
         Comodin = Comodin % -102;
         #rew00010#12 = Comodin;
         Comodin = "  " + #rem00100#49; |QBF Comodin;
         Comodin = Comodin % -102;
         #rew00010#13 = Comodin;
         #rew00010#14 = #rem00100#52;

         enCodProv = #rem00100#50;
         enCodPobl = #rem00100#51;
         |HAZ LeePoblacion;
         #rew00010#15 = #703#2;

         #rew00010#16 = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
         #rew00010#19 = #rem00100#40;
         Comodin = ("00" + #rem00100#41) % -102;
         #rew00010#20 = Comodin;
         #rew00010#21 = #rem00100#12;
      |FINSI;

      Comodin = Comodin - "FAMILIAR";
      |SI FSalida ! 0;
         |PARA Cont = 22; |SI Cont [ 32; |HACIENDO Cont = Cont + 1;
            #rew00010#Cont# = "";
         |SIGUE;
         #rew00010#33 = 0;
         #rew00010#34 = 0;
         #rew00010#35 = 0;
         |QBF Comodin;
         |ABRE #rem00101;
         #rem00101#0  = #rem00100#0;
         #rem00101#1  = Comodin;
         |LEE 010#rem00101.=;
         |SI FSalida = 0;
            #rew00010#5 = #rem00101#2;
            Comodin = #rem00101#3;
            Comodin1 = "";
            |PARA Cont = 1; |SI Cont [ 40; |HACIENDO Cont = Cont + 1;
               Calc = (Cont * 100) + 1;
               Caracter = Comodin % Calc;
               Comodin1 = Comodin1 + Caracter;
               |SI Caracter = " ";
                  Comodin = Comodin - Comodin1; |QBF Comodin;
                  |SAL;
               |FINSI;
            |SIGUE;
            #rew00010#6 = Comodin1;
            Comodin1 = "";
            |PARA Cont = 1; |SI Cont [ 40; |HACIENDO Cont = Cont + 1;
               Calc = (Cont * 100) + 1;
               Caracter = Comodin % Calc;
               Comodin1 = Comodin1 + Caracter;
               |SI Caracter = " "; |O Caracter = ",";
                  Comodin = Comodin - Comodin1; |QBF Comodin;
                  Comodin1 = Comodin1 - ",";
                  |SAL;
               |FINSI;
            |SIGUE;
            #rew00010#7 = Comodin1;
            Comodin = Comodin - ","; |QBT Comodin;
            #rew00010#8 = Comodin;
         |FINSI;
         #rew00010#9  = #rem00100#15;
         Comodin = "    " + #rem00100#16; |QBF Comodin;
         Comodin = Comodin % -104;
         #rew00010#10 = Comodin;
         Comodin = "   " + #rem00100#17; |QBF Comodin;
         Comodin = Comodin % -103;
         #rew00010#11 = Comodin;
         Comodin = "  " + #rem00100#18; |QBF Comodin;
         Comodin = Comodin % -102;
         #rew00010#12 = Comodin;
         Comodin = "  " + #rem00100#19; |QBF Comodin;
         Comodin = Comodin % -102;
         #rew00010#13 = Comodin;
         #rew00010#14 = #rem00100#22;

         enCodProv = #rem00100#20;
         enCodPobl = #rem00100#21;
         |HAZ LeePoblacion;
         #rew00010#15 = #703#2;

         #rew00010#16 = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
         #rew00010#19 = #rem00101#5;
         Comodin = ("00" + #rem00100#8) % -102;
         #rew00010#20 = Comodin;
         #rew00010#21 = #rem00100#12;
         |CIERRA #rem00101;
      |FINSI;

      Comodin = #rem00100#92;
      |QBF Comodin;
      |SI Comodin ! "";
         Comodin1 = Comodin % -104;
         |SI Comodin1 = "0000";
            Comodin = "        ";
         |SINO;
            Comodin = Comodin - ".";
            Comodin = Comodin - ".";
         |FINSI;
      |FINSI;

      #rew00010#17 = "        ";
      |SI #rem00100#91 ! " ";  || Hay un fallecimiento
         Comodin1 = VTipo; |QBF Comodin1;
         |SI Comodin1 = "TITULAR"; |Y #rem00100#91 = "T";
            #rew00010#17 = Comodin;
         |FINSI;
         |SI Comodin1 = "CONYUGE"; |Y #rem00100#91 = "C";
            #rew00010#17 = Comodin;
         |FINSI;
      |FINSI;

      Comodin = VTipo; |QBF Comodin;
      |SI Comodin ! "CONJUNTAE";
         |SI #rem00100#6 = "S"; #rew00010#18 = "1"; |FINSI;
         |SI #rem00100#6 = "C"; #rew00010#18 = "2"; |FINSI;
         |SI #rem00100#6 = "V"; #rew00010#18 = "3"; |FINSI;
         |SI #rem00100#6 = "L"; #rew00010#18 = "4"; |FINSI;
      |SINO;
         #rew00010#18 = "3";
      |FINSI;

      Comodin1 = Comodin - "FAMILIAR";
      |SI FSalida ! 0;
         #rew00010#18 = "1";
      |FINSI;

      ||SI Comodin = "TITULAR"; |O Comodin = "CONJUNTA";
      Comodin1 = Comodin - "FAMILIAR";
      |SI FSalida = 0;
         |SI Comodin ! "CONYUGE";
            #rew00010#22 = #rem00100#35;
            #rew00010#23 = #rem00100#36;
            #rew00010#24 = #rem00100#37;
            #rew00010#25 = #rem00100#38;
            #rew00010#26 = #rem00100#45;
            Comodin = "    " + #rem00100#46; |QBF Comodin;
            Comodin = Comodin % -104;
            #rew00010#27 = Comodin;
            Comodin = "   " + #rem00100#47; |QBF Comodin;
            Comodin = Comodin % -103;
            #rew00010#28 = Comodin;
            Comodin = "  " + #rem00100#48; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#29 = Comodin;
            Comodin = "  " + #rem00100#49; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#30 = Comodin;
            #rew00010#31 = #rem00100#52;

            enCodProv = #rem00100#50;
            enCodPobl = #rem00100#51;
            |HAZ LeePoblacion;
            #rew00010#32 = #703#2;

            #rew00010#33 = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
            #rew00010#34 = #rem00100#40;
            Comodin = "00" + #rem00100#41; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#35 = Comodin;
         |SINO;
            ||SI Comodin = "CONYUGE";
            #rew00010#22 = #rem00100#1;
            #rew00010#23 = #rem00100#2;
            #rew00010#24 = #rem00100#3;
            #rew00010#25 = #rem00100#4;
            #rew00010#26 = #rem00100#15;
            Comodin = "    " + #rem00100#16; |QBF Comodin;
            Comodin = Comodin % -104;
            #rew00010#27 = Comodin;
            Comodin = "   " + #rem00100#17; |QBF Comodin;
            Comodin = Comodin % -103;
            #rew00010#28 = Comodin;
            Comodin = "  " + #rem00100#18; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#29 = Comodin;
            Comodin = "  " + #rem00100#19; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#30 = Comodin;
            #rew00010#31 = #rem00100#22;

            enCodProv = #rem00100#20;
            enCodPobl = #rem00100#21;
            |HAZ LeePoblacion;
            #rew00010#32 = #703#2;

            #rew00010#33 = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
            #rew00010#34 = #rem00100#7;
            Comodin = "00" + #rem00100#8; |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#35 = Comodin;
         |FINSI;
      |FINSI;

      Comodin = VTipo; |QBF Comodin;
      |SI Comodin = "CONJUNTA"; |O Comodin = "CONJUNTAE";
         #rew00010#36 = "2";
      |SINO;
         #rew00010#36 = "1";
      |FINSI;

      |SI Comodin = "CONYUGE";
         |SI #rem00100#60 = "I";
            #rew00010#129 = "X";
         |FINSI;
         |SI #rem00100#60 = "O";
            #rew00010#130 = "X";
         |FINSI;
         |SI #rem00100#60 = "D";
            #rew00010#129 = "X";
            #rew00010#130 = "X";
         |FINSI;
      |SINO;
         |SI #rem00100#59 = "I";
            #rew00010#129 = "X";
         |FINSI;
         |SI #rem00100#59 = "O";
            #rew00010#130 = "X";
         |FINSI;
         |SI #rem00100#59 = "D";
            #rew00010#129 = "X";
            #rew00010#130 = "X";
         |FINSI;
      |FINSI;
      #rew00010#133 = #rew00010#14;
      |HAZ CargaFecha;
      #rew00010#134 = DiaInf;
      #rew00010#135 = MesInf;
      #rew00010#136 = EjerInf;
      Comodin = VTipo; |QBF Comodin;
      |SI Comodin = "CONJUNTAE";
         Comodin = "CONJUNTA";
      |FINSI;

      |SI #reemi101#58 = "S";
          Comodin = VEmpresa + " " + Comodin;
          #rew00010#137 = Comodin;
      |SINO;
          #rew00010#137 = "";
      |FINSI;

      Comodin = ("00" + #rem00100#11) % -102;
      #rew00010#121 = Comodin;
      #rew00010#122 = #rem00100#67;
      #rew00010#123 = #rem00100#66;
      #rew00010#124 = #rem00100#73;
      #rew00010#125 = #rem00100#74;
      #rew00010#126 = #rem00100#76;

      Comodin   = #rem00100#75 % 0102;  enCodProv = Comodin;
      Comodin   = #rem00100#75 % -103;  enCodPobl = Comodin;
      |HAZ LeePoblacion;

      #rew00010#127 = #703#2;
      #rew00010#128 = #rem00100#75;

      Cont = 37;
      |ABRE #rem00101;
      #rem00101#0 = VEmpresa;
      #rem00101#1 = 1;
      |LEE 010#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = VEmpresa; |HACIENDO;
         Comodin = VTipo; |QBF Comodin;
         |SI Comodin = "TITULAR"; |Y #rem00101#7 = "2"; |VETE Salta1; |FINSI;
         |SI Comodin = "CONYUGE"; |Y #rem00101#7 = "1"; |VETE Salta1; |FINSI;
         |SI Comodin = "CONJUNTAE"; #rem00101#7 = "1"; |FINSI;

         |SI Comodin = "1 FAMILIAR";                    |VETE Salta1; |FINSI;
         |SI Comodin = "2 FAMILIAR";                    |VETE Salta1; |FINSI;
         |SI Comodin = "3 FAMILIAR";                    |VETE Salta1; |FINSI;
         |SI Comodin = "4 FAMILIAR";                    |VETE Salta1; |FINSI;
         |SI #rem00101#4 = "DESCENDIENTE";
             nEdad = 1999 - #rem00101#5;
             |SI nEdad > 24; |Y #rem00101#6 < 33; |VETE Salta1; |FINSI;

            #rew00010#Cont# = #rem00101#2; Cont = Cont + 1
            #rew00010#Cont# = #rem00101#3; Cont = Cont + 1
            Comodin = "0000" + #rem00101#5; |QBF Comodin;
            Comodin = Comodin % -104;
            #rew00010#Cont# = Comodin;     Cont = Cont + 1
            Comodin = "00" + #rem00101#6;  |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#Cont# = Comodin;     Cont = Cont + 1
            #rew00010#Cont# = #rem00101#7; Cont = Cont + 1
            #rew00010#Cont# = #rem00101#8; Cont = Cont + 1
         |FINSI;
         |ET Salta1;
         |LEE 010#rem00101.s;
         |SI FSalida ! 0; |O #rem00101#0 ! VEmpresa;
            |SAL;
         |FINSI;
      |SIGUE;

      Cont = 97;
      #rem00101#0 = VEmpresa;
      #rem00101#1 = 1;
      |LEE 010#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = VEmpresa; |HACIENDO;
         Comodin = VTipo; |QBF Comodin;
         |SI Comodin = "TITULAR"; |Y #rem00101#7 = "2"; |VETE Salta2; |FINSI;
         |SI Comodin = "CONYUGE"; |Y #rem00101#7 = "1"; |VETE Salta2; |FINSI;
         |SI Comodin = "CONJUNTAE"; #rem00101#7 = "1"; |FINSI;
         |SI Comodin = "1 FAMILIAR";                    |VETE Salta2; |FINSI;
         |SI Comodin = "2 FAMILIAR";                    |VETE Salta2; |FINSI;
         |SI Comodin = "3 FAMILIAR";                    |VETE Salta2; |FINSI;
         |SI Comodin = "4 FAMILIAR";                    |VETE Salta2; |FINSI;
         |SI #rem00101#4 = "ASCENDIENTE "; |Y Cont [ 115;
            nEdad = 1999 - #rem00101#5;
            |SI nEdad < 65;  |Y #rem00101#6 < 33;  |VETE Salta2;  |FINSI;
            #rew00010#Cont# = #rem00101#2; Cont = Cont + 1
            #rew00010#Cont# = #rem00101#3; Cont = Cont + 1
            #rew00010#Cont# = #rem00101#5; Cont = Cont + 1
            Comodin = "00" + #rem00101#6;  |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#Cont# = Comodin; Cont = Cont + 1
            #rew00010#Cont# = #rem00101#7; Cont = Cont + 1
            Comodin = "  " + #rem00101#8;  |QBF Comodin;
            Comodin = Comodin % -102;
            #rew00010#Cont# = Comodin; Cont = Cont + 1
         |FINSI;
         |ET Salta2;
         |LEE 010#rem00101.s;
         |SI FSalida ! 0; |O #rem00101#0 ! VEmpresa;
            |SAL;
         |FINSI;
      |SIGUE;
      |CIERRA #rem00101;
   |FINSI;
|FPRC;

|PROCESO Hoja2;
   Linea = 0;
   LinComp = 0;
   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01010.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      |DDEFECTO #rew00011;
      #rew00011#0  = Linea;
      #rew00011#1  = "101";
      #rew00011#2  = "02";
      #rew00011#3  = " ";
      #rew00011#4  = #defdata@#3;
      #rew00011#5  = #defdata@#4;
      #rew00011#6  = #defdata@#5;
      #rew00011#7  = #defdata@#6;
      #rew00011#8  = #defdata@#7;
      #rew00011#9  = #defdata@#8;
      #rew00011#10 = #defdata@#9;
      #rew00011#11 = #defdata@#10;
      #rew00011#12 = #defdata@#11;
      #rew00011#13 = #defdata@#12;
      #rew00011#14 = #defdata@#13;
      #rew00011#15 = #defdata@#14;
      #rew00011#16 = #defdata@#15;
      #rew00011#17 = #defdata@#16;
      #rew00011#18 = #defdata@#17;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01011.mas";
   |CARGA_DEF Direc, defdata@;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00011#19  = #defdata@#3;
      #rew00011#20  = #defdata@#4;
      #rew00011#21  = #defdata@#5;
      #rew00011#22  = #defdata@#6;
      #rew00011#23  = #defdata@#7;
      #rew00011#24  = #defdata@#8;
      #rew00011#25 = #defdata@#9;
      #rew00011#26 = #defdata@#10;
      #rew00011#27 = #defdata@#11;
      #rew00011#28 = #defdata@#12;
      #rew00011#29 = #defdata@#13;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01012.mas";
   |CARGA_DEF Direc, defdata@;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00011#30 = #defdata@#3;
      #rew00011#31 = #defdata@#4;
      #rew00011#32 = #defdata@#5;
      #rew00011#33 = #defdata@#6;
      #rew00011#34 = #defdata@#7;
      #rew00011#35 = #defdata@#8;
      #rew00011#36 = #defdata@#9;
      #rew00011#37 = #defdata@#10;
      #rew00011#38 = #defdata@#11;
      #rew00011#39 = #defdata@#12;
      #rew00011#40 = #defdata@#13;
      #rew00011#41 = #defdata@#14;
      #rew00011#42 = #defdata@#15;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01013.mas";
   |CARGA_DEF Direc, defdata@;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00011#43 = #defdata@#3;
      #rew00011#44 = #defdata@#4;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |GRABA 020#rew00011.n;
|FPRC;

|PROCESO GrabaLin31;

   Comodin1 = #defdata@#5; |QBF Comodin1;
   |HAZ TipoPerc;

   |SI Tipo = 1;
      HayDatos = 1;
      |DDEFECTO #rew00050;
      #rew00050#0 = Linea;
      #rew00050#1 = "101";
      #rew00050#2 = "03";
      #rew00050#3 = " ";
      #rew00050#5 = "0";
      #rew00050#6  = #defdata@#4;
      #rew00050#7  = Perce;
      #rew00050#8  = #defdata@#6;
      #rew00050#9  = #defdata@#7;
      #rew00050#10 = #defdata@#8;
      #rew00050#11 = #defdata@#9;
      |SI Linea > 0;
         #rew00050#3 = "C";
         LinComp = LinComp + 1;
      |FINSI;
      |GRABA 020#rew00050.n;
      |LEE 010#rew00050.=;
      Linea = Linea + 1;
   |FINSI;
   |SI Tipo = 2;
      HayDatos = 1;
      #rew00050#12 = #defdata@#4;
      #rew00050#13 = Perce;
      #rew00050#14 = #defdata@#6;
      #rew00050#15 = #defdata@#7;
      #rew00050#16 = #defdata@#8;
      #rew00050#17 = #defdata@#9;
      |GRABA 020#rew00050.a;
   |FINSI;
   |SI Tipo = 3;
      HayDatos = 1;
      #rew00050#18 = #defdata@#4;
      #rew00050#19 = Perce;
      #rew00050#20 = #defdata@#6;
      #rew00050#21 = #defdata@#7;
      #rew00050#22 = #defdata@#8;
      #rew00050#23 = #defdata@#9;
      |GRABA 020#rew00050.a;
   |FINSI;
|FPRC;

|PROCESO Rellena31;
   Tipo = Tipo + 1;

   |SI Tipo = 4;
      Tipo = 1;
   |FINSI;
   |HAZ GrabaLin31;
|FPRC;

|DEFBUCLE Rellena31;
#defdata@#1004;
;
VEmpresa,00,VTipo,001;
VEmpresa,99,VTipo,999;
;
NULL,Rellena31;
|FIN;

|PROCESO Hoja3;
   Linea = 0;
   LinComp = 0;
   LinComp2 = 0;
   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01027.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   Tipo = 3;
   |BUCLE Rellena31;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01033.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   |LEE 010#rew00050.p;
   |SI FSalida ! 0;
      |DDEFECTO #rew00050;
      #rew00050#0 = 0;
      #rew00050#1 = "101";
      #rew00050#2 = "03";
      #rew00050#3 = " ";
      |GRABA 020#rew00050.n;
      |LEE 010#rew00050.p;
   |FINSI;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00050#24 = #defdata@#3;
      #rew00050#25 = #defdata@#4;
      #rew00050#26 = #defdata@#5;
      #rew00050#27 = #defdata@#6;
      #rew00050#28 = #defdata@#7;
      #rew00050#29 = #defdata@#8;
      #rew00050#30 = #defdata@#9;
      #rew00050#31 = #defdata@#10;
      #rew00050#32 = #defdata@#11;
      #rew00050#33 = #defdata@#23;
      #rew00050#34 = #defdata@#24;
      #rew00050#35 = #defdata@#25;
      #rew00050#36 = #defdata@#26;
      #rew00050#37 = #defdata@#27;
      #rew00050#38 = #defdata@#28;
      #rew00050#39 = #defdata@#29;
      #rew00050#40 = #defdata@#30;
      #rew00050#41 = #defdata@#31;
      #rew00050#42 = #defdata@#33;
      #rew00050#43 = #defdata@#34;
      #rew00050#44 = #defdata@#35;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01034.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00050#45 = #defdata@#3;
      #rew00050#46 = #defdata@#4;
      #rew00050#47 = #defdata@#7;
      #rew00050#48 = #defdata@#8;
      #rew00050#49 = #defdata@#11;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01035.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00050#50 = #defdata@#3;
      #rew00050#51 = #defdata@#4;
      #rew00050#52 = #defdata@#5;
      #rew00050#53 = #defdata@#6;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01026.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00050#4 = #defdata@#3;
   |FINSI;

   #rew00050#5  = LinComp;
   |GRABA 020#rew00050.a;

   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;
|FPRC;

|PROCESO GrabaLin41;
   Comodin1 = #defdata@#4; |QBF Comodin1;
   |HAZ TipoPerc;

   |SI Tipo = 1;
      HayDatos = 1;
      |SI #defdata@#5 ! 0; |O #defdata@#6 ! 0;
         #rew00051#11 = Perce;
         #rew00051#12 = #defdata@#5;
         #rew00051#13 = #defdata@#6;
      |FINSI;
      |SI #defdata@#8 ! 0; |O #defdata@#9 ! 0;
         #rew00051#19 = Perce;
         #rew00051#20 = #defdata@#7;
         #rew00051#21 = #defdata@#8;
         #rew00051#22 = #defdata@#9;
      |FINSI;
   |FINSI;
   |SI Tipo = 2;
      HayDatos = 1;
      |SI #defdata@#5 ! 0; |O #defdata@#6 ! 0;
         #rew00051#14 = Perce;
         #rew00051#15 = #defdata@#5;
         #rew00051#16 = #defdata@#6;
      |FINSI;
      |SI #defdata@#8 ! 0; |O #defdata@#9 ! 0;
         #rew00051#23 = Perce;
         #rew00051#24 = #defdata@#7;
         #rew00051#25 = #defdata@#8;
         #rew00051#26 = #defdata@#9;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO Rellena41;
   |LEE 010#rew00051.p;
   |SI FSalida ! 0;
      |DDEFECTO #rew00051;
      #rew00051#0 = Linea;
      #rew00051#1 = "101";
      #rew00051#2 = "04";
      #rew00051#3 = " ";
      |GRABA 020#rew00051.n;
      |LEE 010#rew00051.=;
      Linea = Linea + 1;
   |FINSI;

   |PARA; |SI FSalida = 0; |HACIENDO;
      |SI #rew00051#12 = 0; |Y #rew00051#13 = 0;
         |SI #defdata@#5 ! 0; |O #defdata@#6 ! 0;
            Tipo = 1;
            |HAZ GrabaLin41;
            |GRABA 020#rew00051.a;
            |SAL;
         |FINSI;
      |FINSI;
      |SI #rew00051#21 = 0; |Y #rew00051#22 = 0;
         |SI #defdata@#8 ! 0; |O #defdata@#9 ! 0;
            Tipo = 1;
            |HAZ GrabaLin41;
            |GRABA 020#rew00051.a;
            |SAL;
         |FINSI;
      |FINSI;
      |SI #rew00051#15 = 0; |Y #rew00051#16 = 0;
         |SI #defdata@#5 ! 0; |O #defdata@#6 ! 0;
            Tipo = 2;
            |HAZ GrabaLin41;
            |GRABA 020#rew00051.a;
            |SAL;
         |FINSI;
      |FINSI;
      |SI #rew00051#25 = 0; |Y #rew00051#26 = 0;
         |SI #defdata@#8 ! 0; |O #defdata@#9 ! 0;
            Tipo = 2;
            |HAZ GrabaLin41;
            |GRABA 020#rew00051.a;
            |SAL;
         |FINSI;
      |FINSI;
      |LEE 010#rew00051.s;
      |SI FSalida ! 0;
         |DDEFECTO #rew00051;
         #rew00051#0 = Linea;
         #rew00051#1 = "101";
         #rew00051#2 = "04";
         #rew00051#3 = "C";
         |GRABA 020#rew00051.n;
         |LEE 010#rew00051.=;
         Linea = Linea + 1;
         LinComp = LinComp + 1;
         FSalida = 0;
      |FINSI;
   |SIGUE;
|FPRC;

|DEFBUCLE Rellena41;
#defdata@#1004;
;
VEmpresa,00,VTipo,001;
VEmpresa,99,VTipo,999;
;
NULL,Rellena41;
|FIN;

|PROCESO Hoja4;
   Linea = 0;
   LinComp = 0;
   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01037.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   |BUCLE Rellena41;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |LEE 010#rew00051.p;
   |SI FSalida ! 0;
      |DDEFECTO #rew00051;
      #rew00051#0  = Linea;
      #rew00051#1 = "101";
      #rew00051#2 = "04";
      #rew00051#3 = " ";
      |GRABA 020#rew00051.n;
      |LEE 010#rew00051.p;
   |FINSI;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01038.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00051#17 = #defdata@#3;
      #rew00051#18 = #defdata@#4;
      #rew00051#27 = #defdata@#5;
      Comodin1 = #defdata@#6; |QBF Comodin1;
      |HAZ TipoPerc;
      #rew00051#28 = Perce;
      #rew00051#29 = #defdata@#7;
      #rew00051#30 = #defdata@#8;
      #rew00051#31 = #defdata@#9;
      Comodin1 = #defdata@#10; |QBF Comodin1;
      |HAZ TipoPerc;
      #rew00051#32 = Perce;
      #rew00051#33 = #defdata@#11;
      #rew00051#34 = #defdata@#12;
      #rew00051#35 = #defdata@#13;
      #rew00051#36 = #defdata@#14;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01036.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00051#4  = #defdata@#3;
      #rew00051#5  = #defdata@#4;
      #rew00051#6  = #defdata@#5;
      #rew00051#7  = #defdata@#6;
      #rew00051#8  = #defdata@#7;
      #rew00051#9  = #defdata@#8;
      #rew00051#10 = #defdata@#9;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01039.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00051#37 = #defdata@#3;
      #rew00051#38 = #defdata@#8;
      #rew00051#39 = #defdata@#4;
      #rew00051#40 = #defdata@#7;
      #rew00051#41 = #defdata@#9;
      #rew00051#42 = #defdata@#10;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01040.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00051#43 = #defdata@#3;
      #rew00051#44 = #defdata@#4;
      #rew00051#45 = #defdata@#5;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01041.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      HayDatos = 1;
      #rew00051#46 = #defdata@#3;
      #rew00051#47 = #defdata@#4;
      #rew00051#48 = #defdata@#5;
      #rew00051#49 = #defdata@#6;
      #rew00051#50 = #defdata@#7;
      #rew00051#51 = #defdata@#9;
      #rew00051#52 = #defdata@#10;
      #rew00051#53 = #defdata@#11;
      #rew00051#54 = #defdata@#12;
      #rew00051#55 = #defdata@#13;
      #rew00051#56 = #defdata@#14;
      #rew00051#57 = #defdata@#15;
      #rew00051#58 = #defdata@#16;
      #rew00051#59 = #defdata@#17;
      #rew00051#60 = #defdata@#18;
      #rew00051#61 = #defdata@#19;
      #rew00051#62 = #defdata@#20;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |GRABA 020#rew00051.a;

|FPRC;

|PROCESO Hoja5;

   |DDEFECTO #rew00052;
   #rew00052#0  = 0;
   #rew00052#1 = "101";
   #rew00052#2 = "05";
   #rew00052#3 = " ";
   |GRABA 020#rew00052.n;
   |LEE 010#rew00052.=;
   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01041.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      #rew00052#4  = #defdata@#21;
      #rew00052#5  = #defdata@#22;
      #rew00052#6  = #defdata@#23;
      #rew00052#7  = #defdata@#24;
      #rew00052#8  = #defdata@#25;
      #rew00052#9  = #defdata@#26;
      #rew00052#10 = #defdata@#27;
      #rew00052#11 = #defdata@#28;
      #rew00052#12 = #defdata@#29;
      #rew00052#13 = #defdata@#30;
      #rew00052#14 = #defdata@#31;
      #rew00052#15 = #defdata@#32;
      Comodin = ("0000000000" + #defdata@#33) % -110; |QBF Comodin;
      |SI Comodin = ""; |O Comodin = "0000000000";
         Comodin = "          ";
      |FINSI;
      #rew00052#16 = Comodin;
      Comodin1 = #defdata@#34; |QBF Comodin1;
      |HAZ TipoPerc;
      Comodin = #defdata@#16; |QBF Comodin1;
      |SI Comodin ! ""; #rew00052#17 = Perce; |FINSI;
      Comodin = #defdata@#35;
      |QBF Comodin;
      |SI Comodin ! "";
         Comodin1 = Comodin % -104;
         |SI Comodin1 = "0000";
            #rew00052#18 = "        ";
         |SINO;
            Comodin = Comodin - ".";
            Comodin = Comodin - ".";
            #rew00052#18 = Comodin;
         |FINSI;
      |FINSI;
      #rew00052#19 = #defdata@#36;
      #rew00052#20 = #defdata@#37;
      #rew00052#21 = #defdata@#38;
      Comodin = ("0000000000" + #defdata@#39) % -110; |QBF Comodin;
      |SI Comodin = ""; |O Comodin = "0000000000";
         Comodin = "          ";
      |FINSI;
      #rew00052#22 = Comodin;

      Comodin1 = #defdata@#40; |QBF Comodin1;
      |HAZ TipoPerc;
      Comodin = #defdata@#22; |QBF Comodin1;
      |SI Comodin ! ""; #rew00052#23 = Perce; |FINSI;
      Comodin = #defdata@#41;
      |SI Comodin ! "";
         Comodin1 = Comodin % -104;
         |SI Comodin1 = "0000";
            #rew00052#24 = "        ";
         |SINO;
            Comodin = Comodin - ".";
            Comodin = Comodin - ".";
            #rew00052#24 = Comodin;
         |FINSI;
      |FINSI;
      #rew00052#25 = #defdata@#42;
      #rew00052#26 = #defdata@#43;
      #rew00052#27 = #defdata@#44;
      #rew00052#28 = #defdata@#45;
      #rew00052#29 = #defdata@#46;
      #rew00052#30 = #defdata@#47;
      #rew00052#31 = #defdata@#48;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01043.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      Formato = 2;
      #rew00052#32 = #defdata@#38;
      #rew00052#33 = #defdata@#3;
      #rew00052#34 = #defdata@#39;
      #rew00052#35 = #defdata@#4;
      #rew00052#36 = #defdata@#5;
      #rew00052#37 = #defdata@#6;
      #rew00052#38 = #defdata@#7;
      #rew00052#39 = #defdata@#8;
      #rew00052#40 = #defdata@#9;
      #rew00052#41 = #defdata@#40;
      #rew00052#42 = #defdata@#10;
      #rew00052#43 = #defdata@#41;
      #rew00052#44 = #defdata@#11;
      #rew00052#45 = #defdata@#12;
      #rew00052#46 = #defdata@#13;
      #rew00052#47 = #defdata@#14;
      #rew00052#48 = #defdata@#15;
      #rew00052#49 = #defdata@#42;
      #rew00052#50 = #defdata@#16;
      #rew00052#51 = #defdata@#43;
      #rew00052#52 = #defdata@#17;
      #rew00052#53 = #defdata@#44;
      #rew00052#54 = #defdata@#18;
      #rew00052#55 = #defdata@#45;
      #rew00052#56 = #defdata@#19;
      #rew00052#57 = #defdata@#20;
      #rew00052#58 = #defdata@#21;
      #rew00052#59 = #defdata@#22;
      #rew00052#60 = #defdata@#23;
      #rew00052#61 = #defdata@#24;
      Formato = 10;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   |PARA Cont = 4; |SI Cont [ 61; |HACIENDO Cont = Cont + 1;
      |SI #rew00052#Cont# ! 0; HayDatos = 1; |FINSI;
      |SI Cont = 12; Cont = 24; |FINSI;
      |SI Cont = 31; Cont = 34; |FINSI;
      |SI Cont = 40; Cont = 43; |FINSI;
      |SI Cont = 48; Cont = 55; |FINSI;
   |SIGUE;
   |SI #rew00052#18 ! "        "; HayDatos = 1; |FINSI;
   |SI #rew00052#24 ! "        "; HayDatos = 1; |FINSI;

   |GRABA 020#rew00052.a;

|FPRC;

|PROCESO Hoja6;

   |DDEFECTO #rew00053;
   #rew00053#0  = Linea;
   #rew00053#1 = "101";
   #rew00053#2 = "06";
   #rew00053#3 = " ";
   |GRABA 020#rew00053.n;
   |LEE 010#rew00053.=;

   |DDEF Direc;
   |QBF Direc;
   Direc = Direc + "rem01043.mas";
   |CARGA_DEF Direc, defdata@;
   |DFICE Path;
   |PATH_DAT #650 Path;
   |ABRE #defdata@;
   #defdata@#0 = VEmpresa;
   #defdata@#1 = " ";
   #defdata@#2 = VTipo;
   |LEE 010#defdata@.=;
   |SI FSalida = 0;
      #rew00053#4  = #defdata@#25;
      #rew00053#5  = #defdata@#26;
      #rew00053#6  = #defdata@#27;
      #rew00053#7  = #defdata@#28;
      #rew00053#8  = #defdata@#46;
      #rew00053#9  = #defdata@#29;
      #rew00053#10 = #defdata@#47;
      #rew00053#11 = #defdata@#30;
      #rew00053#12 = #defdata@#31;
      #rew00053#13 = #defdata@#32;
      #rew00053#14 = #defdata@#33;
      #rew00053#15 = #defdata@#34;
      #rew00053#16 = #defdata@#35;
      #rew00053#17 = #defdata@#36;
      #rew00053#18 = #defdata@#37;
   |FINSI;
   |CIERRA #defdata@;
   |DESCARGA_DEF #defdata@;

   Bloque = 1;
   Casilla = " 01"; |HAZ BuscaCasilla; #rew00053#19 = Casilla;
   Casilla = " 02"; |HAZ BuscaCasilla; #rew00053#20 = Casilla;
   Casilla = " 03"; |HAZ BuscaCasilla; #rew00053#21 = Casilla;
   Casilla = " 04"; |HAZ BuscaCasilla; #rew00053#22 = Casilla;
   Casilla = " 05"; |HAZ BuscaCasilla; #rew00053#23 = Casilla;
   Casilla = " 06"; |HAZ BuscaCasilla; #rew00053#24 = Casilla;
   Casilla = " 07"; |HAZ BuscaCasilla; #rew00053#25 = Casilla;

   Bloque = 2;
   Casilla = " 08"; |HAZ BuscaCasilla; #rew00053#26 = Casilla;
   Casilla = " 09"; |HAZ BuscaCasilla; #rew00053#27 = Casilla;
   Casilla = " 10"; |HAZ BuscaCasilla; #rew00053#28 = Casilla;
   Casilla = " 11"; |HAZ BuscaCasilla; #rew00053#29 = Casilla;

   Bloque = 3;
   Casilla = " 12"; |HAZ BuscaCasilla; #rew00053#30 = Casilla;
   Casilla = " 13"; |HAZ BuscaCasilla; #rew00053#31 = Casilla;
   Casilla = " 14"; |HAZ BuscaCasilla; #rew00053#32 = Casilla;
   Casilla = " 15"; |HAZ BuscaCasilla; #rew00053#33 = Casilla;
   Casilla = " 16"; |HAZ BuscaCasilla; #rew00053#34 = Casilla;

   Bloque = 5; Casilla = " 23"; |HAZ BuscaCasilla; #rew00053#35 = Casilla;

   Bloque = 6;  Casilla = " 28"; |HAZ BuscaCasilla; #rew00053#36 = Casilla;
   Bloque = 7;  Casilla = " 29"; |HAZ BuscaCasilla; #rew00053#37 = Casilla;
   Bloque = 8;  Casilla = " 31"; |HAZ BuscaCasilla; #rew00053#38 = Casilla;
   Bloque = 9;  Casilla = " 32"; |HAZ BuscaCasilla; #rew00053#39 = Casilla;
   Bloque = 10; Casilla = " 33"; |HAZ BuscaCasilla; #rew00053#40 = Casilla;

   Bloque = 11;
   Casilla = " 34"; |HAZ BuscaCasilla; #rew00053#41 = Casilla;
   Casilla = " 35"; |HAZ BuscaCasilla; #rew00053#42 = Casilla;
   Casilla = " 36"; |HAZ BuscaCasilla; #rew00053#43 = Casilla;

   Bloque = 13; Casilla = " 38"; |HAZ BuscaCasilla; #rew00053#44 = Casilla;

   |GRABA 020#rew00053.a;

|FPRC;

|PROCESO Hoja7;
   |DDEFECTO #rew00054;
   #rew00054#0  = 0;
   #rew00054#1 = "101";
   #rew00054#2 = "07";
   #rew00054#3 = " ";
   |GRABA 020#rew00054.n;
   |LEE 010#rew00054.p;

   Bloque = 15; Casilla = " 39"; |HAZ BuscaCasilla; #rew00054#4 = Casilla;
   Bloque = 16; Casilla = " 42"; |HAZ BuscaCasilla; #rew00054#5 = Casilla;
   Bloque = 17; Casilla = " 43"; |HAZ BuscaCasilla; #rew00054#6 = Casilla;

   Bloque = 20;
   Casilla = " 38"; |HAZ BuscaCasilla; #rew00054#7 = Casilla;
   Casilla = " 51"; |HAZ BuscaCasilla; #rew00054#8 = Casilla;

   Bloque = 21;
   Casilla = " 38"; |HAZ BuscaCasilla; #rew00054#9  = Casilla;
   Casilla = " 52"; |HAZ BuscaCasilla; #rew00054#10 = Casilla;

   Bloque = 22; Casilla = "TME"; |HAZ BuscaCasilla;
      Valor = Casilla; NDigEnt = 2; NDigDec = 2; |HAZ SacaDecs; #rew00054#11 = ValorEnt; #rew00054#12 = ValorDec;
   Bloque = 22; Casilla = "TMA"; |HAZ BuscaCasilla;
      Valor = Casilla; NDigEnt = 2; NDigDec = 2; |HAZ SacaDecs; #rew00054#13 = ValorEnt; #rew00054#14 = ValorDec;
   Bloque = 29;
   Casilla = " 53";  |HAZ BuscaCasilla; #rew00054#15 = Casilla;
   Casilla = " 54";  |HAZ BuscaCasilla; #rew00054#16 = Casilla;
   Casilla = " 55";  |HAZ BuscaCasilla; #rew00054#17 = Casilla;

   Bloque = 30;
   Casilla = " 56";  |HAZ BuscaCasilla; #rew00054#18 = Casilla;
   Casilla = " 57";  |HAZ BuscaCasilla; #rew00054#19 = Casilla;
   Casilla = " 58";  |HAZ BuscaCasilla; #rew00054#20 = Casilla;

   Bloque = 31;
   Casilla = " 59";  |HAZ BuscaCasilla; #rew00054#21 = Casilla;
   Casilla = " 60";  |HAZ BuscaCasilla; #rew00054#22 = Casilla;
   Casilla = " 61";  |HAZ BuscaCasilla; #rew00054#23 = Casilla;
   Casilla = " 62";  |HAZ BuscaCasilla; #rew00054#24 = Casilla;
   Casilla = " 63";  |HAZ BuscaCasilla; #rew00054#25 = Casilla;
   Casilla = " 64";  |HAZ BuscaCasilla; #rew00054#26 = Casilla;
   Casilla = " 65";  |HAZ BuscaCasilla; #rew00054#27 = Casilla;
   Casilla = " 66";  |HAZ BuscaCasilla; #rew00054#28 = Casilla;

   Bloque = 31;
   Casilla = " 73"; |HAZ BuscaCasilla; #rew00054#29 = Casilla;
   Casilla = " 74"; |HAZ BuscaCasilla; #rew00054#30 = Casilla;

   Bloque = 32;
   Casilla = " 75";  |HAZ BuscaCasilla; #rew00054#31 = Casilla;
   Casilla = " 76";  |HAZ BuscaCasilla; #rew00054#32 = Casilla;

   Bloque = 33;
   Casilla = " 77";  |HAZ BuscaCasilla; #rew00054#33 = Casilla;
   Casilla = " 78";  |HAZ BuscaCasilla; #rew00054#34 = Casilla;
   Casilla = " 79";  |HAZ BuscaCasilla; #rew00054#35 = Casilla;

   Bloque = 37;
   Casilla = " 89";  |HAZ BuscaCasilla; #rew00054#36 = Casilla;
   Casilla = " 90";  |HAZ BuscaCasilla; #rew00054#37 = Casilla;
   Casilla = " 93";  |HAZ BuscaCasilla; #rew00054#38 = Casilla;
   Casilla = " 94";  |HAZ BuscaCasilla; #rew00054#39 = Casilla;
   Casilla = " 95";  |HAZ BuscaCasilla; #rew00054#40 = Casilla;

   Bloque = 38;
   Casilla = " 96";  |HAZ BuscaCasilla; #rew00054#41 = Casilla;
   Casilla = " 97";  |HAZ BuscaCasilla; #rew00054#42 = Casilla;
   Casilla = " 98";  |HAZ BuscaCasilla; #rew00054#43 = Casilla;
   Casilla = "101";  |HAZ BuscaCasilla; #rew00054#44 = Casilla;
   Casilla = "106";  |HAZ BuscaCasilla; #rew00054#45 = Casilla;
   Casilla = "107";  |HAZ BuscaCasilla; #rew00054#46 = Casilla;

   |GRABA 020#rew00054.a;

|FPRC;

|PROCESO Hoja8;

   |DDEFECTO #rew00026;
   #rew00026#0 = 0;
   |GRABA 020#rew00026.n;
   |LEE 010#rew00026.=;
   #rew00026#1 = "101";
   #rew00026#2 = "08";
   #rew00026#3 = " ";

   Bloque = 38; Casilla = "107"; |HAZ BuscaCasilla; #rew00026#14 = Casilla;
   Bloque = 39; Casilla = "110"; |HAZ BuscaCasilla; #rew00026#15 = Casilla;

   #rem01001#0 = VEmpresa;
   #rem01001#1 = 00;
   #rem01001#2 = VTipo;
   |LEE 010#rem01001.=;
   |SI FSalida = 0;
      |SI #rew00026#14 ] 0;
         |SI #rem01001#8 = "S";
            |SI #rew00026#15 = 0;
               #rew00026#16 = " ";
               #rew00026#17 = "X";
            |SINO;
               #rew00026#16 = "X";
               #rew00026#17 = " ";
            |FINSI;
         |SINO;
            #rew00026#16 = "X";
            #rew00026#17 = " ";
         |FINSI;

         |SI #rem01001#9 = "S";
            #rew00026#19 = "X";
            #rew00026#20 = " ";
         |SINO;
            #rew00026#19 = " ";
            #rew00026#20 = "X";
         |FINSI;

         |SI #rew00026#17 = "X";
            |SI #rem01001#10 = "S";
               #rew00026#25 = " ";
               #rew00026#26 = "X";
            |SINO;
               #rew00026#25 = "X";
               #rew00026#26 = " ";
            |FINSI;
         |FINSI;
      |SINO;
         #rew00026#32 = #rem01001#11;
         #rew00026#33 = #rem01001#12;
      |FINSI;
   |FINSI;

   |SI #rew00026#17 = "X";
      |SI #rew00026#14 ] 0;
         ComodNum = #rew00026#14 % 40;
         #rew00026#27 = ComodNum;
         ComodNum = #rew00026#14 % 60;
         #rew00026#18 = ComodNum;
      |FINSI;
   |SINO;
      |SI #rew00026#14 ] 0;
         #rew00026#18 = #rew00026#14;
      |SINO;
         #rew00026#16 = "";
         #rew00026#17 = "";
         #rew00026#19 = "";
         #rew00026#20 = "";
         #rew00026#34 = -#rew00026#14;
      |FINSI;
   |FINSI;

   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 010#rem00100.=;
   |SI FSalida = 0;
      Comodin = VTipo; |QBF Comodin;
      |SI Comodin = "CONYUGE";
         #rew00026#4  = #rem00100#44;
         #rew00026#5  = #rem00100#45;
         #rew00026#6  = #rem00100#46;
         #rew00026#7  = #rem00100#47;
         #rew00026#8  = #rem00100#48;
         #rew00026#9  = #rem00100#49;
         #rew00026#10 = #rem00100#12;
         #rew00026#13 = #rem00100#50 + #rem00100#51;

         |SI #rew00026#14 ] 0;
            |SI #rew00026#20 = "X";
               Comodin = #rem00100#54 % 0104;
               #rew00026#21 = Comodin;
               Comodin = #rem00100#54 % 0504;
               #rew00026#22 = Comodin;
               Comodin = #rem00100#54 % 0902;
               #rew00026#23 = Comodin;
               Comodin = #rem00100#54 % 1110;
               #rew00026#24 = Comodin;
            |FINSI;
         |SINO;
            |SI #rew00026#33 = "X";
               Comodin = #rem00100#54 % 0104;
               #rew00026#35 = Comodin;
               Comodin = #rem00100#54 % 0504;
               #rew00026#36 = Comodin;
               Comodin = #rem00100#54 % 0902;
               #rew00026#37 = Comodin;
               Comodin = #rem00100#54 % 1110;
               #rew00026#38 = Comodin;
            |FINSI;
         |FINSI;

         enCodProv = #rem00100#50;
         enCodPobl = #rem00100#51;
         |HAZ LeePoblacion;
         #rew00026#11 = #703#3;
         #rew00026#12 = #703#2;
      |SINO;
         #rew00026#4  = #rem00100#14;
         #rew00026#5  = #rem00100#15;
         #rew00026#6  = #rem00100#16;
         #rew00026#7  = #rem00100#17;
         #rew00026#8  = #rem00100#18;
         #rew00026#9  = #rem00100#19;
         #rew00026#10 = #rem00100#12;
         #rew00026#13 = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);

         |SI #rew00026#14 ] 0;
            |SI #rew00026#20 = "X";
               Comodin = #rem00100#53 % 0104;
               #rew00026#21 = Comodin;
               Comodin = #rem00100#53 % 0504;
               #rew00026#22 = Comodin;
               Comodin = #rem00100#53 % 0902;
               #rew00026#23 = Comodin;
               Comodin = #rem00100#53 % 1110;
               #rew00026#24 = Comodin;
            |FINSI;
         |SINO;
            |SI #rew00026#33 = "X";
               Comodin = #rem00100#53 % 0104;
               #rew00026#35 = Comodin;
               Comodin = #rem00100#53 % 0504;
               #rew00026#36 = Comodin;
               Comodin = #rem00100#53 % 0902;
               #rew00026#37 = Comodin;
               Comodin = #rem00100#53 % 1110;
               #rew00026#38 = Comodin;
            |FINSI;
         |FINSI;

         enCodProv = #rem00100#20;
         enCodPobl = #rem00100#21;
         |HAZ LeePoblacion;
         #rew00026#11 = #703#3;
         #rew00026#12 = #703#2;
      |FINSI;
   |FINSI;
   |CIERRA #rem00100;

   |SI #rew00026#26 = "X";
      #rew00026#28 = #rew00026#21;
      #rew00026#29 = #rew00026#22;
      #rew00026#30 = #rew00026#23;
      #rew00026#31 = #rew00026#24;
   |FINSI;

   |GRABA 020#rew00026.a;

|FPRC;

|PROCESO BuscaCasilla;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
      Casilla = #rem01002#6;
      SwError = 0;
   |SINO;
      Casilla = 0;
      SwError = 1;
   |FINSI;
|FPRC;

|PROCESO EmiteOficial;
   || *************** PAGINA 1
   |LEE 010#rew00010.p;

   Comodin = #rew00010#4 % 0102; enCodProv = Comodin;
   Comodin = #rew00010#4 % 0303; enCodPobl = Comodin;
   |HAZ LeeHacienda;
   #rew00010#138 = #706#2;
   #rew00010#139 = #706#3;

   #rew00010#140 = VEmpresa;
   Comodin = VTipo; |QBF Comodin;
   |SI Comodin = "TITULAR"; |O Comodin = "CONJUNTA";
      Comodin = #rew00010#6; |QBF Comodin;
      Comodin = Comodin + " " + #rew00010#7; |QBF Comodin;
      Comodin = Comodin + ", " + #rew00010#8; |QBF Comodin;
      #rew00010#141 = Comodin;
      Comodin = #rew00010#23; |QBF Comodin;
      Comodin = Comodin + " " + #rew00010#24; |QBF Comodin;
      Comodin = Comodin + ", " + #rew00010#25; |QBF Comodin;
      #rew00010#142 = Comodin;
      NombreTit = #rew00010#141; NombreCon = #rew00010#142;
   |FINSI;
   |SI Comodin = "CONYUGE";
      Comodin = #rew00010#23; |QBF Comodin;
      Comodin = Comodin + " " + #rew00010#24; |QBF Comodin;
      Comodin = Comodin + ", " + #rew00010#25; |QBF Comodin;
      #rew00010#141 = Comodin;
      Comodin = #rew00010#6; |QBF Comodin;
      Comodin = Comodin + " " + #rew00010#7; |QBF Comodin;
      Comodin = Comodin + ", " + #rew00010#8; |QBF Comodin;
      #rew00010#142 = Comodin;
      NombreTit = #rew00010#142; NombreCon = #rew00010#141;
   |FINSI;
   NifTit = #rew00010#5;  |QBF NifTit;
   NifCon = #rew00010#22; |QBF NifCon;
   |SI #reemi101#54 = "S";
      |INFOR "m101mh01"; |PRINT; |PIEINF; |FININF;

      || *************** PAGINA 2
      |LEE 010#rew00011.p;
      #rew00011#46 = NifTit; #rew00011#47 = NombreTit;
      |INFOR "m101mh02"; |PRINT; |PIEINF; |FININF;

      || *************** PAGINA 3
      |LEE 010#rew00050.p;
      #rew00050#54 = NifTit; #rew00050#55 = NombreTit;
      NHoja = 3;
      Tipo01 = ""; Tipo02 = ""; Tipo03 = "";
      NCampo = 7;  Comodin = ""; |HAZ MiraTipo; Tipo01 = Comodin;
      NCampo = 13; Comodin = ""; |HAZ MiraTipo; Tipo02 = Comodin;
      NCampo = 19; Comodin = ""; |HAZ MiraTipo; Tipo03 = Comodin;
      |INFOR "m101mh03"; |PRINT; |PIEINF; |FININF;

      || *************** PAGINA 4
      |LEE 010#rew00051.p;
      #rew00051#63 = NifTit; #rew00051#64 = NombreTit;
      NHoja = 4;
      Tipo01 = ""; Tipo02 = ""; Tipo03 = ""; Tipo04 = ""; Tipo05 = ""; Tipo06 = "";
      NCampo = 11; Comodin = ""; |HAZ MiraTipo; Tipo01 = Comodin;
      NCampo = 14; Comodin = ""; |HAZ MiraTipo; Tipo02 = Comodin;
      NCampo = 19; Comodin = ""; |HAZ MiraTipo; Tipo03 = Comodin;
      NCampo = 23; Comodin = ""; |HAZ MiraTipo; Tipo04 = Comodin;
      NCampo = 28; Comodin = ""; |HAZ MiraTipo; Tipo05 = Comodin;
      NCampo = 32; Comodin = ""; |HAZ MiraTipo; Tipo06 = Comodin;
      |INFOR "m101mh04"; |PRINT; |PIEINF; |FININF;

      || *************** PAGINA 5
      |LEE 010#rew00052.p;
      #rew00052#62 = NifTit; #rew00052#63 = NombreTit;
      NHoja = 5;
      Tipo01 = ""; Tipo02 = "";
      NCampo = 17;  Comodin = ""; |HAZ MiraTipo; Tipo01 = Comodin;
      NCampo = 23;  Comodin = ""; |HAZ MiraTipo; Tipo02 = Comodin;
      |INFOR "m101mh05"; |PRINT; |PIEINF; |FININF;

      || *************** PAGINA 6
      |LEE 010#rew00053.p;
      #rew00053#45 = NifTit; #rew00053#46 = NombreTit;
      |INFOR "m101mh06"; |PRINT; |PIEINF; |FININF;

      || *************** PAGINA 7
      |LEE 010#rew00054.p;
      #rew00054#47 = NifTit; #rew00054#48 = NombreTit;
      |INFOR "m101mh07"; |PRINT; |PIEINF; |FININF;
   |FINSI;

   || *************** PAGINA 8
   #rew00026#40 = #rew00010#138; #rew00026#41 = #rew00010#139;
   #rew00026#42 = #rew00010#4;
   #rew00026#43 = NifTit;        #rew00026#44 = NombreTit;
   #rew00026#45 = VEmpresa;
   #rew00026#46 = NifCon;        #rew00026#47 = NombreCon;
   |SI #reemi101#54 = "S";
      |INFOR "m101mh08"; |PRINT; |PIEINF; |FININF;
   |FINSI;

   |SI #reemi101#55 = "S";
      |SI #rem01001#8 = "S";
         |INFOR "m102mh01"; |PRINT; |PIEINF; |FININF;
      |SINO;
         |INFOR "m102mh02"; |PRINT; |PIEINF; |FININF;
      |FINSI;
   |FINSI;

|FPRC;

|PROCESO EscribeAscii;
   Nombre = ("00000" + VEmpresa) % -105;
   Nombre = "si" + Nombre;
   |QBF Nombre;
   Comodin = VTipo; |QBF Comodin;
   |SI Comodin = "CONJUNTA"; Comodin = "A"; |FINSI;
   Nombre = Nombre + (Comodin % 0101);
   |QBF Nombre;

   NEmpresas  = Nombre;
   INEmpresas = INEmpresas + 1;

   |DBASE Comodin; |QBF Comodin;
   Comodin = Comodin + "hacienda/";
   Comodin = "wb  " + Comodin + Nombre;
   |FABRE Comodin;
   Handle = FSalida;
   |SI FSalida < 0; |MENSA "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;

   |HAZ PasaPaginas;

   FSalida = Handle;
   |FCIERRA FSalida;
|FPRC;

|PROCESO PasaPaginas;

|| ***************** PASA LA PAGINA 1
   Formato = 4;
   |PARA Cont = 0; |SI Cont [ 12; |HACIENDO Cont = Cont + 1;
      Comodin = "";
      |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
         Calc = (Cont * 10) + Cont1;
         Comodin1 = #rew00010#Calc#; |HAZ Filtro;
         |SI Calc = 21;  Formato = 9; |HAZ FormatoNum; Formato = 4; |FINSI;
         |SI Calc = 33;  Formato = 5; |HAZ FormatoNum; Formato = 4; |FINSI;
         |SI Calc = 34;               |HAZ FormatoNum; |FINSI;
         |SI Calc = 35;  Formato = 2; |HAZ FormatoNum; Formato = 4; |FINSI;
         |SI Calc = 39;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 45;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 51;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 57;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 63;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 69;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 75;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 81;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 87;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 93;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 99;  |HAZ FormatoNum; |FINSI;
         |SI Calc = 105; |HAZ FormatoNum; |FINSI;
         |SI Calc = 111; |HAZ FormatoNum; |FINSI;
         |SI Calc = 117; |HAZ FormatoNum; |FINSI;
         |SI Calc = 128; Formato = 5; |HAZ FormatoNum; Formato = 10; |FINSI;
         Comodin = Comodin + Comodin1;
      |SIGUE;
      Comodin = Handle + " " + Comodin;
      |FGRABA Comodin;
   |SIGUE;
   Comodin = "";
   |PARA Cont1 = 133; |SI Cont1 [ 137; |HACIENDO Cont1 = Cont1 + 1;
      Comodin1 = #rew00010#Cont1#; |HAZ Filtro;
      Comodin = Comodin + Comodin1;
   |SIGUE;
   Comodin = Comodin + &013 + &010;
   Comodin = Handle + " " + Comodin;
   |FGRABA Comodin;

|| ***************** PASA LA PAGINA 2

   |SI H02 = 1;
      Formato = 10;
      |PARA Cont = 0; |SI Cont [ 3; |HACIENDO Cont = Cont + 1;
         Comodin = "";
         |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
            Calc = (Cont * 10) + Cont1;
            Comodin1 = #rew00011#Calc#; |HAZ Filtro;
            |SI Calc ] 4; |HAZ FormatoNum; |FINSI;
            Comodin = Comodin + Comodin1;
         |SIGUE;
         Comodin = Handle + " " + Comodin;
         |FGRABA Comodin;
      |SIGUE;
      Comodin1 = #rew00011#41; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin1;
      Comodin1 = #rew00011#42; |HAZ Filtro; |HAZ FormatoNum; Comodin  = Comodin + Comodin1;
      Comodin1 = #rew00011#43; |HAZ Filtro; |HAZ FormatoNum; Comodin  = Comodin + Comodin1;
      Comodin1 = #rew00011#44; |HAZ Filtro; |HAZ FormatoNum; Comodin  = Comodin + Comodin1;
      Comodin = Comodin + &013 + &010;
      Comodin  = Handle + " " + Comodin;
      |FGRABA Comodin;
   |FINSI;

|| ***************** PASA LA PAGINA 3

   |SI H03 = 1;
      Formato = 10;
      |LEE 010#rew00050.p;
      |PARA; |SI FSalida = 0; |HACIENDO;
         |PARA Cont = 0; |SI Cont [ 4; |HACIENDO Cont = Cont + 1;
            Comodin = "";
            |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
               Calc = (Cont * 10) + Cont1;
               Comodin1 = #rew00050#Calc#; |HAZ Filtro;
               |SI Calc = 4;                |HAZ FormatoNum; |FINSI;
               |SI Calc ] 8;  |Y Calc [ 11; |HAZ FormatoNum; |FINSI;
               |SI Calc ] 14; |Y Calc [ 17; |HAZ FormatoNum; |FINSI;
               |SI Calc ] 20; |Y Calc [ 50; |HAZ FormatoNum; |FINSI;
               Comodin = Comodin + Comodin1;
            |SIGUE;
            Comodin = Handle + " " + Comodin;
            |FGRABA Comodin;
         |SIGUE;
         Formato = 10;
         Comodin1 = #rew00050#51; |HAZ Filtro; |HAZ FormatoNum; Comodin  = Comodin1;
         Comodin1 = #rew00050#52; |HAZ Filtro; |HAZ FormatoNum; Comodin  = Comodin + Comodin1;
         Comodin1 = #rew00050#53; |HAZ Filtro; |HAZ FormatoNum; Comodin  = Comodin + Comodin1;
         Comodin = Comodin + &013 + &010;
         Comodin = Handle + " " + Comodin;
         |FGRABA Comodin;
         |LEE 010#rew00050.s;
         |SI FSalida ! 0;
            |SAL;
         |FINSI;
      |SIGUE;
   |FINSI;
|| ***************** PASA LA PAGINA 4

   |SI H04 = 1;
      Formato = 10;
      |LEE 010#rew00051.p;
      |PARA; |SI FSalida = 0; |HACIENDO;
         |PARA Cont = 0; |SI Cont [ 5; |HACIENDO Cont = Cont + 1;
            Comodin = "";
            |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
               Calc = (Cont * 10) + Cont1;
               Comodin1 = #rew00051#Calc#; |HAZ Filtro;
               |SI Calc ] 4;  |Y Calc [ 10;  |HAZ FormatoNum; |FINSI;
               |SI Calc ] 12; |Y Calc [ 13;  |HAZ FormatoNum; |FINSI;
               |SI Calc ] 15; |Y Calc [ 18;  |HAZ FormatoNum; |FINSI;
               |SI Calc ] 21; |Y Calc [ 22;  |HAZ FormatoNum; |FINSI;
               |SI Calc ] 25; |Y Calc [ 27;  |HAZ FormatoNum; |FINSI;
               |SI Calc = 31;                |HAZ FormatoNum; |FINSI;
               |SI Calc ] 35; |Y Calc [ 60;  |HAZ FormatoNum; |FINSI;
               Comodin = Comodin + Comodin1;
            |SIGUE;
            Comodin = Handle + " " + Comodin;
            |FGRABA Comodin;
         |SIGUE;
         Comodin1 = #rew00051#61; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin1;
         Comodin1 = #rew00051#62; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
         Comodin = Comodin + &013 + &010;
         Comodin  = Handle + " " + Comodin;
         |FGRABA Comodin;
         |LEE 010#rew00051.s;
         |SI FSalida ! 0;
            |SAL;
         |FINSI;
      |SIGUE;
   |FINSI;
|| ***************** PASA LA PAGINA 5

   |SI H05 = 1;
      Formato = 10;
      |LEE 010#rew00052.p;
      |PARA; |SI FSalida = 0; |HACIENDO;
         |PARA Cont = 0; |SI Cont [ 5; |HACIENDO Cont = Cont + 1;
            Comodin = "";
            |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
               Calc = (Cont * 10) + Cont1;
               Comodin1 = #rew00052#Calc#; |HAZ Filtro;
               |SI Calc ] 4;   |Y Calc [ 12;  |HAZ FormatoNum; |FINSI;
               ||SI Calc = 16;                 |HAZ FormatoNum; |FINSI;
               ||SI Calc = 22;                 |HAZ FormatoNum; |FINSI;
               |SI Calc ] 25;  |Y Calc [ 31;  |HAZ FormatoNum; |FINSI;
               |SI Calc = 32;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc = 33;                 |HAZ FormatoNum; |FINSI;
               |SI Calc = 34;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc ] 35;  |Y Calc [ 40;  |HAZ FormatoNum; |FINSI;
               |SI Calc = 41;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc = 42;                 |HAZ FormatoNum; |FINSI;
               |SI Calc = 43;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc ] 44;  |Y Calc [ 48;  |HAZ FormatoNum; |FINSI;
               |SI Calc = 49;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc = 50;                 |HAZ FormatoNum; |FINSI;
               |SI Calc = 51;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc = 52;                 |HAZ FormatoNum; |FINSI;
               |SI Calc = 53;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc = 54;                 |HAZ FormatoNum; |FINSI;
               |SI Calc = 55;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
               |SI Calc ] 56;  |Y Calc [ 60;  |HAZ FormatoNum; |FINSI;
               Comodin = Comodin + Comodin1;
            |SIGUE;
            Comodin = Handle + " " + Comodin;
            |FGRABA Comodin;
         |SIGUE;
         Comodin1 = #rew00052#61; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin1;
         Comodin = Comodin + &013 + &010;
         Comodin = Handle + " " + Comodin;
         |FGRABA Comodin;
         |LEE 010#rew00052.s;
         |SI FSalida ! 0;
            |SAL;
         |FINSI;
      |SIGUE;
   |FINSI;

|| ***************** PASA LA PAGINA 6
   Formato = 10;
   |LEE 010#rew00053.p;
   |PARA; |SI FSalida = 0; |HACIENDO;
      |PARA Cont = 0; |SI Cont [ 3; |HACIENDO Cont = Cont + 1;
         Comodin = "";
         |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
            Calc = (Cont * 10) + Cont1;
            Comodin1 = #rew00053#Calc#; |HAZ Filtro;
            |SI Calc ] 4;   |Y Calc [ 7;   |HAZ FormatoNum; |FINSI;
            |SI Calc = 8;   Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
            |SI Calc = 9;                  |HAZ FormatoNum; |FINSI;
            |SI Calc = 10;  Formato = 2;   |HAZ FormatoNum; Formato = 10; |FINSI;
            |SI Calc ] 11;  |Y Calc [ 40;  |HAZ FormatoNum; |FINSI;
            Comodin = Comodin + Comodin1;
         |SIGUE;
         Comodin = Handle + " " + Comodin;
         |FGRABA Comodin;
      |SIGUE;

      Comodin1 = #rew00053#41; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin1;
      Comodin1 = #rew00053#42; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin1 = #rew00053#43; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin1 = #rew00053#44; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin = Comodin + &013 + &010;
      Comodin = Handle + " " + Comodin;
      |FGRABA Comodin;
      |LEE 010#rew00053.s;
      |SI FSalida ! 0;
         |SAL;
      |FINSI;
   |SIGUE;

|| ***************** PASA LA PAGINA 7
   Formato = 10;
   |LEE 010#rew00054.p;
   |PARA; |SI FSalida = 0; |HACIENDO;
      |PARA Cont = 0; |SI Cont [ 3; |HACIENDO Cont = Cont + 1;
         Comodin = "";
         |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
            Calc = (Cont * 10) + Cont1;
            Comodin1 = #rew00054#Calc#; |HAZ Filtro;
            |SI Calc ] 4;  |Y Calc [ 10; |HAZ FormatoNum; |FINSI;
            |SI Calc ] 15; |Y Calc [ 40; |HAZ FormatoNum; |FINSI;
            Comodin = Comodin + Comodin1;
         |SIGUE;
         Comodin = Handle + " " + Comodin;
         |FGRABA Comodin;
      |SIGUE;
      Comodin1 = #rew00054#41; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin1;
      Comodin1 = #rew00054#42; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin1 = #rew00054#43; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin1 = #rew00054#44; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin1 = #rew00054#45; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin1 = #rew00054#46; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
      Comodin = Comodin + &013 + &010;
      Comodin = Handle + " " + Comodin;
      |FGRABA Comodin;
      |LEE 010#rew00054.s;
      |SI FSalida ! 0;
         |SAL;
      |FINSI;
   |SIGUE;
|| ***************** PASA LA PAGINA 8

   Formato = 10;
   |PARA Cont = 0; |SI Cont [ 2; |HACIENDO Cont = Cont + 1;
      Comodin = "";
      |PARA Cont1 = 1; |SI Cont1 [ 10; |HACIENDO Cont1 = Cont1 + 1;
         Calc = (Cont * 10) + Cont1;
         Comodin1 = #rew00026#Calc#; |HAZ Filtro;
         |SI Calc = 10; Formato = 9;  |HAZ FormatoNum; Formato = 10; |FINSI;
         |SI Calc = 13; Formato = 5;  |HAZ FormatoNum; Formato = 10; |FINSI;
         |SI Calc ] 14; |Y Calc [ 15; |HAZ FormatoNum; |FINSI;
         |SI Calc = 18;               |HAZ FormatoNum; |FINSI;
         |SI Calc = 24;
            |QBF Comodin1;
            |SI Comodin1 ! ""; |Y Comodin1 ! "0000000000";
               |HAZ FormatoNum;
            |SINO;
               Comodin1 = "          ";
            |FINSI;
         |FINSI;
         |SI Calc = 27;               |HAZ FormatoNum; |FINSI;
         Comodin = Comodin + Comodin1;
      |SIGUE;
      Comodin = Handle + " " + Comodin;
      |FGRABA Comodin;
   |SIGUE;
   Comodin1 = #rew00026#31; |HAZ Filtro;
   |QBF Comodin1;
   |SI Comodin1 ! ""; |Y Comodin1 ! "0000000000";
      |HAZ FormatoNum;
   |SINO;
      Comodin1 = "          ";
   |FINSI;
   Comodin = Comodin1;
   Comodin1 = #rew00026#32; |HAZ Filtro; Comodin = Comodin + Comodin1;
   Comodin1 = #rew00026#33; |HAZ Filtro; Comodin = Comodin + Comodin1;
   Comodin1 = #rew00026#34; |HAZ Filtro; |HAZ FormatoNum; Comodin = Comodin + Comodin1;
   Comodin1 = #rew00026#35; |HAZ Filtro; Comodin = Comodin + Comodin1;
   Comodin1 = #rew00026#36; |HAZ Filtro; Comodin = Comodin + Comodin1;
   Comodin1 = #rew00026#37; |HAZ Filtro; Comodin = Comodin + Comodin1;
   Comodin1 = #rew00026#38; |HAZ Filtro;
   |QBF Comodin1;
   |SI Comodin1 ! "";
      |HAZ FormatoNum;
   |SINO;
      Comodin1 = "          ";
   |FINSI;
   Comodin = Comodin + Comodin1;
   Comodin = Comodin + &013 + &010;
   Comodin = Handle + " " + Comodin;
   |FGRABA Comodin;

|FPRC;

|PROCESO Filtro;
   Sigue = 1;
   |PARA; |SI Sigue ! 0; |HACIENDO;
      Sigue = 0;
      Comodin1 = Comodin1 - "";
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &209 + aParte2;
         Sigue = 1;
      |FINSI;
      Comodin1 = Comodin1 - "";
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &209 + aParte2;
         Sigue = 1;
      |FINSI;
      Caracter = &128;
      Comodin1 = Comodin1 - Caracter;
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &199 + aParte2;
         Sigue = 1;
      |FINSI;
      Caracter = &134;
      Comodin1 = Comodin1 - Caracter;
      |SI FSalida ! 0;
         Calc = FSalida;
         nParte1 = 100 + (((Calc / 100) ! 0) - 1);
         aParte1 = Comodin1 % nParte1;
         nParte2 = Calc + 98;
         aParte2 = Comodin1 % nParte2;
         Comodin1 = aParte1 + &199 + aParte2;
         Sigue = 1;
      |FINSI;
   |SIGUE;
|FPRC;

|PROCESO FormatoNum;
   ComodNum1 = Comodin1;
   |SI ComodNum1 < 0;
      ComodNum1 = ComodNum1 * -1;
      Comodin1 = ComodNum1;
      Formato = Formato - 1;
      Comodin2 = "0" * Formato;
      Comodin1 = Comodin2 + Comodin1;
      |QBF Comodin1;
      Calc1 = - (100 + Formato);
      Comodin1 = Comodin1 % Calc1;
      Comodin1 = "N" + Comodin1;
      Formato = Formato + 1;
      |ACABA;
   |SINO;
      Comodin2 = "0" * Formato;
      Comodin1 = Comodin2 + Comodin1;
      |QBF Comodin1;
      Calc1 = - (100 + Formato);
      Comodin1 = Comodin1 % Calc1;
   |FINSI;
|FPRC;

|PROCESO Emision;
   |SI #0#34 = "L";
      eaTipoSec = "101";
      |HAZ CopiaDisco;
   |FINSI;
|FPRC;

|PROCESO TipoPerc;

   |SI Separada = 1;
      Perce = "2";
   |SINO;
      Perce = "0";
      |SI Comodin1 = "TITULAR";    Perce = "2"; |FINSI;
      |SI Comodin1 = "CONYUGE";    Perce = "3"; |FINSI;
      |SI Comodin1 = "COMUNES";    Perce = "1"; |FINSI;
      |SI Comodin1 = "CONJUNTA";   Perce = "1"; |FINSI;
      |SI Comodin1 = "1 FAMILIAR"; Perce = "4"; |FINSI;
      |SI Comodin1 = "2 FAMILIAR"; Perce = "5"; |FINSI;
      |SI Comodin1 = "3 FAMILIAR"; Perce = "6"; |FINSI;
      |SI Comodin1 = "4 FAMILIAR"; Perce = "7"; |FINSI;
      |SI Comodin1 = "VARIOS";    Perce = "2"; |FINSI;
   |FINSI;

|FPRC;

|PROCESO MiraTipo;
   |SI NHoja = 3;  TipoContr = #rew00050#NCampo#; |FINSI;
   |SI NHoja = 4;  TipoContr = #rew00051#NCampo#; |FINSI;
   |SI NHoja = 5;  TipoContr = #rew00052#NCampo#; |FINSI;

   |SI TipoContr = "2"; Comodin = "DECLARANTE"; |FINSI;
   |SI TipoContr = "3"; Comodin = "CONYUGE";    |FINSI;
   |SI TipoContr = "1"; Comodin = "COMUNES";    |FINSI;
   |SI TipoContr = "4"; Comodin = "1 FAMILIAR"; |FINSI;
   |SI TipoContr = "5"; Comodin = "2 FAMILIAR"; |FINSI;
   |SI TipoContr = "6"; Comodin = "3 FAMILIAR"; |FINSI;
   |SI TipoContr = "7"; Comodin = "4 FAMILIAR"; |FINSI;
   |QBF Comodin;
|FPRC;

|PROCESO Complem;
   |INFOR "m101ch03"; |PRINT; |PIEINF; |FININF;
|FPRC;

|PROCESO SacaDecs;
   Calc = 1;
   |PARA nCont = 1; |SI nCont [ NDigDec; |HACIENDO nCont = nCont + 1;
      Calc = Calc * 10;
   |SIGUE;
   Calc = Valor * Calc;
   Calc1 = NDigEnt + NDigDec;
   Comodin1 = "0" * Calc1;
   Calc1 = 0 - (Calc1 + 100);
   Comodin = (Comodin1 + Calc) % Calc1;
   Calc  = NDigEnt + 100;
   Calc1 = 0 - (NDigDec + 100);
   Comod = Comodin % Calc;  ValorEnt = Comod;
   Comod = Comodin % Calc1; ValorDec = Comod;
|FPRC;
