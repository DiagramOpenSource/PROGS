|FICHEROS;
     dsmoy000 #0;
     dsmom002 #2;
     dsmom004 #4;
     dsmom107 #107;
     dsmow600 #600;
     dsmow601 #601,MANTE;

     dsmod110 #110;
     dsmow014 #999;
     dsmow516 #516;
     dsmow520 #520;
     dsmow540 #540;
     dsmow560 #560;
     dsmow566 #566;
     dsmow567 #567;
     dsmow650 #650;
     dsmow652 #652;

     &regisnif@ #709;
     &clientes@ #715;
     &datosper@ #718;
|FIN;

|VARIABLES;
     &eaLit        = "";
     &enImporte    = 0;

     fDFecha       = @;
     fHFecha       = @;

     aTipo         = "";
     aAbrePortal   = "";
     aIPRemoto     = "";
     aBue          = "";

     nHandlePortal = 0;
     nValidacion   = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO dsmom004;
     aAlfa = #4#15;
     aAlfa = aAlfa - ".";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enImporte = #4#15 / 100;

     |PRINT;
|FPRC;

|DEFBUCLE dsmom004;
     #4#1;
     9;
     00000, 2010, 1, 110, 00, "X";
     99999, 2010, 1, 110, 00, "X";
     ;
     NULL, dsmom004;
|FIN;

|PROCESO Informe111;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "dsmoy111";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |BUCLE dsmom004;

     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Registro110_2001;
     |SI nTecla = 1;
         aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #516;
     |SI eaMoneda  = "PESETAS";
         #516#1    = "110";
     |SINO;
         #516#1    = "112";
     |FINSI;

     #516#2  = "01";
     #516#3  = "";

     enSwTrata      = 0;
     enCambiaMoneda = 1;

     |SI enSwDeDonde = 1;
         #516#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #516#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #516#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #516#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #516#6  = eaAlfa;
             #516#7  = ".";
         |FINSI;
         #516#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #516#9 = eaAlfa;
         #516#10 = #715#31 % 104;
         #516#11 = #715#32;
         #516#12 = #715#33;
         #516#13 = #715#34;
         #516#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #516#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #516#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #516#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #110#29 > 0;
             enNume = #110#29;  |HAZ Conver12;  #516#44 = eaAlfa;

             enModelo = 110;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #516#45  = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #516#46  = "X";  |FINSI;

             #516#47  = eaEntidad;
             #516#48  = eaOficina;
             #516#49  = eaDC;
             #516#50  = eaCuenta;
         |SINO;
             enNume  = 0;  |HAZ Conver12;  #516#44 = eaAlfa;
             #516#51 = "X";
         |FINSI;
     |SINO;
         #516#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #516#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #516#6  = eaAlfa;
         #516#7   = ".";
         #516#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #516#9 = eaAlfa;
         #516#10 = #715#5 % 104;
         #516#11 = #715#6;
         #516#12 = #715#7;
         #516#13 = #715#8;
         #516#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #516#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #516#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #516#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #110#29 > 0;
             enNume = #110#29;  |HAZ Conver12;  #516#44 = eaAlfa;

             |SI #715#84 = "                    ";
                 #516#45  = "X";
             |SINO;
                 #516#46  = "X";
                 #516#47 = #715#81;
                 #516#48 = #715#82;
                 #516#49 = #715#83;
                 #516#50 = #715#84 % 110;
             |FINSI;
         |SINO;
             enNume  = 0;  |HAZ Conver12;  #516#44 = eaAlfa;
             #516#51 = "X";
         |FINSI;
     |FINSI;

     #516#18  = #110#1;

     |SI #110#2 = 3;   #516#19 = 1;  |FINSI;
     |SI #110#2 = 6;   #516#19 = 2;  |FINSI;
     |SI #110#2 = 9;   #516#19 = 3;  |FINSI;
     |SI #110#2 = 12;  #516#19 = 4;  |FINSI;

     #516#20 = ("000000" + #110#6) % -106;
     enNume  = #110#7;  |HAZ Conver12;  #516#21 = eaAlfa;
     enNume  = #110#8;  |HAZ Conver12;  #516#22 = eaAlfa;

     #516#23 = ("000000" + #110#9) % -106;
     enNume  = #110#10;  |HAZ Conver12;  #516#24 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver12;  #516#25 = eaAlfa;

     #516#26 = ("000000" + #110#12) % -106;
     enNume  = #110#13;  |HAZ Conver12;  #516#27 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver12;  #516#28 = eaAlfa;

     #516#29 = ("000000" + #110#15) % -106;
     enNume  = #110#16;  |HAZ Conver12;  #516#30 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver12;  #516#31 = eaAlfa;

     #516#32 = ("000000" + #110#18) % -106;
     enNume  = #110#19;  |HAZ Conver12;  #516#33 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver12;  #516#34 = eaAlfa;

     #516#35 = ("000000" + #110#21) % -106;
     enNume  = #110#22;  |HAZ Conver12;  #516#36 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver12;  #516#37 = eaAlfa;

     #516#38 = ("000000" + #110#24) % -106;
     enNume  = #110#25;  |HAZ Conver12;  #516#39 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver12;  #516#40 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver12;  #516#41 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver12;  #516#42 = eaAlfa;
     enNume  = #110#29;  |HAZ Conver12;  #516#43 = eaAlfa;

     #516#53 = #110#30;
     |SI #516#53 ! "             ";
         #516#52 = "X";
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #516#54 = #516#15;
     #516#55 = eaDiaB;
     #516#56 = eaMesB;
     #516#57 = eaAnyoB;
     #516#58 = &13 + &10;

     |SI nTecla = 1;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #516nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
         eaFDestino = eaPathLanza + "110" + (("00000" + #999#0) % -105) + ".TXT";
         |HAZ CopiaFichero;

         |FBORRA eaFOrigen;

         aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "wait mipf " + "110" + (("00000" + #999#0) % -105) + ".TXT";

         |SI #600#0 = "N";  aAlfa = aAlfa + " s";  |FINSI;
         |SI #600#1 = "S";  aAlfa = aAlfa + " a";  |FINSI;
         aAlfa = aAlfa + " " + #600#2;
         aAlfa = aAlfa + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "move errores.txt err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
         aAlfa = aAlfa + &13 + &10;

         |XGRABA nHandle1, aAlfa;
     |FINSI;

     |SI nTecla = 4;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO Internet110_2001;
     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #520;
     |SI eaMoneda  = "PESETAS";
         #520#2    = "P";
     |SINO;
         #520#2    = "E";
     |FINSI;

     #520#1  = "110";

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;    #520#3  = eaVarDni;
         eaAlfa = #715#57;  |HAZ QuitaRaros;       #520#4  = eaAlfa;
         eaAlfa = #715#53;  |HAZ QuitaRaros;       #520#33 = eaAlfa;
         eaAlfa = #715#54;  |HAZ QuitaRarosTfno;   #520#34 = eaAlfa;
         eaAlfa = #715#1;   |HAZ QuitaRaros;       #520#35 = eaAlfa;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #520#3  = eaVarDni;
         eaAlfa   = #715#96;  |HAZ QuitaRaros;     #520#33 = eaAlfa;
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #520#34 = eaAlfa;
         eaAlfa   = #715#1;   |HAZ QuitaRaros;     #520#35 = eaAlfa;
     |FINSI;

     #520#5 = #110#1;

     |SI #110#2 = 3;   #520#6 = "1T";  |FINSI;
     |SI #110#2 = 6;   #520#6 = "2T";  |FINSI;
     |SI #110#2 = 9;   #520#6 = "3T";  |FINSI;
     |SI #110#2 = 12;  #520#6 = "4T";  |FINSI;

     enCambiaMoneda = 0;
     enNume  = #110#6;   |HAZ Conver17;  #520#7  = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#7;   |HAZ Conver17;  #520#8  = eaAlfa;
     enNume  = #110#8;   |HAZ Conver17;  #520#9  = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#9;   |HAZ Conver17;  #520#10 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#10;  |HAZ Conver17;  #520#11 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver17;  #520#12 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#12;  |HAZ Conver17;  #520#13 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#13;  |HAZ Conver17;  #520#14 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver17;  #520#15 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#15;  |HAZ Conver17;  #520#16 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#16;  |HAZ Conver17;  #520#17 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver17;  #520#18 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#18;  |HAZ Conver17;  #520#19 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#19;  |HAZ Conver17;  #520#20 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver17;  #520#21 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#21;  |HAZ Conver17;  #520#22 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#22;  |HAZ Conver17;  #520#23 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver17;  #520#24 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#24;  |HAZ Conver17;  #520#25 = eaAlfa;

     enCambiaMoneda = 1;
     enNume  = #110#25;  |HAZ Conver17;  #520#26 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver17;  #520#27 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver17;  #520#28 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver17;  #520#29 = eaAlfa;
     enNume  = #110#29;  |HAZ Conver17;  #520#30 = eaAlfa;

     #520#31 = #110#30;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 38;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #520nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |HAZ CopiaFichero;

     |FBORRA eaFOrigen;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO Internet111;
     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #560;
     |SI eaMoneda  = "PESETAS";
         #560#2    = "P";
     |SINO;
         #560#2    = "E";
     |FINSI;

     #560#1  = "111";

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;     #560#3  = eaVarDni;
         eaAlfa = #715#53;   |HAZ QuitaRaros;       #560#31 = eaAlfa;
         eaAlfa = #715#54;   |HAZ QuitaRarosTfno;   #560#32 = eaAlfa;
         eaAlfa = #715#1;    |HAZ QuitaRaros;       #560#33 = eaAlfa;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #560#3  = eaVarDni;
         eaAlfa   = #715#96;  |HAZ QuitaRaros;     #560#31 = eaAlfa;
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #560#32 = eaAlfa;
         eaAlfa   = #715#1;   |HAZ QuitaRaros;     #560#33 = eaAlfa;
     |FINSI;

     #560#4 = #110#1 % -102;
     #560#5 = ("00" + #110#2) % -102;

     enCambiaMoneda = 0;
     enNume  = #110#6;   |HAZ Conver17;  #560#6  = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#7;   |HAZ Conver17;  #560#7  = eaAlfa;
     enNume  = #110#8;   |HAZ Conver17;  #560#8  = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#9;   |HAZ Conver17;  #560#9  = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#10;  |HAZ Conver17;  #560#10 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver17;  #560#11 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#12;  |HAZ Conver17;  #560#12 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#13;  |HAZ Conver17;  #560#13 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver17;  #560#14 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#15;  |HAZ Conver17;  #560#15 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#16;  |HAZ Conver17;  #560#16 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver17;  #560#17 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#18;  |HAZ Conver17;  #560#18 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#19;  |HAZ Conver17;  #560#19 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver17;  #560#20 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#21;  |HAZ Conver17;  #560#21 = eaAlfa;

     enCambiaMoneda = 1;
     enNume  = #110#22;  |HAZ Conver17;  #560#22 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver17;  #560#23 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#24;  |HAZ Conver17;  #560#24 = eaAlfa;

     enCambiaMoneda = 1;
     enNume  = #110#25;  |HAZ Conver17;  #560#25 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver17;  #560#26 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver17;  #560#27 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver17;  #560#28 = eaAlfa;
     enNume  = #110#29;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #560#29 = eaAlfa;

     #560#30 = #110#30;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #560nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |HAZ CopiaFichero;

     |FBORRA eaFOrigen;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO Internet111_2007;
     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #567;

     #567#1  = "111";

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;     #567#2  = eaVarDni;
         eaAlfa = #715#53;   |HAZ QuitaRaros;       #567#36 = eaAlfa;
         eaAlfa = #715#54;   |HAZ QuitaRarosTfno;   #567#37 = eaAlfa;
         eaAlfa = #715#1;    |HAZ QuitaRaros;       #567#38 = eaAlfa;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #567#2  = eaVarDni;
         eaAlfa   = #715#96;  |HAZ QuitaRaros;     #567#36 = eaAlfa;
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #567#37 = eaAlfa;
         eaAlfa   = #715#1;   |HAZ QuitaRaros;     #567#38 = eaAlfa;
     |FINSI;

     #567#3 = #110#1 % -102;
     #567#4 = ("00" + #110#2) % -102;

     enCambiaMoneda = 0;
     enNume  = #110#6;   |HAZ Conver15;  #567#5  = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#7;   |HAZ Conver17;  #567#6  = eaAlfa;
     enNume  = #110#8;   |HAZ Conver17;  #567#7  = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#9;   |HAZ Conver15;  #567#8  = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#10;  |HAZ Conver17;  #567#9  = eaAlfa;
     enNume  = #110#11;  |HAZ Conver17;  #567#10 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#12;  |HAZ Conver15;  #567#11 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#13;  |HAZ Conver17;  #567#12 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver17;  #567#13 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#15;  |HAZ Conver15;  #567#14 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#16;  |HAZ Conver17;  #567#15 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver17;  #567#16 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#18;  |HAZ Conver15;  #567#17 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#19;  |HAZ Conver17;  #567#18 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver17;  #567#19 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#21;  |HAZ Conver15;  #567#20 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#22;  |HAZ Conver17;  #567#21 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver17;  #567#22 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#31;  |HAZ Conver15;  #567#23 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#32;  |HAZ Conver17;  #567#24 = eaAlfa;
     enNume  = #110#33;  |HAZ Conver17;  #567#25 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#34;  |HAZ Conver15;  #567#26 = eaAlfa;
     enCambiaMoneda = 1;
     enNume  = #110#35;  |HAZ Conver17;  #567#27 = eaAlfa;
     enNume  = #110#36;  |HAZ Conver17;  #567#28 = eaAlfa;

     enCambiaMoneda = 0;
     enNume  = #110#24;  |HAZ Conver17;  #567#29 = eaAlfa;

     enCambiaMoneda = 1;
     enNume  = #110#25;  |HAZ Conver17;  #567#30 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver17;  #567#31 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver17;  #567#32 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver17;  #567#33 = eaAlfa;
     enNume  = #110#29;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #567#34 = eaAlfa;

     |SI #110#4 > 0;
         #567#35 = #4#20;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #567nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |HAZ CopiaFichero;

     |FBORRA eaFOrigen;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO TDeclaracion111;
     #650#6 = "N";
     |SI #110#29 > 0;
         #650#6 = "I";

         enModelo = 110;  enForzar = 0;  |HAZ CogeDatosBancos;

         #650#41 = eaEntidad;
         #650#42 = eaOficina;
         #650#43 = eaDC;
         #650#44 = eaCuenta;
     |FINSI;
|FPRC;

|PROCESO Internet111_2010;
     enCambiaMoneda = 1;

     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #650;

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;    |HAZ CalculameDNI;     #650#7  = eaVarDni;
         eaAlfa   = #715#1;    |HAZ QuitaRaros;       #650#8  = eaAlfa;
         eaAlfa   = #715#53;   |HAZ QuitaRaros;       #650#48 = eaAlfa;

         eaAlfa   = #715#55; |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa = #715#55; |HAZ QuitaRarosTfno;   #650#49 = eaAlfa;
         |SINO;
             eaAlfa = #715#54; |HAZ QuitaRarosTfno;   #650#49 = eaAlfa;
         |FINSI;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;

         eaVarDni = #715#13;   |HAZ CalculameDNI;     #650#7  = eaVarDni;
         eaAlfa   = #715#1;    |HAZ QuitaRaros;       #650#8  = eaAlfa;
         eaAlfa   = #715#96;   |HAZ QuitaRaros;       #650#48 = eaAlfa;

         eaAlfa = #715#61; |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa = #715#61; |HAZ QuitaRarosTfno;   #650#49 = eaAlfa;
         |SINO;
             eaAlfa = #715#14; |HAZ QuitaRarosTfno;   #650#49 = eaAlfa;
         |FINSI;

     |FINSI;

     #650#9  = #110#1;
     #650#10 = ("00" + #110#2) % -102;

     #650#11 = ("000000" + #110#6) % -106;
     enNume  = #110#7;  |HAZ Conver17;  #650#12 = eaAlfa;
     enNume  = #110#8;  |HAZ Conver17;  #650#13 = eaAlfa;

     #650#14 = ("000000" + #110#9) % -106;
     enNume  = #110#10;  |HAZ Conver17;  #650#15 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver17;  #650#16 = eaAlfa;

     #650#17 = ("000000" + #110#12) % -106;
     enNume  = #110#13;  |HAZ Conver17;  #650#18 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver17;  #650#19 = eaAlfa;

     #650#20 = ("000000" + #110#15) % -106;
     enNume  = #110#16;  |HAZ Conver17;  #650#21 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver17;  #650#22 = eaAlfa;

     #650#23 = ("000000" + #110#18) % -106;
     enNume  = #110#19;  |HAZ Conver17;  #650#24 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver17;  #650#25 = eaAlfa;

     #650#26 = ("000000" + #110#21) % -106;
     enNume  = #110#22;  |HAZ Conver17;  #650#27 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver17;  #650#28 = eaAlfa;

     #650#29 = ("000000" + #110#31) % -106;
     enNume  = #110#32;  |HAZ Conver17;  #650#30 = eaAlfa;
     enNume  = #110#33;  |HAZ Conver17;  #650#31 = eaAlfa;

     #650#32 = ("000000" + #110#34) % -106;
     enNume  = #110#35;  |HAZ Conver17;  #650#33 = eaAlfa;
     enNume  = #110#36;  |HAZ Conver17;  #650#34 = eaAlfa;

     #650#35 = ("000000" + #110#24) % -106;
     enNume  = #110#25;  |HAZ Conver17;  #650#36 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver17;  #650#37 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver17;  #650#38 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver17;  #650#39 = eaAlfa;

     enNume  = #110#29;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #650#40 = eaAlfa;

     |HAZ TDeclaracion111;

     #650#45 = "0";
     |SI #110#4 > 0;
         #650#45 = "1";
         #650#46 = #4#21;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #650nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |HAZ CopiaFichero;

     |FBORRA eaFOrigen;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO TDeclaracion111_2011;
     #652#6 = "N";

     |SI #110#29 > 0;
         enNume = #110#29;  |HAZ Conver13;  #566#52 = eaAlfa;

         enModelo = 110;  enForzar = 0;  |HAZ CogeDatosBancos;

         #652#41 = eaEntidad;
         #652#42 = eaOficina;
         #652#43 = eaDC;
         #652#44 = eaCuenta;

                                 #652#6 = "I";
         |SI eaFormaPago = "3";  #652#6 = "U";  |FINSI;
         |SI eaFormaPago = "4";  #652#6 = "A";  |FINSI;
         |SI eaFormaPago = "5";  #652#6 = "E";  |FINSI;
         |SI eaFormaPago = "6";  #652#6 = "G";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaImprime110;
     aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:110" + (("00000" + #999#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #999#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO TDeclaracion110;
     |SI #0#6 [ 2006;
         |SI #110#29 > 0;
             enNume = #110#29;  |HAZ Conver13;  #540#46 = eaAlfa;

             enModelo = 110;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #540#47  = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #540#48  = "X";  |FINSI;

             #540#49  = eaEntidad;
             #540#50  = eaOficina;
             #540#51  = eaDC;
             #540#52  = eaCuenta;
         |SINO;
             enNume  = 0;  |HAZ Conver13;  #540#46 = eaAlfa;
         |FINSI;

         #540#4 = "";
         |SI nTecla ! 3;
             |SI #110#29 [ 0;   #540#4 = "N";  |FINSI;
         |SINO;
             #540#4 = "N";
             |SI #110#29 > 0;   #540#4 = "I";  |FINSI;
        |FINSI;
     |FINSI;

     |SI #0#6 ] 2007;
         |SI #110#29 > 0;

             enNume = #110#29;  |HAZ Conver13;  #566#52 = eaAlfa;

             enModelo = 110;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #566#53  = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #566#54  = "X";  |FINSI;

             #566#55  = eaEntidad;
             #566#56  = eaOficina;
             #566#57  = eaDC;
             #566#58  = eaCuenta;
         |SINO;
             enNume  = 0;  |HAZ Conver13;  #566#52 = eaAlfa;
         |FINSI;

         #566#4 = "";
         |SI nTecla ! 3;
             |SI #110#29 [ 0;  #566#4 = "N";  |FINSI;
         |SINO;
             #566#4 = "N";
             |SI #110#29 > 0;
                                         #566#4 = "I";
                 |SI eaFormaPago = "3";  #566#4 = "U";  |FINSI;
                 |SI eaFormaPago = "4";  #566#4 = "A";  |FINSI;
                 |SI eaFormaPago = "5";  #566#4 = "E";  |FINSI;
                 |SI eaFormaPago = "6";  #566#4 = "G";  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga110_2002;
     enCambiaMoneda = 1;

     |SI nTecla = 1;
         aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     |SI nTecla = 3;
         aAbre = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #540;

     #540#1  = "110";
     #540#2  = "01";
     #540#3  = "";

     |SI enSwDeDonde = 1;
         #540#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #540#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #540#7  = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #540#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #540#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #540#8  = eaAlfa;
             #540#9  = ".";
         |FINSI;
         #540#10 = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #540#11 = eaAlfa;
         #540#12 = #715#31 % 104;
         #540#13 = #715#32;
         #540#14 = #715#33;
         #540#15 = #715#34;
         #540#16 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #540#17 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;       #540#18 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #540#19 = eaAlfa;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #540#55 = eaAlfa;
         eaAlfa  = #715#55;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#55; |HAZ QuitaRarosTfno;   #540#56 = eaAlfa;
         |SINO;
             #540#56 = #540#19;
         |FINSI;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #540#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #540#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #540#8   = eaAlfa;
         #540#9   = ".";
         #540#10  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #540#11  = eaAlfa;
         #540#12 = #715#5 % 104;
         #540#13 = #715#6;
         #540#14 = #715#7;
         #540#15 = #715#8;
         #540#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #540#17 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #540#18 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #540#19 = eaAlfa;
         eaAlfa  = #715#96;  |HAZ QuitaRaros;     #540#55 = eaAlfa;
         eaAlfa  = #715#61;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#61; |HAZ QuitaRarosTfno;   #540#56 = eaAlfa;
         |SINO;
             #540#56 = #540#19;
         |FINSI;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #540#20  = #110#1;

     |SI #110#2 = 3;   #540#21 = "1T";  |FINSI;
     |SI #110#2 = 6;   #540#21 = "2T";  |FINSI;
     |SI #110#2 = 9;   #540#21 = "3T";  |FINSI;
     |SI #110#2 = 12;  #540#21 = "4T";  |FINSI;

     #540#22 = ("000000" + #110#6) % -106;
     enNume  = #110#7;  |HAZ Conver13;  #540#23 = eaAlfa;
     enNume  = #110#8;  |HAZ Conver13;  #540#24 = eaAlfa;

     #540#25 = ("000000" + #110#9) % -106;
     enNume  = #110#10;  |HAZ Conver13;  #540#26 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver13;  #540#27 = eaAlfa;

     #540#28 = ("000000" + #110#12) % -106;
     enNume  = #110#13;  |HAZ Conver13;  #540#29 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver13;  #540#30 = eaAlfa;

     #540#31 = ("000000" + #110#15) % -106;
     enNume  = #110#16;  |HAZ Conver13;  #540#32 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver13;  #540#33 = eaAlfa;

     #540#34 = ("000000" + #110#18) % -106;
     enNume  = #110#19;  |HAZ Conver13;  #540#35 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver13;  #540#36 = eaAlfa;

     #540#37 = ("000000" + #110#21) % -106;
     enNume  = #110#22;  |HAZ Conver13;  #540#38 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver13;  #540#39 = eaAlfa;

     #540#40 = ("000000" + #110#24) % -106;
     enNume  = #110#25;  |HAZ Conver13;  #540#41 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver13;  #540#42 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver13;  #540#43 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver13;  #540#44 = eaAlfa;
     enNume  = #110#29;
     |SI enNume < 0;  enNume = 0;  |FINSI;
                         |HAZ Conver13;  #540#45 = eaAlfa;

     |HAZ TDeclaracion110;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #540#54 = #110#30;
     #540#61 = #540#17;
     #540#62 = eaDiaB;
     #540#63 = eaMesB;
     #540#64 = eaAnyoB;
     #540#65 = &13 + &10;

     |SI nTecla = 1;
         #540#7  = "";
         #540#53 = "";
         #540#55 = "";
         #540#56 = "";
         #540#57 = "";
         #540#58 = "";
         #540#59 = "";
         #540#60 = "";
         nTCampo = 65;
     |FINSI;

     |SI nTecla = 3;
         #540#2  = "";
         #540#3  = "";
         #540#5  = "";
         #540#8  = "";
         #540#9  = "";
         #540#10 = "";
         #540#11 = "";
         #540#12 = "";
         #540#13 = "";
         #540#14 = "";
         #540#15 = "";
         #540#16 = "";
         #540#17 = "";
         #540#18 = "";
         #540#19 = "";
         #540#47 = "";
         #540#48 = "";
         #540#49 = "";
         #540#50 = "";
         #540#51 = "";
         #540#52 = "";
         #540#61 = "";
         #540#62 = "";
         #540#63 = "";
         #540#64 = "";
         #540#65 = "";
         nTCampo = 64;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #540nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "110" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

              |FBORRA eaFOrigen;

             |HAZ CargaImprime110;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         eaLit  = "TRIMESTRE ............:";
         |SI nModelo111 ! 0;
             #540#21 = ("00" + #110#2) % -102;
             #540#1  = "111";
             eaLit   = "MES ..................:";
         |FINSI;

         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO Carga110_2007;
     enCambiaMoneda = 1;

     |SI nTecla = 1;
         aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     |SI nTecla = 3;
         aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #566;

     #566#1  = "110";
     #566#2  = "01";
     #566#3  = "";

     |SI enSwDeDonde = 1;
         #566#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #566#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #566#7  = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = aAlfa1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #566#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #566#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #566#8  = eaAlfa;
             #566#9  = ".";
         |FINSI;
         #566#10 = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #566#11 = eaAlfa;
         #566#12 = #715#31 % 104;
         #566#13 = #715#32;
         #566#14 = #715#33;
         #566#15 = #715#34;
         #566#16 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #566#17 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;       #566#18 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #566#19 = eaAlfa;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #566#61 = eaAlfa;
         eaAlfa  = #715#55;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#55; |HAZ QuitaRarosTfno;   #566#62 = eaAlfa;
         |SINO;
             #566#62 = #566#19;
         |FINSI;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #566#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #566#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #566#8   = eaAlfa;
         #566#9   = ".";
         #566#10  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #566#11  = eaAlfa;
         #566#12 = #715#5 % 104;
         #566#13 = #715#6;
         #566#14 = #715#7;
         #566#15 = #715#8;
         #566#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #566#17 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #566#18 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #566#19 = eaAlfa;
         eaAlfa  = #715#96;  |HAZ QuitaRaros;     #566#61 = eaAlfa;
         eaAlfa  = #715#61;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#61; |HAZ QuitaRarosTfno;   #566#62 = eaAlfa;
         |SINO;
             #566#62 = #566#19;
         |FINSI;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #566#20  = #110#1;

     |SI #110#2 = 3;   #566#21 = "1T";  |FINSI;
     |SI #110#2 = 6;   #566#21 = "2T";  |FINSI;
     |SI #110#2 = 9;   #566#21 = "3T";  |FINSI;
     |SI #110#2 = 12;  #566#21 = "4T";  |FINSI;

     #566#22 = ("000000" + #110#6) % -106;
     enNume  = #110#7;  |HAZ Conver13;  #566#23 = eaAlfa;
     enNume  = #110#8;  |HAZ Conver13;  #566#24 = eaAlfa;

     #566#25 = ("000000" + #110#9) % -106;
     enNume  = #110#10;  |HAZ Conver13;  #566#26 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver13;  #566#27 = eaAlfa;

     #566#28 = ("000000" + #110#12) % -106;
     enNume  = #110#13;  |HAZ Conver13;  #566#29 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver13;  #566#30 = eaAlfa;

     #566#31 = ("000000" + #110#15) % -106;
     enNume  = #110#16;  |HAZ Conver13;  #566#32 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver13;  #566#33 = eaAlfa;

     #566#34 = ("000000" + #110#18) % -106;
     enNume  = #110#19;  |HAZ Conver13;  #566#35 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver13;  #566#36 = eaAlfa;

     #566#37 = ("000000" + #110#21) % -106;
     enNume  = #110#22;  |HAZ Conver13;  #566#38 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver13;  #566#39 = eaAlfa;

     #566#40 = ("000000" + #110#31) % -106;
     enNume  = #110#32;  |HAZ Conver13;  #566#41 = eaAlfa;
     enNume  = #110#33;  |HAZ Conver13;  #566#42 = eaAlfa;

     #566#43 = ("000000" + #110#34) % -106;
     enNume  = #110#35;  |HAZ Conver13;  #566#44 = eaAlfa;
     enNume  = #110#36;  |HAZ Conver13;  #566#45 = eaAlfa;

     #566#46 = ("000000" + #110#24) % -106;
     enNume  = #110#25;  |HAZ Conver13;  #566#47 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver13;  #566#48 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver13;  #566#49 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver13;  #566#50 = eaAlfa;
     enNume  = #110#29;
     |SI enNume < 0;  enNume = 0;  |FINSI;
                         |HAZ Conver13;  #566#51 = eaAlfa;

     |HAZ TDeclaracion110;

     |SI #110#4 > 0;
         #566#59 = #4#20;
         #566#60 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #566#67 = #566#17;
     #566#68 = eaDiaB;
     #566#69 = eaMesB;
     #566#70 = eaAnyoB;
     #566#71 = &13 + &10;

     |SI nTecla = 1;
         #566#7  = "";
         #566#59 = "";
         #566#61 = "";
         #566#62 = "";
         #566#63 = "";
         #566#64 = "";
         #566#65 = "";
         #566#66 = "";
         nTCampo = 71;
     |FINSI;

     |SI nTecla = 3;
         #566#2  = "";
         #566#3  = "";
         #566#5  = "";
         #566#8  = "";
         #566#9  = "";
         #566#10 = "";
         #566#11 = "";
         #566#12 = "";
         #566#13 = "";
         #566#14 = "";
         #566#15 = "";
         #566#16 = "";
         #566#17 = "";
         #566#18 = "";
         #566#19 = "";
         #566#67 = "";
         #566#68 = "";
         #566#69 = "";
         #566#70 = "";
         #566#71 = "";
         nTCampo = 70;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 9;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #566nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;

         |PARA nCampo = 20;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #566nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "110" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime110;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         eaLit  = "TRIMESTRE ............:";
         |SI nModelo111 ! 0;
             #566#21 = ("00" + #110#2) % -102;
             #566#1  = "111";
             eaLit   = "MES ..................:";
         |FINSI;

         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO Carga652;
     enCambiaMoneda = 1;

     |ABRE #110;
     #110#0 = #4#0;
     #110#1 = #4#1;
     #110#2 = #4#2;
     #110#3 = #4#3;
     #110#4 = #4#4;
     #110#5 = 0;
     |LEE 040#110=;
     |SI FSalida ! 0;  |CIERRA #110;  |ACABA;  |FINSI;
     |CIERRA #110;

     aAbre = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle2;

     enCodCli = #110#0;
     |HAZ LeePersona;

     |DDEFECTO #652;

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;    |HAZ CalculameDNI;     #652#7  = eaVarDni;
         eaAlfa   = #715#1;    |HAZ QuitaRaros;       #652#8  = eaAlfa;
         eaAlfa   = #715#53;   |HAZ QuitaRaros;       #652#48 = eaAlfa;

         eaAlfa   = #715#55; |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa = #715#55; |HAZ QuitaRarosTfno;   #652#49 = eaAlfa;
         |SINO;
             eaAlfa = #715#54; |HAZ QuitaRarosTfno;   #652#49 = eaAlfa;
         |FINSI;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;

         eaVarDni = #715#13;   |HAZ CalculameDNI;     #652#7  = eaVarDni;
         eaAlfa   = #715#1;    |HAZ QuitaRaros;       #652#8  = eaAlfa;
         eaAlfa   = #715#96;   |HAZ QuitaRaros;       #652#48 = eaAlfa;

         eaAlfa = #715#61; |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa = #715#61; |HAZ QuitaRarosTfno;   #652#49 = eaAlfa;
         |SINO;
             eaAlfa = #715#14; |HAZ QuitaRarosTfno;   #652#49 = eaAlfa;
         |FINSI;
     |FINSI;

     #652#9  = #110#1;
     #652#10 = ("00" + #110#2) % -102;

     #652#11 = ("00000000" + #110#6) % -108;
     enNume  = #110#7;  |HAZ Conver17;  #652#12 = eaAlfa;
     enNume  = #110#8;  |HAZ Conver17;  #652#13 = eaAlfa;

     #652#14 = ("00000000" + #110#9) % -108;
     enNume  = #110#10;  |HAZ Conver17;  #652#15 = eaAlfa;
     enNume  = #110#11;  |HAZ Conver17;  #652#16 = eaAlfa;

     #652#17 = ("00000000" + #110#12) % -108;
     enNume  = #110#13;  |HAZ Conver17;  #652#18 = eaAlfa;
     enNume  = #110#14;  |HAZ Conver17;  #652#19 = eaAlfa;

     #652#20 = ("00000000" + #110#15) % -108;
     enNume  = #110#16;  |HAZ Conver17;  #652#21 = eaAlfa;
     enNume  = #110#17;  |HAZ Conver17;  #652#22 = eaAlfa;

     #652#23 = ("00000000" + #110#18) % -108;
     enNume  = #110#19;  |HAZ Conver17;  #652#24 = eaAlfa;
     enNume  = #110#20;  |HAZ Conver17;  #652#25 = eaAlfa;

     #652#26 = ("00000000" + #110#21) % -108;
     enNume  = #110#22;  |HAZ Conver17;  #652#27 = eaAlfa;
     enNume  = #110#23;  |HAZ Conver17;  #652#28 = eaAlfa;

     #652#29 = ("00000000" + #110#31) % -108;
     enNume  = #110#32;  |HAZ Conver17;  #652#30 = eaAlfa;
     enNume  = #110#33;  |HAZ Conver17;  #652#31 = eaAlfa;

     #652#32 = ("00000000" + #110#34) % -108;
     enNume  = #110#35;  |HAZ Conver17;  #652#33 = eaAlfa;
     enNume  = #110#36;  |HAZ Conver17;  #652#34 = eaAlfa;

     #652#35 = ("00000000" + #110#24) % -108;
     enNume  = #110#25;  |HAZ Conver17;  #652#36 = eaAlfa;
     enNume  = #110#26;  |HAZ Conver17;  #652#37 = eaAlfa;

     enNume  = #110#27;  |HAZ Conver17;  #652#38 = eaAlfa;
     enNume  = #110#28;  |HAZ Conver17;  #652#39 = eaAlfa;

     enNume  = #110#29;
     |SI enNume < 0; enNume = 0;  |FINSI;
                         |HAZ Conver17;  #652#40 = eaAlfa;

     |HAZ TDeclaracion111_2011;

     #652#45 = "0";
     |SI #110#4 > 0;
         #652#45 = "1";
         #652#46 = #4#21;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #652nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;
|FPRC;

|PROCESO GrabaPortal;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandlePortal, aAlfa;
|FPRC;

|PROCESO GrabaPortalSin;
     |XGRABA nHandlePortal, aAlfa;
|FPRC;

|PROCESO VarVacia;
     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + aTipo + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;
|FPRC;

|PROCESO Portal8111;
     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |CUADRO 0501 2380;

     aAlfa = "Conectandose a la pagina de la aeat";
     |PINTA 1210, aAlfa;

     aAbrePortal = eaPathEmision + "portal111.html";
     |XABRE "WB", aAbrePortal, nHandlePortal;

     aAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     aAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html>";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "     function carga()";
     |HAZ GrabaPortal;

     aAlfa = "     {";
     |HAZ GrabaPortal;

     aAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     aAlfa = "     }";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www2.agenciatributaria.gob.es/es13/l/zi22zilk0022" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "IE1111VA" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIC" + &34 + " value=" + &34 + "<T1110" + #652#9 + "0A0000><AUX>";
     |HAZ GrabaPortalSin;

     aAlfa = " " * 150;
     |HAZ GrabaPortalSin;
     |HAZ GrabaPortalSin;

     aAlfa = "</AUX><VECTOR>001FIN";
     |HAZ GrabaPortalSin;

     aAlfa = " " * 200;
     |HAZ GrabaPortalSin;

     aAlfa = " " * 94;
     |HAZ GrabaPortalSin;

     aAlfa = "</VECTOR>";
     |HAZ GrabaPortalSin;

     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #652nCampo;
           |XGRABA nHandlePortal, aAlfa;
     |SIGUE;

     aAlfa = "</ T1110" + #652#9 + "0A0000>" + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "RUT";  |HAZ VarVacia;

     |SI nValidacion = 1;
         aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + "EWLINKQN" + &34 + " />";
         |HAZ GrabaPortal;
     |SINO;
         aTipo = "PRG";  |HAZ VarVacia;
     |FINSI;

     aTipo = "F";
     |SI #652#41 ! "    ";
         aTipo = #652#41;
     |FINSI;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + aTipo + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + #652#9 + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "111" + &34 + " />";
     |HAZ GrabaPortal;


     aAlfa = "";  |HAZ GrabaPortal;
     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "</form>";   |HAZ GrabaPortal;
     aAlfa = "</body>";   |HAZ GrabaPortal;
     aAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA nHandlePortal;

     eaFOrigen  = aAbrePortal;
     eaFDestino = eaPathLanza + "portal111.html";
     |HAZ CopiaFichero;

     |SI nValidacion = 1;
         eaHtml  = "portal111.html";
         eaError = "e" + (("00000" + #999#0) % -105) + ".html";
         |HAZ ValidaPortal;
         |SI enErrorPortal = 0;
             eaFOrigen  = eaPathEmision + "110" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "110" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         eaForzExplorador = "N";
         |HAZ Explorador;

         |SI eaPathExplorador ! "";
             aAlfa = eaPathExplorador + " " + eaFDestino;
             aAlfa = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
         |SINO;
             aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaFDestino + &34;
         |FINSI;

         |RSYSTEM aAlfa;

         |RFBORRA eaFDestino;
     |FINSI;

     |RFBORRA aAbrePortal;

     |POPV;
|FPRC;

|PROCESO Portal8211;
     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |CUADRO 0501 2380;

     aAlfa = "Conectandose a la pagina  de la aeat.";
     |PINTA 1210, aAlfa;

     aAbrePortal = eaPathEmision + "portal111.html";
     |XABRE "WB", aAbrePortal, nHandlePortal;

     aAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     aAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html>";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "     function carga()";
     |HAZ GrabaPortal;

     aAlfa = "     {";
     |HAZ GrabaPortal;

     aAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     aAlfa = "     }";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www2.agenciatributaria.gob.es/es13/l/zi21zilk0021" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "IE11110B" + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "N";
     |SI #110#29 > 0;
         aTipo = "I";
     |FINSI;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "TIA" + &34 + " value=" + &34 + aTipo + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "NDC" + &34 + " value=" + &34 + #652#7 + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "NRC";  |HAZ VarVacia;

     |SI #110#29 > 0;
         aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "ING" + &34 + " value=" + &34 + #110#29 + &34 + " />";
         |HAZ GrabaPortal;
     |SINO;
         aTipo = "ING";  |HAZ VarVacia;
     |FINSI;

     aTipo = "NRR";  |HAZ VarVacia;
     aTipo = "ICO";  |HAZ VarVacia;
     aTipo = "NR1";  |HAZ VarVacia;
     aTipo = "IN1";  |HAZ VarVacia;
     aTipo = "NR2";  |HAZ VarVacia;
     aTipo = "IN2";  |HAZ VarVacia;
     aTipo = "NR3";  |HAZ VarVacia;
     aTipo = "IN3";  |HAZ VarVacia;
     aTipo = "NR4";  |HAZ VarVacia;
     aTipo = "IN4";  |HAZ VarVacia;
     aTipo = "NR5";  |HAZ VarVacia;
     aTipo = "IN5";  |HAZ VarVacia;
     aTipo = "NR6";  |HAZ VarVacia;
     aTipo = "IN6";  |HAZ VarVacia;
     aTipo = "NR7";  |HAZ VarVacia;
     aTipo = "IN7";  |HAZ VarVacia;
     aTipo = "CMN";  |HAZ VarVacia;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LOT" + &34 + " value=" + &34 + "0" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LEV" + &34 + " value=" + &34 + "000000000000" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "F01" + &34 + " value=" + &34 + "<T1110" + #652#9 + "0A0000><AUX>";
     |HAZ GrabaPortalSin;

     aAlfa = " " * 150;
     |HAZ GrabaPortalSin;
     |HAZ GrabaPortalSin;

     aAlfa = "</AUX><VECTOR>001FIN";
     |HAZ GrabaPortalSin;

     aAlfa = " " * 200;
     |HAZ GrabaPortalSin;

     aAlfa = " " * 94;
     |HAZ GrabaPortalSin;

     aAlfa = "</VECTOR>";
     |HAZ GrabaPortalSin;

     |PARA nCampo = 1;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #652nCampo;
           |XGRABA nHandlePortal, aAlfa;
     |SIGUE;

     aAlfa = "</ T1110" + #652#9 + "0A0000>" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PUN" + &34 + " value=" + &34 + "00000000" + &34 + " />";
     |HAZ GrabaPortal;

     aTipo = "TXT";  |HAZ VarVacia;
     aTipo = "FIR";  |HAZ VarVacia;

     aTipo = "F";
     |SI #652#41 ! "    ";
         aTipo = #652#41;
     |FINSI;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + aTipo + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + #652#9 + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "111" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + "EWLINKQM" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;
     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "</form>";   |HAZ GrabaPortal;
     aAlfa = "</body>";   |HAZ GrabaPortal;
     aAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA nHandlePortal;

     eaFOrigen  = aAbrePortal;
     eaFDestino = eaPathLanza + "portal111.html";
     |HAZ CopiaFichero;

     eaHtml  = "portal111.html";
     eaError = "e" + (("00000" + #999#0) % -105) + ".html";
     |HAZ ValidaPortal;
     |SI enErrorPortal = 0;
         eaForzExplorador = "N";
         |HAZ Explorador;

         |SI eaPathExplorador ! "";
            aAlfa = eaPathExplorador + " " + eaFDestino;
            aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
         |SINO;
            aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaFDestino + &34;
         |FINSI;

         |RSYSTEM aAlfa;
     |FINSI;

     |FBORRA eaFOrigen;
     |RFBORRA eaFDestino;

     |POPV;
|FPRC;

|PROCESO dsmom002;
     aAlfa   = "31.12." + #999#1;  fHFecha = aAlfa;
     aAlfa   = "01.01." + #999#1;  fDFecha = aAlfa;

     aAlfa   = #2#8 % -104;
     |SI aAlfa ! "0000";
         nNume = aAlfa;
         |SI nNume > #999#1; |ACABA; |FINSI;

         |SI #2#8 > fDFecha; fDFecha = #2#8; |FINSI;
     |FINSI;

     aAlfa   = #2#9 % -104;
     |SI aAlfa ! "0000";
         nNume   = aAlfa;
         |SI nNume < #0#14;  |ACABA;  |FINSI;

         |SI #2#9 < fHFecha;  fHFecha = #2#9;  |FINSI;
     |FINSI;

     aAlfa2 = ("00" + #999#2) % -102;
     aAlfa  = "31.";
     |SI #999#2 = 4; |O #999#2 = 6; |O #999#2 = 9; |O #999#2 = 11;
         aAlfa = "30.";
     |FINSI;
     |SI #999#2 = 2;
         aAlfa = "28."; |SI #999#1 = 2000; |O #999#1 = 2004; |O #999#1 = 2008;
                            |O #999#1 = 2012; |O #999#1 = 2016; |O #999#1 = 2020;
                               aAlfa = "29.";
                        |FINSI;
     |FINSI;
     aAlfa2 = aAlfa + aAlfa2 + "." + #999#1;

     |SI #2#7 = "TRIMESTRAL";
         |SI #999#2 = 3;  aAlfa1 = "01.01." + #999#1;  |FINSI;
         |SI #999#2 = 6;  aAlfa1 = "01.04." + #999#1;  |FINSI;
         |SI #999#2 = 9;  aAlfa1 = "01.07." + #999#1;  |FINSI;
         |SI #999#2 = 12; aAlfa1 = "01.10." + #999#1;  |FINSI;
     |FINSI;

     |SI #2#7 = "MENSUAL   ";
         aAlfa1 = ("00" + #999#2) % -102;
         aAlfa1 = "01." + aAlfa1 + "." + #999#1;
     |FINSI;

     |SI #2#7 = "ANUAL     ";
         aAlfa1 = "01.01." + #999#1;
         aAlfa2 = "31.12." + #999#1;
     |FINSI;

     fFecha = aAlfa1;
     |SI fHFecha < fFecha;  |ACABA;  |FINSI;

     fFecha = aAlfa2;
     |SI fDFecha > fFecha;  |ACABA;  |FINSI;

     |SI #2#7 = "MENSUAL   ";
         nModelo111 = 1;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom002;
     #2#1;
     ;
     #999#0, 01, 110;
     #999#0, 98, 110;
     ;
     NULL, dsmom002;
|FIN;

|PROCESO Forma2010;
     |SI #0#6 [ 2001;
         |SI nTecla ! 3;
             nLaser = 1;
             |HAZ Registro110_2001;
         |SINO;
             |HAZ Internet110_2001;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #0#6 [ 2006;
         |SI nTecla ! 3;
             |SI nModelo111 = 0;
                 nLaser = 1;
                 |HAZ Carga110_2002;
             |SINO;
                 |SI nTecla ! 1;
                     |HAZ Carga110_2002;
                 |FINSI;
             |FINSI;
        |SINO;
             |SI nModelo111 = 0;
                 nLaser = 1;
                 |HAZ Carga110_2002;
             |SINO;
                 |HAZ Internet111;
             |FINSI;
        |FINSI;

        |ACABA;
     |FINSI;

     |SI nTecla ! 3;
         |SI nModelo111 = 0;
             nLaser = 1;
             |HAZ Carga110_2007;
         |SINO;
             |SI nTecla ! 1;
                 |HAZ Carga110_2007;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nModelo111 = 0;
             nLaser = 1;
             |HAZ Carga110_2007;
         |SINO;
             |SI #0#6 [ 2009;
                 |HAZ Internet111_2007;
             |FINSI;

             |SI #0#6 = 2010;
                 |HAZ Internet111_2010;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Forma2011;
     |HAZ Carga652;
/*

     |SI nTecla = 1;                   |HAZ Portal8211; |FINSI;
     |SI nTecla = 3;  nValidacion = 1; |HAZ Portal8111;  |FINSI;
     |SI nTecla = 4;  nValidacion = 0; |HAZ Portal8111;  |FINSI;
*/
|FPRC;

|PROCESO QueHacemos110;
     nModelo111 = 0;
     |BUCLE dsmom002;

     |ABRE #4;
     #4#0  = #999#0;
     #4#1  = #999#1;
     #4#2  = #999#2;
     #4#3  = #999#5;
     #4#4  = #999#7;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #4;

     |SI #999#5 ! 110;  |ACABA;  |FINSI;

     |SI #0#6 [ 2010;  |HAZ Forma2010;  |FINSI;
     |SI #0#6 ] 2011;  |HAZ Forma2011;  |FINSI;

|FPRC;

|DEFBUCLE dsmow014C110;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos110;
|FIN;

|DEFBUCLE dsmow014N110;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos110;
|FIN;

|PROCESO AbreImprime110;
     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD " + eaPathLanza + &13 + &10;    |XGRABA nHandle1, aAlfa;

     aAlfa    = #0#6;
     aAlfa    = aAlfa % -102;
     aVersion = "";

     |SI #0#6 ] 2008;
         aVersion = "01";
         |SI #0#6 = 2008;
             |SI #0#4 ] 4;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + eaPathLanza + &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + eaPathLanza + &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO EmiteEsto110_2001;
     aAlfa = "DEL die*.*" + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.imp"  + &13 + &10;  |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |DBASS aModelos;  |QBT aModelos;
     aModelos = aModelos + "basica/";
     eaFOrigen  = aModelos + "patrones/zls01mpf.exe";
     eaFDestino = eaPathLanza + "zls01mpf.exe";
     |HAZ CopiaFichero;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |HAZ BuscaErroresL;
|FPRC;

|PROCESO EmiteEsto110_2002;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |HAZ Copiampf;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |HAZ BuscaErroresL;
|FPRC;

|PROCESO CreaVarios;
     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = eaPathLanza + "AInternet";
     aPathInter  = aPathInter + "/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
          |SI FSalida ! 0; |SAL; |FINSI;

           aBue     = aFichero - aPathInter;
          |SI nTecla = 3;
               aDestino = eaPathInternet + "111" + (aBue % 405) + ".txt";
               |RCOPIA_FICHERO aFichero, aDestino;
          |SINO;
               |HAZ Portal8211;
          |FINSI;

          |RFBORRA aFichero;

          |R_SDIR aFichero;
     |SIGUE;

     |SI nTecla = 3;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto111_2011;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |HAZ Copiampf;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |SI nTecla = 1;  |O nTecla = 3;
          enValidacion = 1;
          |HAZ BuscaErroresL;

          |SI enBuenos = 0;
             |MENAV "      Ha habido Errores, arreglelos y vuelva a emitir.";
             |ACABA;
          |FINSI;

          |HAZ CreaVarios;
     |FINSI;
|FPRC;

|PROCESO Boton1101;
     |PTEC 824;
|FPRC;

|PROCESO Boton1102;
     |PTEC 825;
|FPRC;

|PROCESO Boton1103;
     |PTEC 826;
|FPRC;

|PROCESO Boton1104;
     |PTEC 827;
|FPRC;

|PROCESO Boton1105;
     |PTEC 806;
|FPRC;

|PROCESO Boton1106;
     |PTEC 828;
|FPRC;

|PROCESO Botones110;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser          ", 0513, 0754, Boton1101;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Continuo       ", 0913, 1154, Boton1102;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica              ", 1313, 1554, Boton1103;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de Comprobacion              ", 1713, 1954, Boton1104;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1105;
     nBoton5 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;
             |SI #0#4 = 1; |O  #0#4 = 2; |O  #0#4 = 4;  |O  #0#2 = 5;
             |O  #0#4 = 7; |O  #0#4 = 8; |O  #0#4 = 10; |O  #0#2 = 11;
                 |MENAV "     El Modelo 111 no esta en Laser.";
             |SINO;
                 nTecla = 1;   |SAL;
             |FINSI;
         |FINSI;
         |SI aTecla = aF3;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF4;  nTecla = 3;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF6;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |PULSATECLA;
|FPRC;

|PROCESO Botones110_2010;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser          ", 0513, 0754, Boton1101;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica              ", 0913, 1154, Boton1103;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de Comprobacion              ", 1313, 1554, Boton1104;
     nBoton4 = FSalida;

     |SI #0#4 = 1;  |Y #0#6 = 2010;
         |CONTROL_SIMPLE 0, "BOTON,<F6> Informe 111 - Posibles presentaciones erroneas", 1713, 1954, Boton1106;
         nBoton6 = FSalida;
     |FINSI;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1105;
     nBoton5 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "828";
     aF7 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;
             |SI #0#4 = 1; |O  #0#4 = 2; |O  #0#4 = 4;  |O  #0#2 = 5;
             |O  #0#4 = 7; |O  #0#4 = 8; |O  #0#4 = 10; |O  #0#2 = 11;
                 |MENAV "     El Modelo 111 no esta en Laser.";
             |SINO;
                 nTecla = 1;   |SAL;
             |FINSI;
         |FINSI;
         |SI aTecla = aF4;  nTecla = 3;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF6;  |HAZ Informe111;     |FINSI;
         |SI aTecla = aF7;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |SI #0#4 = 1;  |Y #0#6 = 2010;
         |FIN_CONTROL_WINDOWS nBoton6;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO Botones111_2011;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision PDF pagina hacienda          ", 0513, 0754, Boton1101;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica              ", 0913, 1154, Boton1103;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de Comprobacion              ", 1313, 1554, Boton1104;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1105;
     nBoton5 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF7 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;
             |SI #0#4 = 1; |O  #0#4 = 2; |O  #0#4 = 4;  |O  #0#2 = 5;
             |O  #0#4 = 7; |O  #0#4 = 8; |O  #0#4 = 10; |O  #0#2 = 11;
                 |MENAV "     El Modelo 111 no esta en Laser.";
             |SINO;
                 nTecla = 1;   |SAL;
             |FINSI;
         |FINSI;
         |SI aTecla = aF4;  nTecla = 3;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF7;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |PULSATECLA;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #0 aFichero;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #999 aFichero;

     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;
         |CIERRA #107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #107;
     |FINSI;

     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     |ABRE #0;
     |LEE 000#0p;
     |CIERRA #0;

     |SI eaParametro ! "110C";
         |SI #0#6 [ 2009;  |HAZ Botones110;       |FINSI;
         |SI #0#6 = 2010;  |HAZ Botones110_2010;  |FINSI;
         |SI #0#6 ] 2011;  |HAZ Botones111_2011;  |FINSI;
     |SINO;
         nTecla = 4;
     |FINSI;

     |SI nTecla = 0;  enInfComp = 1;  |ACABA;  |FINSI;
     |SI nTecla = 4;  enInfComp = 1;  |FINSI;

     |SI nTecla = 1;
         |HAZ CompruebaEjecutable;
         |SI enError = 1;  |ACABA;  |FINSI;

         |SI #0#6 [ 2001;
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #600;
                  |PINPA #0#600;
                  |PINDA #0#600;
                  |ENDATOS #1#600;
                  |SI FSalida = 0;
                      |HAZ AbreImprime110;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |SINO;
             |PARA;  |SI;  |HACIENDO;
                  #601#0 = #107#5;
                  #601#1 = #107#7;

                  |C_M #601#0, 1, "S";
                  |C_M #601#1, 1, "S";
                  |SI #107#6 = "N";  |C_M #601#0, 1, "N";  |FINSI;
                  |SI #107#8 = "N";  |C_M #601#1, 1, "N";  |FINSI;

                  nPedirPanta = 0;
                  |SI #107#6 = "N";  |Y #107#8 = "N";  |Y #107#7 = "N";
                      nPedirPanta = 1;
                  |FINSI;

                  FSalida = 0;
                  |SI nPedirPanta = 0;
                      |PINPA #0#601;
                      |PINDA #0#601;
                      |ENDATOS #1#601;
                  |FINSI;

                  |SI FSalida = 0;
                      |HAZ AbreImprime110;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |SI nTecla = 2;
         |MENAV "     Opcion no instalada";
         |ACABA;
     |FINSI;

     |SI nTecla = 4;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #0#6 ] 2007;                 |INFOR "m110co03";  |FINSI;
         |SI #0#6 ] 2002; |Y #0#6 [ 2006; |INFOR "m110co02";  |FINSI;
         |SI #0#6 [ 2001;                 |INFOR "m110co01";  |FINSI;

         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
     |FINSI;

     nLaser = 0;
     nSwLee = 0;
     |SI #0#8 = "C";
         |BUCLE dsmow014C110;
     |SINO;
         |BUCLE dsmow014N110;
     |FINSI;

     |SI nTecla = 1;  |Y nLaser = 1;
         |SI #0#6 [ 2001;
             |HAZ EmiteEsto110_2001;
         |FINSI;

         |SI #0#6 [ 2010;
             |HAZ EmiteEsto110_2002;
         |FINSI;

         |SI #0#6 ] 2011;
             |HAZ EmiteEsto111_2011;
         |FINSI;
     |FINSI;

     |SI nTecla = 3;
         aAlfa =  "      Los ficheros generados estan en: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;

     |SI nTecla = 4;   |Y #0#6 [ 2010;
         |FININF;
         |FINIMP;
     |FINSI;
|FPRO;
