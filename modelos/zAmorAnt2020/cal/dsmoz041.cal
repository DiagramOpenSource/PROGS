|FICHEROS;
     dsmoz041 #0;
     dsmom040 #40;
     dsmom041 #41;
     dsmom042 #42;
     dsmom044 #44;

     dsmom107 #107;
     dsmow041 #999;

    :/basica/def/agicen14 #114;
    :/basica/def/agifigen #1000;
|FIN;

|VARIABLES;
     aFichero  = "";

     nCampo    = 0;
     nDEmpresa = 0;
     nHEmpresa = 0;
     enGraba   = 0;
     nSwExiste = 0;
     &nNingunaMas = 0;
     &nLaPrimera  = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\
|CALCULO PeroLaCreo;
    |ABRE #1000;
    #1000#0 = #0#1;
    |LEE 041#1000=;
    |SI FSalida ! 0;
        |CIERRA #1000;
        |ACABA;
    |FINSI;
    |CIERRA #1000;

    #999#0 = #1000#0;
    |LEE 101#999=;
    |SI FSalida ! 0;
        #999#0 = #1000#0;
        #999#1 = #1000#1;
        |GRABA 000#999b;
    |FINSI;
    |LIBERA #999;
|FCAL;

|PROCESO GrabaTempo;
     #999#0 = #41#0;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = #41#0;
         #999#1 = #41#32;
         |GRABA 020#999n;
         enGraba = 1;
         |SI #41#0 = #0#1; nSwExiste = 1; |FINSI;
     |FINSI;

     |LIBERA #999;
|FPRC;

|DEFBUCLE dsmom041;
     #41#1;
     ;
     nDEmpresa, "        ", 00;
     nHEmpresa, "zzzzzzzz", 99;
     ;
     NULL, GrabaTempo;
|FIN;

|PROCESO GrabaTempo1;
 |ABRE #41;
 |DDEFECTO #41;
 #41#0 = #1000#0;
 #41#2 = "        ";
 #41#3 = 00;
 |LEE 041#41];
 |SI FSalida = 0; |Y #41#0= #1000#0;
     |HAZ GrabaTempo;
 |FINSI;
 |CIERRA #41;
|FPRC;

|DEFBUCLE dsmom041_f;
     #1000#1;
     ;
     nDEmpresa;
     nHEmpresa;
     ;
     NULL, GrabaTempo1;
|FIN;


|RUTINA ClaveBaja999;
  |SI FSalida = "POSICION";
      #999#0 = #0#1;
  |SINO;
      #999#0 = 1;
  |FINSI;
|FRUT;

|RUTINA ClaveAlta999;
     #999#0 = 99999;
|FRUT;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = ("40" + Usuario) % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     nSwExiste = 0;
     nDEmpresa = 00000;
     nHEmpresa = 99999;
     |SI nNingunaMas = 1;
         nDEmpresa = #0#1;
         nHEmpresa = #0#1;
     |FINSI;

     |ABRE #999;
     |BUCLE dsmom041_f;
     |SI nSwExiste = 0;
         |HAZ PeroLaCreo;
     |FINSI;
     |CIERRA #999;

     |PINPA #0#999;
     enEmpresa = 0;
     |HAZ Analitica;
     |SI enSwAna = 1;
         |C_V #dsmom040#9,1,"S";
         |C_V #dsmom041#34,1,"S";
         |C_M #dsmom041#34,1,"S";
         |ATRI P; |PINTA 1460, "        Ana: "; |ATRI 0;
     |SINO;
         |C_V #dsmom040#9,1,"N";
         |C_V #dsmom041#34,1,"N";
         |C_M #dsmom041#34,1,"N";
         |ATRI P; |PINTA 1460, "Cta Ac.:              "; |ATRI 0;
    |FINSI;
     nLaPrimera = 1;
     |PTEC 825;
     |ENTLINEAL #1#999, -1, 2, 5, 0, ClaveBaja999, ClaveAlta999;
     |DELINDEX #999;
|FPRC;

|PROGRAMA;
  |HAZ LeeEURODBMOD;
  nT600 = 100000;
  |SI EURODBMOD = 2;
      nT600 = (nT600 / 166.386) ! EURODBMOD;
  |FINSI;

   |ABRE #107;
   |DDEFECTO #107;
   |LEE 040#107p;
   |CIERRA #107;

     |SI enEmpresa ! 0;
         nNingunaMas = 1;
         #0#1 = enEmpresa;
         #0#2 = enActividad;
         |HAZ Tipo3;
     |SINO;
         |CLS;
         |CABEZA "Entrada de Elementos de Amortizacion";
         |DDEFECTO #0;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |FINSI;
|FPRO;

|PROCESO Tipo88;  |TIPO 88;
     |HAZ Relaciones;
|FPRC;
