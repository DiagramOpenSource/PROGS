|FICHEROS;
   dsmom051 #51,MANTE;  ||Mant. Valores por Empresas
   dsmom052 #52,MANTE;  ||Relacion de Socios
   dsmom053 #53,MANTE;  ||Relacion de Comuneros
   dsmow061 #61,MANTE;  ||Temporal Cuentas
   dsmow060 #99,MANTE;
|FIN;

|VARIABLES;
 nNume1 = 0;
 nNume2 = 0;
 aAlfa1  = "";
 aNomEmpresa = "";
 &swUnoSolo = 0;
 &nBoton2 = 0;
 &nBoton3 = 0;
 &nBoton4 = 0;
 &nBoton5 = 0;
 &nBoton6 = 0;
 aTecla  = "";
 aF2     = "";
 aEsc    = "";
 &nTecla  = 0;
 &eaRelCta = "";
 nLnEstado = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varlib;

|PROCESO MTipo7; |TIPO 7;
   aNomEmpresa = #51#3;
   enEmpresa = #51#0;
   |HAZ DatosEmpr_w30;

   |SI swUnoSolo = 1; |PINTA 901, "           "; |FINSI;
   |CONTROL_SIMPLE 0, "LBOTON,F2 Relacion Cuentas", 1164, 1179, Boton2;
   nBoton2 = FSalida;
   |CONTROL_SIMPLE 0, "LBOTON,F5 Imprimir Valor  ", 1464, 1479, Boton5;
   nBoton5 = FSalida;

                                  || esto no es socidad || |SI #51#4 = 2;
   |SI #51#6 = 2;  |O nRegis ! 0; ||Una Sociedad
       |CONTROL_SIMPLE 0, "LBOTON,F3 Relacion de Socios", 1264, 1279, Boton3;
       nBoton3 = FSalida;
       |CONTROL_SIMPLE 0, "LBOTON,F6 Imp. Certificados ", 1564, 1579, Boton6;
       nBoton6 = FSalida;
   |SINO;
       |SI #51#6 ] 8; |Y #51#6 [ 12;
           |CONTROL_SIMPLE 0, "LBOTON,F4 Relacion Comuneros", 1264, 1279, Boton4;
           nBoton4 = FSalida;
           |CONTROL_SIMPLE 0, "LBOTON,F6 Imp. Certificados ", 1564, 1579, Boton6;
           nBoton6 = FSalida;
       |FINSI;
   |FINSI;
|FPRC;

|RUTINA ClaveBaja53;
 #53#0 = #51#0;
 #53#1 = #51#1;
 #53#2 = 01;
 #53#3 = 00001;
|FRUT;

|RUTINA ClaveAlta53;
 #53#0 = #51#0;
 #53#1 = #51#1;
 #53#2 = 99;
 #53#3 = 99999;
|FRUT;

|RUTINA ClaveBaja52;
 #52#0 = #51#0;
 #52#1 = #51#1;
 #52#2 = 001;
|FRUT;

|RUTINA ClaveAlta52;
 #52#0 = #51#0;
 #52#1 = #51#1;
 #52#2 = 999;
|FRUT;

|RUTINA ClaveBaja61;
 #61#0 = #51#0;
 #61#1 = #51#1;
 #61#2 = "    ";
|FRUT;

|RUTINA ClaveAlta61;
 #61#0 = #51#0;
 #61#1 = #51#1;
 #61#2 = "zzzz";
|FRUT;

|PROCESO MTipo0;  |TIPO 0;
 |FIN_CONTROL_WINDOWS nBoton2;
 |FIN_CONTROL_WINDOWS nBoton5;
 |SI #51#6 = 2;  |O nRegis ! 0; ||Una Sociedad   |SI #51#4 = 2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton6;
 |SINO;
     |SI #51#6 ] 8; |Y #51#6 [ 12;
         |FIN_CONTROL_WINDOWS nBoton4;
         |FIN_CONTROL_WINDOWS nBoton6;
     |FINSI;
 |FINSI;
 |PULSATECLA;
 |SI nTecla = 10;
    |PUSHV 1201 2380;
    |ENTLINEAL #1#61, -3, 4, 22, 1, ClaveBaja61, ClaveAlta61;
    |POPV;
    |ERROR;
 |FINSI;
 |SI #51#6 = 2;  |O nRegis ! 0; ||Una Sociedad   |SI #51#4 = 2;
    |SI nTecla = 11;
        |PUSHV 1001 2380;
        |ENTLINEAL #1#52,-3, 2, 22, 1, ClaveBaja52, ClaveAlta52;
        |POPV;
        |ERROR;
    |FINSI;
    |SI nTecla = 14;
        enEmpresa = #51#0;
        enEjer    = #51#1;
        |SUB_EJECUTA_NP ":modelos/dsmoy051";
    |FINSI;
 |FINSI;
 |SI #51#6 ! 2;  |Y nRegis = 0; ||Una Sociedad   |SI #51#4 ! 2;
     |SI #51#6 ] 8; |Y #51#6 [ 12;
         |SI nTecla = 12;
             |PUSHV 1001 2380;
             |ENTLINEAL #1#53, -4, 4, 22, 1, ClaveBaja53, ClaveAlta53;
             |POPV;
             |ERROR;
         |FINSI;
         |SI nTecla = 14;
             enEmpresa = #51#0;
             enEjer    = #51#1;
             |SUB_EJECUTA_NP ":modelos/dsmoy051";
         |FINSI;
     |FINSI;
 |FINSI;
 |SI nTecla = 13;
     enEmpresa = #51#0;
     enEjer    = #51#1;
     |SUB_EJECUTA_NP ":modelos/dsmoy050";
 |FINSI;
|FPRC;

|CALCULO NomEmp;|TIPO 0;
 nTecla = FSalida;
 #51#3 = aNomEmpresa; |PINTA #51#3;
 |HAZ MTipo0;
|FCAL;

|PROCESO Boton2;
  |PTEC 824;
|FPRC;
|PROCESO Boton3;
  |PTEC 825;
|FPRC;
|PROCESO Boton4;
  |PTEC 826;
|FPRC;
|PROCESO Boton5;
  |PTEC 827;
|FPRC;
|PROCESO Boton6;
  |PTEC 828;
|FPRC;

|CALCULO AntesPatr; |TIPO 7;
 |SI #51#6 ! 2;  |Y nRegis = 0; ||  ... |SI #51#4 ! 2;
     |C_V #51#33,1,"S"; |C_M #51#33,1,"S"; |PINTA #51#33;
     |C_V #51#30,1,"S"; |C_V #51#31,1,"S"; |C_V #51#32,1,"S";
     |HAZ laAyu2;
 |SINO;
     |C_V #51#33,1,"N"; |C_M #51#33,1,"N";
     #51#33 = 0;
 |FINSI;
 |HAZ MTipo7;
|FCAL;

|CALCULO DespuesPatr; |TIPO 0;
 nTecla = FSalida;
 |SI #51#6 ! 2;  |Y nRegis = 0;  || |SI #51#4 ! 2;
     |POPV;
     |SI #51#33 = 0; #51#33 = 1; |PINTA #51#33; |FINSI;
 |FINSI;

 |SI #51#33 = 0;
     |C_V #51#30,1,"N";
     |C_V #51#31,1,"N";
     |C_V #51#32,1,"N";
     |PINTA 1613,"                                                                  ";
     |PINTA 1713,"                                                                  ";
     #51#30 = 0; #51#31 = 0; #51#32 = 0;
 |FINSI;

 |SI #51#33 = 1;
     |PINTA 1635,"Fondos Propios menos inmuebles:";
     |PINTA 1735,"        Valor de los inmuebles:";
     |C_P #51#30,0,nNume1; |C_P #51#31,0,nNume2;
     |ATRI D; |C_V #51#30,1,"S"; |PINTA nNume1,#51#30;
     |ATRI D; |C_V #51#31,1,"S"; |PINTA nNume2,#51#31;
 |FINSI;
 |SI #51#33 = 2;
     |PINTA 1635,"Fondos Propios:                              ";
     |PINTA 1713,"                                                                  ";
     |C_P #51#32,0,nNume1;
     |ATRI N; |C_V #51#32,1,"S"; |PINTA nNume1,#51#32;
 |FINSI;
 |HAZ MTipo0;
|FCAL;

|| **********************************************************************
|PROCESO PintaTotal; |TIPO 13;
 |C_V #99#5,1,"S"; |PINTA #99#5; |C_V #99#5,1,"N";
 |C_V #99#6,1,"S"; |PINTA #99#6; |C_V #99#6,1,"N";
 |C_V #99#7,1,"S"; |PINTA #99#7; |C_V #99#7,1,"N";
 |C_V #99#8,1,"S"; |PINTA #99#8; |C_V #99#8,1,"N";
 |C_V #99#9,1,"S"; |PINTA #99#9; |C_V #99#9,1,"N";
|FPRC;

|PROCESO NoAlta; |TIPO 0;
 nLnEstado = (FEntrada/ 100) ! 0;
 |SI nLnEstado ! 2;  |ERROR; |FINSI;
|FPRC;

|PROCESO NoBaja; |TIPO 1;
 nLnEstado = (FEntrada/ 100) ! 0;
 |SI nLnEstado ! 2;  |ERROR; |FINSI;
|FPRC;

|CALCULO laAyu1; |TIPO 7;
 |PUSHV 1326 2377;
 |CUADRO 1326 1977;
 |ATRI R;
 |PINTA 1427, " (1) Valores NO Exentos no negociados en mercados ";
 |PINTA 1527, " organizados, incluidos particip. en Cooperativas ";
 |PINTA 1627, " (2) Valores Exentos neg. en mercados organizados ";
 |PINTA 1727, " (3) Valores Exentos no  negociados  en  mercados ";
 |PINTA 1827, " organizados, incluidos particip. en Cooperativas ";
 |ATRI 0;
|FCAL;

|CALCULO QuiAyu1; |TIPO 0;
 |POPV;
|FCAL;

|CALCULO laAyu2;
 |PUSHV  1228 1563;
 |CUADRO 1228 1563;
 |ATRI R;
 |PINTA 1329, " (1) Bienes y Derechos no exentos ";
 |PINTA 1429, " (2) Bienes y Derechos exentos    ";
 |ATRI 0;
|FCAL;
