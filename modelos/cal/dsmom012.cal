|FICHEROS;
     dsmow006 #998;

     dsmom014 #14;
     dsmom011 #11;
     dsmom012 #12,MANTE;
     dsmopl12,MANTE;
|FIN;

|VARIABLES;
     aConcepto = "";
     nDosIntro = 0;
     nCampo    = 0;
     nCampo1   = 0;
     nTecla    = 0;
     nNume     = 0;
     &enCalculado = 0;
     nConte    = 0;
     nExis     = 0;

     nModo     = 0;
     aAlfa     = "";
     nAlta     = 0;
     &eaDCta   = "";
     &eaHCta   = "";
|FIN;

|INCLUYE i_variar;

|PROCESO DosIntrom012;  |TIPO 7;
     |SI nDosIntro = 0;
         |PTEC 802;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Tipo11m012;
|FPRC;

|PROCESO Sumapl12;
    nConte = nConte + #dsmopl12#8;
|FPRC;

|DEFBUCLE Sumapl12;
    #dsmopl12#1;
    ;
    #dsmom012#0, #dsmom012#1, #dsmom012#2, #dsmom012#3, #dsmom012#4, eaDCta;
    #dsmom012#0, #dsmom012#1, #dsmom012#2, #dsmom012#3, #dsmom012#4, eaHCta;
    e;
    NULL, Sumapl12;
|FIN;

|PROCESO Bajapl12;
    #dsmopl12#0 = #dsmom012#0;
    #dsmopl12#1 = #dsmom012#1;
    #dsmopl12#2 = #dsmom012#2;
    #dsmopl12#3 = #dsmom012#3;
    #dsmopl12#4 = #dsmom012#4;
    #dsmopl12#5 = eaDCta;
|FPRC;

|PROCESO Altapl12;
    #dsmopl12#0 = #dsmom012#0;
    #dsmopl12#1 = #dsmom012#1;
    #dsmopl12#2 = #dsmom012#2;
    #dsmopl12#3 = #dsmom012#3;
    #dsmopl12#4 = #dsmom012#4;
    #dsmopl12#5 = eaHCta;
|FPRC;

|PROCESO Verpl12;
    nAlta = 0;
    |ABRE #dsmopl12;
    #dsmopl12#0 = #dsmom012#0;
    #dsmopl12#1 = #dsmom012#1;
    #dsmopl12#2 = #dsmom012#2;
    #dsmopl12#3 = #dsmom012#3;
    #dsmopl12#4 = #dsmom012#4;
    #dsmopl12#5 = #dsmom012#5;
    |LEE 041#dsmopl12.];
    |SI FSalida ! 0;
        nAlta = 1;
    |SINO;
        aAlfa = #dsmopl12#5 % 104;
        |SI aAlfa ! #dsmom012#5;
            nAlta = 1;
        |FINSI;
    |FINSI;
    |SI nAlta = 1; |Y #dsmom012#8 ! 0;
        #dsmopl12#0 = #dsmom012#0;
        #dsmopl12#1 = #dsmom012#1;
        #dsmopl12#2 = #dsmom012#2;
        #dsmopl12#3 = #dsmom012#3;
        #dsmopl12#4 = #dsmom012#4;
        #dsmopl12#5 = #dsmom012#5;
        #dsmopl12#6 = #dsmom012#6;
        #dsmopl12#7 = #dsmom012#7;
        #dsmopl12#8 = #dsmom012#8;
        |GRABA 041#dsmopl12.n;
    |FINSI;
    |CIERRA #dsmopl12;

    |SI #998#60 = "X"; |Y nModo ! 4;
        |MENAV "    Modificar Importes por Introduccion Datos Agrupados";
        nModo = 4;
    |FINSI;

    eaDCta = #dsmom012#5;
    eaHCta = #dsmom012#5 + "zzzzzzzz";

    |PUSHV 0501 2380;
    |PINPA #0#dsmopl12;
    |PINTA 2069, #dsmom012#8;
    |ENTLINEAL #1#dsmopl12, -6, nModo, 18, 0, Bajapl12, Altapl12;
    |POPV;

    nConte = 0;
    |BUCLE Sumapl12;
    #dsmom012#8 = nConte; |PINTA #dsmom012#8;
|FPRC;

|PROCESO NoPasom012;  |TIPO 7;
     |ABRE #14;
     |SELECT #2#14;
     #14#10 = enPlan14;
     #14#5  = #12#5;
     |LEE 040#14=;
     |SI FSalida = 0;
         |MENSA "    Pulse <F2> para Introduccion de Existencias, <F5> Calculadora ";
     |SINO;
         |MENSA "    Pulsa <F5> Calculadora ";
     |FINSI;

     |SELECT #1#14;
     #14#10 = enPlan14;
     #14#0  = #12#5;
     |LEE 040#14=;
     |SI FSalida ! 0;  |DDEFECTO #14;  |FINSI;
     |CIERRA #14;

     eaCta60 = #dsmom012#5;
     eaTip60 = "G";
     |HAZ HayDesglose60;
     nModo = 2;

     |C_M #12#8,  1, "S";
     |SI #14#6 = "N";
         |C_M #12#8,  1, "N";
         nModo = 4;
     |FINSI;

     |SI enEjer ] 2019; |Y enDesglose60 = 1;
         |HAZ Verpl12;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja11_2;
     #11#0  = #12#0;
     #11#1  = #12#1;
     #11#2  = #12#2;
     #11#3  = #12#3;
     #11#4  = #12#4;
     #11#10 = #12#5;
     #11#5  = "    ";
|FRUT;

|RUTINA ClaveAlta11_2;
     #11#0  = #12#0;
     #11#1  = #12#1;
     #11#2  = #12#2;
     #11#3  = #12#3;
     #11#4  = #12#4;
     #11#10 = #12#5;
     #11#5  = "zzzz";
|FRUT;

|PROCESO PonExistencias;
     #12#8 = #12#8 + (#11#8 - #11#9);
|FPRC;

|DEFBUCLE dsmom011;
     #11#2;
     ;
     #12#0, #12#1, #12#2, #12#3, #12#4, #12#5, "    ";
     #12#0, #12#1, #12#2, #12#3, #12#4, #12#5, "zzzz";
     ;
     NULL, PonExistencias;
|FIN;

|PROCESO Teclam012;
     nTecla = FSalida;
     nConte = Contenido;

     |SI nTecla = 13;
         enCalculado = #12#8;
         |HAZ Calculadora;
         #12#8 = enCalculado;
         |PINTA #12#8;
     |FINSI;

     nExis = 0;
     |ABRE #14;
     |SELECT #2#14;
     #14#10 = enPlan14;
     #14#5  = #12#5;
     |LEE 040#14=;
     |SI FSalida = 0;
         nExis = 1;
         |SI nTecla = 10;
             |PUSHV 0501 2380;
             nDosIntro = 0;
             |HAZ Descarga11;
             |ENTLINEAL #2#11, -7, 2, 22, 1, ClaveBaja11_2, ClaveAlta11_2;
             |POPV;
             |CIERRA #14;

             #12#8 = 0;
             |BUCLE dsmom011;
             |PINTA #12#8;

             |ERROR;
             |ACABA;
         |SINO;
             #12#8 = 0;
             |BUCLE dsmom011;
             |PINTA #12#8;
         |FINSI;
     |FINSI;
     |CIERRA #14;

     |SI nTecla = 2;
         |PTEC 802;
         |PTEC 802;
         |PTEC 808;

         aConcepto = "";
         nDosIntro = 1;
         |ACABA;
     |FINSI;

     |SI nTecla = 1;
         |PTEC 806;
         nDosIntro = 1;
         aConcepto = #12#5;
         |ACABA;
     |FINSI;

     |SI aConcepto = #12#5;
         |ERROR;
         aConcepto = "";
     |SINO;
         nDosIntro = 0;
         aConcepto = #12#5;
     |FINSI;

     |SI #998#60 = "X";
         |SI nExis = 0;
             |SI #12#8 ! nConte;
                 |MENAV "    Modificar Importes por Introduccion Datos Agrupados";
             |FINSI;
             #12#8 = nConte; |PINTA #12#8;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo2m012;  |TIPO 2;
     |ABRE #14;
     |SELECT #2#14;
     #14#10 = enPlan14;
     #14#5  = #12#5;
     |LEE 040#14=;
     |SI FSalida = 0;
         |SI #12#7 = "+";
             #998#58 = #998#58 +. #12#8;
         |SINO;
             #998#58 = #998#58 -. #12#8;
         |FINSI;
     |SINO;
         |SI #12#7 = "+";
             #998#20 = #998#20 +. #12#8;
         |SINO;
             #998#20 = #998#20 -. #12#8;
         |FINSI;
     |FINSI;

     nNume = #998#45;
     #998#45 = #998#20 + #998#58;
     |ATRI S;  |PINTA 2269, #998#45;  |ATRI s;
     #998#45 = nNume;

     |SELECT #1#14;
|FPRC;

|PROCESO Descarga12;
     nDosIntro = 0;
|FPRC;
