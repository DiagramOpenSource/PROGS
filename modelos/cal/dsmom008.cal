|FICHEROS;
     dsmom003;
     dsmom004,MANTE;
     dsmom008,MANTE;
     dsmom024;
     dsmom107;

     :basica/agitab99;

     &clientes@;
|FIN;

|VARIABLES;
     aAlfa    = "";
     aPres    = "";

     nBoton1  = 0;
     nBoton2  = 0;
     nBoton3  = 0;
     nBoton4  = 0;
     nBoton5  = 0;
     nBoton6  = 0;
     nBoton7  = 0;
     nBoton8  = 0;
     nBoton9  = 0;
     nBoton10 = 0;
     nBoton12 = 0;
     nBoton13 = 0;
     nBoton14 = 0;

     nSwBoton2  = 0;
     nSwBoton3  = 0;
     nSwBoton4  = 0;
     nSwBoton5  = 0;
     nSwBoton6  = 0;
     nSwBoton7  = 0;
     nSwBoton8  = 0;
     nSwBoton9  = 0;
     nSwBoton10 = 0;
     nSwBoton12 = 0;
     nSwBoton13 = 0;
     nSwBoton14 = 0;

     nTecla   = 0;
     nSwPregunta = 0;

{-1} aMenu310 = "";
     aMenu3101     = "2400";
     aMenu3102     = "1";
     aMenu3103     = "";
     aMenu3104     = "MC";
     aMenu3105     = " Modulo ";
     aMenu3106     = " IVA Deducible ";

{-1} aMenu131 = "";
     aMenu1311     = "2400";
     aMenu1312     = "1";
     aMenu1313     = "";
     aMenu1314     = "MC";
     aMenu1315     = "Modulo  ";
     aMenu1316     = "  Retenciones ";

     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDEjer    = 0;
     &enHEjer    = 0;
     &enDModelo  = 0;
     &enHModelo  = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO BorraFicPlanoInternet;
     eaPathInternet = eaUnidad + "/AEAT";                             |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";                   |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + #dsmom004#3;                    |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + #dsmom004#1;                    |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + (("00" + #dsmom004#2) % -102);  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |SI #dsmom004#3 = 110;
         aAlfa = eaPathInternet + "110" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         aAlfa = eaPathInternet + "111" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         |ACABA;
     |FINSI;

     |SI #dsmom004#3 = 180;
         aAlfa = eaPathInternet + "RTP" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         |ACABA;
     |FINSI;

     |SI #dsmom004#3 = 340;
         aAlfa = eaPathInternet + "fic" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         |ACABA;
     |FINSI;

     |SI #dsmom004#3 = 347;
         aAlfa = eaPathInternet + "OPA" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         |ACABA;
     |FINSI;

     |SI #dsmom004#3 = 370;
         aAlfa = eaPathInternet + "370" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         aAlfa = eaPathInternet + "371" + (("00000" + #dsmom004#0) % -105) + ".TXT";
         |RFBORRA aAlfa;

         |ACABA;
     |FINSI;

     aAlfa = eaPathInternet + #dsmom004#3 + (("00000" + #dsmom004#0) % -105) + ".TXT";
     |RFBORRA aAlfa;
|FPRC;

|| \\\\\ Alta o Modificacion Modelos ////////
|PROCESO BorraElHis8;
    |ABRE #dsmom024;
    #dsmom024#0 = #dsmom004#0;
    #dsmom024#1 = #dsmom004#1;
    #dsmom024#2 = #dsmom004#2;
    #dsmom024#3 = #dsmom004#3;
    #dsmom024#4 = #dsmom004#4;
    |LEE 040#dsmom024.=;
    |SI FSalida = 0;
        |BORRA 020#dsmom024.a;
        |CIERRA #dsmom024;
        enDEmpresa = #dsmom024#0; enHEmpresa = #dsmom024#0;
        enDEjer    = #dsmom024#1; enHEjer    = #dsmom024#1;
        enDModelo  = #dsmom024#3; enHModelo  = #dsmom024#3;;
        |HAZ ReCalculaHis;
    |SINO;
        |CIERRA #dsmom024;
    |FINSI;
|FPRC;

|PROCESO AltaModelo8;
     |SI #dsmom008#7 = "COMUNIDAD ";
         |MENAV "     Comunero, Modifique la Comunidad.";
         |ACABA;
     |FINSI;

     |SI #dsmom008#3 = 349;  |O #dsmom008#3 = 110;  |O #dsmom008#3 = 115;  |O #dsmom008#3 = 123;
      |O #dsmom008#3 = 216;  |O #dsmom008#3 = 340;
         |LEE 101#dsmom008.=;
         |SI FSalida = 0;
             |SI #dsmom008#7 = "PLANILLAS ";  #dsmom008#7 = "MANUAL";  |FINSI;
             |SI #dsmom008#7 = "MODULOS   ";  #dsmom008#7 = "MANUAL";  |FINSI;
             |GRABA 020#dsmom008.a;
             |LIBERA #dsmom008;
         |FINSI;
     |FINSI;

     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     |SI #dsmom008#7 = "REGISTROS ";  |Y #dsmom107#3 = "N";
         |MENAV "     Los datos vienen de Contabilidad, No puedo dejarle entrar datos";
         |ACABA;
     |FINSI;

     |SI #dsmom004#11 = "X";
         |MENAV "     Modelo ya Remesado. No se puede Modificar";
         |ACABA;
     |FINSI;

     aPres = #dsmom004#26;  |QBF aPres;
     |SI aPres ! "";
         |MENAV "     Modelo ya presentado en AEAT. No se puede Modificar";
         |ACABA;
     |FINSI;

     |SI #dsmom004#13 = "X";
         |MENAV "     Modelo ya Archivado. No se puede Modificar";
         |ACABA;
     |FINSI;

     |SI #dsmom004#9 = "X"; |Y #dsmom008#7 ! "PLANILLAS ";
         |CONFI "0000NModelo ya impreso, ¨desea modificarlo?. El modelo se quedara no impreso";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
         |MENAV "0000Recuerde. Imprima otra vez el Modelo para recoger las modificaciones realizadas";

         |HAZ BorraFicPlanoInternet;
         FSalida = 0;
     |FINSI;

     enModi310 = 0;
     enModi131 = 0;
     |SI #dsmom008#7 ! "MANUAL    ";
         |SI #dsmom008#5 > 0;
             |SI #dsmom008#7 = "PLANILLAS ";  |Y  #dsmom008#4 = 0;
                 enEmpresa = #dsmom008#0;
                 enPeriodo = #dsmom008#2;
                 enEjer    = #dsmom008#1;
                 eaNomPer  = #dsmom003#3;  |QBF eaNomPer;
                 |SI eaNomPer = "";
                     |ABRE #dsmom003;
                     #dsmom003#0 = #dsmom008#0;
                     #dsmom003#1 = #dsmom008#1;
                     #dsmom003#2 = #dsmom008#2;
                     |LEE 000#dsmom003.=;
                     |SI FSalida ! 0;  |DDEFECTO #dsmom003;  |FINSI;
                     |CIERRA #dsmom003;

                     eaNomPer  = #dsmom003#3;  |QBF eaNomPer;
                 |FINSI;

                 |SUB_EJECUTA_NP "dsmoz004";
                 |ACABA;
             |FINSI;

             |SI #dsmom008#7 = "MODULOS   ";
                 |SI #dsmom008#12 = 310;
                     |MENU aMenu310;
                     aMenu3102 = FSalida;
                     |SI aMenu3102 = "1";
                         enEmpresa = #dsmom008#0;
                         enEjer    = #dsmom008#1;
                         |SUB_EJECUTA_NP "dsmoz005";
                         |ACABA;
                     |FINSI;

                     |SI aMenu3102 = "2";  enModi310 = 1;  |FINSI;

                     |SI aMenu3102 ! "1";  |Y aMenu3102 ! "2";
                         |ACABA;
                     |FINSI;

                     |SI enModi310 = 0;
                         |MENAV "      No se puede dar de Alta o Modificar, viene de un Traspaso";
                         |ACABA;
                     |FINSI;
                 |FINSI;

                 |SI #dsmom008#12 = 131;
                     |MENU aMenu131;
                     aMenu1312 = FSalida;
                     |SI aMenu1312 = "1";
                         enEmpresa = #dsmom008#0;
                         enEjer    = #dsmom008#1;
                         |SUB_EJECUTA_NP "dsmoz005";
                         |ACABA;
                     |FINSI;

                     |SI aMenu1312 = "2";  enModi131 = 1;  |FINSI;

                     |SI aMenu1312 ! "1";  |Y aMenu1312 ! "2";
                         |ACABA;
                     |FINSI;

                     |SI enModi131 = 0;
                         |MENAV "      No se puede dar de Alta o Modificar, viene de un Traspaso";
                         |ACABA;
                     |FINSI;
                  |FINSI;
             |FINSI;
         |SINO;
             |MENAV "      No se puede dar de Alta o Modificar el Registro de Impresion";
             ||ACABA;
         |FINSI;
     |FINSI;

     |SI #dsmom008#3 = 349;  |Y #dsmom008#5 ! 0;
         ||MENAV "      No se puede dar de Alta o Modificar el Registro, hagalo desde registros de IVA";
         ||ACABA;
     |FINSI;

     enTipoEntrada = 1;

     |SI #dsmom008#7 = "REGISTROS ";  |Y #dsmom107#3 = "S";  |Y #dsmom008#3 = 130;
         enTipoEntrada = 111;
     |FINSI;
     eaCaptura = #dsmom008#7;
     |HAZ EntraModelo;    || Esta en el PLB

     |SI enEntrada = 1;   |O enEntrada = 111;
         |LEE 101#dsmom004.=;
         |SI #dsmom004#9 = "X";
             |HAZ BorraElHis8;
         |FINSI;
         #dsmom004#7  = "X";
         #dsmom004#8  = ~;
         #dsmom004#9  = " ";
         #dsmom004#10 = "01.01.0000";
         #dsmom004#15 = enResultado;
         #dsmom004#17 = "COMPLETADO";
         aAlfa = #dsmom004#16;  |QBT aAlfa;
         |SI aAlfa ! "";
             |HAZ UltimoPeriodo;
             #dsmom004#16 = eaUltimoPer;
         |FINSI;
         |GRABA 020#dsmom004.a;
         |LIBERA #dsmom004;

         |LEE 101#dsmom008.=;
         #dsmom008#11 = "COMPLETADO"
         |GRABA 020#dsmom008.a;
         |LIBERA #dsmom008;
      |FINSI;
|FPRC;

|| \\\\\ Recoge Modelo ////////

|PROCESO RecogeModelo;
     |SI enAnterior = 0;
         |SI #dsmom008#3 ! 110;  |Y #dsmom008#3 ! 115;  |Y #dsmom008#3 ! 123; |Y #dsmom008#3 ! 216;
             |SI #dsmom008#5 = 99;
                 |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 320;  |O #dsmom008#3 = 330;  |O #dsmom008#3 = 332;
                  |O #dsmom008#3 = 370;  |O #dsmom008#3 = 303;  |O #dsmom008#3 = 322;
                     |SI #dsmom008#3 = 303; |O #dsmom008#3 = 322;
                         |SI #dsmom004#22 = "T";
                             |SI #dsmom008#2 = 3;  |ACABA;  |FINSI;
                         |SINO;
                             |SI #dsmom008#2 = 1;  |ACABA;  |FINSI;
                         |FINSI;
                     |SINO;
                         |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 370;
                             |SI #dsmom008#2 = 3;  |ACABA;  |FINSI;
                         |SINO;
                             |SI #dsmom008#2 = 1;  |ACABA;  |FINSI;
                         |FINSI;
                     |FINSI;
                 |SINO;
                     |SI #dsmom008#7 ! "REGISTROS ";  |ACABA;  |FINSI;
                 |FINSI;
             |SINO;
                 |SI #dsmom008#7 ! "REGISTROS ";
                     |SI #dsmom008#3 = 370;
                         |SI #dsmom008#12 ! 310;  |ACABA;  |FINSI;
                     |SINO;
                         |SI #dsmom008#12 ! 310;  |Y #dsmom008#3 ! 349;
                             |ACABA;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |ABRE #agitab99;
     #agitab99#0 = enModelo;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;
     |CIERRA #agitab99;

     |SI #agitab99#4 = "N";
         |MENAV "     Modelo sin Activar el Pase de Registro.";
         |ERROR;
     |FINSI;

     |SI #dsmom004#11 = "X";
         |MENAV "     Modelo ya Remesado. No se puede Recoger Datos";
         |ACABA;
     |FINSI;

     aPres = #dsmom004#26;  |QBF aPres;
     |SI aPres ! "";
         |MENAV "     Modelo ya presentado en AEAT. No se puede Recoger Datos";
         |ACABA;
     |FINSI;

     |SI #dsmom004#13 = "X";
         |MENAV "     Modelo ya Archivado. No se puede Recoger Datos";
         |ACABA;
     |FINSI;

     nSwPregunta = 0;
     |SI #dsmom004#9 = "X";
         |CONFI "0000NModelo ya impreso, ¨desea realizar el pase?. El modelo se quedara no impreso";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nSwPregunta = 1;
         FSalida = 0;

         |HAZ BorraFicPlanoInternet;
         FSalida = 0;
     |FINSI;

     |SI #dsmom008#3 = 300;  |Y enAnterior = 1;
         nSwPregunta = 1;
     |FINSI;

     |SI #dsmom008#3 = 303;  |Y enAnterior = 1;
         nSwPregunta = 1;
     |FINSI;

     |SI #dsmom008#3 = 322;  |Y enAnterior = 1;
         nSwPregunta = 1;
     |FINSI;

     |SI nSwPregunta = 0;
         |CONFI "0000SDesea Realizar el Pase en estos momentos ";
     |FINSI;

     |SI FSalida = 0;
         |LEE 101#dsmom004.=;
         #dsmom004#7  = "X";
         #dsmom004#8  = ~;
         #dsmom004#9  = " ";
         #dsmom004#10 = "01.01.0000";
         #dsmom004#15 = enResultado;
         #dsmom004#17 = "COMPLETADO";
         aAlfa = #dsmom004#16;  |QBT aAlfa;
         |SI aAlfa ! "";
             |HAZ UltimoPeriodo;
             #dsmom004#16 = eaUltimoPer;
         |FINSI;
         |GRABA 020#dsmom004.a;
         |LIBERA #dsmom004;

         enModelo1 = #dsmom008#12;
         |SI #dsmom004#3 = "130";
             enTipoEntrada = 11;
             |HAZ EntraModelo;
             |LEE 101#dsmom008.=;
             #dsmom008#11 = "COMPLETADO"
             |GRABA 020#dsmom008.a;
             |LIBERA #dsmom008;
         |SINO;
             |SUB_EJECUTA_NP "dsmozpas";
         |FINSI;
     |FINSI;
|FPRC;

|| \\\\\ Baja del Modelo ////////

|PROCESO BajaModelo8;
     |SI #dsmom008#7 = "PLANILLAS ";
         |SI #dsmom008#4 = 0;
             |MENAV "     El registro proviene de un Traspaso, no puedo darlo de Baja";
             |ACABA;
         |FINSI;
     |SINO;
         |SI #dsmom008#7 ! "MANUAL    ";  |Y #dsmom008#7 ! "REGISTROS "; |Y #dsmom008#7 ! "MODULOS   ";
           |Y #dsmom008#3 ! 110;  |Y #dsmom008#3 ! 115; |Y #dsmom008#3 ! 123; |Y #dsmom008#3 ! 216;
             |MENAV "     El registro proviene de un Traspaso, no puedo darlo de Baja";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #dsmom004#11 = "X";
         |MENAV "     Modelo ya Remesado. No se puede dar de Baja";
         |ACABA;
     |FINSI;

     aPres = #dsmom004#26;  |QBF aPres;
     |SI aPres ! "";
         |MENAV "     Modelo ya presentado en AEAT. No se puede dar de Baja";
         |ACABA;
     |FINSI;

     |SI #dsmom004#13 = "X";
         |MENAV "     Modelo ya Archivado. No se puede dar de Baja";
         |ACABA;
     |FINSI;

     |SI #dsmom004#9 = "X";
         |CONFI "0000NModelo ya impreso, Esta Seguro de la Baja : ";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |HAZ BorraFicPlanoInternet;
         FSalida = 0;
     |SINO;
         |CONFI "0000NEsta seguro de dar de Baja el Modelo ";
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;
     |FINSI;

     enTipoEntrada = 3;
     |HAZ EntraModelo;   || Esta en el PLB

     |LEE 101#dsmom008.=;
     #dsmom008#11 = "SIN DATOS";
     |GRABA 020#dsmom008.a;
     |LIBERA #dsmom008;
|FPRC;

|PROCESO Boton2m008;
     |PTEC 824;
|FPRC;

|PROCESO Boton3m008;
     |PTEC 825;
|FPRC;

|PROCESO Boton4m008;
     |PTEC 826;
|FPRC;

|PROCESO Boton5m008;
     |PTEC 827;
|FPRC;

|PROCESO Boton6m008;
     |PTEC 828;
|FPRC;

|PROCESO Boton7m008;
     |PTEC 829;
|FPRC;

|PROCESO Boton8m008;
     |PTEC 830;
|FPRC;

|PROCESO Boton9m008;
     |PTEC 831;
|FPRC;

|PROCESO Boton10m008;
     |PTEC 832;
|FPRC;

|PROCESO Boton12m008;
     |PTEC 834;
|FPRC;

|PROCESO Boton13m008;
     |PTEC 835;
|FPRC;

|PROCESO Boton14m008;
     |PTEC 962;  || Ctrl-A
|FPRC;

|PROCESO FinBotonm008;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;
     |FIN_CONTROL_WINDOWS nBoton8;
     |FIN_CONTROL_WINDOWS nBoton9;
     |FIN_CONTROL_WINDOWS nBoton10;
     |FIN_CONTROL_WINDOWS nBoton12;
     |FIN_CONTROL_WINDOWS nBoton13;
     |FIN_CONTROL_WINDOWS nBoton14;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo0m008;  |TIPO 0;
     |HAZ FinBotonm008;
|FPRC;

|PROCESO Tipo7m008;  |TIPO 7;
     |BLIN 04;

     |CONTROL_SIMPLE 0, "LBOTON,F2 Consulta Modelo             ", 0902, 0926, Boton2m008;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F3 Entrada Modelo              ", 1002, 1026, Boton3m008;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F4 Entrada Planilla/Modulos    ", 1102, 1126, Boton4m008;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F5 Recoger NIF's Regul.Anterior", 1202, 1226, Boton5m008;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F6 Compensar Regularizacion    ", 0928, 0952, Boton6m008;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F7 Recoger Datos               ", 1028, 1052, Boton7m008;
     nBoton7 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F8 Baja Datos                  ", 1128, 1152, Boton8m008;
     nBoton8 = FSalida;

     aAlfa = "LBOTON,F9 Datos Periodo Anterior      ";
     |SI #dsmom008#1 ] 2011; |Y #dsmom008#3 = 110; |Y #dsmom008#4 > 00;
         aAlfa = "LBOTON,F9 Datos Declaracion Anterior  ";
     |FINSI;
     |SI #dsmom008#1 ] 2014; |Y #dsmom008#3 = 303; |Y #dsmom008#4 > 00;
         aAlfa = "LBOTON,F9 Datos Declaracion Anterior  ";
     |FINSI;
     |SI #dsmom008#1 ] 2014; |Y #dsmom008#3 = 322; |Y #dsmom008#4 > 00;
         aAlfa = "LBOTON,F9 Datos Declaracion Anterior  ";
     |FINSI;
     |CONTROL_SIMPLE 0, aAlfa, 1228, 1252, Boton9m008;
     nBoton9 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F10 C.Prorrata Definitiva ", 0954, 0980, Boton10m008;
     nBoton10 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F12 C.Prorrata Provisional", 1054, 1080, Boton12m008;
     nBoton12 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,Ctrl-F3 Intr.Rendimiento Ej.Anterior", 1154, 1180, Boton13m008;
     nBoton13 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,Ctrl-A Importacion desde hoja EXCEL", 1254, 1280, Boton14m008;
     nBoton14 = FSalida;

     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     |ESTADO_CONTROL nBoton2, "DISABLE";  nSwBoton2 = 0;
     |ESTADO_CONTROL nBoton3, "DISABLE";  nSwBoton3 = 0;
     |ESTADO_CONTROL nBoton4, "DISABLE";  nSwBoton4 = 0;
     |ESTADO_CONTROL nBoton5, "DISABLE";  nSwBoton5 = 0;
     |ESTADO_CONTROL nBoton6, "DISABLE";  nSwBoton6 = 0;
     |ESTADO_CONTROL nBoton7, "DISABLE";  nSwBoton7 = 0;
     |ESTADO_CONTROL nBoton8, "DISABLE";  nSwBoton8 = 0;
     |ESTADO_CONTROL nBoton9, "DISABLE";  nSwBoton9 = 0;
     |ESTADO_CONTROL nBoton10, "DISABLE"; nSwBoton10 = 0;
     |ESTADO_CONTROL nBoton12, "DISABLE"; nSwBoton12 = 0;
     |ESTADO_CONTROL nBoton13, "DISABLE"; nSwBoton13 = 0;
     |ESTADO_CONTROL nBoton14, "DISABLE"; nSwBoton14 = 0;

     |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 370;  |O #dsmom008#3 = 320;
      |O #dsmom008#3 = 330;  |O #dsmom008#3 = 332;  |O #dsmom008#3 = 303;
        |O #dsmom008#3 = 322;
         |SI enSwProrr ! 2;
             |SI #dsmom008#2 = 12;
                 |ESTADO_CONTROL nBoton10,  "ENABLE";  nSwBoton10 = 1;
             |SINO;
                 |ESTADO_CONTROL nBoton12,  "ENABLE";  nSwBoton12 = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmom008#5 = 0;
         |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
         |SI #dsmom008#1 ] 2015; |Y #dsmom008#7 ! "COMUNIDAD ";
             |SI #dsmom008#3 = 130;  |O #dsmom008#3 = 131;
                 |ESTADO_CONTROL nBoton13, "ENABLE";  nSwBoton13 = 1;
             |FINSI;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #dsmom008#3 = 349;
         |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
         |ESTADO_CONTROL nBoton3, "ENABLE";  nSwBoton3 = 1;
         |ESTADO_CONTROL nBoton8, "ENABLE";  nSwBoton8 = 1;

         |SI #dsmom008#7 = "REGISTROS ";
             |ESTADO_CONTROL nBoton7,  "ENABLE";  nSwBoton7  = 1;
         |FINSI;

         |SI #dsmom008#11 ! "COMPLETADO  "
             |ESTADO_CONTROL nBoton14, "ENABLE";  nSwBoton14 = 1;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #dsmom008#3 = 110;  |O #dsmom008#3 = 115;  |O #dsmom008#3 = 123; |O #dsmom008#3 = 216;
         |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
         |ESTADO_CONTROL nBoton3, "ENABLE";  nSwBoton3 = 1;

         |SI #dsmom008#5 ! 99;
             |ESTADO_CONTROL nBoton7, "ENABLE";  nSwBoton7 = 1;

             |SI #dsmom008#3 = 115; |O #dsmom008#3 = 123; |O #dsmom008#3 = 216;
                 |ESTADO_CONTROL nBoton9, "ENABLE";  nSwBoton9 = 1;
             |FINSI;
         |SINO;
             |ESTADO_CONTROL nBoton5, "ENABLE";  nSwBoton5 = 1;
         |FINSI;

         |SI #dsmom008#1 ] 2011; |Y #dsmom008#3 = 110; |Y #dsmom008#4 > 00; |Y #dsmom008#5 ! 0;
             |ESTADO_CONTROL nBoton9, "ENABLE";  nSwBoton9 = 1;
         |FINSI;

         |ESTADO_CONTROL nBoton8, "ENABLE";  nSwBoton8 = 1;
         |ACABA;
     |FINSI;

     |SI #dsmom008#5 ! 0;
         |SI #dsmom008#7 = "COMUNIDAD ";
             |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
             |ACABA;
         |FINSI;

         |SI #dsmom008#7 = "MODULOS   ";
             |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
             |ESTADO_CONTROL nBoton4, "ENABLE";  nSwBoton4 = 1;
             |ESTADO_CONTROL nBoton8, "ENABLE";  nSwBoton8 = 1;

             |SI #dsmom008#3 = 310;  |O #dsmom008#12 = 310;
                 |ESTADO_CONTROL nBoton7, "ENABLE";  nSwBoton7 = 1;
             |FINSI;

             |ACABA;
         |FINSI;

         |SI #dsmom008#7 = "PLANILLAS ";
             |SI #dsmom008#4 = 0;
                 |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
                 |ESTADO_CONTROL nBoton4, "ENABLE";  nSwBoton4 = 1;
             |SINO;
                 |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
                 |ESTADO_CONTROL nBoton3, "ENABLE";  nSwBoton3 = 1;
                 |ESTADO_CONTROL nBoton8, "ENABLE";  nSwBoton8 = 1;
             |FINSI;

             |ACABA;
         |FINSI;

         |SI #dsmom008#7 = "MANUAL    ";
             |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
             |ESTADO_CONTROL nBoton3, "ENABLE";  nSwBoton3 = 1;
             |ESTADO_CONTROL nBoton8, "ENABLE";  nSwBoton8 = 1;

             |SI #dsmom008#5 = 99;
                 |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 320;  |O #dsmom008#3 = 330;  |O #dsmom008#3 = 332;  |O #dsmom008#3 = 370;
                     |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 370;
                         |SI #dsmom008#2 ! 3;
                             |ESTADO_CONTROL nBoton6, "ENABLE";  nSwBoton6 = 1;
                         |FINSI;
                     |SINO;
                         |SI #dsmom008#2 ! 1;
                             |ESTADO_CONTROL nBoton6, "ENABLE";  nSwBoton6 = 1;
                         |FINSI;
                     |FINSI;
                 |FINSI;

                 |SI #dsmom008#3 = 303; |O #dsmom008#3 = 322;
                     |SI #dsmom004#22 = "T";
                         |SI #dsmom008#2 ! 3;
                             |ESTADO_CONTROL nBoton6, "ENABLE";  nSwBoton6 = 1;
                         |FINSI;
                     |SINO;
                         |SI #dsmom008#2 ! 1;
                             |ESTADO_CONTROL nBoton6, "ENABLE";  nSwBoton6 = 1;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |SINO;
                 |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 303; |O #dsmom008#3 = 322;
                     |SI #dsmom008#4 = 0;
                         |ESTADO_CONTROL nBoton9, "ENABLE";  nSwBoton9 = 1;
                     |FINSI;
                 |FINSI;
             |FINSI;

             |SI #dsmom008#1 ] 2014; |Y #dsmom008#3 = 303; |Y #dsmom008#4 > 00; |Y #dsmom008#5 ! 0;
                 |ESTADO_CONTROL nBoton9, "ENABLE";  nSwBoton9 = 1;
             |FINSI;
             |SI #dsmom008#1 ] 2014; |Y #dsmom008#3 = 322; |Y #dsmom008#4 > 00; |Y #dsmom008#5 ! 0;
                 |ESTADO_CONTROL nBoton9, "ENABLE";  nSwBoton9 = 1;
             |FINSI;

             |ACABA;
         |FINSI;

         |SI #dsmom008#7 = "REGISTROS ";
             |ESTADO_CONTROL nBoton7, "ENABLE";  nSwBoton7 = 1;
             |ESTADO_CONTROL nBoton2, "ENABLE";  nSwBoton2 = 1;
             |ESTADO_CONTROL nBoton8, "ENABLE";  nSwBoton8 = 1;

             |SI #dsmom008#3 = 340;
                 |ESTADO_CONTROL nBoton7, "DISABLE";  nSwBoton7 = 0;
             |FINSI;

             |SI #dsmom107#3 = "S";
                 |ESTADO_CONTROL nBoton3, "ENABLE";  nSwBoton3 = 1;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo11m008;  |TIPO 11;
     nTecla = FSalida;

     |HAZ FinBotonm008;

     enEmpresa     = #dsmom008#0;
     enEjer        = #dsmom008#1;
     enPeriodo     = #dsmom008#2;
     enModelo      = #dsmom008#3;
     enComplem     = #dsmom008#4;
     enActividad   = #dsmom008#5;
     eaComunidad   = #dsmom008#9;
     eaComunero    = #dsmom008#10;
     eaCaptura     = #dsmom008#7;
     eaNombreAct   = #dsmom008#6;

|| \\\\\ Consulta Modelos ////////

     |SI nTecla = 10;  |Y nSwBoton2 = 1;
         enTipoEntrada = 4;
         |HAZ EntraModelo;    || Esta en el PLB
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Alta o Modificacion Modelos ////////

     |SI nTecla = 11;  |Y nSwBoton3 = 1;
         |HAZ AltaModelo8;
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Alta o Modificacion Planillas y Modulos ////////

     |SI nTecla = 12;  |Y nSwBoton4 = 1;
         |HAZ AltaModelo8;
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Recoger NIF Regularizacion Anterior ////////

     |SI nTecla = 13;  |Y nSwBoton5 = 1;
         enAnterior = 1;
         |HAZ RecogeModelo;
         |HAZ Refresco;
         enAnterior = 0;
     |FINSI;

|| \\\\\ Compensar Regularizacion ////////

     |SI nTecla = 14;  |Y nSwBoton6 = 1;
         |HAZ RecogeModelo;
         |HAZ Refresco;
         enAnterior = 0;
     |FINSI;

|| \\\\\ Recoger Datos ////////

     |SI nTecla = 15;  |Y nSwBoton7 = 1;
         |HAZ RecogeModelo;
         |HAZ Refresco;
         enAnterior = 0;
     |FINSI;

|| \\\\\ Baja Modelos ////////

     |SI nTecla = 16;  |Y nSwBoton8 = 1;
         |HAZ BajaModelo8;
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Recoger Datos Perido Anterior ////////

     |SI nTecla = 17;  |Y nSwBoton9 = 1;
         |SI #dsmom008#3 = 115; |O #dsmom008#3 = 123; |O #dsmom008#3 = 216;
             enAnterior = 1;
             |HAZ RecogeModelo;
             |HAZ Refresco;
             enAnterior = 0;
         |FINSI;

         |SI #dsmom008#3 = 110;
             enAnterior = 2;
             |HAZ RecogeModelo;
             |HAZ Refresco;
             enAnterior = 0;
         |FINSI;

         |SI #dsmom008#3 = 300;  |O #dsmom008#3 = 303;
             |SI #dsmom008#7 = "MANUAL    ";
                 |CONFI "0000NNo deben tener Adquisiciones ni Entregas Intracomunitarias, Continuar ";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;
                 enAnterior = 1;
                 |SI #dsmom008#4 > 0;
                     enAnterior = 2;
                 |FINSI;
                 |HAZ RecogeModelo;
                 |HAZ Refresco;
                 enAnterior = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTecla = 18; |Y nSwBoton10 = 1;
         aAlfa = "    SModificar la Prorrata Definitiva de Esta Empresa S/N";
         |SI enEjer [ 2010;
             aAlfa = "    NCalcular la Prorrata Definitiva de Esta Empresa S/N";
         |FINSI;
         |CONFI aAlfa;
         |SI FSalida = 0;
             |SI enEjer [ 2010;
                 enSinPantalla = 4;
                 |SUB_EJECUTA_NP "dsmozp80";
                 enSinPantalla = 0;
             |SINO;
                 |CONFI "    NDesea volver a realizar los Calculos";
                 |SI FSalida = 0;
                     |SUB_EJECUTA_NP "dsmozp02";
                 |SINO;
                     |SUB_EJECUTA_NP "dsmozp02;F10";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
     |SI nTecla = 20; |O nTecla = 9;
         |SI nSwBoton12 = 1;
             |CONFI "    NIntroducir Prorrata Provisional S/N";
             |SI FSalida = 0;
                 |SI enEjer [ 2010;
                     |SUB_EJECUTA_NP "dsmozp82";
                 |SINO;

                     |SUB_EJECUTA_NP "dsmozp03";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTecla = 1;
         |SI #dsmom008#3 = 303;  |O #dsmom008#3 = 349;
             |SUB_EJECUTA "dsmoy086;PLANING";
             |SUB_EJECUTA "dsmoy093;PLANING";
         |FINSI;
     |FINSI;

|| \\\\\ Introducir Rendimiento Ejercicio A¤o Anterior ////////

     |SI nTecla = 21;  |Y nSwBoton13 = 1;
         |SUB_EJECUTA "dsmoz099";
         |HAZ Refresco;
     |FINSI;

|| \\\\\ Importaciones

     |SI nTecla = 148;  |Y nSwBoton14 = 1;
         enCodCli = #dsmom008#0;
         |HAZ LeePersona;

         aAlfa = (("00000" + #dsmom008#0) % -105) + #dsmom008#1 + (("00" + #dsmom008#2) % -102);
         aAlfa = aAlfa + (("000" + #dsmom008#3) % -103) + (("00" + #dsmom008#4) % -102);
         aAlfa = aAlfa + (("00" + #dsmom008#5) % -102);
         aAlfa = aAlfa + #clientes@#1;

         aAlfa = "|:modelos/dsmox001;" + aAlfa;
         |SUB_EJECUTA aAlfa;

         |HAZ Refresco;
     |FINSI;

|FPRC;
