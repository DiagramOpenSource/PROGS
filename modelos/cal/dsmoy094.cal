|FICHEROS;
     dsmoy094;

     dsm39001;
     dsmom004;
     :/basica/def/agifigen;
|FIN;

|VARIABLES;
     nHay       = 0;
     nDEmpresa  = 0;
     nHEmpresa  = 0;
     &eaNombre  = "";
|FIN;

|INCLUYE i_variar;

|| /////////////////////// PROCESOS DE IMPRESION \\\\\\\\\\\\\\\\\\\\

|PROCESO Modelo390;

    #dsmom004#0 = #dsm39001#0;
    #dsmom004#1 = #dsm39001#1;
    #dsmom004#2 = enPeriodo;
    #dsmom004#3 = #dsm39001#2;
    #dsmom004#4 = #dsm39001#3 + 1;
    |LEE 041#dsmom004.=;
    |SI FSalida = 0;
        |ACABA;
    |FINSI;

    |DDEFECTO #dsmom004;
    #dsmom004#0 = #dsm39001#0;
    #dsmom004#1 = #dsm39001#1;
    #dsmom004#2 = enPeriodo;
    #dsmom004#3 = #dsm39001#2;
    #dsmom004#4 = #dsm39001#3;
    |LEE 041#dsmom004.=;

    |DDEFECTO #agifigen;
    #agifigen#0 = #dsm39001#0;
    |LEE 041#agifigen.=;

    |SI #dsm39001#10 = #dsm39001#114; |Y #dsm39001#10 ! 0;
        eaNombre = #agifigen#1;
        |PRINT;
        nHay = 1;
    |FINSI;
|FPRC;

|DEFBUCLE Modelo390;
     #dsm39001#1;
     ;
     nDEmpresa, enEjer, enModelo, 00;
     nHEmpresa, enEjer, enModelo, 99;
     e;
     NULL, Modelo390;
|FIN;

|PROCESO Chequeo; |TIPO 3;
     |SI #dsmoy094#1 = "N"; |ACABA; |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;
         |MENAV "0000Error en Impresora. Proceso interrumpido";
         |ACABA;
     |FINSI;

     |INFOR "dsmoy094";
     |SI FSalida ! 0;
         |FINIMP;
         |MENAV "0000Error en Informe.";
         |ACABA;
     |FINSI;

     enEjer    = #dsmoy094#0;
     enModelo  = 390;
     enPeriodo = 99;
     nDEmpresa = 00001;
     nHEmpresa = 99999;

     nHay = 0;
     |ABRE #dsmom004;
     |ABRE #agifigen;
     |BUCLE Modelo390;
     |CIERRA #agifigen;
     |CIERRA #dsmom004;

     |SI nHay ! 0;
         |PIEINF;
     |SINO;
         |MENAV "    Sin Incidencias";
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;
