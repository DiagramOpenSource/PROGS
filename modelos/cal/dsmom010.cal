|FICHEROS;
     dsmow006 #998;

     dsmom014 #14;
     dsmom010 #10,MANTE;
     dsmopl10,MANTE;
|FIN;

|VARIABLES;
     aConcepto = "";
     nDosIntro = 0;
     nCampo    = 0;
     nCampo1   = 0;
     &enCalculado = 0;
     nConte    = 0;
     nModo     = 0;
     aAlfa     = "";
     nAlta     = 0;
     &eaDCta   = "";
     &eaHCta   = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo11m010;
|FPRC;

|PROCESO DosIntrom010;  |TIPO 7;
     |SI nDosIntro = 0;
         |PTEC 802;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Sumapl10;
    nConte = nConte + #dsmopl10#8;
|FPRC;

|DEFBUCLE Sumapl10;
    #dsmopl10#1;
    ;
    #dsmom010#0, #dsmom010#1, #dsmom010#2, #dsmom010#3, #dsmom010#4, eaDCta;
    #dsmom010#0, #dsmom010#1, #dsmom010#2, #dsmom010#3, #dsmom010#4, eaHCta;
    e;
    NULL, Sumapl10;
|FIN;

|PROCESO Bajapl10;
    #dsmopl10#0 = #dsmom010#0;
    #dsmopl10#1 = #dsmom010#1;
    #dsmopl10#2 = #dsmom010#2;
    #dsmopl10#3 = #dsmom010#3;
    #dsmopl10#4 = #dsmom010#4;
    #dsmopl10#5 = eaDCta;
|FPRC;

|PROCESO Altapl10;
    #dsmopl10#0 = #dsmom010#0;
    #dsmopl10#1 = #dsmom010#1;
    #dsmopl10#2 = #dsmom010#2;
    #dsmopl10#3 = #dsmom010#3;
    #dsmopl10#4 = #dsmom010#4;
    #dsmopl10#5 = eaHCta;
|FPRC;

|PROCESO Verpl10;
    nAlta = 0;
    |ABRE #dsmopl10;
    #dsmopl10#0 = #dsmom010#0;
    #dsmopl10#1 = #dsmom010#1;
    #dsmopl10#2 = #dsmom010#2;
    #dsmopl10#3 = #dsmom010#3;
    #dsmopl10#4 = #dsmom010#4;
    #dsmopl10#5 = #dsmom010#5;
    |LEE 041#dsmopl10.];
    |SI FSalida ! 0;
        nAlta = 1;
    |SINO;
        aAlfa = #dsmopl10#5 % 104;
        |SI aAlfa ! #dsmom010#5;
            nAlta = 1;
        |FINSI;
    |FINSI;
    |SI nAlta = 1; |Y #dsmom010#8 ! 0;
        #dsmopl10#0 = #dsmom010#0;
        #dsmopl10#1 = #dsmom010#1;
        #dsmopl10#2 = #dsmom010#2;
        #dsmopl10#3 = #dsmom010#3;
        #dsmopl10#4 = #dsmom010#4;
        #dsmopl10#5 = #dsmom010#5;
        #dsmopl10#6 = #dsmom010#6;
        #dsmopl10#7 = #dsmom010#7;
        #dsmopl10#8 = #dsmom010#8;
        |GRABA 041#dsmopl10.n;
    |FINSI;
    |CIERRA #dsmopl10;

    |SI #998#60 = "X"; |Y nModo ! 4;
        |MENAV "    Modificar Importes por Introduccion Datos Agrupados";
        nModo = 4;
    |FINSI;

    eaDCta = #dsmom010#5;
    eaHCta = #dsmom010#5 + "zzzzzzzz";

    |PUSHV 0501 2380;
    |PINPA #0#dsmopl10;
    |PINTA 2069, #dsmom010#8;
    |ENTLINEAL #1#dsmopl10, -6, nModo, 18, 0, Bajapl10, Altapl10;
    |POPV;

    nConte = 0;
    |BUCLE Sumapl10;
    #dsmom010#8 = nConte; |PINTA #dsmom010#8;
|FPRC;

|PROCESO NoPasom010;  |TIPO 7;
     |ABRE #14;
     #14#10 = enPlan14;
     #14#0  = #10#5;
     |LEE 040#14=;
     |SI FSalida ! 0;  |DDEFECTO #14;  |FINSI;
     |CIERRA #14;

     eaCta60 = #dsmom010#5;
     eaTip60 = "I";
     |HAZ HayDesglose60;

     nModo = 2;
     |C_M #10#8,  1, "S";
     |SI #dsmom014#6 = "N";
         |C_M #10#8,  1, "N";
         nModo = 4;
     |FINSI;

     |SI enEjer ] 2019; |Y enDesglose60 = 1;
         |HAZ Verpl10;
     |SINO;
         |MENSA "    <F5> Calculadora";
     |FINSI;

|FPRC;

|PROCESO Teclam010;
     nConte = Contenido;

     |SI FSalida = 2;
         |PTEC 802;
         |PTEC 802;
         |PTEC 808;

         aConcepto = "";
         nDosIntro = 1;
         |ACABA;
     |FINSI;

     |SI FSalida = 1;
         |PTEC 806;
         nDosIntro = 1;
         aConcepto = #10#5;
         |ACABA;
     |FINSI;

     |SI FSalida = 13;
         enCalculado = #10#8;
         |HAZ Calculadora;
         #10#8 = enCalculado;
         |PINTA #10#8;
     |FINSI;

     |SI aConcepto = #10#5;
         |ERROR;
         aConcepto = "";
     |SINO;
         nDosIntro = 0;
         aConcepto = #10#5;
     |FINSI;

     |SI #998#60 = "X";
         |SI #10#8 ! nConte;
             |MENAV "    Modificar Importes por Introduccion Datos Agrupados";
         |FINSI;
         #10#8 = nConte; |PINTA #10#8;
     |FINSI;
|FPRC;

|PROCESO Tipo2m010;  |TIPO 2;
     |SI #10#7 = "+";
         #998#17 = #998#17 +. #10#8;
     |SINO;
         #998#17 = #998#17 -. #10#8;
     |FINSI;

     |ATRI S;  |PINTA 2269, #998#17;  |ATRI s;
|FPRC;

|PROCESO Descarga10;
     nDosIntro = 0;
|FPRC;
