|FICHEROS;
     dsmoy000;

     dsmom001;
     dsmom004;
     dsmom107;

     dsm39001;
     dsm39002;
     dsm39003;
     dsm39004;
     dsm39005;

     t1539001;
     t1539002;
     t1539003;
     t1539004;
     t1539005;
     t1539006;
     t1539007;
     t1539008;

     :/basica/def/agim0004;
     :/basica/def/agicen14;
     :/basica/def/agicen15;

     &regisnif@;
     &clientes@;
     &datosper@;

     dsmow014;
|FIN;

|VARIABLES;
     aLetrasCif      = "ABCDEFGHNPQSKLMJUVWR";
     aIPRemoto       = "";
     aFicTmp         = "";

     nNueEjer        = 0;
     nGrupo          = 0;
     nSubGrupo       = 0;
     nCampo1         = 0;
     nCampo2         = 0;
     nCampo3         = 0;
     nCampo4         = 0;
     nCampo5         = 0;
     nCampo6         = 0;
     nCas            = 0;
     nCas1           = 0;
     nCas2           = 0;
     nCas3           = 0;
     nCas4           = 0;
     nCas5           = 0;
     nCas6           = 0;
     nCas7           = 0;
     nCas8           = 0;
     nCas9           = 0;
     nCas10          = 0;
     nCas11          = 0;
     nCas12          = 0;
     nCas13          = 0;
     nCas14          = 0;
     nCas15          = 0;
     nCas16          = 0;
     nConta          = 0;
     nFila           = 0;
     nPag            = 0;
     nSigo           = 0;
     nHayGrupo       = 0;
     nOk             = 0;

     nNume1          = 0;
     nNume2          = 0;

     &enEjer         = 0;
     &enComplem      = 0;
     &enTipoEntrada  = 0;
     &nSwMod         = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO LeeDSM39002;
     #dsm39002#0  = #dsm39001#0;
     #dsm39002#1  = #dsm39001#1;
     #dsm39002#2  = #dsm39001#2;
     #dsm39002#3  = #dsm39001#3;
     #dsm39002#4  = nGrupo;
     #dsm39002#5  = nSubGrupo;
     |SELECT #1#dsm39002;
     |LEE 040#dsm39002.=;
     |SI FSalida ! 0;  |DDEFECTO #dsm39002;  |FINSI;
|FPRC;

|PROCESO CargaGrupo;
     #dsm39005#0 = #dsm39001#0;
     #dsm39005#1 = #dsm39001#1;
     #dsm39005#2 = #dsm39001#2;
     #dsm39005#3 = #dsm39001#3;
     #dsm39005#4 = nGrupo;
     |LEE 000#dsm39005.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nSigo = 0;
     |PARA nCampo = 5;  |SI nCampo [ 21;  |HACIENDO nCampo = nCampo + 1;
           |SI #dsm39005#nCampo# ! 0;
               nSigo = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSigo = 0;  |ACABA;  |FINSI;

     nHayGrupo = 1;

     |SI nGrupo = 1;  nCas = 6;  |FINSI;
     |SI nGrupo = 2;  nCas = 24; |FINSI;
     |SI nGrupo = 3;  nCas = 42; |FINSI;

                       enNume  = #dsm39005#5;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#6;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#7;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#8;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#9;   |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#10;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#11;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#12;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#13;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#14;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#15;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#16;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#17;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#18;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#22;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#19;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#20;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39005#21;  |HAZ Conver17;  #t1539008#nCas# = eaAlfa;
|FPRC;

|PROCESO Registro8;
     nHayGrupo = 0;

     |DDEFECTO #t1539008;

     |ABRE #dsm39005;

     nGrupo = 1;  |HAZ CargaGrupo;
     nGrupo = 2;  |HAZ CargaGrupo;
     nGrupo = 3;  |HAZ CargaGrupo;

     |CIERRA #dsm39005;
|FPRC;

|PROCESO dsm39004;
     nConta = nConta + 1;

     #t1539007#0 = ((nConta / 5) + .49) ! 0;
     |LEE 101#t1539007.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539007;
         #t1539007#0 = ((nConta / 5) + .49) ! 0;
         |GRABA 020#t1539007.b;

         |SI #t1539007#0 > 1;  #t1539007#5 = "C";  |FINSI;

         nFila = 0;
     |FINSI;

     nFila = nFila + 1;

                     nCas = 17;
     |SI nFila = 2;  nCas = 23;  |FINSI;
     |SI nFila = 3;  nCas = 29;  |FINSI;
     |SI nFila = 4;  nCas = 35;  |FINSI;
     |SI nFila = 5;  nCas = 41;  |FINSI;

                       eaAlfa = #dsm39004#5; |HAZ QuitaRaros;  #t1539007#nCas# = eaAlfa;
     nCas = nCas + 1;                                          #t1539007#nCas# = #dsm39004#6 % 103;
     nCas = nCas + 1;  enNume  = #dsm39004#7;  |HAZ Conver17;  #t1539007#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39004#8;  |HAZ Conver17;  #t1539007#nCas# = eaAlfa;
     nCas = nCas + 1;                                          #t1539007#nCas# = #dsm39004#9;
     nCas = nCas + 1;  enNume  = #dsm39004#10 * 100;           aAlfa           = ("00000" + enNume) % -105;
                                                               #t1539007#nCas# = aAlfa;

     |GRABA 020#t1539007.a;
     |LIBERA #t1539007;
|FPRC;

|DEFBUCLE dsm39004;
     #dsm39004#1;
     ;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 01;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 99;
     ;
     NULL, dsm39004;
|FIN;

|PROCESO Registro7;
     nConta = 0;
     |BUCLE dsm39004;

     |SI nConta = 0;
         enNume  = 0;
         nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 3;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 4;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 16;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10;

         nGrupo  = 4;  nSubGrupo = 17;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10 + #dsm39002#11;

         nGrupo  = 4;  nSubGrupo = 18;   |HAZ LeeDSM39002;
         enNume  = enNume + #dsm39002#10 + #dsm39002#11;

         |SI enNume = 0;  |ACABA;  |FINSI;
     |FINSI;

     #t1539007#0 = 1;
     |LEE 101#t1539007.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539007;
         #t1539007#0 = 1;
         |GRABA 020#t1539007.b;
     |FINSI;

     nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#6  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#7  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 3;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#8  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 4;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#9  = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#10 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#11 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 16;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#12 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 17;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#13 = eaAlfa;
     enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539007#14 = eaAlfa;

     nGrupo  = 4;  nSubGrupo = 18;   |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539007#15 = eaAlfa;
     enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539007#16 = eaAlfa;

     |GRABA 020#t1539007.a;
     |LIBERA #t1539007;
|FPRC;

|PROCESO Registro6;
     |DDEFECTO #t1539006;

     |SI #dsm39001#55 = 0;  |Y #dsm39001#56 = 0;
      |Y #dsm39001#57 = 0;  |Y #dsm39001#58 = 0;
      |Y #dsm39001#59 = 0;
         enNume  = #dsm39001#109; |HAZ Conver17;  #t1539006#6  = eaAlfa;
         enNume  = #dsm39001#53;  |HAZ Conver17;  #t1539006#7  = eaAlfa;
         enNume  = #dsm39001#110; |HAZ Conver17;  #t1539006#8  = eaAlfa;
         enNume  = #dsm39001#54;  |HAZ Conver17;  #t1539006#9  = eaAlfa;
         enNume  = #dsm39001#6;   |HAZ Conver17;  #t1539006#10 = eaAlfa;
     |SINO;
         enNume  = #dsm39001#55 * 100;            #t1539006#11 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#56 * 100;            #t1539006#12 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#57 * 100;            #t1539006#13 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#58 * 100;            #t1539006#14 = ("00000" + enNume) % -105;
         enNume  = #dsm39001#59 * 100;            #t1539006#15 = ("00000" + enNume) % -105;

         enNume  = #dsm39001#111; |HAZ Conver17;  #t1539006#16 = eaAlfa;
         enNume  = #dsm39001#60;  |HAZ Conver17;  #t1539006#17 = eaAlfa;
         enNume  = #dsm39001#61;  |HAZ Conver17;  #t1539006#18 = eaAlfa;
         enNume  = #dsm39001#112; |HAZ Conver17;  #t1539006#19 = eaAlfa;
         enNume  = #dsm39001#62;  |HAZ Conver17;  #t1539006#20 = eaAlfa;
         enNume  = #dsm39001#7;   |HAZ Conver17;  #t1539006#21 = eaAlfa;
     |FINSI;

     enNume  = #dsm39001#8;   |HAZ Conver17;  #t1539006#22 = eaAlfa;
     enNume  = #dsm39001#9;   |HAZ Conver17;  #t1539006#23 = eaAlfa;
     enNume  = #dsm39001#100; |HAZ Conver17;  #t1539006#24 = eaAlfa;
     enNume  = #dsm39001#10;  |HAZ Conver17;  #t1539006#25 = eaAlfa;
     enNume  = #dsm39001#11;  |HAZ Conver17;  #t1539006#26 = eaAlfa;
     enNume  = #dsm39001#101; |HAZ Conver17;  #t1539006#27 = eaAlfa;
     enNume  = #dsm39001#102; |HAZ Conver17;  #t1539006#28 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 1;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#29 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 17;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#30 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;
     nGrupo  = 3;  nSubGrupo = 16;  |HAZ LeeDSM39002;
     enNume  = enNume + #dsm39002#10;  |HAZ Conver17;  #t1539006#31 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;
     nGrupo  = 3;  nSubGrupo = 11;  |HAZ LeeDSM39002;
     enNume  = enNume + #dsm39002#10;  |HAZ Conver17;  #t1539006#32 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 12;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#33 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 4;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#34 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 7;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#35 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 2;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#36 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 3;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#37 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#38 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 5;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#39 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 6;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#40 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#41 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeDSM39002;
     enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539006#42 = eaAlfa;

     enNume  = #dsm39001#12;  |HAZ Conver17;  #t1539006#43 = eaAlfa;
|FPRC;

|PROCESO dsm39003;
     nConta = nConta + 1;

     #t1539005#0 = (nConta / 2) ! 0;
     |LEE 101#t1539005.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539005;
         #t1539005#0 = (nConta / 2) ! 0;

         |SI #t1539005#0 > 1;  #t1539005#5 = "C";  |FINSI;

         |GRABA 020#t1539005.b;
     |FINSI;

     nFila = nConta $ 2;

                     nCas = 6;
     |SI nFila = 0;  nCas = 30;  |FINSI;

                                                               #t1539005#nCas# = #dsm39003#5;
     nCas = nCas + 1;  enNume  = #dsm39003#6;  |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#7;  |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#8;  |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#9;  |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#10; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#11; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#12; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#13; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#14; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#15; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#16; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#17; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#18; |HAZ Conver10;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#19; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;

     nCas = nCas + 1;  enNume  = #dsm39003#20; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#33; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#21; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#22 * 100;           aAlfa           = ("000" + enNume) % -103;
                                                               #t1539005#nCas# = aAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#23; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#24 * 100;           aAlfa           = ("00000" + enNume) % -105;
                                                               #t1539005#nCas# = aAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#25; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#26; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;
     nCas = nCas + 1;  enNume  = #dsm39003#27; |HAZ Conver17;  #t1539005#nCas# = eaAlfa;

     |GRABA 020#t1539005.a;
     |LIBERA #t1539005;
|FPRC;

|DEFBUCLE dsm39003;
     #dsm39003#1;
     ;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 01;
     #dsm39001#0, #dsm39001#1, #dsm39001#2, #dsm39001#3, 99;
     ;
     NULL, dsm39003;
|FIN;

|PROCESO Registro5;
     nConta = 0;
     |BUCLE dsm39003;

     |SI #dsm39001#44 = 0;  |Y #dsm39001#45 = 0;  |Y #dsm39001#49 = 0;
      |Y #dsm39001#52 = 0;  |Y #dsm39001#5  = 0;
         |ACABA;
     |FINSI;


     #t1539005#0 = 1;
     |LEE 101#t1539005.=;
     |SI FSalida ! 0;
         |DDEFECTO #t1539005;
         #t1539005#0 = 1;
         |GRABA 020#t1539005.b;
     |FINSI;

                                              #t1539005#54 = ("00" + #dsm39001#14) % -102;
     enNume  = #dsm39001#15;  |HAZ Conver17;  #t1539005#55 = eaAlfa;
     enNume  = #dsm39001#16 * 100000;         #t1539005#56 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#17;  |HAZ Conver17;  #t1539005#57 = eaAlfa;
     enNume  = #dsm39001#18;  |HAZ Conver17;  #t1539005#58 = eaAlfa;
     enNume  = #dsm39001#19;  |HAZ Conver17;  #t1539005#59 = eaAlfa;

                                              #t1539005#60 = ("00" + #dsm39001#20) % -102;
     enNume  = #dsm39001#21;  |HAZ Conver17;  #t1539005#61 = eaAlfa;
     enNume  = #dsm39001#22 * 100000;         #t1539005#62 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#23;  |HAZ Conver17;  #t1539005#63 = eaAlfa;
     enNume  = #dsm39001#24;  |HAZ Conver17;  #t1539005#64 = eaAlfa;
     enNume  = #dsm39001#25;  |HAZ Conver17;  #t1539005#65 = eaAlfa;

                                              #t1539005#66 = ("00" + #dsm39001#26) % -102;
     enNume  = #dsm39001#27;  |HAZ Conver17;  #t1539005#67 = eaAlfa;
     enNume  = #dsm39001#28 * 100000;         #t1539005#68 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#29;  |HAZ Conver17;  #t1539005#69 = eaAlfa;
     enNume  = #dsm39001#30;  |HAZ Conver17;  #t1539005#70 = eaAlfa;
     enNume  = #dsm39001#31;  |HAZ Conver17;  #t1539005#71 = eaAlfa;

                                              #t1539005#72 = ("00" + #dsm39001#32) % -102;
     enNume  = #dsm39001#33;  |HAZ Conver17;  #t1539005#73 = eaAlfa;
     enNume  = #dsm39001#34 * 100000;         #t1539005#74 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#35;  |HAZ Conver17;  #t1539005#75 = eaAlfa;
     enNume  = #dsm39001#36;  |HAZ Conver17;  #t1539005#76 = eaAlfa;
     enNume  = #dsm39001#37;  |HAZ Conver17;  #t1539005#77 = eaAlfa;

                                              #t1539005#78 = ("00" + #dsm39001#38) % -102;
     enNume  = #dsm39001#39;  |HAZ Conver17;  #t1539005#79 = eaAlfa;
     enNume  = #dsm39001#40 * 100000;         #t1539005#80 = ("000000" + enNume) % -106;
     enNume  = #dsm39001#41;  |HAZ Conver17;  #t1539005#81 = eaAlfa;
     enNume  = #dsm39001#42;  |HAZ Conver17;  #t1539005#82 = eaAlfa;
     enNume  = #dsm39001#43;  |HAZ Conver17;  #t1539005#83 = eaAlfa;

     enNume  = #dsm39001#44;  |HAZ Conver17;  #t1539005#84 = eaAlfa;
     enNume  = #dsm39001#45;  |HAZ Conver17;  #t1539005#85 = eaAlfa;
     enNume  = #dsm39001#46;  |HAZ Conver17;  #t1539005#86 = eaAlfa;
     enNume  = #dsm39001#47;  |HAZ Conver17;  #t1539005#87 = eaAlfa;
     enNume  = #dsm39001#48;  |HAZ Conver17;  #t1539005#88 = eaAlfa;
     enNume  = #dsm39001#49;  |HAZ Conver17;  #t1539005#89 = eaAlfa;
     enNume  = #dsm39001#50;  |HAZ Conver17;  #t1539005#90 = eaAlfa;
     enNume  = #dsm39001#51;  |HAZ Conver17;  #t1539005#91 = eaAlfa;
     enNume  = #dsm39001#52;  |HAZ Conver17;  #t1539005#92 = eaAlfa;
     enNume  = #dsm39001#5;   |HAZ Conver17;  #t1539005#93 = eaAlfa;

     |GRABA 020#t1539005.a;
     |LIBERA #t1539005;
|FPRC;

|PROCESO MeteIVASop;
     |HAZ LeeDSM39002;

     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas2# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas2# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 7;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas4# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas4# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 8;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas6# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas6# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas7# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas8# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas7# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas8# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 16;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas9#  = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas10# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas9#  = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas10# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 18;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas11# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas12# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas11# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas12# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas13# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas14# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas13# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas14# = eaAlfa;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas2# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas1# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas2# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 7;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas4# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas3# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas4# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 8;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas6# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas5# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas6# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas7# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas8# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas7# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas8# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 16;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas9#  = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas10# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas9#  = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas10# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 18;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas11# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas12# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas11# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas12# = eaAlfa;
               |FINSI;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               |SI nPag = 3;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539003#nCas13# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539003#nCas14# = eaAlfa;
               |FINSI;

               |SI nPag = 4;
                   enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539004#nCas13# = eaAlfa;
                   enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539004#nCas14# = eaAlfa;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 3;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539003#nCas15# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539003#nCas16# = eaAlfa;
     |FINSI;

     |SI nPag = 4;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539004#nCas15# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539004#nCas16# = eaAlfa;
     |FINSI;
|FPRC;

|PROCESO MeteBaseCuota;
     |HAZ LeeDSM39002;

     |SI nGrupo = 1;  |Y nSubGrupo = 7;
         nNume1 = #dsm39002#10;  nNume2 = #dsm39002#11;

         nGrupo = 1;  nSubGrupo = 18;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         nGrupo = 1;  nSubGrupo = 19;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         #dsm39002#10 = nNume1;
         #dsm39002#11 = nNume2;
     |FINSI;

     |SI nGrupo = 1;  |Y nSubGrupo = 11;
         nNume1 = #dsm39002#10;  nNume2 = #dsm39002#11;

         nGrupo = 1;  nSubGrupo = 20;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         #dsm39002#10 = nNume1;
         #dsm39002#11 = nNume2;
     |FINSI;

     |SI nGrupo = 2;  |Y nSubGrupo = 8;
         nNume1 = #dsm39002#10;  nNume2 = #dsm39002#11;

         nGrupo = 2;   nSubGrupo = 17;
         |HAZ LeeDSM39002;  nNume1 = nNume1 + #dsm39002#10;  nNume2 = nNume2 + #dsm39002#11;

         #dsm39002#10 = nNume1;
         #dsm39002#11 = nNume2;
     |FINSI;

     |SI nPag = 2;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
     |FINSI;

     |SI nPag = 3;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539003#nCas1# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539003#nCas2# = eaAlfa;
     |FINSI;

     |SI nPag = 4;
         enNume  = #dsm39002#10;  |HAZ Conver17;  #t1539004#nCas1# = eaAlfa;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539004#nCas2# = eaAlfa;
     |FINSI;
|FPRC;

|PROCESO MeteCuota;
     |HAZ LeeDSM39002;

     |SI nPag = 2;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
     |FINSI;

     |SI nPag = 3;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539003#nCas1# = eaAlfa;
     |FINSI;

     |SI nPag = 4;
         enNume  = #dsm39002#11;  |HAZ Conver17;  #t1539004#nCas1# = eaAlfa;
     |FINSI;
|FPRC;

|PROCESO Registro4;
     |DDEFECTO #t1539004;

     nPag = 4;

     nGrupo = 2;   nSubGrupo = 4;
     nCas1  = 6;   nCas2     = 7;
     nCas3  = 8;   nCas4     = 9;
     nCas5  = 10;  nCas6     = 11;
     nCas7  = 12;  nCas8     = 13;
     nCas9  = 14;  nCas10    = 15;
     nCas11 = 16;  nCas12    = 17;
     nCas13 = 18;  nCas14    = 19;
     nCas15 = 20;  nCas16    = 21;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 5;
     nCas1  = 22;  nCas2     = 23;
     nCas3  = 24;  nCas4     = 25;
     nCas5  = 26;  nCas6     = 27;
     nCas7  = 28;  nCas8     = 29;
     nCas9  = 30;  nCas10    = 31;
     nCas11 = 32;  nCas12    = 33;
     nCas13 = 34;  nCas14    = 35;
     nCas15 = 36;  nCas16    = 37;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 6;
     nCas1  = 38;  nCas2     = 39;
     nCas3  = 40;  nCas4     = 41;
     nCas5  = 42;  nCas6     = 43;
     nCas7  = 44;  nCas8     = 45;
     nCas9  = 46;  nCas10    = 47;
     nCas11 = 48;  nCas12    = 49;
     nCas13 = 50;  nCas14    = 51;
     nCas15 = 52;  nCas16    = 53;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 13;
     nCas1  = 54;  nCas2     = 55;
     nCas3  = 56;  nCas4     = 57;
     nCas5  = 58;  nCas6     = 59;
     nCas7  = 60;  nCas8     = 61;
     nCas9  = 62;  nCas10    = 63;
     nCas11 = 64;  nCas12    = 65;
     nCas13 = 66;  nCas14    = 67;
     nCas15 = 68;  nCas16    = 69;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 7;
     nCas1  = 70;  nCas2     = 71;  |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 8;
     nCas1  = 72;  nCas2     = 73;  |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 16;
     nCas1  = 74;  nCas2     = 75;  |HAZ MeteBaseCuota;

     nGrupo = 2;   nSubGrupo = 9;
     nCas1  = 76;                   |HAZ MeteCuota;

     nGrupo = 2;   nSubGrupo = 10;
     nCas1  = 77;                   |HAZ MeteCuota;

     nGrupo = 2;   nSubGrupo = 12;
     nCas1  = 78;                   |HAZ MeteCuota;

     enNume  = #dsm39001#4;  |HAZ Conver17;  #t1539004#79# = eaAlfa;
|FPRC;

|PROCESO Registro3;
     |DDEFECTO #t1539003;

     nPag = 3;

     nGrupo = 2;   nSubGrupo = 1;
     nCas1  = 6;   nCas2     = 7;
     nCas3  = 8;   nCas4     = 9;
     nCas5  = 10;  nCas6     = 11;
     nCas7  = 12;  nCas8     = 13;
     nCas9  = 14;  nCas10    = 15;
     nCas11 = 16;  nCas12    = 17;
     nCas13 = 18;  nCas14    = 19;
     nCas15 = 20;  nCas16    = 21;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 14;
     nCas1  = 22;  nCas2     = 23;
     nCas3  = 24;  nCas4     = 25;
     nCas5  = 26;  nCas6     = 27;
     nCas7  = 28;  nCas8     = 29;
     nCas9  = 30;  nCas10    = 31;
     nCas11 = 32;  nCas12    = 33;
     nCas13 = 34;  nCas14    = 35;
     nCas15 = 36;  nCas16    = 37;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 2;
     nCas1  = 38;  nCas2     = 39;
     nCas3  = 40;  nCas4     = 41;
     nCas5  = 42;  nCas6     = 43;
     nCas7  = 44;  nCas8     = 45;
     nCas9  = 46;  nCas10    = 47;
     nCas11 = 48;  nCas12    = 49;
     nCas13 = 50;  nCas14    = 51;
     nCas15 = 52;  nCas16    = 53;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 15;
     nCas1  = 54;  nCas2     = 55;
     nCas3  = 56;  nCas4     = 57;
     nCas5  = 58;  nCas6     = 59;
     nCas7  = 60;  nCas8     = 61;
     nCas9  = 62;  nCas10    = 63;
     nCas11 = 64;  nCas12    = 65;
     nCas13 = 66;  nCas14    = 67;
     nCas15 = 68;  nCas16    = 69;  |HAZ MeteIVASop;

     nGrupo = 2;   nSubGrupo = 3;
     nCas1  = 70;  nCas2     = 71;
     nCas3  = 72;  nCas4     = 73;
     nCas5  = 74;  nCas6     = 75;
     nCas7  = 76;  nCas8     = 77;
     nCas9  = 78;  nCas10    = 79;
     nCas11 = 80;  nCas12    = 81;
     nCas13 = 82;  nCas14    = 83;
     nCas15 = 84;  nCas16    = 85;  |HAZ MeteIVASop;
|FPRC;

|PROCESO MeteAcumDev;
     |HAZ LeeDSM39002;

     nNume1 = 0;
     nNume1 = 0;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo1# ! 0; |O #dsm39002#nCampo3# ! 0;
               nNume1  = nNume1 + #dsm39002#nCampo1#;
               nNume2  = nNume2 + #dsm39002#nCampo3#;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo1# ! 0; |O #dsm39002#nCampo3# ! 0;
               nNume1  = nNume1 + #dsm39002#nCampo1#;
               nNume2  = nNume2 + #dsm39002#nCampo3#;
           |FINSI;
     |SIGUE;

     enNume  = nNume1;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
     enNume  = nNume2;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
|FPRC;

|PROCESO MeteIVADev;
     |HAZ LeeDSM39002;

     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = 4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 10;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 21;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MeteRECDev;
     |HAZ LeeDSM39002;

     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = .5;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 5.2;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.75;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas7# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas8# = eaAlfa;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 27;  |SI nCampo2 [ 33;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #dsm39002#nCampo2# = .5;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas1# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas2# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.4;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas3# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas4# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 5.2;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas5# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas6# = eaAlfa;
           |FINSI;

           |SI #dsm39002#nCampo2# = 1.75;
               enNume  = #dsm39002#nCampo1#;  |HAZ Conver17;  #t1539002#nCas7# = eaAlfa;
               enNume  = #dsm39002#nCampo3#;  |HAZ Conver17;  #t1539002#nCas8# = eaAlfa;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Registro2;
     |DDEFECTO #t1539002;

     nPag = 2;

     nGrupo = 1;   nSubGrupo = 1;
     nCas1  = 6;   nCas2     = 7;
     nCas3  = 8;   nCas4     = 9;
     nCas5  = 10;  nCas6     = 11;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 14;
     nCas1  = 12;  nCas2     = 13;
     nCas3  = 14;  nCas4     = 15;
     nCas5  = 16;  nCas6     = 17;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 16;
     nCas1  = 18;  nCas2     = 19;
     nCas3  = 20;  nCas4     = 21;
     nCas5  = 22;  nCas6     = 23;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 2;
     nCas1  = 24;  nCas2     = 25;
     nCas3  = 26;  nCas4     = 27;
     nCas5  = 28;  nCas6     = 29;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 3;
     nCas1  = 30;  nCas2     = 31;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 5;
     nCas1  = 32;  nCas2     = 33;
     nCas3  = 34;  nCas4     = 35;
     nCas5  = 36;  nCas6     = 37;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 15;
     nCas1  = 38;  nCas2     = 39;
     nCas3  = 40;  nCas4     = 41;
     nCas5  = 42;  nCas6     = 43;  |HAZ MeteIVADev;

     nGrupo = 1;   nSubGrupo = 6;
     nCas1  = 44;  nCas2     = 45;  |HAZ MeteAcumDev;

     nGrupo = 1;   nSubGrupo = 7;
     nCas1  = 46;  nCas2     = 47;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 17;
     nCas1  = 48;  nCas2     = 49;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 8;
     nCas1  = 50;  nCas2     = 51;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 9;
     nCas1  = 52;  nCas2     = 53;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 10;
     nCas1  = 54;  nCas2     = 55;
     nCas3  = 56;  nCas4     = 57;
     nCas5  = 58;  nCas6     = 59;
     nCas7  = 60;  nCas8     = 61;  |HAZ MeteRECDev;

     nGrupo = 1;   nSubGrupo = 11;
     nCas1  = 62;  nCas2     = 63;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 12;
     nCas1  = 64;  nCas2     = 65;  |HAZ MeteBaseCuota;

     nGrupo = 1;   nSubGrupo = 13;
     nCas1  = 66;                   |HAZ MeteCuota;
|FPRC;

|PROCESO ElRepresentante;
     |ABRE #agicen15;
     #agicen15#0 = #dsm39001#0;
     |LEE 000#agicen15.=;
     |SI FSalida ! 0;  |DDEFECTO #agicen15;  |FINSI;
     |CIERRA #agicen15;

     |SI #agicen15#4 =  "            ";  |ACABA;  |FINSI;

     enCodCli = #dsm39001#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         |SI #clientes@#3  = #agicen15#4;  |ACABA;  |FINSI;
     |SINO;
         |SI #clientes@#13 = #agicen15#4;  |ACABA;  |FINSI;
     |FINSI;

     eaVarDni = #agicen15#4;  |HAZ CalculameDNI;     #t1539001#47 = eaVarDni;
     eaAlfa   = #agicen15#5;  |HAZ QuitaRaros;       #t1539001#48 = eaAlfa;
                                                     #t1539001#49 = #agicen15#8;
     eaAlfa   = #agicen15#9;  |HAZ QuitaRaros;       #t1539001#50 = eaAlfa;
                                                     #t1539001#51 = #agicen15#10 % 104;
                                                     #t1539001#52 = #agicen15#11;
                                                     #t1539001#53 = #agicen15#12;
                                                     #t1539001#54 = #agicen15#13;
     eaAlfa   = #agicen15#14;  |HAZ QuitaRarosTfno;  #t1539001#55 = eaAlfa;
     eaAlfa   = #agicen15#17;  |HAZ QuitaRaros;      #t1539001#56 = eaAlfa;
     eaAlfa   = #agicen15#18;  |HAZ QuitaRaros;      #t1539001#57 = eaAlfa;

     #t1539001#58 = (("00" + #agicen15#15) % -102) + (("000" + #agicen15#16) % -103);
|FPRC;

|PROCESO dsmom001;
     aAlfa = "31.12." + #dsm39001#1;
     |SI #dsmom001#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #dsm39001#1;
     |SI #dsmom001#9 > "01.01.0000";
         |SI #dsmom001#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     aAlfa = "31.12." + #dsm39001#1; fFecha = aAlfa;

     #agicen14#0  = #dsmom001#0;  ||Compruebo si esta la actividad de alta
     #agicen14#1  = #dsmom001#1;  ||Tique 700000_7747
     |LEE 000#agicen14.=;
     |SI FSalida ! 0;  |DDEFECTO #agicen14;  |FINSI;

     |SI #agicen14#5 > "01.01.0000";
         |SI #agicen14#5 > fFecha;  |ACABA;  |FINSI;
     |FINSI;

     aAlfa = "01.01." + #dsm39001#1; fFecha = aAlfa;
     |SI #agicen14#6 > "01.01.0000";
         |SI #agicen14#6 < fFecha;  |ACABA;  |FINSI;
     |FINSI;

     enComuneros = 1;

     enCodCli = #dsmom001#3;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;     #t1539001#47 = eaVarDni;
         eaAlfa   = #clientes@#1;  |HAZ QuitaRaros;       #t1539001#48 = eaAlfa;
                                                          #t1539001#49 = #clientes@#29;
         eaAlfa   = #clientes@#30;  |HAZ QuitaRaros;      #t1539001#50 = eaAlfa;
                                                          #t1539001#51 = #clientes@#31 % 104;
                                                          #t1539001#52 = #clientes@#32;
                                                          #t1539001#53 = #clientes@#33;
                                                          #t1539001#54 = #clientes@#34;
         eaAlfa   = #clientes@#54;  |HAZ QuitaRarosTfno;  #t1539001#55 = eaAlfa;
         eaAlfa   = #clientes@#37;  |HAZ QuitaRaros;      #t1539001#56 = eaAlfa;
         eaAlfa   = #clientes@#38;  |HAZ QuitaRaros;      #t1539001#57 = eaAlfa;
         #t1539001#58 = (("00" + #clientes@#35) % -102) + (("000" + #clientes@#36) % -103);
     |SINO;
         eaVarDni = #clientes@#13; |HAZ CalculameDNI;     #t1539001#47 = eaVarDni;
         eaAlfa   = #clientes@#1;  |HAZ QuitaRaros;       #t1539001#48 = eaAlfa;
                                                          #t1539001#49 = #clientes@#3;
         eaAlfa   = #clientes@#4;  |HAZ QuitaRaros;       #t1539001#50 = eaAlfa;
                                                          #t1539001#51 = #clientes@#5 % 104;
                                                          #t1539001#52 = #clientes@#6;
                                                          #t1539001#53 = #clientes@#7;
                                                          #t1539001#54  = #clientes@#8;
         eaAlfa   = #clientes@#14;  |HAZ QuitaRarosTfno;  #t1539001#55  = eaAlfa;
         eaAlfa   = #clientes@#11;  |HAZ QuitaRaros;      #t1539001#56  = eaAlfa;
         eaAlfa   = #clientes@#12;  |HAZ QuitaRaros;      #t1539001#57  = eaAlfa;
         #t1539001#58  = (("00" + #clientes@#9) % -102) + (("000" + #clientes@#10) % -103);
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#1;
     ;
     #dsm39001#0, 01, 0001;
     #dsm39001#0, 99, 9999;
     ;
     NULL, dsmom001;
|FIN;

|PROCESO agim0004;
     nLinea = nLinea + 1;
     |SI nLinea = 1;
         eaAlfa   = #agim0004#3;   |HAZ QuitaRaros;     #t1539001#59  = eaAlfa;
         eaVarDni = #agim0004#2;   |HAZ CalculameDNI;   #t1539001#60  = eaVarDni;
         #t1539001#61  = (#agim0004#4 % 102) + (#agim0004#4 % 402) + (#agim0004#4 % -104);
         eaAlfa   = #agim0004#5;   |HAZ QuitaRaros;     #t1539001#62  = eaAlfa;
     |FINSI;

     |SI nLinea = 2;
         eaAlfa   = #agim0004#3;   |HAZ QuitaRaros;     #t1539001#63  = eaAlfa;
         eaVarDni = #agim0004#2;   |HAZ CalculameDNI;   #t1539001#64  = eaVarDni;
         #t1539001#65  = (#agim0004#4 % 102) + (#agim0004#4 % 402) + (#agim0004#4 % -104);
         eaAlfa   = #agim0004#5;   |HAZ QuitaRaros;     #t1539001#66  = eaAlfa;
     |FINSI;

     |SI nLinea = 3;
         eaAlfa   = #agim0004#3;   |HAZ QuitaRaros;     #t1539001#67  = eaAlfa;
         eaVarDni = #agim0004#2;   |HAZ CalculameDNI;   #t1539001#68  = eaVarDni;
         #t1539001#69  = (#agim0004#4 % 102) + (#agim0004#4 % 402) + (#agim0004#4 % -104);
         eaAlfa   = #agim0004#5;   |HAZ QuitaRaros;     #t1539001#70  = eaAlfa;
     |FINSI;

     |SI nLinea = 3;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE agim0004;
     #agim0004#1;
     ;
     #dsm39001#0, 01;
     #dsm39001#0, 99;
     ;
     NULL, agim0004;
|FIN;

|PROCESO LeoAgicen14;
    nOk = 0;
|FPRC;

|DEFBUCLE LeoAgicen14;
    #agicen14#1;
    16;
    #dsm39001#0, 01, 3;
    #dsm39001#0, 99, 3;
    ;
    NULL, LeoAgicen14;
|FIN;

|PROCESO BuscaFirmantes;
     enComuneros = 0;
     nOk   = 0;
     aAlfa = #t1539001#7 % 101; aAlfa = aAlfa > " ";
     |SI aAlfa = "J";
         nOk = 1;
         |BUCLE LeoAgicen14;
     |FINSI;

     |SI nOk = 0;
         |ABRE #agicen14;
         |BUCLE dsmom001;
         |CIERRA #agicen14;
     |SINO;
         eaComBienes = "N";
     |FINSI;

     |SI enComuneros = 1;  |O eaComBienes = "S";
         |HAZ ElRepresentante;
     |SINO;
         nLinea = 0;
         |BUCLE agim0004;
         |SI nLinea = 0;
             |HAZ ElRepresentante;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Registro1;
     |DDEFECTO #t1539001;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;   #t1539001#7   = eaVarDni;

         aAlfa1   = #datosper@#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #datosper@#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa; |QBF aAlfa1;
             eaAlfa = #datosper@#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa; |QBF aAlfa2;
                                                       #t1539001#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #datosper@#4;  |HAZ QuitaRaros;  #t1539001#9 = eaAlfa;
         |SINO;
             eaAlfa = #clientes@#1;  |HAZ QuitaRaros;  #t1539001#8  = eaAlfa;
             aCaracter  = eaVarDni % 101;
             aAlfa      = aLetrasCif - aCaracter;

             |SI aAlfa  = aLetrasCif;
                 #t1539001#9 = ".";

                 eaCadena = #clientes@#1;  |HAZ SeparaNombre;
                 eaAlfa = eaCadena1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa % 130;  |QBF aAlfa1;
                 eaAlfa = eaCadena2;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa % 130;  |QBF aAlfa2;
                 eaAlfa = eaCadena3;  |HAZ QuitaRaros;  aAlfa3 = eaAlfa % 130;  |QBF aAlfa3;
                 #t1539001#8  = aAlfa1 + " " + aAlfa2;
                 #t1539001#9  = aAlfa3;
             |FINSI;
         |FINSI;

         eaComBienes = #clientes@#12;
     |SINO;
         eaVarDni = #clientes@#13; |HAZ CalculameDNI;    #t1539001#7  = eaVarDni;
         eaAlfa   = #clientes@#1;  |HAZ QuitaRaros;      #t1539001#8  = eaAlfa;

         aCaracter  = eaVarDni % 101;
         aAlfa      = aLetrasCif - aCaracter;

         |SI aAlfa  = aLetrasCif;
             #t1539001#9 = ".";

             eaCadena = #clientes@#1;  |HAZ SeparaNombre;
             eaAlfa = eaCadena1;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa % 130;  |QBF aAlfa1;
             eaAlfa = eaCadena2;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa % 130;  |QBF aAlfa2;
             eaAlfa = eaCadena3;  |HAZ QuitaRaros;  aAlfa3 = eaAlfa % 130;  |QBF aAlfa3;
             #t1539001#8  = aAlfa1 + " " + aAlfa2;
             #t1539001#9  = aAlfa3;
         |FINSI;
     |FINSI;

     #t1539001#10  = #dsm39001#1;

     #t1539001#12 = "0";
     #t1539001#13 = "0";
     #t1539001#14 = "";
     #t1539001#15 = "0";
     #t1539001#16 = "0";
     #t1539001#17 = "0";
     #t1539001#19 = "0";
     #t1539001#20 = "0";
     #t1539001#21 = "0";
     #t1539001#22 = "0";
     #t1539001#23 = "0";
     #t1539001#24 = "0";
     #t1539001#44 = "0";

     #t1539001#25 = #dsm39001#13;
     eaVarDni     = #dsm39001#97;  |HAZ CalculameDNI;  #t1539001#18 = eaVarDni;

     |SI #dsm39001#98  = "S";  #t1539001#12  = "1";           |FINSI;
     |SI #dsm39001#92  = "S";  #t1539001#13  = "1";           |FINSI;

     |SI #dsm39001#1 [ 2015;
         |SI #dsm39001#93  ! 0;    #t1539001#14  = #dsm39001#93;  |FINSI;
     |FINSI;

     |SI #dsm39001#1 ] 2016;
         #t1539001#14  = #dsm39001#113;
     |FINSI;

     |SI #dsm39001#94  = "S";  #t1539001#15  = "1";           |FINSI;
     |SI #dsm39001#95  = "S";  #t1539001#16  = "1";           |FINSI;
     |SI #dsm39001#92  = "S";
         |SI #dsm39001#96  = "S";  #t1539001#17  = "1";       |FINSI;
         |SI #dsm39001#96  = "N";  #t1539001#17  = "2";       |FINSI;
         |SI #dsm39001#99  = "S";  #t1539001#19  = "1";           |FINSI;
         |SI #dsm39001#99  = "N";  #t1539001#19  = "2";           |FINSI;
     |FINSI;
     |SI #dsm39001#105 = "S";  #t1539001#20  = "1";           |FINSI;
     |SI #dsm39001#105 = "N";  #t1539001#20  = "2";           |FINSI;
     |SI #dsm39001#106 = "S";  #t1539001#21  = "1";           |FINSI;
     |SI #dsm39001#106 = "N";  #t1539001#21  = "2";           |FINSI;
     |SI #dsm39001#107 = "S";  #t1539001#22  = "1";           |FINSI;
     |SI #dsm39001#107 = "N";  #t1539001#22  = "2";           |FINSI;
     |SI #dsm39001#108 = "S";  #t1539001#24  = "1";           |FINSI;
     |SI #t1539001#25 ! "             ";  #t1539001#23 = "1"; |FINSI;


     |SI #dsm39001#64 = "9999";  #dsm39001#64 = "";  |FINSI;
     |SI #dsm39001#68 = "9999";  #dsm39001#68 = "";  |FINSI;
     |SI #dsm39001#72 = "9999";  #dsm39001#72 = "";  |FINSI;
     |SI #dsm39001#76 = "9999";  #dsm39001#76 = "";  |FINSI;
     |SI #dsm39001#80 = "9999";  #dsm39001#80 = "";  |FINSI;
     |SI #dsm39001#84 = "9999";  #dsm39001#84 = "";  |FINSI;

     eaAlfa   = #dsm39001#65;  |HAZ QuitaRaros; #t1539001#26 = eaAlfa;
                                                #t1539001#27 = #dsm39001#66;
                                                #t1539001#28 = #dsm39001#64;

     eaAlfa   = #dsm39001#69;  |HAZ QuitaRaros; #t1539001#29 = eaAlfa;
                                                #t1539001#30 = #dsm39001#70;
                                                #t1539001#31 = #dsm39001#68;

     eaAlfa   = #dsm39001#73;  |HAZ QuitaRaros; #t1539001#32 = eaAlfa;
                                                #t1539001#33 = #dsm39001#74;
                                                #t1539001#34 = #dsm39001#72;

     eaAlfa   = #dsm39001#77;  |HAZ QuitaRaros; #t1539001#35 = eaAlfa;
                                                #t1539001#36 = #dsm39001#78;
                                                #t1539001#37 = #dsm39001#76;

     eaAlfa   = #dsm39001#81;  |HAZ QuitaRaros; #t1539001#38 = eaAlfa;
                                                #t1539001#39 = #dsm39001#82;
                                                #t1539001#40 = #dsm39001#80;

     eaAlfa   = #dsm39001#85;  |HAZ QuitaRaros; #t1539001#41 = eaAlfa;
                                                #t1539001#42 = #dsm39001#86;
                                                #t1539001#43 = #dsm39001#84;

     |SI #dsm39001#87 = "X";  #t1539001#44  = "1";  |FINSI;

     eaVarDni = #dsm39001#89;  |HAZ CalculameDNI;  #t1539001#45 = eaVarDni;
     eaAlfa   = #dsm39001#90;  |HAZ QuitaRaros;    #t1539001#46 = eaAlfa;

     |HAZ BuscaFirmantes;
|FPRC;

|PROCESO CreaFicPlano;
     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     aAlfa = "<T";                   |XGRABA nHandle2, aAlfa;
     aAlfa = "390";                  |XGRABA nHandle2, aAlfa;
     aAlfa = "0";                    |XGRABA nHandle2, aAlfa;
     aAlfa = #dsmoy000#6;            |XGRABA nHandle2, aAlfa;
     aAlfa = "0A";                   |XGRABA nHandle2, aAlfa;
     aAlfa = "0000>";                |XGRABA nHandle2, aAlfa;
     aAlfa = "<AUX>";                |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 70;               |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 4;                |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 4;                |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 9;                |XGRABA nHandle2, aAlfa;
     aAlfa = " " * 213;              |XGRABA nHandle2, aAlfa;
     aAlfa = "</AUX>";               |XGRABA nHandle2, aAlfa;

     |PARA nCas = 1;  |SI nCas [ 75;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1539001#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 68;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1539002#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 87;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1539003#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 81;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1539004#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |LEE 000#t1539005.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |PARA nCas = 1;  |SI nCas [ 95;  |HACIENDO nCas = nCas + 1;
                aAlfa = #t1539005#nCas#;  |XGRABA nHandle2, aAlfa;
          |SIGUE;

          |LEE 000#t1539005.s;
     |SIGUE;

     |PARA nCas = 1;  |SI nCas [ 45;  |HACIENDO nCas = nCas + 1;
           aAlfa = #t1539006#nCas#;  |XGRABA nHandle2, aAlfa;
     |SIGUE;

     |LEE 000#t1539007.p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |PARA nCas = 1;  |SI nCas [ 48;  |HACIENDO nCas = nCas + 1;
                aAlfa = #t1539007#nCas#;  |XGRABA nHandle2, aAlfa;
          |SIGUE;

          |LEE 000#t1539007.s;
     |SIGUE;

     |SI nHayGrupo = 1;
         |PARA nCas = 1;  |SI nCas [ 61;  |HACIENDO nCas = nCas + 1;
               aAlfa = #t1539008#nCas#;  |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;

     aAlfa = "</T";                  |XGRABA nHandle2, aAlfa;
     aAlfa = "390";                  |XGRABA nHandle2, aAlfa;
     aAlfa = "0";                    |XGRABA nHandle2, aAlfa;
     aAlfa = #dsmoy000#6;            |XGRABA nHandle2, aAlfa;
     aAlfa = "0A";                   |XGRABA nHandle2, aAlfa;
     aAlfa = "0000>";                |XGRABA nHandle2, aAlfa;
     |XCIERRA enHandle2;
|FPRC;

|PROCESO  Portal390;
     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsm39001;
     #dsm39001#0 = #dsmom004#0;
     #dsm39001#1 = #dsmom004#1;
     #dsm39001#2 = #dsmom004#3;
     #dsm39001#3 = #dsmom004#4;
     |LEE 040#dsm39001.=;
     |SI FSalida ! 0;  |CIERRA #dsm39001;  |ACABA;  |FINSI;
     |CIERRA #dsm39001;

     aFicTmp = "t1539005";
     |NOME_DAT #t1539005#aFicTmp#;
     |ABRE #t1539005;  |CIERRA #t1539005;  |DELINDEX #t1539005;

     aFicTmp = "t1539007";
     |NOME_DAT #t1539007#aFicTmp#;
     |ABRE #t1539007;  |CIERRA #t1539007;  |DELINDEX #t1539007;

     |ABRET #t1539005;
     |ABRET #t1539007;

     enCodCli = #dsm39001#0;
     |HAZ LeePersona;

     eaFicheroPlano = "390" + (("00000" + #dsmow014#0) % -105) + ".txt";

     |ABRE #dsm39002;

     |HAZ Registro1;
     |HAZ Registro2;
     |HAZ Registro3;
     |HAZ Registro4;
     |HAZ Registro5;
     |HAZ Registro6;
     |HAZ Registro7;
     |HAZ Registro8;

     |CIERRA #dsm39002;

     |HAZ CreaFicPlano;

     |CIERRAT #t1539005;  |DELINDEX #t1539005;
     |CIERRAT #t1539007;  |DELINDEX #t1539007;

     enEmpresa    = #dsmow014#0;
     eaNomEmpresa = #dsmow014#3;

     |HAZ PresentaPortal;
|FPRC;

|DEFBUCLE dsmow014C390;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, Portal390;
|FIN;

|DEFBUCLE dsmow014N390;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, Portal390;
|FIN;

|PROCESO Bloque2015;
     |SI eaParametro ! "390C";
         |SI #dsmoy000#6 [ 2016;
             |HAZ Botones2015;
         |FINSI;

         |SI #dsmoy000#6 ] 2017;
             |HAZ Botones2017;
         |FINSI;
     |SINO;
         eaOpcion = "1";
     |FINSI;

     |SI eaOpcion = "0";  enInfComp = 1;  |ACABA;  |FINSI;

     nTecla = 1;

     nSwLee  = 0;
     enTecla = nTecla;

     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C390;
     |SINO;
         |BUCLE dsmow014N390;
     |FINSI;

     |SI eaOpcion = "3";  |Y enPresentar = 0;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #dsmoy000#aFichero#;

     |ABRE #dsmoy000;
     |LEE 000#dsmoy000.p;
     |CIERRA #dsmoy000;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #dsmow014#aFichero#;

     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;
         |CIERRA #dsmom107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #dsmom107;
     |FINSI;

     |LEE 000#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     |ABRE #dsmoy000;
     |LEE 000#dsmoy000.p;
     |CIERRA #dsmoy000;

     enSwTrata      = 0;
     enCambiaMoneda = 1;

     |HAZ Bloque2015;
|FPRO;
