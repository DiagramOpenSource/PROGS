|FICHEROS;
     dsmoy055 #0;

     dsmom001 #1;

     :/basica/def/agifigen #100;
     :/integral/def/dsam0003 #103;
     :/basica/def/agim0024 #124;

     :/integral/def/dsam0121 #121;
     :/integral/def/dsam0122 #122;
     :/integral/def/dsam0054 #54;

     :/laboral/def/labempre #200;
     :/basica/def/wordm000 #400;

     dsmoy055@ #999;
|FIN;

|VARIABLES;
     aPath       = "";
     aPathDoc    = "";
     aAbre       = "";
     aAlfa       = "";
     aAlfaP      = "";
     aAlfaS      = "";
     aAlfaT      = "";
     aBase       = "";
     aMas        = "";
     aIPRemoto   = "";
     aMenav      = "";
     aMes        = "";
     aOrigen     = "";
     aDestino    = "";
     aCadena     = "";
     aLen        = "";
     aAsigna     = "";
     aCaracter   = "";
     aIdenti     = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aBaseAplica = "";
     aPos        = "";
     aPos1       = "";
     aPos2       = "";
     aLong       = "";
     nBytes      = 0;

     nHandle     = 0;
     nWord       = 0;
     nLen        = 0;
     nCampo      = 0;
     nPos        = 0;
     nLinea      = 0;
     nComuneros  = 0;
     nTecla      = 0;
     nPos1       = 0;
     nPos2       = 0;
     nLong       = 0;
     nCaracter   = 0;

     &eaNomUbicacion  = "";
     &eaRutaDocumento = "";
     &eaPathIntegral  = "";
     &eaAplica        = "";
     &eaPrograma      = "";
     &eaNomDocumento  = "";
     &eaUnidadBasico  = "";
     &eaDSMAC         = "";

     &enFSalida       = 0;
     &enCodUbica      = 0;
|FIN;

|PROCESO LeeUbicaciones;
     enFSalida = 0;

     |ABRE #121;
     #121#0 = enCodUbica;
     |LEE 040#121=;
     enFSalida = FSalida;
     |SI FSalida ! 0;
         |MENAV "      No existe Ubicacion ";
         |CIERRA #121;
         |ACABA;
     |FINSI;
     |CIERRA #121;

     |HAZ CargaMac;

     |ABRE #122;
     #122#0 = enCodUbica;
     #122#1 = eaDSMAC;
     |LEE 040#122=;
     enFSalida = FSalida;
     |SI FSalida ! 0;
         aMenav =  "      No existe Ubicacion en la Maquina : " + eaDSMAC;
         |MENAV aMenav;
         |CIERRA #122;
         |ACABA;
     |FINSI;
     |CIERRA #122;

     eaRutaDocumento = #122#3;  |QBF eaRutaDocumento;
     |SI eaRutaDocumento = "";
         aMenav = "      No esta configurada la Ruta en la Maquina " + eaDSMAC;
         |MENAV aMenav;
         enFSalida = 1;
         |ACABA;
     |FINSI;
     eaNomUbicacion = #121#1;
|FPRC;

|PROCESO Ubicacion;  |TIPO 0;
     |DBASS aBase;  |QBF aBase;

     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     |SI eaPathIntegral = "";
         |C_M #0#17, 1, "N";  #0#17 = "N";  |PINTA #0#17;
         |C_M #0#18, 1, "N";  #0#18 = 0;    |PINTA #0#18;
         |ACABA;
     |FINSI;

     |C_M #0#18, 1, "S";
     |SI #0#17 = "N";
         |C_M #0#18, 1, "N";  #0#18 = 0;  |PINTA #0#18;
     |FINSI;
|FPRC;

|PROCESO BuscaUbicacion;
     |SI #0#17 = "N";  |ACABA;  |FINSI;

     enCodUbica = #0#18;
     |HAZ LeeUbicaciones;
     |SI enFSalida ! 0;  |ERROR;  |ACABA;  |FINSI;

     #0#19 = eaNomUbicacion;  |PINTA #0#19;
|FPRC;

|PROCESO PonCadena;
     aPos  = FSalida;
     aLong = aPos % 0;
     |SI aLong = "3";
         aPos1 = aPos % 101;
         aPos2 = aPos % 204;
     |SINO;
         aPos1 = aPos % 102;
         aPos2 = aPos % 304;
     |FINSI;

     nPos1  = aPos1;
     nPos2  = aPos2;
     nPos2  = (nPos2 + nPos1) - 1;

     aLong  = aAlfa % 0;
     nLong  = aLong;

     aAlfa2 = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (nCaracter * 100) + 1;
           aCaracter = aAlfa % nPos;
           |SI nCaracter < nPos1;  |O nCaracter > nPos2;
               aAlfa2 = aAlfa2 + aCaracter;
           |FINSI;

           |SI nCaracter = nPos1;
               aAlfa2 = aAlfa2 + aAlfa1;
           |FINSI;
     |SIGUE;

     aAlfa = aAlfa2;
|FPRC;

|PROCESO PonCadena2;
     |QBF aAlfa1;

     aAlfa3 = aAlfa - aAlfa2;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     aPos  = FSalida;
     aLong = aPos % 0;
     |SI aLong = "3";
         aPos1 = aPos % 101;
         aPos2 = aPos % 204;
     |SINO;
         aPos1 = aPos % 102;
         aPos2 = aPos % 304;
     |FINSI;

     nPos1  = aPos1;
     nPos2  = aPos2;
     nPos2  = (nPos2 + nPos1) - 1;

     aLong  = aAlfa % 0;
     nLong  = aLong;

     aAlfa2 = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (nCaracter * 100) + 1;
           aCaracter = aAlfa % nPos;
           |SI nCaracter < nPos1;  |O nCaracter > nPos2;
               aAlfa2 = aAlfa2 + aCaracter;
           |FINSI;

           |SI nCaracter = nPos1;
               aAlfa2 = aAlfa2 + aAlfa1;
           |FINSI;
     |SIGUE;

     aAlfa = aAlfa2;
|FPRC;

|PROCESO PonDefectos;
     aAlfa1 = "." * 25;
     aAlfa2 = aAlfa - "#NOMBRE#";
     |SI FSalida ! 0;  |HAZ PonCadena;  |FINSI;

     aAlfa1 = "." * 9;
     aAlfa2 = aAlfa - "#NIF#";
     |SI FSalida ! 0;  |HAZ PonCadena;  |FINSI;

     aAlfa1 = "." * 25;
     aAlfa2 = aAlfa - "#POBLACION#";
     |SI FSalida ! 0;  |HAZ PonCadena;  |FINSI;

     aAlfa1 = "." * 27;
     aAlfa2 = aAlfa - "#DOMICILIO#";
     |SI FSalida ! 0;  |HAZ PonCadena;  |FINSI;

     aAlfa1 = "." * 4;
     aAlfa2 = aAlfa - "#NUMERO#";
     |SI FSalida ! 0;  |HAZ PonCadena;  |FINSI;
|FPRC;

|PROCESO Defectos;
     nTecla = FSalida;

     #999#0 = 9;
     |LEE 101#999=;
     |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

     |SI nTecla = 17;
         |PUSHV 0501 2380;

         |PINPA #0#999;
         |PINDA #0#999;

         |C_M #999#1,  1, "N";
         |C_M #999#2,  1, "N";
         |C_M #999#12, 1, "N";
         |C_M #999#13, 1, "N";
         |C_M #999#14, 1, "N";
         |C_M #999#15, 1, "N";
         |C_M #999#16, 1, "N";
         |C_M #999#17, 1, "N";
         |C_M #999#18, 1, "N";

         |ENDATOS #1#999;
         |SI FSalida = 0;
             |GRABA 020#999a;
         |FINSI;

         |POPV;
     |FINSI;
     |LIBERA #999;

     aAlfa = #0#3;  |QBF aAlfa;
     |SI aAlfa = "";
         aAlfa = #999#3;  |HAZ PonDefectos;  #0#3 = aAlfa;
         aAlfa = #999#4;  |HAZ PonDefectos;  #0#4 = aAlfa;

         |PINTA #0#3;
         |PINTA #0#4;
     |FINSI;

     aAlfa = #0#5;  |QBF aAlfa;
     |SI aAlfa = "";
         aAlfa = #999#5;  |HAZ PonDefectos;  #0#5 = aAlfa;
         aAlfa = #999#6;  |HAZ PonDefectos;  #0#6 = aAlfa;

         |PINTA #0#5;
         |PINTA #0#6;
     |FINSI;

     aAlfa = #0#7;  |QBF aAlfa;
     |SI aAlfa = "";
         aAlfa = #999#7;  |HAZ PonDefectos;  #0#7 = aAlfa;
         aAlfa = #999#8;  |HAZ PonDefectos;  #0#8 = aAlfa;

         |PINTA #0#7;
         |PINTA #0#8;
     |FINSI;

     aAlfa = #0#9;  |QBF aAlfa;
     |SI aAlfa = "";
         aAlfa = #999#9;  |HAZ PonDefectos;  #0#9  = aAlfa;
         aAlfa = #999#10; |HAZ PonDefectos;  #0#10 = aAlfa;
         aAlfa = #999#11; |HAZ PonDefectos;  #0#11 = aAlfa;

         |PINTA #0#9;
         |PINTA #0#10;
         |PINTA #0#11;
     |FINSI;
|FPRC;

|PROCESO agim0024;
     aAlfa = #124#4;  |QBF aAlfa;
     |SI aAlfa = "";
         #0#9  = "";
         #0#10 = "";
         #0#11 = "";
     |SINO;
         aAlfa = #999#9;    |QBF aAlfa;

         aAlfa1 = #124#4;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
         aAlfa1 = #124#3;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
         aAlfa1 = #124#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
         aAlfa1 = #124#7;   aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
         aAlfa1 = #124#8;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
         aAlfaP = aAlfa;    |QBF aAlfaP;

         aAlfa = #999#10;   |QBF aAlfa;

         aAlfa1 = #124#4;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
         aAlfa1 = #124#3;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
         aAlfa1 = #124#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
         aAlfa1 = #124#7;   aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
         aAlfa1 = #124#8;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
         aAlfaS = aAlfa;    |QBF aAlfaS;

         aAlfa = #999#11;   |QBF aAlfa;

         aAlfa1 = #124#4;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
         aAlfa1 = #124#3;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
         aAlfa1 = #124#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
         aAlfa1 = #124#7;   aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
         aAlfa1 = #124#8;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
         aAlfaT = aAlfa;    |QBF aAlfaT;

         aAlfa = aAlfaP + " " + aAlfaS + " " + aAlfaT;
         #0#9  = aAlfa % 168;
         #0#10 = aAlfa % 6968;
         #0#11 = aAlfa % 13768;
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE agim0024;
     #124#2;
     ;
     #0#1, 99, 01;
     #0#1, 01, 99;
     ;
     NULL, agim0024;
|FIN;

|PROCESO dsmom001;
     nComuneros = 1;

     |SALVA_DATOS #100;

     |ABRE #100;
     #100#0 = #1#3;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     aAlfa = #999#9;    |QBF aAlfa;

     aAlfa1 = #100#1;    aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
     aAlfa1 = #100#13;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
     aAlfa1 = #100#11;   aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
     aAlfa1 = #100#3;    |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + #100#4;
                         aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
     aAlfa1 = #100#5;   a Alfa2 = "#NUMERO#";     |HAZ PonCadena2;
     aAlfaP = aAlfa;    |QBF aAlfaP;

     aAlfa = #999#10;   |QBF aAlfa;

     aAlfa1 = #100#1;    aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
     aAlfa1 = #100#13;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
     aAlfa1 = #100#11;   aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
     aAlfa1 = #100#3;    |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + #100#4;
                         aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
     aAlfa1 = #100#5;   a Alfa2 = "#NUMERO#";     |HAZ PonCadena2;
     aAlfaS = aAlfa;    |QBF aAlfaS;

     aAlfa = #999#11;   |QBF aAlfa;

     aAlfa1 = #100#1;    aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
     aAlfa1 = #100#13;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
     aAlfa1 = #100#11;   aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
     aAlfa1 = #100#3;    |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + #100#4;
                         aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
     aAlfa1 = #100#5;   a Alfa2 = "#NUMERO#";     |HAZ PonCadena2;
     aAlfaT = aAlfa;    |QBF aAlfaT;

     aAlfa = aAlfaP + " " + aAlfaS + " " + aAlfaT;
     #0#9  = aAlfa % 168;
     #0#10 = aAlfa % 6968;
     #0#11 = aAlfa % 13768;

     |REPON_DATOS #100;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #1#1;
     ;
     #0#1, 01, 0001;
     #0#1, 99, 9999;
     ;
     NULL, dsmom001;
|FIN;

|PROCESO CogeDatosEmpresas;
     #999#0 = 9;
     |LEE 101#999=;
     |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

     #0#3  = "";
     #0#4  = "";
     #0#5  = "";
     #0#6  = "";
     #0#7  = "";
     #0#8  = "";
     #0#9  = "";
     #0#10 = "";
     #0#11 = "";

     |ABRE #100;
     #100#0 = #0#1;
     |LEE 000#100=;
     |SI FSalida ! 0;
         |MENAV "0000 Empresa inexistente.";
         |ERROR;
         |CIERRA #100;
         |ACABA;
     |FINSI;
     |CIERRA #100;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "integral/def/dsam0003.mas";
     |XABRE "E", aMas, nHandle;
     |SI FSalida ] 0;
         |ABRE #103;
         #103#0 = #0#1;
         |LEE 000#103=;
         |SI FSalida ! 0;  |DDEFECTO #103;  |FINSI;
         |CIERRA #103;

         aAlfa = #103#5;  |QBF aAlfa;
         |SI aAlfa = "";
             #0#3 = "";
             #0#4 = "";
         |SINO;
             aAlfa = #999#3;    |QBF aAlfa;

             aAlfa1 = #103#5;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
             aAlfa1 = #103#1;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
             aAlfa1 = #100#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
             aAlfa1 = #100#3;   |QBF aAlfa1;
             aAlfa1 = aAlfa1 + " " + #100#4;
                                aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
             aAlfa1 = #100#5;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
             aAlfaP = aAlfa;    |QBF aAlfaP;

             aAlfa = #999#4;  |QBF aAlfa;

             aAlfa1 = #103#5;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
             aAlfa1 = #103#1;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
             aAlfa1 = #100#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
             aAlfa1 = #100#3;   |QBF aAlfa1;
             aAlfa1 = aAlfa1 + " " + #100#4;
                                aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
             aAlfa1 = #100#5;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
             aAlfaS = aAlfa;    |QBF aAlfaS;

             aAlfa = aAlfaP + " " + aAlfaS;
             #0#3  = aAlfa % 168;
             #0#4  = aAlfa % 6968;
         |FINSI;

         aAlfa = #103#39;  |QBF aAlfa;
         |SI aAlfa = "";
             #0#5 = "";
             #0#6 = "";
         |SINO;
             aAlfa = #999#5;    |QBF aAlfa;

             aAlfa1 = #103#39;  aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
             aAlfa1 = #103#35;  aAlfa2 = "#NIF#";        |HAZ PonCadena2;
             aAlfa1 = #100#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
             aAlfa1 = #100#3;   |QBF aAlfa1;
             aAlfa1 = aAlfa1 + " " + #100#4;
                                aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
             aAlfa1 = #100#5;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
             aAlfaP = aAlfa;    |QBF aAlfaP;

             aAlfa = #999#6;  |QBF aAlfa;

             aAlfa1 = #103#39;  aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
             aAlfa1 = #103#35;  aAlfa2 = "#NIF#";        |HAZ PonCadena2;
             aAlfa1 = #100#11;  aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
             aAlfa1 = #100#3;   |QBF aAlfa1;
             aAlfa1 = aAlfa1 + " " + #100#4;
                                aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
             aAlfa1 = #100#5;   aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
             aAlfaS = aAlfa;    |QBF aAlfaS;

             aAlfa = aAlfaP + " " + aAlfaS;
             #0#5  = aAlfa % 168;
             #0#6  = aAlfa % 6968;
         |FINSI;
     |FINSI;

     aAlfa  = #100#1;  |QBF aAlfa;
     aAlfa1 = #103#5;  |QBF aAlfa1;
     |SI aAlfa = "";  |O aAlfa1 ! "";
         #0#7 = "";
         #0#8 = "";
     |SINO;
         aAlfa = #999#7;    |QBF aAlfa;

         aAlfa1 = #100#1;    aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
         aAlfa1 = #100#13;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
         aAlfa1 = #100#11;   aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
         aAlfa1 = #100#3;    |QBF aAlfa1;
         aAlfa1 = aAlfa1 + " " + #100#4;
                             aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
         aAlfa1 = #100#5;   a Alfa2 = "#NUMERO#";     |HAZ PonCadena2;
         aAlfaP = aAlfa;    |QBF aAlfaP;

         aAlfa = #999#8;    |QBF aAlfa;

         aAlfa1 = #100#1;    aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
         aAlfa1 = #100#13;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
         aAlfa1 = #100#11;   aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
         aAlfa1 = #100#3;    |QBF aAlfa1;
         aAlfa1 = aAlfa1 + " " + #100#4;
                             aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
         aAlfa1 = #100#5;   a Alfa2 = "#NUMERO#";     |HAZ PonCadena2;
         aAlfaS = aAlfa;     |QBF aAlfaS;

         aAlfa = aAlfaP + " " + aAlfaS;
         #0#7  = aAlfa % 168;
         #0#8  = aAlfa % 6968;
     |FINSI;

     nComuneros = 0;
     |BUCLE dsmom001;

     |SI nComuneros = 0;
         |SI #100#20 = "S";
             |BUCLE agim0024;
         |SINO;
             |SI #100#18 = "S";
                 |ABRE #200;
                 #200#0 = #0#1;
                 |LEE 000#200=;
                 |SI FSalida ! 0;  |DDEFECTO #200;  |FINSI;
                 |CIERRA #200;

                 aAlfa = #200#15;  |QBF aAlfa;
                 |SI aAlfa = "";
                     #0#9  = "";
                     #0#10 = "";
                     #0#11 = "";
                 |SINO;
                     aAlfa = #999#9;    |QBF aAlfa;

                     aAlfa1 = #200#15;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
                     aAlfa1 = #200#17;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
                     aAlfaP = aAlfa;    |QBF aAlfaP;

                     aAlfa = #999#10;   |QBF aAlfa;

                     aAlfa1 = #200#15;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
                     aAlfa1 = #200#17;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
                     aAlfaS = aAlfa;    |QBF aAlfaS;

                     aAlfa = #999#11;   |QBF aAlfa;

                     aAlfa1 = #200#15;   aAlfa2 = "#NOMBRE#";     |HAZ PonCadena2;
                     aAlfa1 = #200#17;   aAlfa2 = "#NIF#";        |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#POBLACION#";  |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#DOMICILIO#";  |HAZ PonCadena2;
                     aAlfa1 = "";        aAlfa2 = "#NUMERO#";     |HAZ PonCadena2;
                     aAlfaT = aAlfa;    |QBF aAlfaT;

                     aAlfa = aAlfaP + " " + aAlfaS + " " + aAlfaT;

                     #0#9  = aAlfa % 168;
                     #0#10 = aAlfa % 6968;
                     #0#11 = aAlfa % 13768;
                 |FINSI;
            |FINSI;
         |FINSI;
     |FINSI;

     |HAZ Defectos;

     |PINTA #0#3;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
     |PINTA #0#7;
     |PINTA #0#8;
     |PINTA #0#9;
     |PINTA #0#10;
     |PINTA #0#11;
|FPRC;

|PROCESO AbreWord;
     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     |DBASS aBase;
     aOrigen   = aBase + "basica/word/word0035.doc";
     aDestino  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/word0035.doc";

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     nWord  = 1;
     aAbre  = aDestino;

     |WORD_ABRE nWord, aAbre;
     |WORD_PROPIEDADES nWord, "Visible", "NO";
|FPRC;

|PROCESO Asigna;
     aCadena = "";
     aLen    = aAsigna % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = aAsigna % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAsigna = aCadena;

     |PARA;  |SI;  |HACIENDO;
          |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;
          |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Mes;
   |SI aMes = "01";  aMes = "Enero     "; |FINSI;
   |SI aMes = "02";  aMes = "Febrero   "; |FINSI;
   |SI aMes = "03";  aMes = "Marzo     "; |FINSI;
   |SI aMes = "04";  aMes = "Abril     "; |FINSI;
   |SI aMes = "05";  aMes = "Mayo      "; |FINSI;
   |SI aMes = "06";  aMes = "Junio     "; |FINSI;
   |SI aMes = "07";  aMes = "Julio     "; |FINSI;
   |SI aMes = "08";  aMes = "Agosto    "; |FINSI;
   |SI aMes = "09";  aMes = "Septiembre"; |FINSI;
   |SI aMes = "10";  aMes = "Octubre   "; |FINSI;
   |SI aMes = "11";  aMes = "Noviembre "; |FINSI;
   |SI aMes = "12";  aMes = "Diciembre "; |FINSI;

   |QBF aMes;
|FPRC;

|PROCESO Asignacion;
     aAsigna = #0#3 + #0#4;  |QBF aAsigna;
     aIdenti = "!#1#";
     |HAZ Asigna;

     aAsigna = #0#5 + #0#6;  |QBF aAsigna;
     aIdenti = "!#2#";
     |HAZ Asigna;

     aAsigna = #0#7 + #0#8;  |QBF aAsigna;
     aIdenti = "!#3#";
     |HAZ Asigna;

     aAsigna = #0#9 + #0#10 + #0#11;  |QBF aAsigna;
     aIdenti = "!#4#";
     |HAZ Asigna;

     aAsigna = #0#12 + #0#13;  |QBF aAsigna;
     aIdenti = "!#5#";
     |HAZ Asigna;

     aAsigna = #0#15 + " al " + #0#16;
     aIdenti = "!#6#";
     |HAZ Asigna;

     aAsigna = #100#11;  |QBF aAsigna;
     aAsigna = aAsigna + " a " + (#0#2 % 102);
     aMes    = #0#2 % 402;  |HAZ Mes;
     aAsigna = aAsigna + " de " + aMes + " de " + (#0#2 % -104);
     aIdenti = "!#7#";
     |HAZ Asigna;

     aAsigna = #0#14;  |QBF aAsigna;
     aAsigna = aAsigna + " a " + (#0#2 % 102);
     aMes    = #0#2 % 402;  |HAZ Mes;
     aAsigna = aAsigna + " de " + aMes + " de " + (#0#2 % -104);
     aIdenti = "!#8#";
     |HAZ Asigna;

     aAsigna = #0#20;  |QBF aAsigna;
     aIdenti = "!#9#";
     |HAZ Asigna;
|FPRC;

|PROCESO GuardaDocumento;
     |ABRE #54;
     #54#0  = #0#1;
     #54#1  = 9999;
     |LEE 040#54];
     |SI FSalida = 0;
         |LEE 040#54a;
     |SINO;
         |LEE 040#54u;
     |FINSI;
     |SI FSalida = 0;  |Y #54#0 = #0#1;
         nLinea = #54#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #54;
     |HORA aAlfa;
     aAlfa1 = aAlfa % 102;
     aAlfa2 = aAlfa % 402;

     #54#0  = #0#1;
     #54#1  = nLinea;
     #54#2  = "CARTA OTORGAMIENTO DE REPRESENTACION VIA TELEMATICA DE MODELOS";
     #54#3  = "DOC" + (("00000" + #54#0) % -105) + (("0000" + #54#1) % -104) + ".DOC";
     #54#4  = ~;
     #54#5  = aAlfa1;
     #54#6  = aAlfa2;
     #54#7  = ~;
     #54#8  = aAlfa1;
     #54#9  = aAlfa2;
     #54#10 = #0#18;
     #54#11 = "";
     #54#12 = "";
     |GRABA 020#54n;
     |LIBERA #54;
     |CIERRA #54;

     aOrigen  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/word0035.doc";
     aDestino = eaRutaDocumento + "/" + "DOC" + (("00000" + #0#1) % -105) + (("0000" + nLinea) % -104) + ".DOC";
     |QBT aOrigen;
     |QBT aDestino;

     |RCOPIA_FICHERO aOrigen, aDestino;
     |SI FSalida ! 0;
         |MENAV "     No se ha podido copia el Documento al Cliente.";
     |FINSI;
|FPRC;

|PROCESO Cierre;
     |WORD_IMPRIME nWord, "";
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |SLEEP 10;

     |MENSA "      Cerrando Documento";

     |WORD_SALVA nWord, "";

     |SI #0#17 = "S";  |HAZ GuardaDocumento;  |FINSI;

     |RFBORRA aAbre;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ BuscaUbicacion;

     |MENSA "      Abriendo el Documento, espere un Momento.";
     |HAZ AbreWord;

     |MENSA "      Cargando Campos, espere un Momento.";
     |HAZ Asignacion;

     |MENSA "      Imprimiendo, espere un Momento.";
     |HAZ Cierre;
|FPRC;

|PROCESO CargaDef;
     |DBASE aBaseAplica;  |QBF aBaseAplica;
     aBaseAplica = aBaseAplica + "def/dsmoy055.mas";
     |CARGA_DEF aBaseAplica, dsmoy055@;

     |ABRE #999;
|FPRC;

|PROCESO DesCargaDef;
     |CIERRA #999;

     |DESCARGA_DEF #dsmoy055@;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     |CLS;
     |CABEZA "Carta Otorgamiento de Representacion";

     |SUB_EJECUTA_NP ":basica/wordm000;CREALOS";

     |DBASS aPath; |QBF aPath;
     aPathDoc = aPath + "basica/word/";

     nBytes = 0;
     aAbre = aPathDoc + "word0035.doc";
     |XABRE "B", aAbre, nHandle;
     |SI FSalida < 0;
         nBytes = 1;
||       |MENAV "     Instale Ficheros patrones (Documentos en Word)";
     |SINO;
         nBytes = 0;
         |XPOSICION nHandle, nBytes, 2;
     |FINSI;
     |XCIERRA nHandle;

     |SI nBytes = 1;  |O nBytes = 22016;
         |ABRE #400;
         #400#0 = "modelos";
         #400#1 = "dsmoy055";
         #400#2 = "word0035.doc";
         |LEE 101#400=;
         |SI FSalida = 0;
             |BORRA 020#400a;
             |LIBERA #400;
             |FBORRA aAbre;
         |FINSI;
         |CIERRA #400;

         |SUB_EJECUTA_NP ":basica/wordm000;CREALOS";
     |FINSI;

     |HAZ CargaDef;

     |ABRET #0;
     #0#0 = 9;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 9;
         #0#3 = "#NOMBRE# N.I.F. #NIF#, con domicilio fiscal en ";
         #0#4 = "#POBLACION#, #DOMICILIO# n§ #NUMERO# ";
         #0#5 = "#NOMBRE# N.I.F. #NIF#, con domicilio fiscal en ";
         #0#6 = "#POBLACION#, #DOMICILIO# n§ #NUMERO# ";
         #0#7 = "#NOMBRE# N.I.F. #NIF#, con domicilio fiscal en ";
         #0#8 = "#POBLACION#, #DOMICILIO# n§ #NUMERO# ";
         #0#9  = "#NOMBRE# como representante legal seg£n documento  ";
         #0#10 = "justificativo que se adjunta, con N.I.F. #NIF#, y domicilio";
         #0#11 = "fiscal en #POBLACION#, #DOMICILIO# n§ #NUMERO#";

         |GRABA 020#0n;
     |FINSI;
     |LIBERA #0;

     #0#0 = 1;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = 1;
         |GRABA 020#0b;
     |FINSI;

     |PDEFECTO #0, 1, 12;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;

     |HAZ DesCargaDef;
|FPRO;
