|FICHEROS;
   dsmorexp #0;

   dsm210dp #10;
   dsminmex #11;
   dsmivcex #12;
   dsm210db #13;

   reacceso@ #100;
   rem00100@ #101;
   rem00021@ #102;
   rem00002@ #103;
   rem00003@ #104;
   agimunic@ #105;
   rpaises@  #106;
   reauxpai@ #107;
|FIN;

|VARIABLES;
   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aBase  = "";

   nCont   = 0;
   nHandle = 0;
   nEjerc  = 0;
   nSwCod  = 0;
   nCanal  = 0;
   nDel210 = 0;
|FIN;

|PROCESO Inmuebles;
   nDel210 = 1;
   #rem00003@#0 = #rem00002@#0;
   #rem00003@#1 = #rem00002@#1;
   |LEE 000#rem00003@.=;
   |SI FSalida ! 0;
      nDel210 = 0;
      |DDEFECTO #rem00003@;
   |FINSI;

   |SI #rem00002@#3 = "1"; |O #rem00002@#3 = "2"; |O #rem00002@#3 = "3"; |O #rem00002@#3 = "4"; |ACABA; |FINSI;
   |SI #rem00002@#3 = "V";
      |SI #rem00002@#8 = 0; |Y #rem00002@#9 = 0; |ACABA; |FINSI;
   |FINSI;

   #rem00021@#0 = #rem00002@#0;
   #rem00021@#1 = #rem00002@#1;
   |LEE 000#rem00021@.=;
   |SI FSalida ! 0; |DDEFECTO #rem00021@; |FINSI;

   |DDEFECTO #agimunic@;
   aAlfa = (("00" + #rem00021@#105) % -102) + (("000" + #rem00021@#106) % -103);
   #agimunic@#0 = aAlfa;
   |LEE 000#agimunic@.];
   |SI FSalida ! 0; |O #agimunic@#0 ! aAlfa; |DDEFECTO #agimunic@; |FINSI;

   |DDEFECTO #dsminmex;
   #dsminmex#0  = #rem00002@#0;
   #dsminmex#1  = #rem00002@#1;
   #dsminmex#2  = #rem00021@#14;
   #dsminmex#3  = "CALLE";
   #dsminmex#4  = #rem00002@#5;
   #dsminmex#5  = "NUM";
   aAlfa = (("00" + #rem00021@#105) % -102);
   #dsminmex#15 = aAlfa;
   aAlfa = (("000" + #rem00021@#106) % -103);
   #dsminmex#16 = aAlfa;
   #dsminmex#22 = #rem00002@#5;
   #dsminmex#23 = #agimunic@#1;
   #dsminmex#24 = #rem00021@#25;
   #dsminmex#25 = #rem00021@#26;
   #dsminmex#28 = #rem00021@#17;
   |SI #rem00002@#3 = "T"; #dsminmex#31 = 100; #dsminmex#32 = 0;   |FINSI;
   |SI #rem00002@#3 = "C"; #dsminmex#31 = 0;   #dsminmex#32 = 100; |FINSI;
   |SI #rem00002@#3 = "G"; #dsminmex#31 = 50;  #dsminmex#32 = 50;  |FINSI;
   |SI #rem00002@#3 = "V"; #dsminmex#31 = #rem00002@#8; #dsminmex#32 = #rem00002@#9; |FINSI;

   |SI nDel210 = 1;
      #dsminmex#3  = #rem00003@#122;
      #dsminmex#4  = #rem00003@#123;
      #dsminmex#6  = #rem00003@#124;
      #dsminmex#10 = #rem00003@#125;
      #dsminmex#11 = #rem00003@#126;
      #dsminmex#12 = #rem00003@#127;
      aAlfa = (("00" + #rem00003@#129) % -102);
      #dsminmex#15 = aAlfa;
      aAlfa = (("000" + #rem00003@#130) % -103);
      #dsminmex#16 = aAlfa;
      #dsminmex#17 = #rem00003@#128;

      |DDEFECTO #agimunic@;
      aAlfa = (("00" + #dsm210dp#20) % -102) + (("000" + #dsm210dp#21) % -103);
      #agimunic@#0 = aAlfa;
      |LEE 000#agimunic@.];
      |SI FSalida ! 0; |O #agimunic@#0 ! aAlfa; |DDEFECTO #agimunic@; |FINSI;
      #dsminmex#19 = #agimunic@#2;

      #dsm210dp#0 = #reacceso@#0;
      |LEE 101#dsm210dp.=;
      |SI FSalida = 0;
         #dsm210dp#6 = #rem00003@#131;
         #dsm210dp#7 = #rem00003@#131;

         #dsm210dp#37 = #rem00003@#37;
         #dsm210dp#38 = #rem00003@#38;
         #dsm210dp#39 = #rem00003@#39;
         #dsm210dp#41 = #rem00003@#40;
         #dsm210dp#42 = #rem00003@#41;
         #dsm210dp#43 = "NUM";
         #dsm210dp#44 = #rem00003@#42;
         #dsm210dp#48 = #rem00003@#43;
         #dsm210dp#49 = #rem00003@#44;
         #dsm210dp#50 = #rem00003@#45;
         #dsm210dp#52 = #rem00003@#49;
         #dsm210dp#53 = #rem00003@#47;
         #dsm210dp#54 = #rem00003@#48;
         #dsm210dp#55 = #rem00003@#49;
         #dsm210dp#57 = #rem00003@#50;
         #dsm210dp#58 = #rem00003@#46;

         |GRABA 020#dsm210dp.a; |LIBERA #dsm210dp;
      |FINSI;
   |FINSI;
   |GRABA 020#dsminmex.n;

   |DDEFECTO #dsmivcex;
   #dsmivcex#0 = #rem00002@#0;
   #dsmivcex#1 = #rem00002@#1;
   #dsmivcex#2 = nEjerc;
   #dsmivcex#3 = #rem00021@#15;
   #dsmivcex#4 = #rem00021@#17;
   |GRABA 020#dsmivcex.n;
|FPRC;

|DEFBUCLE Inmuebles;
#rem00002@#1002;
6;
#rem00100@#0, 01, "S";
#rem00100@#0, 99, "S";
;
NULL, Inmuebles;
|FIN;

|PROCESO Contribuyentes;
   #dsm210dp#0 = #reacceso@#0;
   |LEE 000#dsm210dp.=;
   |SI FSalida ! 0;
      #rem00100@#0 = #reacceso@#0;
      |LEE 000#rem00100@.=;
      |SI FSalida ! 0; |DDEFECTO #rem00100@; |FINSI;
      |SI #rem00100@#94 = "N"; |ACABA; |FINSI;

      #rem00002@#0 = #rem00100@#0;
      #rem00002@#1 = 1;
      |LEE 000#rem00002@.];
      |SI FSalida ! 0; |O #rem00002@#0 ! #rem00100@#0; |ACABA; |FINSI;

      |DDEFECTO #dsm210dp;
      #dsm210dp#0 = #reacceso@#0;
      |GRABA 020#dsm210dp.b;

      #dsm210dp#1  = #rem00100@#5;
      #dsm210dp#2  = #rem00100@#1;
      #dsm210dp#4  = #rem00100@#103;
      #dsm210dp#24 = #rem00100@#12;
      #dsm210dp#25 = #rem00100@#109;
      #dsm210dp#26 = #rem00100@#112;
      #dsm210dp#8  = #rem00100@#14;
      #dsm210dp#9  = #rem00100@#15;
      #dsm210dp#10 = #rem00100@#114;
      #dsm210dp#4  = #rem00100@#103;
      #dsm210dp#11 = #rem00100@#16;
      #dsm210dp#12 = #rem00100@#115;
      #dsm210dp#13 = #rem00100@#116;
      #dsm210dp#14 = #rem00100@#117;
      #dsm210dp#15 = #rem00100@#17;
      #dsm210dp#16 = #rem00100@#18;
      #dsm210dp#17 = #rem00100@#19;
      #dsm210dp#18 = #rem00100@#118;
      #dsm210dp#19 = #rem00100@#119;
      #dsm210dp#20 = #rem00100@#20;
      #dsm210dp#21 = #rem00100@#21;
      #dsm210dp#22 = #rem00100@#22;

      #dsm210dp#67 = #rem00100@#104;

      #dsm210dp#8  = #rem00100@#24;
      #dsm210dp#9  = #rem00100@#25;
      #dsm210dp#11 = #rem00100@#26;
      #dsm210dp#15 = #rem00100@#27;
      #dsm210dp#16 = #rem00100@#28;
      #dsm210dp#17 = #rem00100@#29;
      #dsm210dp#20 = #rem00100@#30;
      #dsm210dp#21 = #rem00100@#31;
      #dsm210dp#22 = #rem00100@#32;

      |DDEFECTO #agimunic@;
      aAlfa = (("00" + #dsm210dp#20) % -102) + (("000" + #dsm210dp#21) % -103);
      #agimunic@#0 = aAlfa;
      |LEE 000#agimunic@.];
      |SI FSalida ! 0; |O #agimunic@#0 ! aAlfa; |DDEFECTO #agimunic@; |FINSI;
      #dsm210dp#23 = #agimunic@#2;

      #dsm210dp#39 = #rem00100@#66;
      #dsm210dp#37 = #rem00100@#67;
      #dsm210dp#58 = #rem00100@#68;

      #reauxpai@#0 = #rem00100@#77;
      |LEE 000#reauxpai@.=;
      |SI FSalida ! 0; |DDEFECTO #reauxpai@; |FINSI;
      #dsm210dp#33 = #reauxpai@#2;


      #dsm210dp#27 = #rem00100@#120;
      #dsm210dp#28 = #rem00100@#121;
      #dsm210dp#29 = #rem00100@#122;
      #dsm210dp#30 = #rem00100@#123;
      #dsm210dp#31 = #rem00100@#124;
      #dsm210dp#32 = #rem00100@#125;
      aAlfa = #dsm210dp#27; |QBF aAlfa;
      aAlfa = aAlfa + #dsm210dp#28; |QBF aAlfa;
      |SI aAlfa = "";
         #dsm210dp#27 = #rem00100@#73;
         #dsm210dp#29 = #rem00100@#76;
         #dsm210dp#31 = #rem00100@#75;
         #dsm210dp#32 = #rem00100@#76;

         #reauxpai@#0 = #rem00100@#77;
         |LEE 000#reauxpai@.=;
         |SI FSalida ! 0; |DDEFECTO #reauxpai@; |FINSI;
         #dsm210dp#33 = #reauxpai@#2;
      |FINSI;

      #dsm210dp#64 = #rem00100@#39;
      #dsm210dp#65 = #rem00100@#35;
      #dsm210dp#67 = #rem00100@#104;
      #dsm210dp#71 = #rem00100@#44;
      #dsm210dp#72 = #rem00100@#45;
      #dsm210dp#73 = #rem00100@#114;
      #dsm210dp#74 = #rem00100@#46;
      #dsm210dp#75 = #rem00100@#115;
      #dsm210dp#76 = #rem00100@#116;
      #dsm210dp#77 = #rem00100@#117;
      #dsm210dp#78 = #rem00100@#47;
      #dsm210dp#79 = #rem00100@#48;
      #dsm210dp#80 = #rem00100@#49;
      #dsm210dp#83 = #rem00100@#50;
      #dsm210dp#84 = #rem00100@#51;
      #dsm210dp#85 = #rem00100@#52;
      #dsm210dp#87 = #rem00100@#13;
      #dsm210dp#88 = #rem00100@#110;
      #dsm210dp#89 = #rem00100@#129;
      #dsm210dp#90 = #rem00100@#137;
      #dsm210dp#91 = #rem00100@#138;
      #dsm210dp#92 = #rem00100@#139;
      #dsm210dp#93 = #rem00100@#140;
      #dsm210dp#94 = #rem00100@#141;
      #dsm210dp#95 = #rem00100@#142;

      aAlfa = #rem00100@#144; |QBF aAlfa;
      aAlfa = aAlfa > aAlfa;
      |SELECT #2#rpaises@;
      #rpaises@#1  = aAlfa;
      |LEE 000#rpaises@.=;
      |SI FSalida = 0;
         #dsm210dp#96 = #rpaises@#0;
      |SINO;
         #dsm210dp#96 = #rem00100@#143;
      |FINSI;
      |SELECT #1#rpaises@;

      #dsm210dp#97 = #rem00100@#13;
      #dsm210dp#98 = #rem00100@#110;
      #dsm210dp#99 = #rem00100@#129;

      |GRABA 020#dsm210dp.a; |LIBERA #dsm210dp;

      |DDEFECTO #dsm210db;
      #dsm210db#0 = #reacceso@#0;
      |GRABA 020#dsm210db.b;

      aAlfa = #rem00100@#53; |QBF aAlfa;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#2  = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#3  = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#4  = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#5  = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#6  = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#7  = aAlfa1;
      aAlfa = #rem00100@#54; |QBF aAlfa;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#27 = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#28 = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#29 = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#30 = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#31 = aAlfa1;
      aAlfa1 = aAlfa % 0104; aAlfa = aAlfa % 0599; #dsm210db#32 = aAlfa1;
      |GRABA 020#dsm210db.a; |LIBERA #dsm210db;

      |BUCLE Inmuebles;
   |FINSI;
|FPRC;

|DEFBUCLE Contribuyentes;
#reacceso@#1001;
;
00000;
99999;
;
NULL, Contribuyentes;
|FIN;

|PROGRAMA;
   |CLS;

   |CABEZA "Pase contribuyentes no residentes desde aplicacion anterior";

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida ! 0; |O #0#0 = "N"; |ACABA; |FINSI;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa1 = aAlfa + "basica/def/agimunic.mas"; |CARGA_DEF aAlfa1, agimunic@;
   aAlfa1 = aAlfa + "basica/fich/"; |PATH_DAT #agimunic@#aAlfa1#;
   |ABRE #agimunic@;

   |DBASS aAlfa; |QBF aAlfa;
   |PARA nCont = 2010; |SI nCont ] 2000; |HACIENDO nCont = nCont - 1;
      aAlfa1 = aAlfa + "ren" + nCont + "/def/rem00100.mas";
      |XABRE "E", aAlfa1, nHandle;
      |SI FSalida ] 0; |SAL; |FINSI;
   |SIGUE;

   aAlfa1 = aAlfa + "ren" + nCont + "/def/rem00100.mas";
   |XABRE "E", aAlfa1, nHandle;
   |SI FSalida ] 0;
       aAlfa1 = "ren" + nCont;
       nEjerc = nCont;
   |SINO;
      |ACABA;
   |FINSI;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + aAlfa1 + "/def/reacceso.mas";
   |CARGA_DEF aAlfa, reacceso@;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aAlfa1 + "/def/rem00100.mas";
      |CARGA_DEF aAlfa, rem00100@;

      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aAlfa1 + "/def/rem00021.mas";
      |CARGA_DEF aAlfa, rem00021@;

      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aAlfa1 + "/def/rem00002.mas";
      |CARGA_DEF aAlfa, rem00002@;

      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aAlfa1 + "/def/rem00003.mas";
      |CARGA_DEF aAlfa, rem00003@;

      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aAlfa1 + "/def/reauxpai.mas";
      |CARGA_DEF aAlfa, reauxpai@;

      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + aAlfa1 + "/fich/";
      |PATH_DAT #reacceso@#aAlfa#; |PATH_DAT #rem00100@#aAlfa#;
      |PATH_DAT #rem00021@#aAlfa#; |PATH_DAT #rem00002@#aAlfa#;
      |PATH_DAT #rem00003@#aAlfa#; |PATH_DAT #reauxpai@#aAlfa#;

      |ABRE #rem00100@; |ABRE #rem00021@; |ABRE #rem00002@; |ABRE #rem00003@;
      |ABRE #reauxpai@;
      |ABRE #dsm210dp;  |ABRE #dsminmex;  |ABRE #dsmivcex;  |ABRE #dsm210db;

      |DBASS aBase; |QBF aBase;
      aAlfa = aBase + "integral/def/dsam0000.mas";
      |XABRE "E", aAlfa, nCanal;
      |SI FSalida ] 0;
         aAlfa2 = aBase + "integral/def/dsam0104.mas";
         |CARGA_DEF aAlfa2, rpaises@; aAlfa = aBase + "integral/fich/";
         nSwCod = 1;
      |SINO;
         aAlfa2 = aBase + "basica/def/agim0016.mas";
         |CARGA_DEF aAlfa2, rpaises@; aAlfa = aBase + "basica/fich/";
         nSwCod = 2;
      |FINSI;
      |PATH_DAT #rpaises@#aAlfa#; |ABRE #rpaises@;

      |BUCLE Contribuyentes;

      |CIERRA #rpaises@;  |DESCARGA_DEF #rpaises@;
      |CIERRA #dsm210db;  |CIERRA #dsm210dp;  |CIERRA #dsminmex;  |CIERRA #dsmivcex;
      |CIERRA #rem00100@; |CIERRA #rem00021@; |CIERRA #rem00002@; |CIERRA #rem00003@;

      |CIERRA #reauxpai@; |DESCARGA_DEF #reauxpai@;
      |CIERRA #rem00003@; |DESCARGA_DEF #rem00003@;
      |CIERRA #rem00002@; |DESCARGA_DEF #rem00002@;
      |CIERRA #rem00021@; |DESCARGA_DEF #rem00021@;
      |CIERRA #rem00100@; |DESCARGA_DEF #rem00100@;
      |CIERRA #reacceso@; |DESCARGA_DEF #reacceso@;
   |FINSI;

   |CIERRA #agimunic@; |DESCARGA_DEF #agimunic@;
|FPRO;
