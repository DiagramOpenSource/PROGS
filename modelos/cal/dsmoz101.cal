|FICHEROS;
     dsmoz101;
     dsmom007 #7;
     dsmom117 #117,MANTE;
|FIN;

|VARIABLES;
      nEjer      = 0;
      nEjerA     = 0;
      aAlfa      = "";
      aFichero   = "";
      nGrupo     = 0;
      nNumero    = 0;
      aMas       = "";
      aBase      = "";
      nAny       = 0;
      nClau      = 0;
      &eaExtension = "";
      &eaPrograma  = "";
|FIN;

|RUTINA ClaveBaja117;
     #117#8 = #dsmoz101#0;
     #117#0 = 1;
     #117#1 = 00;
     nClau  = 1;
|FRUT;

|RUTINA ClaveAlta117;
     #117#8 = #dsmoz101#0;
     #117#0 = 9;
     #117#1 = 99;
|FRUT;

|RUTINA ClaveBaja117_2;
     #117#8 = #dsmoz101#0;
     #117#7 = 0001;
     #117#0 = 0;
     #117#1 = 0;

     nClau  = 2;
|FRUT;

|RUTINA ClaveAlta117_2;
     #117#8 = #dsmoz101#0;
     #117#7 = 9999;
     #117#0 = 9;
     #117#1 = 99;
|FRUT;

|RUTINA ClaveBaja117_4;
     #117#8 = #dsmoz101#0;
     #117#9 = 0001;
     #117#0 = 0;
     #117#1 = 0;

     nClau  = 4;
|FRUT;

|RUTINA ClaveAlta117_4;
     #117#8 = #dsmoz101#0;
     #117#9 = 9999;
     #117#0 = 9;
     #117#1 = 99;
|FRUT;

|RUTINA ClaveBaja7;
     #7#0 = 1;
     #7#1 = 00;
|FRUT;

|RUTINA ClaveAlta7;
     #7#0 = 9;
     #7#1 = 99;
|FRUT;

|PROCESO Tipo5;  |TIPO 5;
     |LEE 040#117p;
     |SI nClau = 1;
         |LINEAS_BI_ATRI #117#3, S, I, -1;
     |SINO;
         #117#3 = "T";
         |LINEAS_BI_ATRI #117#3, S, I, -1;
     |FINSI;
|FPRC;

|PROCESO Tipo7; |TIPO 7;
    |SI #dsmoz101#0 = 2010;
        |PINPA #0#7;
        |ENTLINEAL #1#7, -1, 7, 22, 0, ClaveBaja7, ClaveAlta7;
    |SINO;
        |MENSA "    Consulta: <F2> Orden en Pantalla Mod.303, <F3> Orden en Pantalla Mod.322";

        |PINPA #0#117;
        |ENTLINEAL #1#117, -2, 7, 22, 0, ClaveBaja117, ClaveAlta117;
    |FINSI;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
   |SI FSalida = 10; |Y #dsmoz101#0 ] 2011;
       |PINPA #0#117;
       |ENTLINEAL #3#117, -2, 5, 22, 0, ClaveBaja117_2, ClaveAlta117_2;
   |FINSI;
   |SI FSalida = 11; |Y #dsmoz101#0 ] 2011;
       |PINPA #0#117;
       |ENTLINEAL #4#117, -2, 5, 22, 0, ClaveBaja117_4, ClaveAlta117_4;
   |FINSI;
|FPRC;

|PROCESO Tipo0;
    |ENTLINEAL #1#117, -2, 3, 22, 0, ClaveBaja117, ClaveAlta117;
|FPRC;

|PROCESO Crea117_M322;
  |SI #117#9 = 0; #117#9 = #117#7; |FINSI;
  |GRABA 020#117a;
  |LIBERA #117;
|FPRC;

|DEFBUCLE Crea117_M322;
  #117#1;
  ;
  nEjer, 0, 00;
  nEjer, 9, 99;
  e;
  NULL, Crea117_M322;
|FIN;

|PROCESO Crea117;
  #117#8 = nEjer;
  |SI #117#9 = 0; #117#9 = #117#7; |FINSI;
  |GRABA 020#117n;
  |LIBERA #117;
|FPRC;

|DEFBUCLE Crea117;
  #117#1;
  ;
  nEjerA, 0, 00;
  nEjerA, 9, 99;
  e;
  NULL, Crea117;
|FIN;

|PROCESO Baja100;
     |SI FSalida = "POSICION";
         #dsmoz101#0 = nEjer;
     |SINO;
         #dsmoz101#0 = 2010;
     |FINSI;
|FPRC;

|PROCESO Alta100;
     #dsmoz101#0 = nEjer;
|FPRC;

|PROGRAMA;
     aFichero = "dsmoz101" + Usuario;
     |NOME_DAT #dsmoz101#aFichero#;

     |ABRE #dsmoz101;  |CIERRA #dsmoz101;  |DELINDEX #dsmoz101;

     nEjer = 2018;

     |ABRE #dsmoz101;
     |LEE 000#dsmoz101.p;
     |SI FSalida ! 0;
         #dsmoz101#0 = 2010; |GRABA 020#dsmoz101.n;  |LIBERA #dsmoz101;
         #dsmoz101#0 = 2011; |GRABA 020#dsmoz101.n;  |LIBERA #dsmoz101;
         #dsmoz101#0 = 2014; |GRABA 020#dsmoz101.n;  |LIBERA #dsmoz101;
         #dsmoz101#0 = 2015; |GRABA 020#dsmoz101.n;  |LIBERA #dsmoz101;
         #dsmoz101#0 = 2018; |GRABA 020#dsmoz101.n;  |LIBERA #dsmoz101;
     |FINSI;

     |ABRE #dsmom117;
     #117#8 = nEjer;
     #117#0 = 1;
     #117#1 = 1;
     |LEE 041#117=;
     |SI FSalida ! 0;
         |CIERRA #117;
         nEjerA = nEjer - 1;
         |SI nEjer = 2018; nEjerA = 2015; |FINSI;
         |BUCLE Crea117;
     |SINO;
         |CIERRA #117;
         |SI #117#9 = 0;
             |BUCLE Crea117_M322;
         |FINSI;
     |FINSI;

/*
     |ABRE #117;
     |CONSULTA_CLAVE #1#117;
     |CIERRA #117;
*/
     |CLS;
     |PINPA #0#dsmoz101;
     |ENTLINEAL #1#dsmoz101, -1, 4, 22, 0, Baja100, Alta100;

     |CIERRA #dsmoz101; |DELINDEX #dsmoz101;
|FPRO;
