|FICHEROS;
     dsmow006 #998;
     dsmom011 #11,MANTE;

     espejos@ #111;
|FIN;

|VARIABLES;
     aConcepto   = "";
     aDef        = "";
     aPathModelo = "";
     aAlfa       = "";

     nDosIntro   = 0;
     nCampo      = 0;
     nCampo1     = 0;
     nPeriodoMin = 0;
     nModo       = 0;
     nInkey      = 0;
     nEjer       = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO DosIntrom011;  |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 4;  |ACABA;  |FINSI;
     aAlfa = "     ";
     |SI #11#2 = 3; aAlfa = "    Pulse <F2> para recoger Exis. Finales Ejercicio Anterior"; |FINSI;
     |MENSA aAlfa;

     |SI nDosIntro = 0;
         |PTEC 802;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Teclam011;  |TIPO 0;
     nInkey = FSalida;
     |SI nInkey = 10;  |ACABA; |FINSI;

     |SI nInkey = 2;
         |PTEC 802;
         |PTEC 802;
         |PTEC 808;

         aConcepto = "";
         nDosIntro = 1;
         |ACABA;
     |FINSI;

     |SI nInkey = 1;
         |PTEC 806;
         nDosIntro = 1;
         aConcepto = #11#5;
         |ACABA;
     |FINSI;

     |SI aConcepto = #11#5;
         |ERROR;
         aConcepto = "";
     |SINO;
         nDosIntro = 0;
         aConcepto = #11#5;
     |FINSI;
|FPRC;

|PROCESO OchoIntrom011;  |TIPO 7;
     aAlfa = "     ";
     |SI #11#2 = 3;
         aAlfa = "    Pulse <F2> para recoger Exis. Finales Ejercicio Anterior";
     |FINSI;
     |MENSA aAlfa;
|FPRC;

|PROCESO LeoEspejos;
         #11#0 = #111#0;
         #11#3 = #111#3;
         #11#4 = #111#4;
         #11#5 = #111#5;
         |LEE 141#11=;
         |SI FSalida = 0;
             #11#8 = #111#9;
             |GRABA 020#11a;
         |FINSI;
         |LIBERA #11;
|FPRC;

|DEFBUCLE LeoEspejos;
 #111#1006;
 ;
 #11#0, nEjer, 12, #11#3, #11#4, "    ";
 #11#0, nEjer, 12, #11#3, #11#4, "zzzz";
 e;
 NULL, LeoEspejos;
|FIN;

|PROCESO ExistenciaIni;
     nPeriodoMin = 1;
     |SI #998#7  = "X";  |O #998#14 = "X"; nPeriodoMin = 3;  |FINSI;

     |SI #11#2 ! nPeriodoMin;
         |SI nInkey = 10; |ERROR; |ACABA; |FINSI;

         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/dsmom011.mas";
         |CARGA_DEF aDef, espejos@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def " + eaNomDef;
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |ABRE #111;
         #111#0 = #11#0;
         #111#1 = #11#1;
         #111#2 = #11#2 - nPeriodoMin;
         #111#3 = #11#3;
         #111#4 = #11#4;
         #111#5 = #11#5;
         |LEE 040#111=;
         |SI FSalida = 0;
             #11#8 = #111#8;
         |FINSI;
         |CIERRA #111;

         |DESCARGA_DEF #espejos@;

         |PINTA #11#8;
     |SINO;
         |SI nInkey = 10;
             |DBASE aPathModelo;  |QBT aPathModelo;
             aDef = aPathModelo + "def/dsmom011.mas";
             |CARGA_DEF aDef, espejos@;
             |SI FSalida ! 0;
                 aAlfa = "     Error en cargar el Def " + eaNomDef;
                 |MENAV aAlfa;
                 |ERROR;
             |FINSI;

             nEjer       = #11#1 - 1;
             nPeriodoMin = #11#2;
             |ABRE #111;
             #111#0 = #11#0;
             #111#1 = nEjer;
             #111#2 = 12;
             #111#3 = #11#3;
             #111#4 = #11#4;
             #111#5 = #11#5;
             |LEE 040#111=;
             |SI FSalida = 0;
                 #11#8 = #111#9;
             |FINSI;
             |CIERRA #111;

             |PINTA #11#8;
             |SALVA_DATOS #11;

             |BUCLE LeoEspejos;
             |REPON_DATOS #11;

             |DESCARGA_DEF #espejos@;

             |PTEC 806;

             |PONCONTROL  23, "SI";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Descarga11;
     nDosIntro = 0;
|FPRC;
