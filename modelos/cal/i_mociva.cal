|| borrar todo lo que es referente a otros modelos diferentes al 300 y 303

|FICHEROS;
     dsmociva #0;
     dsmom007 #7;
     dsmom117 #117;
     dsmom004 #4;
     dsmom008 #8;

     dsmom028 #28;
     dsmom087 #87;

     dsmom047 #47;

     dsmom103 #103;
     dsmom109 #109;

     dsmod300 #300;
     dsmod303 #303;
     dsm30301 #304;

     dsmod320 #320;
     dsmod330 #330;
     dsmod332 #332;
     dsmod370 #370;
     dsmod310 #310;

     dsmow002 #99;

     :/basica/def/agicen14 #402;

     dsmocivp #165;
|FIN;

|VARIABLES;
     nCampo68    = 0;
     nCampo1     = 0;
     nCampo2     = 0;
     nCampo3     = 0;
     nCampo11    = 0;
     nCampo22    = 0;
     nCampo33    = 0;
     nValor1     = 0;
     nValor2     = 0;
     &nGrupo     = 0;
     &nSubGrupo  = 0;
     nPeriodoMin = 0;
     nEjerAnt    = 0;
     nSwAcum     = 0;
     nDesde      = 0;
     nHasta      = 0;
     nContador   = 0;
     nResult     = 0;
     nSwGraba    = 0;
     nAnyo       = 0;
     nPer        = 0;
     nTipo       = 0;
     nPeriodo    = 0;
     nDepar      = 0;
     nEjer       = 0;
     nModAnter   = 0;
     nIVA        = 0;
     nIVA1       = 0;
     nIVA2       = 0;
     nIVA3       = 0;
     nIVA4       = 0;
     nIVA5       = 0;
     nIVA6       = 0;
     nIVA7           = 0;
     nIVA10          = 0;
     nIVA13          = 0;
     nIVA16          = 0;
     nIVA19          = 0;
     nIVA22          = 0;
     nIVA25          = 0;
     nIVA28          = 0;
     nIVA31          = 0;
     nSubeIVA        = 0;
     nImporte1       = 0;
     nImporte2       = 0;

     aAlfa       = "";

     &aFitxer300 = "";
     &aFitxer301 = "";
     &aFitxer87  = "";
     &enPregunta = 0;

     nCuotaMas   = 0;
     nBaseMas    = 0;
     &enProAct   = 0;
     &enProCom   = 0;
     &nEjerCarga  = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO BajaModelo;
     |BORRA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsmocivaB;
     #0#1;
     ;
     enEmpresa, enEjer, enPeriodo, 000, enComplem, enActividad, 0,  0;
     enEmpresa, enEjer, enPeriodo, 999, enComplem, enActividad, 9, 99;
     be;
     NULL, BajaModelo;
|FIN;

|PROCESO Bajadsmom087;
     |BORRA 020#87a;
     |LIBERA #87;
|FPRC;

|DEFBUCLE dsmom087B;
     #87#1;
     ;
     enEmpresa, enEjer, enPeriodo, 000, enComplem, enActividad, 0,  0;
     enEmpresa, enEjer, enPeriodo, 999, enComplem, enActividad, 9, 99;
     be;
     NULL, Bajadsmom087;
|FIN;


|PROCESO LeeCasilla;
     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = nGrupo;
     #0#7  = nSubGrupo;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
|FPRC;

|| ///////////////////////////////////////////
|| ///////////////// Procesos Grabacion de Modelos \\\\\\\\\\\\\\\\\\\\

|PROCESO EjerAnt;
      nEjerAnt = nEjerAnt + #103#5;
|FPRC;

|DEFBUCLE dsmom103;
     #103#1;
     ;
     nModAnter, enEmpresa, 00, nAnyo, nPer;
     nModAnter, enEmpresa, 99, nAnyo, nPer;
     ;
     NULL, EjerAnt;
|FIN;

|PROCESO LeeComplem;
  |SI nModAnter = 332; nEjerAnt = #332#67; |FINSI;
  |SI nModAnter = 330; nEjerAnt = #330#67; |FINSI;
  |SI nModAnter = 320; nEjerAnt = #320#65; |FINSI;
  |SI nModAnter = 300; nEjerAnt = #300#63; |FINSI;
  |SI nModAnter = 303; nEjerAnt = #303#61; |FINSI;
  |SI nModAnter = 310; nEjerAnt = #310#38; |FINSI;
  |SI nModAnter = 370; nEjerAnt = #370#84; |FINSI;
|FPRC;

|DEFBUCLE LeeCompl332;
  #332#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|DEFBUCLE LeeCompl330;
  #330#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|DEFBUCLE LeeCompl320;
  #320#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|DEFBUCLE LeeCompl300;
  #300#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|DEFBUCLE LeeCompl303;
  #303#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|DEFBUCLE LeeCompl310;
  #310#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|DEFBUCLE LeeCompl370;
  #370#1;
  ;
  enEmpresa, #4#1, #4#2, nModAnter, 00, 00;
  enEmpresa, #4#1, #4#2, nModAnter, 99, 00;
  ;
  NULL, LeeComplem;
|FIN;

|PROCESO Recoge2013;
     nPeriodoMin = 1;
     |SI enModelo = 300; nPeriodoMin = 3;  |FINSI;

     |SI enModelo = 303;
         |ABRE #dsmom004;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = enEjer;
         #dsmom004#2 = enPeriodo;
         #dsmom004#3 = enModelo;
         #dsmom004#4 = enComplem;
         |LEE 040#dsmom004.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom004;  |FINSI;

         |SI #dsmom004#22 = "M";
             nPeriodoMin = 1;
         |SINO;
             nPeriodoMin = 3;
         |FINSI;
         |CIERRA #dsmom004;
     |FINSI;

     |ABRE #dsmom004;
     #dsmom004#0 = enEmpresa;
     #dsmom004#3 = nModAnter;
     #dsmom004#4 = enComplem;
     |SI enPeriodo = nPeriodoMin;
         nAnyo     = enEjer - 1;
         nPer      = 12;
         nModAnter = 0;
     |SINO;
         nAnyo     = enEjer;
         nPer      = enPeriodo - nPeriodoMin;
         nModAnter = enModelo;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 303;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 300;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 320;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 332;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 330;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 310;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 370;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     #dsmom004#0 = enEmpresa;
     #dsmom004#1 = nAnyo;
     #dsmom004#2 = nPer;
     #dsmom004#3 = nModAnter;
     #dsmom004#4 = 0;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom004;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = nModAnter;
     |FINSI;
     |CIERRA #dsmom004;

     nEjerAnt = 0;
     |SI nModAnter = 300;
         |CIERRA #dsmod300;
         |BUCLE LeeCompl300;
         |ABRE #dsmod300;
     |FINSI;

     |SI nModAnter = 303;
         |CIERRA #dsmod303;
         |BUCLE LeeCompl303;
         |ABRE #dsmod303;
     |FINSI;

     |SI nModAnter = 320;
         |CIERRA #dsmod320;
         |BUCLE LeeCompl320;
         |ABRE #dsmod320;
     |FINSI;

     |SI nModAnter = 330;
         |CIERRA #dsmod330;
         |BUCLE LeeCompl330;
         |ABRE #dsmod330;
     |FINSI;

     |SI nModAnter = 332;
         |CIERRA #dsmod332;
         |BUCLE LeeCompl332;
         |ABRE #dsmod332;
     |FINSI;

     |SI nModAnter = 310;
         |BUCLE LeeCompl310;
     |FINSI;

     |SI nModAnter = 370;
         |BUCLE LeeCompl370;
     |FINSI;

     |SI nEjerAnt = 0;
         |BUCLE dsmom103;
     |FINSI;

     |ABRE #dsmom047;
     #dsmom047#0 = enEmpresa;
     #dsmom047#1 = enEjer;
     #dsmom047#2 = enPeriodo;
     #dsmom047#3 = enModelo;
     #dsmom047#4 = enComplem;
     #dsmom047#5 = 0;
     |LEE 040#dsmom047.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom047;  |FINSI;
     |CIERRA #dsmom047;

     |ABRE #dsmom028;
     #dsmom028#0 = enEmpresa;
     #dsmom028#1 = enEjer;
     #dsmom028#2 = enPeriodo;
     #dsmom028#3 = enModelo;
     #dsmom028#4 = enComplem;
     #dsmom028#5 = 0;
     |LEE 040#dsmom028.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom028;  |FINSI;
     |CIERRA #dsmom028;

     |SI #dsmom028#7 = "N";  #dsmom028#6 = 0;  |FINSI;

     nEjerAnt = nEjerAnt - #dsmom028#6;
     |SI nEjerAnt < 0;  nEjerAnt = 0;  |FINSI;
|FPRC;

|PROCESO MiraPrescripcion;
     |ABRE #dsmom028;
     |DDEFECTO #dsmom028;
     #dsmom028#0 = enEmpresa;
     #dsmom028#1 = enEjer;
     #dsmom028#2 = enPeriodo;
     #dsmom028#3 = enModelo;
     #dsmom028#4 = enComplem;
     #dsmom028#5 = 0;
     |LEE 040#dsmom028.=;
     |SI FSalida ! 0; |O #dsmom028#7 ! "S";
         |CIERRA #dsmom028;
         |ACABA;
     |FINSI;
     |CIERRA #dsmom028;

     nEjerAnt  = nEjerAnt + #dsmom028#6;

     nImporte1 = #dsm30301#83 + #dsm30301#95 + #dsm30301#85;

     |ABRE #dsmom004;
     #dsmom004#0 = enEmpresa;
     #dsmom004#1 = enEjer;
     #dsmom004#2 = enPeriodo;
     #dsmom004#3 = enModelo;
     #dsmom004#4 = enComplem;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom004;  |FINSI;
     |CIERRA #dsmom004;

     |SI nImporte1 ] 0;
         nImporte2 = nImporte1 - #dsmom028#8;
         |SI nImporte2 ] 0;
             #dsmom028#6 = 0;
         |SINO;
             #dsmom028#6 = - nImporte2;
         |FINSI;
     |SINO;
        #dsmom028#6 = #dsmom028#8;
     |FINSI;

     |SI #dsmom004#23 = "S"; |O #dsm30301#2 = 12;
         |HAZ UltimoPeriodo;
         |SI eaUltimoPer = "DEVOLVER ";
             #dsmom028#6 = 0;
         |FINSI;
     |FINSI;

     nEjerAnt = nEjerAnt - #dsmom028#6;
|FPRC;



|PROCESO LeeComplem30301;
     nEjerAnt = #304#89;
|FPRC;

|DEFBUCLE LeeCompl30301;
     #304#1;
     ;
     enEmpresa, #dsmom004#1, #dsmom004#2, nModAnter, 00, 00;
     enEmpresa, #dsmom004#1, #dsmom004#2, nModAnter, 99, 00;
     ;
     NULL, LeeComplem30301;
|FIN;

|PROCESO Recoge2014;
     nPeriodoMin = 1;

     |ABRE #dsmom004;
     #dsmom004#0 = enEmpresa;
     #dsmom004#1 = enEjer;
     #dsmom004#2 = enPeriodo;
     #dsmom004#3 = enModelo;
     #dsmom004#4 = enComplem;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom004;  |FINSI;

     |SI #dsmom004#22 = "M";
         nPeriodoMin = 1;
     |SINO;
         nPeriodoMin = 3;
     |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsmom004;
     #dsmom004#0 = enEmpresa;
     #dsmom004#3 = enModelo;
     #dsmom004#4 = enComplem;
     |SI enPeriodo = nPeriodoMin;
         nAnyo     = enEjer - 1;
         nPer      = 12;
     |SINO;
         nAnyo     = enEjer;
         nPer      = enPeriodo - nPeriodoMin;
     |FINSI;

     nModAnter   = 0;
     #dsmom004#0 = enEmpresa;
     #dsmom004#1 = nAnyo;
     #dsmom004#2 = nPer;
     #dsmom004#3 = 303;
     #dsmom004#4 = 0;
     |LEE 040#dsmom004.=;
     |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 310;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     |SI nModAnter = 0;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = 370;
         #dsmom004#4 = 0;
         |LEE 040#dsmom004.=;
         |SI FSalida = 0;  nModAnter = #dsmom004#3;  |FINSI;
     |FINSI;

     #dsmom004#0 = enEmpresa;
     #dsmom004#1 = nAnyo;
     #dsmom004#2 = nPer;
     #dsmom004#3 = nModAnter;
     #dsmom004#4 = 0;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmom004;
         #dsmom004#0 = enEmpresa;
         #dsmom004#1 = nAnyo;
         #dsmom004#2 = nPer;
         #dsmom004#3 = nModAnter;
     |FINSI;
     |CIERRA #dsmom004;

     nEjerAnt = 0;
     |SI nModAnter = 303;
         |SI #dsmom004#1 [ 2013;
             |BUCLE LeeCompl303;
         |FINSI;

         |SI #dsmom004#1 ] 2014;
             |BUCLE LeeCompl30301;
         |FINSI;
     |FINSI;

     |SI nModAnter = 370;
         |BUCLE LeeCompl370;
     |FINSI;

     |SI nEjerAnt = 0;
         nModAnter = enModelo;
         |BUCLE dsmom103;
     |FINSI;

     |ABRE #dsmom047;
     #dsmom047#0 = enEmpresa;
     #dsmom047#1 = enEjer;
     #dsmom047#2 = enPeriodo;
     #dsmom047#3 = enModelo;
     #dsmom047#4 = enComplem;
     #dsmom047#5 = 0;
     |LEE 040#dsmom047.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom047;  |FINSI;
     |CIERRA #dsmom047;

     |ABRE #dsmom028;
     #dsmom028#0 = enEmpresa;
     #dsmom028#1 = enEjer;
     #dsmom028#2 = enPeriodo;
     #dsmom028#3 = enModelo;
     #dsmom028#4 = enComplem;
     #dsmom028#5 = 0;
     |LEE 040#dsmom028.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom028;  |FINSI;
     |CIERRA #dsmom028;

     |SI #dsmom028#7 = "N";  |ACABA;  |FINSI;

     nEjerAnt = nEjerAnt - #dsmom028#6;
     |SI nEjerAnt < 0;  nEjerAnt = 0;  |FINSI;
|FPRC;

|PROCESO RecogeAnter;
     |SI enEjer [ 2013;  |HAZ Recoge2013;  |FINSI;
     |SI enEjer ] 2014;  |HAZ Recoge2014;  |FINSI;
|FPRC;

|| ///////// Modelo 300 \\\\\\\\\\\\

|PROCESO GrabaDevengado300;
     |SI #0nCampo3 = 0;  |ACABA;  |FINSI;
     nSwAcum       = 0;

     |PARA nCampo33 = nDesde;  |SI nCampo33 [ nHasta;  |HACIENDO nCampo33 = nCampo33 + 3;
           nCampo11 = nCampo33 - 2;
           nCampo22 = nCampo33 - 1;
           |SI #300nCampo22 = #0nCampo2;
               #300nCampo11 = #300nCampo11 + #0nCampo1;
               #300nCampo33 = #300nCampo33 + #0nCampo3;
               nSwAcum = 1;
               |SAL;
            |FINSI;
     |SIGUE;

     |SI nSwAcum = 0;
         |PARA nCampo33 = nDesde;  |SI nCampo33 [ nHasta;  |HACIENDO nCampo33 = nCampo33 + 3;
               nCampo11 = nCampo33 - 2;
               nCampo22 = nCampo33 - 1;
               |SI #300nCampo22 = 0;
                   #300nCampo11 = #0nCampo1;
                   #300nCampo22 = #0nCampo2;
                   #300nCampo33 = #0nCampo3;
                   nSwAcum = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwAcum = 0;
         nCampo11     = nHasta - 2;
         nCampo22     = nHasta - 1;
         nCampo33     = nHasta;

         #300nCampo11 = #300nCampo11 + #0nCampo1;
         #300nCampo22 = -1;
         #300nCampo33 = #300nCampo33 + #0nCampo3;
     |FINSI;
|FPRC;

|PROCESO GrabaDeducible300;
     |SI nDesde = 34; |Y nHasta = -2;   ||inversion
         nHasta = nDesde + 1;
         #300nDesde = #300nDesde - (#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32);
         #300nHasta = #300nHasta - (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
         |ACABA;
     |FINSI;

     |SI nHasta ! -1;
         nHasta = nDesde + 1;
     |FINSI;

     |SI nDesde ! 46;  |Y nDesde ! 48;
         |SI nHasta ! -1;
             #300nDesde = #300nDesde + ((#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32) % nProrrata) + nBaseMas;
             #300nHasta = #300nHasta + ((#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata) + nCuotaMas;
         |SINO;
             #300nDesde = #300nDesde + ((#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata) + nCuotaMas;
         |FINSI;
     |SINO;
         #300nDesde = #300nDesde + (#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32);
         #300nHasta = #300nHasta + (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
     |FINSI;
|FPRC;

|PROCESO Graba300;
     nDesde = 0;
     nHasta = 0;

     |SI #0#6 = 1;  |Y #0#7 [ 4;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 6;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 7;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 8;   nDesde =  8;  nHasta = 14;  |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 5;   nDesde = 26;  nHasta = 32;  |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 10;  nDesde = 17;  nHasta = 23;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 11;  nDesde = 17;  nHasta = 23;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 12;  nDesde = 17;  nHasta = 23;  |FINSI;

     |SI nDesde ! 0;
         |PARA nCampo1 = 14;  |SI nCampo1 [ 23;  |HACIENDO nCampo1 = nCampo1 + 3;
               nCampo2 = nCampo1 + 1;
               nCampo3 = nCampo1 + 2;
               |SI #0nCampo1 ! 0;  |O #0nCampo2 ! 0;  |O #0nCampo3 ! 0;
                   |HAZ GrabaDevengado300;
               |FINSI;
         |SIGUE;
     |FINSI;

     |PARA nCampo1 = 7;  |SI nCampo1 [ 31;  |HACIENDO nCampo1 = nCampo1 + 3;
           |SI #300nCampo1 = -1;  #300nCampo1 = 0;  |FINSI;
     |SIGUE;

     nDesde = 0;
     nHasta = 0;

     |SI #0#6 = 2;  |Y #0#7 = 1;   nDesde = 34;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 2;   nDesde = 36;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 3;   nDesde = 40;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 4;   nDesde = 42;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 5;   nDesde = 46;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 6;   nDesde = 48;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 7;   nDesde = 52;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 9;   nDesde = 54;  nHasta = -1;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 11;  nDesde = 34;  nHasta = -2;  |FINSI;

     |SI #0#6 = 2;  |Y #0#7 = 10;
         |SI #0#1 ] 2008;
             nDesde = 68;  nHasta = -1;
         |FINSI;
     |FINSI;

     |SI nDesde ! 0;
         |HAZ GrabaDeducible300;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 9;
         #300#60 = #300#60 + #0#12;
     |FINSI;

     |SI #0#6 = 5;  |Y #0#7 = 1;
         #300#57   = #300#57 + #0#12;
         nContador = nContador + 1;
     |FINSI;

     |SI #0#6 = 5;  |Y #0#7 = 2;
         #300#61   = #300#61 + #0#12;
     |FINSI;
|FPRC;

|| ///////// Modelo 303 - Ejercicio 2014 \\\\\\\\\\\\
|PROCESO AcumPorIVA;
     |PARA nCampo33 = nDesde;  |SI nCampo33 [ nHasta;  |HACIENDO nCampo33 = nCampo33 + 3;
           nCampo11 = nCampo33 - 2;
           nCampo22 = nCampo33 - 1;
           |SI #304nCampo22 = nIVA;
               #304nCampo11 = #304nCampo11 + #0nCampo1;
               #304nCampo33 = #304nCampo33 + #0nCampo3;
               nSwAcum = 1;

               |SI nIVA ! #0nCampo2;
                   |SI nCampo22 = 17;  nIVA1  = 1;  |FINSI;
                   |SI nCampo22 = 20;  nIVA2  = 1;  |FINSI;
                   |SI nCampo22 = 23;  nIVA3  = 1;  |FINSI;
                   |SI nCampo22 = 32;  nIVA4  = 1;  |FINSI;
                   |SI nCampo22 = 35;  nIVA5  = 1;  |FINSI;
                   |SI nCampo22 = 38;  nIVA6  = 1;  |FINSI;
               |FINSI;
               |SAL;
            |FINSI;
     |SIGUE;

     |SI nSwAcum = 0;
         |PARA nCampo33 = nDesde;  |SI nCampo33 [ nHasta;  |HACIENDO nCampo33 = nCampo33 + 3;
               nCampo11 = nCampo33 - 2;
               nCampo22 = nCampo33 - 1;
               |SI #304nCampo22 = 0;
                   #304nCampo11 = #0nCampo1;
                   #304nCampo22 = nIVA;
                   #304nCampo33 = #0nCampo3;
                   nSwAcum = 1;

                   |SI nIVA ! #0nCampo2;
                       |SI nCampo22 = 17;  nIVA1  = 1;  |FINSI;
                       |SI nCampo22 = 20;  nIVA2  = 1;  |FINSI;
                       |SI nCampo22 = 23;  nIVA3  = 1;  |FINSI;
                       |SI nCampo22 = 32;  nIVA4  = 1;  |FINSI;
                       |SI nCampo22 = 35;  nIVA5  = 1;  |FINSI;
                       |SI nCampo22 = 38;  nIVA6  = 1;  |FINSI;
                   |FINSI;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwAcum = 0;
         nCampo11     = nHasta - 2;
         nCampo22     = nHasta - 1;
         nCampo33     = nHasta;

         #304nCampo11 = #304nCampo11 + #0nCampo1;
         #304nCampo22 = -1;
         #304nCampo33 = #304nCampo33 + #0nCampo3;
     |FINSI;
|FPRC;

|PROCESO GrabaDevengado30314;
     |SI #0nCampo3 = 0;  |ACABA;  |FINSI;
     nSwAcum       = 0;

     nIVA     = #0nCampo2;

     |SI nIVA = 18; |O nIVA = 16; nIVA = 21;  |FINSI;
     |SI nIVA = 8;  |O nIVA = 7;  nIVA = 10;  |FINSI;

     |SI nDesde = 33;
         |SI nIVA = 4; nIVA = 5.20;  |FINSI;
         |SI nIVA = 1; nIVA = 1.40;  |FINSI;
     |FINSI;

     |SI nDesde ! nHasta;
         |HAZ AcumPorIVA;
     |SINO;
         nCampo11 = nHasta - 1;
         nCampo33 = nHasta;

         #304nCampo11 = #304nCampo11 + #0nCampo1;
         #304nCampo33 = #304nCampo33 + #0nCampo3;
     |FINSI;
|FPRC;

|PROCESO GrabaDeducible30314;
     |SI enSwProrr ! 2;
         |ABRE #dsmom087;
         #dsmom087#0 = #0#0;
         #dsmom087#1 = #0#1;
         #dsmom087#2 = #0#2;
         #dsmom087#3 = #0#3;
         #dsmom087#4 = #0#4;
         #dsmom087#5 = #0#5;
         #dsmom087#6 = #0#6;
         #dsmom087#7 = #0#7;
         |LEE 001#dsmom087.=;
         |SI FSalida = 0;
             #0#16 = #dsmom087#17 + #dsmom087#41;
             #0#19 = #dsmom087#20 + #dsmom087#43;
             #0#22 = #dsmom087#23 + #dsmom087#45;
             #0#25 = #dsmom087#26 + #dsmom087#47;
             #0#28 = #dsmom087#29 + #dsmom087#49;
             #0#31 = #dsmom087#32 + #dsmom087#51;
             #0#34 = #dsmom087#35 + #dsmom087#53;
        |FINSI;
        |LIBERA #dsmom087;
        |CIERRA #dsmom087;
     |FINSI;

     |SI nHasta ! -1;
         nHasta = nDesde + 1;
         #304nDesde = #304nDesde + (#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32);
         #304nHasta = #304nHasta + (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
     |SINO;
         #304nDesde = #304nDesde + ((#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata) + nCuotaMas;
     |FINSI;
|FPRC;

|PROCESO GrabaParte1;
     nDesde       = 0;
     nHasta       = 0;

     |SI #0#6 = 1;  |Y #0#7 [ 4;   nDesde = 18;  nHasta = 24;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 14;  nDesde = 18;  nHasta = 24;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 16;  nDesde = 18;  nHasta = 24;  |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 5;   nDesde = 26;  nHasta = 26;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 15;  nDesde = 26;  nHasta = 26;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 6;   nDesde = 28;  nHasta = 28;  |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 7;   nDesde = 30;  nHasta = 30;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 8;   nDesde = 30;  nHasta = 30;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 17;  nDesde = 30;  nHasta = 30;  |FINSI;

     |SI enEjer ] 2015;
         |SI #0#6 = 1;  |Y #0#7 = 18;  nDesde = 30;  nHasta = 30;  |FINSI;
         |SI #0#6 = 1;  |Y #0#7 = 19;  nDesde = 30;  nHasta = 30;  |FINSI;
     |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 10;  nDesde = 33;  nHasta = 39;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 11;  nDesde = 41;  nHasta = 41;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 12;  nDesde = 41;  nHasta = 41;  |FINSI;

     |SI enEjer ] 2015;
         |SI #0#6 = 1;  |Y #0#7 = 20;  nDesde = 41;  nHasta = 41;  |FINSI;
     |FINSI;

     |SI nDesde ! 0;
         |PARA nCampo1 = 14;  |SI nCampo1 [ 32;  |HACIENDO nCampo1 = nCampo1 + 3;
               nCampo2 = nCampo1 + 1;
               nCampo3 = nCampo1 + 2;
               |SI #0nCampo1 ! 0;  |O #0nCampo2 ! 0;  |O #0nCampo3 ! 0;
                   |HAZ GrabaDevengado30314;
               |FINSI;
         |SIGUE;

         |SI #0#6 = 1;  |Y #0#7 = 15;
             |PARA nCampo1 = 35;  |SI nCampo1 [ 53;  |HACIENDO nCampo1 = nCampo1 + 3;
                   nCampo2 = nCampo1 + 1;
                   nCampo3 = nCampo1 + 2;
                   |SI #0nCampo1 ! 0;  |O #0nCampo2 ! 0;  |O #0nCampo3 ! 0;
                       |HAZ GrabaDevengado30314;
                   |FINSI;
             |SIGUE;
         |FINSI;

         |SI #0#6 = 1;  |Y #0#7 = 6;
             |PARA nCampo1 = 35;  |SI nCampo1 [ 53;  |HACIENDO nCampo1 = nCampo1 + 3;
                   nCampo2 = nCampo1 + 1;
                   nCampo3 = nCampo1 + 2;
                   |SI #0nCampo1 ! 0;  |O #0nCampo2 ! 0;  |O #0nCampo3 ! 0;
                       |HAZ GrabaDevengado30314;
                   |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |PARA nCampo1 = 17;  |SI nCampo1 [ 23;  |HACIENDO nCampo1 = nCampo1 + 3;
           |SI #304nCampo1 = -1;  #304nCampo1 = 0;  |FINSI;
     |SIGUE;

     |PARA nCampo1 = 32;  |SI nCampo1 [ 38;  |HACIENDO nCampo1 = nCampo1 + 3;
           |SI #304nCampo1 = -1;  #304nCampo1 = 0;  |FINSI;
     |SIGUE;

     nDesde = 0;
     nHasta = 0;

     |SI #0#6 = 2;  |Y #0#7 = 1;   nDesde = 43;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 2;   nDesde = 45;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 14;  nDesde = 43;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 15;  nDesde = 45;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 3;   nDesde = 47;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 4;   nDesde = 49;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 5;   nDesde = 51;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 6;   nDesde = 53;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 13;  nDesde = 51;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 7;   nDesde = 57;  nHasta = -1;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 8;   nDesde = 55;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 16;  nDesde = 55;  |FINSI;
     |SI enEjer ] 2015;
        |SI #0#6 = 2;  |Y #0#7 = 17;  nDesde = 55;  |FINSI;
     |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 9;   nDesde = 58;  nHasta = -1;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 10;  nDesde = 59;  nHasta = -1;  |FINSI;

     |SI nDesde ! 0;
         |HAZ GrabaDeducible30314;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 9;
         #304#74 = #304#74 + #0#12;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 16;
         #304#74 = #304#74 + #0#12;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 10;
         #304#75 = #304#75 + #0#12;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 4;
         #304#76 = #304#76 + #0#12;
     |FINSI;

     |SI #0#6 = 5;  |Y #0#7 = 1;
         #304#82 = #304#82 + #0#12;
         nContador = nContador + 1;
     |FINSI;

     |SI #0#6 = 5;  |Y #0#7 = 2;
         #304#85 = #304#85 + #0#12;
     |FINSI;

     |SI #0#6 = 4;  |Y #0#7 = 17;
         #304#77 = #304#77 + #0#12;
         #304#78 = #304#78 + #0#13;
     |FINSI;

     |SI #0#6 = 4;  |Y #0#7 = 18;
         #304#79 = #304#79 + #0#12;
         #304#80 = #304#80 + #0#13;
     |FINSI;
|FPRC;

|| ///////// Modelo 303 \\\\\\\\\\\\

|PROCESO GrabaDevengado303;
     |SI #0nCampo3 = 0;  |ACABA;  |FINSI;
     nSwAcum       = 0;

     nIVA     = #0nCampo2;

     |SI nSubeIVA = 1;
         |SI nIVA = 16;  nIVA = 18;  |FINSI;
         |SI nIVA = 7;   nIVA = 8;   |FINSI;
     |FINSI;
     |SI nSubeIVA = 2;
         |SI nIVA = 18; |O nIVA = 16; nIVA = 21;  |FINSI;
         |SI nIVA = 8;  |O nIVA = 7;  nIVA = 10;  |FINSI;
     |FINSI;
     |SI nSubeIVA = 2;
         |SI nDesde = 17;
             |SI nIVA = 4; nIVA = 5.20;  |FINSI;
             |SI nIVA = 1; nIVA = 1.40;  |FINSI;
         |FINSI;
     |FINSI;

     |PARA nCampo33 = nDesde;  |SI nCampo33 [ nHasta;  |HACIENDO nCampo33 = nCampo33 + 3;
           nCampo11 = nCampo33 - 2;
           nCampo22 = nCampo33 - 1;
           |SI #303nCampo22 = nIVA;
               #303nCampo11 = #303nCampo11 + #0nCampo1;
               #303nCampo33 = #303nCampo33 + #0nCampo3;
               nSwAcum = 1;

               |SI nIVA ! #0nCampo2;
                   |SI nCampo22 = 7;   nIVA7  = 1;  |FINSI;
                   |SI nCampo22 = 10;  nIVA10 = 1;  |FINSI;
                   |SI nCampo22 = 13;  nIVA13 = 1;  |FINSI;
                   |SI nCampo22 = 16;  nIVA16 = 1;  |FINSI;
                   |SI nCampo22 = 19;  nIVA19 = 1;  |FINSI;
                   |SI nCampo22 = 22;  nIVA22 = 1;  |FINSI;
                   |SI nCampo22 = 25;  nIVA25 = 1;  |FINSI;
                   |SI nCampo22 = 28;  nIVA28 = 1;  |FINSI;
                   |SI nCampo22 = 31;  nIVA31 = 1;  |FINSI;
               |FINSI;

               |SAL;
            |FINSI;
     |SIGUE;

     |SI nSwAcum = 0;
         |PARA nCampo33 = nDesde;  |SI nCampo33 [ nHasta;  |HACIENDO nCampo33 = nCampo33 + 3;
               nCampo11 = nCampo33 - 2;
               nCampo22 = nCampo33 - 1;
               |SI #303nCampo22 = 0;
                   #303nCampo11 = #0nCampo1;
                   #303nCampo22 = nIVA;
                   #303nCampo33 = #0nCampo3;

                   |SI nIVA ! #0nCampo2;
                       |SI nCampo22 = 7;   nIVA7  = 1;  |FINSI;
                       |SI nCampo22 = 10;  nIVA10 = 1;  |FINSI;
                       |SI nCampo22 = 13;  nIVA13 = 1;  |FINSI;
                       |SI nCampo22 = 16;  nIVA16 = 1;  |FINSI;
                       |SI nCampo22 = 19;  nIVA19 = 1;  |FINSI;
                       |SI nCampo22 = 22;  nIVA22 = 1;  |FINSI;
                       |SI nCampo22 = 25;  nIVA25 = 1;  |FINSI;
                       |SI nCampo22 = 28;  nIVA28 = 1;  |FINSI;
                       |SI nCampo22 = 31;  nIVA31 = 1;  |FINSI;
                   |FINSI;

                   nSwAcum = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwAcum = 0;
         nCampo11     = nHasta - 2;
         nCampo22     = nHasta - 1;
         nCampo33     = nHasta;

         #303nCampo11 = #303nCampo11 + #0nCampo1;
         #303nCampo22 = -1;
         #303nCampo33 = #303nCampo33 + #0nCampo3;
     |FINSI;
|FPRC;

|PROCESO GrabaDeducible303;
     |SI #0#1 > 2010; |Y enSwProrr < 2;
         |ABRE #87;
         #87#0 = #0#0;
         #87#1 = #0#1;
         #87#2 = #0#2;
         #87#3 = #0#3;
         #87#4 = #0#4;
         #87#5 = #0#5;
         #87#6 = #0#6;
         #87#7 = #0#7;
         |LEE 141#87=;
         |SI FSalida = 0;
             #0#16 = #87#17 + #87#41;
             #0#19 = #87#20 + #87#43;
             #0#22 = #87#23 + #87#45;
             #0#25 = #87#26 + #87#47;
             #0#28 = #87#29 + #87#49;
             #0#31 = #87#32 + #87#51;
             #0#34 = #87#35 + #87#53;
        |FINSI;
        |CIERRA #87;
     |FINSI;

     |SI nDesde = 34; |Y nHasta = -2;   ||inversion
         nHasta = nDesde + 1;
         #303nDesde = #303nDesde - (#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32);
         #303nHasta = #303nHasta - (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
         |ACABA;
     |FINSI;

     |SI nHasta ! -1;
         nHasta = nDesde + 1;
     |FINSI;

     |SI nDesde ! 42;  |Y nDesde ! 44;
         |SI nHasta ! -1;
             #303nDesde = #303nDesde + ((#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32) % nProrrata) + nBaseMas;
             #303nHasta = #303nHasta + ((#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata) + nCuotaMas;
         |SINO;
             #303nDesde = #303nDesde + ((#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata) + nCuotaMas;
         |FINSI;
     |SINO;
         #303nDesde = #303nDesde + (#0#14 + #0#17 + #0#20 + #0#23 + #0#26 + #0#29 + #0#32);
         #303nHasta = #303nHasta + (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
     |FINSI;
|FPRC;

|PROCESO Graba303;
     |SI enEjer ] 2014;
         |HAZ GrabaParte1;
         |ACABA;
     |FINSI;

     nDesde = 0;
     nHasta = 0;

     |SI #0#6 = 1;  |Y #0#7 [ 4;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 6;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 7;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 8;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 =14;   nDesde =  8;  nHasta = 14;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 =16;   nDesde =  8;  nHasta = 14;  |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 5;   nDesde = 26;  nHasta = 32;  |FINSI;

     |SI #0#6 = 1;  |Y #0#7 = 10;  nDesde = 17;  nHasta = 23;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 11;  nDesde = 17;  nHasta = 23;  |FINSI;
     |SI #0#6 = 1;  |Y #0#7 = 12;  nDesde = 17;  nHasta = 23;  |FINSI;

     |SI nDesde ! 0;
         |PARA nCampo1 = 14;  |SI nCampo1 [ 32;  |HACIENDO nCampo1 = nCampo1 + 3;
               nCampo2 = nCampo1 + 1;
               nCampo3 = nCampo1 + 2;
               |SI #0nCampo1 ! 0;  |O #0nCampo2 ! 0;  |O #0nCampo3 ! 0;
                   |HAZ GrabaDevengado303;
               |FINSI;
         |SIGUE;

         |SI #0#6 = 1;  |Y #0#7 = 6;
             |PARA nCampo1 = 35;  |SI nCampo1 [ 53;  |HACIENDO nCampo1 = nCampo1 + 3;
                   nCampo2 = nCampo1 + 1;
                   nCampo3 = nCampo1 + 2;
                   |SI #0nCampo1 ! 0;  |O #0nCampo2 ! 0;  |O #0nCampo3 ! 0;
                       |HAZ GrabaDevengado303;
                   |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |PARA nCampo1 = 7;  |SI nCampo1 [ 31;  |HACIENDO nCampo1 = nCampo1 + 3;
           |SI #303nCampo1 = -1;  #303nCampo1 = 0;  |FINSI;
     |SIGUE;

     nDesde = 0;
     nHasta = 0;

     |SI #0#6 = 2;  |Y #0#7 = 1;   nDesde = 34;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 2;   nDesde = 36;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 3;   nDesde = 38;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 4;   nDesde = 40;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 5;   nDesde = 42;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 6;   nDesde = 44;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 7;   nDesde = 46;  nHasta = -1;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 9;   nDesde = 47;  nHasta = -1;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 11;  nDesde = 34;  nHasta = -2;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 10;  nDesde = 48;  nHasta = -1;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 13;  nDesde = 34;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 14;  nDesde = 34;  |FINSI;
     |SI #0#6 = 2;  |Y #0#7 = 15;  nDesde = 36;  |FINSI;

     |SI nDesde ! 0;
         |HAZ GrabaDeducible303;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 9;
         #303#54 = #303#54 + #0#12;
     |FINSI;

     |SI #0#6 = 5;  |Y #0#7 = 1;
         #303#51   = #303#51 + #0#12;
         nContador = nContador + 1;
     |FINSI;

     |SI #0#6 = 5;  |Y #0#7 = 2;
         #303#57 = #303#57 + #0#12;
     |FINSI;

     |SI #0#6 = 3;  |Y #0#7 = 10;
         #303#55 = #303#55 + #0#12;
     |FINSI;

     |SI #0#1 [ 2009;
         |SI #0#6 = 3;  |Y #0#7 = 11;
             #303#56 = #303#56 + #0#12;
         |FINSI;
     |SINO;
         |SI #0#6 = 3;  |Y #0#7 = 4;  || Tique 3923_ 242
             #303#56 = #303#56 + #0#12;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaModelo;
     |SI #0#6 = 5;  |Y #0#7 = 6;  |Y #0#12 ! 0;
         nEjerAnt = #0#12;
     |FINSI;

     enImpIvaSop = 0;
     enImpIvaSub = 0;
     enIvaSopDed = 0;

     nBaseMas  = 0;
     nCuotaMas = 0;

     |SI #0#6 = 2;
         |SI #0#7 ! 5; |Y #0#7 ! 6;
             |HAZ LeeRestoPror;
             |SI #0#1 [ 2007;
                 |SI #0#7 ! 10; |Y #0#7 ! 11; |Y #0#7 ! 12;
                     enIvaSopDed = (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata + nCuotaMas;
                 |FINSI;
                 |SI #0#7 = 10;
                    enImpIvaSop = #0#13 + nCuotaMas;
                 |FINSI;
                 |SI #0#7 = 11;
                     enImpIvaSub = #0#13;
                     enIvaSopDed = - (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
                 |FINSI;
             |FINSI;

             |SI #0#1 ] 2008;
                 |SI #0#7 ! 11; |Y #0#7 ! 12;
                     enIvaSopDed = (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34) % nProrrata + nCuotaMas;
                     enImpIvaSop = #0#13 + nCuotaMas;
                 |FINSI;

                 |SI #0#7 = 11;
                     enImpIvaSub = #0#13;
                     enIvaSopDed = - (#0#16 + #0#19 + #0#22 + #0#25 + #0#28 + #0#31 + #0#34);
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #0#7 = 12; |ACABA; |FINSI;
     |FINSI;

     |SI #0#12 = 0;  |Y #0#13 = 0;  |Y nCuotaMas = 0; |ACABA;  |FINSI;

     |SI enModelo = 300;   |HAZ Graba300;   |FINSI;
     |SI enModelo = 303;   |HAZ Graba303;   |FINSI;

     nSwGraba = 1;
|FPRC;

|DEFBUCLE dsmociva;
     #0#1;
     ;
     enEmpresa, enEjer, enPeriodo, enModelo, enComplem, 01, 0,  0;
     enEmpresa, enEjer, enPeriodo, enModelo, enComplem, 99, 9, 99;
     be;
     NULL, GrabaModelo;
|FIN;

|PROCESO LeeRestoPror;
     |ABRE #165;
     #165#0 = #0#0;
     #165#1 = #0#1;
     #165#2 = #0#2;
     #165#3 = #0#3;
     #165#4 = #0#4;
     #165#5 = #0#5;
     #165#6 = #0#6;
     #165#7 = #0#7;
     |LEE 001#165=;
     |SI FSalida = 0;
         nBaseMas  = #165#10 + #165#13 + #165#16 + #165#19;
         nCuotaMas = #165#12 + #165#15 + #165#18 + #165#21;
     |FINSI;
     |CIERRA #165;
|FPRC;

|PROCESO Totales300;
     #300#33 = #300#8  + #300#11 + #300#14 + #300#17 + #300#20 + #300#23 + #300#26 + #300#29 + #300#32;

     |SI enEjer ] enEjerPro;
          |SI #109#36 = "N";
              #300#35 = #300#35 - enImpProrrata;
          |SINO;
              #300#35 = #300#35 - enImpProrrat1;
              #300#37 = #300#37 - enImpProrrat2;
              #300#41 = #300#41 - enImpProrrat3;
              #300#43 = #300#43 - enImpProrrat4;
              #300#47 = #300#47 - enImpProrrat5;
              #300#49 = #300#49 - enImpProrrat6;
              #300#53 = #300#53 - enImpProrrat7;
          |FINSI;
     |FINSI;
|| ....
|| Regularizacion Manual
     #300#35 = #300#35 - #47#6;
     #300#37 = #300#37 - #47#7;
     #300#41 = #300#41 - #47#8;
     #300#43 = #300#43 - #47#9;
     #300#47 = #300#47 - #47#10;
     #300#49 = #300#49 - #47#11;
     #300#53 = #300#53 - #47#12;
|| ....

     #300#38 = #300#34 + #300#36;
     #300#39 = #300#35 + #300#37;
     #300#44 = #300#40 + #300#42;
     #300#45 = #300#41 + #300#43;
     #300#50 = #300#46 + #300#48;
     #300#51 = #300#47 + #300#49;
     #300#55 = #300#39 + #300#45 + #300#51 + #300#53 + #300#54;

     #300#57 = #300#57 / nContador;
     #300#56 = #300#33 - #300#55;
     #300#58 = #300#56 % #300#57;
     #300#62 = #300#58 - #300#59 + #300#61;

     |SI #300#62 > 0;
         #300#65 = #300#62;
         #300#63 = 0;
         #300#64 = 0;
     |SINO;
         |SI #300#2 = 12;
             |HAZ UltimoPeriodo;
             |SI eaUltimoPer = "COMPENSAR";
                 #300#63 = -#300#62;
                 #300#64 = 0;
                 #300#65 = 0;
             |SINO;
                 #300#64 = -#300#62;
                 #300#63 = 0;
                 #300#65 = 0;
             |FINSI;
         |SINO;
             #300#63 = -#300#62;
             #300#64 = 0;
             #300#65 = 0;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Modelo300;
     |ABRE #300;

     #300#0 = enEmpresa;
     #300#1 = enEjer;
     #300#2 = enPeriodo;
     #300#3 = enModelo;
     #300#4 = enComplem;
     #300#5 = 0;
     |LEE 101#300=;
     |SI FSalida ! 0;
         |HAZ RecogeAnter;
         |DDEFECTO #300;
         #300#0 = enEmpresa;
         #300#1 = enEjer;
         #300#2 = enPeriodo;
         #300#3 = enModelo;
         #300#4 = enComplem;
         #300#5 = 0;
         #300#59 = nEjerAnt;
         #300#57 = 0;
         |GRABA 020#300b;
     |FINSI;

     nEjerAnt  = #300#59;
     nContador = 0;
     nSwGraba  = 0;
     |BUCLE dsmociva;

     |SI nSwGraba = 1;
         #300#59 = nEjerAnt;
         |HAZ Totales300;
         |GRABA 020#300a;
     |SINO;
         |BORRA 020#300a;
     |FINSI;
     |LIBERA #300;
     |CIERRA #300;
|FPRC;

|PROCESO Totales303;
     #303#33 = #303#8  + #303#11 + #303#14 + #303#17 + #303#20 + #303#23
     #303#33 = #303#33 + #303#26 + #303#29 + #303#32;

|| aplicar nueva Prorrata
     |SI enEjer ] enEjerPro;
          |SI #109#36 = "N";
              #303#35 = #303#35 - enImpProrrata;
          |SINO;
              #303#35 = #303#35 - enImpProrrat1;
              #303#37 = #303#37 - enImpProrrat2;
              #303#39 = #303#39 - enImpProrrat3;
              #303#41 = #303#41 - enImpProrrat4;
              #303#43 = #303#43 - enImpProrrat5;
              #303#45 = #303#45 - enImpProrrat6;
              #303#46 = #303#46 - enImpProrrat7;
          |FINSI;
          |SI enEjer ] 2009; |Y enPeriodo = 12;
              #303#48 = #303#48 + enImpProrrat36;
          |FINSI;
     |FINSI;
|| ....
|| Regularizacion Manual
     #303#35 = #303#35 - #47#6;
     #303#37 = #303#37 - #47#7;
     #303#39 = #303#39 - #47#8;
     #303#41 = #303#41 - #47#9;
     #303#43 = #303#43 - #47#10;
     #303#45 = #303#45 - #47#11;
     #303#46 = #303#46 - #47#12;
|| ....

     #303#49 = #303#35 + #303#37 + #303#39 + #303#41 + #303#43 + #303#45;
     #303#49 = #303#49 + #303#46 + #303#47 + #303#48;

     #303#50 = #303#33 - #303#49;
     #303#51 = #303#51 / nContador;
     #303#52 = #303#50 % #303#51;

     #303#58 = #303#52 - #303#53 + #303#57;
     #303#60 = #303#58 - #303#59;

     |SI #303#60 > 0;
         #303#63 = #303#60;
         #303#61 = 0;
         #303#62 = 0;
     |SINO;
         |ABRE #4;
         #4#0 = enEmpresa;
         #4#1 = enEjer;
         #4#2 = enPeriodo;
         #4#3 = enModelo;
         #4#4 = enComplem;
         |LEE 040#4=;
         |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
         |CIERRA #4;

         |SI #4#23 = "S";
              |HAZ UltimoPeriodo;
              |SI eaUltimoPer = "COMPENSAR";
                  #303#61 = -#303#60;
                  #303#62 = 0;
                  #303#63 = 0;
              |SINO;
                  #303#62 = -#303#60;
                  #303#61 = 0;
                  #303#63 = 0;
              |FINSI;
         |FINSI;

         |SI #4#23 = "N";
             |SI #303#2 = 12;
                 |HAZ UltimoPeriodo;
                 |SI eaUltimoPer = "COMPENSAR";
                     #303#61 = -#303#60;
                     #303#62 = 0;
                     #303#63 = 0;
                 |SINO;
                     #303#61 = -#303#60;
                     #303#62 = 0;
                     #303#63 = 0;
                 |FINSI;
             |SINO;
                 #303#61 = -#303#60;
                 #303#62 = 0;
                 #303#63 = 0;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Modelo303;
     |ABRE #303;

     #303#0 = enEmpresa;
     #303#1 = enEjer;
     #303#2 = enPeriodo;
     #303#3 = enModelo;
     #303#4 = enComplem;
     #303#5 = 0;
     |LEE 101#303=;
     |SI FSalida ! 0;
         |HAZ RecogeAnter;
         |DDEFECTO #303;
         #303#0 = enEmpresa;
         #303#1 = enEjer;
         #303#2 = enPeriodo;
         #303#3 = enModelo;
         #303#4 = enComplem;
         #303#5 = 0;

         #303#53 = nEjerAnt;
         #303#51 = 0;
         |GRABA 020#303b;
     |FINSI;

     nEjerAnt  = #303#53;
     nContador = 0;
     nSwGraba  = 0;
     nIVA7     = 0;
     nIVA10    = 0;
     nIVA13    = 0;
     nIVA16    = 0;
     nIVA19    = 0;
     nIVA22    = 0;
     nIVA25    = 0;
     nIVA28    = 0;
     nIVA31    = 0;
     nSubeIVA  = 0;

     |SI #303#1 = 2010; |Y #303#2 ] 7;
         nSubeIVA = 1;
     |FINSI;

     |SI #303#1 ] 2011;
         nSubeIVA = 1;
     |FINSI;

     |SI #303#1 = 2012; |Y #303#2 ] 9;
         nSubeIVA = 2;
     |FINSI;

     |SI #303#1 ] 2013;
         nSubeIVA = 2;
     |FINSI;

     |BUCLE dsmociva;

     |SI nSwGraba = 1;
         |SI nIVA7  = 1;  #303#7  = (#303#8  / #303#6)  * 100;   |FINSI;
         |SI nIVA10 = 1;  #303#10 = (#303#11 / #303#9)  * 100;   |FINSI;
         |SI nIVA13 = 1;  #303#13 = (#303#14 / #303#12) * 100;   |FINSI;
         |SI nIVA16 = 1;  #303#16 = (#303#17 / #303#15) * 100;   |FINSI;
         |SI nIVA19 = 1;  #303#19 = (#303#20 / #303#18) * 100;   |FINSI;
         |SI nIVA22 = 1;  #303#22 = (#303#23 / #303#21) * 100;   |FINSI;
         |SI nIVA25 = 1;  #303#25 = (#303#26 / #303#24) * 100;   |FINSI;
         |SI nIVA28 = 1;  #303#28 = (#303#29 / #303#27) * 100;   |FINSI;
         |SI nIVA31 = 1;  #303#31 = (#303#32 / #303#20) * 100;   |FINSI;

         #303#53 = nEjerAnt;
         |HAZ Totales303;
         enIvaSopDed = #303#49;
         |GRABA 020#303a;
     |SINO;
         #303#49 = 0;
         |BORRA 020#303a;
     |FINSI;

     |LIBERA #303;
     |CIERRA #303;
|FPRC;

|PROCESO Totales30314;
     |SI nIVA1 = 1;  #304#17 = (#304#18 / #304#16) * 100;   |FINSI;
     |SI nIVA2 = 1;  #304#20 = (#304#21 / #304#19) * 100;   |FINSI;
     |SI nIVA3 = 1;  #304#23 = (#304#24 / #304#22) * 100;   |FINSI;
     |SI nIVA4 = 1;  #304#32 = (#304#33 / #304#31) * 100;   |FINSI;
     |SI nIVA5 = 1;  #304#35 = (#304#36 / #304#34) * 100;   |FINSI;
     |SI nIVA6 = 1;  #304#38 = (#304#39 / #304#37) * 100;   |FINSI;

     #304#92 = nProrrata;
     #304#93 = eaProrrat;

     #304#42 = #304#18 + #304#21 + #304#24 + #304#26;
     #304#42 = #304#42 + #304#28 + #304#30 + #304#33;
     #304#42 = #304#42 + #304#36 + #304#39 + #304#41;

     #304#44 = #304#44 - #dsmom047#6;
     #304#46 = #304#46 - #dsmom047#7;
     #304#48 = #304#48 - #dsmom047#8;
     #304#50 = #304#50 - #dsmom047#9;
     #304#52 = #304#52 - #dsmom047#10;
     #304#54 = #304#54 - #dsmom047#11;
     #304#57 = #304#57 - #dsmom047#12;

     #304#60 = #304#44 + #304#46 + #304#48 + #304#50;
     #304#60 = #304#60 + #304#52 + #304#54 + #304#56;
     #304#60 = #304#60 + #304#57 + #304#58 + #304#59;
     #304#61 = #304#42 - #304#60;

     |SI #304#2 = 12;
         #304#64 = 0;
     |FINSI;
     |SI enPeriodo ! 12;
         #304#69 = #304#62 + #304#66 + #304#67 + #304#68;
     |FINSI;
     |SI enPeriodo = 12;
         #304#69 = #304#65 + #304#66 + #304#67 + #304#68;
     |FINSI;

     #304#72 = #304#70 + #304#71;
     #304#73 = #304#69 - #304#72;

     #304#81 = #304#61 + #304#73;
     #304#82 = 100;
     #304#83 = #304#81 % #304#82;
     |HAZ MiraPrescripcion;
     #304#84 = nEjerAnt;
     #304#86 = #304#83 - #304#84 + #304#85;
     #304#87 = 0;
     #304#88 = #304#86 - #304#87;

     |SI #304#88 > 0;
         #304#91 = #304#88;
         #304#89 = 0;
         #304#90 = 0;
     |SINO;
         #304#89 = -#304#88;
         #304#90 = 0;
         #304#91 = 0;
     |FINSI;
|FPRC;

|PROCESO Modelo30314;
     |ABRE #304;

     #304#0 = enEmpresa;
     #304#1 = enEjer;
     #304#2 = enPeriodo;
     #304#3 = enModelo;
     #304#4 = enComplem;
     #304#5 = 0;
     |LEE 101#304=;
     |SI FSalida ! 0;
         |HAZ RecogeAnter;
         |DDEFECTO #304;
         #304#0 = enEmpresa;
         #304#1 = enEjer;
         #304#2 = enPeriodo;
         #304#3 = enModelo;
         #304#4 = enComplem;
         #304#5 = 0;

         #304#84 = nEjerAnt;
         |GRABA 020#304b;
     |FINSI;

     nEjerAnt  = #304#84;
     nContador = 0;
     nSwGraba  = 0;
     nIVA1     = 0;
     nIVA2     = 0;
     nIVA3     = 0;
     nIVA4     = 0;
     nIVA5     = 0;
     nIVA6     = 0;
     nSubeIVA  = 2;

     |BUCLE dsmociva;
     |HAZ Totales30314;
     |GRABA 020#304a;
     |LIBERA #304;
     |CIERRA #304;
|FPRC;

|PROCESO Registro0;

     eaProrrat = "G";
     nProrrata = 100;
     enImpProrrata = 0;  enImpProrrat1 = 0;
     enImpProrrat2 = 0;  enImpProrrat3 = 0;
     enImpProrrat4 = 0;  enImpProrrat5 = 0;
     enImpProrrat6 = 0;  enImpProrrat7 = 0;
     enImpProrrat8 = 0;

     |SI enSwProrr < 2;
         |SI #0#1 [ 2010;
             |HAZ eLeeLaProrrata;
         |SINO;
             |SI enPeriodo = 12;
             |FINSI;
         |FINSI;
         |SI #0#1 ] enEjerPro; nProrrata = 100; |FINSI;
     |FINSI;

     |SI enModelo = 300;
         |ABRE #300;
         #300#0 = enEmpresa;
         #300#1 = enEjer;
         #300#2 = enPeriodo;
         #300#3 = enModelo;
         #300#4 = enComplem;
         #300#5 = 0;
         |LEE 101#300=;
         |SI FSalida = 0;
             |BORRA 020#300a;
         |FINSI;
         |LIBERA #300;
         |CIERRA #300;
     |FINSI;

     |SI enModelo = 303;
         |SI enEjer [ 2013;
             |ABRE #303;
             #303#0 = enEmpresa;
             #303#1 = enEjer;
             #303#2 = enPeriodo;
             #303#3 = enModelo;
             #303#4 = enComplem;
             #303#5 = 0;
             |LEE 101#303=;
             |SI FSalida = 0;
                 |BORRA 020#303a;
             |FINSI;
             |LIBERA #303;
             |CIERRA #303;
         |SINO;
             |ABRE #304;
             #304#0 = enEmpresa;
             #304#1 = enEjer;
             #304#2 = enPeriodo;
             #304#3 = enModelo;
             #304#4 = enComplem;
             #304#5 = 0;
             |LEE 101#304=;
             |SI FSalida = 0;
                 |BORRA 020#304a;
             |FINSI;
             |LIBERA #304;
             |CIERRA #304;
         |FINSI;
     |FINSI;

     |ABRE #8;
     #8#0 = enEmpresa;
     #8#1 = enEjer;
     #8#2 = enPeriodo;
     #8#3 = enModelo;
     #8#4 = enComplem;
     #8#5 = 0;
     |LEE 101#8=;
     |SI FSalida = 0;
         #8#11 = "SIN DATOS ";
     |FINSI;
     |LIBERA #8;
     |CIERRA #8;

     nSwGraba = 0;

     |SI enModelo = 300;  |HAZ Modelo300;  |FINSI;
     |SI enModelo = 303;
         |SI enEjer [ 2013;
             |HAZ Modelo303;
         |SINO;
             |HAZ Modelo30314;
         |FINSI;
     |FINSI;

     |SI nSwGraba = 1;
         |ABRE #8;
         #8#0 = enEmpresa;
         #8#1 = enEjer;
         #8#2 = enPeriodo;
         #8#3 = enModelo;
         #8#4 = enComplem;
         #8#5 = 0;
         |LEE 101#8=;
         |SI FSalida = 0;
             #8#11 = "EXISTENTE";
         |FINSI;
         |LIBERA #8;
         |CIERRA #8;
     |FINSI;
|FPRC;

|| ///////////////// Procesos del Entlineal \\\\\\\\\\\\\\\\\\\\

|PROCESO Total1_9;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 2;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 3;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 4;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 5;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 6;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 7;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 8;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 14;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     |SI enEjer ] 2014;
         nGrupo    = 1;  nSubGrupo = 15;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;

         nGrupo    = 1;  nSubGrupo = 16;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;

         nGrupo    = 1;  nSubGrupo = 17;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     |SI enEjer ] 2015;
         nGrupo    = 1;  nSubGrupo = 18;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;

         nGrupo    = 1;  nSubGrupo = 19;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 1;
     #0#7  = 9;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         #0#13 = nValor2;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total1_13;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 1;  nSubGrupo = 12;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     |SI enEjer ] 2015;
         nGrupo    = 1;  nSubGrupo = 20;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 1;
     #0#7  = 13;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         #0#13 = nValor2;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total3_1;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     |SI enEjer ] 2011;
         nGrupo    = 1;  nSubGrupo = 14;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
     |FINSI;

     |SI enEjer ] 2015;
         nGrupo    = 1;  nSubGrupo = 18;  |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
     |FINSI;

/*
     |SI enEjer ] 2014; ||  |Y falta saber que es regimen de caja
         |ABRE #402;
         |DDEFECTO #402;
         #402#0 = enEmpresa;
         #402#1 = enActividad;
         |LEE 040#402=;
         |CIERRA #402;
         |SI #402#7 = 14;  |O #402#7 = 15;
             |ACABA;
         |FINSI;
     |FINSI;
*/

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 3;
     #0#7  = 1;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total3_4;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 3;
     #0#7  = 4;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total3_5;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 3;
     #0#7  = 5;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total3_6;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 3;
     #0#7  = 6;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total3_7;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 1;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 3;
     #0#7  = 7;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total2_10;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 2;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     nGrupo    = 2;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;
     nValor2   = nValor2 + #0#13;

     |SI enEjer [ 2007;
         #0#0  = enEmpresa;
         #0#1  = enEjer;
         #0#2  = enPeriodo;
         #0#3  = enModelo;
         #0#4  = enComplem;
         #0#5  = enActividad;
         #0#6  = 2;
         #0#7  = 10;
         |LEE 101#0=;
         |SI FSalida = 0;
             #0#12 = nValor1;
             #0#13 = nValor2;
             |GRABA 020#0a;
             |LIBERA #0;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI enEjer ] 2008;
         nGrupo    = 2;  nSubGrupo = 10;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     |SI enEjer [ 2010;
         nGrupo    = 2;  nSubGrupo = 11;   |HAZ LeeCasilla;
         nValor1   = nValor1 - #0#12;
         nValor2   = nValor2 - #0#13;
     |FINSI;

     |SI enEjer ] 2011;
         nGrupo    = 2;  nSubGrupo = 13;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;

         nGrupo    = 2;  nSubGrupo = 14;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;

         nGrupo    = 2;  nSubGrupo = 15;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     |SI enEjer ] 2014;
         nGrupo    = 2;  nSubGrupo = 16;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     |SI enEjer ] 2015;
         nGrupo    = 2;  nSubGrupo = 17;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
         nValor2   = nValor2 + #0#13;
     |FINSI;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 2;
     #0#7  = 12;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         #0#13 = nValor2;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Total3_15;
     nValor1   = 0;
     nValor2   = 0;

     nGrupo    = 3;  nSubGrupo = 1;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 2;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 3;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 4;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 5;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 6;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 7;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 8;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 9;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     |SI enEjer ] 2014;
         nGrupo    = 3;  nSubGrupo = 16;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;

         nGrupo    = 3;  nSubGrupo = 17;   |HAZ LeeCasilla;
         nValor1   = nValor1 + #0#12;
     |FINSI;

     nGrupo    = 3;  nSubGrupo = 10;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 11;  |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 12;   |HAZ LeeCasilla;
     nValor1   = nValor1 + #0#12;

     nGrupo    = 3;  nSubGrupo = 13;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #0#12;

     nGrupo    = 3;  nSubGrupo = 14;   |HAZ LeeCasilla;
     nValor1   = nValor1 - #0#12;

     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = 3;
     #0#7  = 15;
     |LEE 101#0=;
     |SI FSalida = 0;
         #0#12 = nValor1;
         |GRABA 020#0a;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Totales;
     |HAZ Total1_9;   || Total Bases y Cuotas I.V.A.
     |HAZ Total1_13;  || Total Bases y Cuotas I.V.A. y Recargo

     |SI enModelo = 300;  |O enModelo = 330;  |O enModelo = 370;
         |HAZ Total3_1;   || Operaciones en Regimen General
     |FINSI;

     |SI enModelo = 320;  |O enModelo = 332;
         |HAZ Total3_4;   || Operaciones en Regimen Ordinario
         |HAZ Total3_5;   || Operaciones en Regimen especial bienes usados etc.
         |HAZ Total3_6;   || Operaciones en Regimen especial Agencias Viajes
         |HAZ Total3_7;   || Operaciones en Determinacion Proporcional
     |FINSI;

     |SI enModelo = 303;
         |HAZ Total3_1;   || Operaciones en Regimen General
         |HAZ Total3_5;   || Operaciones en Regimen especial bienes usados etc.
         |HAZ Total3_6;   || Operaciones en Regimen especial Agencias Viajes
     |FINSI;

     |HAZ Total2_10;  || Suma de Deducciones
     |HAZ Total3_15;  || Total Volumnen de Operaciones
|FPRC;

|PROCESO GrabaRegistros;
     |SI enModelo ! 303;
         |SI enModelo = 300;  |O enModelo = 330;  |O enModelo = 370;
             |SI #7#4 = 2;  |ACABA;  |FINSI;
         |SINO;
             |SI #7#4 = 1;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #7#0 = 2;  |Y #7#1 = 10;
         |SI #0#1 [ 2007;
             #7#2 = "      Suma de deducciones ........................";
             #7#3 = "T";
             #7#4 = 0;
             #7#5 = 2;
             #7#6 = 0;
             #7#7 = 0;
         |SINO;
             #7#2 = "Regularizacion aplicacion porcentaje def.prorrata";
             #7#3 = "D";
             #7#4 = 0;
             #7#5 = 0;
             #7#6 = 0;
             #7#7 = 0;
         |FINSI;
     |FINSI;

     |DDEFECTO #0;
     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = #7#0;
     #0#7  = #7#1;
     #0#8  = #7#2;
     #0#9  = #7#3;
     #0#11 = #7#5;

     |SI #7#0 = 5;  |Y #7#1 = 1;
         #0#12 = 100;
     |FINSI;

     |GRABA 020#0n;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsmom007;
     #7#1;
     ;
     0, 00;
     5, 99;
     ;
     NULL, GrabaRegistros;
|FIN;

|PROCESO GrabaRegistros117;
     |SI #117#7 = 0;
         |ACABA;
     |FINSI;
     |SI #117#4 = 3; |ACABA; |FINSI;

     |DDEFECTO #0;
     #0#0  = enEmpresa;
     #0#1  = enEjer;
     #0#2  = enPeriodo;
     #0#3  = enModelo;
     #0#4  = enComplem;
     #0#5  = enActividad;
     #0#6  = #117#0;
     #0#7  = #117#1;
     #0#8  = #117#2;
     #0#9  = #117#3;
     #0#11 = #117#5;
     #0#56 = #117#7;

     |SI #117#0 = 5;  |Y #117#1 = 1;
         #0#12 = 100;
     |FINSI;

     |GRABA 020#0n;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsmom117;
     #117#1;
     ;
     nEjerCarga, 0, 00;
     nEjerCarga, 5, 99;
     ;
     NULL, GrabaRegistros117;
|FIN;

|PROCESO dsmociva;             ||Atencion
     |NOME_DAT #0  aFitxer300;
     |SI enEjer [ 2008;
         |NOME_DAT #300 aFitxer301;
     |SINO;
         |SI enEjer [ 2013;
             |NOME_DAT #303 aFitxer301;
         |SINO;
             |NOME_DAT #304 aFitxer301;
         |FINSI;
         |SI enEjer > 2010; |Y enSwProrr < 2;
             |NOME_DAT #87 aFitxer87;
         |FINSI;
     |FINSI;

     eaNomDef = "dsmociva";

|| \\\\\\ Baja del Modelo desde planillas ////////

     |SI enTipoEntrada = 97;              ||Baja del Modelo
         |BUCLE dsmocivaB;
         |SI enEjer > 2010; |Y enSwProrr < 2;
             |BUCLE dsmom087B;
         |FINSI;
         |HAZ Registro0;
         |ACABA;
     |FINSI;

|| Creacion unicamente del Modelo

     |SI enEjer > 2010; |Y enSwProrr < 2;
         enProAct = 100;
         enProCom = 100;
         |HAZ eNuevoPro;
     |FINSI;

     |SI enTipoEntrada = 90;              || Creacion Solamente
         |ABRE #0;
         #0#0 = enEmpresa;
         #0#1 = enEjer;
         #0#2 = enPeriodo;
         #0#3 = enModelo;
         #0#4 = enComplem;
         #0#5 = enActividad;
         #0#6 = 0;
         #0#7 = 0;
         |LEE 040#0];
         |SI FSalida ! 0;  |O #0#0 ! enEmpresa;  |O #0#1 ! enEjer; |O #0#2 ! enPeriodo;
          |O #0#3 ! enModelo;  |O #0#4 ! enComplem; |O #0#5 ! enActividad;
             |SI nEjerCarga [ 2010;
                 |BUCLE dsmom007;
             |SINO;
                 |BUCLE dsmom117;
             |FINSI;
         |FINSI;
         |CIERRA #0;

         |ACABA;
     |FINSI;

|| Creacion unicamente del Modelo de Impresion

     |SI enTipoEntrada = 91;
         |HAZ Registro0;
         |ACABA;
     |FINSI;

|| Calcula unicamente del Modelo de Trabajo

     |SI enTipoEntrada = 95;              || Calculo del dsmociva
         |ABRE #0;
         |HAZ Totales;
         |CIERRA #0;
     |FINSI;
|FPRC;
