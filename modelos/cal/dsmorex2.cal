/****************************************************************************
*****************************************************************************
*****                  PRESENTACION HISTORICOS MODELOS                  *****
*****************************************************************************
****************************************************************************/

|FICHEROS;
   dsmow334;
   dsmow336;
   dsmow337;
   dsmow338;
   dsmow340;
   dsmow341,MANTE;
   dsmow344;
   dsmow345;
   dsmow352 #18,MANTE;

   dsminmex;
   dsmivcex;

   dsmow390 #50;
   dsmow391 #51;
   dsmow355 #55;

   dsm210dp;
   dsm210db;

   dsm213hi;
   dsm213h1;
   dsm213h2;
   dsm211la;
   dsm210tr;
   dsm210in;
   dsm210ni;
   dsm210ln;
   dsm210fp;
   dsm210ca;
   dsm211ca;
   dsm211tr;

   dsm213ca;
   dsm213so;
   dsm213in;

   dsm210hi;
   dsm210h1;
   dsm210h2;
   dsm210h3;
   dsm210h4;

   dsm211hi;
   dsm211h1;
   dsm211h2;

   reacceso@;
   rem00100@;
   rem00021@;
|FIN;

|VARIABLES;
   &enPorc1 = 0;
   &enPorc2 = 0;
   &eaConyuge = "";

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";

   nModo = 0;
   fFecha = @;
   FEstado = 0;

   aDNif = "";
   aHNif = "";
   nDInm = 0;
   nHInm = 0;

   nContCmp = 0;

   nPant0  = 0;
   nVent0  = 0;
   nVent1  = 0;
   nPant1  = 0;
   nGrid1  = 0;
   nGrid1a = 0;
   nGrid1b = 0;
   nGrid1c = 0;
   nGrid2  = 0;
   nGridSel = 0;
   nGridL1  = 0;
   nGridL2  = 0;
   nBoton1 = 0;
   nBoton2 = 0;
   nBotonValida  = 0;
   nBotonCancela = 0;
   nLabel1       = 0;

   nLinea  = 0;

   nSwEndatos = 0;

   nRango  = 0;
   nPos1   = 0;
   nPos2   = 0;

   nCont   = 0;

   fHoy    = @;

   fFecha0 = @;
   fFecha2 = @;
   nCalc   = 0;
   nCalc1  = 0;
   nCalc2  = 0;

   nSwConDatos = 0;
   nActualiza  = 0;
   nActualAnt  = 0;
   nPaseHecho  = 0;
   nSwHayDatos = 0;

      nDia1 = 0;
      nDia2 = 0;
      nMes1 = 0;
      nMes2 = 0;
      nAny1 = 0;
      nAny2 = 0;
      nEdad = 0;

   || NO METER VARIABLES ENTRE ESTE BLOQUE
{-1}aVent      = "";
    aVent1     = 0;
    aVent2     = 0;
    aVent3     = 0;
    aVent4     = 0;
    aVent5     = "";
   || NO METER VARIABLES ENTRE ESTE BLOQUE
   aEsc1   = "";
   aEsc2   = "";
   aRetu   = "";
   aTecla1 = "";
   aTecla  = "";

   aDesde  = "";
   aHasta  = "";
   nSwAny  = 0;

   &nTr210tr   = 0;
   &nEj210tr   = 0;
   &nTg210tr   = 0;
   &fFecha1    = @;
|FIN;

|PROCESO Elimina213in;
   |BORRA 020#dsm213in.a;
|FPRC;

|DEFBUCLE Elimina213in;
    #dsm213in#1;
    ;
    #dsm213ca#0, #dsm213ca#1, 000;
    #dsm213ca#0, #dsm213ca#1, 999;
    ;
    NULL, Elimina213in;
|FIN;

|PROCESO Elimina213so;
   |BORRA 020#dsm213so.a;
|FPRC;

|DEFBUCLE Elimina213so;
    #dsm213so#1;
    ;
    #dsm213ca#0, #dsm213ca#1, "               ";
    #dsm213ca#0, #dsm213ca#1, "zzzzzzzzzzzzzzz";
    ;
    NULL, Elimina213so;
|FIN;

|PROCESO EliminaRegistro213;
   |BUCLE Elimina213in;
   |BUCLE Elimina213so;
|FPRC;

|PROCESO Graba213so;
   |DDEFECTO #dsm213so;
   #dsm213so#0  = #dsm213h1#0;
   #dsm213so#1  = #dsm213h1#3;
   #dsm213so#2  = #dsm213h1#5;
   #dsm213so#3  = #dsm213h1#6;
   #dsm213so#4  = #dsm213h1#7;
   #dsm213so#5  = #dsm213h1#8;
   #dsm213so#6  = #dsm213h1#9;
   #dsm213so#7  = #dsm213h1#10;
   #dsm213so#8  = #dsm213h1#11;
   #dsm213so#9  = #dsm213h1#12;
   #dsm213so#10 = #dsm213h1#13;
   #dsm213so#11 = #dsm213h1#14;
   #dsm213so#12 = #dsm213h1#15;
   #dsm213so#13 = #dsm213h1#16;
   #dsm213so#14 = #dsm213h1#17;
   #dsm213so#15 = #dsm213h1#18;
   #dsm213so#16 = #dsm213h1#19;
   #dsm213so#17 = #dsm213h1#20;
   #dsm213so#18 = #dsm213h1#21;
   #dsm213so#19 = #dsm213h1#22;
   #dsm213so#20 = #dsm213h1#23;
   #dsm213so#21 = #dsm213h1#24;
   #dsm213so#22 = #dsm213h1#25;
   #dsm213so#23 = #dsm213h1#26;
   #dsm213so#24 = #dsm213h1#27;
   #dsm213so#25 = #dsm213h1#28;
   #dsm213so#26 = #dsm213h1#29;
   #dsm213so#27 = #dsm213h1#30;
   #dsm213so#28 = #dsm213h1#31;
   #dsm213so#29 = #dsm213h1#32;
   #dsm213so#30 = #dsm213h1#33;
   #dsm213so#31 = #dsm213h1#34;
   #dsm213so#32 = #dsm213h1#35;
   #dsm213so#33 = #dsm213h1#36;
   #dsm213so#34 = #dsm213h1#37;
   #dsm213so#35 = #dsm213h1#38;
   #dsm213so#36 = #dsm213h1#39;
   |GRABA 020#dsm213so.n;
|FPRC;

|DEFBUCLE Graba213so;
    #dsm213h1#1;
    ;
    #dsm213hi#0, #dsm213hi#1, #dsm213hi#2, #dsm213hi#3, #dsm213hi#4, aAlfa1;
    #dsm213hi#0, #dsm213hi#1, #dsm213hi#2, #dsm213hi#3, #dsm213hi#4, aAlfa2;
    ;
    NULL, Graba213so;
|FIN;

|PROCESO Graba213in;
   |DDEFECTO #dsm213in;
   #dsm213in#0  = #dsm213h2#0;
   #dsm213in#1  = #dsm213h2#3;
   #dsm213in#2  = #dsm213h2#5;
   #dsm213in#3  = #dsm213h2#6;
   #dsm213in#4  = #dsm213h2#7;
   #dsm213in#5  = #dsm213h2#8;
   #dsm213in#6  = #dsm213h2#9;
   #dsm213in#7  = #dsm213h2#10;
   #dsm213in#8  = #dsm213h2#11;
   #dsm213in#9  = #dsm213h2#12;
   #dsm213in#10 = #dsm213h2#13;
   #dsm213in#11 = #dsm213h2#14;
   #dsm213in#12 = #dsm213h2#15;
   #dsm213in#13 = #dsm213h2#16;
   #dsm213in#14 = #dsm213h2#17;
   #dsm213in#15 = #dsm213h2#18;
   #dsm213in#16 = #dsm213h2#19;
   #dsm213in#17 = #dsm213h2#20;
   #dsm213in#18 = #dsm213h2#21;
   #dsm213in#19 = #dsm213h2#22;
   #dsm213in#20 = #dsm213h2#23;
   #dsm213in#21 = #dsm213h2#24;
   |GRABA 020#dsm213in.n;
|FPRC;

|DEFBUCLE Graba213in;
    #dsm213h2#1;
    ;
    #dsm213hi#0, #dsm213hi#1, #dsm213hi#2, #dsm213hi#3, #dsm213hi#4, 000;
    #dsm213hi#0, #dsm213hi#1, #dsm213hi#2, #dsm213hi#3, #dsm213hi#4, 999;
    ;
    NULL, Graba213in;
|FIN;

|PROCESO EnviarEntr213;
   |ABRE #dsm213ca; |ABRE #dsm213so; |ABRE #dsm213in;
   #dsm213ca#0  = #dsm213hi#0;
   #dsm213ca#1  = #dsm213hi#3;
   |LEE 101#dsm213ca.=;
   |SI FSalida = 0;
      aAlfa = "    NEl contribuyente seleccionado ya tiene datos en la administración indicada. " + &191 + " Reescribir los datos ? ";
      |CONFI aAlfa;
      |SI FSalida = 0;
         |HAZ EliminaRegistro213;
         |BORRA 020#dsm213ca.a; |LIBERA #dsm213ca;
      |SINO;
         |CIERRA #dsm213ca; |CIERRA #dsm213so; |CIERRA #dsm213in;
         |ACABA;
      |FINSI;
   |FINSI;

   |DDEFECTO #dsm213ca;
   #dsm213ca#0  = #dsm213hi#0;
   #dsm213ca#1  = #dsm213hi#3;
   #dsm213ca#2  = #dsm213hi#5;
   #dsm213ca#3  = #dsm213hi#6;
   #dsm213ca#4  = #dsm213hi#7;
   #dsm213ca#5  = #dsm213hi#8;
   #dsm213ca#6  = #dsm213hi#9;
   #dsm213ca#7  = #dsm213hi#10;
   #dsm213ca#8  = #dsm213hi#11;
   #dsm213ca#9  = #dsm213hi#12;
   #dsm213ca#10 = #dsm213hi#13;
   #dsm213ca#11 = #dsm213hi#14;
   #dsm213ca#12 = #dsm213hi#15;
   #dsm213ca#13 = #dsm213hi#16;
   #dsm213ca#14 = #dsm213hi#17;
   #dsm213ca#15 = #dsm213hi#18;
   #dsm213ca#16 = #dsm213hi#19;
   #dsm213ca#17 = #dsm213hi#20;
   #dsm213ca#18 = #dsm213hi#21;
   #dsm213ca#19 = #dsm213hi#22;
   |GRABA 020#dsm213ca.c;

   |BUCLE Graba213in;
   aAlfa1 = " " * 15; aAlfa2 = "z" * 15;
   |BUCLE Graba213so;

   |CIERRA #dsm213ca; |CIERRA #dsm213so; |CIERRA #dsm213in;
   |MENAV "    Emision replicada en la entrada de datos";
|FPRC;

|PROCESO Borra213h1;
   |BORRA 020#dsm213h1.a; |LIBERA #dsm213h1;
|FPRC;

|DEFBUCLE Borra213h1;
   #dsm213h1#1;
   ;
   #dsm213hi#0,#dsm213hi#1,#dsm213hi#2,#dsm213hi#3, #dsm213hi#4,"               ";
   #dsm213hi#0,#dsm213hi#1,#dsm213hi#2,#dsm213hi#3, #dsm213hi#4,"zzzzzzzzzzzzzzz";
   be;
   NULL, Borra213h1;
|FIN;

|PROCESO Borra213h2;
   |BORRA 020#dsm213h2.a; |LIBERA #dsm213h2;
|FPRC;

|DEFBUCLE Borra213h2;
   #dsm213h2#1;
   ;
   #dsm213hi#0, #dsm213hi#1, #dsm213hi#2, #dsm213hi#3, #dsm213hi#4, 000;
   #dsm213hi#0, #dsm213hi#1, #dsm213hi#2, #dsm213hi#3, #dsm213hi#4, 999;
   be;
   NULL, Borra213h2;
|FIN;

|PROCESO BorrarEm213;
   aAlfa = "    N" + &191 + " Esta seguro de eliminar la emisión seleccionada ?";
   |CONFI aAlfa;
   |SI FSalida = 0;
      |BUCLE Borra213h1; |BUCLE Borra213h2;
      |BORRA 020#dsm213hi.a;

      |REFRESCACONTROL nGrid1;
   |FINSI;
|FPRC;

|PROCESO EvtoHist213;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm213hi.c;

      #dsmow334#0 = #dsm213hi#9;  |PINTA #dsmow334#0;
      #dsmow334#1 = #dsm213hi#10; |PINTA #dsmow334#1;
      #dsmow334#2 = #dsm213hi#11; |PINTA #dsmow334#2;
      #dsmow334#3 = #dsm213hi#12; |PINTA #dsmow334#3;
      #dsmow334#4 = #dsm213hi#13; |PINTA #dsmow334#4;
      #dsmow334#5 = #dsm213hi#14; |PINTA #dsmow334#5;
      #dsmow334#6 = #dsm213hi#15; |PINTA #dsmow334#6;
      #dsmow334#7 = #dsm213hi#16; |PINTA #dsmow334#7;

      |REFRESCACONTROL nGrid1a; |REFRESCACONTROL nGrid1b;
      nSwConDatos = 1;
   |FINSI;
|FPRC;

|PROCESO EvtoHSoc;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm213h1.c;
   |FINSI;
|FPRC;

|PROCESO EvtoHInm;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm213h2.c;
   |FINSI;
|FPRC;

|PROCESO InfHSoc213;
   #dsm213h1#0 = #dsm213hi#0;
   #dsm213h1#1 = #dsm213hi#1;
   #dsm213h1#2 = #dsm213hi#2;
   #dsm213h1#3 = #dsm213hi#3;
   #dsm213h1#4 = #dsm213hi#4;
   #dsm213h1#5 = "";
|FPRC;

|PROCESO SupHSoc213;
   #dsm213h1#0 = #dsm213hi#0;
   #dsm213h1#1 = #dsm213hi#1;
   #dsm213h1#2 = #dsm213hi#2;
   #dsm213h1#3 = #dsm213hi#3;
   #dsm213h1#4 = #dsm213hi#4;
   #dsm213h1#5 = "zzzzzzzzzzzzzzz";
|FPRC;

|PROCESO InfHInm213;
   #dsm213h2#0 = #dsm213hi#0;
   #dsm213h2#1 = #dsm213hi#1;
   #dsm213h2#2 = #dsm213hi#2;
   #dsm213h2#3 = #dsm213hi#3;
   #dsm213h2#4 = #dsm213hi#4;
   #dsm213h2#5 = 1;
|FPRC;

|PROCESO SupHInm213;
   #dsm213h2#0 = #dsm213hi#0;
   #dsm213h2#1 = #dsm213hi#1;
   #dsm213h2#2 = #dsm213hi#2;
   #dsm213h2#3 = #dsm213hi#3;
   #dsm213h2#4 = #dsm213hi#4;
   #dsm213h2#5 = 999;
|FPRC;

|PROCESO InfHist213;
   #dsm213hi#0 = #dsm210dp#0;
   #dsm213hi#1 = 0000;
   #dsm213hi#2 = 0;
   #dsm213hi#3 = 00000;
   #dsm213hi#4 = 0;
|FPRC;

|PROCESO SupHist213;
   #dsm213hi#0 = #dsm210dp#0;
   #dsm213hi#1 = 9999;
   #dsm213hi#2 = 0;
   #dsm213hi#3 = 99999;
   #dsm213hi#4 = 9;
|FPRC;

|PROCESO Historico213;
   |ABRE #dsm213hi; |ABRE #dsm213h1; |ABRE #dsm213h2;

   aAlfa = "Mod.213 : Historico emisiones [" + #dsm210dp#2; |QBF aAlfa;
   aAlfa = aAlfa + "] " + #dsm210dp#1;
   |VENTANA 0510, 2889, 1, 17, aAlfa; nVent0 = FSalida;
   aVent1 = -1; aVent2 = -1; aVent3 = 0;
   aVent4 = nVent0;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |PINPA #0#dsmow334; nPant0 = FSalida;
   |PINDA #0#dsmow334;

   nPos1 = 2858; nPos2 = 2878;
   |CONTROL_SIMPLE nPant0, "BOTON,{{197}}Enviar a entrada datos", nPos1, nPos2, EnviarEntr213;
   nBoton1 = FSalida;

   nPos1 = 2842; nPos2 = 2856;
   |CONTROL_SIMPLE nPant0, "BOTON,{{199}}Borrar emisión", nPos1, nPos2, BorrarEm213;
   nBoton2 = FSalida;

   nSwConDatos = 0;
   nRango = 4 + 8 + 16 + 32;
   nPos1 = 0602; nPos2 = 1179;
   |LINEAL_SIMPLE #1#dsm213hi, nRango, nPos1, nPos2, InfHist213, SupHist213, EvtoHist213;
   nGrid1 = FSalida;

   |SI nSwConDatos = 0; |DDEFECTO #dsm213hi; |FINSI;
   nPos1 = 1702; nPos2 = 2639;
   |LINEAL_SIMPLE #1#dsm213h1, nRango, nPos1, nPos2, InfHSoc213, SupHSoc213, EvtoHSoc;
   nGrid1a = FSalida;

   nPos1 = 1741; nPos2 = 2679;
   |LINEAL_SIMPLE #1#dsm213h2, nRango, nPos1, nPos2, InfHInm213, SupHInm213, EvtoHInm;
   nGrid1b = FSalida;
   |PULSATECLA;

   aEsc1  = &255 + "806";
   aEsc2  = &255 + "807";
   aRetu  = &255 + "802";
   |PARA; |SI;  |HACIENDO;
      FSalida = "::{{001}}Salir," + nGrid1;
      |LEETECLA aTecla1;
      |SI aTecla1 = aEsc1; |SAL; |FINSI;
      |SI aTecla1 = aEsc2; |SAL; |FINSI;
      |SI aTecla1 = aRetu; |SAL; |FINSI;
   |SIGUE;

   |DESTRUYECONTROL nGrid1;
   |DESTRUYECONTROL nGrid1a;
   |DESTRUYECONTROL nGrid1b;
   |FIN_CONTROL_WINDOWS nBoton1;
   |FIN_CONTROL_WINDOWS nBoton2;

   aVent4 = nVent0;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent0;

   |CIERRA #dsm213hi; |CIERRA #dsm213h1; |CIERRA #dsm213h2;
|FPRC;

|PROCESO Borra210h1;
   |BORRA 020#dsm210h1.a; |LIBERA #dsm210h1;
|FPRC;

|DEFBUCLE Borra210h1;
   #dsm210h1#1;
   ;
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, 000;
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, 999;
   be;
   NULL, Borra210h1;
|FIN;

|PROCESO Borra210h2;
   |BORRA 020#dsm210h2.a; |LIBERA #dsm210h2;
|FPRC;

|DEFBUCLE Borra210h2;
   #dsm210h2#1;
   ;
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, "               ";
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, "zzzzzzzzzzzzzzz";
   be;
   NULL, Borra210h2;
|FIN;

|PROCESO Borra210h3;
   |BORRA 020#dsm210h3.a; |LIBERA #dsm210h3;
|FPRC;

|DEFBUCLE Borra210h3;
   #dsm210h3#1;
   ;
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aDesde, 000, "01.01.0000", 000;
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aHasta, 999, "31.12.9999", 999;
   be;
   NULL, Borra210h3;
|FIN;

|PROCESO Borra210h4;
   |BORRA 020#dsm210h4.a; |LIBERA #dsm210h4;
|FPRC;

|DEFBUCLE Borra210h4;
   #dsm210h4#1;
   ;
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aDesde, 000, 000, "  ";
   #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aHasta, 999, 999, "zz";
   be;
   NULL, Borra210h4;
|FIN;

|PROCESO BorrarEm210;
   aAlfa = "    N" + &191 + " Esta seguro de eliminar la emisión seleccionada ?";
   |CONFI aAlfa;
   |SI FSalida = 0;
      aDesde = " " * 15; aHasta = "z" * 15;
      |BUCLE Borra210h1; |BUCLE Borra210h2;
      |BUCLE Borra210h3; |BUCLE Borra210h4;
      |BORRA 020#dsm210hi.a;

      |REFRESCACONTROL nGrid1;
   |FINSI;
|FPRC;

|PROCESO EvtoHist210;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm210hi.c;

      #dsm210tr#0 = #dsm210hi#4;
      #dsm210tr#6 = #dsm210hi#1;
      |LEE 000#dsm210tr.=;
      |SI FSalida ! 0; |DDEFECTO #dsm210tr; |FINSI;

      |REFRESCACONTROL nGrid1a;
      |REFRESCACONTROL nGrid1b;
      |REFRESCACONTROL nGrid1c;
      nSwConDatos = 1;
   |FINSI;
|FPRC;

|PROCESO EvtoHInm210;
   |SI FSalida = 1; |O FSalida = 2;

      |LEE 000#dsm210h1.c;

      |REFRESCACONTROL nGrid1b;
      |REFRESCACONTROL nGrid1c;
   |FINSI;
|FPRC;

|PROCESO Elimina210in;
   |BORRA 020#dsm210in.a;
|FPRC;

|DEFBUCLE Elimina210in;
    #dsm210in#1;
    ;
    #dsm210ca#0, #dsm210ca#1, 000;
    #dsm210ca#0, #dsm210ca#1, 999;
    ;
    NULL, Elimina210in;
|FIN;

|PROCESO Elimina210ni;
   |BORRA 020#dsm210ni.a;
|FPRC;

|DEFBUCLE Elimina210ni;
    #dsm210ni#1;
    ;
    #dsm210ca#0, #dsm210ca#1, "               ";
    #dsm210ca#0, #dsm210ca#1, "zzzzzzzzzzzzzzz";
    ;
    NULL, Elimina210ni;
|FIN;

|PROCESO Elimina210ln;
   |BORRA 020#dsm210ln.a;
|FPRC;

|DEFBUCLE Elimina210ln;
    #dsm210ln#1;
    ;
    #dsm210ca#0, #dsm210ca#1, aAlfa1, 000, "01.01.0000", 000;
    #dsm210ca#0, #dsm210ca#1, aAlfa2, 999, "31.12.9999", 999;
    ;
    NULL, Elimina210ln;
|FIN;

|PROCESO Elimina210fp;
   |BORRA 020#dsm210fp.a;
|FPRC;

|DEFBUCLE Elimina210fp;
    #dsm210fp#1;
    ;
    #dsm210ca#0, #dsm210ca#1, aAlfa1, 000, 000, " ";
    #dsm210ca#0, #dsm210ca#1, aAlfa2, 999, 999, "z";
    ;
    NULL, Elimina210fp;
|FIN;

|PROCESO EliminaRegistro210;
   |BUCLE Elimina210in; |BUCLE Elimina210ni;
   |BUCLE Elimina210ln; |BUCLE Elimina210fp;
|FPRC;

|PROCESO Graba210in;
   |DDEFECTO #dsm210in;
   #dsm210in#0 = #dsm210h1#0;
   #dsm210in#1 = #dsm210h1#4;
   #dsm210in#2 = #dsm210h1#5;
   #dsm210in#3 = #dsm210h1#6;
   #dsm210in#4 = #dsm210h1#7;
   #dsm210in#5 = #dsm210h1#8;
   #dsm210in#6 = #dsm210h1#9;
   #dsm210in#7 = #dsm210h1#10;
   #dsm210in#8 = #dsm210h1#11;
   #dsm210in#9 = #dsm210h1#12;
   #dsm210in#10 = #dsm210h1#13;
   #dsm210in#11 = #dsm210h1#14;
   |GRABA 020#dsm210in.n;
|FPRC;

|DEFBUCLE Graba210in;
    #dsm210h1#1;
    ;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, 000;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, 999;
    ;
    NULL, Graba210in;
|FIN;

|PROCESO Graba210ni;
   |DDEFECTO #dsm210in;
   #dsm210ni#0 = #dsm210h2#0;
   #dsm210ni#1 = #dsm210h2#4;
   #dsm210ni#2 = #dsm210h2#5;
   #dsm210ni#3 = #dsm210h2#6;
   #dsm210ni#4 = #dsm210h2#7;
   |GRABA 020#dsm210ni.n;
|FPRC;

|DEFBUCLE Graba210ni;
    #dsm210h2#1;
    ;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aAlfa1;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aAlfa2;
    ;
    NULL, Graba210ni;
|FIN;

|PROCESO Graba210ln;
   |DDEFECTO #dsm210ln;
   #dsm210ln#0 = #dsm210h3#0;
   #dsm210ln#1 = #dsm210h3#4;
   #dsm210ln#2 = #dsm210h3#5;
   #dsm210ln#3 = #dsm210h3#6;
   #dsm210ln#4 = #dsm210h3#7;
   #dsm210ln#5 = #dsm210h3#8;
   #dsm210ln#6 = #dsm210h3#9;
   #dsm210ln#7 = #dsm210h3#10;
   #dsm210ln#8 = #dsm210h3#11;
   #dsm210ln#9 = #dsm210h3#12;
   #dsm210ln#10 = #dsm210h3#13;
   #dsm210ln#11 = #dsm210h3#14;
   #dsm210ln#12 = #dsm210h3#15;
   #dsm210ln#13 = #dsm210h3#16;
   #dsm210ln#14 = #dsm210h3#17;
   #dsm210ln#15 = #dsm210h3#18;
   #dsm210ln#16 = #dsm210h3#19;
   #dsm210ln#17 = #dsm210h3#20;
   #dsm210ln#18 = #dsm210h3#21;
   #dsm210ln#19 = #dsm210h3#22;
   #dsm210ln#20 = #dsm210h3#23;
   #dsm210ln#21 = #dsm210h3#24;
   #dsm210ln#22 = #dsm210h3#25;
   #dsm210ln#23 = #dsm210h3#26;
   #dsm210ln#24 = #dsm210h3#27;
   #dsm210ln#25 = #dsm210h3#28;
   #dsm210ln#26 = #dsm210h3#29;
   #dsm210ln#27 = #dsm210h3#30;
   #dsm210ln#28 = #dsm210h3#31;
   #dsm210ln#29 = #dsm210h3#32;
   #dsm210ln#30 = #dsm210h3#33;
   #dsm210ln#31 = #dsm210h3#34;
   #dsm210ln#32 = #dsm210h3#35;
   #dsm210ln#33 = #dsm210h3#36;
   #dsm210ln#34 = #dsm210h3#38;
   #dsm210ln#35 = #dsm210h3#39;
   #dsm210ln#36 = #dsm210h3#40;
   #dsm210ln#37 = #dsm210h3#41;
   #dsm210ln#38 = #dsm210h3#42;
   #dsm210ln#39 = #dsm210h3#43;
   |GRABA 020#dsm210ln.n;
|FPRC;

|DEFBUCLE Graba210ln;
    #dsm210h3#1;
    ;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aAlfa1, 000, "01.01.0000", 000;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aAlfa2, 999, "31.12.9999", 999;
    ;
    NULL, Graba210ln;
|FIN;

|PROCESO Graba210fp;
   |DDEFECTO #dsm210fp;
   #dsm210fp#0 = #dsm210h4#0;
   #dsm210fp#1 = #dsm210h4#4;
   #dsm210fp#2 = #dsm210h4#5;
   #dsm210fp#3 = #dsm210h4#6;
   #dsm210fp#4 = #dsm210h4#7;
   #dsm210fp#5 = #dsm210h4#8;
   #dsm210fp#6 = #dsm210h4#9;
   #dsm210fp#7 = #dsm210h4#10;
   #dsm210fp#8 = #dsm210h4#11;
   #dsm210fp#9 = #dsm210h4#12;
   #dsm210fp#10 = #dsm210h4#13;
   #dsm210fp#11 = #dsm210h4#14;
   #dsm210fp#12 = #dsm210h4#15;
   #dsm210fp#13 = #dsm210h4#16;
   #dsm210fp#14 = #dsm210h4#17;
   #dsm210fp#15 = #dsm210h4#18;
   #dsm210fp#16 = #dsm210h4#19;
   #dsm210fp#17 = #dsm210h4#20;
   #dsm210fp#18 = #dsm210h4#21;
   #dsm210fp#19 = #dsm210h4#22;
   #dsm210fp#20 = #dsm210h4#23;
   #dsm210fp#21 = #dsm210h4#24;
   #dsm210fp#22 = #dsm210h4#25;
   #dsm210fp#23 = #dsm210h4#26;
   #dsm210fp#24 = #dsm210h4#27;
   #dsm210fp#25 = #dsm210h4#28;
   #dsm210fp#26 = #dsm210h4#29;
   #dsm210fp#27 = #dsm210h4#30;
   #dsm210fp#28 = #dsm210h4#31;
   #dsm210fp#29 = #dsm210h4#32;
   #dsm210fp#30 = #dsm210h4#33;
   #dsm210fp#31 = #dsm210h4#34;
   #dsm210fp#32 = #dsm210h4#35;
   #dsm210fp#33 = #dsm210h4#36;
   #dsm210fp#34 = #dsm210h4#37;
   #dsm210fp#35 = #dsm210h4#38;
   #dsm210fp#36 = #dsm210h4#39;
   #dsm210fp#37 = #dsm210h4#40;
   |GRABA 020#dsm210fp.n;
|FPRC;

|DEFBUCLE Graba210fp;
    #dsm210h4#1;
    ;
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aAlfa1, 000, 000, " ";
    #dsm210hi#0, #dsm210hi#1, #dsm210hi#2, #dsm210hi#3, #dsm210hi#4, aAlfa2, 999, 999, "z";
    ;
    NULL, Graba210fp;
|FIN;

|PROCESO EnviarEntr210;
   |ABRE #dsm210ca; |ABRE #dsm210ni; |ABRE #dsm210in;
   |ABRE #dsm210ln; |ABRE #dsm210fp;
   #dsm210ca#0  = #dsm210hi#0;
   #dsm210ca#1  = #dsm210hi#4;
   |LEE 101#dsm210ca.=;
   |SI FSalida = 0;
      aAlfa = "    NEl contribuyente seleccionado ya tiene datos en la administración indicada. " + &191 + " Reescribir los datos ? ";
      |CONFI aAlfa;
      |SI FSalida = 0;
         |HAZ EliminaRegistro210;
         |BORRA 020#dsm210ca.a; |LIBERA #dsm210ca;
      |SINO;
         |CIERRA #dsm210ca; |CIERRA #dsm210ni; |CIERRA #dsm210in;
         |CIERRA #dsm210ln; |CIERRA #dsm210fp;
         |ACABA;
      |FINSI;
   |FINSI;

   |DDEFECTO #dsm210ca;
   #dsm210ca#0  = #dsm210hi#0;
   #dsm210ca#1  = #dsm210hi#4;
   #dsm210ca#2  = #dsm210hi#5;
   #dsm210ca#3  = #dsm210hi#6;
   #dsm210ca#4  = #dsm210hi#7;
   #dsm210ca#5  = #dsm210hi#8;
   #dsm210ca#7  = #dsm210hi#9;
   |GRABA 020#dsm210ca.c;

   |BUCLE Graba210in;
   aAlfa1 = " " * 15; aAlfa2 = "z" * 15;
   |BUCLE Graba210ni; |BUCLE Graba210ln; |BUCLE Graba210fp;

   |CIERRA #dsm210ca; |CIERRA #dsm210ni; |CIERRA #dsm210in;
   |CIERRA #dsm210ln; |CIERRA #dsm210fp;
   |MENAV "    Emision replicada en la entrada de datos";
|FPRC;

|PROCESO EvtoHNif210;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm210h2.c;

      |REFRESCACONTROL nGrid1c;
   |FINSI;
|FPRC;

|PROCESO EvtoHLin210;

   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm210h3.=;
      FEstado = FSalida;

      |SI nEj210tr = 2014;
          |SI #dsm210h3#39 = 0; |Y #dsm210h3#42 = 0;
              #dsm210h3#39 = #dsm210hi#8;
              #dsm210h3#42 = #dsm210hi#9;
              |SI #dsm210hi#6 = "X"; #dsm210h3#40 = "S"; |FINSI;
              |SI #dsm210hi#7 = "X"; #dsm210h3#41 = "S"; |FINSI;
          |FINSI;
      |FINSI;

      |SI #dsm210tr#2 = "S";
         |SI FEstado ! 0; |O #dsm210h3#0 ! #dsm210hi#0; |O #dsm210h3#4 ! #dsm210hi#4; |O #dsm210h3#6 ! #dsm210h1#5;
             |DDEFECTO #dsm210h3;
         |FINSI;
      |SINO;
         |SI #dsm210tr#3 = "S";
            |SI FEstado ! 0; |O #dsm210h3#0 ! #dsm210hi#0; |O #dsm210h3#4 ! #dsm210hi#4; |O #dsm210h3#5 ! #dsm210h2#5;
                |DDEFECTO #dsm210ln;
            |FINSI;
         |FINSI;
      |FINSI;

      #dsmow336#0 = #dsm210h3#40; |PINTA #dsmow336#0;
      #dsmow336#1 = #dsm210h3#41; |PINTA #dsmow336#1;
      #dsmow336#6 = #dsm210h3#42; |PINTA #dsmow336#6;
      #dsmow336#2 = #dsm210h3#39; |PINTA #dsmow336#2;

      |SI #dsm210tr#4 = "I"; |O #dsm210tr#4 = "G";
          #dsmow336#3 = #dsm210h3#10 % #dsm210h3#39; |PINTA #dsmow336#3;
          #dsmow336#7 = 0; |PINTA #dsmow336#7;
      |FINSI;
      |SI #dsm210tr#4 = "R";
         #dsmow336#3 = #dsm210h3#10 % #dsm210h3#39; |PINTA #dsmow336#3;
         #dsmow336#7 = #dsm210h3#11 % #dsm210h3#42; |PINTA #dsmow336#7;
      |FINSI;
      |SI #dsm210tr#4 = "H";
         #dsmow336#3  = #dsm210h3#10 % #dsm210h3#39; |PINTA #dsmow336#3;
         #dsmow336#7 = 0; |PINTA #dsmow336#7;
      |FINSI;
      #dsmow336#4  = #dsm210h3#30; |PINTA #dsmow336#4;
      #dsmow336#10 = #dsm210h3#31; |PINTA #dsmow336#10;
      #dsmow336#11 = #dsm210h3#34; |PINTA #dsmow336#11;

      |SI #dsmow336#3 < 0; #dsmow336#3 = 0; |FINSI; |PINTA #dsmow336#3;
      #dsmow336#5 = #dsmow336#3 - #dsmow336#4; |PINTA #dsmow336#5;
      |SI #dsmow336#7 < #dsmow336#5; |Y #dsmow336#7 > 0;
         #dsmow336#8 = #dsmow336#5 - #dsmow336#7;
      |SINO;
         #dsmow336#8 = 0;
      |FINSI;
      |PINTA #dsmow336#8;
      #dsmow336#9 = #dsmow336#5 - #dsmow336#8; |PINTA #dsmow336#9;
      #dsmow336#12 = #dsmow336#9 - #dsmow336#10 + #dsmow336#11; |PINTA #dsmow336#12;
   |FINSI;
|FPRC;

|PROCESO InfHist210;
   #dsm210hi#0 = #dsm210dp#0;
   #dsm210hi#1 = 0000;
   #dsm210hi#2 = 0;
   #dsm210hi#3 = 0;
   #dsm210hi#4 = 0;
|FPRC;

|PROCESO SupHist210;
   #dsm210hi#0 = #dsm210dp#0;
   #dsm210hi#1 = 9999;
   #dsm210hi#2 = 99;
   #dsm210hi#3 = 99;
   #dsm210hi#4 = 99;
|FPRC;

|PROCESO InfHInm210;
   #dsm210h1#0 = #dsm210hi#0;
   #dsm210h1#1 = #dsm210hi#1;
   #dsm210h1#2 = #dsm210hi#2;
   #dsm210h1#3 = #dsm210hi#3;
   #dsm210h1#4 = #dsm210hi#4;
   #dsm210h1#5 = 000;
|FPRC;

|PROCESO SupHInm210;
   #dsm210h1#0 = #dsm210hi#0;
   #dsm210h1#1 = #dsm210hi#1;
   #dsm210h1#2 = #dsm210hi#2;
   #dsm210h1#3 = #dsm210hi#3;
   #dsm210h1#4 = #dsm210hi#4;
   #dsm210h1#5 = 999;
|FPRC;

|PROCESO InfHNif210;
   #dsm210h2#0 = #dsm210hi#0;
   #dsm210h2#1 = #dsm210hi#1;
   #dsm210h2#2 = #dsm210hi#2;
   #dsm210h2#3 = #dsm210hi#3;
   #dsm210h2#4 = #dsm210hi#4;
   #dsm210h2#5 = "";
|FPRC;

|PROCESO SupHNif210;
   #dsm210h2#0 = #dsm210hi#0;
   #dsm210h2#1 = #dsm210hi#1;
   #dsm210h2#2 = #dsm210hi#2;
   #dsm210h2#3 = #dsm210hi#3;
   #dsm210h2#4 = #dsm210hi#4;
   #dsm210h2#5 = "zzzzzzzzzzzzzzz";
|FPRC;

|PROCESO InfHLin210;
   #dsm210h3#0 = #dsm210hi#0;
   #dsm210h3#1 = #dsm210hi#1;
   #dsm210h3#2 = #dsm210hi#2;
   #dsm210h3#3 = #dsm210hi#3;
   #dsm210h3#4 = #dsm210hi#4;
   |SI #dsm210tr#0 = 1; |O #dsm210tr#0 = 2; |O #dsm210tr#0 = 28; |O #dsm210tr#0 = 33;
        |O #dsm210tr#0 = 34;  |O #dsm210tr#0 = 35;
      #dsm210h3#5 = "";
      #dsm210h3#6 = #dsm210h1#5;
   |SINO;
      #dsm210h3#5 = #dsm210h2#5;
      #dsm210h3#6 = 000;
   |FINSI;
   #dsm210h3#7 = "01.01.0000";
   #dsm210h3#8 = 000;
|FPRC;

|PROCESO SupHLin210;
   #dsm210h3#0 = #dsm210hi#0;
   #dsm210h3#1 = #dsm210hi#1;
   #dsm210h3#2 = #dsm210hi#2;
   #dsm210h3#3 = #dsm210hi#3;
   #dsm210h3#4 = #dsm210hi#4;

   |SI #dsm210tr#0 = 1; |O #dsm210tr#0 = 2; |O #dsm210tr#0 = 28; |O #dsm210tr#0 = 33;
       |O #dsm210tr#0 = 34; |O #dsm210tr#0 = 35;
      #dsm210h3#5 = "";
      #dsm210h3#6 = #dsm210h1#5;
   |SINO;
      #dsm210h3#5 = #dsm210h2#5;
      #dsm210h3#6 = 000;
   |FINSI;
   #dsm210h3#7 = "31.12.9999";
   #dsm210h3#8 = 999;
|FPRC;

|PROCESO Reemitir210;
|FPRC;

|PROCESO BuscoPrihi;
   |ABRE #dsm210hi;
   #dsm210hi#0 = #dsm210dp#0;
   #dsm210hi#1 = 9999;
   #dsm210hi#2 = 0;
   #dsm210hi#3 = 0;
   #dsm210hi#4 = 0;
   |LEE 040#dsm210hi.];
   |SI FSalida = 0;
       |LEE 040#dsm210hi.a;
   |SINO;
       |LEE 040#dsm210hi.u;
   |FINSI;
   |SI FSalida = 0; |Y #dsm210dp#0 = #dsm210hi#0;
       nSwConDatos = 1;
       FSalida = 1;
       |HAZ EvtoHist210;
   |FINSI;
   |CIERRA #dsm210hi;
|FPRC;

|PROCESO Historico210;
   nSwConDatos = 0;
   |HAZ BuscoPrihi;
   |SI nSwConDatos = 0;
       |MENAV "0000No existe Registros en el Historico";
       |ACABA;
   |FINSI;

   |ABRE #dsm210hi; |ABRE #dsm210h1;
   |ABRE #dsm210h2; |ABRE #dsm210h3; |ABRE #dsm210h4;

   aAlfa = "Mod.210 : Historico emisiones [" + #dsm210dp#2; |QBF aAlfa;
   aAlfa = aAlfa + "] " + #dsm210dp#1;

   |VENTANA 0501, 3399, 1, 17, aAlfa; nVent0 = FSalida;
   aVent1 = -1; aVent2 = -1; aVent3 = 0;
   aVent4 = nVent0;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |PINPA #0#dsmow336; nPant0 = FSalida;
   |PINDA #0#dsmow336;

   nPos1 = 2880; nPos2 = 2898;
   |CONTROL_SIMPLE nPant0, "BOTON,{{197}}Enviar a entrada datos", nPos1, nPos2, EnviarEntr210;
   nBoton1 = FSalida;

   nPos1 = 2680; nPos2 = 2698;
   |CONTROL_SIMPLE nPant0, "BOTON,{{199}}Borrar emisión", nPos1, nPos2, BorrarEm210;
   nBoton2 = FSalida;
/*
   nSwConDatos = 0;
   |HAZ BuscoPrihi;
*/
   nRango = 4 + 8 + 16 + 32;
   nPos1 = 0602; nPos2 = 1098;
   |LINEAL_SIMPLE #1#dsm210hi, nRango, nPos1, nPos2, InfHist210, SupHist210, EvtoHist210;
   nGrid1 = FSalida;

   nPos1 = 1202; nPos2 = 1698;
   |LINEAL_SIMPLE #1#dsm210h1, nRango, nPos1, nPos2, InfHInm210, SupHInm210, EvtoHInm210;
   nGrid1a = FSalida;

   nPos1 = 1802; nPos2 = 2298;
   |LINEAL_SIMPLE #1#dsm210h2, nRango, nPos1, nPos2, InfHNif210, SupHNif210, EvtoHNif210;
   nGrid1b = FSalida;

   nPos1 = 2402; nPos2 = 2878;
   |LINEAL_SIMPLE #1#dsm210h3, nRango, nPos1, nPos2, InfHLin210, SupHLin210, EvtoHLin210;
   nGrid1c = FSalida;
   |PULSATECLA;

   aEsc1  = &255 + "806";
   aEsc2  = &255 + "807";
   aRetu  = &255 + "802";
   |PARA; |SI;  |HACIENDO;
      FSalida = "::{{001}}Salir," + nGrid1;
      |LEETECLA aTecla1;
      |SI aTecla1 = aEsc1; |SAL; |FINSI;
      |SI aTecla1 = aEsc2; |SAL; |FINSI;
      |SI aTecla1 = aRetu; |SAL; |FINSI;
   |SIGUE;

   |DESTRUYECONTROL nGrid1;
   |DESTRUYECONTROL nGrid1a;
   |DESTRUYECONTROL nGrid1b;
   |DESTRUYECONTROL nGrid1c;
   |FIN_CONTROL_WINDOWS nBoton1;
   |FIN_CONTROL_WINDOWS nBoton2;

   aVent4 = nVent0;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent0;

   |CIERRA #dsm210hi; |CIERRA #dsm210h1;
   |CIERRA #dsm210h2; |CIERRA #dsm210h3; |CIERRA #dsm210h4;
|FPRC;

|PROCESO Elimina211la;
   |BORRA 020#dsm211la.a;
|FPRC;

|DEFBUCLE Elimina211la;
    #dsm211la#1;
    ;
    #dsm211ca#0, #dsm211ca#1, "               ";
    #dsm211ca#0, #dsm211ca#1, "zzzzzzzzzzzzzzz";
    ;
    NULL, Elimina211la;
|FIN;

|PROCESO Elimina211tr;
   |BORRA 020#dsm211tr.a;
|FPRC;

|DEFBUCLE Elimina211tr;
    #dsm211tr#1;
    ;
    #dsm211ca#0, #dsm211ca#1, "               ";
    #dsm211ca#0, #dsm211ca#1, "zzzzzzzzzzzzzzz";
    ;
    NULL, Elimina211tr;
|FIN;

|PROCESO EliminaRegistro211;
   |BUCLE Elimina211la;
   |BUCLE Elimina211tr;
|FPRC;

|PROCESO Graba211tr;
   |DDEFECTO #dsm211tr;
   #dsm211tr#0  = #dsm211h2#0;
   #dsm211tr#1  = #dsm211h2#3;
   #dsm211tr#2  = #dsm211h2#4;
   #dsm211tr#3  = #dsm211h2#5;
   #dsm211tr#4  = #dsm211h2#6;
   #dsm211tr#5  = #dsm211h2#7;
   #dsm211tr#6  = #dsm211h2#8;
   #dsm211tr#7  = #dsm211h2#9;
   #dsm211tr#8  = #dsm211h2#10;
   #dsm211tr#9  = #dsm211h2#11;
   #dsm211tr#10 = #dsm211h2#12;
   #dsm211tr#11 = #dsm211h2#13;
   #dsm211tr#12 = #dsm211h2#14;
   #dsm211tr#13 = #dsm211h2#15;
   #dsm211tr#14 = #dsm211h2#16;
   #dsm211tr#15 = #dsm211h2#17;
   #dsm211tr#16 = #dsm211h2#18;
   #dsm211tr#17 = #dsm211h2#19;
   |GRABA 020#dsm211tr.n;
|FPRC;

|DEFBUCLE Graba211tr;
    #dsm211h2#1;
    ;
    #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, aAlfa1;
    #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, aAlfa2;
    ;
    NULL, Graba211tr;
|FIN;

|PROCESO Graba211la;
   |DDEFECTO #dsm211la;
   #dsm211la#0  = #dsm211h1#0;
   #dsm211la#1  = #dsm211h1#3;
   #dsm211la#2  = #dsm211h1#4;
   #dsm211la#3  = #dsm211h1#5;
   #dsm211la#4  = #dsm211h1#6;
   #dsm211la#5  = #dsm211h1#7;
   #dsm211la#6  = #dsm211h1#8;
   #dsm211la#7  = #dsm211h1#9;
   #dsm211la#8  = #dsm211h1#10;
   #dsm211la#9  = #dsm211h1#11;
   #dsm211la#10 = #dsm211h1#12;
   #dsm211la#11 = #dsm211h1#13;
   #dsm211la#12 = #dsm211h1#14;
   #dsm211la#13 = #dsm211h1#15;
   #dsm211la#14 = #dsm211h1#16;
   #dsm211la#15 = #dsm211h1#17;
   #dsm211la#16 = #dsm211h1#18;
   #dsm211la#17 = #dsm211h1#19;
   #dsm211la#18 = #dsm211h1#20;
   #dsm211la#19 = #dsm211h1#21;
   #dsm211la#20 = #dsm211h1#22;
   #dsm211la#21 = #dsm211h1#23;
   #dsm211la#22 = #dsm211h1#24;
   #dsm211la#23 = #dsm211h1#25;
   #dsm211la#24 = #dsm211h1#26;
   #dsm211la#25 = #dsm211h1#27;
   #dsm211la#26 = #dsm211h1#28;
   #dsm211la#27 = #dsm211h1#29;
   #dsm211la#28 = #dsm211h1#30;
   #dsm211la#29 = #dsm211h1#31;
   #dsm211la#30 = #dsm211h1#32;
   #dsm211la#31 = #dsm211h1#33;
   #dsm211la#32 = #dsm211h1#34;
   #dsm211la#33 = #dsm211h1#35;
   #dsm211la#34 = #dsm211h1#36;
   #dsm211la#35 = #dsm211h1#37;
   #dsm211la#36 = #dsm211h1#38;
   #dsm211la#37 = #dsm211h1#39;
   |GRABA 020#dsm211la.n;
|FPRC;

|DEFBUCLE Graba211la;
    #dsm211h1#1;
    ;
    #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, aAlfa1;
    #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, aAlfa2;
    ;
    NULL, Graba211la;
|FIN;

|PROCESO EnviarEntr211;
   |ABRE #dsm211ca; |ABRE #dsm211la; |ABRE #dsm211tr;
   #dsm211ca#0  = #dsm211hi#0;
   #dsm211ca#1  = #dsm211hi#3;
   |LEE 101#dsm211ca.=;
   |SI FSalida = 0;
      aAlfa = "    NEl contribuyente seleccionado ya tiene datos en la administración indicada. " + &191 + " Reescribir los datos ? ";
      |CONFI aAlfa;
      |SI FSalida = 0;
         |HAZ EliminaRegistro211;
         |BORRA 020#dsm211ca.a; |LIBERA #dsm211ca;
      |SINO;
         |CIERRA #dsm211ca; |CIERRA #dsm211la; |CIERRA #dsm211tr;
         |ACABA;
      |FINSI;
   |FINSI;

   |DDEFECTO #dsm211ca;
   #dsm211ca#0  = #dsm211hi#0;
   #dsm211ca#1  = #dsm211hi#3;
   #dsm211ca#2  = #dsm211hi#4;
   #dsm211ca#3  = #dsm211hi#5;
   #dsm211ca#4  = #dsm211hi#6;
   #dsm211ca#5  = #dsm211hi#7;
   #dsm211ca#6  = #dsm211hi#8;
   #dsm211ca#7  = #dsm211hi#9;
   #dsm211ca#8  = #dsm211hi#10;
   #dsm211ca#9  = #dsm211hi#11;
   #dsm211ca#10 = #dsm211hi#12;
   #dsm211ca#11 = #dsm211hi#13;
   #dsm211ca#12 = #dsm211hi#14;
   #dsm211ca#13 = #dsm211hi#15;
   #dsm211ca#14 = #dsm211hi#16;
   #dsm211ca#15 = #dsm211hi#17;
   #dsm211ca#16 = #dsm211hi#18;
   #dsm211ca#17 = #dsm211hi#19;
   #dsm211ca#18 = #dsm211hi#20;
   #dsm211ca#19 = #dsm211hi#21;
   #dsm211ca#20 = #dsm211hi#22;
   #dsm211ca#21 = #dsm211hi#23;
   #dsm211ca#22 = #dsm211hi#24;
   #dsm211ca#23 = #dsm211hi#25;
   #dsm211ca#24 = #dsm211hi#26;
   #dsm211ca#25 = #dsm211hi#27;
   #dsm211ca#26 = #dsm211hi#28;
   #dsm211ca#27 = #dsm211hi#29;
   #dsm211ca#28 = #dsm211hi#30;
   #dsm211ca#29 = #dsm211hi#31;
   #dsm211ca#30 = #dsm211hi#32;
   #dsm211ca#31 = #dsm211hi#33;
   #dsm211ca#32 = #dsm211hi#34;
   #dsm211ca#33 = #dsm211hi#35;
   #dsm211ca#34 = #dsm211hi#36;
   #dsm211ca#35 = #dsm211hi#37;
   #dsm211ca#36 = #dsm211hi#38;
   #dsm211ca#37 = #dsm211hi#39;
   #dsm211ca#38 = #dsm211hi#40;
   #dsm211ca#39 = #dsm211hi#41;
   #dsm211ca#40 = #dsm211hi#42;
   #dsm211ca#41 = #dsm211hi#43;
   #dsm211ca#42 = #dsm211hi#44;
   #dsm211ca#43 = #dsm211hi#45;
   #dsm211ca#44 = #dsm211hi#46;
   #dsm211ca#45 = #dsm211hi#47;
   #dsm211ca#46 = #dsm211hi#48;
   #dsm211ca#47 = #dsm211hi#49;
   #dsm211ca#48 = #dsm211hi#50;
   #dsm211ca#49 = #dsm211hi#51;
   #dsm211ca#50 = #dsm211hi#52;
   #dsm211ca#51 = #dsm211hi#53;
   #dsm211ca#52 = #dsm211hi#54;
   #dsm211ca#53 = #dsm211hi#55;
   #dsm211ca#54 = #dsm211hi#56;
   #dsm211ca#55 = #dsm211hi#57;
   #dsm211ca#56 = #dsm211hi#58;
   #dsm211ca#57 = #dsm211hi#59;
   #dsm211ca#58 = #dsm211hi#60;
   #dsm211ca#59 = #dsm211hi#61;
   #dsm211ca#60 = #dsm211hi#62;
   #dsm211ca#61 = #dsm211hi#63;
   #dsm211ca#62 = #dsm211hi#64;
   #dsm211ca#63 = #dsm211hi#65;
   #dsm211ca#64 = #dsm211hi#66;
   #dsm211ca#65 = #dsm211hi#67;
   #dsm211ca#66 = #dsm211hi#68;
   #dsm211ca#67 = #dsm211hi#69;
   #dsm211ca#68 = #dsm211hi#70;
   |GRABA 020#dsm211ca.c;

   aAlfa1 = " " * 15; aAlfa2 = "z" * 15;
   |BUCLE Graba211la;
   |BUCLE Graba211tr;

   |CIERRA #dsm211ca; |CIERRA #dsm211la; |CIERRA #dsm211tr;
   |MENAV "    Emision replicada en la entrada de datos";
|FPRC;

|PROCESO Borra211h2;
   |BORRA 020#dsm211h2.a; |LIBERA #dsm211h2;
|FPRC;

|DEFBUCLE Borra211h2;
   #dsm211h1#1;
   ;
   #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, "               ";
   #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, "zzzzzzzzzzzzzzz";
   be;
   NULL, Borra211h2;
|FIN;

|PROCESO Borra211h1;
   |BORRA 020#dsm211h1.a; |LIBERA #dsm211h1;
|FPRC;

|DEFBUCLE Borra211h1;
   #dsm211h1#1;
   ;
   #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, "               ";
   #dsm211hi#0, #dsm211hi#1, #dsm211hi#2, #dsm211hi#3, "zzzzzzzzzzzzzzz";
   be;
   NULL, Borra211h1;
|FIN;

|PROCESO BorrarEm211;
   aAlfa = "    N" + &191 + " Esta seguro de eliminar la emisión seleccionada ?";
   |CONFI aAlfa;
   |SI FSalida = 0;
      |BUCLE Borra211h1; |BUCLE Borra211h2;
      |BORRA 020#dsm211hi.a;

      |REFRESCACONTROL nGrid1;
   |FINSI;
|FPRC;

|PROCESO EvtoHist211;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm211hi.c;
      |SI #dsm211hi#0 ! #dsm210dp#0; |DDEFECTO #dsm211hi; |FINSI;

      #dsmow340#1 = #dsm213hi#10; |PINTA #dsmow340#1;
      #dsmow340#2 = #dsm213hi#11; |PINTA #dsmow340#2;
      #dsmow340#3 = #dsm213hi#12; |PINTA #dsmow340#3;
      #dsmow340#4 = #dsm213hi#13; |PINTA #dsmow340#4;
      #dsmow340#5 = #dsm213hi#14; |PINTA #dsmow340#5;
      #dsmow340#6 = #dsm213hi#15; |PINTA #dsmow340#6;
      #dsmow340#7 = #dsm213hi#16; |PINTA #dsmow340#7;

      #dsmow340#0  = #dsm211hi#4;  |PINTA #dsmow340#0;
      #dsmow340#1  = #dsm211hi#58; |PINTA #dsmow340#1;
      |SI #dsm211hi#46 = "P";
         #dsmow340#2  = "S"; |PINTA #dsmow340#2;
         #dsmow340#20 = "N"; |PINTA #dsmow340#20;
      |FINSI;
      |SI #dsm211hi#46 = "R";
         #dsmow340#2  = "N"; |PINTA #dsmow340#2;
         #dsmow340#20 = "S"; |PINTA #dsmow340#20;
      |FINSI;
      #dsmow340#3  = #dsm211hi#47; |PINTA #dsmow340#3;
      #dsmow340#4  = #dsm211hi#48; |PINTA #dsmow340#4;
      #dsmow340#5  = #dsm211hi#49; |PINTA #dsmow340#5;
      #dsmow340#6  = #dsm211hi#50; |PINTA #dsmow340#6;
      #dsmow340#7  = #dsm211hi#51; |PINTA #dsmow340#7;
      #dsmow340#8  = #dsm211hi#52; |PINTA #dsmow340#8;
      #dsmow340#9  = #dsm211hi#53; |PINTA #dsmow340#9;
      #dsmow340#10 = #dsm211hi#54; |PINTA #dsmow340#10;
      #dsmow340#11 = #dsm211hi#55; |PINTA #dsmow340#11;
      #dsmow340#12 = #dsm211hi#62; |PINTA #dsmow340#12;
      #dsmow340#13 = #dsm211hi#63; |PINTA #dsmow340#13;
      #dsmow340#14 = #dsm211hi#64; |PINTA #dsmow340#14;
      #dsmow340#15 = #dsm211hi#65; |PINTA #dsmow340#15;
      #dsmow340#16 = #dsm211hi#66; |PINTA #dsmow340#16;
      #dsmow340#17 = #dsm211hi#67; |PINTA #dsmow340#17;
      #dsmow340#18 = #dsm211hi#68; |PINTA #dsmow340#18;
      #dsmow340#19 = #dsm211hi#69; |PINTA #dsmow340#19;
      #dsmow340#21 = #dsm211hi#5;  |PINTA #dsmow340#21;

      |REFRESCACONTROL nGrid1a; |REFRESCACONTROL nGrid1b;
   |FINSI;
|FPRC;

|PROCESO EvtoHAdq211;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm211h1.c;
   |FINSI;
|FPRC;

|PROCESO EvtoHTrm211;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsm211h2.c;
   |FINSI;
|FPRC;

|PROCESO InfHAdq211;
   #dsm211h1#0 = #dsm211hi#0;
   #dsm211h1#1 = #dsm211hi#1;
   #dsm211h1#2 = #dsm211hi#2;
   #dsm211h1#3 = #dsm211hi#3;
   #dsm211h1#4 = "";
|FPRC;

|PROCESO SupHAdq211;
   #dsm211h1#0 = #dsm211hi#0;
   #dsm211h1#1 = #dsm211hi#1;
   #dsm211h1#2 = #dsm211hi#2;
   #dsm211h1#3 = #dsm211hi#3;
   #dsm211h1#4 = "zzzzzzzzzzzzzzz";
|FPRC;

|PROCESO InfHTrm211;
   #dsm211h2#0 = #dsm211hi#0;
   #dsm211h2#1 = #dsm211hi#1;
   #dsm211h2#2 = #dsm211hi#2;
   #dsm211h2#3 = #dsm211hi#3;
   #dsm211h2#4 = "";
|FPRC;

|PROCESO SupHTrm211;
   #dsm211h2#0 = #dsm211hi#0;
   #dsm211h2#1 = #dsm211hi#1;
   #dsm211h2#2 = #dsm211hi#2;
   #dsm211h2#3 = #dsm211hi#3;
   #dsm211h2#4 = "zzzzzzzzzzzzzzz";
|FPRC;

|PROCESO InfHist211;
   #dsm211hi#0 = #dsm210dp#0;
   #dsm211hi#1 = 0000;
   #dsm211hi#2 = 0;
   #dsm211hi#3 = 000;
|FPRC;

|PROCESO SupHist211;
   #dsm211hi#0 = #dsm210dp#0;
   #dsm211hi#1 = 9999;
   #dsm211hi#2 = 0;
   #dsm211hi#3 = 999;
|FPRC;

|PROCESO Historico211;
   |ABRE #dsm211hi; |ABRE #dsm211h1; |ABRE #dsm211h2;

   aAlfa = "Mod.211 : Historico emisiones [" + #dsm210dp#2; |QBF aAlfa;
   aAlfa = aAlfa + "] " + #dsm210dp#1;
   |VENTANA 0501, 3299, 1, 17, aAlfa; nVent0 = FSalida;
   aVent1 = -1; aVent2 = -1; aVent3 = 0;
   aVent4 = nVent0;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |PINPA #0#dsmow340; nPant0 = FSalida;
   |PINDA #0#dsmow340;

   nPos1 = 3278; nPos2 = 3298;
   |CONTROL_SIMPLE nPant0, "BOTON,{{197}}Enviar a entrada datos", nPos1, nPos2, EnviarEntr211;
   nBoton1 = FSalida;

   nPos1 = 3262; nPos2 = 3276;
   |CONTROL_SIMPLE nPant0, "BOTON,{{199}}Borrar emision", nPos1, nPos2, BorrarEm211;
   nBoton2 = FSalida;

   |DDEFECTO #dsmow340;
   |PARA nContCmp = 0; |SI nContCmp [ 21; |HACIENDO nContCmp = nContCmp + 1;
      |PINTA #dsmow340#nContCmp#;
   |SIGUE;

   nRango = 4 + 8 + 16 + 32;
   nPos1 = 0602; nPos2 = 1298;
   |LINEAL_SIMPLE #1#dsm211hi, nRango, nPos1, nPos2, InfHist211, SupHist211, EvtoHist211;
   nGrid1 = FSalida;
   |SI #dsm211hi#0 ! #dsm210dp#0; |DDEFECTO #dsm211hi; |FINSI;

   nPos1 = 1402; nPos2 = 2049;
   |LINEAL_SIMPLE #1#dsm211h1, nRango, nPos1, nPos2, InfHAdq211, SupHAdq211, EvtoHAdq211;
   nGrid1a = FSalida;

   nPos1 = 1451; nPos2 = 2098;
   |LINEAL_SIMPLE #1#dsm211h2, nRango, nPos1, nPos2, InfHTrm211, SupHTrm211, EvtoHTrm211;
   nGrid1b = FSalida;
   |PULSATECLA;

   aEsc1  = &255 + "806";
   aEsc2  = &255 + "807";
   aRetu  = &255 + "802";
   |PARA; |SI;  |HACIENDO;
      FSalida = "::{{001}}Salir," + nGrid1;
      |LEETECLA aTecla1;
      |SI aTecla1 = aEsc1; |SAL; |FINSI;
      |SI aTecla1 = aEsc2; |SAL; |FINSI;
      |SI aTecla1 = aRetu; |SAL; |FINSI;
   |SIGUE;

   |DESTRUYECONTROL nGrid1;
   |DESTRUYECONTROL nGrid1a;
   |DESTRUYECONTROL nGrid1b;
   |FIN_CONTROL_WINDOWS nBoton1;
   |FIN_CONTROL_WINDOWS nBoton2;

   aVent4 = nVent0;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent0;

   |CIERRA #dsm213hi; |CIERRA #dsm213h1; |CIERRA #dsm213h2;
|FPRC;

/****************************************************************************
*****                          PROCESOS VARIOS                          *****
****************************************************************************/
|PROCESO PonSiglo20;
     aAlfa1 = #Fichero@#Campo#;
     aAlfa1 = (aAlfa1 % 106) + "19" + (aAlfa1 % -102);
     #Fichero@#Campo# = aAlfa1;
     |PINTA #Fichero@#Campo#;
|FPRC;

|PROCESO CumpleAnyos;
     aAlfa1 = fHoy;             aAlfa1 = aAlfa1 % -104; nAny1 = aAlfa1;
     aAlfa1 = #Fichero@#Campo#; aAlfa1 = aAlfa1 % -104; nAny2 = aAlfa1;
     nEdad  = nAny1 - nAny2;

     |SI nEdad ! 18; |ACABA; |FINSI;

     aAlfa1 = fHoy;             aAlfa1 = aAlfa1 % 402; nMes1 = aAlfa1;
     aAlfa1 = #Fichero@#Campo#; aAlfa1 = aAlfa1 % 402; nMes2 = aAlfa1;

     |SI nMes2 > nMes1;  nEdad = nEdad - 1; |FINSI;
     |SI nMes1 ! nMes2;  |ACABA;            |FINSI;

     aAlfa1 = fHoy;             aAlfa1 = aAlfa1 % 102; nDia1 = aAlfa1;
     aAlfa1 = #Fichero@#Campo#; aAlfa1 = aAlfa1 % 102; nDia2 = aAlfa1;

     |SI nDia2 > nDia1;  nEdad = nEdad - 1; |FINSI;
|FPRC;

|PROCESO ValFechaNacim;
     |SI #Fichero@#Campo# [ "01.01.0000";  |ACABA;  |FINSI;

     fHoy = ~;

     |SI #Fichero@#Campo# > fHoy;    || nacimientos futuros como que no
          |HAZ PonSiglo20;    ||/se cambia sin preguntar
     |FINSI;

     |SI #Fichero@#Campo# ] "01.01.2000"; |Y #Fichero@#Campo# [ fHoy;     || presuntos ni¤os,
                                                            ||/se pregunta
         |HAZ CumpleAnyos;
         |SI nEdad < 18;
             aAlfa = "0000SLa fecha puede ser incorrecta. Ha introducido un contribuyente menor de edad. Corregir fecha?";
             |CONFI aAlfa;
             |SI FSalida = 0;
                 |ERROR;
                 || |HAZ PonSiglo20;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO DatosPersRenta;
   #rem00100@#1 = #dsm210dp#1;
   #rem00100@#5 = #dsm210dp#2;
   aAlfa = #dsm210dp#4; |QBF aAlfa;
   aAlfa = aAlfa % -104;
   #rem00100@#7 = aAlfa;
   #rem00100@#10  = "N";
   #rem00100@#12  = #dsm210dp#25;
   #rem00100@#13  = #dsm210dp#24;
   #rem00100@#14  = #dsm210dp#8;
   #rem00100@#15  = #dsm210dp#9;
   #rem00100@#114 = #dsm210dp#10;
   #rem00100@#103 = #dsm210dp#4;
   #rem00100@#16  = #dsm210dp#11;
   #rem00100@#115 = #dsm210dp#12;
   #rem00100@#116 = #dsm210dp#13;
   #rem00100@#117 = #dsm210dp#14;
   #rem00100@#17  = #dsm210dp#15;
   #rem00100@#18  = #dsm210dp#16;
   #rem00100@#19  = #dsm210dp#17;
   #rem00100@#118 = #dsm210dp#18;
   #rem00100@#119 = #dsm210dp#19;
   #rem00100@#20  = #dsm210dp#20;
   #rem00100@#21  = #dsm210dp#21;
   #rem00100@#22  = #dsm210dp#22;
   aAlfa = (("00" + #dsm210dp#20) % -102) + (("000" + #dsm210dp#21) % -103);
   #rem00100@#23  = aAlfa;
   #rem00100@#24  = #dsm210dp#8;
   #rem00100@#25  = #dsm210dp#9;
   #rem00100@#26  = #dsm210dp#11;
   #rem00100@#27  = #dsm210dp#15;
   #rem00100@#28  = #dsm210dp#16;
   #rem00100@#29  = #dsm210dp#17;
   #rem00100@#30  = #dsm210dp#20;
   #rem00100@#31  = #dsm210dp#21;
   #rem00100@#32  = #dsm210dp#22;
   aAlfa = (("00" + #dsm210dp#20) % -102) + (("000" + #dsm210dp#21) % -103);
   #rem00100@#33  = aAlfa;
   #rem00100@#66  = #dsm210dp#39;
   #rem00100@#67  = #dsm210dp#37;
   #rem00100@#68  = #dsm210dp#58;
   #rem00100@#77  = #dsm210dp#33;
   #rem00100@#120 = #dsm210dp#27;
   #rem00100@#121 = #dsm210dp#28;
   #rem00100@#122 = #dsm210dp#29;
   #rem00100@#123 = #dsm210dp#30;
   #rem00100@#124 = #dsm210dp#31;
   #rem00100@#125 = #dsm210dp#32;
   #rem00100@#126 = #dsm210dp#33;

   nPaseHecho  = 1;
|FPRC;

|PROCESO DatosInmuebles;
   #rem00021@#2  = "TITULAR";
   #rem00021@#3  = "X";
   aAlfa = #dsminmex#3;          |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + " "; |FINSI;
   aAlfa = aAlfa + #dsminmex#4;  |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
   aAlfa = aAlfa + #dsminmex#5;  |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + " "; |FINSI;
   aAlfa = aAlfa + #dsminmex#6;  |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + " "; |FINSI;
   aAlfa = aAlfa + #dsminmex#7;  |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
   aAlfa = aAlfa + #dsminmex#8;  |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
   aAlfa = aAlfa + #dsminmex#9;  |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
   aAlfa = aAlfa + #dsminmex#10; |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
   aAlfa = aAlfa + #dsminmex#11; |QBF aAlfa; |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
   aAlfa = aAlfa + #dsminmex#12; |QBF aAlfa;
   #rem00021@#13 = aAlfa;
   #rem00021@#14 = #dsminmex#2;
   aAlfa = #dsminmex#2; |QBF aAlfa;
   |SI aAlfa = "";
      #rem00021@#125 = 1;
   |SINO;
      #rem00021@#125 = 3;
   |FINSI;
   #rem00021@#104 = "P";
   #rem00021@#105 = #dsminmex#15;
   #rem00021@#106 = #dsminmex#16;
   #rem00021@#17  = #dsmivcex#4;
   #rem00021@#25  = #dsminmex#24;
   #rem00021@#26  = #dsminmex#25;
   #rem00021@#15  = #dsmivcex#3;

   fFecha0 = #dsminmex#24; nCalc1 = fFecha0;
   aAlfa = "31.12." + #dsmow341#0;
   fFecha2 = aAlfa; nCalc2 = fFecha2;
   nCalc1 = nCalc2 - nCalc1;
   |SI nCalc1 > 365; nCalc1 = 365; |FINSI;

   #rem00021@#32  = nCalc1;
   #rem00021@#128 = "D";
   #rem00021@#136 = 100;
   #rem00021@#141 = 2;
   #rem00021@#143 = "0,0,0;255,80,80";

   nPaseHecho  = 1;
|FPRC;

|PROCESO InmueblesRenta;
   nActualAnt = nActualiza;

   #dsmivcex#0 = #dsminmex#0;
   #dsmivcex#1 = #dsminmex#1;
   #dsmivcex#2 = #dsmow341#0;
   |LEE 000#dsmivcex.=;
   |SI FSalida ! 0; |DDEFECTO #dsmivcex; |FINSI;
   |SI #dsmivcex#4 = " "; #dsmivcex#4 = #dsminmex#28; |FINSI;

   aAlfa = #dsminmex#2; |QBF aAlfa;
   |SI aAlfa ! "";
      |SELECT #3#rem00021@;
      #rem00021@#0  = #dsminmex#0;
      #rem00021@#14 = #dsminmex#2;
      |LEE 000#rem00021@.=;
      |SI FSalida ! 0; |DDEFECTO #rem00021@; |FINSI;
      |SELECT #1#rem00021@;

      |LEE 000#rem00021@.=;
      |SI FSalida ! 0;
         |DDEFECTO #rem00021@;
         #rem00021@#0  = #dsminmex#0;
         #rem00021@#1 = nLinea; nLinea = nLinea + 1;
         |GRABA 020#rem00021@.b;
         nActualiza = 1;
      |FINSI;
   |SINO;
      |DDEFECTO #rem00021@;
      #rem00021@#0  = #dsminmex#0;
      #rem00021@#1 = nLinea; nLinea = nLinea + 1;
      |GRABA 020#rem00021@.b;

      nActualiza = 1;
   |FINSI;

   |SI nActualiza = 1;
      |HAZ DatosInmuebles;

      |GRABA 020#rem00021@.a; |LIBERA #rem00021@;
   |FINSI;

   nActualiza = nActualAnt;
|FPRC;

|DEFBUCLE InmueblesRenta;
    #dsminmex#1;
    ;
    #dsm210dp#0, 000;
    #dsm210dp#0, 999;
    ;
    NULL, InmueblesRenta;
|FIN;

|PROCESO PaseRenta
   |VENTANA 1735, 2064, -1, 17, "Pase de datos a renta/patrimonio"; nVent1 = FSalida;
   aVent1 = -1;
   aVent2 = -1;
   aVent3 = 0;
   aVent4 = nVent1;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |PINPA #0#dsmow341; |PINDA #0#dsmow341;
   |ENDATOS #1#dsmow341;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "ren" + #dsmow341#0 + "/def/reacceso.mas";
      |CARGA_DEF aAlfa, reacceso@;
      |SI FSalida = 0;
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "ren" + #dsmow341#0 + "/def/rem00100.mas";
         |CARGA_DEF aAlfa, rem00100@;

         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "ren" + #dsmow341#0 + "/def/rem00021.mas";
         |CARGA_DEF aAlfa, rem00021@;

         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "ren" + #dsmow341#0 + "/fich/";
         |PATH_DAT #reacceso@#aAlfa#; |PATH_DAT #rem00100@#aAlfa#;
         |PATH_DAT #rem00021@#aAlfa#;

         |ABRE #dsmivcex;

         nActualiza = 0; nPaseHecho = 0;
         |ABRE #rem00021@; |ABRE #rem00100@;
         |ABRE #reacceso@;
         #reacceso@#0 = #dsm210dp#0;
         |LEE 101#reacceso@.=;
         |SI FSalida ! 0;
            |DDEFECTO #reacceso@;
            #reacceso@#0 = #dsm210dp#0;
            |GRABA 020#reacceso@.b;

            #reacceso@#1 = #dsm210dp#1;
            #reacceso@#2 = #dsm210dp#2;
            |GRABA 020#reacceso@.a; |LIBERA #reacceso@;

            |DDEFECTO #rem00100@;
            #rem00100@#0 = #dsm210dp#0;
            |GRABA 020#rem00100@.b;

            |HAZ DatosPersRenta;
            nActualiza = 1;
            nLinea = 1; |BUCLE InmueblesRenta;

            |GRABA 020#rem00100@.a; |LIBERA #rem00100@;
         |SINO;
            aAlfa = "    NEl codigo de contribuyente ya se está usando. " + &191 + " Actualizar datos ?";
            |CONFI aAlfa;
            |SI FSalida = 0;
               #reacceso@#1 = #dsm210dp#1;
               #reacceso@#2 = #dsm210dp#2;
               |GRABA 020#reacceso@.a;

               #rem00100@#0 = #dsm210dp#0;
               |LEE 101#rem00100@.=;
               |SI FSalida = 0;
                  |HAZ DatosPersRenta;
                  |GRABA 020#rem00100@.a; |LIBERA #rem00100@;
                  nActualiza = 1;
               |FINSI;
            |FINSI;
            |LIBERA #reacceso@;
         |FINSI;

         #rem00021@#0 = #dsm210dp#0;
         #rem00021@#1 = 99;
         |LEE 000#rem00021@.];
         |SI FSalida = 0;
            |LEE 000#rem00021@.a;
         |SINO;
            |LEE 000#rem00021@.u;
         |FINSI;
         |SI FSalida = 0; |Y #rem00021@#0 = #dsm210dp#0;
            nLinea = #rem00021@#1 + 1;
         |SINO;
            nLinea = 1;
         |FINSI;
         |BUCLE InmueblesRenta;

         |CIERRA #dsmivcex;
         |CIERRA #rem00021@; |DESCARGA_DEF #rem00021@;
         |CIERRA #rem00100@; |DESCARGA_DEF #rem00100@;
         |CIERRA #reacceso@; |DESCARGA_DEF #reacceso@;

         |SI nPaseHecho = 1;
            |MENAV "    Pase ejecutado correctamente";
         |SINO;
            |MENAV "    Pase ejecutado sin cambios";
         |FINSI;
      |SINO;
         |MENAV "    Proceso cancelado";
      |FINSI;
   |SINO;
      |MENAV "    Proceso cancelado";
   |FINSI;

   aVent4 = nVent1;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent1;
|FPRC;

|PROCESO EvtoSel;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsmow344.=;
   |FINSI;

   |SI FSalida = 4;
      |PTEC 802;
   |FINSI;
|FPRC;

|PROCESO SelecTipo;
   |VENTANA 1423, 2278, -1, 17, "Pase de datos a renta/patrimonio"; nVent1 = FSalida;
   aVent1 = -1;
   aVent2 = -1;
   aVent3 = 0;
   aVent4 = nVent1;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   aAlfa = #dsm210dp#65; |QBF aAlfa;
   |SI aAlfa ! "";
      #dsmow345#2 = "G";
      eaConyuge = "S";
   |SINO;
      #dsmow345#2 = "T";
      eaConyuge = "N";
   |FINSI;

   |SI enPorc1 ! 0; |O enPorc2 ! 0;
      #dsmow345#2 = "V";
      |SI enPorc1 = "100"; #dsmow345#2 = "T"; |FINSI;
      |SI enPorc2 = "100"; #dsmow345#2 = "C"; |FINSI;
      |SI enPorc1 = "50"; |Y enPorc2 = "50"; #dsmow345#2 = "G"; |FINSI;
      |SI #dsmow345#2 = "V";
         #dsmow345#0 = enPorc1; |PINTA #dsmow345#0;
         #dsmow345#1 = enPorc2; |PINTA #dsmow345#1;
      |FINSI;
   |FINSI;

   |PINPA #0#dsmow345; nPant1 = FSalida;
   |PINDA #0#dsmow345;

|ET EligeDeNuevo;
   |ENDATOS #1#dsmow345;
   |SI FSalida = 0;
      |SI #dsmow345#2 = "G"; enPorc1 = 50;  enPorc2 = 50;  |FINSI;
      |SI #dsmow345#2 = "T"; enPorc1 = 100; enPorc2 = 0;   |FINSI;
      |SI #dsmow345#2 = "C"; enPorc1 = 0;   enPorc2 = 100; |FINSI;
      |SI #dsmow345#2 = "V"; enPorc1 = #dsmow345#0; enPorc2 = #dsmow345#1; |FINSI;
   |SINO;
      |VETE EligeDeNuevo;
   |FINSI;

   |DESTRUYECONTROL nGridSel;
   |CIERRA #dsmow344;   |DELINDEX #dsmow344;

   aVent4 = nVent1;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent1;
|FPRC;

|PROCESO CargaDatos;
   |SI #dsminmex#29 > "01.01.0000";  || la fecha de venta es anterior
      |SI #dsminmex#29 < fFecha0; |ACABA; |FINSI;
   |FINSI;
   |SI #dsminmex#24 > "01.01.0000";  || la compra es posterior
      |SI #dsminmex#24 > fFecha2; |ACABA; |FINSI;
   |FINSI;
   |SI #dsmow352#6 ! 0;
       |SI #dsmow352#6 ! #dsminmex#15; |ACABA; |FINSI;
       |SI #dsmow352#7 ! 0;
           |SI #dsmow352#7 ! #dsminmex#16; |ACABA; |FINSI;
       |FINSI;
   |FINSI;

   #dsm210dp#0 = #dsminmex#0;
   |LEE 000#dsm210dp.=;
   |SI FSalida ! 0; |ACABA; |FINSI;

   nSwAny = 0;
   #dsmivcex#0 = #dsminmex#0;  || lee el a¤o actual
   #dsmivcex#1 = #dsminmex#1;
   #dsmivcex#2 = #dsmow352#0;
   |LEE 000#dsmivcex.=;
   |SI FSalida ! 0;
       |DDEFECTO #dsmivcex;
       nSwAny = 1;
   |FINSI;
   |SI #dsmivcex#4 = " "; #dsmivcex#4 = #dsminmex#28; |FINSI;

   #dsmow390#0 = #dsminmex#0;
   |LEE 000#dsmow390.=;
   |SI FSalida ! 0;
      |DDEFECTO #dsmow390;
      #dsmow390#0 = #dsm210dp#0;
      #dsmow390#1 = #dsm210dp#1;
      #dsmow390#2 = #dsm210dp#2;
      |GRABA 020#dsmow390.n;
   |FINSI;

   |DDEFECTO #dsmow391;
   #dsmow391#0 = #dsminmex#0;
   #dsmow391#1 = #dsminmex#1;
   #dsmow391#2 = #dsminmex#22;
   #dsmow391#3 = #dsminmex#2;
   #dsmow391#4 = #dsmivcex#3;
   #dsmow391#5 = #dsmivcex#4;

   |SI #dsmow352#1 = "A";
       |SI nSwAny = 1; |O #dsmow352#3 = "S";
           #dsmow391#5 = #dsmow352#8;
       |FINSI;
       #dsmivcex#0 = #dsminmex#0;
       #dsmivcex#1 = #dsminmex#1;
       #dsmivcex#2 = #dsmow352#0 - 1;
       |LEE 000#dsmivcex.=;
       |SI FSalida = 0;
           |SI #dsmow352#3 = "S"; |O nSwAny = 1;
               #dsmow391#4 = #dsmivcex#3 > #dsmow352#2;
           |FINSI;
      |FINSI;
   |FINSI;
   |GRABA 020#dsmow391.n:

   nSwHayDatos = 1;
|FPRC;

|DEFBUCLE CargaDatos;
   #dsminmex#1;
   ;
   #dsmow352#4, 000;
   #dsmow352#5, 999;
   ;
   NULL, CargaDatos;
|FIN;

|PROCESO EvtoGridL1;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsmow390.c;

      |REFRESCACONTROL nGridL2;
   |FINSI;
|FPRC;

|PROCESO Infw391;
   #dsmow391#0 = #dsmow390#0;
   #dsmow391#1 = 001;
|FPRC;

|PROCESO Supw391;
   #dsmow391#0 = #dsmow390#0;
   #dsmow391#1 = 999;
|FPRC;

|PROCESO EvtoGridL2;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#dsmow391.c;
   |FINSI;
   |SI FSalida = 4;
      |ENCAMPO #4#dsmow391;
      |SI FSalida = 0;
          |ENCAMPO #5#dsmow391;
          |SI FSalida = 0;
              |GRABA 020#dsmow391.a;
          |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO VuelcaDatos;
   #dsmivcex#0 = #dsmow391#0;
   #dsmivcex#1 = #dsmow391#1;
   #dsmivcex#2 = #dsmow352#0;
   |LEE 101#dsmivcex.=;
   |SI FSalida ! 0;
      |DDEFECTO #dsmivcex;
      #dsmivcex#0 = #dsmow391#0;
      #dsmivcex#1 = #dsmow391#1;
      #dsmivcex#2 = #dsmow352#0;
      |GRABA 020#dsmivcex.b;
   |FINSI;
   #dsmivcex#3 = #dsmow391#4;
   #dsmivcex#4 = #dsmow391#5;
   |GRABA 020#dsmivcex.a;
   |LIBERA #dsmivcex;

   #dsmivcex#0 = #dsmow391#0;
   #dsmivcex#1 = #dsmow391#1;
   #dsmivcex#2 = #dsmow352#0 + 1;
   |LEE 041#dsmivcex.];
   |SI FSalida ! 0; |O #dsmivcex#0 ! #dsmow391#0; |O #dsmivcex#1 ! #dsmow391#1;
       #dsminmex#0 = #dsmow391#0;
       #dsminmex#1 = #dsmow391#1;
       |LEE 101#dsminmex.=;
       |SI FSalida = 0;
          #dsminmex#28 = #dsmow391#5;
          |GRABA 020#dsminmex.a;
       |FINSI;
       |LIBERA #dsminmex;
   |FINSI;
|FPRC;

|DEFBUCLE VuelcaDatos;
   #dsmow391#1;
   ;
   INICIO;
   FINAL;
   ;
   NULL, VuelcaDatos;
|FIN;

|PROCESO CargaValoresCatastrales;
   |VENTANA 0703, 2899, -1, 17, "Introducción masiva de valores catastrales por a¤o"; nVent1 = FSalida;
   aVent1 = -1;
   aVent2 = -1;
   aVent3 = 0;
   aVent4 = nVent1;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |ABRE #dsm210dp; |ABRE #dsmivcex;

   |PINPA #0#dsmow352; nPant1 = FSalida;
   |PINDA #0#dsmow352;

   aAlfa = "cvc" + Usuario; |NOME_DAT #dsmow390#aAlfa#;
   aAlfa = "cvl" + Usuario; |NOME_DAT #dsmow391#aAlfa#;
   |ABRE #dsmow390; |ABRE #dsmow391;

   nPos1 = 1802; nPos2 = 1889;
   |CONTROL_SIMPLE nPant1, "LABEL,{{6}}Doble click para editar el valor catastral", nPos1, nPos2, NULL;
   nLabel1 = FSalida;

   nRango = 4 + 8 + 16 + 32;
   nPos1 = 1902; nPos2 = 2594;
   |LINEAL_SIMPLE #1#dsmow391, nRango, nPos1, nPos2, Infw391, Supw391, EvtoGridL2;
   nGridL2 = FSalida;

   nPos1 = 0902; nPos2 = 1794;
   |LINEAL_SIMPLE #1#dsmow390, nRango, nPos1, nPos2, NULL, NULL, EvtoGridL1;
   nGridL1 = FSalida;

   |ENDATOS #1#dsmow352;
   |SI FSalida = 0;
      aAlfa = "01.01." + #dsmow352#0; fFecha0 = aAlfa;
      aAlfa = "31.12." + #dsmow352#0; fFecha2 = aAlfa;
      nSwHayDatos = 0; |BUCLE CargaDatos;

      |SI nSwHayDatos = 1;
         |REFRESCACONTROL nGridL1;

         aEsc1  = &255 + "806";
         aEsc2  = &255 + "807";
         aRetu  = &255 + "802";
         |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGridL1;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL; |FINSI;
            |SI aTecla = aEsc2; |SAL; |FINSI;
            |SI aTecla = aRetu; |SAL; |FINSI;
         |SIGUE;

         aAlfa = "    N" + &191 + " Conforme con validar los cambios ?";
         |CONFI aAlfa;
         |SI FSalida = 0;
             |ABRE #dsminmex;
             |BUCLE VuelcaDatos;
             |CIERRA #dsminmex;
         |FINSI;
      |SINO;
         |MENAV "    Seleccion vacia";
      |FINSI;
   |FINSI;

   |DESTRUYECONTROL nGridL1; |DESTRUYECONTROL nGridL2;
   |FIN_CONTROL_WINDOWS nLabel1;
   |FIN_CONTROL_WINDOWS nBotonValida; |FIN_CONTROL_WINDOWS nBotonCancela;
   |FIN_CONTROL_WINDOWS nLabel1;

   |CIERRA #dsm210dp; |CIERRA #dsmivcex;
   |CIERRA #dsmow390; |DELINDEX #dsmow390;
   |CIERRA #dsmow391; |DELINDEX #dsmow391;

   aVent4 = nVent1;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;
   |FINVENTANA nVent1;
|FPRC;

|PROCESO BorraValorCat;
   |BORRA 020#dsmivcex.a;
   |LIBERA #dsmivcex;
|FPRC;

|DEFBUCLE BorraValorCat;
   #dsmivcex#1;
   ;
   #dsminmex#0, #dsminmex#1, 0000;
   #dsminmex#0, #dsminmex#1, 9999;
   be;
   NULL, BorraValorCat;
|FIN;

|PROCESO BorraInmContr;
   |BUCLE BorraValorCat;

   |BORRA 020#dsminmex.a;
|FPRC;

|DEFBUCLE BorraInmContr;
    #dsminmex#1;
    ;
    #dsm210dp#0, 000;
    #dsm210dp#0, 999;
    be;
    NULL, BorraInmContr;
|FIN;

|PROCESO BorraL1His213;
   |BORRA 020#dsm213h1.a;
   |LIBERA #dsm213h1;
|FPRC;

|DEFBUCLE BorraL1His213;
    #dsm213h1#1;
    ;
    #dsm210dp#0, 0000, 00, 00000, 00, "               ";
    #dsm210dp#0, 9999, 12, 99999, 99, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL1His213;
|FIN;

|PROCESO BorraL2His213;
   |BORRA 020#dsm213h2.a;
   |LIBERA #dsm213h2;
|FPRC;

|DEFBUCLE BorraL2His213;
    #dsm213h2#1;
    ;
    #dsm210dp#0, 0000, 00, 00000, 00, 000;
    #dsm210dp#0, 9999, 12, 99999, 99, 999;
    be;
    NULL, BorraL2His213;
|FIN;

|PROCESO BorraHis213;
   |BORRA 020#dsm213hi.a;
   |LIBERA #dsm213hi;
|FPRC;

|DEFBUCLE BorraHis213;
    #dsm213hi#1;
    ;
    #dsm210dp#0, 0000, 00, 00000, 00;
    #dsm210dp#0, 9999, 12, 99999, 99;
    be;
    NULL, BorraHis213;
|FIN;

|PROCESO BorraL1Mod213;
   |BORRA 020#dsm213in.a;
   |LIBERA #dsm213in;
|FPRC;

|DEFBUCLE BorraL1Mod213;
    #dsm213in#1;
    ;
    #dsm213ca#0, #dsm213ca#1, 000;
    #dsm213ca#0, #dsm213ca#1, 999;
    be;
    NULL, BorraL1Mod213;
|FIN;

|PROCESO BorraL2Mod213;
   |BORRA 020#dsm213so.a;
   |LIBERA #dsm213so;
|FPRC;

|DEFBUCLE BorraL2Mod213;
    #dsm213so#1;
    ;
    #dsm213ca#0, #dsm213ca#1, "               ";
    #dsm213ca#0, #dsm213ca#1, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL2Mod213;
|FIN;

|PROCESO BorraMod213;
   |BORRA 020#dsm213ca.a;
   |LIBERA #dsm213ca;
|FPRC;

|DEFBUCLE BorraMod213;
    #dsm213ca#1;
    ;
    #dsm210dp#0, 00000;
    #dsm210dp#0, 99999;
    be;
    NULL, BorraMod213;
|FIN;

|PROCESO BorraL1His211;
   |BORRA 020#dsm211h1.a;
   |LIBERA #dsm211h1;
|FPRC;

|DEFBUCLE BorraL1His211;
    #dsm211h1#1;
    ;
    #dsm210dp#0, 0000, 00, 000, "               ";
    #dsm210dp#0, 9999, 99, 999, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL1His211;
|FIN;

|PROCESO BorraL2His211;
   |BORRA 020#dsm211h2.a;
   |LIBERA #dsm211h2;
|FPRC;

|DEFBUCLE BorraL2His211;
    #dsm211h2#1;
    ;
    #dsm210dp#0, 0000, 00, 000, "               ";
    #dsm210dp#0, 9999, 99, 999, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL2His211;
|FIN;

|PROCESO BorraHis211;
   |BORRA 020#dsm211hi.a;
   |LIBERA #dsm211hi;
|FPRC;

|DEFBUCLE BorraHis211;
    #dsm211hi#1;
    ;
    #dsm210dp#0, 0000, 00, 000;
    #dsm210dp#0, 9999, 99, 999;
    be;
    NULL, BorraHis211;
|FIN;

|PROCESO BorraL1Mod211;
   |BORRA 020#dsm211la.a;
   |LIBERA #dsm211la;
|FPRC;

|DEFBUCLE BorraL1Mod211;
    #dsm211la#1;
    ;
    #dsm210dp#0, 000, "               ";
    #dsm210dp#0, 999, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL1Mod211;
|FIN;

|PROCESO BorraL2Mod211;
   |BORRA 020#dsm211tr.a;
   |LIBERA #dsm211tr;
|FPRC;

|DEFBUCLE BorraL2Mod211;
    #dsm211tr#1;
    ;
    #dsm210dp#0, 000, "               ";
    #dsm210dp#0, 999, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL2Mod211;
|FIN;

|PROCESO BorraMod211;
   |BORRA 020#dsm211ca.a;
   |LIBERA #dsm211ca;
|FPRC;

|DEFBUCLE BorraMod211;
    #dsm211ca#1;
    ;
    #dsm210dp#0, 000;
    #dsm210dp#0, 999;
    be;
    NULL, BorraMod211;
|FIN;

|PROCESO BorraL4His210;
   |BORRA 020#dsm210h4.a;
   |LIBERA #dsm210h4;
|FPRC;

|DEFBUCLE BorraL4His210;
    #dsm210h4#1;
    ;
    #dsm210dp#0, 0000, 00, 00, 00, "               ", 000, 000, "  ";
    #dsm210dp#0, 9999, 12, 99, 99, "zzzzzzzzzzzzzzz", 999, 999, "zz";
    be;
    NULL, BorraL4His210;
|FIN;

|PROCESO BorraL3His210;
   |BORRA 020#dsm210h3.a;
   |LIBERA #dsm210h3;
|FPRC;

|DEFBUCLE BorraL3His210;
    #dsm210h3#1;
    ;
    #dsm210dp#0, 0000, 00, 00, 00, "               ", 000, "01.01.0000", 000;
    #dsm210dp#0, 9999, 12, 99, 99, "zzzzzzzzzzzzzzz", 999, "31.12.9999", 999;
    be;
    NULL, BorraL3His210;
|FIN;

|PROCESO BorraL2His210;
   |BORRA 020#dsm210h2.a;
   |LIBERA #dsm210h2;
|FPRC;

|DEFBUCLE BorraL2His210;
    #dsm210h2#1;
    ;
    #dsm210dp#0, 0000, 00, 00, 00, "               ";
    #dsm210dp#0, 9999, 12, 99, 99, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL2His210;
|FIN;

|PROCESO BorraL1His210;
   |BORRA 020#dsm210h1.a;
   |LIBERA #dsm210h1;
|FPRC;

|DEFBUCLE BorraL1His210;
    #dsm210h1#1;
    ;
    #dsm210dp#0, 0000, 00, 00, 00, 000;
    #dsm210dp#0, 9999, 12, 99, 99, 999;
    be;
    NULL, BorraL1His210;
|FIN;

|PROCESO BorraHis210;
   |BORRA 020#dsm210hi.a;
   |LIBERA #dsm210hi;
|FPRC;

|DEFBUCLE BorraHis210;
    #dsm210hi#1;
    ;
    #dsm210dp#0, 0000, 00, 00, 00;
    #dsm210dp#0, 9999, 12, 99, 99;
    be;
    NULL, BorraHis210;
|FIN;

|PROCESO BorraL4Mod210;
   |BORRA 020#dsm210fp.a;
   |LIBERA #dsm210fp;
|FPRC;

|DEFBUCLE BorraL4Mod210;
    #dsm210fp#1;
    ;
    #dsm210dp#0, 00, "               ", 000, 000, " ";
    #dsm210dp#0, 99, "zzzzzzzzzzzzzzz", 999, 999, "z";
    be;
    NULL, BorraL4Mod210;
|FIN;

|PROCESO BorraL3Mod210;
   |BORRA 020#dsm210ln.a;
   |LIBERA #dsm210ln;
|FPRC;

|DEFBUCLE BorraL3Mod210;
    #dsm210ln#1;
    ;
    #dsm210dp#0, 00, "               ", 000, "01.01.0000", 000;
    #dsm210dp#0, 99, "zzzzzzzzzzzzzzz", 999, "31.12.9999", 999;
    be;
    NULL, BorraL3Mod210;
|FIN;

|PROCESO BorraL2Mod210;
   |BORRA 020#dsm210ni.a;
   |LIBERA #dsm210ni;
|FPRC;

|DEFBUCLE BorraL2Mod210;
    #dsm210ni#1;
    ;
    #dsm210dp#0, 00, "               ";
    #dsm210dp#0, 99, "zzzzzzzzzzzzzzz";
    be;
    NULL, BorraL2Mod210;
|FIN;

|PROCESO BorraL1Mod210;
   |BORRA 020#dsm210in.a;
   |LIBERA #dsm210in;
|FPRC;

|DEFBUCLE BorraL1Mod210;
    #dsm210in#1;
    ;
    #dsm210dp#0, 00, 000;
    #dsm210dp#0, 99, 999;
    be;
    NULL, BorraL1Mod210;
|FIN;

|PROCESO BorraMod210;
   |BORRA 020#dsm210ca.a;
   |LIBERA #dsm210ca;
|FPRC;

|DEFBUCLE BorraMod210;
    #dsm210ca#1;
    ;
    #dsm210dp#0, 00;
    #dsm210dp#0, 99;
    be;
    NULL, BorraMod210;
|FIN;

|PROCESO EliminaContr;
   |BUCLE BorraInmContr;

   |BUCLE BorraMod210; |BUCLE BorraL1Mod210; |BUCLE BorraL2Mod210;
                       |BUCLE BorraL3Mod210; |BUCLE BorraL4Mod210;
   |BUCLE BorraHis210; |BUCLE BorraL1His210; |BUCLE BorraL2His210;
                       |BUCLE BorraL3His210; |BUCLE BorraL4His210;

   |BUCLE BorraMod211; |BUCLE BorraL1Mod211; |BUCLE BorraL2Mod211;
   |BUCLE BorraHis211; |BUCLE BorraL1His211; |BUCLE BorraL2His211;

   |BUCLE BorraMod213; |BUCLE BorraL1Mod213; |BUCLE BorraL2Mod213;
   |BUCLE BorraHis213; |BUCLE BorraL1His213; |BUCLE BorraL2His213;

   |ABRE #dsm210db;
   #dsm210db#0 = #dsm210dp#0;
   |LEE 101#dsm210db.=;
   |SI FSalida = 0;
       |BORRA 020#dsm210db.a;
       |LIBERA #dsm210db;
   |FINSI;
   |CIERRA #dsm210db;
|FPRC;

|PROCESO GrabaHistorico;
   #dsm210h4#0 = #dsmow355#0;
   #dsm210h4#1 = #dsmow355#1;
   #dsm210h4#2 = #dsmow355#2;
   #dsm210h4#3 = #dsmow355#3;
   #dsm210h4#4 = #dsmow355#4;
   #dsm210h4#5 = #dsmow355#5;
   #dsm210h4#6 = #dsmow355#6;
   #dsm210h4#7 = #dsmow355#7;
   #dsm210h4#40 = #dsmow355#40;
   |LEE 000#dsm210h4.=;
   |SI FSalida ! 0;
      |DDEFECTO #dsm210h4;
      |PARA nCont = 0; |SI nCont [ 40; |HACIENDO nCont = nCont + 1;
         #dsm210h4#nCont# = #dsmow355#nCont#;
      |SIGUE;
      |GRABA 020#dsm210h4.n;
   |FINSI;
|FPRC;

|DEFBUCLE GrabaHistorico;
    #dsmow355#1;
    ;
    INICIO;
    FINAL;
    ;
    NULL, GrabaHistorico;
|FIN;

|PROCESO Transforma;
   |ABRE #dsmow355;
   |LEE 000#dsmow355.p;
   |SI FSalida ! 0;
      |DFICE aAlfa; |QBF aAlfa;
      aAlfa1 = aAlfa + "dsm210h4.dat"; aAlfa2 = aAlfa + "dsmow355.dat";
      |COPIA_FICHERO aAlfa1, aAlfa2;

      |DFICE aAlfa; |QBF aAlfa;
      aAlfa1 = aAlfa + "dsm210h4.ddx"; aAlfa2 = aAlfa + "dsmow355.ddx";
      |COPIA_FICHERO aAlfa1, aAlfa2;

      |DFICE aAlfa; |QBF aAlfa;
      aAlfa1 = aAlfa + "dsm210h4.ixx"; aAlfa2 = aAlfa + "dsmow355.ixx";
      |COPIA_FICHERO aAlfa1, aAlfa2;

      |DELINDEX #dsm210h4; |ABRE #dsm210h4; |ABRET #dsmow355;
      |BUCLE GrabaHistorico;
      |CIERRAT #dsmow355; |CIERRA #dsm210h4;
   |FINSI;
   |CIERRA #dsmow355;
|FPRC;
