|FICHEROS;
     dsmom065 #65;
     dsmom001 #1;
     dsmom004 #4;
     dsmom008 #8;

     dsmom009 #9;
     dsmom010 #10;
     dsmom011 #11;
     dsmom012 #12;
     dsmom013 #13;
     dsmom014 #14;
     dsmopl10;
     dsmopl12;
     dsmopl13;

     dsmom030 #30;
     dsmoc130 #130;
     dsmom107 #107;

     :/contagen/def/cacuenta;
|FIN;

|VARIABLES;
     &enCalculado = 0;
     &enRec65   = 0;
     &eaTipo65  = "";
     &enImpo65  = 0;
     &enModo65  = 0;
     &eaHay130  = "";
     &eaHay303  = "";
     aDTipo     = "";
     aHTipo     = "";
     nNume1     = 0;
     nNume2     = 0;
     nNume3     = 0;
     nNume11    = 0;
     nInkey     = 0;
     Modo       = 0;
     nCambio    = 0;
     aCuenta    = "";
     aDesde     = "";
     aHasta     = "";
     aAlfa1     = "";
     aAlfa2     = "";
     aAlfa3     = "";
     nSalir     = 0;
     nMaestra   = 0;
     swError    = 0;

     &eaDCta    = "";
     &eaHCta    = "";
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|| ********************** Procesos
|RUTINA inf2_65;
   #cacuenta#0 = "6           ";
   #cacuenta#3 = "S";
|FRUT;

|RUTINA sup2_65;
   #cacuenta#0 = "799999999999";
   #cacuenta#3 = "S";
|FRUT;

|PROCESO Inf14;
    #14#10 = enPlan14;
    #14#0  = "6   ";
    #14#2 = aDTipo;
|FPRC;

|PROCESO Sup14;
    #14#10 = enPlan14;
    #14#0  = "zzzz";
    #14#2 = aHTipo;
|FPRC;

|PROCESO Consulta;

   |SI nInkey = 10;
      |ABRE #cacuenta;
      |SI nMaestra = 1;
          |CONSULTA_F_CLAVE #1#cacuenta,inf2_65,sup2_65;
      |SINO;
          |CONSULTA_F_CLAVE #6#cacuenta,inf2_65,sup2_65;
      |FINSI;
      #dsmom065#6 = #cacuenta#0; |PINTA #dsmom065#6;
      #dsmom065#7 = #cacuenta#2; |PINTA #dsmom065#7;
      |ERROR;
      |CIERRA #cacuenta;
   |FINSI;

   |SI nInkey = 11;
      aDTipo = " ";
      aHTipo = "z";
      #14#0 = #dsmom065#6;
      |ABRE #14;
      |CONSULTA_F_CLAVE #1#14, Inf14, Sup14;
      |CIERRA #14;
      #dsmom065#6 = #14#0; |PINTA #dsmom065#6;
   |FINSI;
|FPRC;

|CALCULO LaCuenta;
   nInkey = FSalida;

   Modo = (FEntrada / 100) ! 0;
   |SI nInkey = 10; |O nInkey = 11;
       |HAZ Consulta;
   |FINSI;

   nNume11 = enEjer;
   eaCuenta = #dsmom065#6;
   salidas  = FSalida;
   |HAZ FiltraPuntos;
   enEjer = nNume11;

   #dsmom065#6 = eaCuenta;
   |PINTA #dsmom065#6;

   |SI #dsmom065#6 = "            ";  |ACABA; |FINSI;

   aAlfa1  = #dsmom065#6; |QBF aAlfa1;
   |SI aAlfa1 = "";
       |MENAV "    Error. Introcuzca Cuenta";
       |ERROR;
       |ACABA;
   |FINSI;

   swError = 0;
   aAlfa2 = aAlfa1 % 0;
   nNume1 = aAlfa2;
   |SI nNume1 < 4;
       |MENAV "    Error. Introcuzca Cuenta con longitud mayor o igual a 4";
       |ERROR;
       |ACABA;
   |FINSI;
   |PARA nNume2 = 1; |SI nNume2 [ nNume1; |HACIENDO nNume2 = nNume2 + 1;
         aAlfa2 = nNume2; |QBF aAlfa2;
         aAlfa2 = aAlfa2 + "01";
         aAlfa3 = aAlfa1 % aAlfa2;
         |SI aAlfa3 < "0"; |O aAlfa3 > "9";
             swError = 1;
             |SAL;
         |FINSI;
   |SIGUE;
   |SI swError = 1;
       |MENAV "    Cuenta Erronea ... ";
       |ERROR;
       |ACABA;
   |FINSI;

   aCuenta = #dsmom065#6 % 104;
   |ABRE #14;
   |SELECT #2#14;
   #14#10 = enPlan14;
   #14#5  = aCuenta;
   |LEE 040#14=;
   |SI FSalida = 0;
       |SELECT #1#14;
       |CIERRA #14;
       |MENAV "    Error. Cuenta en Existencias";
       |ERROR;
       |ACABA;
   |FINSI;

   |SELECT #1#14;
   #14#10 = enPlan14;
   #14#0  = aCuenta;
   |LEE 040#14=;
   |SI FSalida ! 0;
       |CIERRA #14;
       |MENAV "    Error. No existe Cuenta en planillas";
       |ERROR;
       |ACABA;
   |FINSI;
   |CIERRA #14;
   |SI #14#2 = "E";
       |MENAV "    Error. Cuenta de Existencias";
       |ERROR;
       |ACABA;
   |FINSI;

   aAlfa1 = "S";
   #dsmom065#7  = #14#1; |PINTA #dsmom065#7;
   |ABRE #cacuenta;
   #cacuenta#0 = #dsmom065#6;
   |LEE 041#cacuenta.=;
   |SI FSalida = 0;
       aAlfa1 = "N";
       #dsmom065#7 = #cacuenta#2;
       |PINTA #dsmom065#7;
   |FINSI;
   |CIERRA #cacuenta;
   |C_M #dsmom065#7,1,aAlfa1;

   #dsmom065#13 = #14#2; |PINTA #dsmom065#13;
|FCAL;


|CALCULO CalImporte; |TIPO 0;
  nNume1 = Contenido;
  |SI FSalida = 13; |Y Campo = 8;
      enCalculado = #dsmom065#8;
      |HAZ Calculadora;
      #dsmom065#8 = enCalculado;
      |PINTA #dsmom065#8;
  |FINSI;

  |SI #dsmom065#Campo# ! nNume1;
      |SI Campo = 8; |O Campo = 9;
          #dsmom065#10 = (#dsmom065#8 % #dsmom065#9) ! EURODBMOD; |PINTA #dsmom065#10;
      |FINSI;
      |SI Campo = 8; |O Campo = 14;
          #dsmom065#15 = (#dsmom065#8 % #dsmom065#14) ! EURODBMOD; |PINTA #dsmom065#15;
      |FINSI;
  |FINSI;
|FCAL;

|PROCESO Inf30;
 #30#0 = 600;
|FPRC;

|PROCESO Sup30;
 #30#0 = 999;
|FPRC;

|CALCULO AntesConcepto;  |TIPO 7;
 Modo = (FEntrada / 100) ! 0;
 |SI Modo = 1; |Y #dsmom065#11 = 0; |Y #dsmom065#9 ! 0;
     |SI #dsmom065#13 = "I"; #dsmom065#11 = 700; |FINSI;
     |SI #dsmom065#13 ! "I"; #dsmom065#11 = 600; |FINSI;
     |PINTA #dsmom065#11;
 |FINSI;
|FCAL;

|CALCULO MiraConcepto;  |TIPO 6;
   nInkey = FSalida;

   |SI nInkey = 10;
       |ABRE #30;
       #30#0 = #dsmom065#11; |SI #dsmom065#11 = 0; #30#0 = 600;|FINSI;
       |CONSULTA_F_CLAVE  #1#30, Inf30, Sup30;
       |CIERRA #30;
       #dsmom065#11 = #30#0;
   |FINSI;

   |DDEFECTO #30;
   |SI #dsmom065#11 ! 0;
       |ABRE #30;
       #30#0 = #dsmom065#11;
       |LEE 001#30=;
       |SI FSalida ! 0;
           |MENAV "    Error, no existe Concepto";
           |ERROR;
       |SINO;
           |SI #30#4 = "N";
              |CONFI "    NError Este Concepto no es de IVA. Continuar";
              |SI FSalida ! 0;
                  |ERROR;
              |FINSI;
           |SINO;
              |SI #dsmom065#13 = "I"; |Y #30#17 = "N";
                  |CONFI "    NError Este Concepto no es de Ventas y Ingresos. Continuar";
                  |SI FSalida ! 0;
                      |ERROR;
                   |FINSI;
              |FINSI;
              |SI #dsmom065#13 ! "I"; |Y #30#16 = "N";
                  |CONFI "    NError Este Concepto no es de Compras y Gastos. Continuar";
                  |SI FSalida ! 0;
                      |ERROR;
                   |FINSI;
              |FINSI;
           |FINSI;
      |FINSI;
   |FINSI;
   |CIERRA #30;
   #dsmom065#12 = #30#1;
|FCAL;

|| ********************************************************************
|PROCESO Tipo7C05; |TIPO 7;
   |SI enRec65 = 0;
       |MENSA "    <F5> Para introducir Movmientos con Recargo";
   |FINSI;
|FPRC;

|PROCESO Tipo11C65; |TIPO 11;
   |BLIN 4;
   |SI FSalida = 13; |Y enRec65 = 0;
       |CONFI "    SDesea introducir Movimientos con Recargo ";
       |SI FSalida = 0;
           enRec65 = 1;
           nSalir  = 1;
           |ERROR;
           |PTEC 806;
       |FINSI;
   |FINSI;
|FPRC;

|| ********************************************************************
|| ...................... Calculo
|PROCESO Borra10;
    #10#8 = 0;
    |GRABA 020#10a;
    |LIBERA #10;
|FPRC;

|DEFBUCLE dsmom010B;
    #10#1;
    ;
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "    ";
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "zzzz";
    be;
    NULL, Borra10;
|FIN;

|PROCESO Borra12;
  #14#5 = #12#5;
  |LEE 040#14=;
  |SI FSalida ! 0;  ||No es de existencias
      #12#8 = 0;
  |FINSI;
  |GRABA 020#12a;
  |LIBERA #12;
|FPRC;

|DEFBUCLE dsmom012B;
    #12#1;
    ;
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "    ";
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "zzzz";
    be;
    NULL, Borra12;
|FIN;

|PROCESO Borra13;
  #13#8 = 0;
  |GRABA 020#13a;
  |LIBERA #13;
|FPRC;

|DEFBUCLE dsmom013B;
    #13#1;
    ;
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "    ";
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "zzzz";
    be;
    NULL, Borra13;
|FIN;

|PROCESO Borra10pl;
    |BORRA 020#dsmopl10.a;
    |LIBERA #dsmopl10;
|FPRC;

|DEFBUCLE dsmopl10B;
    #dsmopl10#1;
    ;
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "            ";
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "zzzzzzzzzzzz";
    be;
    NULL, Borra10pl;
|FIN;

|PROCESO Borra12pl;
  |BORRA 020#dsmopl12.a;
  |LIBERA #dsmopl12;
|FPRC;

|DEFBUCLE dsmopl12B;
    #dsmopl12#1;
    ;
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "            ";
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "zzzzzzzzzzzz";
    be;
    NULL, Borra12pl;
|FIN;

|PROCESO Borra13pl;
  |BORRA 020#dsmopl13.a;
  |LIBERA #dsmopl13;
|FPRC;

|DEFBUCLE dsmopl13B;
    #dsmopl13#1;
    ;
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "            ";
    enEmpresa, enEjer, enPeriodo, enComplem, enActividad, "zzzzzzzzzzzz";
    be;
    NULL, Borra13pl;
|FIN;

|PROCESO PasaIngresos;
     |DDEFECTO #10;
     #10#0  = enEmpresa;
     #10#1  = enEjer;
     #10#2  = enPeriodo;
     #10#3  = enComplem;
     #10#4  = enActividad;
     #10#5  = #14#0;
     #10#6  = #14#1;
     #10#7  = #14#3;
     |GRABA 020#10n;
     |LIBERA #10;
|FPRC;

|DEFBUCLE dsmom014Iw6;
     #14#1;
     2;
     enPlan14, "    ", "I";
     enPlan14, "zzzz", "I";
     ;
     NULL, PasaIngresos;
|FIN;

|PROCESO PasaConsumo;
     |DDEFECTO #12;
     #12#0  = enEmpresa;
     #12#1  = enEjer;
     #12#2  = enPeriodo;
     #12#3  = enComplem;
     #12#4  = enActividad;
     #12#5  = #14#0;
     #12#6  = #14#1;
     #12#7  = #14#3;
     |GRABA 020#12n;
     |LIBERA #12;
|FPRC;

|DEFBUCLE dsmom014Cw6;
     #14#1;
     2;
     enPlan14, "    ", "C";
     enPlan14, "zzzz", "C";
     ;
     NULL, PasaConsumo;
|FIN;

|PROCESO PasaGastos;
     |DDEFECTO #13;
     #13#0  = enEmpresa;
     #13#1  = enEjer;
     #13#2  = enPeriodo;
     #13#3  = enComplem;
     #13#4  = enActividad;
     #13#5  = #14#0;
     #13#6  = #14#1;
     #13#7  = #14#3;
     |GRABA 020#13n;
     |LIBERA #13;
|FPRC;

|DEFBUCLE dsmom014Gw6;
     #14#1;
     2;
     enPlan14, "    ", "G";
     enPlan14, "zzzz", "G";
     ;
     NULL, PasaGastos;
|FIN;

|PROCESO ActIngreso;
     #10#0  = enEmpresa;
     #10#1  = enEjer;
     #10#2  = enPeriodo;
     #10#3  = enComplem;
     #10#4  = enActividad;
     #10#5  = #dsmom065#6;
     |LEE 141#10=;
     |SI FSalida = 0;
         #10#8 = #10#8 + #dsmom065#8;
         |GRABA 020#10a;
     |FINSI;
     |LIBERA #10;

     |SI enEjer ] 2019; |Y enDesglose60 = 1;

         #dsmopl10#0 = enEmpresa;
         #dsmopl10#1 = enEjer;
         #dsmopl10#2 = enPeriodo;
         #dsmopl10#3 = enComplem;
         #dsmopl10#4 = enActividad;
         #dsmopl10#5 = #dsmom065#6;
         |LEE 101#dsmopl10.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmopl10;
             #dsmopl10#0 = enEmpresa;
             #dsmopl10#1 = enEjer;
             #dsmopl10#2 = enPeriodo;
             #dsmopl10#3 = enComplem;
             #dsmopl10#4 = enActividad;
             #dsmopl10#5 = #dsmom065#6;
             |GRABA 020#dsmopl10.b;
         |FINSI;
         #dsmopl10#6 = #dsmom065#7;
         #dsmopl10#7 = #dsmom010#7;
         #dsmopl10#8 = #dsmopl10#8 + #dsmom065#8;
         |GRABA 020#dsmopl10.a;
         |LIBERA #dsmopl10;
     |FINSI;
|FPRC;

|PROCESO ActConsumo;
     #12#0  = enEmpresa;
     #12#1  = enEjer;
     #12#2  = enPeriodo;
     #12#3  = enComplem;
     #12#4  = enActividad;
     #12#5  = #dsmom065#6;
     |LEE 141#12=;
     |SI FSalida = 0;
         #12#8 = #12#8 + #dsmom065#8;
         |GRABA 020#12a;
     |FINSI;
     |LIBERA #12;

     |SI enEjer ] 2019; |Y enDesglose60 = 1;
         #dsmopl12#0 = enEmpresa;
         #dsmopl12#1 = enEjer;
         #dsmopl12#2 = enPeriodo;
         #dsmopl12#3 = enComplem;
         #dsmopl12#4 = enActividad;
         #dsmopl12#5 = #dsmom065#6;
         |LEE 101#dsmopl12.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmopl12;
              #dsmopl12#0 = enEmpresa;
              #dsmopl12#1 = enEjer;
              #dsmopl12#2 = enPeriodo;
              #dsmopl12#3 = enComplem;
              #dsmopl12#4 = enActividad;
              #dsmopl12#5 = #dsmom065#6;
              |GRABA 020#dsmopl12.b;
         |FINSI;
         #dsmopl12#6 = #dsmom065#7;
         #dsmopl12#7 = #dsmom012#7;
         #dsmopl12#8 = #dsmopl12#8 + #dsmom065#8;
         |GRABA 020#dsmopl12.a;
         |LIBERA #dsmopl12;
     |FINSI;
|FPRC;

|PROCESO ActGastos;
     #13#0  = enEmpresa;
     #13#1  = enEjer;
     #13#2  = enPeriodo;
     #13#3  = enComplem;
     #13#4  = enActividad;
     #13#5  = #dsmom065#6;
     |LEE 141#13=;
     |SI FSalida = 0;
         #13#8 = #13#8 + #dsmom065#8;
         |GRABA 020#13a;
     |FINSI;
     |LIBERA #13;

     |SI enEjer ] 2019; |Y enDesglose60 = 1;
         #dsmopl13#0 = enEmpresa;
         #dsmopl13#1 = enEjer;
         #dsmopl13#2 = enPeriodo;
         #dsmopl13#3 = enComplem;
         #dsmopl13#4 = enActividad;
         #dsmopl13#5 = #dsmom065#6;
         |LEE 101#dsmopl13.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmopl13;
              #dsmopl13#0 = enEmpresa;
              #dsmopl13#1 = enEjer;
              #dsmopl13#2 = enPeriodo;
              #dsmopl13#3 = enComplem;
              #dsmopl13#4 = enActividad;
              #dsmopl13#5 = #dsmom065#6;
              |GRABA 020#dsmopl13.b;
         |FINSI;
         #dsmopl13#6 = #dsmom065#7;
         #dsmopl13#7 = #dsmom013#7;
         #dsmopl13#8 = #dsmopl13#8 + #dsmom065#8;
         |GRABA 020#dsmopl13.a;
         |LIBERA #dsmopl13;
     |FINSI;
|FPRC;

|PROCESO LeoNuevaPlanilla;
     eaTip60 = #dsmom065#13;
     |SI #dsmom065#13 = "C"; eaTip60 = "G"; |FINSI;
     eaCta60 = #dsmom065#6 % 104;
     |HAZ HayDesglose60;

     |SI #dsmom065#13 = "I"; |HAZ ActIngreso; |FINSI;
     |SI #dsmom065#13 = "C"; |HAZ ActConsumo; |FINSI;
     |SI #dsmom065#13 = "G"; |HAZ ActGastos;  |FINSI;
|FPRC;

|DEFBUCLE LeoNuevaPlanilla;
 #dsmom065#1;
 ;
 enEmpresa, enEjer, enPeriodo, enComplem, enActividad, 0001;
 enEmpresa, enEjer, enPeriodo, enComplem, enActividad, 9999;
 be;
 NULL, LeoNuevaPlanilla;
|FIN;

|PROCESO CalculaPlanillas;
     |PULSATECLA;

     |ABRE #10;
     #10#0  = enEmpresa;
     #10#1  = enEjer;
     #10#2  = enPeriodo;
     #10#3  = enComplem;
     #10#4  = enActividad;
     #10#5  = "    ";
     |LEE 040#10];
     |SI FSalida ! 0; |O #10#0 ! enEmpresa;  |O #10#1 ! enEjer; |O #10#2 ! enPeriodo;
       |O #10#3 ! enComplem; |O #10#4 ! enActividad;
          |BUCLE dsmom014Iw6;
          |CIERRA #10;
     |SINO;
          |CIERRA #10;
          |BUCLE dsmom010B;
     |FINSI;

     |ABRE #12;
     #12#0  = enEmpresa;
     #12#1  = enEjer;
     #12#2  = enPeriodo;
     #12#3  = enComplem;
     #12#4  = enActividad;
     #12#5  = "    ";
     |LEE 040#12];
     |SI FSalida ! 0; |O #12#0 ! enEmpresa;  |O #12#1 ! enEjer; |O #12#2 ! enPeriodo;
       |O #12#3 ! enComplem; |O #12#4 ! enActividad;
          |BUCLE dsmom014Cw6;
          |CIERRA #12;
     |SINO;
          |CIERRA #12;
          |ABRE #14;
          |SELECT #2#14;
          |BUCLE dsmom012B;
          |SELECT #1#14;
          |CIERRA #14;
     |FINSI;

     |ABRE #13;
     #13#0  = enEmpresa;
     #13#1  = enEjer;
     #13#2  = enPeriodo;
     #13#3  = enComplem;
     #13#4  = enActividad;
     #13#5  = "    ";
     |LEE 040#13];
     |SI FSalida ! 0; |O #13#0 ! enEmpresa;  |O #13#1 ! enEjer; |O #13#2 ! enPeriodo;
       |O #13#3 ! enComplem; |O #13#4 ! enActividad;
          |BUCLE dsmom014Gw6;
          |CIERRA #13;
     |SINO;
          |CIERRA #13;
          |BUCLE dsmom013B;
     |FINSI;
     |SI enEjer ] 2019;
          |BUCLE dsmopl10B;
          |BUCLE dsmopl12B;
          |BUCLE dsmopl13B;
     |FINSI;

     |SI eaHay130 = "X";
          |ABRE #dsmopl10;
          |ABRE #dsmopl12;
          |ABRE #dsmopl13;
          |ABRE #10;
          |ABRE #12;
          |ABRE #13;
          |BUCLE LeoNuevaPlanilla;
          |CIERRA #13;
          |CIERRA #12;
          |CIERRA #10;
          |CIERRA #dsmopl13;
          |CIERRA #dsmopl12;
          |CIERRA #dsmopl10;
     |FINSI;
|FPRC;

|PROCESO ClaveBaja65;
      #dsmom065#0 = enEmpresa;
      #dsmom065#1 = enEjer;
      #dsmom065#2 = enPeriodo;
      #dsmom065#3 = enComplem;
      #dsmom065#4 = enActividad;
      #dsmom065#5 = 0001;
      #dsmom065#13 = aDesde;
|FPRC;

|PROCESO ClaveAlta65;
      #dsmom065#0 = enEmpresa;
      #dsmom065#1 = enEjer;
      #dsmom065#2 = enPeriodo;
      #dsmom065#3 = enComplem;
      #dsmom065#4 = enActividad;
      #dsmom065#5 = 9999;
      #dsmom065#13 = aHasta;
|FPRC;

|PROCESO LaPantalla;
     |C_V #dsmom065#14,1,"N"; |C_M #dsmom065#14,1,"N";
     |C_V #dsmom065#15,1,"N"; |C_M #dsmom065#15,1,"N";
     |C_A #dsmom065#7, 1, 20;
     |C_P #dsmom065#8, 1, 1441;
     |C_P #dsmom065#9, 1, 1454;
     |C_P #dsmom065#10,1, 1460;
     |PINPA #0#dsmom065;
     |SI enRec65 = 1;
         |C_V #dsmom065#14,1,"S"; |C_M #dsmom065#14,1,"S";
         |C_V #dsmom065#15,1,"S"; |C_M #dsmom065#15,1,"S";
         |C_A #dsmom065#7, 1, 9;
         |C_P #dsmom065#8, 1, 1422;
         |C_P #dsmom065#9, 1, 1435;
         |C_P #dsmom065#10,1, 1441;
         |PINTA 1321, ""; |PINTA 1334, "";
         |PINTA 1421, ""; |PINTA 1434, "";
         |PINTA 1521, ""; |PINTA 1534, "";
         |PINTA 1621, ""; |PINTA 1634, "";
         |PINTA 1721, ""; |PINTA 1734, "";
         |PINTA 1821, ""; |PINTA 1834, "";
         |PINTA 1921, ""; |PINTA 1934, "";
         |PINTA 2021, ""; |PINTA 2034, "";
         |PINTA 2121, ""; |PINTA 2134, "";
         |PINTA 2221, ""; |PINTA 2234, "";

         |ATRI R;
         |PINTA 1322, "     Importe";
         |PINTA 1335, "%IVA ";
         |PINTA 1341, " Cuota IVA  ";
         |PINTA 1354, "%Rec.";
         |PINTA 1360, " C. Recargo ";
         |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO LaConta;
  nNume11    = enEjer;
  nMaestra   = 0;
  enConcreto = 1;
  enPerConta = -1;
  enSwSinMen = 1;
  |HAZ SituaContagen;
  |SI swerror = 1;
      |HAZ SituaMaestra;
      nMaestra   = 1;
  |FINSI;
  nLongMax = MaximoDigitos;
  |PATH_DAT #cacuenta#aPathConta#;
  enEjer = nNume11;
|FPRC;

|PROGRAMA;
     |HAZ LeeEURODBMOD;

     |HAZ LaConta;

     |HAZ Verm014Plan;
     |SI enPlan14 = 0; |ACABA; |FINSI;
     |HAZ Verm060Plan;
     |SI enPlan60 = 0; |ACABA; |FINSI;

     |PULSATECLA;
     |HAZ LaPantalla;
     |SI enModo65 = 4; |Y eaTipo65 ! "V";
         aAlfa1 = "        "
         aDesde = eaTipo65; aHasta = eaTipo65;
         |SI eaTipo65 = "I"; aAlfa1 = "Ingresos"; |FINSI;
         |SI eaTipo65 = "G"; aAlfa1 = "Gastos  "; |FINSI;
         |SI eaTipo65 = "C"; aAlfa1 = "Consumo "; |FINSI;

         |ATRI I; |PINTA 1254, aAlfa1;
         #dsmom065#8 = enImpo65; |PINTA 1241, #dsmom065#8; |ATRI 0;

         |ENTLINEAL #2#dsmom065, -6, enModo65, 22, 0, ClaveBaja65, ClaveAlta65;
     |SINO;
         nSalir = 1;
         |PARA; |SI nSalir = 1; |HACIENDO;
             nSalir = 0;
             aDesde = " "; aHasta = "z";
             |ENTLINEAL #1#dsmom065, -6, enModo65, 22, 0, ClaveBaja65, ClaveAlta65;
             |SI nSalir = 1;
                 |HAZ LaPantalla;
             |FINSI;
         |SIGUE;
     |FINSI;
     |SI enModo65 ! 4;
         |HAZ CalculaPlanillas;
     |FINSI;
|FPRO;
