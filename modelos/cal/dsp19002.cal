|FICHEROS;
     dsmom004;
     dsmom107;

     dsm19001;
     dsm11101;

     :/basica/def/agidanif;

     dsmow013;
     dsmow107;

     espejo1@;
     dsm190co@;
     &regisnif@;
|FIN;

|VARIABLES;
     aFichero     = "";
     nOpera       = 0;
     aAlfa        = "";
     nNume        = 0;
     nOp          = 0;
     nLaImpresora = 0;
     nSw          = 0;
     nSwHay       = 0;
     nSumaCampo1  = 0;
     nSumaCampo2  = 0;
     nSumaCampo3  = 0;
     nSumaCampo4  = 0;
     nSumaCampo5  = 0;
     nSumaCampo6  = 0;
     nSumaCampo7  = 0;
     nSumaCampo8  = 0;
     nSumaCampo9  = 0;
     nSumaCampo10 = 0;
     nTRelacion   = 0;
     &enTRela     = 0;
     &enBRela     = 0;
     nSuma        = 0;
     nCampoD      = 0;

     aVariable    = "";
     aPathModelo  = "";
     aDef         = "";

     &eaVariable  = "";
     &enNumError  = 0;
     &enError     = 0;
     &enSwPartir  = 0;

     nDComplem    = 0;
     nHComplem    = 0;
     Periodo      = 0;
     nImporte     = 0;

     &enDEmpresa  = 0;
     &enHEmpresa  = 0;
     nSiEsta      = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO BuscaRepre;
     |SI eaNifRepresentante = "............";
         eaNifRepresentante = "";
     |FINSI;

     nNume = enEjer - #dsm19001#14;
     aAlfa = #dsm11101#30; |QBF aAlfa;

     |SI #dsm19001#14 ! 0;
         |SI nNume < 15;
             |SI aAlfa ! ""; eaNifRepresentante = #dsm11101#30; |FINSI;
         |SINO;
              eaNifRepresentante = "";
         |FINSI;
     |SINO;
         |SI aAlfa ! ""; eaNifRepresentante = #dsm11101#30; |FINSI;
     |FINSI;
     #dsm19001#70 = eaNifRepresentante;
|FPRC;

|PROCESO GraboAux2016;
   |DDEFECTO #dsmow107;
   #dsmow107#0  = #dsm19001#0;
   #dsmow107#1  = #dsm19001#1;
   #dsmow107#2  = #dsm19001#2;
   #dsmow107#3  = #dsm19001#3;
   #dsmow107#4  = #dsm19001#4;
   #dsmow107#5  = #dsm19001#5;
   #dsmow107#6  = #dsm19001#6;
   #dsmow107#7  = #dsm19001#7;
   #dsmow107#8  = #dsm19001#8;
   #dsmow107#9  = #dsm19001#9;
   #dsmow107#10 = #dsm19001#10;
   |LEE 101#dsmow107.=;
   |SI FSalida ! 0;
      |DDEFECTO #dsmow107;
      #dsmow107#0  = #dsm19001#0;
      #dsmow107#1  = #dsm19001#1;
      #dsmow107#2  = #dsm19001#2;
      #dsmow107#3  = #dsm19001#3;
      #dsmow107#4  = #dsm19001#4;
      #dsmow107#5  = #dsm19001#5;
      #dsmow107#6  = #dsm19001#6;
      #dsmow107#7  = #dsm19001#7;
      #dsmow107#8  = #dsm19001#8;
      #dsmow107#9  = #dsm19001#9;
      #dsmow107#10 = #dsm19001#10;
      |GRABA 020#dsmow107.b;
   |FINSI;

   |SI nOpera = 1; #dsmow107#11 = #dsmow107#11 + nImporte; |FINSI;
   |SI nOpera = 2; #dsmow107#12 = nImporte; |FINSI;

   |GRABA 020#dsmow107.a;
   |LIBERA #dsmow107;
|FPRC;

|PROCESO GrabaError2016;
     eaVariable = aVariable;
     enNumError = enNumError + 1;
     |HAZ eGrabaW156;
|FPRC;

|PROCESO dsm11101Rel;
     |SI #espejo1@#24 = "S";
         nTRelacion = #espejo1@#11;
         enBRela    = 1;
         |SI #espejo1@#8 < #dsm11101#8;
             |SI #dsm11101#24 = "N"; |Y #dsm11101#11 ! 1;
                 nTRelacion = #dsm11101#11;
                 enBRela    = 0;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm11101Rel;
     #espejo1@#3006;
     ;
     #dsm11101#6, "A", #dsm11101#0, #dsm11101#1, 00, "";
     #dsm11101#6, "A", #dsm11101#0, #dsm11101#1, 99, "z";
     ;
     NULL, dsm11101Rel;
|FIN;

|PROCESO dsm11101;
     |SI #dsm11101#6 = "PASEANTERIOR";  |ACABA;  |FINSI;
     |SI #dsm11101#6 = "MANUAL      ";  |ACABA;  |FINSI;

     nSumaCampo1  = #dsm11101#12;
     nSumaCampo2  = #dsm11101#13;
     nSumaCampo3  = #dsm11101#14;
     nSumaCampo4  = #dsm11101#15 + #dsm11101#16;
     nSumaCampo5  = #dsm11101#16;

     nSumaCampo6  = #dsm11101#25;
     nSumaCampo7  = #dsm11101#26;
     nSumaCampo8  = #dsm11101#27;
     nSumaCampo9  = #dsm11101#28 + #dsm11101#29;
     nSumaCampo10 = #dsm11101#29;

     nSuma = nSumaCampo1 + nSumaCampo2 + nSumaCampo3 + nSumaCampo4 + nSumaCampo5;
     nSuma = nSuma       + nSumaCampo6 + nSumaCampo7 + nSumaCampo8 + nSumaCampo9;
     nSuma = nSuma       + #dsm11101#17 + #dsm11101#18 + #dsm11101#19 + #dsm11101#20;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     nImporte   = 0;
     enImporte1 = 0;
     enImporte2 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     #dsm19001#0  = #dsm11101#0;
     #dsm19001#1  = #dsm11101#1;
     #dsm19001#6  = #dsm11101#6;
     #dsm19001#7  = #dsm11101#7;

     #dsm19001#8  = #dsm11101#9;
     #dsm19001#9  = #dsm11101#10;
     enError = 1;
     enTRela = #dsm11101#11;
     enBRela = 0;
     nTRelacion = #dsm11101#11;
     |BUCLE dsm11101Rel;

     |HAZ GrabaDatosNif;

     #dsm19001#0  = #dsm11101#0;
     #dsm19001#1  = #dsm11101#1;
     #dsm19001#6  = #dsm11101#6;

     #dsm19001#0  = #dsm11101#0;
     #dsm19001#1  = #dsm11101#1;
     #dsm19001#2  = 99;
     #dsm19001#3  = 190;
     #dsm19001#4  = enComplem;
     #dsm19001#5  = 0;
     #dsm19001#6  = #dsm11101#6;
     #dsm19001#7  = #dsm11101#7;
     #dsm19001#8  = #dsm11101#9;
     #dsm19001#9  = #dsm11101#10;
     #dsm19001#10 = 0;
     |SI #dsm19001#8 = "A";  #dsm19001#10 = nTRelacion;  |FINSI;
     |LEE 101#dsm19001.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm19001;
         #dsm19001#0  = #dsm11101#0;
         #dsm19001#1  = #dsm11101#1;
         #dsm19001#2  = 99;
         #dsm19001#3  = 190;
         #dsm19001#4  = enComplem;
         #dsm19001#5  = 0;
         #dsm19001#6  = #dsm11101#6;
         #dsm19001#7  = #dsm11101#7;
         #dsm19001#8  = #dsm11101#9;
         #dsm19001#9  = #dsm11101#10;
         #dsm19001#10 = 0;
         |SI #dsm19001#8 = "A";  #dsm19001#10 = nTRelacion;  |FINSI;

         eaCodNif = #dsm19001#6;
         |HAZ LeeNifs;

         #dsm19001#12 = #regisnif@#1;
         #dsm19001#13 = #regisnif@#4;

         |HAZ CalculaDatosNif;

         |HAZ BuscaRepre;

         nSw = 0;
         |SI #dsm19001#8 ! "A"; |Y #dsm19001#8 ! "B";  |Y #dsm19001#8 ! "C";
                nSw = 1;
         |FINSI;
         |SI #dsm19001#8 = "B"; |Y #dsm19001#9 = "02";
             nSw = 1;
         |FINSI;

         |SI nSw = 1;
             #dsm19001#14 = 0;  #dsm19001#21 = 0;  #dsm19001#22 = 0;  #dsm19001#23 = 0;
             #dsm19001#24 = 0;  #dsm19001#25 = 0;  #dsm19001#26 = 0;

             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm19001#nCampoD# = 0;
             |SIGUE;

             |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm19001#nCampoD# = 0;
             |SIGUE;

             |PDEFECTO #dsm19001,61,65;
         |FINSI;

         |SI #dsm19001#26 ! 2;
             #dsm19001#27 = "";
         |FINSI;

         |GRABA 020#dsm19001.b;
     |FINSI;

     nSw = 0;
     |SI #dsm19001#8 ! "A"; |Y #dsm19001#8 ! "B";  |Y #dsm19001#8 ! "C";
           nSw = 1;
     |FINSI;
     |SI #dsm19001#8 = "B"; |Y #dsm19001#9 = "02";
          nSw = 1;
     |FINSI;
     |SI enMasivo = 0;
         |SI nSw = 0;
             |SI #dsm19001#14 = 0;  |O #dsm19001#26 = 0;
                 aVariable = "NIF : " + #dsm19001#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                 |SI nLaImpresora = 0;
                     |HAZ LaImprMas2016;
                 |FINSI;

                 |IMPRIME aVariable;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nSw = 0;
             |SI #dsm19001#14 = 0;  |O #dsm19001#26 = 0;
                 aVariable = "NIF : " + #dsm19001#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                 |HAZ GrabaError2016;
             |FINSI;
         |FINSI;
     |FINSI;

     #dsm19001#16 = #dsm19001#16 + nSumaCampo1;
     #dsm19001#17 = #dsm19001#17 + nSumaCampo2;
     #dsm19001#18 = #dsm19001#18 + nSumaCampo3;
     #dsm19001#19 = #dsm19001#19 + nSumaCampo4;
     #dsm19001#20 = #dsm19001#20 + nSumaCampo5;

     #dsm19001#65 = #dsm19001#65 + nSumaCampo6;
     #dsm19001#66 = #dsm19001#66 + nSumaCampo7;
     #dsm19001#67 = #dsm19001#67 + nSumaCampo8;
     #dsm19001#68 = #dsm19001#68 + nSumaCampo9;
     #dsm19001#69 = #dsm19001#69 + nSumaCampo10;

     |SI #dsm19001#20 > #dsm19001#19;
         #dsm19001#20 = #dsm19001#19;
     |FINSI;

     |SI #dsm19001#69 > #dsm19001#68;
         #dsm19001#69 = #dsm19001#68;
     |FINSI;

     |SI #dsm11101#5 ! 99;
         |SI enImporte1 ! 0; |O enImporte3 ! 0; |O enImporte4 ! 0;
             #dsm19001#21 = enImporte1;
             #dsm19001#23 = enImporte3;
             #dsm19001#24 = enImporte4;
         |SINO;
             #dsm19001#21 = #dsm19001#21 + #dsm11101#17;
             #dsm19001#23 = #dsm19001#23 + #dsm11101#19;
             #dsm19001#24 = #dsm19001#24 + #dsm11101#20;
         |FINSI;

         #dsm19001#22 = #dsm19001#22 + #dsm11101#18;

         nSw = 0;
         |SI #dsm19001#8 ! "A";  |Y #dsm19001#8 ! "B";
              |Y #dsm19001#8 ! "C"; |Y #dsm19001#8 ! "E";
                 nSw = 1;
         |FINSI;
         |SI #dsm19001#8 = "E";
             |SI #dsm19001#9 ! "01"; |Y #dsm19001#9 ! "02";
                 nSw = 1;
             |FINSI;
         |FINSI;
         |SI #dsm19001#8 = "B"; |Y #dsm19001#9 = "02";
             nSw = 1;
         |FINSI;

         |SI nSw = 1;
              nImporte =  0;
         |SINO;
              nImporte = #dsm19001#22;
              |SI #dsmom107#21 = "S";
                  nOpera = 2;
                  |HAZ GraboAux2016;
              |FINSI;
         |FINSI;
     |FINSI;

     nImporte = #dsm19001#22;
     nSw = 0;
     |SI #dsm19001#8 ! "A"; |Y #dsm19001#8 ! "B";  |Y #dsm19001#8 ! "C";
           nSw = 1;
     |FINSI;
     |SI #dsm19001#8 = "B"; |Y #dsm19001#9 = "02";
          nSw = 1;
     |FINSI;

     |SI nSw = 1;
         #dsm19001#14 = 0;
         #dsm19001#21 = 0;
         #dsm19001#22 = 0;
         #dsm19001#23 = 0;
         #dsm19001#24 = 0;
         #dsm19001#25 = 0;
         #dsm19001#26 = 0;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm19001#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm19001#nCampoD# = 0;
         |SIGUE;

         |PDEFECTO #dsm19001,61,65;
     |FINSI;
     |SI #dsm19001#8 = "E";
         |SI #dsm19001#9 = "01"; |O #dsm19001#9 = "02";
             #dsm19001#22 = nImporte;
         |FINSI;
     |FINSI;

     |SI #dsm19001#16 ! 0; |O #dsm19001#17 ! 0; |O #dsm19001#18 ! 0;
         |O #dsm19001#19 ! 0; |O #dsm19001#20 ! 0; |O #dsm19001#21 ! 0;
           |O #dsm19001#22 ! 0; |O #dsm19001#23 ! 0; |O #dsm19001#24 ! 0;
             |O #dsm19001#22 ! 0; |O #dsm19001#23 ! 0; |O #dsm19001#24 ! 0;
               |O #dsm19001#65 ! 0; |O #dsm19001#66 ! 0; |O #dsm19001#67 ! 0;
                 |O #dsm19001#68 ! 0; |O #dsm19001#69 ! 0;
            |GRABA 020#dsm19001.a;
         nSwHay = 1;
     |SINO;
         |BORRA 020#dsm19001.a;
     |FINSI;
     |LIBERA #dsm19001;
|FPRC;

|DEFBUCLE dsm11101;
     #dsm11101#1;
     ;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nDComplem, 01, "            ", 0000, 00, " ", "  ", 0;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nHComplem, 99, "zzzzzzzzzzzz", 9999, 99, "z", "zz", 9;
     ;
     NULL, dsm11101;
|FIN;

|PROCESO dsm11101Reg;
     |SI #dsm11101#6 = "PASEANTERIOR";  |ACABA;  |FINSI;
     |SI #dsm11101#6 = "MANUAL      ";  |ACABA;  |FINSI;

     nSumaCampo1  = #dsm11101#12;
     nSumaCampo2  = #dsm11101#13;
     nSumaCampo3  = #dsm11101#14;
     nSumaCampo4  = #dsm11101#15 + #dsm11101#16;
     nSumaCampo5  = #dsm11101#16;

     nSumaCampo6  = #dsm11101#25;
     nSumaCampo7  = #dsm11101#26;
     nSumaCampo8  = #dsm11101#27;
     nSumaCampo9  = #dsm11101#28 + #dsm11101#29;
     nSumaCampo10 = #dsm11101#29;

     nSuma = nSumaCampo1 + nSumaCampo2 + nSumaCampo3 + nSumaCampo4;
     nSuma = nSuma       + nSumaCampo6 + nSumaCampo7 + nSumaCampo8 +  nSumaCampo9;
     nSuma = nSuma       + #dsm11101#17 + #dsm11101#18 + #dsm11101#19 + #dsm11101#20;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     nImporte   = 0;
     enImporte1 = 0;
     enImporte2 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     #dsm19001#0  = #dsm11101#0;
     #dsm19001#1  = #dsm11101#1;
     #dsm19001#6  = #dsm11101#6;
     #dsm19001#7  = #dsm11101#7;
     #dsm19001#8  = #dsm11101#9;
     #dsm19001#9  = #dsm11101#10;
     enError = 1;
     enTRela = #dsm11101#11;
     enBRela = 0;
     nTRelacion = #dsm11101#11;
     |BUCLE dsm11101Rel;

     |HAZ GrabaDatosNif;

     #dsm19001#0  = #dsm11101#0;
     #dsm19001#1  = #dsm11101#1;
     #dsm19001#6  = #dsm11101#6;

     nTRelacion = #dsm11101#11;
     |BUCLE dsm11101Rel;

     #dsm19001#0  = #dsm11101#0;
     #dsm19001#1  = #dsm11101#1;
     #dsm19001#2  = 99;
     #dsm19001#3  = 190;
     #dsm19001#4  = enComplem;
     #dsm19001#5  = 0;
     #dsm19001#6  = #dsm11101#6;
     #dsm19001#7  = #dsm11101#7;
     #dsm19001#8  = #dsm11101#9;
     #dsm19001#9  = #dsm11101#10;
     #dsm19001#10 = 0;
     |SI #dsm19001#8 = "A";  #dsm19001#10 = nTRelacion;  |FINSI;
     |LEE 101#dsm19001.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm19001;
         #dsm19001#0  = #dsm11101#0;
         #dsm19001#1  = #dsm11101#1;
         #dsm19001#2  = 99;
         #dsm19001#3  = 190;
         #dsm19001#4  = enComplem;
         #dsm19001#5  = 0;
         #dsm19001#6  = #dsm11101#6;
         #dsm19001#7  = #dsm11101#7;
         #dsm19001#8  = #dsm11101#9;
         #dsm19001#9  = #dsm11101#10;
         #dsm19001#10 = 0;
         |SI #dsm19001#8 = "A";  #dsm19001#10 = nTRelacion;  |FINSI;

         eaCodNif = #dsm19001#6;
         |HAZ LeeNifs;

         #dsm19001#12 = #regisnif@#1;
         #dsm19001#13 = #regisnif@#4;

         |HAZ CalculaDatosNif;

         |HAZ BuscaRepre;

         |SI #dsm19001#8 ! "A"; |Y #dsm19001#8 ! "B";  |Y #dsm19001#8 ! "C";  |Y #dsm19001#8 ! "D"; |Y #dsm19001#8 ! "E";
             #dsm19001#14 = 0;  #dsm19001#21 = 0;  #dsm19001#22 = 0;  #dsm19001#23 = 0;
             #dsm19001#24 = 0;  #dsm19001#25 = 0;  #dsm19001#26 = 0;

             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm19001#nCampoD# = 0;
             |SIGUE;

             |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm19001#nCampoD# = 0;
             |SIGUE;

             |PDEFECTO #dsm19001,61,65;
         |FINSI;

         |SI #dsm19001#26 ! 2;
             #dsm19001#27 = "";
         |FINSI;

         |GRABA 020#dsm19001.b;
     |SINO;
         enImporte1 = 0;
         enImporte2 = 0;
         enImporte3 = 0;
         enImporte4 = 0;
     |FINSI;

     #dsm19001#21 = #dsm19001#21 + #dsm11101#17 + enImporte1;
     #dsm19001#22 = #dsm19001#22 + #dsm11101#18 + enImporte2;
     #dsm19001#23 = #dsm19001#23 + #dsm11101#19 + enImporte3;
     #dsm19001#24 = #dsm19001#24 + #dsm11101#20 + enImporte4;

     |SI #dsm19001#8 ! "A"; |Y #dsm19001#8 ! "B";  |Y #dsm19001#8 ! "C";  |Y #dsm19001#8 ! "D"; |Y #dsm19001#8 ! "E";
         #dsm19001#14 = 0;
         #dsm19001#21 = 0;
         #dsm19001#22 = 0;
         #dsm19001#23 = 0;
         #dsm19001#24 = 0;
         #dsm19001#25 = 0;
         #dsm19001#26 = 0;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm19001#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm19001#nCampoD# = 0;
         |SIGUE;

         |PDEFECTO #dsm19001,61,65;
     |FINSI;
     |GRABA 020#dsm19001.a;
     |LIBERA #dsm19001;
     nSwHay = 1;

    |SI #dsmom107#21 = "S";
        nImporte = #dsm11101#18;
        nOpera   = 1;
        |HAZ GraboAux2016;
    |FINSI;
|FPRC;

|DEFBUCLE dsm11101Reg;
     #dsm11101#1;
     ;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nDComplem, 99, "            ", 0000, 00, " ", "  ", 0;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nHComplem, 99, "zzzzzzzzzzzz", 9999, 99, "z", "zz", 9;
     ;
     NULL, dsm11101Reg;
|FIN;

|PROCESO LaImprMas2016;
     |SI enMasivo = 0; |Y nLaImpresora = 0;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nLaImpresora = 1;
     |FINSI;
|FPRC;

|PROCESO Pase190_2016;
     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     aFichero = ("x" + Usuario) % 108;
     |NOME_DAT #dsmow107#aFichero#;
     |DELINDEX #dsmow107;

     nLaImpresora = 0;
     enNumError   = 0;

     |ABRE #dsmom004;
     #dsmom004#0 = #dsmow013#0;
     #dsmom004#1 = #dsmow013#2;
     #dsmom004#2 = #dsmow013#3;
     #dsmom004#3 = #dsmow013#7;
     #dsmom004#4 = #dsmow013#9;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;
         |CIERRA #dsmom004;
         |ACABA;
     |FINSI;
     |CIERRA #dsmom004;

     enSwPartir    = 0;
     enEmpresa     = #dsmow013#0;
     enEjer        = #dsmow013#2;
     enPeriodo     = #dsmow013#3;
     enModelo      = #dsmow013#7;
     enComplem     = #dsmom004#4;
     enActividad   = 0;
     enTipoEntrada = 3;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm190ca";

     |ABRE #dsm19001;
     |ABRE #dsmow107;

     |DBASE aPathModelo;  |QBT aPathModelo;
     aDef = aPathModelo + "def/dsm11101.mas";
     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = aPathModelo + "def/dsm19001.mas";
     |CARGA_DEF aDef, dsm190co@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #espejo1@;
         |ACABA;
     |FINSI;

     aFichero = "9y" + Usuario;
     |NOME_DAT #dsm190co@#aFichero#;
     |DELINDEX #dsm190co@;

     enSwPartir = 0;
     |PARA Periodo = 1;  |SI Periodo [ 12;  |HACIENDO Periodo = Periodo + 1;
           nDComplem = -1;
           |ABRE #dsm11101;
           |DDEFECTO #dsm11101;
           #dsm11101#0 = #dsmow013#0;
           #dsm11101#1 = #dsmow013#2;
           #dsm11101#2 = Periodo
           #dsm11101#3 = 110;
           #dsm11101#4 = 99;
           |LEE 040#dsm11101.];
           |SI FSalida = 0;
               |LEE 040#dsm11101.a;
           |SINO;
               |LEE 040#dsm11101.u;
           |FINSI;
           |SI FSalida = 0; |Y #dsm11101#0 = #dsmow013#0; |Y #dsm11101#1 = #dsmow013#2;
                            |Y #dsm11101#2 = Periodo; |Y #dsm11101#3 = 110;
               nDComplem = #dsm11101#4;
               nHComplem = #dsm11101#4;
           |FINSI;
           |CIERRA #dsm11101;

           |SI nDComplem ] 0;
               |ABRE #dsm190co@;
               |BUCLE dsm11101;
               |BUCLE dsm11101Reg;
               |CIERRA #dsm190co@;
           |FINSI;
     |SIGUE;

     |DESCARGA_DEF #dsm190co@;
     |DESCARGA_DEF #espejo1@;

     |CIERRA #dsmow107;
     |CIERRA #dsm19001;

     |SI nSwHay = 0;
         |SI enMasivo = 0;
             |MENAV "      Seleccion Vacia";
             |CONFI "0000NDesea Crear el Modelo sin Actividad ";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |SINO;
             |ACABA;
         |FINSI;
     |FINSI;

     enEmpresa     = #dsmow013#0;
     enEjer        = #dsmow013#2;
     enPeriodo     = #dsmow013#3;
     enModelo      = #dsmow013#7;
     enComplem     = #dsmom004#4;
     enActividad   = 0;
     enTipoEntrada = 98;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm190ca";

     |ABRE #dsmom004;
     #dsmom004#0 = #dsmow013#0;
     #dsmom004#1 = #dsmow013#2;
     #dsmom004#2 = #dsmow013#3;
     #dsmom004#3 = #dsmow013#7;
     #dsmom004#4 = #dsmow013#9;
     |LEE 101#dsmom004.=;
     |SI FSalida = 0;
         #dsmom004#7  = "X";
         #dsmom004#8  = ~;
         #dsmom004#15 = 0;
         #dsmom004#17 = "COMPLETADO";

         |GRABA 020#dsmom004.a;
         |LIBERA #dsmom004;
     |FINSI;
     |CIERRA #dsmom004;

     |SI enMasivo = 0; |Y nLaImpresora = 1;
         |FINIMP;
     |FINSI;
     |DELINDEX #dsmow107;
|FPRC;
