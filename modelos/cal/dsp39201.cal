|FICHEROS;
     dsmozpas #0;
     dsmom004 #4;
     dsmom008 #8;

     dsmom047 #47;
     dsmom080 #80;
     dsmom081 #81;
     dsmom082 #82;
     dsmom083 #83;

     dsmod320 #320;
     dsmod332 #332;

     dsm39201 #390;
     dsm39202 #490;
     dsm39203 #590;
     dsm39204 #690;
     dsmociva #300;
     dsmocivp #165;

     dsmow013 #999;
|FIN;

|VARIABLES;
     nCampo1      = 0;
     nCampo2      = 0;
     nCampo3      = 0;
     nCampo4      = 0;
     nCampo5      = 0;
     nCampo6      = 0;
     nCampo11     = 0;
     nCampo22     = 0;
     nCampo33     = 0;
     nSwAcum      = 0;
     nAtri        = 0;
     nContAtri    = 0;
     nError       = 0;
     nLinea       = 0;
     nPeriodo     = 0;
     nCampo       = 0;
     nCodigo      = 0;
     nTotal       = 0;
     nNume        = 0;
     nResta       = 0;
     nT300C       = 0;
     nT300C1      = 0;
     nT300C2      = 0;
     nT300C3      = 0;
     nT300C4      = 0;
     nT300C5      = 0;
     nT300C6      = 0;
     nT300C7      = 0;
     nT300C8      = 0;
     nT300C9      = 0;
     nT300C11     = 0;

     aAlfa        = "";
     nBaseMas     = 0;
     nCuotaMas    = 0;
     nLaPro       = 0;
     nProrraDif   = 0;
     nPro  = 0;
     nSwP0 = 0; nSwP1 = 0; nSwP2 = 0; nSwP3 = 0;
     nSwP4 = 0; nSwP5 = 0; nSwP6 = 0; nSwP7 = 0;
     nM = 0;
     nErrorSinImporte = 0;

     aCNAE   = "";
     nSwEsta = 0;
     nPara1  = 0;
     nQuants = 0;
     nPrim   = 0;
     nT7     = 0;
     nT9     = 0;
     nSwLimpio = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO GrabaIVA392;
     nLaPro    = nProrrata;
     nProrrata = 100;

     |SI #300#6 = 2;  |Y #300#7 ! 8; |Y #300#7 ! 11;
         |SI enEjer ] enEjerPro; |Y #300#2 = 12;
             |SI eaProrrat = "E";
                 enActividad = #300#5;
               ||  |HAZ eLeeLaProEsp;
             |SINO;
                 nProrrata = nLaPro;
             |FINSI;
         |SINO;
             |SI #300#3 = 320;
                 |ABRE #320;
                 #320#0 = #300#0;
                 #320#1 = #300#1;
                 #320#2 = #300#2;
                 #320#3 = #300#3;
                 #320#4 = #300#4;
                 #320#5 = 0;
                 |LEE 040#320=;
                 |SI FSalida ! 0;  |DDEFECTO #320;  |FINSI;
                 |CIERRA #320;

                 nProrrata = #320#68;
             |FINSI;

             |SI #300#3 = 332;
                 |ABRE #332;
                 #332#0 = #300#0;
                 #332#1 = #300#1;
                 #332#2 = #300#2;
                 #332#3 = #300#3;
                 #332#4 = #300#4;
                 #332#5 = 0;
                 |LEE 040#332=;
                 |SI FSalida ! 0;  |DDEFECTO #332;  |FINSI;
                 |CIERRA #332;

                 nProrrata = #332#70;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #300#6 = 2;  |Y #300#7 = 5;  nProrrata = 100;  |FINSI;
     |SI #300#6 = 2;  |Y #300#7 = 6;  nProrrata = 100;  |FINSI;
     |SI #300#6 = 2;  |Y #300#7 ] 11;  nProrrata = 100;  |FINSI;

     |SI #300nCampo2 = 0;
         |SI #300nCampo1 ! 0;  |O #300nCampo3 ! 0;
             #490#21 = #490#21 + #300nCampo1;
             #490#22 = -1;
             #490#23 = #490#23 + (#300nCampo3 % nProrrata) + #165nCampo5;
             nProrraDif = nProrrata;
             nProrrata  = nLaPro;
             |ACABA;
         |FINSI;
     |FINSI;

     nSwAcum = 0;
     |PARA nCampo11  = 12;  |SI nCampo11 [ 21;  |HACIENDO nCampo11 = nCampo11 + 3;
           nCampo22 = nCampo11 + 1;
           nCampo33 = nCampo11 + 2;

           |SI #490nCampo22 = #300nCampo2;
               #490nCampo11 = #490nCampo11 + #300nCampo1;
               #490nCampo33 = #490nCampo33 + (#300nCampo3 % nProrrata) + #165nCampo5;
               nSwAcum = 1;
               |SAL;
            |FINSI;
     |SIGUE;

     |SI nSwAcum = 0;
         |PARA nCampo11  = 12;  |SI nCampo11 [ 21;  |HACIENDO nCampo11 = nCampo11 + 3;
               nCampo22 = nCampo11 + 1;
               nCampo33 = nCampo11 + 2;
               |SI #490nCampo22 = 0;
                   #490nCampo11 = #300nCampo1;
                   #490nCampo22 = #300nCampo2;
                   #490nCampo33 = (#300nCampo3 % nProrrata) + #165nCampo5;
                   nSwAcum = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwAcum = 0;
         #490#21 = #490#21 + #300nCampo1;
         #490#22 = -1;
         #490#23 = #490#23 + (#300nCampo3 % nProrrata) + #165nCampo5;
     |FINSI;

     nProrraDif = nProrrata;
     nProrrata  = nLaPro;
|FPRC;

|PROCESO LeeRestoPror_392;
  |DDEFECTO #165;

  nBaseMas = 0;
  nCuotaMas = 0;
  |SI #300#6 = 2;
      |SI #300#7 ! 5; |Y #300#7 ! 6;
          |ABRE #165;
          #165#0 = #300#0;
          #165#1 = #300#1;
          #165#2 = #300#2;
          #165#3 = #300#3;
          #165#4 = #300#4;
          #165#5 = #300#5;
          #165#6 = #300#6;
          #165#7 = #300#7;
          |LEE 001#165=;
          |SI FSalida = 0;
              nBaseMas  = #165#10 + #165#13 + #165#16 + #165#19;
              nCuotaMas = #165#12 + #165#15 + #165#18 + #165#21;
          |FINSI;
          |CIERRA #165;
      |FINSI;
      |SI enEjer ] enEjerPro;
          nCuotaMas = 0;
         |SI eaDesg109 = "S";
             |SI #300#7 = 1; |Y nSwP1 = 0; nCuotaMas = - enImpProrrat1; nSwP1 = 1; |FINSI;
             |SI #300#7 = 2; |Y nSwP2 = 0; nCuotaMas = - enImpProrrat2; nSwP2 = 1; |FINSI;
             |SI #300#7 = 3; |Y nSwP3 = 0; nCuotaMas = - enImpProrrat3; nSwP3 = 1; |FINSI;
             |SI #300#7 = 4; |Y nSwP4 = 0; nCuotaMas = - enImpProrrat4; nSwP4 = 1; |FINSI;
             |SI #300#7 = 5; |Y nSwP5 = 0; nCuotaMas = - enImpProrrat5; nSwP5 = 1; |FINSI;
             |SI #300#7 = 6; |Y nSwP6 = 0; nCuotaMas = - enImpProrrat6; nSwP6 = 1; |FINSI;
             |SI #300#7 = 7; |Y nSwP7 = 0; nCuotaMas = - enImpProrrat7; nSwP7 = 1; |FINSI;
         |SINO;
             |SI #300#7 = 1; |Y nSwP0 = 0; nCuotaMas = - enImpProrrata; nSwP0 = 1; |FINSI;
         |FINSI;
         #165#9  = 0;
         #165#12 = nCuotaMas;
         |SI nCuotaMas ! 0;
             #165#9 = nCuotaMas;
         |FINSI;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO LeeEl47_392;
     |ABRE #47;
     #47#0 = enEmpresa;
     #47#1 = enEjer;
     #47#2 = nPeriodo;
     #47#3 = nM;
     #47#4 = 0;
     #47#5 = 0;
     |LEE 040#47=;
     |SI FSalida ! 0;
         |DDEFECTO #47;
         |CIERRA #47;
         |ACABA;
     |FINSI;
     |CIERRA #47;
     enImpProrrat1 = enImpProrrat1 + #47#6;
     enImpProrrat2 = enImpProrrat2 + #47#7;
     enImpProrrat3 = enImpProrrat3 + #47#8;
     enImpProrrat4 = enImpProrrat4 + #47#9;
     enImpProrrat5 = enImpProrrat5 + #47#10;
     enImpProrrat6 = enImpProrrat6 + #47#11;
     enImpProrrat7 = enImpProrrat7 + #47#12;
     enImpProrrata = enImpProrrata + (#47#6 + #47#7 + #47#8 + #47#9 + #47#10 + #47#11 + #47#12);
|FPRC;

|PROCESO Graba392_2;
     |SI #300#6 = 2;  |Y #300#7 = 11;  |Y #390#1 ] 2008;
         |ACABA;
     |FINSI;

     |SI #300#6 = 2;  |Y #300#7 = 12;  |Y #390#1 ] 2008;
         |ACABA;
     |FINSI;

     |HAZ LeeRestoPror_392;
     |SI #300#12 ! 0;  |O #300#13 ! 0; |O nCuotaMas ! 0;
         #490#0 = #390#0;
         #490#1 = #390#1;
         #490#2 = #390#2;
         #490#3 = #390#3;
         #490#4 = #300#6;
         #490#5 = #300#7;
         |LEE 101#490=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #490#4 = 5;  |Y #490#5 = 1;
             nAtri     = nAtri     + #490#10;
             nContAtri = nContAtri + 1;
             #490#10   = nAtri / nContAtri;
             |SI #490#10 ! 100;
                 #390#15 = #490#10;
             |FINSI;
         |SINO;
             |PARA nCampo1 = 14;  |SI nCampo1 [ 23;  |HACIENDO nCampo1 = nCampo1 + 3;
                   nCampo2 = nCampo1 + 1;
                   nCampo3 = nCampo1 + 2;
                   nCampo4 = nCampo1 - 4;
                   nCampo5 = nCampo3 - 4;
                   |SI #300nCampo1 ! 0;  |O #300nCampo2 ! 0;  |O #300nCampo3 ! 0;
                       |O #165nCampo4 ! 0; |O #165nCampo5 ! 0;
                       |HAZ GrabaIVA392;
                   |FINSI;
             |SIGUE;

             |SI #300#6 = 2;  |Y #300#7 ! 10; |Y #300#7 ! 12;
                 |SI #300#13 ! 0; |Y #300#12 = 0; |Y #300#7 < 8;
                      nErrorSinImporte = 1;
                 |FINSI;
                 |SI #300#6 = 2;  |Y #300#7 = 1;
                     nT300C1 = nT300C1 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 2;
                     nT300C2 = nT300C2 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 3;
                     nT300C3 = nT300C3 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 4;
                     nT300C4 = nT300C4 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 5;
                     nT300C5 = nT300C5 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 6;
                     nT300C6 = nT300C6 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 7;
                     nT300C7 = nT300C7 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 8;
                     nT300C8 = nT300C8 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 9;
                     nT300C9 = nT300C9 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 |SI #300#6 = 2;  |Y #300#7 = 11;
                      nT300C11 = nT300C11 + (((#300#13 % nProrraDif) ! 2) + #165#9) ! 2;
                 |FINSI;

                 #490#11 = #490#14 + #490#17 + #490#20 + #490#23;

                 nT300C  = 0;

                 |SI #300#7 = 1;   nT300C = nT300C1;   |FINSI;
                 |SI #300#7 = 2;   nT300C = nT300C2;   |FINSI;
                 |SI #300#7 = 3;   nT300C = nT300C3;   |FINSI;
                 |SI #300#7 = 4;   nT300C = nT300C4;   |FINSI;
                 |SI #300#7 = 5;   nT300C = nT300C5;   |FINSI;
                 |SI #300#7 = 6;   nT300C = nT300C6;   |FINSI;
                 |SI #300#7 = 7;   nT300C = nT300C7;   |FINSI;
                 |SI #300#7 = 8;   nT300C = nT300C8;   |FINSI;
                 |SI #300#7 = 9;   nT300C = nT300C9;   |FINSI;
                 |SI #300#7 = 11;  nT300C = nT300C11;  |FINSI;

                 nResta = nT300C - #490#11;
                 |SI nResta ! 0;
                     |PARA nCampo11  = 14;  |SI nCampo11 [ 23;  |HACIENDO nCampo11 = nCampo11 + 3;
                           |SI #490nCampo11 ! 0;
                               #490nCampo11 = #490nCampo11 + nResta;
                               |SAL;
                           |FINSI;
                     |SIGUE;
                 |FINSI;
             |FINSI;

             |PARA nCampo1 = 13;  |SI nCampo1 [ 22;  |HACIENDO nCampo1 = nCampo1 + 3;
                   |SI #490nCampo1 = -1;  #490nCampo1 = 0;  |FINSI;
             |SIGUE;

             |SI #490#12 ! 0;  |O #490#15 ! 0;  |O #490#18 ! 0;  |O #490#21 ! 0;
                 #490#10 = #490#12 + #490#15 + #490#18 + #490#21;
                 #490#11 = #490#14 + #490#17 + #490#20 + #490#23;
             |SINO;
                 #490#10 = #490#10 + #300#12;
                 #490#11 = #490#11 + #300#13;
             |FINSI;
         |FINSI;

         |GRABA 020#490a;
         |LIBERA #490;
     |FINSI;
|FPRC;

|DEFBUCLE dsmociva392;
     #300#1;
     ;
     #4#0, #4#1, #4#2, #4#3, 00, 01, 0,  0;
     #4#0, #4#1, #4#2, #4#3, 99, 99, 9, 99;
     be;
     NULL, Graba392_2;
|FIN;

|PROCESO BorraVarDed392;
     nT300C    = 0;
     nT300C1   = 0;
     nT300C2   = 0;
     nT300C3   = 0;
     nT300C4   = 0;
     nT300C5   = 0;
     nT300C6   = 0;
     nT300C7   = 0;
     nT300C8   = 0;
     nT300C9   = 0;
     nT300C11  = 0;
|FPRC;

|PROCESO Errores392;
     enEmpresa     = #999#0;
     enEjer        = #999#2;
     enModelo      = #999#7;
     enComplem     = #4#4;
     enTipoEntrada = 3;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm39201";

     |ABRE #4;
     #4#0 = #999#0;
     #4#1 = #999#2;
     #4#2 = #999#3;
     #4#3 = #999#7;
     #4#4 = #999#9;
     |LEE 101#4=;
     |SI FSalida = 0;
         #4#7  = " ";
         #4#8  = ~;
         #4#15 = 0;
         #4#17 = "SIN DATOS";

         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Saca320;
     #390#7  = #390#7 + #320#67;

     |SI #320#2 = 12;
         #390#9  = #390#9  + #320#65;
         #390#10 = #390#10 + #320#66;
     |FINSI;
|FPRC;

|DEFBUCLE dsmod320;
     #320#1;
     ;
     #4#0, #4#1, #4#2, #4#3, 00, 00;
     #4#0, #4#1, #4#2, #4#3, 99, 99;
     ;
     NULL, Saca320;
|FIN;

|PROCESO Saca332;
     #390#7  = #390#7 + #332#69;
     #390#8  = #390#8 + #332#68;

     |SI #332#2 = 12;
         #390#9  = #390#9  + #332#67;
         #390#10 = #390#10 + #332#68;
     |FINSI;
|FPRC;

|DEFBUCLE dsmod332;
     #332#1;
     ;
     #4#0, #4#1, #4#2, #4#3, 00, 00;
     #4#0, #4#1, #4#2, #4#3, 99, 99;
     ;
     NULL, Saca332;
|FIN;

|PROCESO ControlaRegGeneral392;
     |HAZ BorraVarDed392;

     |ABRE #490;
     |PARA nPeriodo = 1; |SI nPeriodo [ 12;  |HACIENDO nPeriodo = nPeriodo + 1;
           nError = 0;
           nErrorSinImporte = 0;
           #4#0   = #390#0;
           #4#1   = #390#1;
           #4#2   = nPeriodo;
           #4#3   = 320;
           #4#4   = 0;
           |LEE 040#4=;
           |SI FSalida = 0;
               |SI #4#7 = "X";  |Y #4#9 ! "X";  |Y enSwCheq390 = 0;
                   nError = 1;
               |SINO;
                  enPeriodo = nPeriodo;
                  enSwCompensa = 1; |HAZ  eLeeLaProrrata; enSwCompensa = 0;
                  nPro = nProrrata; |SI enEjer ] enEjerPro; nProrrata = 100; |FINSI;
                  nSwP0 = 0; nSwP1 = 0; nSwP2 = 0; nSwP3 = 0;
                  nSwP4 = 0; nSwP5 = 0; nSwP6 = 0; nSwP7 = 0;
                  nM=320;  |HAZ LeeEl47_392;
                  |BUCLE dsmociva392;
                  |BUCLE dsmod320;
               |FINSI;
           |SINO;
               nError = 2;
           |FINSI;

           |SI nError = 1;
               aAlfa = "    Modelos sin Imprimir, Empresa = " + #4#0 + ", Pase Abortado";
               |MENAV aAlfa;
               |SAL;
           |FINSI;
           |SI nErrorSinImporte = 1;
               aAlfa = "    Atencion. Faltan bases de IVA Soportado en el Periodo = " + nPeriodo + " de la Empresa = " + #4#0;
               |MENAV aAlfa;
           |FINSI;

           nError = 0;
           #4#0   = #390#0;
           #4#1   = #390#1;
           #4#2   = nPeriodo;
           #4#3   = 332;
           #4#4   = 0;
           |LEE 040#4=;
           |SI FSalida = 0;
               |SI #4#7 = "X";  |Y #4#9 ! "X";  |Y enSwCheq390 = 0;
                   nError = 1;
               |SINO;
                   enPeriodo = nPeriodo;
                   enSwCompensa = 1; |HAZ  eLeeLaProrrata; enSwCompensa = 0;
                   nPro = nProrrata; |SI enEjer ] enEjerPro; nProrrata = 100; |FINSI;
                   nSwP0 = 0; nSwP1 = 0; nSwP2 = 0; nSwP3 = 0;
                   nSwP4 = 0; nSwP5 = 0; nSwP6 = 0; nSwP7 = 0;
                   nM = 332; |HAZ LeeEl47_392;
                   |BUCLE dsmociva392;
                   |BUCLE dsmod332;
               |FINSI;
           |FINSI;

           |SI nError = 1;
               aAlfa = "    Modelos sin Imprimir, Empresa = " + #4#0 + ", Pase Abortado";
               |MENAV aAlfa;
               |SAL;
           |FINSI;
     |SIGUE;
     |CIERRA #490;
|FPRC;

||///////////////////////////
|| ..........Todo Lineal de Prorratas

|PROCESO Resto690_392;
 |SI nSwLimpio = 0;
     |SI nPrim ! #690#4;
         nT9 = (nT9 - #690#7) ! EURODBMOD;
         nT7 = (nT7 - #690#8) ! EURODBMOD;
     |FINSI;
 |SINO;
     |SI #690#10 = 100;
         |BORRA 020#690a;
     |FINSI;
 |FINSI;
 |LIBERA #690;
|FPRC;

|DEFBUCLE Resto690_392;
 #690#1;
 ;
 enEmpresa, enEjer, #390#2, #390#3, 01;
 enEmpresa, enEjer, #390#2, #390#3, 98;
 ;
 NULL, Resto690_392;
|FIN;

|PROCESO GraboUna_392;
 |ABRE #690;
 |DDEFECTO #690;
 #690#0 = enEmpresa;
 #690#1 = enEjer;
 #690#2 = #390#2;
 #690#3 = #390#3;
 #690#4 = nPrim;
 |LEE 101#690=;
 |SI FSalida ! 0;
     |DDEFECTO #690;
     #690#0 = enEmpresa;
     #690#1 = enEjer;
     #690#2 = #390#2;
     #690#3 = #390#3;
     #690#4 = nPrim;
     |GRABA 020#690b;
 |FINSI;

 |SI aCNAE ! ""; |Y #690##6 = "     "; #690#6 = aCNAE; |FINSI;
 |SI nT9 ! #690#7; |O nT7 ! #690#8;
     #690#10 = #80#32;  || % prorrata
 |FINSI;
 #690#7  = nT9;     || Totales
 #690#8  = nT7;     || Con derecho a deducir

 |GRABA 020#690a;
 |CIERRA #690;
|FPRC;

|PROCESO ComprueboEsta_392;
  nSwEsta = 0;
  |PARA nPara1 = 23;  |SI nPara1 [ 43;  |HACIENDO nPara1 = nPara1 + 4;
        |SI #390nPara1 = #81#2;
            nSwEsta = 1;
            |SAL;
        |FINSI;
  |SIGUE;
|FPRC;

|PROCESO Leem81_392;

 |DDEFECTO #690;
 #690#0 = enEmpresa;
 #690#1 = enEjer;
 #690#2 = #390#2;
 #690#3 = #390#3;
 #690#4 = #81#2;
 |LEE 101#690=;
 |SI FSalida ! 0;
     |DDEFECTO #690;
     #690#0 = enEmpresa;
     #690#1 = enEjer;
     #690#2 = #390#2;
     #690#3 = #390#3;
     #690#4 = #81#2;
     #690#5 = #81#3;
     #690#6 = #81#4;
     |GRABA 020#690b;
 |FINSI;

 |SI aCNAE = ""; |Y #81#4 ! "     ";
     aCNAE = #81#4;
 |FINSI;
 |SI aCNAE ! ""; |Y #81#4 = "     ";
     #81#4 = aCNAE;
 |FINSI;

 #690#7  = #81#9;  || Totales
 #690#8  = #81#7;  || Con derecho a deducir
 #690#9  = #80#4;  || tipo prorrata
 #690#10 = #81#6;  || % prorrata

 |SI #81#2 = 0;
     |BORRA 020#690a;
     |LIBERA #690;
     |ACABA;
 |FINSI;

 |SI #81#2 = 99;
     |SI #690#7 = 0; |Y #690#8 = 0;
         |BORRA 020#690a;
     |SINO;
         |GRABA 020#690a;
     |FINSI;
     |LIBERA #690;
     |ACABA;
 |FINSI;

 |HAZ ComprueboEsta_392;
 |SI enAdTodas = 1;
     |SI nSwEsta = 0;
         |BORRA 020#690a;
         |LIBERA #690;
         |ACABA;
     |FINSI;
 |FINSI;

 |GRABA 020#690a;
 |LIBERA #690;

 nQuants = nQuants + 1;
 |SI nPrim = 0; nPrim = #81#2; |FINSI;
|FPRC;

|DEFBUCLE Leem81_392;
 #81#1;
 ;
 #80#0, #80#1, 00;
 #80#0, #80#1, 99;
 ;
 NULL, Leem81_392;
|FINSI;

|PROCESO CreaLinProrr392;
 aCNAE = "";
 |ABRE #80;
 #80#0 = enEmpresa;
 #80#1 = enEjer;
 |LEE 040#80=;
 |SI FSalida ! 0;
     |CIERRA #80;
     |ACABA;
 |FINSI;
 |CIERRA #80;
 |SI #80#4 = "N"; |ACABA; |FINSI;
 |SI #80#4 = "G"; |Y #80#5 = 100; |ACABA; |FINSI;
 nQuants = 0;
 nPrim   = 0;
 |ABRE #690;
 |BUCLE Leem81_392;
 |CIERRA #690;

 |SI #80#4 = "E"; |Y nQuants ! 0;
     nT7 = #80#6;
     nT9 = #80#8;
     |SI nQuants = 1;
         |HAZ GraboUna_392;
     |SINO;
         |BUCLE Resto690_392;
         |HAZ GraboUna_392;
     |FINSI;
     |SI enAdTodas = 1;
         nSwLimpio = 1;
         |BUCLE Resto690_392;
         nSwLimpio = 0;
     |FINSI;
 |FINSI;
|FPRC;
||////////////////////////////////////


|PROCESO Pase392;
     |ABRE #4;
     #4#0 = #999#0;
     #4#1 = #999#2;
     #4#2 = #999#3;
     #4#3 = #999#7;
     #4#4 = #999#9;
     |LEE 040#4=;
     |SI FSalida ! 0;  |CIERRA #4; |ACABA;   |FINSI;
     |CIERRA #4;

     enEmpresa     = #999#0;
     enEjer        = #999#2;
     enModelo      = #999#7;
     enComplem     = #4#4;
     enTipoEntrada = 3;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm39201";

     enTipoEntrada = 95;
     |SUB_EJECUTA_NP "dsm39201";

     |ABRE #390;
     #390#0  = enEmpresa;
     #390#1  = enEjer;
     #390#2  = enModelo;
     #390#3  = enComplem;
     |LEE 101#390=;
     |SI FSalida ! 0;  |CIERRA #390;  |ACABA;  |FINSI;

     |ABRE #4;

     nError    = 0;
     nAtri     = 0;
     nContAtri = 0;

     |HAZ ControlaRegGeneral392;
     |SI nError = 1;  |HAZ Errores392;  |ACABA;  |FINSI;

     |GRABA 020#390a;
     |LIBERA #390;
     |CIERRA #390;

     |HAZ CreaLinProrr392;

     |ABRE #4;
     #4#0 = #999#0;
     #4#1 = #999#2;
     #4#2 = #999#3;
     #4#3 = #999#7;
     #4#4 = #999#9;
     |LEE 040#4=;
     |SI FSalida ! 0;  |CIERRA #4; |ACABA;   |FINSI;
     |CIERRA #4;

     enEmpresa     = #999#0;
     enEjer        = #999#2;
     enModelo      = #999#7;
     enComplem     = #4#4;
     enTipoEntrada = 95;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm39201";

     |ABRE #4;
     #4#0 = #999#0;
     #4#1 = #999#2;
     #4#2 = #999#3;
     #4#3 = #999#7;
     #4#4 = #999#9;
     |LEE 101#4=;
     |SI FSalida = 0;
         #4#7  = "X";
         #4#8  = ~;
         #4#15 = 0;
         #4#17 = "COMPLETADO";

         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     |CIERRA #4;
|FPRC;
