|FICHEROS;
   dsmom162,MANTE;
|FIN;

|VARIABLES;
  fFecha  = @;
  aAlfa1  = "";
  aAlfa2  = "";
  aAlfa3  = "";
  nEjer   = 0;
  aQueQuiero  = "";
  aNumCampos  = "";
  nNumCampos  = 0;

  nCampo  = 0;
  nCampo0 = 0;
  nCampo1 = 0;
  nCampo2 = 0;
  nPara1  = 0;
  nNume1  = 0;

  aTipo   = "";
  swError = 0;
  aClave  = "";
|FIN;

|PROCESO LosParametros;
 aTipo = "I";
 |SI Campo > 55; aTipo = "G"; |FINSI;

 |SI Campo ] 1;   |Y Campo [ 11;  nCampo0 = 1;   |FINSI;
 |SI Campo ] 12;  |Y Campo [ 22;  nCampo0 = 12;  |FINSI;
 |SI Campo ] 23;  |Y Campo [ 33;  nCampo0 = 23;  |FINSI;
 |SI Campo ] 34;  |Y Campo [ 44;  nCampo0 = 34;  |FINSI;
 |SI Campo ] 45;  |Y Campo [ 55;  nCampo0 = 45;  |FINSI;

 |SI Campo ] 56;  |Y Campo [ 66;  nCampo0 = 56;  |FINSI;
 |SI Campo ] 67;  |Y Campo [ 77;  nCampo0 = 67;  |FINSI;
 |SI Campo ] 78;  |Y Campo [ 88;  nCampo0 = 78;  |FINSI;
 |SI Campo ] 89;  |Y Campo [ 99;  nCampo0 = 89;  |FINSI;
 |SI Campo ] 100; |Y Campo [ 110; nCampo0 = 100; |FINSI;

 nCampo1 = nCampo0 + 1;
 nCampo2 = nCampo0 + 10;
|FPRC;

|PROCESO VerClave;
     swError = 0;

     aAlfa1  = aClave; |QBF aAlfa1;
     |SI aAlfa1 = "";
         |MENAV "    Error. Clave en Blanco";
         swError = 1;
         |ACABA;
     |FINSI;

     aAlfa2 = aAlfa1 % 0;
     nNume1 = aAlfa2;
     |SI nNume1 ! 3;
         |MENAV "0000Error. Longitud de la Clave erronea";
         swError = 1;
         |ACABA;
     |FINSI;

    aAlfa1 = aClave % 101;
    aAlfa2 = aClave % 201;
    aAlfa3 = aClave % 301;

    |SI aAlfa1 ! aTipo; swError = 1; |FINSI;

    |SI Campo = nCampo0;
        |SI aAlfa2 ! "Y"; |Y aAlfa2 ! "X";
            swError = 1;
        |FINSI;
    |SINO;
        |SI aAlfa2 < "0"; |O aAlfa2 > "9";
            swError = 1;
        |FINSI;
    |FINSI;

    |SI aAlfa3 < "0"; |O aAlfa3 > "9";
        swError = 1;
    |FINSI;

    |SI swError = 1;
        |MENAV "    Clave Erronea ... ";
    |FINSI;
|FPRC;

|CALCULO SubGrupo; |TIPO 0;

  |HAZ LosParametros;

  aClave = #dsmom162#Campo#;
  |SI #dsmom162#Campo# ! "   ";
      |HAZ VerClave;
      |SI swError = 1;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;

  aAlfa1 = "S";
  |SI #dsmom162#Campo# = "   ";
      aAlfa1 = "N";
  |FINSI;
  |PARA nPara1 = nCampo1; |SI nPara1 [ nCampo2; |HACIENDO nPara1 = nPara1 + 1;
        |C_M #dsmom162#nPara1#,1,aAlfa1;
        |SI aAlfa1 = "N";
            #dsmom162#nPara1# = "";
            |PINTA #dsmom162#nPara1#;
        |FINSI;
  |SIGUE;
|FCAL;

|CALCULO Clave; |TIPO 0;
  |C_M #dsmom162#Campo#,0,aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |HAZ LosParametros;

  aClave = #dsmom162#Campo#;
  |SI #dsmom162#Campo# ! "   ";
      |HAZ VerClave;
      |SI swError = 1;
          |ERROR;
          |ACABA;
      |FINSI;
  |SINO;
      |SI Campo = nCampo1;
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;

  nCampo = Campo + 1;
  aAlfa1 = "S";
  |SI #dsmom162#Campo# = "   ";
      aAlfa1 = "N";
  |FINSI;
  |PARA nPara1 = nCampo; |SI nPara1 [ nCampo2; |HACIENDO nPara1 = nPara1 + 1;
        |C_M #dsmom162#nPara1#,1,aAlfa1;
        |SI aAlfa1 = "N";
            #dsmom162#nPara1# = "";
            |PINTA #dsmom162#nPara1#;
        |FINSI;
  |SIGUE;
|FCAL;

|PROCESO Baja162;
 |SI FSalida = "POSICION";
     #dsmom162#0 = nEjer;
 |SINO;
     #dsmom162#0 = 1990;
 |FINSI;
|FPRC;

|PROCESO Alta162;
     #dsmom162#0 = 2999;
|FPRC;

|PROGRAMA;
     fFecha = ~;
     aAlfa1 = fFecha;
     aAlfa1 = aAlfa1 % -104;
     nEjer  = 2019;

      aQueQuiero = "|NC";
      aNumCampos = #dsmom162#aQueQuiero#;
      nNumCampos = aNumCampos;
      nNumCampos = nNumCampos - 1;

     |CLS;
     |CABEZA "Control Emision Libros";

     |PINPA #0#dsmom162;
     |ENTLINEAL #1#dsmom162, -1, 2, 22, 0, Baja162, Alta162;
|FPRO;
