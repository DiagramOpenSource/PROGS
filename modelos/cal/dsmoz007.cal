|FICHEROS;
     dsmoz007 #0;
     dsmom004 #4;
     dsmom101 #101;
     dsmom102 #102;
     dsmom107;
     dsmod045 #45;
     dsmod309 #309;
     dsmo7201 #720;
     dsmo5831 #583;
     dsm182ca #182;

     :/basica/def/agitab99 #99;

     dsmow018 #999;

     &clientes@ #715;
|FIN;

|VARIABLES;
     nChequeo = 0;
     nAnyo    = 0;
     nMes     = 0;
     nSwPlan  = 0;

     nInkey       = 0;
     nAscii       = 0;
     nAsciiB      = 0;


     &enPeriodo = 0;
     &enEjer    = 0;
     &enArchi   = 0;
     &eaPass    = "";

     aHecho     = "";
     aImpreso   = "";
|FIN;

|INCLUYE i_varemi;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\

|PROCESO Modelo;
     |SI eaParametro = "311";  |O eaParametro = "311C";
      |O eaParametro = "371";  |O eaParametro = "371C";
         |ACABA;
     |FINSI;

     |ABRE #99;
     #99#0 = #0#0;
     |LEE 040#99=;
     |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
     |CIERRA #99;

     |SI #99#4 = "N";
         |SI #99#0 ! 180;  |Y #99#0 ! 190;  |Y #99#0 ! 390;  |Y #99#0 ! 193;
          |Y #99#0 ! 184;  |Y #99#0 ! 296;  |Y #99#0 ! 187;
             |MENAV "     Modelo sin Activar.";
             |ERROR;
         |FINSI;
     |FINSI;

     #0#4 = 0;
     |SI #0#0 = 180;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 184;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 187;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 190;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 193;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 296;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 390;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 392;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 347;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 720;  #0#4 = 99;  |FINSI;
     |SI #0#0 = 182;  #0#4 = 99;  |FINSI;

     |SI #0#4 = 99;
         |C_M #0#4, 1, "N";
         |PINTA #0#4;
         |HAZ Periodo;
     |SINO;
         fFecha = ~;
         aAlfa  = fFecha % 402;   nMes  = aAlfa;
         aAlfa  = fFecha % -104;  nAnyo = aAlfa;
         |SI #99#5 = "T";  |O #99#5 = "C";
             |SI nMes [ 3;
                 #0#4 = 4;
                 #0#6 = nAnyo - 1;
                 |HAZ Periodo;
                 |PINTA #0#4;
                 |PINTA #0#6;
                 |ACABA;
             |FINSI;

             |SI nMes [ 6;
                 #0#4 = 3;
                 #0#6 = nAnyo;
                 |HAZ Periodo;
                 |PINTA #0#4;
                 |PINTA #0#6;
                 |ACABA;
             |FINSI;

             |SI nMes [ 9;
                 #0#4 = 6;
                 #0#6 = nAnyo;
                 |HAZ Periodo;
                 |PINTA #0#4;
                 |PINTA #0#6;
                 |ACABA;
             |FINSI;

             |SI nMes [ 12;
                 #0#4 = 9;
                 #0#6 = nAnyo;
                 |HAZ Periodo;
                 |PINTA #0#4;
                 |PINTA #0#6;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #99#5 = "A";
             #0#4 = 99;
             #0#6 = nAnyo - 1;
             |HAZ Periodo;
             |PINTA #0#4;
             |PINTA #0#6;
         |FINSI;

         |SI #99#5 = "M";
             |SI nMes = 1;
                 #0#4 = 12;
                 #0#6 = nAnyo - 1;
                 |HAZ Periodo;
             |SINO;
                 #0#4 = nMes - 1;
                 #0#6 = nAnyo;
                 |HAZ Periodo;
             |FINSI;
             |PINTA #0#4;
             |PINTA #0#6;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Periodo;
     |SI #0#4 = 1;   #0#5 = "ENERO     ";  |FINSI;
     |SI #0#4 = 2;   #0#5 = "FEBRERO   ";  |FINSI;
     |SI #0#4 = 3;   #0#5 = "MARZO     ";  |FINSI;
     |SI #0#4 = 4;   #0#5 = "ABRIL     ";  |FINSI;
     |SI #0#4 = 5;   #0#5 = "MAYO      ";  |FINSI;
     |SI #0#4 = 6;   #0#5 = "JUNIO     ";  |FINSI;
     |SI #0#4 = 7;   #0#5 = "JULIO     ";  |FINSI;
     |SI #0#4 = 8;   #0#5 = "AGOSTO    ";  |FINSI;
     |SI #0#4 = 9;   #0#5 = "SEPTIEMBRE";  |FINSI;
     |SI #0#4 = 10;  #0#5 = "OCTUBRE   ";  |FINSI;
     |SI #0#4 = 11;  #0#5 = "NOVIEMBRE ";  |FINSI;
     |SI #0#4 = 12;  #0#5 = "DICIEMBRE ";  |FINSI;
     |SI #0#4 = 99;  #0#5 = "ANUAL     ";  |FINSI;

     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#6   = aAlfa;

     |PINTA #0#5;
     |PINTA #0#6;
|FPRC;

|PROCESO Desarchivar;
     |C_M #0#7, 1, "S";
     |SI #0#8 = "D";
         |ABRE #dsmom107;
         |LEE 000#dsmom107.p;
         |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
         |CIERRA #dsmom107;

         |SI #dsmom107#35 = "S";
             |PUSHV 1424 1742;
             |BLANCO 1424 1742;
             |CUADRO 1424 1742;

             |ATRI R;
             |PINTA 1525, "    Password     ";
             |ATRI 0;

             E_inf = "";
             E_sup = 10;

             eaPass  = "";
             eaPass  = 1628 ? -1;
             |HAZ PonPassword;
             |SI eaPass ! #dsmom107#34;
                 |MENAV "0000Password incorrecto.";
                 |ERROR;
             |FINSI;

             |POPV;
         |FINSI;

         |C_M #0#7, 1, "N";
         #0#7 = "01.01.0000";  |PINTA #0#7;
     |FINSI;
|FPRC;

|PROCESO Planillas;
     |C_M #0#36, 1, "S";

     #0#10 = 1;      |PINTA #0#10;  |C_M #0#10, 1, "N";
     #0#11 = 99999;  |PINTA #0#11;  |C_M #0#11, 1, "N";
     |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
          |C_M #0nCampo, 1, "N";
     |SIGUE;
|FPRC;

|PROCESO Parrilla;
     #0#10 = 1;      |PINTA #0#10;  |C_M #0#10, 1, "N";
     #0#11 = 99999;  |PINTA #0#11;  |C_M #0#11, 1, "N";
     #0#36 = 0;  |PINTA #0#36;  |C_M #0#36, 1, "N";
     |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
          |C_M #0nCampo, 1, "S";
     |SIGUE;
|FPRC;

|PROCESO DesdeHasta;
     |C_M #0#10, 1, "S";
     |C_M #0#11, 1, "S";
     #0#36 = 0;  |PINTA #0#36;  |C_M #0#36, 1, "N";

     |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
           |C_M #0nCampo, 1, "N";
           #0nCampo = 0;  |PINTA #0nCampo;
     |SIGUE;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO BotonParrilla;
     |CONTROL_SIMPLE 0, "LBOTON,F2 Seleccion Empresas Desde-Hasta", 2007, 2039, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F3 Seleccion Empresas Parrilla   ", 2107, 2139, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F4 Seleccion por Planillas       ", 2207, 2239, Boton3;
     nBoton3 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  |HAZ DesdeHasta;  |SAL;  |FINSI;
         |SI aTecla = aF3;  |HAZ Parrilla;    |SAL;  |FINSI;
         |SI aTecla = aF4;  |HAZ Planillas;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;
|FPRC;

|PROCESO MiraPlanilla;  |TIPO 0;
     |SI #0#36 = 0;  |ACABA;  |FINSI;

     |ABRE #101;
     #101#0 = #0#36;
     |LEE 040#101=;
     |SI FSalida ! 0;
         |MENAV "     Registro de Planilla Inexistente.";
         |ERROR;
     |FINSI;
     |CIERRA #101;
|FPRC;

|PROCESO GrabaTempo;
     enEmpresaPINET = #4#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     nSwEsta = 1;

     |SI #0#36 ! 0;
         nSwEsta = 0;
         |ABRE #102;
         #102#0 = #0#36;
         #102#1 = #4#0;
         |LEE 040#102=;
         |SI FSalida = 0;
             nSwEsta = 1;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |SI #0#12 ! 0;
         nSwEsta = 0;
         |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #4#0;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;  |ACABA;  |FINSI;

     enCodCli = #4#0;
     |HAZ LeePersona;

     #999#0  = #4#0;
     #999#7  = #4#4;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #4#0;
         #999#7  = #4#4;
         |GRABA 020#999b;
     |FINSI;

     #999#1  = #4#1;
     #999#2  = #4#2;
     #999#3  = #715#1;
     #999#4  = #0#5;
     #999#5  = #0#0;
     #999#6  = "S";
     #999#7  = #4#4;
     |GRABA 020#999a;
     |LIBERA #999;

     nSwGraba = 1;
|FPRC;

|DEFBUCLE dsmom004;
     #4#1;
     7, 9, 13;
     #0#10, #0#6, #0#4, #0#0, 00, aHecho, aImpreso, aArchivo;
     #0#11, #0#6, #0#4, #0#0, 99, aHecho, aImpreso, aArchivo;
     ;
     NULL, GrabaTempo;
|FIN;

|PROCESO GrabaTempo182;
     enEmpresaPINET = #182#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     |SI nChequeo = 1;
         |SI #0#8 = "D";
             #182#16 = "";
             #182#17 = "01.01.0000";
         |SINO;
             #182#16 = "X";
             #182#17 = #0#7;
         |FINSI;
         |GRABA 020#182a;
         |LIBERA #182;

         |ACABA;
     |FINSI;

     nSwEsta = 1;

     |SI #0#36 ! 0;
         nSwEsta = 0;
         |ABRE #102;
         #102#0 = #0#36;
         #102#1 = #182#0;
         |LEE 040#102=;
         |SI FSalida = 0;
             nSwEsta = 1;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |SI #0#12 ! 0;
         nSwEsta = 0;
         |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #182#0;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;  |ACABA;  |FINSI;

     enCodCli = #182#0;
     |HAZ LeePersona;

     #999#0  = #182#0;
     #999#7  = #182#4;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #182#0;
         #999#7  = #182#4;
         |GRABA 020#999b;
     |FINSI;

     #999#1  = #182#1;
     #999#2  = #182#2;
     #999#3  = #715#1;
     #999#4  = #0#5;
     #999#5  = #0#0;
     #999#6  = "S";
     #999#7  = #182#4;
     |GRABA 020#999a;
     |LIBERA #999;

     nSwGraba = 1;

     |LIBERA #182;
|FPRC;

|DEFBUCLE dsm182ca;
     #182#1;
     9, 11, 16;
     #0#10, #0#6, #0#4, #0#0, 00, aHecho, aImpreso, aArchivo;
     #0#11, #0#6, #0#4, #0#0, 99, aHecho, aImpreso, aArchivo;
     be;
     NULL, GrabaTempo182;
|FIN;

|PROCESO dsm182ca;
    #182#0 = #999#0;
    #182#1 = #999#1;
    #182#2 = #999#2;
    #182#3 = #999#5;
    #182#4 = #999#7;
    #182#5 = 00;
    |LEE 141#182=;
    |SI FSalida = 0;
        |HAZ GrabaTempo182;
    |FINSI;
    |LIBERA #182;
|FPRC;

|PROCESO GrabaTempo583;
     enEmpresaPINET = #583#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     |SI nChequeo = 1;
         |SI #0#8 = "D";
             #583#16 = "";
             #583#17 = "01.01.0000";
         |SINO;
             #583#16 = "X";
             #583#17 = #0#7;
         |FINSI;
         |GRABA 020#583a;
         |LIBERA #583;

         |ACABA;
     |FINSI;

     nSwEsta = 1;

     |SI #0#36 ! 0;
         nSwEsta = 0;
         |ABRE #102;
         #102#0 = #0#36;
         #102#1 = #583#0;
         |LEE 040#102=;
         |SI FSalida = 0;
             nSwEsta = 1;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |SI #0#12 ! 0;
         nSwEsta = 0;
         |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #583#0;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;  |ACABA;  |FINSI;

     enCodCli = #583#0;
     |HAZ LeePersona;

     #999#0  = #583#0;
     #999#7  = 00;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #583#0;
         #999#7  = 0;
         |GRABA 020#999b;
     |FINSI;

     #999#1  = #583#1;
     #999#2  = #583#2;
     #999#3  = #715#1;
     #999#4  = #0#5;
     #999#5  = #0#0;
     #999#6  = "S";
     #999#7  = 0;
     |GRABA 020#999a;
     |LIBERA #999;

     nSwGraba = 1;

     |LIBERA #583;
|FPRC;

|DEFBUCLE dsmo5831;
     #583#1;
     9, 11, 16;
     #0#10, #0#6, #0#4, aHecho, aImpreso, aArchivo;
     #0#11, #0#6, #0#4, aHecho, aImpreso, aArchivo;
     be;
     NULL, GrabaTempo583;
|FIN;

|PROCESO dsmo5831;
    #583#0 = #999#0;
    #583#1 = #999#1;
    #583#2 = #999#2;
    #583#3 = #999#5;
    |LEE 141#583=;
    |SI FSalida = 0;
        |HAZ GrabaTempo583;
    |FINSI;
    |LIBERA #583;
|FPRC;

|PROCESO GrabaTempo720;
     enEmpresaPINET = #720#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     |SI nChequeo = 1;
         |SI #0#8 = "D";
             #720#16 = "";
             #720#17 = "01.01.0000";
         |SINO;
             #720#16 = "X";
             #720#17 = #0#7;
         |FINSI;
         |GRABA 020#720a;
         |LIBERA #720;

         |ACABA;
     |FINSI;

     nSwEsta = 1;

     |SI #0#36 ! 0;
         nSwEsta = 0;
         |ABRE #102;
         #102#0 = #0#36;
         #102#1 = #720#0;
         |LEE 040#102=;
         |SI FSalida = 0;
             nSwEsta = 1;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |SI #0#12 ! 0;
         nSwEsta = 0;
         |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #720#0;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;  |ACABA;  |FINSI;

     enCodCli = #720#0;
     |HAZ LeePersona;

     #999#0  = #720#0;
     #999#7  = #720#4;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #720#0;
         #999#7  = #720#4;
         |GRABA 020#999b;
     |FINSI;

     #999#1  = #720#1;
     #999#2  = #720#2;
     #999#3  = #715#1;
     #999#4  = #0#5;
     #999#5  = #0#0;
     #999#6  = "S";
     #999#7  = #720#4;
     |GRABA 020#999a;
     |LIBERA #999;

     nSwGraba = 1;

     |LIBERA #720;
|FPRC;

|DEFBUCLE dsmo7201;
     #720#1;
     9, 11, 16;
     #0#10, #0#6, #0#4, #0#0, 00, 00, aHecho, aImpreso, aArchivo;
     #0#11, #0#6, #0#4, #0#0, 99, 99, aHecho, aImpreso, aArchivo;
     be;
     NULL, GrabaTempo720;
|FIN;

|PROCESO dsmo7201;
    #720#0 = #999#0;
    #720#1 = #999#1;
    #720#2 = #999#2;
    #720#3 = #999#5;
    #720#4 = #999#7;
    #720#5 = 00;
    |LEE 141#720=;
    |SI FSalida = 0;
        |HAZ GrabaTempo720;
    |FINSI;
    |LIBERA #720;
|FPRC;

|PROCESO GrabaTempo309;
     enEmpresaPINET = #309#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     |SI nChequeo = 1;
         |SI #0#8 = "D";
             #309#16 = "";
             #309#17 = "01.01.0000";
         |SINO;
             #309#16 = "X";
             #309#17 = #0#7;
         |FINSI;
         |GRABA 020#309a;
         |LIBERA #309;

         |ACABA;
     |FINSI;

     nSwEsta = 1;

     |SI #0#36 ! 0;
         nSwEsta = 0;
         |ABRE #102;
         #102#0 = #0#36;
         #102#1 = #309#0;
         |LEE 040#102=;
         |SI FSalida = 0;
             nSwEsta = 1;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |SI #0#12 ! 0;
         nSwEsta = 0;
         |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #309#0;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;  |ACABA;  |FINSI;

     enCodCli = #309#0;
     |HAZ LeePersona;

     #999#0  = #309#0;
     #999#7  = #309#4;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #309#0;
         #999#7  = #309#4;
         |GRABA 020#999b;
     |FINSI;

     #999#1  = #309#2;
     #999#2  = #309#3;
     #999#3  = #715#1;
     #999#4  = #0#5;
     #999#5  = #0#0;
     #999#6  = "S";
     #999#7  = #309#4;
     |GRABA 020#999a;
     |LIBERA #999;

     nSwGraba = 1;

     |LIBERA #309;
|FPRC;

|DEFBUCLE dsmod309;
     #309#1;
     9, 11, 16;
     #0#10, 01, #0#6, #0#4, 00, 01, aHecho, aImpreso, aArchivo;
     #0#11, 98, #0#6, #0#4, 99, 99, aHecho, aImpreso, aArchivo;
     be;
     NULL, GrabaTempo309;
|FIN;

|DEFBUCLE dsmod309_1;
     #309#1;
     ;
     #999#0, 01, #999#1, #999#2, #999#7, 01;
     #999#0, 98, #999#1, #999#2, #999#7, 98;
     be;
     NULL, GrabaTempo309;
|FIN;

|PROCESO GrabaTempo045;
     enEmpresaPINET = #45#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     |SI nChequeo = 1;
         |SI #0#8 = "D";
             #45#16 = "";
             #45#17 = "01.01.0000";
         |SINO;
             #45#16 = "X";
             #45#17 = #0#7;
         |FINSI;
         |GRABA 020#45a;
         |LIBERA #45;

         |ACABA;
     |FINSI;

     nSwEsta = 1;

     |SI #0#36 ! 0;
         nSwEsta = 0;
         |ABRE #102;
         #102#0 = #0#36;
         #102#1 = #45#0;
         |LEE 040#102=;
         |SI FSalida = 0;
             nSwEsta = 1;
         |FINSI;
         |CIERRA #102;
     |FINSI;

     |SI #0#12 ! 0;
         nSwEsta = 0;
         |PARA nCampo = 12;  |SI nCampo [ 35;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #45#0;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;  |ACABA;  |FINSI;

     enCodCli = #45#0;
     |HAZ LeePersona;

     #999#0  = #45#0;
     #999#7  = #45#4;
     |LEE 101#999=;
     |SI FSalida ! 0;
         |DDEFECTO #999;
         #999#0  = #45#0;
         #999#7  = #45#4;
         |GRABA 020#999b;
     |FINSI;

     #999#1  = #45#2;
     #999#2  = #45#3;
     #999#3  = #715#1;
     #999#4  = #0#5;
     #999#5  = #0#0;
     #999#6  = "S";
     #999#7  = #45#4;
     |GRABA 020#999a;
     |LIBERA #999;

     nSwGraba = 1;

     |LIBERA #45;
|FPRC;

|DEFBUCLE dsmod045;
     #045#1;
     9, 11, 16;
     #0#10, 00001, #0#6, #0#4, 00, aHecho, aImpreso, aArchivo;
     #0#11, 99999, #0#6, #0#4, 99, aHecho, aImpreso, aArchivo;
     be;
     NULL, GrabaTempo045;
|FIN;

|DEFBUCLE dsmod045_1;
     #045#1;
     ;
     #999#0, 00001, #999#1, #999#2, #999#7;
     #999#0, 99999, #999#1, #999#2, #999#7;
     be;
     NULL, GrabaTempo045;
|FIN;

|RUTINA ClaveBaja999;
     #999#0 = 1;
     #999#7 = 00;
|FRUT;

|RUTINA ClaveAlta999;
     #999#0 = 99999;
     #999#7 = 99;
|FRUT;

|PROCESO GrabaArchivo;
     |SI #999#5 ! 309; |Y #999#5 ! 45; |Y #999#5 ! 720; |Y #999#5 ! 583; |Y #999#5 ! 182;
         #4#0 = #999#0;
         #4#1 = #999#1;
         #4#2 = #999#2;
         #4#3 = #999#5;
         #4#4 = #999#7;
         |LEE 101#4=;
         |SI FSalida = 0;
             |SI #0#8 = "D";
                 #4#13 = "";
                 #4#14 = "01.01.0000";
             |SINO;
                 #4#13 = "X";
                 #4#14 = #0#7;
             |FINSI;
             |GRABA 020#4a;
             |LIBERA #4;
         |FINSI;
     |SINO;
         |SI #0#0 = 309; nChequeo = 1;  |BUCLE dsmod309_1; |FINSI;
         |SI #0#0 = 45;  nChequeo = 1;  |BUCLE dsmod045_1; |FINSI;
         |SI #0#0 = 720; nChequeo = 1;  |HAZ dsmo7201; |FINSI;
         |SI #0#0 = 583; nChequeo = 1;  |HAZ dsmo5831; |FINSI;
         |SI #0#0 = 182; nChequeo = 1;  |HAZ dsm182ca; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014M;
     #999#1;
     6;
     00000, 00, "S";
     99999, 99, "S";
     ;
     NULL, GrabaArchivo;
|FIN;

|PROCESO MiraCuantos;
     enSwHay = enSwHay + 1;
|FPRC;

|DEFBUCLE dsmow014C;
     #999#1;
     6;
     00000, 00,"S";
     99999, 99, "S";
     ;
     NULL, MiraCuantos;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = ("arc" + Usuario) % 108;
     |NOME_DAT #999 aFichero;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     nSwGraba = 0;

     aArchivo = " ";
     |SI #0#8 = "D";  aArchivo = "X";  |FINSI;

     aHecho   = "X";
     aImpreso = "X";
     |SI enArchi = 1;
         aHecho   = " ";
         aImpreso = " ";
     |FINSI;

     |ABRE #999;
     |SI #0#0 ! 309; |Y #0#0 ! 45; |Y #0#0 ! 720; |Y #0#0 ! 583; |Y #0#0 ! 182;
         |BUCLE dsmom004;
     |SINO;
         |SI #0#0 = 309; nChequeo = 0;  |BUCLE dsmod309; |FINSI;
         |SI #0#0 = 045; nChequeo = 0;  |BUCLE dsmod045; |FINSI;
         |SI #0#0 = 720; nChequeo = 0;  |BUCLE dsmo7201; |FINSI;
         |SI #0#0 = 583; nChequeo = 0;  |BUCLE dsmo5831; |FINSI;
         |SI #0#0 = 182; nChequeo = 0;  |BUCLE dsm182ca; |FINSI;
     |FINSI;
     |CIERRA #999;

     |SI nSwGraba = 1;
         |SI nSwPlan = 0;
             |HAZ PonBoton;
             |ENTLINEAL #1#999, -1, 4, 22, 1, ClaveBaja999, ClaveAlta999;
             |HAZ QuitaBoton;
         |FINSI;

         enSwHay = 0;
         |BUCLE dsmow014C;
     |SINO;
         |MENAV "     Seleccion Vacia.";
         |DELINDEX #999;
         |ACABA;
     |FINSI;

     |SI enSwHay = 0;
         |MENAV "      Seleccion Vacia";
     |SINO;
         |ABRE #4;
         |SI #0#0 = 720; |ABRE #720; |FINSI;
         |SI #0#0 = 583; |ABRE #583; |FINSI;
         |SI #0#0 = 182; |ABRE #182; |FINSI;
         |BUCLE dsmow014M;
         |SI #0#0 = 182; |CIERRA #182; |FINSI;
         |SI #0#0 = 583; |CIERRA #583; |FINSI;
         |SI #0#0 = 720; |CIERRA #720; |FINSI;
         |CIERRA #4;
     |FINSI;

     |DELINDEX #999;
|FPRC;

|PROCESO Boton1;
     |PTEC 824;
|FPRC;

|PROCESO Boton2;
     |PTEC 825;
|FPRC;

|PROCESO Boton3;
     |PTEC 826;
|FPRC;

|PROGRAMA;
     eaParametro = PARAMETRO;  |QBF eaParametro;
     |SI eaParametro ! "";

         nSwPlan = 0;
         aAlfa   = eaParametro - "PLANING";
         |SI aAlfa ! eaParametro;
             nSwPlan = 1;
             eaParametro = aAlfa;
         |FINSI;

         |DDEFECTO #0;

         aAlfa = eaParametro % 103;
         #0#0  = aAlfa;
         |SI eaParametro = "311";  |O eaParametro = "311C";
             #0#0 = "310";
             #0#4 = "12";
             |C_M #0#4, 1, "N";
         |FINSI;

         |SI eaParametro = "371";  |O eaParametro = "371C";
             #0#0 = "370";
             #0#4 = "12";
             |C_M #0#4, 1, "N";
         |FINSI;

         |C_M #0#0, 1, "N";
         |SI nSwPlan = 0;
             |PINPA #0#0;
             |PINDA #0#0;
             |ENDATOS #1#0;
         |SINO;
              #0#4  = enPeriodo;
              #0#6  = enEjer;
              #0#8  = "A";
              #0#10 = enEmpresa;
              #0#11 = enEmpresa;

              |PUSHV 0501 2380;
              |BLANCO 1025 1240;
              |ATRI R;
              |PINTA 1026, " FECHA ARCHIVO ";
              |ATRI r;
              |CUADRO 0925 1240;

              fFecha = ~;
              fFecha = 1128 ? 1;

              #0#7 = fFecha;

              |POPV;

              |HAZ Tipo3;
              |ACABA;
         |FINSI;
     |SINO;
         |MANTE #0;
     |FINSI;

     |PULSATECLA;
|FPRO;
