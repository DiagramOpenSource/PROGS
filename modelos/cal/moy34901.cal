|FICHEROS;
     dsmoy000;
     dsmom004;
     dsmom095;

     dsmod349;
     dsmoc349;

     dsmow014;
     dsmow016;
     dsmow538;
     dsmow539;

     &dsmod349@;
     &dsmoc349@;
     &clientes@;
|FIN;

|VARIABLES;
     nDPeriodo = 0;
     nHPeriodo = 0;
     nCampo1  = 0;
     nCampo2  = 0;
     nCampo3  = 0;
     nCampo11 = 0;
     nCampo22 = 0;
     nCampo33 = 0;
     nHandle  = 0;

     aEjer       = "";
     aPathAfegir = "";
     aNombre     = "";
     aIPRemoto   = "";
     aBue        = "";

    ndecontar = 0;
    contador = 0;
    &hojas   = 0;
    resto    = 0;
    &eaPRec  = "";
    &numhoja = 0;
    nNume1   = 0;
    nNume2   = 0;

    nSwBoton1 = 0;
    nSwBoton2 = 0;
    nSwBoton3 = 0;
    nSwBoton4 = 0;

     nEmp                = 0;
     nAny                = 0;
     nPer                = 0;
     nMod                = 0;
     nCom                = 0;
     nHasta              = 0;
|FIN;

|INCLUYE i_varemi;

|| --------------------------------------------------------------------------
|| Recalculo del Modelo segun los Periodos
|| --------------------------------------------------------------------------

|PROCESO dsmoc349R2018;
     |SI #dsmoc349#2 = 99;
         |PARA nCampo = 0;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
               #dsmoc349@#nCampo# = #dsmoc349#nCampo#;
         |SIGUE;
         #dsmoc349@#58 = #dsmoc349#58;
         #dsmoc349@#59 = #dsmoc349#59;
         #dsmoc349@#60 = #dsmoc349#60;
         |GRABA 020#dsmoc349@.n;
         |ACABA;
     |FINSI;

     #dsmoc349@#0  = #dsmoc349#0;
     #dsmoc349@#1  = #dsmoc349#1;
     #dsmoc349@#2  = #dsmow014#2;
     #dsmoc349@#3  = #dsmoc349#3;
     #dsmoc349@#4  = #dsmoc349#4;
     #dsmoc349@#5  = #dsmoc349#5;
     #dsmoc349@#6  = #dsmoc349#6;
     #dsmoc349@#7  = #dsmoc349#7;
     #dsmoc349@#25 = #dsmoc349#25;
     #dsmoc349@#26 = #dsmoc349#26;
     |LEE 101#dsmoc349@.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmoc349@;
         #dsmoc349@#0  = #dsmoc349#0;
         #dsmoc349@#1  = #dsmoc349#1;
         #dsmoc349@#2  = #dsmow014#2;
         #dsmoc349@#3  = #dsmoc349#3;
         #dsmoc349@#4  = #dsmoc349#4;
         #dsmoc349@#5  = #dsmoc349#5;
         #dsmoc349@#6  = #dsmoc349#6;
         #dsmoc349@#7  = #dsmoc349#7;
         #dsmoc349@#8  = #dsmoc349#8;
         #dsmoc349@#9  = #dsmoc349#9;
         #dsmoc349@#23 = #dsmoc349#23;
         #dsmoc349@#24 = #dsmoc349#24;
         #dsmoc349@#25 = #dsmoc349#25;
         #dsmoc349@#26 = #dsmoc349#26;
         #dsmoc349@#58 = #dsmoc349#58;
         #dsmoc349@#59 = #dsmoc349#59;
         #dsmoc349@#60 = #dsmoc349#60;
         |GRABA 020#dsmoc349@.b;
     |FINSI;

     #dsmoc349@#22 = #dsmoc349@#22 + #dsmoc349#22;
     #dsmoc349@#27 = #dsmoc349@#27 + #dsmoc349#27;

     |PARA nCampo2 = 11;  |SI nCampo2 [ 20;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
            |PARA nCampo22 = 11;  |SI nCampo22 [ 20;  |HACIENDO nCampo22 = nCampo22 + 3;
                  nCampo11 = nCampo22 - 1;
                  nCampo33 = nCampo22 + 1;
                  |SI #dsmoc349@#nCampo22# = #dsmoc349#nCampo2#;
                      #dsmoc349@#nCampo11# = #dsmoc349@#nCampo11# + #dsmoc349#nCampo1#;
                      #dsmoc349@#nCampo33# = #dsmoc349@#nCampo33# + #dsmoc349#nCampo3#;
                      |SAL;
                  |FINSI;
            |SIGUE;
     |SIGUE;

     |PARA nCampo2 = 29;  |SI nCampo2 [ 35;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
            |PARA nCampo22 = 29;  |SI nCampo22 [ 35;  |HACIENDO nCampo22 = nCampo22 + 3;
                  nCampo11 = nCampo22 - 1;
                  nCampo33 = nCampo22 + 1;
                  |SI #dsmoc349@#nCampo22# = #dsmoc349#nCampo2#;
                      #dsmoc349@#nCampo11# = #dsmoc349@#nCampo11# + #dsmoc349#nCampo1#;
                      #dsmoc349@#nCampo33# = #dsmoc349@#nCampo33# + #dsmoc349#nCampo3#;
                      |SAL;
                  |FINSI;
            |SIGUE;
     |SIGUE;

     |GRABA 020#dsmoc349@.a;
     |LIBERA #dsmoc349@;
|FPRC;

|DEFBUCLE dsmoc349R2018;
     #dsmoc349#1;
     ;
     nEmp, nAny, nDPeriodo, nMod, nCom, 01, "  ", 0000, 00, "            ";
     nEmp, nAny, nHPeriodo, nMod, nCom, 99, "zz", 9999, 99, "zzzzzzzzzzzz";
     ;
     NULL, dsmoc349R2018;
|FIN;

|PROCESO dsmoc349T2018;
     |SI #dsmoc349@#6 = "E ";  |O #dsmoc349@#6 = "M "; |O #dsmoc349@#6 = "H "; |O #dsmoc349@#6 = "S ";
      |O #dsmoc349@#6 = "T ";  |O #dsmoc349@#6 = "R "; |O #dsmoc349@#6 = "D "; |O #dsmoc349@#6 = "C ";
         #dsmod349@#6 = #dsmod349@#6 + 1;
         #dsmod349@#7 = #dsmod349@#7 + #dsmoc349@#22;
     |FINSI;

     |SI #dsmoc349@#6 = "A ";  |O #dsmoc349@#6 = "I ";
         #dsmod349@#8 = #dsmod349@#8 + 1;
         #dsmod349@#9 = #dsmod349@#9 + #dsmoc349@#22;
     |FINSI;

     |SI #dsmoc349@#6 = "AR";  |O #dsmoc349@#6 = "ER";
      |O #dsmoc349@#6 = "SR";  |O #dsmoc349@#6 = "IR";
      |O #dsmoc349@#6 = "MR";  |O #dsmoc349@#6 = "HR";
      |O #dsmoc349@#6 = "TR";  |O #dsmoc349@#6 = "RR";
      |O #dsmoc349@#6 = "DR";  |O #dsmoc349@#6 = "CR";
         #dsmod349@#10 = #dsmod349@#10 + 1;
         #dsmod349@#11 = #dsmod349@#11 + #dsmoc349@#22;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc349T2018;
     #dsmoc349@#1010;
     ;
     nEmp, nAny, nDPeriodo, nMod, nCom, 01, "  ", 0000, 00, "            ";
     nEmp, nAny, nHPeriodo, nMod, nCom, 99, "zz", 9999, 99, "zzzzzzzzzzzz";
     ;
     NULL, dsmoc349T2018;
|FIN;

|PROCESO dsmow014R2018;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom004;  |FINSI;

     nDPeriodo = #dsmoy000#4;
     nHPeriodo = #dsmoy000#4;

     |SI #dsmom004#22 = "M";
         nDPeriodo = #dsmoy000#4;
         nHPeriodo = #dsmoy000#4;

         |SI #dsmom004#1 ] 2018;
             |ABRE #dsmom095;
             #dsmom095#0 = #dsmom004#0;
             #dsmom095#1 = #dsmom004#1;
             |LEE 000#dsmom095.=;
             |SI FSalida ! 0;  |DDEFECTO #dsmom095;  |FINSI;
             |CIERRA #dsmom095;

             |SI #dsmoy000#4 = 2;   |Y #dsmom095#27 = "S";  nDPeriodo = 1;   |FINSI;
             |SI #dsmoy000#4 = 5;   |Y #dsmom095#28 = "S";  nDPeriodo = 4;   |FINSI;
             |SI #dsmoy000#4 = 8;   |Y #dsmom095#29 = "S";  nDPeriodo = 7;   |FINSI;
             |SI #dsmoy000#4 = 11;  |Y #dsmom095#30 = "S";  nDPeriodo = 10;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmom004#22 = "T";
         |SI #dsmoy000#4 = 3;   nDPeriodo = 1;   nHPeriodo = 3;  |FINSI;
         |SI #dsmoy000#4 = 6;   nDPeriodo = 4;   nHPeriodo = 6;  |FINSI;
         |SI #dsmoy000#4 = 9;   nDPeriodo = 7;   nHPeriodo = 9;  |FINSI;
         |SI #dsmoy000#4 = 12;  nDPeriodo = 10;  nHPeriodo = 12; |FINSI;
     |FINSI;

     #dsmod349#0  = #dsmow014#0;
     #dsmod349#1  = #dsmow014#1;
     #dsmod349#2  = #dsmow014#2;
     #dsmod349#3  = #dsmow014#5;
     #dsmod349#4  = #dsmow014#7;
     #dsmod349#5  = 0;
     |LEE 040#dsmod349.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsmod349@#0  = #dsmow014#0;
     #dsmod349@#1  = #dsmow014#1;
     #dsmod349@#2  = #dsmow014#2;
     #dsmod349@#3  = #dsmow014#5;
     #dsmod349@#4  = #dsmow014#7;
     #dsmod349@#5  = 0;
     |LEE 040#dsmod349@.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmod349@;
         #dsmod349@#0  = #dsmow014#0;
         #dsmod349@#1  = #dsmow014#1;
         #dsmod349@#2  = #dsmow014#2;
         #dsmod349@#3  = #dsmow014#5;
         #dsmod349@#4  = #dsmow014#7;
         #dsmod349@#5  = 0;
         #dsmod349@#6  = 0;
         #dsmod349@#7  = 0;
         #dsmod349@#8  = 0;
         #dsmod349@#9  = 0;
         #dsmod349@#10 = 0;
         #dsmod349@#11 = 0;
         #dsmod349@#12 = #dsmod349#12;
         #dsmod349@#13 = #dsmod349#13;
         |GRABA 020#dsmod349@.b;
     |FINSI;

     nEmp = #dsmod349#0;
     nAny = #dsmod349#1;
     nPer = #dsmod349#2;
     nMod = #dsmod349#3;
     nCom = #dsmod349#4;
     |BUCLE dsmoc349R2018;

     nEmp = #dsmod349@#0;
     nAny = #dsmod349@#1;
     nPer = #dsmod349@#2;
     nMod = #dsmod349@#3;
     nCom = #dsmod349@#4;
     |BUCLE dsmoc349T2018;

     |GRABA 020#dsmod349@.a;
     |LIBERA #dsmod349@;
|FPRC;

|DEFBUCLE dsmow014R2018;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, dsmow014R2018;
|FIN;

|| --------------------------------------------------------------------------

|PROCESO CargaDSMOW016;
     |DDEFECTO #dsmow016;

     enCodCli = #dsmod349@#0;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow016#0 = eaVarDni;

         eaAlfa = #clientes@#1;  |HAZ QuitaRaros;
         #dsmow016#1 = eaAlfa;

         #dsmow016#2  = #clientes@#29;
         #dsmow016#3  = #clientes@#30;
         #dsmow016#4  = #clientes@#31;
         #dsmow016#5  = #clientes@#32;
         #dsmow016#6  = #clientes@#33;
         #dsmow016#7  = #clientes@#34;
         #dsmow016#8  = #clientes@#35;
         #dsmow016#9  = #clientes@#36;
         #dsmow016#10 = #clientes@#37;
         #dsmow016#11 = #clientes@#15;
         #dsmow016#12 = #clientes@#16;

         eaAlfa   = #clientes@#53;  |HAZ QuitaRaros;
         #dsmow016#13  = eaAlfa;

         eaAlfa   = #clientes@#1;  enLinea = 2;  |HAZ LeeTelefono;  |QBF eaAlfa;
         |SI eaAlfa = "";
             eaAlfa   = #clientes@#1;  enLinea = 1;  |HAZ LeeTelefono;
         |FINSI;
         |HAZ QuitaRarosTfno;
         #dsmow016#14  = eaAlfa;

         #dsmow016#15  = #dsmow016#13;
         #dsmow016#16  = "SECRETARIO";

         #dsmow016#20  = #clientes@#17;
         #dsmow016#21  = #clientes@#18;
         #dsmow016#22  = #clientes@#38;
     |SINO;
         aAlfa = #clientes@#96; |QBF aAlfa; |SI aAlfa = ""; #clientes@#96 = #clientes@#2; |FINSI;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow016#0 = eaVarDni;

         eaAlfa = #clientes@#1;  |HAZ QuitaRaros;
         #dsmow016#1 = eaAlfa;

         #dsmow016#2  = #clientes@#3;
         #dsmow016#3  = #clientes@#4;
         #dsmow016#4  = #clientes@#5;
         #dsmow016#5  = #clientes@#6;
         #dsmow016#6  = #clientes@#7;
         #dsmow016#7  = #clientes@#8;
         #dsmow016#8  = #clientes@#9;
         #dsmow016#9  = #clientes@#10;
         #dsmow016#10 = #clientes@#11;
         #dsmow016#11 = #clientes@#15;
         #dsmow016#12 = #clientes@#16;

         eaAlfa   = #clientes@#96;  |HAZ QuitaRaros;
         #dsmow016#13  = eaAlfa;

         eaAlfa   = #clientes@#14;  |HAZ QuitaRarosTfno;
         #dsmow016#14  = eaAlfa;

         #dsmow016#15  = #dsmow016#13;
         #dsmow016#16  = "SECRETARIO";

         #dsmow016#20  = #clientes@#91;
         #dsmow016#21  = #clientes@#92;
         #dsmow016#22  = #clientes@#12;
     |FINSI;

     #dsmow016#23 = #dsmod349@#1;
     |SI #dsmod349@#2 ! 99;
         |SI #dsmod349@#2 = 3;   #dsmow016#24 = "1T";  |FINSI;
         |SI #dsmod349@#2 = 6;   #dsmow016#24 = "2T";  |FINSI;
         |SI #dsmod349@#2 = 9;   #dsmow016#24 = "3T";  |FINSI;
         |SI #dsmod349@#2 = 12;  #dsmow016#24 = "4T";  |FINSI;
     |SINO;
         #dsmow016#24 = "0A";
     |FINSI;

     |SI #dsmow016#23 ] 2018; |Y #dsmom004#22 = "M";
         #dsmow016#24 = ("00" + #dsmod349@#2) % -102;
     |FINSI;

     |SI nTecla = 1;  #dsmow016#25 = "X";  |FINSI;
     |SI nTecla = 2;  #dsmow016#25 = "X";  |FINSI;
     |SI nTecla = 3;  #dsmow016#26 = "X";  |FINSI;
     |SI nTecla = 4;  #dsmow016#29 = "X";  |FINSI;

     #dsmow016#30 = #dsmod349@#6;
     #dsmow016#31 = #dsmod349@#7;
     #dsmow016#32 = #dsmod349@#8;
     #dsmow016#33 = #dsmod349@#9;
     #dsmow016#34 = #dsmod349@#10;
     #dsmow016#42 = #dsmod349@#11;
     #dsmow016#37 = "";
     #dsmow016#39 = #dsmow016#15;
     #dsmow016#40 = #dsmow016#16;
     #dsmow016#41 = #dsmod349@#0;
     eaAlfa  = #dsmoy000#7;  |HAZ FechaBonito;  #dsmow016#38 = eaFechaB;
|FPRC;

|PROCESO Registro1_349_2018;
     enCodCli = #dsmod349@#0;
     |HAZ LeePersona;

     |HAZ CargaDSMOW016;

     |DDEFECTO #dsmow538;

     #dsmow538#0   = "1";

     #dsmow538#1   = "349";

     #dsmow538#2   = #dsmod349@#1;

     eaVarDni = #dsmow016#0;  |HAZ CalculameDNI;
     #dsmow538#3   = eaVarDni;

     eaAlfa   = #dsmow016#1;  |HAZ QuitaRaros;
     #dsmow538#4   = eaAlfa;

     |SI #dsmow538#2 < 2020;
         #dsmow538#5   = "T";
     |FINSI;

     eaAlfa   = #dsmow016#14;  |HAZ QuitaRarosTfno;
     #dsmow538#6   = eaAlfa;

     eaAlfa   = #dsmow016#13;  |HAZ QuitaRaros;
     #dsmow538#7   = eaAlfa;

     #dsmow538#8   = "3490000000000";

     |SI enDirecta = 1; |O #dsmow538#2 ] 2020;
         |HAZ CalcJustificante;
         #dsmow538#8 = eaJusti;
     |FINSI;

     |SI #dsmod349@#12 = "C";
         #dsmow538#9 = "C";
         #dsmow538#11 = #dsmod349@#13;
     |FINSI;

     |SI #dsmod349@#12 = "S";
         #dsmow538#10 = "S";
         #dsmow538#11 = #dsmod349@#13;
     |FINSI;

     |SI #dsmom004#22 = "M";
         |ABRE #dsmom095;
         #dsmom095#0 = #dsmod349@#0;
         #dsmom095#1 = #dsmod349@#1;
         |LEE 000#dsmom095.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom095;  |FINSI;
         |CIERRA #dsmom095;

         #dsmow538#12 = (("00" + #dsmod349@#2) % -102);

                           nCampo = 0;
         |SI #dsmod349@#2 = 2;   nCampo = 27;  |FINSI;
         |SI #dsmod349@#2 = 5;   nCampo = 28;  |FINSI;
         |SI #dsmod349@#2 = 8;   nCampo = 29;  |FINSI;
         |SI #dsmod349@#2 = 11;  nCampo = 30;  |FINSI;

         |SI nCampo ! 0;
             |SI #dsmom095#nCampo# = "S";  #dsmow538#17 = "X";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmom004#22 = "T";
         |SI #dsmod349@#2 = 3;   #dsmow538#12 = "1T";  |FINSI;
         |SI #dsmod349@#2 = 6;   #dsmow538#12 = "2T";  |FINSI;
         |SI #dsmod349@#2 = 9;   #dsmow538#12 = "3T";  |FINSI;
         |SI #dsmod349@#2 = 12;  #dsmow538#12 = "4T";  |FINSI;
     |FINSI;

     |SI #dsmom004#22 = "A";
         #dsmow538#12 = "0A";
     |FINSI;

     enNume   = #dsmod349@#6 + #dsmod349@#8;
     #dsmow538#13  = ("000000000" + enNume) % -109;

     enNume   = #dsmod349@#7 + #dsmod349@#9;  |HAZ Conver15;
     #dsmow538#14  = eaAlfa;

     #dsmow538#15  = ("000000000" + #dsmod349@#10) % -109;

     enNume   = #dsmod349@#11;  |HAZ Conver15;
     #dsmow538#16  = eaAlfa;

     #dsmow538#21  = &13 + &10;

                          nHasta = 20;
     |SI eaOpcion = "3";  nHasta = 21;  |FINSI;

     |SI enTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ nHasta;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow538#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Registro2_349_2018;
     |DDEFECTO #dsmow539;

     #dsmow539#0  = "2";

     #dsmow539#1  = "349";

     #dsmow539#2  = #dsmod349@#1;
     #dsmow539#3  = #dsmow538#3;
     #dsmow539#4  = "";

     #dsmow539#5  = #dsmoc349@#8;
     |SI #dsmoc349@#8 = "GR ";  #dsmow539#5 = "EL";  |FINSI;

     #dsmow539#6  = #dsmoc349@#7;

     #dsmow539#7  = #dsmoc349@#9;

                                #dsmow539#8 = "E";
     |SI #dsmoc349@#6  = "M ";  #dsmow539#8 = "M";  |FINSI;
     |SI #dsmoc349@#6  = "H ";  #dsmow539#8 = "H";  |FINSI;  ||tique 70000_6570
     |SI #dsmoc349@#6  = "A ";  #dsmow539#8 = "A";  |FINSI;
     |SI #dsmoc349@#6  = "S ";  #dsmow539#8 = "S";  |FINSI;
     |SI #dsmoc349@#6  = "I ";  #dsmow539#8 = "I";  |FINSI;
     |SI #dsmoc349@#6  = "T ";  #dsmow539#8 = "T";  |FINSI;
     |SI #dsmoc349@#6  = "R ";  #dsmow539#8 = "R";  |FINSI;
     |SI #dsmoc349@#6  = "D ";  #dsmow539#8 = "D";  |FINSI;
     |SI #dsmoc349@#6  = "C ";  #dsmow539#8 = "C";  |FINSI;
     |SI #dsmoc349@#6  = "ER";  #dsmow539#8 = "E";  |FINSI;
     |SI #dsmoc349@#6  = "MR";  #dsmow539#8 = "M";  |FINSI;
     |SI #dsmoc349@#6  = "HR";  #dsmow539#8 = "H";  |FINSI;
     |SI #dsmoc349@#6  = "AR";  #dsmow539#8 = "A";  |FINSI;
     |SI #dsmoc349@#6  = "SR";  #dsmow539#8 = "S";  |FINSI;
     |SI #dsmoc349@#6  = "IR";  #dsmow539#8 = "I";  |FINSI;
     |SI #dsmoc349@#6  = "TR";  #dsmow539#8 = "T";  |FINSI;
     |SI #dsmoc349@#6  = "RR";  #dsmow539#8 = "R";  |FINSI;
     |SI #dsmoc349@#6  = "DR";  #dsmow539#8 = "D";  |FINSI;
     |SI #dsmoc349@#6  = "CR";  #dsmow539#8 = "C";  |FINSI;


     |SI #dsmoc349@#6 = "A ";  |O #dsmoc349@#6 = "E ";  |O #dsmoc349@#6 = "S ";
      |O #dsmoc349@#6 = "I ";  |O #dsmoc349@#6 = "M ";  |O #dsmoc349@#6 = "H ";
       |O #dsmoc349@#6 = "T "; |O #dsmoc349@#6 = "R ";  |O #dsmoc349@#6 = "D ";
       |O #dsmoc349@#6 = "C ";
         enNume = #dsmoc349@#22;  |HAZ Conver13;
         #dsmow539#9  = eaAlfa;

         #dsmow539#10 = "";

         #dsmow539#11 = "";

         #dsmow539#12 = "";

         #dsmow539#13 = "";
     |SINO;
         #dsmow539#9  = "";

         #dsmow539#10 = #dsmoc349@#25;

         |SI #dsmoc349@#26 = 0;   #dsmow539#11 = "0A";   |FINSI;
         |SI #dsmoc349@#26 = 1;   #dsmow539#11 = "1T";   |FINSI;
         |SI #dsmoc349@#26 = 2;   #dsmow539#11 = "2T";   |FINSI;
         |SI #dsmoc349@#26 = 3;   #dsmow539#11 = "3T";   |FINSI;
         |SI #dsmoc349@#26 = 4;   #dsmow539#11 = "4T";   |FINSI;
         |SI #dsmoc349@#26 = 11;  #dsmow539#11 = "01";   |FINSI;
         |SI #dsmoc349@#26 = 12;  #dsmow539#11 = "02";   |FINSI;
         |SI #dsmoc349@#26 = 13;  #dsmow539#11 = "03";   |FINSI;
         |SI #dsmoc349@#26 = 14;  #dsmow539#11 = "04";   |FINSI;
         |SI #dsmoc349@#26 = 15;  #dsmow539#11 = "05";   |FINSI;
         |SI #dsmoc349@#26 = 16;  #dsmow539#11 = "06";   |FINSI;
         |SI #dsmoc349@#26 = 17;  #dsmow539#11 = "07";   |FINSI;
         |SI #dsmoc349@#26 = 18;  #dsmow539#11 = "08";   |FINSI;
         |SI #dsmoc349@#26 = 19;  #dsmow539#11 = "09";   |FINSI;
         |SI #dsmoc349@#26 = 20;  #dsmow539#11 = "10";   |FINSI;
         |SI #dsmoc349@#26 = 21;  #dsmow539#11 = "11";   |FINSI;
         |SI #dsmoc349@#26 = 22;  #dsmow539#11 = "12";   |FINSI;

         enNume = #dsmoc349@#22;  |HAZ Conver13;
         #dsmow539#12  = eaAlfa;

         enNume = #dsmoc349@#27;  |HAZ Conver13;
         #dsmow539#13  = eaAlfa;
     |FINSI;
     |SI #dsmow539#2 ] 2020; |Y #dsmow539#8 = "C";
         #dsmow539#14 = #dsmoc349@#59;
         |SI #dsmoc349@#59 = "GR ";  #dsmow539#14 = "EL";  |FINSI;

         #dsmow539#15  = #dsmoc349@#58;

         #dsmow539#16  = #dsmoc349@#60;

     |FINSI;

     #dsmow539#19 = &13 + &10;

                          nHasta = 18;
     |SI eaOpcion = "3";  nHasta = 19;  |FINSI;

     |SI enTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ nHasta;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow539#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |SINO;
         |PARA nCampo = 0; |SI nCampo [ 60; |HACIENDO nCampo = nCampo + 1;
               #dsmoc349#nCampo# = #dsmoc349@#nCampo#;
         |SIGUE;
         |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc349_2018;
     #dsmoc349@#1010;
     ;
     nEmp, nAny, nDPeriodo, nMod, nCom, 01, "  ", 0000, 00, "            ";
     nEmp, nAny, nHPeriodo, nMod, nCom, 99, "zz", 9999, 99, "zzzzzzzzzzzz";
     ;
     NULL, Registro2_349_2018;
|FIN;

|PROCESO LeeModelo_2018;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsmod349@#0  = #dsmow014#0;
     #dsmod349@#1  = #dsmow014#1;
     #dsmod349@#2  = #dsmow014#2;
     #dsmod349@#3  = #dsmow014#5;
     #dsmod349@#4  = #dsmow014#7;
     #dsmod349@#5  = 0;
     |LEE 040#dsmod349@.=;
     |SI FSalida ! 0;  |ACABA;   |FINSI;

     |HAZ Registro1_349_2018;

     nEmp = #dsmod349@#0;
     nAny = #dsmod349@#1;
     nPer = #dsmod349@#2;
     nMod = #dsmod349@#3;
     nCom = #dsmod349@#4;

     |BUCLE dsmoc349_2018;
     |SI enTecla = 5;
         |PIEINF;
     |FINSI;
|FPRC;


|PROCESO QueHacemos349_2018;
     |SI enTecla = 5;
         |HAZ LeeModelo_2018;
         |ACABA;
     |FINSI;

     eaFicheroPlano = "349" + (("00000" + #dsmow014#0) % -105) + ".txt";
     eaFicheroImpre = "349" + (("00000" + #dsmow014#0) % -105) + ".imp";
     eaFicheroSalid = "349" + (("00000" + #dsmow014#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #dsmow014#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     |HAZ LeeModelo_2018;

     |XCIERRA nHandle2;

     enEmpresa    = #dsmow014#0;
     enComple     = #dsmow014#7;
     eaNomEmpresa = #dsmow014#3;

     eaX002_10    = #dsmow538#3;
     eaX002_11    = #dsmow538#4;
     eaX002_12    = #dsmoy000#0;
     eaX002_13    = #dsmoy000#6;
     eaX002_14    = #dsmow538#12;

     |SI #dsmow538#9 ! " ";
         eaX002_15 = #dsmow538#9;
     |FINSI;

     |SI #dsmow538#10 ! " ";
         eaX002_15 = #dsmow538#10;
         eaX002_16 = #dsmow538#11;
     |FINSI;

     enNume    = #dsmod349@#6 + #dsmod349@#8;
     eaX002_31 = enNume;

     enNume    = #dsmod349@#7 + #dsmod349@#9;
     eaX002_32 = enNume;

     |HAZ PresentaPortal;
|FPRC;

|DEFBUCLE dsmow014C_2018;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos349_2018;
|FIN;

|DEFBUCLE dsmow014N_2018;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos349_2018;
|FIN;

|PROCESO Btn349_2018;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Presentacion Telematica      ", 0513, 0654, BotonF2;
     nBtnF2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Borrador con validacion ", 0813, 0954, BotonF3;
     nBtnF3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Informe Comprobacion ", 1113, 1254, BotonF4;
     nBtnF4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, BotonEsc;
     nBtnEs = FSalida;

     eaForzExplorador = "S";

     aF2  = &255 + "824";
     aF3  = &255 + "825";
     aF4  = &255 + "826";
     aEsc = &255 + "806";

     eaOpcion = "0";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;

         |SI aTecla = aF2;  eaOpcion = "3"; |SAL;  |FINSI;
         |SI aTecla = aF3;  eaOpcion = "1"; |SAL;  |FINSI;
         |SI aTecla = aF4;  eaOpcion = "5"; |SAL;  |FINSI;
         |SI aTecla = aEsc;                 |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBtnF2;
     |FIN_CONTROL_WINDOWS nBtnF3;
     |FIN_CONTROL_WINDOWS nBtnF4;
     |FIN_CONTROL_WINDOWS nBtnEs;

                          enTecla = 0;
     |SI eaOpcion = "1";  enTecla = 1;  |FINSI;
     |SI eaOpcion = "3";  enTecla = 3;  |FINSI;
     |SI eaOpcion = "5";  enTecla = 5;  |FINSI;


     |PULSATECLA;
|FPRC;

|PROCESO Btn349_2019;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Presentacion Telematica MANUAL ", 0531, 0649, BotonF2;
     nBtnF2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Presentacion Telematica DIRECTA ", 0831, 0949, BotonF6;
     nBtnF6 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Borrador con validacion ", 1131, 1249, BotonF3;
     nBtnF3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Informe Comprobacion ", 1431, 1549, BotonF4;
     nBtnF4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 1731, 1849, BotonEsc;
     nBtnEs = FSalida;

     eaForzExplorador = "S";

     aF2  = &255 + "824";
     aF3  = &255 + "825";
     aF4  = &255 + "826";
     aF6  = &255 + "828";
     aEsc = &255 + "806";

     eaOpcion  = "0";
     enDirecta = 0;
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;

         |SI aTecla = aF2;  eaOpcion = "3"; |SAL;  |FINSI;
         |SI aTecla = aF3;  eaOpcion = "1"; |SAL;  |FINSI;
         |SI aTecla = aF4;  eaOpcion = "5"; |SAL;  |FINSI;

         |SI aTecla = aF6;
             |HAZ PermisoPortal;
             |SI enPortal = 1;
                 enDirecta = 1;
                 eaOpcion = "6";
                 |SAL;
             |FINSI;
         |FINSI;

         |SI aTecla = aEsc;                 |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBtnF2;
     |FIN_CONTROL_WINDOWS nBtnF3;
     |FIN_CONTROL_WINDOWS nBtnF4;
     |FIN_CONTROL_WINDOWS nBtnF6;
     |FIN_CONTROL_WINDOWS nBtnEs;

                          enTecla = 0;
     |SI eaOpcion = "1";  enTecla = 1;  |FINSI;
     |SI eaOpcion = "3";  enTecla = 3;  |FINSI;
     |SI eaOpcion = "5";  enTecla = 5;  |FINSI;
     |SI eaOpcion = "6";  enTecla = 3;  |FINSI;

     enParar = 1;
     |SI enDirecta = 1;  |Y enMsv = 1;
         |CONFI "0000SSolicitar confirmacion de cada empresa";
         |SI FSalida ! 0;
             enParar = 0;
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO Papel349_2018;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "m349co01";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |ABRE #dsmom004;
     |ABRE #dsmod349@;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C_2018;
     |SINO;
         |BUCLE dsmow014N_2018;
     |FINSI;
     |CIERRA #dsmod349@;
     |CIERRA #dsmom004;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO moy34901;
     |SI eaParametro = "349C";
         enTecla = 5;
     |SINO;
         |SI #dsmoy000#6 [ 2018;
             |HAZ Btn349_2018;
         |FINSI;

         |SI #dsmoy000#6 ] 2019;
             |HAZ Btn349_2019;
         |FINSI;
     |FINSI;

     |SI enTecla = 0;  |ACABA;  |FINSI;

     |SI enTecla = 0;  enInfComp = 1; |ACABA;  |FINSI;
     |SI enTecla = 5;  enInfComp = 1; |FINSI;

     |ABRE #dsmom004;
     |ABRE #dsmod349;
     |ABRE #dsmod349@;
     |ABRE #dsmoc349@;
     |BUCLE dsmow014R2018;
     |CIERRA #dsmom004;
     |CIERRA #dsmod349;
     |CIERRA #dsmod349@;
     |CIERRA #dsmoc349@;

     |SI enTecla = 5;
         |HAZ Papel349_2018;
         |ACABA;
     |FINSI;

     enCambiaMoneda = 1;
     enSwTrata      = 0;

     |SI eaOpcion = "3";
         |HAZ PreguntaPresentacion;
     |FINSI;

     |ABRE #dsmom004;
     |ABRE #dsmod349@;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C_2018;
     |SINO;
         |BUCLE dsmow014N_2018;
     |FINSI;
     |CIERRA #dsmod349@;
     |CIERRA #dsmom004;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;
