|FICHEROS;
     dsm190ca;
     dsm190li;
     dsmom073;

     dsmow079,MANTE;
     dsmow078,MANTE;

     :/basica/def/agidanif;

     &regisnif@;
|FIN;

|VARIABLES;
     nModo       = 0;
     nCampo      = 0;
     nPtec       = 0;
     nCampoD     = 0;
     nCampoO     = 0;
     nForma      = 0;

     aMenav      = "";
     aPathModelo = "";
     aDef        = "";
     aAlfa       = "";
     aTecla      = "";
     nError      = 0;
     &enError    = 0;
     &enBoton3   = 0;
     &eaPathLaboral = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO PonDatosNifLI;  |TIPO 7;
     eaCodNif  = #dsm190li#6;
     |HAZ LeeNifs;

     |HAZ CalculaDatosNif;

     #dsm190li#12 = #regisnif@#1;   |PINTA #dsm190li#12;
     #dsm190li#13 = #regisnif@#4;   |PINTA #dsm190li#13;
                               |PINTA #dsm190li#14;
                               |PINTA #dsm190li#15;
                               |PINTA #dsm190li#25;
                               |PINTA #dsm190li#26;
                               |PINTA #dsm190li#27;

     |C_M #dsm190li#10, 1, "S";
     |C_M #dsm190li#14, 1, "S";
     |C_M #dsm190li#21, 1, "S";
     |C_M #dsm190li#22, 1, "S";
     |C_M #dsm190li#23, 1, "S";
     |C_M #dsm190li#24, 1, "S";
     |C_M #dsm190li#25, 1, "S";
     |C_M #dsm190li#26, 1, "S";

     |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";
      |Y #dsm190li#8 ! "E"; |Y #dsm190li#8 ! "M";
         |C_M #dsm190li#14, 1, "N";   #dsm190li#14 = 0;   |PINTA #dsm190li#14;
         |C_M #dsm190li#21, 1, "N";   #dsm190li#21 = 0;   |PINTA #dsm190li#21;
         |C_M #dsm190li#22, 1, "N";   #dsm190li#22 = 0;   |PINTA #dsm190li#22;
         |C_M #dsm190li#23, 1, "N";   #dsm190li#23 = 0;   |PINTA #dsm190li#23;
         |C_M #dsm190li#24, 1, "N";   #dsm190li#24 = 0;   |PINTA #dsm190li#24;
         |C_M #dsm190li#25, 1, "N";   #dsm190li#25 = 0;   |PINTA #dsm190li#25;
         |C_M #dsm190li#26, 1, "N";   #dsm190li#26 = 0;   |PINTA #dsm190li#26;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;
     |FINSI;

     |SI #dsm190li#26 ! 2;
         |C_M #dsm190li#27, 1, "N";  #dsm190li#27 = "";  |PINTA #dsm190li#27;
     |FINSI;
|FPRC;

|PROCESO Tipo2m190LI;  |TIPO 2;
     #dsm190ca#6 = #dsm190ca#6 +. 1;
     #dsm190ca#7 = #dsm190ca#7 +. (#dsm190li#16 + #dsm190li#18);
     #dsm190ca#8 = #dsm190ca#8 +. (#dsm190li#17 + #dsm190li#19);

     |SI enBoton3 = -1;  |ACABA;  |FINSI;

     nForma = 0 +. 1;
     |SI nForma = 1;
         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";
          |Y #dsm190li#8 ! "E"; |Y #dsm190li#8 ! "M";
             |ACABA;
         |FINSI;

         |ESTADO_CONTROL enBoton3, "HIDE";

         |SI #dsm190li#1 [ 2002;
             |PUSHV 0501 2380;
             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoO = nCampoD - 28;
                   #dsmow078#nCampoO# = #dsm190li#nCampoD#;
             |SIGUE;

             |PINPA #0#dsmow078;
             |PINDA #0#dsmow078;
             |ENDATOS #1#dsmow078;
             |SI FSalida = 0;
                 |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                       nCampoO = nCampoD - 28;
                       #dsm190li#nCampoD# = #dsmow078#nCampoO#;
                 |SIGUE;
             |FINSI;
             |POPV;
         |FINSI;

         |SI #dsm190li#1 ] 2003;
             |PUSHV 0501 2380;

             |PARA nCampoD = 41;  |SI nCampoD [ 63;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoO = nCampoD - 41;
                   #dsmow079#nCampoO# = #dsm190li#nCampoD#;
             |SIGUE;

             |PINPA #0#dsmow079;
             |C_V #dsmow079#20, 1, "S";  |C_M #dsmow079#20, 1, "S";
             |C_V #dsmow079#21, 1, "S";  |C_M #dsmow079#21, 1, "S";
             |C_V #dsmow079#22, 1, "S";  |C_M #dsmow079#22, 1, "S";

             |SI #dsm190li#1 [ 2008;
                 |C_V #dsmow079#20, 1, "N";  |C_M #dsmow079#20, 1, "N";
                 |C_V #dsmow079#21, 1, "N";  |C_M #dsmow079#21, 1, "N";
                 |C_V #dsmow079#22, 1, "N";  |C_M #dsmow079#22, 1, "N";

                 |PINTA 2027, "쳐컴컴컴컴컴컴컴컴컴컴컴컴컵";
                 |PINTA 2128, "                         ";
                 |PINTA 2228, "                         ";
             |FINSI;

             |PINDA #0#dsmow079;
             |ENDATOS #1#dsmow079;
             |SI FSalida = 0;
                 |PARA nCampoD = 41;  |SI nCampoD [ 63;  |HACIENDO nCampoD = nCampoD + 1;
                       nCampoO = nCampoD - 41;
                       #dsm190li#nCampoD# = #dsmow079#nCampoO#;
                 |SIGUE;
             |FINSI;
             |POPV;
         |FINSI;

         |ESTADO_CONTROL enBoton3, "SHOW";
     |FINSI;
|FPRC;

|PROCESO Tipo11m190LI;  |TIPO 11;
     |SI FSalida = 10;
         eaVarDni  = #dsm190li#Campo#;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #dsm190li#Campo# = eaVarDni;
         |PINTA #dsm190li#Campo#;
         |ERROR;
     |FINSI;

     |SI FSalida = 11;
         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";
          |Y #dsm190li#8 ! "E"; |Y #dsm190li#8 ! "M";
             |ERROR;
             |ACABA;
         |FINSI;

         |ESTADO_CONTROL enBoton3, "HIDE";

         |SI #dsm190li#1 [ 2002;
             |PUSHV 0501 2380;
             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoO = nCampoD - 28;
                   #dsmow078#nCampoO# = #dsm190li#nCampoD#;
             |SIGUE;

             |PINPA #0#dsmow078;
             |PINDA #0#dsmow078;
             |LEETECLA aTecla;
             |POPV;
         |FINSI;

         |SI #dsm190li#1 ] 2003;
             |PUSHV 0501 2380;

             |PARA nCampoD = 41;  |SI nCampoD [ 63;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoO = nCampoD - 41;
                   #dsmow079#nCampoO# = #dsm190li#nCampoD#;
             |SIGUE;

             |PINPA #0#dsmow079;

             |C_V #dsmow079#20, 1, "S";
             |C_V #dsmow079#21, 1, "S";
             |C_V #dsmow079#22, 1, "S";

             |SI #dsm190li#1 [ 2008;
                 |C_V #dsmow079#20, 1, "N";
                 |C_V #dsmow079#21, 1, "N";
                 |C_V #dsmow079#22, 1, "N";

                 |PINTA 2027, "쳐컴컴컴컴컴컴컴컴컴컴컴컴컵";
                 |PINTA 2128, "                         ";
                 |PINTA 2228, "                         ";
             |FINSI;

             |PINDA #0#dsmow079;
             |LEETECLA aTecla;
             |POPV;
         |FINSI;

         |ESTADO_CONTROL enBoton3, "SHOW";

         |ERROR;
     |FINSI;
|FPRC;

|PROCESO LetraNifConyugeLI;
     |SI FSalida = 10;
         eaVarDni  = #dsm190li#Campo#;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #dsm190li#Campo# = eaVarDni;
         |PINTA #dsm190li#Campo#;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO MiraDni190LI;  |TIPO 6;
     |C_M #dsm190li#Campo#, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     eaVarDni  = #dsm190li#Campo#;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #dsm190li#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #dsm190li#Campo# = eaVarDni;  |PINTA #dsm190li#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #dsm190li#Campo# = "            "; |ACABA; |FINSI;

     nError = 1;
     aAlfa = #dsm190li#Campo# % 101;
     |SI aAlfa = "0";  nError = 0; |FINSI;
     |SI aAlfa = "1";  nError = 0; |FINSI;
     |SI aAlfa = "2";  nError = 0; |FINSI;
     |SI aAlfa = "3";  nError = 0; |FINSI;
     |SI aAlfa = "4";  nError = 0; |FINSI;
     |SI aAlfa = "5";  nError = 0; |FINSI;
     |SI aAlfa = "6";  nError = 0; |FINSI;
     |SI aAlfa = "7";  nError = 0; |FINSI;
     |SI aAlfa = "8";  nError = 0; |FINSI;
     |SI aAlfa = "9";  nError = 0; |FINSI;
     |SI aAlfa = "E";  |O aAlfa = "e"; nError = 0; |FINSI;
     |SI aAlfa = "J";  |O aAlfa = "j"; nError = 0; |FINSI;
     |SI aAlfa = "X";  |O aAlfa = "x"; nError = 0; |FINSI;
     |SI aAlfa = "Y";  |O aAlfa = "y"; nError = 0; |FINSI;
     |SI aAlfa = "Z";  |O aAlfa = "z"; nError = 0; |FINSI;

     |SI nError = 1;
         |CONFI "0000NEste CIF es de una sociedad y no debe declarase en el Modelo. Continuar S/N";
         |SI FSalida ! 0;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO RecogeDatosLI;
     enError = 1;
     |HAZ GrabaDatosNif;

     |SI enError = 1;
         |MENAV "     Datos del NIF sin Actualizar o no hay Trabajador, PUEDE que los datos esten incompletos.";
         |ACABA;
     |FINSI;

     |ABRE #agidanif;
     #agidanif#0  = #dsm190li#6;
     #agidanif#1  = 1;
     |LEE 040#agidanif.=;
     |SI FSalida ! 0;
         |SI eaPathLaboral ! "";
             |MENAV "      NIF sin Datos Personales, Actualicelo.";
             |ERROR;
         |FINSI;
     |FINSI;
     |CIERRA #agidanif;
|FPRC;

|PROCESO Tipo7LI;  |TIPO 7;
     |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";
      |Y #dsm190li#8 ! "E"; |Y #dsm190li#8 ! "M";
         |ESTADO_CONTROL enBoton3, "DISABLE";
     |SINO;
         |ESTADO_CONTROL enBoton3, "ENABLE";
     |FINSI;

     |SI #dsm190li#1 < 2015;
         |PINTA 2128, "Prolongacion :"; |C_V #dsm190li#39,1,"S";
         |PINTA 2228, "Movilidad ...:"; |C_P #dsm190li#40,1,2243;
         |C_V #dsm190li#65,1,"N";
     |FINSI;
|FPRC;

|PROCESO TipoRelacionLI;  |TIPO 7;

     nModo = (FEntrada / 100) ! 0;

     |SI #dsm190li#8 ! "A";  |Y #dsm190li#8 ! "M";
         |C_M #dsm190li#10, 1, "N";
         #dsm190li#10 = 0;  |PINTA #dsm190li#10;
         |ACABA;
     |FINSI;

     |SI nModo ! 1; |ACABA; |FINSI;

     |ABRE #agidanif;
     #agidanif#0  = #dsm190li#6;
     #agidanif#1  = 1;
     |LEE 040#agidanif.=;
     |SI FSalida ! 0;  |DDEFECTO #agidanif; |FINSI;
     |CIERRA #agidanif;

     #dsm190li#10 = #agidanif#36;
     |PINTA #dsm190li#10;
|FPRC;

|PROCESO SituacionFamiliarLI;
     |C_M #dsm190li#27, 1, "S";
     |SI #dsm190li#26 ! 2;
         |C_M #dsm190li#27, 1, "N";  #dsm190li#27 = "";  |PINTA #dsm190li#27;
     |FINSI;
|FPRC;

|PROCESO Baja73LI;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73LI;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO Tipo66C8F190LI; |TIPO 66;
     enEjerIRPF = #dsm190li#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #dsm190li#8;
     #dsmom073#2 = #dsm190li#9;
     |LEE 000#dsmom073.];

     |CONSULTA_F_CLAVE #1#dsmom073, Baja73LI, Alta73LI;
     |SI FSalida = 0;
          #dsm190li#8 = #dsmom073#1;    |PINTA #dsm190li#8;
          #dsm190li#9 = #dsmom073#2;    |PINTA #dsm190li#9;
     |FINSI;
     |CIERRA #dsmom073;

     |ERROR;
|FPRC;

|PROCESO SubCl190LI; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;

     enEjerIRPF = #dsm190li#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #dsm190li#8;
     #dsmom073#2 = #dsm190li#9;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |SI nModo = 1;  |ERROR;  |FINSI;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;
