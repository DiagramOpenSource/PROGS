-|FICHEROS;
     dsmo7201 #1;
     dsmo7202 #2,MANTE;

     dsmow150 #150,MANTE;

     &regisnif@ #709;
     reflejo@   #22;
|FIN;

|VARIABLES;
     aPathModelo = "";
     aDef        = "";
     aAlfa       = "";
     nPara1      = 0;
     nPara2      = 0;
     nNumero     = 0;

     nTecla       = 0;
     &enEmpOrigen = 0;
     &enEjeOrigen = 0;
     &enComOrigen = 0;
     &enLinOrigen = 0;
     &enTantoEmp  = 0;
     &eaNomOrigen = "";
     &enSw999     = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO MiraDnimo7202;  |TIPO 6;
     |SI #2#8 = "            "; |ACABA; |FINSI;

     eaVarDni  = #2Campo;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #2Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #2Campo = eaVarDni;  |PINTA #2Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 0;
     eaCodNif  = #2#8;
     |HAZ LeeNifs;

     #2#10 = #709#1;   || |PINTA #2#10;
|FPRC;

|PROCESO DespuesRep; |TIPO 0;
     |C_M #2#8,1, "S";
     |SI #2#9 = "N";
         |C_M #2#8,1, "N";
         #2#8 = ""; |PINTA #2#8;
     |FINSI;
|FPRC;

|PROCESO Sacar2011;
     |PUSHV 0501 2480;

     |DDEFECTO #150;

     |PARA nPara1 = 7; |SI nPara1 [ 38; |HACIENDO nPara1 = nPara1 + 1;
           nPara2 = nPara1 - 7;
           #150nPara2 = #2nPara1;
     |SIGUE;
     #150#33 = #2#39;
     #150#34 = "DECLARADO";
     |SI #150#33 = "N"; #150#34 = "DESACTIVADO"; |FINSI;

     |PINPA #0#150;
     |PINDA #0#150;
|FPRC;

|PROCESO Importe;
     |HAZ LeeEURODBMOD;

     |HAZ Sacar2011;

     |ENDATOS #2#150;
     |SI FSalida = 0;
         |PARA nPara1 = 7; |SI nPara1 [ 38; |HACIENDO nPara1 = nPara1 + 1;
               nPara2 = nPara1 - 7;
               #2nPara1 = #150nPara2;
         |SIGUE;
         #2#39 = #150#33;
     |FINSI;

     |POPV;
     |BLIN 4;

     |PINTA #2#27;
     |PINTA #2#39;
|FPRC;

|PROCESO Tipo5mo7202;  |TIPO 5;
     |LEE 040#2p;
     #2#39 = "N";
     |LINEAS_BI_ATRI #2#39, S, I, -1;
|FPRC;

|PROCESO Tipo2mo7202;  |TIPO 2;
   |SI #2#39 = "S";
      #1#6 = #1#6 +. #2#33;  |PINTA #1#6;
      #1#7 = #1#7 +. #2#34;  |PINTA #1#7;

      #1#8 = #1#8 +. 1;      |PINTA #1#8;
   |FINSI;
|FPRC;

|PROCESO LaCabecera;
    #1#6 = #1#6 + (nNumero * #2#33);  |PINTA #1#6;
    #1#7 = #1#7 + (nNumero * #2#34);  |PINTA #1#7;

    #1#8 = #1#8 + nNumero;            |PINTA #1#8;
|FPRC;

|RUTINA ClaveBaja22;
     #22#0  = #1#0;
     #22#1  = #1#1;
     #22#2  = #1#2;
     #22#3  = #1#3;
     #22#4  = #1#4;
     #22#5  = #1#5;
     #22#6  = 001;
     #22#10 = " ";
|FRUT;

|RUTINA ClaveAlta22;
     #22#0  = #1#0;
     #22#1  = #1#1;
     #22#2  = #1#2;
     #22#3  = #1#3;
     #22#4  = #1#4;
     #22#5  = #1#5;
     #22#6  = 999;
     #22#10 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROCESO Tipo11mo7202;  |TIPO 11;
     nTecla = FSalida;

     |SI nTecla = 11;
         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/dsmo7202";
         |CARGA_DEF aDef, reflejo@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dsmo7202.mas";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |ABRE #22;
         |CONSULTA_F_CLAVE #1#22, ClaveBaja22, ClaveAlta22;
         |SI FSalida = 0;
             #2#0 = #22#0;
             #2#1 = #22#1;
             #2#2 = #22#2;
             #2#3 = #22#3;
             #2#4 = #22#4;
             #2#5 = #22#5;
             #2#6 = #22#6;
             |LEE 000#2=;
         |FINSI;
         |CIERRA #22;

         |DESCARGA_DEF #reflejo@;

         |PTEC 809;
         |PTEC 808;
         |PONCONTROL  23, "SI";
     |FINSI;

     |SI nTecla = 12;

         |HAZ Sacar2011;
         |HAZ Tipo7C04;
         |PAUSA;
         |SI FSalida ! 1; |Y FSalida ! 7;
             |PINPA #1#150;
             |PINDA #1#150;
             |HAZ Tipo7C23;
             |PAUSA;
         |FINSI;

         |POPV;

         |ERROR;
     |FINSI;

     |SI nTecla = 13;
         |CONFI "    SDesea Copiar los datos a otra(s) Empresa(s)";
         |SI FSalida = 0;
             enEmpOrigen = #2#0;
             enEjeOrigen = #2#1;
             enComOrigen = #2#4;
             enLinOrigen = #2#6;
             enTantoEmp  = #2#38;
             |SUB_EJECUTA_NP "dsmoz023;MODELO";
         |FINSI;

         |ERROR;
     |FINSI;

     |SI nTecla = 14;

         |LEE 041#2=;

         |SI #2#39 = "S";
             |CONFI "0000NDesea no Declarar este Inmueble";
         |SINO;
              FSalida = 0;
         |FINSI;
         |SI FSalida = 0;
             |SI #2#39 = "S";
                 nNumero = -1;
                 #2#39 = "N";
             |SINO;
                 nNumero = 1;
                 #2#39 = "S";
             |FINSI;
             |HAZ LaCabecera;
             |GRABA 020#2a;
             |LIBERA #2;
             |PONCONTROL  23, "SI";
         |SINO;
             |LIBERA #2;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;
