|FICHEROS;
     dsmoz066;
     dsmom004;
     dsmom008;
     dsmoc110;
     dsmoc111;
     dsm11101;

     :/basica/def/agifigen;

     dsmoc11@;
|FIN;

|VARIABLES;
     nCampo            = 0;
     fFecha            = @;
     aAlfa             = "";
     aAlfa1            = "";
     nPara1            = 0;
     nDEmpresa         = 0;
     nHEmpresa         = 0;
     nEmpresa          = 0;
     nEjer             = 0;
     nPeriodo          = 0;
     nModelo           = 0;
     nComplem          = 0;
     nActividad        = 0;
     nDPeriodo         = 0;
     nHPeriodo         = 0;
     nDComplem         = 0;
     nHComplem         = 0;
     aClave            = "";
     aSubClave         = "";
     aNomDef           = "";
     aBase             = "";
     aMas              = "";
     nCambio           = 0;
     nBorrar           = 0;

     nRegDestino       = 00;
     nRegOrigen        = 99;
|FIN;

|INCLUYE i_variar;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\
|PROCESO Periodo;
     nCampo   = Campo + 1;
     #dsmoz066#nCampo# = "          ";
     |SI #dsmoz066#Campo# = 1;   #dsmoz066#nCampo# = "ENERO     ";  |FINSI;
     |SI #dsmoz066#Campo# = 2;   #dsmoz066#nCampo# = "FEBRERO   ";  |FINSI;
     |SI #dsmoz066#Campo# = 3;   #dsmoz066#nCampo# = "MARZO     ";  |FINSI;
     |SI #dsmoz066#Campo# = 4;   #dsmoz066#nCampo# = "ABRIL     ";  |FINSI;
     |SI #dsmoz066#Campo# = 5;   #dsmoz066#nCampo# = "MAYO      ";  |FINSI;
     |SI #dsmoz066#Campo# = 6;   #dsmoz066#nCampo# = "JUNIO     ";  |FINSI;
     |SI #dsmoz066#Campo# = 7;   #dsmoz066#nCampo# = "JULIO     ";  |FINSI;
     |SI #dsmoz066#Campo# = 8;   #dsmoz066#nCampo# = "AGOSTO    ";  |FINSI;
     |SI #dsmoz066#Campo# = 9;   #dsmoz066#nCampo# = "SEPTIEMBRE";  |FINSI;
     |SI #dsmoz066#Campo# = 10;  #dsmoz066#nCampo# = "OCTUBRE   ";  |FINSI;
     |SI #dsmoz066#Campo# = 11;  #dsmoz066#nCampo# = "NOVIEMBRE ";  |FINSI;
     |SI #dsmoz066#Campo# = 12;  #dsmoz066#nCampo# = "DICIEMBRE ";  |FINSI;

     |SI #dsmoz066#nCampo# = "          ";
         |MENAV "     Periodo Incorrecto.";
         |ERROR;
     |FINSI;

     |PINTA #dsmoz066#nCampo#;
|FPRC;

|PROCESO defecto; |TIPO 7;
     fFecha = ~;
     aAlfa  = fFecha % -104;
     #dsmoz066#2   = aAlfa;
     |PINTA #dsmoz066#2;
|FPRC;

|PROCESO Parrilla;
     |SI #dsmoz066#3 = 0;
         #dsmoz066#3 = 0;  |PINTA #dsmoz066#3;
         #dsmoz066#4 = 0;  |PINTA #dsmoz066#4;  |C_M #dsmoz066#4, 1, "N";
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoz066#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #dsmoz066#3, 1, "S";
         |C_M #dsmoz066#4, 1, "S";

         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoz066#nCampo#, 1, "N";
               #dsmoz066#nCampo# = 0;  |PINTA #dsmoz066#nCampo#;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #dsmoz066#Campo# = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               #dsmoz066#nCampo# = 0;  |C_M #dsmoz066#nCampo#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoz066#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO LasClaves; |TIPO 0;
     aAlfa1 = "S";
     |SI #dsmoz066#22 = "S"; aAlfa1 = "N"; |FINSI;
     |PARA nCampo = 23;  |SI nCampo [ 34;  |HACIENDO nCampo = nCampo + 1;
           |C_M #dsmoz066#nCampo#, 1, aAlfa1;

           |SI aAlfa1 = "N";
               #dsmoz066#nCampo# = ""; |PINTA #dsmoz066#nCampo#;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO ParaBorrar; |TIPO 0;
     aAlfa1 = "S";
     |SI #dsmoz066#37 = "S"; aAlfa1 = "N"; |FINSI;
     |C_M #dsmoz066#38, 1, aAlfa1;
|FPRC;

|PROCESO repetir;
     aAlfa = #dsmoz066#17; |QBF aAlfa;
     |SI aAlfa ! "";
         |SI #dsmoz066#18 = "zzzzzzzzzzzz";
             #dsmoz066#18 = #dsmoz066#17; |PINTA #dsmoz066#18;
         |FINSI;
     |FINSI;
|FPRC;
|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\
|PROCESO SelClave;
   nBorrar = 1;
   |SI #dsmoz066#22 = "N";
       nBorrar = 0;
       |SI #dsmoz066#23 = aClave; |Y #dsmoz066#24 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz066#25 = aClave; |Y #dsmoz066#26 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz066#27 = aClave; |Y #dsmoz066#28 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz066#29 = aClave; |Y #dsmoz066#30 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz066#31 = aClave; |Y #dsmoz066#32 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz066#33 = aClave; |Y #dsmoz066#34 = aSubClave; nBorrar = 1; |FINSI;
   |FINSI;
|FPRC;

|| ///////////////////////////
|PROCESO BajaM008;
     |ABRE #dsmom008;
     #dsmom008#0 = nEmpresa;
     #dsmom008#1 = nEjer;
     #dsmom008#2 = nPeriodo;
     #dsmom008#3 = nModelo;
     #dsmom008#4 = nComplem;
     #dsmom008#5 = nActividad;
     |LEE 101#dsmom008.=;
     |SI FSalida = 0;
         #dsmom008#11 = "SIN DATOS";
         |GRABA 020#dsmom008.a;
     |FINSI;
     |LIBERA #dsmom008;
     |CIERRA #dsmom008;
|FPRC;

|PROCESO dsmoc110;
     aClave    = #dsmoc110#8;
     aSubClave = #dsmoc110#9;
     |HAZ SelClave;

     |SI nBorrar = 1;

         |DDEFECTO #dsmoc11@;
         #dsmoc11@#0  = #dsmoc110#0;
         #dsmoc11@#01 = #dsmoc110#01;
         #dsmoc11@#02 = #dsmoc110#02;
         #dsmoc11@#03 = #dsmoc110#03;
         #dsmoc11@#04 = #dsmoc110#04;
         #dsmoc11@#05 = nRegDestino;
         #dsmoc11@#06 = #dsmoc110#06;
         #dsmoc11@#07 = #dsmoc110#07;
         #dsmoc11@#08 = #dsmoc110#08;
         #dsmoc11@#09 = #dsmoc110#09;
         |LEE 141#dsmoc11@.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmoc11@;
             |PARA nPara1 = 0; |SI nPara1 [ 31; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmoc11@#nPara1# = #dsmoc110#nPara1#;
             |SIGUE;
             #dsmoc11@#05 = nRegDestino;
             |GRABA 020#dsmoc11@.n;
         |SINO;
             |SI #dsmoz066#38 = "S";
                 |PARA nPara1 = 10; |SI nPara1 [ 28; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsmoc110#nPara1#;
                 |SIGUE;
                 #dsmoc11@#30 = #dsmoc110#30;
                 #dsmoc11@#31 = #dsmoc110#31;
             |SINO;
                 |PARA nPara1 = 10; |SI nPara1 [ 28; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsmoc11@#nPara1# + #dsmoc110#nPara1#;
                 |SIGUE;
                 #dsmoc11@#30 = #dsmoc11@#30 + #dsmoc110#30;
                 #dsmoc11@#31 = #dsmoc11@#31 + #dsmoc110#31;
             |FINSI;
             |GRABA 020#dsmoc11@.a;
         |FINSI;
         |LIBERA #dsmoc11@;

         |BORRA 020#dsmoc110.a;
         nCambio = 1;
     |FINSI;

     |LIBERA #dsmoc110;
|FPRC;

|DEFBUCLE dsmoc110;
     #dsmoc110#1;
     ;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#17, 0000, " ", "  ";
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#18, 9999, "z", "zz";
     be;
     NULL, dsmoc110;
|FIN;

|PROCESO dsmoc111;
     aClave    = #dsmoc111#9;
     aSubClave = #dsmoc111#10;
     |HAZ SelClave;

     |SI nBorrar = 1;

         |DDEFECTO #dsmoc11@;
         #dsmoc11@#0  = #dsmoc111#0;
         #dsmoc11@#01 = #dsmoc111#01;
         #dsmoc11@#02 = #dsmoc111#02;
         #dsmoc11@#03 = #dsmoc111#03;
         #dsmoc11@#04 = #dsmoc111#04;
         #dsmoc11@#05 = nRegDestino;
         #dsmoc11@#06 = #dsmoc111#06;
         #dsmoc11@#07 = #dsmoc111#07;
         #dsmoc11@#08 = #dsmoc111#08;
         #dsmoc11@#09 = #dsmoc111#09;
         #dsmoc11@#10 = #dsmoc111#10;
         #dsmoc11@#11 = #dsmoc111#11;
         |LEE 141#dsmoc11@.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmoc11@;
             |PARA nPara1 = 0; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmoc11@#nPara1# = #dsmoc111#nPara1#;
             |SIGUE;
             #dsmoc11@#05 = nRegDestino;
             |GRABA 020#dsmoc11@.n;
         |SINO;
             |SI #dsmoz066#38 = "S";
                 |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsmoc111#nPara1#;
                 |SIGUE;
                 #dsmoc11@#22 = #dsmoc111#22;
                 #dsmoc11@#23 = #dsmoc111#23;
             |SINO;
                 |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsmoc11@#nPara1# + #dsmoc111#nPara1#;
                 |SIGUE;
                 #dsmoc11@#22 = #dsmoc11@#22 + #dsmoc111#22;
                 #dsmoc11@#23 = #dsmoc11@#23 + #dsmoc111#23;
             |FINSI;
             |GRABA 020#dsmoc11@.a;
         |FINSI;
         |LIBERA #dsmoc11@;

         |BORRA 020#dsmoc111.a;
         nCambio = 1;
     |FINSI;

     |LIBERA #dsmoc111;
|FPRC;

|DEFBUCLE dsmoc111;
     #dsmoc111#1;
     ;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegOrigen, #dsmoz066#17, 0000, 00, " ", "  ", 0;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegOrigen, #dsmoz066#18, 9999, 99, "z", "zz", 9;
     be;
     NULL, dsmoc111;
|FIN;

|PROCESO dsm11101;
     aClave    = #dsm11101#9;
     aSubClave = #dsm11101#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |DDEFECTO #dsmoc11@;
         #dsmoc11@#0  = #dsm11101#0;
         #dsmoc11@#01 = #dsm11101#01;
         #dsmoc11@#02 = #dsm11101#02;
         #dsmoc11@#03 = #dsm11101#03;
         #dsmoc11@#04 = #dsm11101#04;
         #dsmoc11@#05 = nRegDestino;
         #dsmoc11@#06 = #dsm11101#06;
         #dsmoc11@#07 = #dsm11101#07;
         #dsmoc11@#08 = #dsm11101#08;
         #dsmoc11@#09 = #dsm11101#09;
         #dsmoc11@#10 = #dsm11101#10;
         #dsmoc11@#11 = #dsm11101#11;
         |LEE 141#dsmoc11@.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsmoc11@;
             |PARA nPara1 = 0; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmoc11@#nPara1# = #dsm11101#nPara1#;
             |SIGUE;
             #dsmoc11@#05 = nRegDestino;
             |GRABA 020#dsmoc11@.n;
         |SINO;
             |SI #dsmoz066#38 = "S";
                 |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsm11101#nPara1#;
                 |SIGUE;

                 |PARA nPara1 = 25; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsm11101#nPara1#;
                 |SIGUE;

                #dsmoc11@#22 = #dsm11101#22;
                 #dsmoc11@#23 = #dsm11101#23;
             |SINO;
                 |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsmoc11@#nPara1# + #dsm11101#nPara1#;
                 |SIGUE;

                 |PARA nPara1 = 25; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
                       #dsmoc11@#nPara1# = #dsmoc11@#nPara1# + #dsm11101#nPara1#;
                 |SIGUE;

                 #dsmoc11@#22 = #dsmoc11@#22 + #dsm11101#22;
                 #dsmoc11@#23 = #dsmoc11@#23 + #dsm11101#23;
             |FINSI;

             |GRABA 020#dsmoc11@.a;
         |FINSI;
         |LIBERA #dsmoc11@;

         |BORRA 020#dsm11101.a;
         nCambio = 1;
     |FINSI;

     |LIBERA #dsm11101;
|FPRC;

|DEFBUCLE dsm11101;
     #dsm11101#1;
     ;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegOrigen, #dsmoz066#17, 0000, 00, " ", "  ", 0;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegOrigen, #dsmoz066#18, 9999, 99, "z", "zz", 9;
     be;
     NULL, dsm11101;
|FIN;

|PROCESO dsmoc110B;
     aClave    = #dsmoc110#8;
     aSubClave = #dsmoc110#9;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsmoc110.a;
         nCambio = 1;
      |FINSI;

      |LIBERA #dsmoc110;
|FPRC;

|DEFBUCLE dsmoc110B;
     #dsmoc110#1;
     ;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#17, 0000, " ", "  ";
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#18, 9999, "z", "zz";
     be;
     NULL, dsmoc110B;
|FIN;

|PROCESO dsmoc111B;
     aClave    = #dsmoc111#9;
     aSubClave = #dsmoc111#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsmoc111.a;
         nCambio = 1;
     |FINSI;
     |LIBERA #dsmoc111;
|FPRC;

|DEFBUCLE dsmoc111B;
     #dsmoc111#1;
     ;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#17, 0000, 00, " ", "  ", 0;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#18, 9999, 99, "z", "zz", 9;
     be;
     NULL, dsmoc111B;
|FIN;

|PROCESO dsm11101B;
     aClave    = #dsm11101#9;
     aSubClave = #dsm11101#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsm11101.a;
         nCambio = 1;
     |FINSI;
     |LIBERA #dsm11101;
|FPRC;

|DEFBUCLE dsm11101B;
     #dsm11101#1;
     ;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#17, 0000, 00, " ", "  ", 0;
     nEmpresa, nEjer, nPeriodo, nModelo, nComplem, nRegDestino, #dsmoz066#18, 9999, 99, "z", "zz", 9;
     be;
     NULL, dsm11101B;
|FIN;

|PROCESO dsmom004;

    nPeriodo = #dsmom004#2;
    nComplem = #dsmom004#4;

    nCambio = 0;
    |SI #dsmoz066#37 = "S";
        |SI #dsmoz066#2 [ 2010;  |BUCLE dsmoc110B;  |FINSI;
        |SI #dsmoz066#2 = 2011;  |BUCLE dsmoc111B;  |FINSI;
        |SI #dsmoz066#2 = 2012;  |BUCLE dsmoc111B;  |FINSI;
        |SI #dsmoz066#2 = 2013;  |BUCLE dsmoc111B;  |FINSI;
        |SI #dsmoz066#2 = 2014;  |BUCLE dsmoc111B;  |FINSI;
        |SI #dsmoz066#2 = 2015;  |BUCLE dsmoc111B;  |FINSI;
        |SI #dsmoz066#2 ] 2016;  |BUCLE dsm11101B;  |FINSI;

        nActividad = nRegDestino; |HAZ  BajaM008;
    |FINSI;

    |ABRE #dsmoc11@;
    |SI #dsmoz066#2 [ 2010;  |BUCLE dsmoc110;  |FINSI;
    |SI #dsmoz066#2 = 2011;  |BUCLE dsmoc111;  |FINSI;
    |SI #dsmoz066#2 = 2012;  |BUCLE dsmoc111;  |FINSI;
    |SI #dsmoz066#2 = 2013;  |BUCLE dsmoc111;  |FINSI;
    |SI #dsmoz066#2 = 2014;  |BUCLE dsmoc111;  |FINSI;
    |SI #dsmoz066#2 = 2015;  |BUCLE dsmoc111;  |FINSI;
    |SI #dsmoz066#2 ] 2016;  |BUCLE dsm11101;  |FINSI;
    |CIERRA #dsmoc11@;

    |SI nCambio = 1;
        enDesdePase = 1;

            nActividad  = nRegOrigen; |HAZ  BajaM008;
            enEmpresa   = nEmpresa;
            enEjer      = nEjer;
            enPeriodo   = nPeriodo;
            enModelo    = 110;
            enComplem   = nComplem;
            enActividad = nRegOrigen;
            enTipoEntrada = 98;
        |SI #dsmoz066#2 [ 2010;
            |SUB_EJECUTA_NP "dsmoc110";
        |SINO;
            |SI #dsmoz066#2 [ 2015;
                |SUB_EJECUTA_NP "dsmoc111";
            |SINO;
                |SUB_EJECUTA_NP "dsm11101";
            |FINSI;
        |FINSI;

            nActividad  = nRegDestino; |HAZ  BajaM008;
            enEmpresa   = nEmpresa;
            enEjer      = nEjer;
            enPeriodo   = nPeriodo;
            enModelo    = 110;
            enComplem   = nComplem;
            enActividad = nRegDestino;
            enTipoEntrada = 98;
        |SI #dsmoz066#2 [ 2010;
            |SUB_EJECUTA_NP "dsmoc110";
        |SINO;
            |SI #dsmoz066#2 [ 2015;
                |SUB_EJECUTA_NP "dsmoc111";
            |SINO;
                |SUB_EJECUTA_NP "dsm11101";
            |FINSI;
        |FINSI;

        |HAZ ChequeaSituacion;  || Esta en el PLB
        #dsmom004#9 = " ";
        |GRABA 020#dsmom004.a;
        enDesdePase = 0;
   |FINSI;
|FPRC;

|DEFBUCLE dsmom004;
   #dsmom004#1;
   ;
   nEmpresa, nEjer, nDPeriodo, nModelo, nDComplem;
   nEmpresa, nEjer, nHPeriodo, nModelo, nHComplem;
   e;
   NULL, dsmom004;
|FIN;

|PROCESO agifigen;
     nEmpresa = #agifigen#0;
     |BUCLE dsmom004;
|FPRC;

|DEFBUCLE agifigen;
     #agifigen#1;
     ;
     nDEmpresa;
     nHEmpresa;
     ;
     NULL, agifigen;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     nModelo   = 110;
     nEjer     = #dsmoz066#2;
     nDPeriodo = #dsmoz066#19;
     nHPeriodo = #dsmoz066#0;
     nDComplem = #dsmoz066#35;
     nHComplem = #dsmoz066#36;

     nRegOrigen  = 01;
     nRegDestino = 99;
     |SI #dsmoz066#21 = 2;
         nRegOrigen  = 99;
         nRegDestino = 01;
     |FINSI;

     aNomDef = "dsm11101.mas";
     |SI #dsmoz066#2 [ 2010; aNomDef = "dsmoc110.mas"; |FINSI;
     |SI #dsmoz066#2 = 2011; aNomDef = "dsmoc111.mas"; |FINSI;
     |SI #dsmoz066#2 = 2012; aNomDef = "dsmoc111.mas"; |FINSI;
     |SI #dsmoz066#2 = 2013; aNomDef = "dsmoc111.mas"; |FINSI;
     |SI #dsmoz066#2 = 2014; aNomDef = "dsmoc111.mas"; |FINSI;
     |SI #dsmoz066#2 = 2015; aNomDef = "dsmoc111.mas"; |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/"+ aNomDef;
     |CARGA_DEF aMas, dsmoc11@;
     |SI FSalida ! 0;
         |MENAV "    Error al carga el def " + aNomDef;
         |ACABA;
     |FINSI;

     |SI #dsmoz066#3 ! 0;
         nDEmpresa = #dsmoz066#3;
         nHEmpresa = #dsmoz066#4;
         |BUCLE agifigen;
     |SINO;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoz066#nCampo# ! 0;
                   nDEmpresa = #dsmoz066#nCampo#;
                   nHEmpresa = #dsmoz066#nCampo#;
                   |BUCLE agifigen;
               |FINSI;
         |SIGUE;
     |FINSI;

     |DESCARGA_DEF #dsmoc11@;
|FPRC;
