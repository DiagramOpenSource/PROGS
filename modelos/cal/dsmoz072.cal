|FICHEROS;
     dsmoz072;
     dsmom002;
     dsmom004;
     dsmom008;

     dsmoc110;
     dsmoc111;
     dsm11101;
     dsm190li;
     dsm19001;

     :/basica/def/agifigen;

     dsmodel@;
     &clientes@;
|FIN;

|VARIABLES;
     nCampo            = 0;
     fFecha            = @;
     aAlfa             = "";
     aAlfa1            = "";
     nPara1            = 0;
     nDEmpresa         = 0;
     nHEmpresa         = 0;
     nDActividad       = 0;
     nHActividad       = 0;
     nEmpresa          = 0;
     nEjer             = 0;
     nPer              = 0;
     nPeriodoN         = 0;
     nMod              = 0;
     nCpl              = 0;
     nActividad        = 0;
     nDEjer            = 0;
     nHEjer            = 0;
     nDPeriodo         = 0;
     nHPeriodo         = 0;
     nDComplem         = 0;
     nHComplem         = 0;
     aClave            = "";
     aSubClave         = "";
     aNomDef           = "";
     aBase             = "";
     aMas              = "";
     nCambio           = 0;
     nBorrar           = 0;

     aNif              = "";
     nDevengo          = 0;
     nRelacion         = 0;
     aParam            = "";
     nEmpresaN         = 0;
     aPeriodicidad     = "";
     aPerioNuevo       = "";
     nExism002         = 0;
     fFecIni           = @;
     fFecFin           = @;
     nNume             = 0;
     nNume1            = 0;
     nNume2            = 0;

     &enAnyo          = 0;
     &enEmpresaA      = 0;
|FIN;

|INCLUYE i_variar;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\
|PROCESO Modelo; |TIPO 0;
  |SI #dsmoz072#48 ! 110; |Y #dsmoz072#48 ! 190;
      |C_M #dsmoz072#48,1,"S";
      |ERROR;
      |ACABA;
  |FINSI;

  |SI #dsmoz072#48 = 110;
      |SI #dsmoz072#0 = 99;
          #dsmoz072#0  = 1;           |PINTA #dsmoz072#0;
          #dsmoz072#1  = "ENERO";     |PINTA #dsmoz072#1;
          #dsmoz072#43 = 12;          |PINTA #dsmoz072#43;
          #dsmoz072#44 = "DICIEMBRE"; |PINTA #dsmoz072#44;
      |FINSI;
      |C_M #dsmoz072#0,  1, "S";
      |C_M #dsmoz072#43, 1, "S";
      |C_M #dsmoz072#46, 1, "S";
      |C_M #dsmoz072#47, 1, "S";
  |FINSI;

  |SI #dsmoz072#48 = 190;
      #dsmoz072#0  = 99;      |PINTA #dsmoz072#0;
      #dsmoz072#1  = "ANUAL"; |PINTA #dsmoz072#1;
      #dsmoz072#43 = 99;      |PINTA #dsmoz072#43;
      #dsmoz072#44 = "ANUAL"; |PINTA #dsmoz072#44;
      |C_M #dsmoz072#0,  1, "N";
      |C_M #dsmoz072#43, 1, "N";
      |C_M #dsmoz072#46, 1, "N";
      |C_M #dsmoz072#47, 1, "N";
  |FINSI;
|FPRC;

|PROCESO Periodo;
     nCampo   = Campo + 1;
     #dsmoz072#nCampo# = "          ";
     |SI #dsmoz072#Campo# = 1;   #dsmoz072#nCampo# = "ENERO     ";  |FINSI;
     |SI #dsmoz072#Campo# = 2;   #dsmoz072#nCampo# = "FEBRERO   ";  |FINSI;
     |SI #dsmoz072#Campo# = 3;   #dsmoz072#nCampo# = "MARZO     ";  |FINSI;
     |SI #dsmoz072#Campo# = 4;   #dsmoz072#nCampo# = "ABRIL     ";  |FINSI;
     |SI #dsmoz072#Campo# = 5;   #dsmoz072#nCampo# = "MAYO      ";  |FINSI;
     |SI #dsmoz072#Campo# = 6;   #dsmoz072#nCampo# = "JUNIO     ";  |FINSI;
     |SI #dsmoz072#Campo# = 7;   #dsmoz072#nCampo# = "JULIO     ";  |FINSI;
     |SI #dsmoz072#Campo# = 8;   #dsmoz072#nCampo# = "AGOSTO    ";  |FINSI;
     |SI #dsmoz072#Campo# = 9;   #dsmoz072#nCampo# = "SEPTIEMBRE";  |FINSI;
     |SI #dsmoz072#Campo# = 10;  #dsmoz072#nCampo# = "OCTUBRE   ";  |FINSI;
     |SI #dsmoz072#Campo# = 11;  #dsmoz072#nCampo# = "NOVIEMBRE ";  |FINSI;
     |SI #dsmoz072#Campo# = 12;  #dsmoz072#nCampo# = "DICIEMBRE ";  |FINSI;
     |SI #dsmoz072#Campo# = 99;  #dsmoz072#nCampo# = "ANUAL     ";  |FINSI;

     |SI #dsmoz072#nCampo# = "          ";
         |MENAV "     Periodo Incorrecto.";
         |ERROR;
     |FINSI;

     |PINTA #dsmoz072#nCampo#;
|FPRC;

|PROCESO defecto; |TIPO 7;
|FPRC;

|PROCESO Parrilla;
     |SI #dsmoz072#3 = 0;
         #dsmoz072#3 = 0;  |PINTA #dsmoz072#3;
         #dsmoz072#4 = 0;  |PINTA #dsmoz072#4;  |C_M #dsmoz072#4, 1, "N";
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoz072#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #dsmoz072#3, 1, "S";
         |C_M #dsmoz072#4, 1, "S";

         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoz072#nCampo#, 1, "N";
               #dsmoz072#nCampo# = 0;  |PINTA #dsmoz072#nCampo#;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #dsmoz072#Campo# = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               #dsmoz072#nCampo# = 0;  |C_M #dsmoz072#nCampo#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoz072#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO LasClaves; |TIPO 0;
     aAlfa1 = "S";
     |SI #dsmoz072#22 = "S"; aAlfa1 = "N"; |FINSI;
     |PARA nCampo = 23;  |SI nCampo [ 34;  |HACIENDO nCampo = nCampo + 1;
           |C_M #dsmoz072#nCampo#, 1, aAlfa1;

           |SI aAlfa1 = "N";
               #dsmoz072#nCampo# = ""; |PINTA #dsmoz072#nCampo#;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO repetir;
     aAlfa = #dsmoz072#17; |QBF aAlfa;
     |SI aAlfa ! "";
         |SI #dsmoz072#18 = "zzzzzzzzzzzz";
             #dsmoz072#18 = #dsmoz072#17; |PINTA #dsmoz072#18;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO dsmom002;
     aAlfa   = "31.12." + nEjer;  fFecFin = aAlfa;
     aAlfa   = "01.01." + nEjer;  fFecIni = aAlfa;

     aAlfa   = #dsmom002#8 % -104;
     |SI aAlfa ! "0000";
         nNume = aAlfa;
         |SI nNume > nEjer; |ACABA; |FINSI;

         |SI #dsmom002#8 > fFecIni; fFecIni = #dsmom002#8; |FINSI;
     |FINSI;

     aAlfa   = #dsmom002#9 % -104;
     |SI aAlfa ! "0000";
         nNume   = aAlfa;
         |SI nNume < nEjer;  |ACABA;  |FINSI;

         |SI #dsmom002#9 < fFecFin;  fFecFin = #dsmom002#9;  |FINSI;
     |FINSI;

     nExism002 = 0;
     aPeriodicidad = "T";  |SI nMod = 190; aPeriodicidad = "A"; |FINSI;
     |SI #dsmom002#7 = "MENSUAL   ";  aPeriodicidad = "M";  |FINSI;
|FPRC;

|DEFBUCLE dsmom002;
     #dsmom002#1;
     ;
     nEmpresa, 01, nMod;
     nEmpresa, 99, nMod;
     e;
     NULL, dsmom002;
|FIN;

|PROCESO LeeCliente;
     enCodCli = #dsmoz072#41;
     |HAZ LeePersona;

     |ABRE #clientes@;
     #clientes@#0 = enCodCli;
     |LEE 040#clientes@.=;
     |SI FSalida ! 0;
         |CIERRA #clientes@;
         |MENAV "     No existe el Cliente";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #clientes@;

     #dsmoz072#42 = #clientes@#1;
     aAlfa = #dsmoz072#42;  |QBF aAlfa;
     |SI aAlfa = "";  #dsmoz072#42 = #clientes@#2;  |FINSI;
     |PINTA #dsmoz072#42;

     nEjer    = #dsmoz072#2;
     nEmpresa = #dsmoz072#41;
     nMod  = #dsmoz072#48;

     aPeriodicidad = "M"; |SI nMod = 190; aPeriodicidad = "A"; |FINSI;
     nExism002 = 1;
     |BUCLE dsmom002;
     |SI nExism002 = 1;
         aAlfa1 = "    Error. Esta Empresa no hace el Modelo " + #dsmoz072#48;
         |MENAV aAlfa1;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO ParaBorrar; |TIPO 0;
   ||   aAlfa1 = "S";
   ||  |SI #dsmoz072#37 = "S"; aAlfa1 = "N"; |FINSI;
   ||  |C_M #dsmoz072#38, 1, aAlfa1;
|FPRC;

|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\
|PROCESO SelClave;
   nBorrar = 1;
   |SI #dsmoz072#22 = "N";
       nBorrar = 0;
       |SI #dsmoz072#23 = aClave; |Y #dsmoz072#24 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz072#25 = aClave; |Y #dsmoz072#26 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz072#27 = aClave; |Y #dsmoz072#28 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz072#29 = aClave; |Y #dsmoz072#30 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz072#31 = aClave; |Y #dsmoz072#32 = aSubClave; nBorrar = 1; |FINSI;
       |SI #dsmoz072#33 = aClave; |Y #dsmoz072#34 = aSubClave; nBorrar = 1; |FINSI;
   |FINSI;
|FPRC;

|| ///////////////////////////
|PROCESO EstadoM004;
    |SI nMod = 110;
        enDesdePase = 1;

        enEmpresa   = nEmpresaN;
        enEjer      = nEjer;
        enPeriodo   = nPeriodoN;
        enModelo    = 110;
        enComplem   = nCpl;
        enActividad = 1;
        enTipoEntrada = 98;

        |SI nEjer [ 2010;  |SUB_EJECUTA_NP "dsmoc110";  |FINSI;
        |SI nEjer = 2011;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2012;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2013;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2014;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2015;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer ] 2016;  |SUB_EJECUTA_NP "dsm11101";  |FINSI;

        enEmpresa   = nEmpresaN;
        enEjer      = nEjer;
        enPeriodo   = nPeriodoN;
        enModelo    = 110;
        enComplem   = nCpl;
        enActividad = 99;
        enTipoEntrada = 98;

        |SI nEjer [ 2010;  |SUB_EJECUTA_NP "dsmoc110";  |FINSI;
        |SI nEjer = 2011;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2012;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2013;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2014;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer = 2015;  |SUB_EJECUTA_NP "dsmoc111";  |FINSI;
        |SI nEjer ] 2016;  |SUB_EJECUTA_NP "dsm11101";  |FINSI;

        |HAZ ChequeaSituacion;  || Esta en el PLB
        #dsmom004#9 = " ";
        |GRABA 020#dsmom004.a;
        enDesdePase = 0;
   |FINSI;

   |SI nMod = 190;
       enEmpresa    = nEmpresaN;
       enEjer       = nEjer;
       enPeriodo    = nPer;
       enModelo     = nMod;
       enComplem    = nCpl;
       enActividad  = 0;
       enMensa      = 1;
       enTipoEntrada= 98;
       |SUB_EJECUTA_NP "dsm190ca";

       #dsmom004#7  = "X";
       #dsmom004#8  = ~;
       #dsmom004#9 = " ";
       #dsmom004#15 = 0;
       #dsmom004#17 = "COMPLETADO";

        |GRABA 020#dsmom004.a;
    |FINSI;
|FPRC;

|PROCESO BajaM008;
     |ABRE #dsmom008;
     #dsmom008#0 = nEmpresa;
     #dsmom008#1 = nEjer;
     #dsmom008#2 = nPer;
     #dsmom008#3 = nMod;
     #dsmom008#4 = nCpl;
     #dsmom008#5 = nActividad;
     |LEE 101#dsmom008.=;
     |SI FSalida = 0;
         #dsmom008#11 = "SIN DATOS";
         |GRABA 020#dsmom008.a;
     |FINSI;
     |LIBERA #dsmom008;
     |CIERRA #dsmom008;
|FPRC;

|PROCESO dsm190liB;
     aClave    = #dsm190li#9;
     aSubClave = #dsm190li#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsm190li.a;
         nCambio = 1;
         nActividad = #dsm190li#5;
         |HAZ BajaM008;
     |FINSI;
     |LIBERA #dsm190li;
|FPRC;

|DEFBUCLE dsm190liB;
  #dsm190li#1;
  ;
  nEmpresaN,nEjer,nPer,nMod,nCpl,00,#dsmoz072#17,#dsmoz072#19," ","  ",#dsmoz072#39;
  nEmpresaN,nEjer,nPer,nMod,nCpl,99,#dsmoz072#18,#dsmoz072#20,"z","zz",#dsmoz072#40;
  be;
  NULL, dsm190liB;
|FIN;

|PROCESO dsm19001B;
     aClave    = #dsm19001#9;
     aSubClave = #dsm19001#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsm19001.a;
         nCambio = 1;
         nActividad = #dsm19001#5;
         |HAZ BajaM008;
     |FINSI;
     |LIBERA #dsm19001;
|FPRC;

|DEFBUCLE dsm19001B;
  #dsm19001#1;
  ;
  nEmpresaN,nEjer,nPer,nMod,nCpl,00,#dsmoz072#17,#dsmoz072#19," ","  ",#dsmoz072#39;
  nEmpresaN,nEjer,nPer,nMod,nCpl,99,#dsmoz072#18,#dsmoz072#20,"z","zz",#dsmoz072#40;
  be;
  NULL, dsm19001B;
|FIN;

|PROCESO dsmoc110B;
     aClave    = #dsmoc110#8;
     aSubClave = #dsmoc110#9;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsmoc110.a;
         nCambio = 1;
         nActividad = #dsmoc110#5;
         |HAZ BajaM008;
     |FINSI;

     |LIBERA #dsmoc110;
|FPRC;

|DEFBUCLE dsmoc110B;
  #dsmoc110#1;
  ;
  nEmpresaN,nEjer,nPer,nMod,nCpl,nDActividad,#dsmoz072#17,0000," ","  ";
  nEmpresaN,nEjer,nPer,nMod,nCpl,nHActividad,#dsmoz072#18,9999,"z","zz";
  be;
  NULL, dsmoc110B;
|FIN;

|PROCESO dsmoc111B;
     aClave    = #dsmoc111#9;
     aSubClave = #dsmoc111#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsmoc111.a;
         nCambio = 1;
         nActividad = #dsmoc111#5;
         |HAZ BajaM008;
     |FINSI;
     |LIBERA #dsmoc111;
|FPRC;

|DEFBUCLE dsmoc111B;
  #dsmoc111#1;
  ;
  nEmpresaN,nEjer,nPer,nMod,nCpl,nDActividad,#dsmoz072#17,0000,00," ","  ",0;
  nEmpresaN,nEjer,nPer,nMod,nCpl,nHActividad,#dsmoz072#18,9999,99,"z","zz",9;
  be;
  NULL, dsmoc111B;
|FIN;

|PROCESO dsm11101B;
     aClave    = #dsm11101#9;
     aSubClave = #dsm11101#10;
     |HAZ SelClave;

     |SI nBorrar = 1;
         |BORRA 020#dsm11101.a;
         nCambio = 1;
         nActividad = #dsm11101#5;
         |HAZ BajaM008;
     |FINSI;
     |LIBERA #dsm11101;
|FPRC;

|DEFBUCLE dsm11101B;
  #dsm11101#1;
  ;
  nEmpresaN,nEjer,nPer,nMod,nCpl,nDActividad,#dsmoz072#17,0000,00," ","  ",0;
  nEmpresaN,nEjer,nPer,nMod,nCpl,nHActividad,#dsmoz072#18,9999,99,"z","zz",9;
  be;
  NULL, dsm11101B;
|FIN;

|PROCESO dsmom004_Borrar;
     nEjer = #dsmom004#1;
     nPer  = #dsmom004#2;
     nCpl  = #dsmom004#4;

     |SI nMod = 110;
         |SI nEjer [ 2010;  |BUCLE dsmoc110B;  |FINSI;
         |SI nEjer = 2011;  |BUCLE dsmoc111B;  |FINSI;
         |SI nEjer = 2012;  |BUCLE dsmoc111B;  |FINSI;
         |SI nEjer = 2013;  |BUCLE dsmoc111B;  |FINSI;
         |SI nEjer = 2014;  |BUCLE dsmoc111B;  |FINSI;
         |SI nEjer = 2015;  |BUCLE dsmoc111B;  |FINSI;
         |SI nEjer ] 2016;  |BUCLE dsm11101B;  |FINSI;

         |HAZ EstadoM004;
     |FINSI;

     |SI nMod = 190;
         |SI nEjer [ 2015;  |BUCLE dsm190liB;  |FINSI;
         |SI nEjer ] 2016;  |BUCLE dsm19001B;  |FINSI;

         |HAZ EstadoM004;
     |FINSI;

     |LIBERA #dsmom004;
|FPRC;

|DEFBUCLE dsmom004_Borrar;
   #dsmom004#1;
   ;
   nEmpresaN, nDEjer, nDPeriodo, nMod, nDComplem;
   nEmpresaN, nHEjer, nHPeriodo, nMod, nHComplem;
   be;
   NULL, dsmom004_Borrar;
|FIN;

|PROCESO CalculoNueva;
    nEmpresa = nEmpresaN;
    aPeriodicidad = "M"; |SI nMod = 190; aPeriodicidad = "A"; |FINSI;

    nExism002 = 1;
    |BUCLE dsmom002;
    |SI nExism002 = 1;
        aAlfa1 = "    Error. Esta Empresa no hace el Modelo " + #dsmoz072#48;
        |MENAV aAlfa1;
        |ACABA;
    |FINSI;
    aPerioNuevo = aPeriodicidad;

    |SI #dsmoz072#37 = "S";
        |BUCLE dsmom004_Borrar;
    |FINSI;

    enAnyo = nDEjer;
    enEmpresaA = nEmpresaN;
    |SUB_EJECUTA "dsmoz001";
|FPRC;

|| //////////////////////////////////////////////////////////////////
|PROCESO GrabaMoc110;
        |DDEFECTO #dsmodel@;
        #dsmodel@#0  = nEmpresaN;
        #dsmodel@#01 = #dsmoc110#01;
        #dsmodel@#02 = nPeriodoN;
        #dsmodel@#03 = #dsmoc110#03;
        #dsmodel@#04 = #dsmoc110#04;
        #dsmodel@#05 = #dsmoc110#05;
        #dsmodel@#06 = #dsmoc110#06;
        #dsmodel@#07 = #dsmoc110#07;
        #dsmodel@#08 = #dsmoc110#08;
        #dsmodel@#09 = #dsmoc110#09;
        |LEE 141#dsmodel@.=;
        |SI FSalida ! 0;
            |DDEFECTO #dsmodel@;
            |PARA nPara1 = 0; |SI nPara1 [ 31; |HACIENDO nPara1 = nPara1 + 1;
                  #dsmodel@#nPara1# = #dsmoc110#nPara1#;
            |SIGUE;
            #dsmodel@#0 = nEmpresaN;
            #dsmodel@#2 = nPeriodoN;
            |GRABA 020#dsmodel@.n;
        |SINO;
            |SI #dsmoz072#38 = "S";
                |PARA nPara1 = 10; |SI nPara1 [ 28; |HACIENDO nPara1 = nPara1 + 1;
                      #dsmodel@#nPara1# = #dsmoc110#nPara1#;
                |SIGUE;
                #dsmodel@#29 = #dsmoc110#29;
                #dsmodel@#30 = #dsmoc110#30;
                #dsmodel@#31 = #dsmoc110#31;
            |SINO;
                |PARA nPara1 = 10; |SI nPara1 [ 28; |HACIENDO nPara1 = nPara1 + 1;
                      #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsmoc110#nPara1#;
                |SIGUE;
                #dsmodel@#30 = #dsmodel@#30 + #dsmoc110#30;
                #dsmodel@#31 = #dsmodel@#31 + #dsmoc110#31;
            |FINSI;
            #dsmodel@#0 = nEmpresaN;
            #dsmodel@#2 = nPeriodoN;
            |GRABA 020#dsmodel@.a;
        |FINSI;
        |LIBERA #dsmodel@;
|FPRC;

|PROCESO dsmoc110;

    nActividad = #dsmoc110#5;
    aClave     = #dsmoc110#8;
    aSubClav e = #dsmoc110#9;
    |HAZ SelClave;
    |SI nBorrar = 0; |ACABA; |FINSI;

    |SI aPeriodicidad = aPerioNuevo;
        |HAZ GrabaMoc110;
    |SINO;
        |SALVA_DATOS #dsmoc110;

        |SI aPeriodicidad = "M";  ||... la nueva es trimestral
            |SI nPer = 1; |O nPer = 4; |O nPer = 7; |O nPer = 10;
                |HAZ GrabaMoc110;
            |FINSI;
            |SI nPer = 2; |O nPer = 5; |O nPer = 8; |O nPer = 11;
                |PARA nNume1 = 10; |SI nNume1 [ 14; |HACIENDO nNume1 = nNume1 + 1;
                      nNume2 = nNume1 + 5;
                      #dsmoc110#nNume2# = #dsmoc110#nNume1#;
                      #dsmoc110#nNume1# = 0;
                |SIGUE;
                |HAZ GrabaMoc110;
            |FINSI;
            |SI nPer = 3; |O nPer = 6; |O nPer = 9; |O nPer = 12;
                |PARA nNume1 = 10; |SI nNume1 [ 14; |HACIENDO nNume1 = nNume1 + 1;
                      nNume2 = nNume1 + 10;
                      #dsmoc110#nNume2# = #dsmoc110#nNume1#;
                      #dsmoc110#nNume1# = 0;
                |SIGUE;
                |HAZ GrabaMoc110;
            |FINSI;
        |FINSI;
        |SI aPeriodicidad = "T";  ||... la nueva es Mensual
            |SI nPer = 3;   nPeriodoN = 1;  |FINSI;
            |SI nPer = 6;   nPeriodoN = 4;  |FINSI;
            |SI nPer = 9;   nPeriodoN = 7;  |FINSI;
            |SI nPer = 12;  nPeriodoN = 10; |FINSI;

            |PDEFECTO #dsmoc110, 15, 29;
            |HAZ GrabaMoc110;

            |REPON_DATOS #dsmoc110;
            |SALVA_DATOS #dsmoc110;

            |SI nPer = 3;   nPeriodoN = 2;  |FINSI;
            |SI nPer = 6;   nPeriodoN = 5;  |FINSI;
            |SI nPer = 9;   nPeriodoN = 8;  |FINSI;
            |SI nPer = 12;  nPeriodoN = 11; |FINSI;

            |PDEFECTO #dsmoc110, 20, 29;
            |PARA nNume1 = 10; |SI nNume1 [ 14; |HACIENDO nNume1 = nNume1 + 1;
                  nNume2 = nNume1 + 5;
                  #dsmoc110#nNume1# = #dsmoc110#nNume2#;
                  #dsmoc110#nNume2# = 0;
            |SIGUE;
            |HAZ GrabaMoc110;

            |REPON_DATOS #dsmoc110;
            |SALVA_DATOS #dsmoc110;

            nPeriodoN = nPer;
            |PDEFECTO #dsmoc110, 10, 19;
            |PARA nNume1 = 10; |SI nNume1 [ 14; |HACIENDO nNume1 = nNume1 + 1;
                  nNume2 = nNume1 + 10;
                  #dsmoc110#nNume1# = #dsmoc110#nNume2#;
                  #dsmoc110#nNume2# = 0;
            |SIGUE;
            |HAZ GrabaMoc110;
        |FINSI;
        |REPON_DATOS #dsmoc110;
    |FINSI;

    nCambio = 1;
    |LIBERA #dsmoc110;
|FPRC;

|DEFBUCLE dsmoc110;
  #dsmoc110#1;
  ;
  nEmpresa,nEjer,nPer,nMod,nCpl,#dsmoz072#46,#dsmoz072#17,#dsmoz072#19," ","  ";
  nEmpresa,nEjer,nPer,nMod,nCpl,#dsmoz072#47,#dsmoz072#18,#dsmoz072#20,"z","zz";
  be;
  NULL, dsmoc110;
|FIN;

|| //////////////////////////////////////////////

|PROCESO GrabaMoc111;
        |DDEFECTO #dsmodel@;
        #dsmodel@#0  = nEmpresaN;
        #dsmodel@#01 = #dsmoc111#01;
        #dsmodel@#02 = nPeriodoN;
        #dsmodel@#03 = #dsmoc111#03;
        #dsmodel@#04 = #dsmoc111#04;
        #dsmodel@#05 = #dsmoc111#05;
        #dsmodel@#06 = #dsmoc111#06;
        #dsmodel@#07 = #dsmoc111#07;
        #dsmodel@#08 = #dsmoc111#08;
        #dsmodel@#09 = #dsmoc111#09;
        #dsmodel@#10 = #dsmoc111#10;
        #dsmodel@#11 = #dsmoc111#11;
        |LEE 141#dsmodel@.=;
        |SI FSalida ! 0;
            |DDEFECTO #dsmodel@;
            |PARA nPara1 = 0; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
                  #dsmodel@#nPara1# = #dsmoc111#nPara1#;
            |SIGUE;
            #dsmodel@#0 = nEmpresaN;
            #dsmodel@#2 = nPeriodoN;
            |GRABA 020#dsmodel@.n;
        |SINO;
            |SI #dsmoz072#38 = "S";
                |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                      #dsmodel@#nPara1# = #dsmoc111#nPara1#;
                |SIGUE;
                #dsmodel@#21 = #dsmoc111#21;
                #dsmodel@#22 = #dsmoc111#22;
                #dsmodel@#23 = #dsmoc111#23;
            |SINO;
                |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                      #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsmoc111#nPara1#;
                |SIGUE;
                #dsmodel@#22 = #dsmodel@#22 + #dsmoc111#22;
                #dsmodel@#23 = #dsmodel@#23 + #dsmoc111#23;
            |FINSI;
            |GRABA 020#dsmodel@.a;
        |FINSI;
        |LIBERA #dsmodel@;
|FPRC;

|PROCESO dsmoc111;
    nActividad = #dsmoc111#5;
    aClave     = #dsmoc111#9;
    aSubClave  = #dsmoc111#10;
    |HAZ SelClave;
    |SI nBorrar = 0; |ACABA; |FINSI;

    |SI aPeriodicidad = aPerioNuevo; |O aPerioNuevo = "T";
        |HAZ GrabaMoc111;
    |SINO;
        ||... la nueva es Mensual la anterior trimestral
        nPeriodoN = nPer;
        |SI #dsmoc111#7 = 0;
            |SI nPer = 3;  |Y #dsmoc111#8 [ 3;                nPeriodoN = #dsmoc111#8; |FINSI;
            |SI nPer = 6;  |Y #dsmoc111#8 > 3; |Y #dsmoc111#8 [ 6; nPeriodoN = #dsmoc111#8; |FINSI;
            |SI nPer = 9;  |Y #dsmoc111#8 > 6; |Y #dsmoc111#8 [ 9; nPeriodoN = #dsmoc111#8; |FINSI;
            |SI nPer = 12; |Y #dsmoc111#8 > 9; |Y #dsmoc111#8 [12; nPeriodoN = #dsmoc111#8; |FINSI;
        |FINSI;
        |HAZ GrabaMoc111;
    |FINSI;

    nCambio = 1;
    |LIBERA #dsmoc111;
|FPRC;

|DEFBUCLE dsmoc111;
  #dsmoc111#1;
  ;
  nEmpresa,nEjer,nPer,nMod,nCpl,#dsmoz072#46,#dsmoz072#17,#dsmoz072#19,00," ","  ",#dsmoz072#39;
  nEmpresa,nEjer,nPer,nMod,nCpl,#dsmoz072#47,#dsmoz072#18,#dsmoz072#20,99,"z","zz",#dsmoz072#40;
  be;
  NULL, dsmoc111;
|FIN;

|| //////////////////////////////////////////////

|PROCESO GrabaM11101;
     |DDEFECTO #dsmodel@;
     #dsmodel@#0  = nEmpresaN;
     #dsmodel@#01 = #dsm11101#01;
     #dsmodel@#02 = nPeriodoN;
     #dsmodel@#03 = #dsm11101#03;
     #dsmodel@#04 = #dsm11101#04;
     #dsmodel@#05 = #dsm11101#05;
     #dsmodel@#06 = #dsm11101#06;
     #dsmodel@#07 = #dsm11101#07;
     #dsmodel@#08 = #dsm11101#08;
     #dsmodel@#09 = #dsm11101#09;
     #dsmodel@#10 = #dsm11101#10;
     #dsmodel@#11 = #dsm11101#11;
     |LEE 141#dsmodel@.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmodel@;
         |PARA nPara1 = 0; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
               #dsmodel@#nPara1# = #dsm11101#nPara1#;
         |SIGUE;
         #dsmodel@#0 = nEmpresaN;
         #dsmodel@#2 = nPeriodoN;
         |GRABA 020#dsmodel@.n;
     |SINO;
         |SI #dsmoz072#38 = "S";
             |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsm11101#nPara1#;
             |SIGUE;

             |PARA nPara1 = 25; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsm11101#nPara1#;
             |SIGUE;

             #dsmodel@#21 = #dsm11101#21;
             #dsmodel@#22 = #dsm11101#22;
             #dsmodel@#23 = #dsm11101#23;
         |SINO;
             |PARA nPara1 = 12; |SI nPara1 [ 20; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsm11101#nPara1#;
             |SIGUE;

             |PARA nPara1 = 25; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsm11101#nPara1#;
             |SIGUE;

             #dsmodel@#22 = #dsmodel@#22 + #dsm11101#22;
             #dsmodel@#23 = #dsmodel@#23 + #dsm11101#23;
         |FINSI;
         |GRABA 020#dsmodel@.a;
     |FINSI;
     |LIBERA #dsmodel@;
|FPRC;

|PROCESO dsm11101;
     nActividad = #dsm11101#5;
     aClave     = #dsm11101#9;
     aSubClave  = #dsm11101#10;
     |HAZ SelClave;
     |SI nBorrar = 0; |ACABA; |FINSI;

     |SI aPeriodicidad = aPerioNuevo; |O aPerioNuevo = "T";
         |HAZ GrabaM11101;
     |SINO;
         nPeriodoN = nPer;
         |SI #dsm11101#7 = 0;
             |SI nPer = 3;  |Y #dsm11101#8 [ 3;                nPeriodoN = #dsm11101#8; |FINSI;
             |SI nPer = 6;  |Y #dsm11101#8 > 3; |Y #dsm11101#8 [ 6; nPeriodoN = #dsm11101#8; |FINSI;
             |SI nPer = 9;  |Y #dsm11101#8 > 6; |Y #dsm11101#8 [ 9; nPeriodoN = #dsm11101#8; |FINSI;
             |SI nPer = 12; |Y #dsm11101#8 > 9; |Y #dsm11101#8 [12; nPeriodoN = #dsm11101#8; |FINSI;
         |FINSI;
         |HAZ GrabaM11101;
     |FINSI;

     nCambio = 1;
     |LIBERA #dsm11101;
|FPRC;

|DEFBUCLE dsm11101;
  #dsm11101#1;
  ;
  nEmpresa,nEjer,nPer,nMod,nCpl,#dsmoz072#46,#dsmoz072#17,#dsmoz072#19,00," ","  ",#dsmoz072#39;
  nEmpresa,nEjer,nPer,nMod,nCpl,#dsmoz072#47,#dsmoz072#18,#dsmoz072#20,99,"z","zz",#dsmoz072#40;
  be;
  NULL, dsm11101;
|FIN;

|| ///////////////////////////

|PROCESO dsm190li;
     nActividad = #dsm190li#5;
     aClave     = #dsm190li#8;
     aSubClave  = #dsm190li#9;
     |HAZ SelClave;
     |SI nBorrar = 0; |ACABA; |FINSI;

     |DDEFECTO #dsmodel@;
     #dsmodel@#0  = nEmpresaN;
     #dsmodel@#01 = #dsm190li#01;
     #dsmodel@#02 = #dsm190li#02;
     #dsmodel@#03 = #dsm190li#03;
     #dsmodel@#04 = #dsm190li#04;
     #dsmodel@#05 = #dsm190li#05;
     #dsmodel@#06 = #dsm190li#06;
     #dsmodel@#07 = #dsm190li#07;
     #dsmodel@#08 = #dsm190li#08;
     #dsmodel@#09 = #dsm190li#09;
     #dsmodel@#10 = #dsm190li#10;
     |LEE 141#dsmodel@.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmodel@;
         |PARA nPara1 = 0; |SI nPara1 [ 64; |HACIENDO nPara1 = nPara1 + 1;
               #dsmodel@#nPara1# = #dsm190li#nPara1#;
         |SIGUE;
         #dsmodel@#0 = nEmpresaN;
         |GRABA 020#dsmodel@.n;
     |SINO;
         |SI #dsmoz072#38 = "S";
             |PARA nPara1 = 16; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsm190li#nPara1#;
             |SIGUE;
         |SINO;
             |PARA nPara1 = 16; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsm190li#nPara1#;
             |SIGUE;
         |FINSI;
         |GRABA 020#dsmodel@.a;
     |FINSI;
     |LIBERA #dsmodel@;
     |LIBERA #dsm190li;

     nCambio = 1;
|FPRC;

|DEFBUCLE dsm190li;
  #dsm190li#1;
  ;
  nEmpresa,nEjer,nPer,nMod,nCpl,00,#dsmoz072#17,#dsmoz072#19," ","  ",#dsmoz072#39;
  nEmpresa,nEjer,nPer,nMod,nCpl,99,#dsmoz072#18,#dsmoz072#20,"z","zz",#dsmoz072#40;
  be;
  NULL, dsm190li;
|FIN;

|PROCESO dsm19001;
     nActividad = #dsm19001#5;
     aClave     = #dsm19001#8;
     aSubClave  = #dsm19001#9;
     |HAZ SelClave;
     |SI nBorrar = 0; |ACABA; |FINSI;

     |DDEFECTO #dsmodel@;
     #dsmodel@#0  = nEmpresaN;
     #dsmodel@#01 = #dsm19001#01;
     #dsmodel@#02 = #dsm19001#02;
     #dsmodel@#03 = #dsm19001#03;
     #dsmodel@#04 = #dsm19001#04;
     #dsmodel@#05 = #dsm19001#05;
     #dsmodel@#06 = #dsm19001#06;
     #dsmodel@#07 = #dsm19001#07;
     #dsmodel@#08 = #dsm19001#08;
     #dsmodel@#09 = #dsm19001#09;
     #dsmodel@#10 = #dsm19001#10;
     |LEE 141#dsmodel@.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmodel@;
         |PARA nPara1 = 0; |SI nPara1 [ 69; |HACIENDO nPara1 = nPara1 + 1;
               #dsmodel@#nPara1# = #dsm19001#nPara1#;
         |SIGUE;
         #dsmodel@#0 = nEmpresaN;
         |GRABA 020#dsmodel@.n;
     |SINO;
         |SI #dsmoz072#38 = "S";
             |PARA nPara1 = 16; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsm19001#nPara1#;
             |SIGUE;

             |PARA nPara1 = 65; |SI nPara1 [ 69; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsm19001#nPara1#;
             |SIGUE;
         |SINO;
             |PARA nPara1 = 16; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsm19001#nPara1#;
             |SIGUE;

             |PARA nPara1 = 65; |SI nPara1 [ 69; |HACIENDO nPara1 = nPara1 + 1;
                   #dsmodel@#nPara1# = #dsmodel@#nPara1# + #dsm19001#nPara1#;
             |SIGUE;
         |FINSI;
         |GRABA 020#dsmodel@.a;
     |FINSI;
     |LIBERA #dsmodel@;
     |LIBERA #dsm19001;

     nCambio = 1;
|FPRC;

|DEFBUCLE dsm19001;
  #dsm19001#1;
  ;
  nEmpresa,nEjer,nPer,nMod,nCpl,00,#dsmoz072#17,#dsmoz072#19," ","  ",#dsmoz072#39;
  nEmpresa,nEjer,nPer,nMod,nCpl,99,#dsmoz072#18,#dsmoz072#20,"z","zz",#dsmoz072#40;
  be;
  NULL, dsm19001;
|FIN;

|| /////////////////////////////////////////////////

|PROCESO CalculoPeriodo;
     |SI aPerioNuevo = "T";
         |SI nPer [ 3;              nPeriodoN = 3;  |FINSI;
         |SI nPer > 3; |Y nPer [ 6; nPeriodoN = 6;  |FINSI;
         |SI nPer > 6; |Y nPer [ 9; nPeriodoN = 9;  |FINSI;
         |SI nPer > 9;              nPeriodoN = 12; |FINSI;
     |FINSI;

     |SI aPerioNuevo = "M";
         nPeriodoN = nPer;
     |FINSI;
|FPRC;

|PROCESO dsmom004;
     nEjer = #dsmom004#1;
     nPer  = #dsmom004#2;
     nCpl  = #dsmom004#4;
     |SI aPeriodicidad = aPerioNuevo; |O nMod = 190;
         nPeriodoN = nPer;
     |SINO;
         |HAZ CalculoPeriodo;
     |FINSI;

     |SI nMod = 110;
         nCambio = 0;

         |ABRE #dsmodel@;
         |SI #dsmoz072#2 [ 2010;  |BUCLE dsmoc110;  |FINSI;
         |SI #dsmoz072#2 = 2011;  |BUCLE dsmoc111;  |FINSI;
         |SI #dsmoz072#2 = 2012;  |BUCLE dsmoc111;  |FINSI;
         |SI #dsmoz072#2 = 2013;  |BUCLE dsmoc111;  |FINSI;
         |SI #dsmoz072#2 = 2014;  |BUCLE dsmoc111;  |FINSI;
         |SI #dsmoz072#2 = 2015;  |BUCLE dsmoc111;  |FINSI;
         |SI #dsmoz072#2 ] 2016;  |BUCLE dsm11101;  |FINSI;
         |CIERRA #dsmodel@;
     |FINSI;

     |SI nMod = 190;
         nCambio = 0;
         |ABRE #dsmodel@;
         |SI #dsmoz072#2 [ 2015;  |BUCLE dsm190li;  |FINSI;
         |SI #dsmoz072#2 ] 2016;  |BUCLE dsm19001;  |FINSI;
         |CIERRA #dsmodel@;
     |FINSI;

     |SI nCambio = 1;
         |SALVA_FICHA #dsmom004;
         |SI aPeriodicidad = aPerioNuevo; |O aPerioNuevo = "T"; |O nMod = 190;
             #dsmom004#0 = nEmpresaN;
             #dsmom004#1 = nEjer;
             #dsmom004#2 = nPeriodoN;
             |LEE 101#dsmom004.=;
             |HAZ EstadoM004;
         |SINO;
             |SI nPer =  3; nPeriodoN =  1; |FINSI;
             |SI nPer =  6; nPeriodoN =  4; |FINSI;
             |SI nPer =  9; nPeriodoN =  7; |FINSI;
             |SI nPer = 12; nPeriodoN = 10; |FINSI;
             #dsmom004#0 = nEmpresaN;
             #dsmom004#1 = nEjer;
             #dsmom004#2 = nPeriodoN;
             |LEE 101#dsmom004.=;
             |HAZ EstadoM004;
             |SI nPer =  3; nPeriodoN =  2; |FINSI;
             |SI nPer =  6; nPeriodoN =  5; |FINSI;
             |SI nPer =  9; nPeriodoN =  8; |FINSI;
             |SI nPer = 12; nPeriodoN = 11; |FINSI;
             #dsmom004#0 = nEmpresaN;
             #dsmom004#1 = nEjer;
             #dsmom004#2 = nPeriodoN;
             |LEE 101#dsmom004.=;
             |HAZ EstadoM004;

             nPeriodoN = nPer;
             #dsmom004#0 = nEmpresaN;
             #dsmom004#1 = nEjer;
             #dsmom004#2 = nPeriodoN;
             |LEE 101#dsmom004.=;
             |HAZ EstadoM004;
         |FINSI;
         |REPON_FICHA #dsmom004;
     |FINSI;

     |LIBERA #dsmom004;
|FPRC;

|DEFBUCLE dsmom004;
     #dsmom004#1;
     ;
     nEmpresa, nDEjer, nDPeriodo, nMod, nDComplem;
     nEmpresa, nHEjer, nHPeriodo, nMod, nHComplem;
     be;
     NULL, dsmom004;
|FIN;

|PROCESO agifigen;
     nEmpresa = #agifigen#0;

                     aPeriodicidad = "M";
     |SI nMod = 190; aPeriodicidad = "A"; |FINSI;

     nExism002 = 1;
     |BUCLE dsmom002;

     |BUCLE dsmom004;
|FPRC;

|DEFBUCLE agifigen;
     #agifigen#1;
     ;
     nDEmpresa;
     nHEmpresa;
     ;
     NULL, agifigen;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     #dsmoz072#45 = #dsmoz072#2;   ||solo un ejercicio
     nEmpresaN    = #dsmoz072#41;   ||Empresa Nueva
     nMod         = #dsmoz072#48;
     nEjer        = #dsmoz072#2;
     nDEjer       = #dsmoz072#2;
     nHEjer       = #dsmoz072#45;
     nDPeriodo    = #dsmoz072#0;
     nHPeriodo    = #dsmoz072#43;
     nDComplem    = #dsmoz072#35;
     nHComplem    = #dsmoz072#36;
     nDActividad  = #dsmoz072#46;
     nHActividad  = #dsmoz072#47;

     |HAZ CalculoNueva;
     |SI nExism002 = 1;
         |ACABA;
     |FINSI;

     |SI nMod = 110;
                                 aNomDef = "dsm11101.mas";
         |SI #dsmoz072#2 [ 2010; aNomDef = "dsmoc110.mas"; |FINSI;
         |SI #dsmoz072#2 = 2011; aNomDef = "dsmoc111.mas"; |FINSI;
         |SI #dsmoz072#2 = 2012; aNomDef = "dsmoc111.mas"; |FINSI;
         |SI #dsmoz072#2 = 2013; aNomDef = "dsmoc111.mas"; |FINSI;
         |SI #dsmoz072#2 = 2014; aNomDef = "dsmoc111.mas"; |FINSI;
         |SI #dsmoz072#2 = 2015; aNomDef = "dsmoc111.mas"; |FINSI;
     |SINO;
                                 aNomDef = "dsm19001.mas";
         |SI #dsmoz072#2 [ 2015; aNomDef = "dsm190li.mas"; |FINSI;
     |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/"+ aNomDef;
     |CARGA_DEF aMas, dsmodel@;
     |SI FSalida ! 0;
         |MENAV "    Error al carga el def " + aNomDef;
         |ACABA;
     |FINSI;

     |SI #dsmoz072#3 ! 0;
         nDEmpresa = #dsmoz072#3;
         nHEmpresa = #dsmoz072#4;
         |BUCLE agifigen;
     |SINO;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoz072#nCampo# ! 0;
                   nDEmpresa = #dsmoz072#nCampo#;
                   nHEmpresa = #dsmoz072#nCampo#;
                   |BUCLE agifigen;
               |FINSI;
         |SIGUE;
     |FINSI;

     |DESCARGA_DEF #dsmodel@;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     |DDEFECTO #dsmoz072;
     |ABRE #dsmoz072;
     |LEE 101#dsmoz072.p;
     |SI FSalida ! 0;
         |DDEFECTO #dsmoz072;
         fFecha = ~;
         aAlfa   = fFecha % -104;
         #dsmoz072#2    = aAlfa; #dsmoz072#2   = #dsmoz072#2 - 1;
         #dsmoz072#45   = #dsmoz072#2;
         |GRABA 020#dsmoz072.b;
     |FINSI;

     |CLS;
     |PINPA #0#dsmoz072;

     |C_M #dsmoz072#48,1, "S";
     |SI aParam ! "";
         #dsmoz072#48 = aParam; |C_M #dsmoz072#48,1, "N";
         |PINTA 0536, "                                       ";

         |SI aParam = "110";
             aAlfa = "l Modelo 110/111 a otra Empresa";
         |SINO;
             aAlfa = "l Modelo 190 a otra Empresa";
         |FINSI;

         |ATRI R; |PINTA 0536, aAlfa; |ATRI 0;
     |FINSI;

     |PINDA #0#dsmoz072;

     |ENDATOS #1#dsmoz072;
     |SI FSalida = 0;
         |GRABA 020#dsmoz072.a;
     |FINSI;
     |LIBERA #dsmoz072;
     |CIERRA #dsmoz072;
|FPRO;
