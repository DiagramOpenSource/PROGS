|FICHEROS;
     dsmoy000 #0;
     dsmom001 #1;
     dsmom004 #4;
     dsmom999 #199;

     dsm39201 #390;
     dsm39202 #490;
     dsm39203 #590;
     dsm39204 #690;

     dsmow014 #999;

     dsmow551 #551;  || Def Secuencial 2002
     dsmow552 #552;
     dsmow553 #553;
     dsmow554 #554;
     dsmow555 #555;
     dsmow556 #556;

     :/basica/def/agim0004 #24;
     :/basica/def/agicen15 #1015;

     &regisnif@ #709;
     &clientes@ #715;
     &datosper@ #718;
|FIN;

|VARIABLES;
     aLetrasCif      = "ABCDEFGHNPQSKLMJUVWR";

     nGrupo          = 0;
     nSubGrupo       = 0;
     nCampo1         = 0;
     nCampo2         = 0;
     nCampo3         = 0;
     nCampo4         = 0;
     nCampo5         = 0;
     nCampo6         = 0;
     nSwHay          = 0;
     nModulos        = 0;
     nLineaC         = 0;
     nTopeD          = 0;
     nTopeH          = 0;
     nComple         = 0;
     nComplementaria = 0;
     nImpreLaser     = 0;

     &enEjer         = 0;
     &enComplem      = 0;
     &enTipoEntrada  = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO BuscaComuneros392;
     aAlfa = "31.12." + #390#1;
     |SI #1#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #390#1;
     |SI #1#9 > "01.01.0000";
         |SI #1#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     enComuneros = 1;

     enCodCli = #1#3;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #551#37 = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;     #551#38 = eaAlfa;
         #551#39  = #715#29;
         eaAlfa   = #715#30;  |HAZ QuitaRaros;    #551#40 = eaAlfa;
         #551#41  = #715#31 % 104;
         #551#42  = #715#32;
         #551#43  = #715#33;
         #551#44  = #715#34;
         eaAlfa   = #715#54;  |HAZ QuitaRarosTfno;  #551#45  = eaAlfa;
         eaAlfa   = #715#37;  |HAZ QuitaRaros;      #551#46  = eaAlfa;
         eaAlfa   = #715#38;  |HAZ QuitaRaros;      #551#47  = eaAlfa;
         #551#48 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
     |SINO;
         eaVarDni = #715#13; |HAZ CalculameDNI;     #551#37  = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;       #551#38  = eaAlfa;
         #551#39  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;       #551#40  = eaAlfa;
         #551#41  = #715#5 % 104;
         #551#42  = #715#6;
         #551#43  = #715#7;
         #551#44  = #715#8;
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno;  #551#45  = eaAlfa;
         eaAlfa   = #715#11;  |HAZ QuitaRaros;      #551#46  = eaAlfa;
         eaAlfa   = #715#12;  |HAZ QuitaRaros;      #551#47  = eaAlfa;
         #551#48  = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #1#1;
     ;
     #390#0, 01, 0001;
     #390#0, 99, 9999;
     ;
     NULL, BuscaComuneros392;
|FIN;

|PROCESO PonRepresentantes392;
     nLinea = nLinea + 1;
     |SI nLinea = 1;
         eaAlfa   = #24#3;   |HAZ QuitaRaros;     #551#54  = eaAlfa;
         eaVarDni = #24#2;   |HAZ CalculameDNI;   #551#55  = eaVarDni;
         #551#56  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
         eaAlfa   = #24#5;   |HAZ QuitaRaros;     #551#57  = eaAlfa;
     |FINSI;

     |SI nLinea = 2;
         eaAlfa   = #24#3;   |HAZ QuitaRaros;     #551#58  = eaAlfa;
         eaVarDni = #24#2;   |HAZ CalculameDNI;   #551#59  = eaVarDni;
         #551#60  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
         eaAlfa   = #24#5;   |HAZ QuitaRaros;     #551#61  = eaAlfa;
     |FINSI;

     |SI nLinea = 3;
         eaAlfa   = #24#3;   |HAZ QuitaRaros;     #551#62  = eaAlfa;
         eaVarDni = #24#2;   |HAZ CalculameDNI;   #551#63  = eaVarDni;
         #551#64  = (#24#4 % 102) + (#24#4 % 402) + (#24#4 % -104);
         eaAlfa   = #24#5;   |HAZ QuitaRaros;     #551#65  = eaAlfa;
     |FINSI;

     |SI nLinea = 3;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE agim0004;
     #24#1;
     ;
     #390#0, 01;
     #390#0, 99;
     ;
     NULL, PonRepresentantes392;
|FIN;

|PROCESO BuscaFirmantes392;
     enComuneros = 0;
     |BUCLE dsmom001;
     |SI enComuneros = 1;  |O eaComBienes = "S";
         #551#49 = (#0#7 % 102) + (#0#7 % 402) + (#0#7 % -104);

         |SI enComuneros = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #551#49 = "        ";
         nLinea = 0;
         |BUCLE agim0004;
         eaAlfa  = #0#7;  |HAZ FechaBonito;
         |SI nLinea = 0;
             #551#49 = (#0#7 % 102) + (#0#7 % 402) + (#0#7 % -104);
         |SINO;
             #551#50 = #551#14;
             #551#51 = eaDiaB;
             #551#52 = eaMesB;
             #551#53 = eaAnyoB;
         |FINSI;
     |FINSI;

     |SI #551#49 ! "        ";
         aAlfa = #551#54;  |QBF aAlfa;
         |SI #551#37 = "         ";  |Y aAlfa = "";
             |ABRE #1015;
             #1015#0 = #390#0;
             |LEE 000#1015=;
             |SI FSalida ! 0;  |DDEFECTO #1015;  |FINSI;
             |CIERRA #1015;

             |SI #1015#0 =  "            ";  |ACABA;  |FINSI;

             enCodCli = #390#0;
             |HAZ LeePersona;
             |SI enSwDeDonde = 1;
                 |SI #715#3  = #1015#4;  |ACABA;  |FINSI;
             |SINO;
                 |SI #715#13 = #1015#4;  |ACABA;  |FINSI;
             |FINSI;

             eaVarDni = #1015#4;  |HAZ CalculameDNI;   #551#37 = eaVarDni;
             eaAlfa   = #1015#5;  |HAZ QuitaRaros;     #551#38 = eaAlfa;
             #551#39  = #1015#8;
             eaAlfa   = #1015#9;  |HAZ QuitaRaros;     #551#40 = eaAlfa;
             #551#41  = #1015#10 % 104;
             #551#42  = #1015#11;
             #551#43  = #1015#12;
             #551#44  = #1015#13;
             eaAlfa   = #1015#14;  |HAZ QuitaRarosTfno;  #551#45  = eaAlfa;
             eaAlfa   = #1015#17;  |HAZ QuitaRaros;      #551#46  = eaAlfa;
             eaAlfa   = #1015#18;  |HAZ QuitaRaros;      #551#47  = eaAlfa;
             #551#48 = (("00" + #1015#15) % -102) + (("000" + #1015#16) % -103);
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Regis392T1A2002;
     |ABRE #390;
     #390#0 = #4#0;
     #390#1 = #4#1;
     #390#2 = #4#3;
     #390#3 = #4#4;
     |LEE 040#390=;
     |SI FSalida ! 0;  |CIERRA #390;  |ACABA;  |FINSI;
     |CIERRA #390;

     enCodCli = #390#0;
     |HAZ LeePersona;

     |DDEFECTO #551;

     #551#1  = "<T";
     #551#2  = "392";
     #551#3  = "01";
     #551#4  = ">";
     #551#5  = "";

     |SI enSwDeDonde = 1;
         #551#6   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #551#7   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #551#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #551#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #551#8  = eaAlfa;
             aCaracter  = eaVarDni % 101;
             aAlfa      = aLetrasCif - aCaracter;
             |SI aAlfa  = aLetrasCif;  #551#9 = ".";  |FINSI;
         |FINSI;

         #551#10  = #715#29;
         eaAlfa   = #715#30;  |HAZ QuitaRaros;  #551#11 = eaAlfa;
         #551#12  = #715#31 % 104;
         eaEscal  = #715#32 % 102;  |QBF eaEscal;
         eaPiso   = #715#33;        |QBF eaPiso;
         eaPuerta = #715#34;        |QBF eaPuerta;

         eaAlfa    = #715#55;  |QBF eaAlfa;
         |SI eaAlfa = "";  eaAlfa  = #715#54;  |FINSI;

         |HAZ QuitaRarosTfno;  #551#13 = eaAlfa;

         eaAlfa   = #715#37;  |HAZ QuitaRaros;  #551#14 = eaAlfa;
         eaAlfa   = #715#38;  |HAZ QuitaRaros;  #551#15 = eaAlfa;

         #551#16 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;
         eaComBienes = #715#12;
     |SINO;
         #551#6   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13; |HAZ CalculameDNI;    #551#7  = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #551#8  = eaAlfa;

         aCaracter  = eaVarDni % 101;
         aAlfa      = aLetrasCif - aCaracter;
         |SI aAlfa  = aLetrasCif;  #551#9 = ".";  |FINSI;

         #551#10  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #551#11 = eaAlfa;
         #551#12  = #715#5 % 104;
         eaEscal  = #715#6 % 102;  |QBF eaEscal;
         eaPiso   = #715#7;        |QBF eaPiso;
         eaPuerta = #715#8;        |QBF eaPuerta;
         eaAlfa   = #715#14;  |HAZ QuitaRarosTfno; #551#13 = eaAlfa;
         eaAlfa   = #715#11;  |HAZ QuitaRaros;     #551#14 = eaAlfa;
         eaAlfa   = #715#12;  |HAZ QuitaRaros;     #551#15 = eaAlfa;
         #551#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;
     |FINSI;

     #551#17 = "0";
     |SI #390#47 = "X";  #551#17  = "1";  |FINSI;

     #551#18  = #390#1;

     |SI #390#24 = "9999";  #390#24 = "";  |FINSI;
     |SI #390#28 = "9999";  #390#28 = "";  |FINSI;
     |SI #390#32 = "9999";  #390#32 = "";  |FINSI;
     |SI #390#36 = "9999";  #390#36 = "";  |FINSI;
     |SI #390#40 = "9999";  #390#40 = "";  |FINSI;
     |SI #390#44 = "9999";  #390#44 = "";  |FINSI;

     eaAlfa   = #390#25;  |HAZ QuitaRaros;      #551#19 = eaAlfa;
     #551#20  = #390#26;
     #551#21  = #390#24;
     eaAlfa   = #390#29;  |HAZ QuitaRaros;      #551#22 = eaAlfa;
     #551#23  = #390#30;
     #551#24  = #390#28;
     eaAlfa   = #390#33;  |HAZ QuitaRaros;      #551#25 = eaAlfa;
     #551#26  = #390#34;
     #551#27  = #390#32;
     eaAlfa   = #390#37;  |HAZ QuitaRaros;      #551#28 = eaAlfa;
     #551#29  = #390#38;
     #551#30  = #390#36;
     eaAlfa   = #390#41;  |HAZ QuitaRaros;      #551#31 = eaAlfa;
     #551#32  = #390#42;
     #551#33  = #390#40;
     eaAlfa   = #390#45;  |HAZ QuitaRaros;      #551#34 = eaAlfa;
     #551#35  = #390#46;
     #551#36  = #390#44;

     |HAZ BuscaFirmantes392;

     #551#68 = "</T39201>";
     #551#69 = &13 + &10;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 69;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #551nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO LeeCasilla392;
     #490#0  = #390#0;
     #490#1  = #390#1;
     #490#2  = #390#2;
     #490#3  = #390#3;
     #490#4  = nGrupo;
     #490#5  = nSubGrupo;
     |SELECT #1#490;
     |LEE 040#490=;
     |SI FSalida ! 0;  |DDEFECTO #490;  |FINSI;
|FPRC;

|PROCESO LeeCasilla392_2;
     #490#0  = #390#0;
     #490#1  = #390#1;
     #490#2  = #390#2;
     #490#3  = #390#3;
     #490#24 = nGrupo;
     #490#25 = nSubGrupo;
     |SELECT #2#490;
     |LEE 040#490=;
     |SI FSalida ! 0;  |DDEFECTO #490;  |FINSI;
|FPRC;

|PROCESO Regis392T2A2002;
     |DDEFECTO #552;

     |ABRE #490;

     nSwHay = 0;
     #552#1 = "<T";
     #552#2 = "392";
     #552#3 = "02";
     #552#4 = ">";
     #552#5 = "";

     nGrupo  = 1;  nSubGrupo = 1;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#6  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#7  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#8  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#9  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#10 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#11 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 2;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#12  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#13  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#14 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#15 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#16 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#17 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 3;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#18 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#19 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 4;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#20 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#21 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#22 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#23 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#24 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#25 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 5;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#26 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#27 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#28 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#29 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#30 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#31 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 6;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #552#32 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #552#33 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 7;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #552#34 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #552#35 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 8;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #552#36 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #552#37 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 9;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #552#38 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #552#39 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 10;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 0.5;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#40  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#41  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 1;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#42 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#43 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#44 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#45 = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 1.75;
               enNume  = #490nCampo1;  |HAZ Conver13;  #552#46 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #552#47 = eaAlfa;
           |FINSI;
     |SIGUE;

     nGrupo  = 1;  nSubGrupo = 11;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #552#48 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #552#49 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 12;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #552#50 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #552#51 = eaAlfa;

     nGrupo  = 1;  nSubGrupo = 13;  |HAZ LeeCasilla392;
     enNume  = #490#11;  |HAZ Conver13;  #552#52 = eaAlfa;
     |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;

     #552#53 = "</T39202>";
     #552#54 = &13 + &10;

     |SI nSwHay = 0;  |ACABA;  |FINSI;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ 54;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #552nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO Regis392T3A2002;
     |DDEFECTO #553;

     |ABRE #490;

     nSwHay = 0;
     #553#1 = "<T";
     #553#2 = "392";
     #553#3 = "03";
     #553#4 = ">";
     #553#5 = "";

     nGrupo  = 2;  nSubGrupo = 1;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#6  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#7  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#8  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#9  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#10 = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#11 = eaAlfa;
           |FINSI;
     |SIGUE;

     enNume  = #490#10;  |HAZ Conver13;  #553#12 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#13 = eaAlfa;


     nGrupo  = 2;  nSubGrupo = 2;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#14  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#15  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#16  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#17  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#18  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#19  = eaAlfa;
           |FINSI;
     |SIGUE;

     enNume  = #490#10;  |HAZ Conver13;  #553#20 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#21 = eaAlfa;


     nGrupo  = 2;  nSubGrupo = 3;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#22  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#23  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#24  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#25  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#26  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#27  = eaAlfa;
           |FINSI;
     |SIGUE;

     enNume  = #490#10;  |HAZ Conver13;  #553#28 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#29 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 4;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#30  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#31  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#32  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#33  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#34  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#35  = eaAlfa;
           |FINSI;
     |SIGUE;

     enNume  = #490#10;  |HAZ Conver13;  #553#36 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#37 = eaAlfa;


     nGrupo  = 2;  nSubGrupo = 5;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#38  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#39  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#40  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#41  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#42  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#43  = eaAlfa;
           |FINSI;
     |SIGUE;

     enNume  = #490#10;  |HAZ Conver13;  #553#44 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#45 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 6;  |HAZ LeeCasilla392;
     |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;

           |SI #490nCampo2 = 4;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#46  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#47  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 7;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#48  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#49  = eaAlfa;
           |FINSI;

           |SI #490nCampo2 = 16;
               enNume  = #490nCampo1;  |HAZ Conver13;  #553#50  = eaAlfa;
               enNume  = #490nCampo3;  |HAZ Conver13;  #553#51  = eaAlfa;
           |FINSI;
     |SIGUE;

     enNume  = #490#10;  |HAZ Conver13;  #553#52 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#53 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 7;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #553#54 = eaAlfa;
     enNume  = #490#11;  |HAZ Conver13;  #553#55 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 8;   |HAZ LeeCasilla392;
     enNume  = #490#11;  |HAZ Conver13;  #553#56 = eaAlfa;

     nGrupo  = 2;  nSubGrupo = 9;   |HAZ LeeCasilla392;
     enNume  = #490#11;  |HAZ Conver13;  #553#57 = eaAlfa;

     |SI #0#6 [ 2007;
         nGrupo  = 2;  nSubGrupo = 10;  |HAZ LeeCasilla392;
         enNume  = #490#11;  |HAZ Conver13;  #553#58 = eaAlfa;
         |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;
     |SINO;
         nGrupo  = 2;  nSubGrupo = 11;  |HAZ LeeCasilla392;
         |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;

               |SI #490nCampo2 = 4;
                   enNume  = #490nCampo1;  |HAZ Conver13;  #553#62 = eaAlfa;
                   enNume  = #490nCampo3;  |HAZ Conver13;  #553#63 = eaAlfa;
               |FINSI;

               |SI #490nCampo2 = 7;
                   enNume  = #490nCampo1;  |HAZ Conver13;  #553#64 = eaAlfa;
                   enNume  = #490nCampo3;  |HAZ Conver13;  #553#65 = eaAlfa;
               |FINSI;

               |SI #490nCampo2 = 16;
                   enNume  = #490nCampo1;  |HAZ Conver13;  #553#66 = eaAlfa;
                   enNume  = #490nCampo3;  |HAZ Conver13;  #553#67 = eaAlfa;
               |FINSI;
         |SIGUE;

         enNume  = #490#10;  |HAZ Conver13;  #553#68 = eaAlfa;
         enNume  = #490#11;  |HAZ Conver13;  #553#69 = eaAlfa;

         nGrupo  = 2;  nSubGrupo = 12;  |HAZ LeeCasilla392;
         |PARA nCampo2 = 13;  |SI nCampo2 [ 22;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;

               |SI #490nCampo2 = 4;
                   enNume  = #490nCampo1;  |HAZ Conver13;  #553#70  = eaAlfa;
                   enNume  = #490nCampo3;  |HAZ Conver13;  #553#71  = eaAlfa;
               |FINSI;

               |SI #490nCampo2 = 7;
                   enNume  = #490nCampo1;  |HAZ Conver13;  #553#72  = eaAlfa;
                   enNume  = #490nCampo3;  |HAZ Conver13;  #553#73  = eaAlfa;
               |FINSI;

               |SI #490nCampo2 = 16;
                   enNume  = #490nCampo1;  |HAZ Conver13;  #553#74  = eaAlfa;
                   enNume  = #490nCampo3;  |HAZ Conver13;  #553#75  = eaAlfa;
               |FINSI;
         |SIGUE;

         enNume  = #490#10;  |HAZ Conver13;  #553#76 = eaAlfa;
         enNume  = #490#11;  |HAZ Conver13;  #553#77 = eaAlfa;

         nGrupo  = 2;  nSubGrupo = 10;  |HAZ LeeCasilla392;
         enNume  = #490#11;  |HAZ Conver13;  #553#78 = eaAlfa;

         nGrupo  = 2;  nSubGrupo = 13;  |HAZ LeeCasilla392;
         enNume  = #490#11;  |HAZ Conver13;  #553#58 = eaAlfa;
         |SI #490#11 ! 0;  nSwHay = 1;  |FINSI;
     |FINSI;

     enNume  = #390#4;   |HAZ Conver13;  #553#59 = eaAlfa;

     |CIERRA #490;

     #553#60 = "</T39203>";
     #553#61 = &13 + &10;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     |SI nSwHay = 1;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #553nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Regis392T4A2002;
     |DDEFECTO #554;

     |ABRE #490;

     nSwHay = 0;
     #554#1 = "<T";
     #554#2 = "392";
     #554#3 = "04";
     #554#4 = ">";
     #554#5 = "";

     enNume  = #390#13;  |HAZ Conver13;  #554#6  = eaAlfa;
     enNume  = #390#14;  |HAZ Conver13;  #554#7  = eaAlfa;
     enNume  = #390#5;   |HAZ Conver13;  #554#8  = eaAlfa;
     enNume  = #390#15 * 100;            #554#9  = ("0000" + enNume) % -104;
     enNume  = #390#16 * 100;            #554#10 = ("0000" + enNume) % -104;
     enNume  = #390#17 * 100;            #554#11 = ("0000" + enNume) % -104;
     enNume  = #390#18 * 100;            #554#12 = ("0000" + enNume) % -104;
     enNume  = #390#19 * 100;            #554#13 = ("0000" + enNume) % -104;
     enNume  = #390#20;  |HAZ Conver13;  #554#14 = eaAlfa;
     enNume  = #390#21;  |HAZ Conver13;  #554#15 = eaAlfa;
     enNume  = #390#22;  |HAZ Conver13;  #554#16 = eaAlfa;
     enNume  = #390#6;   |HAZ Conver13;  #554#17 = eaAlfa;
     enNume  = #390#7;   |HAZ Conver13;  #554#18 = eaAlfa;
     enNume  = #390#8;   |HAZ Conver13;  #554#19 = eaAlfa;
     enNume  = #390#9;   |HAZ Conver13;  #554#20 = eaAlfa;
     enNume  = #390#10;  |HAZ Conver13;  #554#21 = eaAlfa;

     |ABRE #490;
     nGrupo  = 3;  nSubGrupo = 4;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#22 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 5;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#23 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 6;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#24 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 7;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#25 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#26 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#27 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeCasilla392;
     enNume  = #490#10;
     nGrupo  = 3;  nSubGrupo = 11;  |HAZ LeeCasilla392;
     enNume  = enNume + #490#10;  |HAZ Conver13;  #554#28 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 12;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#29 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#30 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #554#31 = eaAlfa;

     enNume  = #390#11;  |HAZ Conver13;  #554#32 = eaAlfa;

     |CIERRA #490;

     |SI #390#5  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#6  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#7  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#8  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#9  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#10 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#11 ! 0;  nSwHay = 1;  |FINSI;

     #554#33 = "</T39204>";
     #554#34 = &13 + &10;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     |SI nSwHay = 1;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 34;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #554nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Regis392T4A2006;
     |DDEFECTO #554;

     |ABRE #490;

     nSwHay = 0;
     #554#1 = "<T";
     #554#2 = "392";
     #554#3 = "04";
     #554#4 = ">";
     #554#5 = "";

     enNume  = #390#13;  |HAZ Conver13;  #554#6  = eaAlfa;
     enNume  = #390#14;  |HAZ Conver13;  #554#7  = eaAlfa;
     enNume  = #390#5;   |HAZ Conver13;  #554#8  = eaAlfa;
     enNume  = #390#15 * 100;            #554#9  = ("0000" + enNume) % -104;
     enNume  = #390#16 * 100;            #554#10 = ("0000" + enNume) % -104;
     enNume  = #390#17 * 100;            #554#11 = ("0000" + enNume) % -104;
     enNume  = #390#18 * 100;            #554#12 = ("0000" + enNume) % -104;
     enNume  = #390#19 * 100;            #554#13 = ("0000" + enNume) % -104;
     enNume  = #390#20;  |HAZ Conver13;  #554#14 = eaAlfa;
     enNume  = #390#21;  |HAZ Conver13;  #554#15 = eaAlfa;
     enNume  = #390#22;  |HAZ Conver13;  #554#16 = eaAlfa;
     enNume  = #390#6;   |HAZ Conver13;  #554#17 = eaAlfa;
     enNume  = #390#7;   |HAZ Conver13;  #554#18 = eaAlfa;
     enNume  = #390#8;   |HAZ Conver13;  #554#19 = eaAlfa;
     enNume  = #390#9;   |HAZ Conver13;  #554#20 = eaAlfa;
     enNume  = #390#10;  |HAZ Conver13;  #554#21 = eaAlfa;

     |ABRE #490;
     nGrupo  = 3;  nSubGrupo = 1;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#22 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 2;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#23 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 3;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;
     nGrupo  = 3;  nSubGrupo = 4;  |HAZ LeeCasilla392_2;
     enNume  = enNume + #490#10;  |HAZ Conver13;  #554#24 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 5;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#25 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 6;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#26 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 7;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#27 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 8;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#28 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 9;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#29 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 10;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#30 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 13;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#31 = eaAlfa;

     nGrupo  = 3;  nSubGrupo = 14;  |HAZ LeeCasilla392_2;
     enNume  = #490#10;  |HAZ Conver13;  #554#32 = eaAlfa;

     enNume  = #390#11;  |HAZ Conver13;  #554#35 = eaAlfa;

     |CIERRA #490;

     |SI #390#5  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#6  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#7  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#8  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#9  ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#10 ! 0;  nSwHay = 1;  |FINSI;
     |SI #390#11 ! 0;  nSwHay = 1;  |FINSI;

     #554#33 = "</T39204>";
     #554#34 = &13 + &10;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     |SI nSwHay = 1;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 34;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #554nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO CargaProrrata392;
     eaAlfa = #690#5;      |HAZ QuitaRaros;                    #555nCampo = eaAlfa;
     nCampo = nCampo + 1;  aAlfa = #690#6 %  103;              #555nCampo = aAlfa;  || los tres ultimos
     nCampo = nCampo + 1;  enNume  = #690#7;   |HAZ Conver13;  #555nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #690#8;   |HAZ Conver13;  #555nCampo = eaAlfa;
     nCampo = nCampo + 1;                                      #555nCampo = #690#9;
     nCampo = nCampo + 1;  aAlfa = ("000" + #690#10) % -103;   #555nCampo = aAlfa;

     nSwHay = 1;
|FPRC;

|PROCESO Prorratas392;
     |SI nModulos = 0;
         nLinea = nLinea + 1;
         |SI nLinea > 5; |ACABA;  |FINSI;

         |SI nLinea = 1;  nCampo = 14;  |FINSI;
         |SI nLinea = 2;  nCampo = 20;  |FINSI;
         |SI nLinea = 3;  nCampo = 26;  |FINSI;
         |SI nLinea = 4;  nCampo = 32;  |FINSI;
         |SI nLinea = 5;  nCampo = 38;  |FINSI;

         |HAZ CargaProrrata392;
     |SINO;
         nLineaC = nLineaC + 1;

         |SI nLineaC [ nTopeD;             |ACABA;  |FINSI;
         |SI nLineaC > nTopeH;  |ERROR10;  |ACABA;  |FINSI;

         nNume = nLineaC - nTopeD;

         |SI nNume = 1;  nCampo = 14;  |FINSI;
         |SI nNume = 2;  nCampo = 20;  |FINSI;
         |SI nNume = 3;  nCampo = 26;  |FINSI;
         |SI nNume = 4;  nCampo = 32;  |FINSI;
         |SI nNume = 5;  nCampo = 38;  |FINSI;

         |HAZ CargaProrrata392;
     |FINSI;
|FPRC;

|DEFBUCLE dsm39204;
     #690#1;
     ;
     #390#0, #390#1, #390#2, #390#3, 01;
     #390#0, #390#1, #390#2, #390#3, 99;
     ;
     NULL, Prorratas392;
|FIN;

|PROCESO Regis392T5A2002;
     |DDEFECTO #555;

     nSwHay = 0;
     #555#1 = "<T";
     #555#2 = "392";
     #555#3 = "05";
     #555#4 = ">";
     #555#5 = "";

     nGrupo  = 4;  nSubGrupo = 1;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#6  = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 2;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#7 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 3;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#8 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 4;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#9 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 5;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#10 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 6;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#11 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 7;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#12 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 8;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#13 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nGrupo  = 4;  nSubGrupo = 16;   |HAZ LeeCasilla392;
     enNume  = #490#10;  |HAZ Conver13;  #555#46 = eaAlfa;
     |SI enNume ! 0;  nSwHay = 1;  |FINSI;

     nModulos = 0;
     nLinea   = 0;
     |BUCLE dsm39204;

     #555#44 = "</T39205>";
     #555#45  = &13 + &10;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     |SI nSwHay = 1;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #555nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;

         |SI nLinea > 5;
             nComple         = 0;
             nComplementaria = (((nLinea - 5) / 5) + 0.5) ! 0;
             nTopeD  = 5;
             nTopeH  = 10;

             |PARA nComple = 1; |SI nComple [ nComplementaria;  |HACIENDO nComple = nComple + 1;
                   nTopeD = nComple * 5;
                   nTopeH = nTopeD + 5;

                   |DDEFECTO #555;
                   nSwHay   = 0;
                   #555#1   = "<T";
                   #555#2   = "392";
                   #555#3   = "05";
                   #555#4   = ">";
                   #555#5   = "C";
                   nModulos = 1;
                   nLinea   = 0;
                   nLineaC  = 0;
                   |BUCLE dsm39204;

                   #555#44 = "</T39205>";
                   #555#45 = &13 + &10;

                   |SI nSwHay = 1;
                       aAlfa = "";
                       |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
                             aAlfa = #555nCampo;
                             |XGRABA nHandle2, aAlfa;
                       |SIGUE;
                   |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaGrupo;
     #590#0 = #4#0;
     #590#1 = #4#1;
     #590#2 = #4#3;
     #590#3 = #4#4;
     #590#4 = nGrupo;
     |LEE 040#590=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI nGrupo = 1;  nCampo = 6;  |FINSI;
     |SI nGrupo = 2;  nCampo = 23; |FINSI;
     |SI nGrupo = 3;  nCampo = 40; |FINSI;

                           enNume  = #590#5;   |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#6;   |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#7;   |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#8;   |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#9;   |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#10;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#11;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#12;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#13;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#14;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#15;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#16;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#17;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#18;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#19;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#20;  |HAZ Conver13;  #556nCampo = eaAlfa;
     nCampo = nCampo + 1;  enNume  = #590#21;  |HAZ Conver13;  #556nCampo = eaAlfa;

     |PARA nCampo = 5;  |SI nCampo [ 21;  |HACIENDO nCampo = nCampo + 1;
           |SI #590nCampo ! 0;  nSwHay = 1;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Regis392T6A2002;
     |DDEFECTO #556;

     nSwHay = 0;
     #556#1 = "<T";
     #556#2 = "392";
     #556#3 = "06";
     #556#4 = ">";
     #556#5 = "";

     |ABRE #590;

     nSwHay = 0;
     nGrupo = 1;  |HAZ CargaGrupo;
     nGrupo = 2;  |HAZ CargaGrupo;
     nGrupo = 3;  |HAZ CargaGrupo;

     |CIERRA #590;

     #556#57 = "</T39206>";
     #556#58  = &13 + &10;

     |SI #0#6 ] 2004;  |ACABA;  |FINSI;

     |SI nSwHay = 1;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 58;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #556nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO QueHacemos392;
     |ABRE #4;
     #4#0  = #999#0;
     #4#1  = #999#1;
     #4#2  = #999#2;
     #4#3  = #999#5;
     #4#4  = #999#7;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #4;

     |SI #0#6 [ 2003;
         aAbre = eaPathEmision + "INT" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |SINO;
         aAbre = eaPathEmision + "392" + (("00000" + #999#0) % -105) + ".XML";
         |XABRE "BW", aAbre, enHandle2;
     |FINSI;

     |HAZ Regis392T1A2002;
     |HAZ Regis392T2A2002;
     |HAZ Regis392T3A2002;

     |SI #0#6 [ 2005;
         |HAZ Regis392T4A2002;
     |SINO;
         |HAZ Regis392T4A2006;
     |FINSI;

     |HAZ Regis392T5A2002;
     |HAZ Regis392T6A2002;

     |SI #0#6 ] 2004;
         |ABRE #199;
         |HAZ CargaXml;
         |CIERRA #199;
         |XCIERRA enHandle2;
     |SINO;
         |XCIERRA nHandle2;
     |FINSI;

     |SI #0#6 [ 2003;
         eaFOrigen  = eaPathEmision  + "INT" + (("00000" + #999#0) % -105) + ".TXT";
         eaFDestino = eaPathInternet + "INT" + (("00000" + #999#0) % -105) + ".TXT";
     |SINO;
         eaFOrigen  = eaPathEmision  + "392" + (("00000" + #999#0) % -105) + ".XML";
         eaFDestino = eaPathInternet + "392" + (("00000" + #999#0) % -105) + ".XML";
     |FINSI;

     |HAZ CopiaFichero;
     |FBORRA eaFOrigen;
|FPRC;

|DEFBUCLE dsmow014C392;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos392;
|FIN;

|DEFBUCLE dsmow014N392;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos392;
|FIN;

|PROCESO Boton3921;
     |PTEC 824;
|FPRC;

|PROCESO Boton3922;
     |PTEC 825;
|FPRC;

|PROCESO Boton3923;
     |PTEC 806;
|FPRC;

|PROCESO Botones392;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Presentacion Telematica              ", 1313, 1554, Boton3921;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Informe de Comprobacion ", 1713, 1954, Boton3922;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton3923;
     nBoton3 = FSalida;

     aF2  = &255 + "824";
     aF3  = &255 + "825";
     aEsc = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;   nTecla = 1;   |SAL;  |FINSI;
         |SI aTecla = aF3;   nTecla = 5;   |SAL;  |FINSI;
         |SI aTecla = aEsc;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;
|FPRC;

|PROGRAMA;
     enEmpresa     = 0;
     enEjer        = 2008;
     enModelo      = 392;
     enComplem     = 0;
     enTipoEntrada = 99;
     |SUB_EJECUTA_NP "dsm39201";

     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #0 aFichero;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #999 aFichero;

     |ABRE #0;
     |LEE 000#0p;
     |CIERRA #0;

     |SI #0#6 < 2002;
         |MENAV "0000 Emisiones a partir del Ejercicio 2002";
         |ACABA;
     |FINSI;

     |SI eaParametro ! "392C";
         enSwTrata      = 0;
         enCambiaMoneda = 1;

         |HAZ Botones392;
     |SINO;
         nTecla = 5;
     |FINSI;

     |SI nTecla = 0;  enInfComp = 1;  |ACABA;  |FINSI;
     |SI nTecla = 5;  enInfComp = 1;  |FINSI;

     enTecla = nTecla;

     |SI nTecla = 5;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |INFOR "dsmoy392";
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
     |FINSI;

     nSwLee = 0;
     |SI #0#8 = "C";
         |BUCLE dsmow014C392;
     |SINO;
         |BUCLE dsmow014N392;
     |FINSI;

     |SI nTecla ! 5;
         |HAZ GrabaImpreso;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |SINO;
         |PIEINF;
         |FININF;
         |FINIMP;
     |FINSI;

     |PULSATECLA;
|FPRO;
