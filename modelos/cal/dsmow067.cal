|FICHEROS;
     dsmow067,MANTE;

     dsm39001;
     :/basica/def/agicen14;

     &regisnif@;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;

     aAlfa   = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo0C28Fw67;  |TIPO 0;
     |C_M #dsmow067#30, 1, "S";
     |C_M #dsmow067#31, 1, "S";
     |C_M #dsmow067#32, 1, "S";
     |C_M #dsmow067#35, 1, "S";

     |SI #dsm39001#1 [ 2015;
         |C_M #dsmow067#29, 1, "S";
     |FINSI;

     |SI #dsm39001#1 ] 2016;
         |C_M #dsmow067#42, 1, "S";
     |FINSI;

     |SI #dsmow067#28 = "N";
         |SI #dsm39001#1 [ 2015;
             #dsmow067#29 = 0; |C_M #dsmow067#29, 1, "N";  |PINTA #dsmow067#29;
         |FINSI;

         |SI #dsm39001#1 ] 2016;
             #dsmow067#42 = "";  |C_M #dsmow067#42, 1, "N";  |PINTA #dsmow067#42;
         |FINSI;

         #dsmow067#30 = "N";   |C_M #dsmow067#30, 1, "N";  |PINTA #dsmow067#30;
         #dsmow067#31 = "N";   |C_M #dsmow067#31, 1, "N";  |PINTA #dsmow067#31;
         #dsmow067#32 = "N";   |C_M #dsmow067#32, 1, "N";  |PINTA #dsmow067#32;
         #dsmow067#35 = "N";   |C_M #dsmow067#35, 1, "N";  |PINTA #dsmow067#35;
     |FINSI;
|FPRC;

|PROCESO Tipo0C31Fw67;  |TIPO 0;
     |C_M #dsmow067#32, 1, "S";
     |C_M #dsmow067#33, 1, "S";

     |SI #dsmow067#31 = "N";
         #dsmow067#32 = "N";   |C_M #dsmow067#32, 1, "N";  |PINTA #dsmow067#32;
         #dsmow067#33 = "";    |C_M #dsmow067#33, 1, "N";  |PINTA #dsmow067#33;
     |FINSI;
|FPRC;

|PROCESO Actividad;
     nCampo1 = Campo + 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;

     |C_M #dsmow067#nCampo3#, 1, "S";
     |SI #dsmow067#Campo# = 0;
         #dsmow067#nCampo1# = "";  |PINTA #dsmow067#nCampo1#;
         #dsmow067#nCampo2# = "";  |PINTA #dsmow067#nCampo2#;
         #dsmow067#nCampo3# = 0;   |PINTA #dsmow067#nCampo3#;
         |C_M #dsmow067#nCampo3#, 1, "N";

         |ACABA;
     |FINSI;

     |ABRE #agicen14;
     #agicen14#0 = #dsm39001#0;
     #agicen14#1 = #dsmow067#Campo#;
     |LEE 040#agicen14.=;
     |SI FSalida ! 0;
         |MENAV "     No existe Actividad";
         |ERROR;
     |SINO;
         aAlfa = #agicen14#5 % -104;
         |SI aAlfa ! "0000";
             aAlfa = "31.12." + #dsm39001#1;
             |SI #agicen14#5 > aAlfa;
                 |MENAV "    La Actividad se inicia en a¤os posteriores."
                 #dsmow067#Campo#   = 0;   |PINTA #dsmow067#Campo#;
                 #dsmow067#nCampo1# = "";  |PINTA #dsmow067#nCampo1#;
                 #dsmow067#nCampo2# = "";  |PINTA #dsmow067#nCampo2#;
                 #dsmow067#nCampo3# = 0;   |PINTA #dsmow067#nCampo3#;
                 |ACABA;
             |FINSI;
         |FINSI;

         aAlfa = #agicen14#6 % -104;
         |SI aAlfa ! "0000";
             aAlfa = "01.01." + #dsm39001#1;
             |SI #agicen14#6 < aAlfa;
                 |MENAV "    La Actividad a finalizado en a¤os anteriores.";
                 #dsmow067#Campo#   = 0;   |PINTA #dsmow067#Campo#;
                 #dsmow067#nCampo1# = "";  |PINTA #dsmow067#nCampo1#;
                 #dsmow067#nCampo2# = "";  |PINTA #dsmow067#nCampo2#;
                 #dsmow067#nCampo3# = 0;   |PINTA #dsmow067#nCampo3#;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #agicen14#7 = 1;
             |MENAV "    La Actividad tiene IVA Exento.";
             #dsmow067#Campo#   = 0;   |PINTA #dsmow067#Campo#;
             #dsmow067#nCampo1# = "";  |PINTA #dsmow067#nCampo1#;
             #dsmow067#nCampo2# = "";  |PINTA #dsmow067#nCampo2#;
             #dsmow067#nCampo3# = 0;   |PINTA #dsmow067#nCampo3#;
             |ACABA;
         |FINSI;

         #dsmow067#nCampo1# = #agicen14#3;  |PINTA #dsmow067#nCampo1#;
         #dsmow067#nCampo2# = #agicen14#4;  |PINTA #dsmow067#nCampo2#;

         |SI #agicen14#7  = 11;  |O #agicen14#7 = 13;
             #dsmow067#25 = "X";
         |FINSI;

         |SI #agicen14#16 = 1;  |O #agicen14#16 = 2;
             #dsmow067#nCampo3# = 1;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #agicen14#16 = 4;  |O #agicen14#16 = 5;
             #dsmow067#nCampo3# = 2;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #agicen14#3 = "8612"; |O #agicen14#3  = "8611";
             #dsmow067#nCampo3# = 3;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #agicen14#16 = 3;
             #dsmow067#nCampo3# = 1;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #agicen14#16 = 6;
             #dsmow067#nCampo3# = 6;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #agicen14#3 = "9999";  |Y #agicen14#16 = 3;
             #dsmow067#nCampo3# = 4;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #agicen14#3 = "9999";  |Y #agicen14#16 = 6;
             #dsmow067#nCampo3# = 6;  |PINTA #dsmow067#nCampo3#;
         |FINSI;

         |SI #dsmow067#nCampo3# = 0;  |O #dsmow067#nCampo3# = 4;  |O #dsmow067#nCampo3# = 5;
          |O #dsmow067#nCampo3# = 6;
             #dsmow067#nCampo1# = "";  |PINTA #dsmow067#nCampo1#;
         |FINSI;
     |FINSI;

     |CIERRA #agicen14;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #dsmow067#Campo#;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #dsmow067#Campo# = eaVarDni;
         |PINTA #dsmow067#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #dsmow067#Campo#;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #dsmow067#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #dsmow067#Campo# = eaVarDni;  |PINTA #dsmow067#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     eaCodNif  = #dsmow067#Campo#;
     |HAZ LeeNifs;

     #dsmow067#27 = #regisnif@#1;   |PINTA #dsmow067#27;
|FPRC;

|PROCESO Tipo12w067;  |TIPO 12;
|FPRC;
