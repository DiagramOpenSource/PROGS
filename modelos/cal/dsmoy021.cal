|FICHEROS;
    dsmoy021;

    dsmom001;
    dsmom004;

    dsm180ca;
    dsm180li;
    dsmom107;

    :/basica/def/agim0024;
    :/basica/def/agim0026;
    :/basica/def/agim0029;
    :/basica/def/agitab99;

    :/integral/def/dsam0003;

    dsmow014;

    &regisnif@;
    &clientes@;
|FIN;

|VARIABLES;
     nSwGraba            = 0;
     nCampo              = 0;
     nDEmpresa           = 0;
     nHEmpresa           = 0;
     nEjer               = 0;
     nOpcion             = 0;
     nArchivo            = 0;

     aAlfa1              = "";
     aAlfa2              = "";
     aAlfa3              = "";
     aFichero            = "";
     aPath               = "";
     eaMoneda            = "";
     aAlfa               = "";
     aElDni              = "";
     aBase               = "";

     nNume1              = 0;
     nNume2              = 0;
     nNume3              = 0;
     SwPrimer            = 0;
     nSwHay              = 0;
     sw_valido           = 0;
     nVale               = 0;
     nHayRepre           = 0;
     nLectura            = 0;
     nDComple            = 0;
     nHComple            = 0;
     nCanal              = 0;

     fecsys              = @;

     {-1}aMenu           = "";
         aMenu1          = "2400";
         aMenu2          = "1";
         aMenu3          = "Archivo documental activado. Elija opci¢n: ";
         aMenu4          = "IAB";
         aMenu5          = "Imprimir";
         aMenu6          = "Archivar";
         aMenu7          = "Ambos";

     &eaParam            = "";
     &eaPathIntegral     = "";
     &eaCodRenta         = "";
     &eaTMoneda          = "";
     &justi1             = 0;
     &justi2             = 0;
     &dia                = "";
     &mes                = "";
     &anyo               = "";
     &periodo            = 0;
     &nomrep             = "";
     &dnirep             = "";
     &carrep             = "";
     &codemp             = "";
     &nomemp             = "";
     &dniemp             = "";
     &sgemp              = "";
     &domemp             = "";
     &numemp             = "";
     &escemp             = "";
     &pisemp             = "";
     &puremp             = "";
     &telemp             = "";
     &munemp             = "";
     &cpoemp             = "";
     &proemp             = "";
     &delemp             = "";
     &admemp             = "";

     &nomtra             = "";
     &dnitra             = "";
     &domtra             = "";
     &muntra             = "";
     &cpotra             = "";
     &protra             = "";

     &fletra             = "";
     &fprese             = @;

     &enImp1             = 0;
     &enImp2             = 0;
     &enImp3             = 0;
     &enImp4             = 0;

     &enErrorDSArchi     = 0;
     &eaVengoDe          = "";
     &enArchi            = 0;
     &eaInforme          = "";
     &enEjercicio        = 0;
     &eaNifEmp           = "";
     &enCodTrab          = 0;
     &eaNombreTra        = "";
     &eaNifTra           = "";
     &eaObservacion1     = "";
     &eaObservacion2     = "";
     &eaObservacion3     = "";
     &enM2               = 0;

     &enDesde            = 0;
     &enHasta            = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO NomMes;
     nNume1 = mes;
     |SI nNume1 = 1;  mes = "Enero     "; |FINSI;
     |SI nNume1 = 2;  mes = "Febrero   "; |FINSI;
     |SI nNume1 = 3;  mes = "Marzo     "; |FINSI;
     |SI nNume1 = 4;  mes = "Abril     "; |FINSI;
     |SI nNume1 = 5;  mes = "Mayo      "; |FINSI;
     |SI nNume1 = 6;  mes = "Junio     "; |FINSI;
     |SI nNume1 = 7;  mes = "Julio     "; |FINSI;
     |SI nNume1 = 8;  mes = "Agosto    "; |FINSI;
     |SI nNume1 = 9;  mes = "Septiembre"; |FINSI;
     |SI nNume1 = 10; mes = "Octubre   "; |FINSI;
     |SI nNume1 = 11; mes = "Noviembre "; |FINSI;
     |SI nNume1 = 12; mes = "Diciembre "; |FINSI;
|FPRC;

|PROCESO LaRentaSI;
     eaCodRenta = "";
     |ABRE #dsam0003;
     |SELECT #2#dsam0003;
     #dsam0003#1 = aElDni;
     |LEE 040#dsam0003.=;
     |SI FSalida = 0;
         eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
     |SINO;
        |SELECT #3#dsam0003;
        #dsam0003#35 = aElDni;
        |LEE 040#dsam0003.=;
        |SI FSalida = 0;
            eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
        |FINSI;
     |FINSI;
     |CIERRA #dsam0003;
|FPRC;

|PROCESO CargaVar;
     eaObservacion1 = "Certificado de arrendamientos";
     || eaObservacion2 = "Ejercicio " + #dsmoy021#14;

     enEjercicio = #dsmoy021#14;
     enEmpresa   = #dsm180ca#0;
     eaNombreEmp = nomemp;
     eaNifEmp    = dniemp;
     eaNombreTra = nomtra;
     eaNifTra    = dnitra;
     enM2        = 99;
     enCodTrab   = 0;
|FPRC;

|PROCESO Imprimir;
     |SI enImp1 = 0; |Y enImp2 = 0; |Y enImp3 = 0; |Y enImp4 = 0;
         |ACABA;
     |FINSI;

     eaCodRenta = "";
     |SI #dsmoy021#34 = "S";  |HAZ LaRentaSI;  |FINSI;

     |SI nArchivo = 1;
         |HAZ IMPREArchi;

         |PRINT;
         |PIEINF;
         |FININF;
         |FINIMP;

         |SI enErrorDSArchi = 0;
             |HAZ CargaVar;
             |HAZ Archivando;
         |FINSI;
     |FINSI;

     |SI nArchivo = 0;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO FechaPres;
     |ABRE #dsmom004;
     #dsmom004#0 = #dsm180ca#0;
     #dsmom004#1 = #dsm180ca#1;
     #dsmom004#2 = #dsm180ca#2;
     #dsmom004#3 = #dsm180ca#3;
     #dsmom004#4 = #dsm180ca#4;
     |LEE 000#dsmom004.=;
     |CIERRA #dsmom004;

     fprese = #dsmom004#10;
     aAlfa1 = #dsmom004#25 %  112; justi1 = aAlfa1;
     aAlfa1 = #dsmom004#25 % 1301; justi2 = aAlfa1;
|FPRC;

|PROCESO ElTrabajador;
     enImp1 = 0;
     enImp2 = 0;
     enImp3 = 0;
     enImp4 = 0;

     aElDni   = #dsm180li#6;
     eaCodNif = #dsm180li#6;
     |HAZ LeeNifs;

     nomtra = #regisnif@#1;
     dnitra = aElDni;

     aAlfa1 = #regisnif@#9; |QBF aAlfa1;
     |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;

     aAlfa2 = #regisnif@#2; |QBF aAlfa2;
     |SI aAlfa2 ! ""; aAlfa2 = aAlfa2 + " "; |FINSI;

     aAlfa3 = #regisnif@#3;
     domtra = aAlfa1 + aAlfa2 + aAlfa3;

     muntra = #regisnif@#6;
     protra = #regisnif@#7;

     aAlfa1 = #regisnif@#4; |QBF aAlfa1;
     aAlfa1 = ("00" + aAlfa1) % -102;

     aAlfa2 = #regisnif@#5; |QBF aAlfa2;
     aAlfa2 = ("000" + aAlfa2) % -103;

     cpotra = aAlfa1 + aAlfa2;
|FPRC;

|PROCESO dsm180li;
     |SI #dsmoy021#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy021#nCampo# ! "            ";
                   nVale = 1;
                   |SI #dsmoy021#nCampo# = #dsm180li#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI SwPrimer = 0;
         |HAZ ElTrabajador;
         SwPrimer = 1;
     |FINSI;

     |SI aElDni ! #dsm180li#6;
         |HAZ Imprimir;
         |HAZ ElTrabajador;
     |FINSI;

     || ............................. Sumo Cantidades donde van

     |SI #dsm180li#7 = 1;
         enImp1 = enImp1 + #dsm180li#13;
         enImp2 = enImp2 + #dsm180li#11;
     |FINSI;

     |SI #dsm180li#7 = 2;
         enImp3 = enImp3 + #dsm180li#13;
         enImp4 = enImp4 + #dsm180li#11;
     |FINSI;
|FPRC;

|DEFBUCLE dsm180li;
     #dsm180li#1;
     ;
#dsm180ca#0,#dsm180ca#1,#dsm180ca#2,#dsm180ca#3,#dsm180ca#4,#dsm180ca#5,#dsmoy021#19,1,0000,01;
#dsm180ca#0,#dsm180ca#1,#dsm180ca#2,#dsm180ca#3,#dsm180ca#4,#dsm180ca#5,#dsmoy021#20,2,9999,99;
     ;
     NULL, dsm180li;
|FIN;

|PROCESO agim0026;
   nomrep = #agim0026#4;
   dnirep = #agim0026#3;
   carrep = #agim0026#17;
|FPRC;

|DEFBUCLE agim0026;
    #agim0026#1;
    16;
    #dsm180ca#0, 01, 01, #dsmoy021#32;
    #dsm180ca#0, 99, 99, #dsmoy021#32;
    ;
    NULL, agim0026;
|FIN;

|PROCESO agim0024;
    |SI #agim0024#15 ! "A";
        nomrep = #agim0024#4;
        dnirep = #agim0024#3;
        carrep = "REPRESENTANTE";
        nHayRepre = 1;
        |ERROR10;
    |FINSI;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#2;
     ;
     #dsm180ca#0, 99, 01;
     #dsm180ca#0, 01, 99;
     ;
     NULL, agim0024;
|FIN;

|PROCESO dsmom001;
     aAlfa = "31.12." + #dsm180ca#1;
     |SI #dsmom001#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #dsm180ca#1;
     |SI #dsmom001#9 > "01.01.0000";
         |SI #dsmom001#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nHayRepre = 1;

     enCodCli = #dsmom001#3;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         nomrep = #clientes@#1;
         dnirep = #clientes@#3;
         carrep = "REPRESENTANTE";
     |SINO;
         nomrep = #clientes@#1;
         dnirep = #clientes@#13;
         carrep = "REPRESENTANTE";
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#1;
     ;
     #dsm180ca#0, 01, 0001;
     #dsm180ca#0, 99, 9999;
     ;
     NULL, dsmom001;
|FIN;

|PROCESO dsm180ca;
     |SI nLectura = 0;
         |SI #dsm180ca#4 ! 0;
             |SI #dsm180ca#10 = "S";
                 nDComple = #dsm180ca#4;
                 nHComple = #dsm180ca#4;
             |SINO;
                 nHComple = #dsm180ca#4;
             |FINSI;
         |SINO;
             nDComple = #dsm180ca#4;
             nHComple = #dsm180ca#4;
         |FINSI;

         |ACABA;
     |FINSI;

     codemp = "";
     nomrep = "";
     dnirep = "";
     carrep = "";

     nomemp = "";
     dniemp = "";
     sgemp  = "";
     domemp = "";
     numemp = "";
     escemp = "";
     pisemp = "";
     puremp = "";
     telemp = "";
     munemp = "";
     cpoemp = "";
     proemp = "";
     delemp = "";
     admemp = "";

     |SI #dsmom107#1 = "S";
         |BUCLE agim0026;
     |SINO;
         nHayRepre = 0;
         |BUCLE agim0024;
         |SI nHayRepre = 0;
             |BUCLE dsmom001;
             |SI nHayRepre = 0;
                 nomrep  = #dsmow014#3;
                 carrep  = "TITULAR";
             |FINSI;
         |FINSI;
    |FINSI;

    codemp   = #dsm180ca#0; |QBF codemp; codemp = ("00000" + codemp) % -105;
    enCodCli = #dsm180ca#0;
    |HAZ LeePersona;

    |SI enSwDeDonde = 1;
          nomemp = #clientes@#1;   || tique 1222_1187
          dniemp = #clientes@#3;
          sgemp  = #clientes@#29;
          domemp = #clientes@#30;
          numemp = #clientes@#31;
          escemp = #clientes@#32;
          pisemp = #clientes@#33;
          puremp = #clientes@#34;
          telemp = #clientes@#54;
          munemp = #clientes@#37;
          aAlfa1 = #clientes@#35; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #clientes@#36; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          cpoemp = aAlfa1 + aAlfa2;
          proemp = #clientes@#38;
          delemp = #clientes@#17;
          admemp = #clientes@#18;
          |SI nomrep = "";
              nomrep = #clientes@#1;
              |SI dnirep = ""; dnirep = #clientes@#3; |FINSI;
          |FINSI;
     |SINO;
          nomemp = #clientes@#2;  || tique 1222_1187
          dniemp = #clientes@#13;
          sgemp  = #clientes@#3;
          domemp = #clientes@#4;
          numemp = #clientes@#5;
          escemp = #clientes@#6;
          pisemp = #clientes@#7;
          puremp = #clientes@#8;
          telemp = #clientes@#14;
          munemp = #clientes@#11;
          aAlfa1 = #clientes@#9;  |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #clientes@#10; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          cpoemp = aAlfa1 + aAlfa2;
          proemp = #clientes@#12;
          delemp = #clientes@#91;
          admemp = #clientes@#92;
          |SI nomrep = "";
              nomrep = #clientes@#2;
              |SI dnirep = ""; dnirep = #clientes@#13; |FINSI;
          |FINSI;
     |FINSI;

     periodo = #dsmoy021#14;

     fprese = #dsmoy021#16;
     aAlfa1 = #dsmoy021#16;
     fecsys = aAlfa1 % 2;    || pasa la fecha a letras
     fletra = fecsys % 11;   || coge la parte literal de la fecha
     aAlfa1 = munemp; |QBF aAlfa1;
     fletra = aAlfa1 + ", a " + fletra;  || une la localidad a la fecha literal
     |HAZ FechaPres;

     SwPrimer = 0;
     aElDni   = "";

     |BUCLE dsm180li;
     |SI SwPrimer = 1;
         |HAZ Imprimir;
     |FINSI;
|FPRC;

|DEFBUCLE dsm180ca;
     #dsm180ca#1;
     ;
     #dsmow014#0, #dsmow014#1, #dsmow014#2, #dsmoy021#30, nDComple, 00;
     #dsmow014#0, #dsmow014#1, #dsmow014#2, #dsmoy021#30, nHComple, 99;
     ;
     NULL, dsm180ca;
|FIN;

|PROCESO dsmow014M;
    enEmpresa = #dsmow014#0;
    nSwHay    = nSwHay + 1;
    nDComple  = 0;
    nHComple  = 99;

    nLectura  = 0;  |BUCLE dsm180ca;
    nLectura  = 1;  |BUCLE dsm180ca;
|FPRC;

|DEFBUCLE dsmow014M;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, dsmow014M;
|FIN;

|| ///////////////////////////////////////////////////

|PROCESO GrabaTempo;
     enEmpresaPINET = #dsmom004#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

    enCodCli = #dsmom004#0;
    |HAZ LeePersona;

    #dsmow014#0  = #dsmom004#0;
    #dsmow014#1  = #dsmom004#1;
    #dsmow014#2  = #dsmom004#2;
    |LEE 101#dsmow014.=;
    |SI FSalida ! 0;
        |DDEFECTO #dsmow014;
        #dsmow014#0  = #dsmom004#0;
        #dsmow014#1  = #dsmom004#1;
        #dsmow014#2  = #dsmom004#2;
        |GRABA 020#dsmow014.b;
    |FINSI;

    #dsmow014#3  = #clientes@#1;
    #dsmow014#4  = "ANUAL";
    #dsmow014#5  = #dsmoy021#30;
    #dsmow014#6  = "S";
    #dsmow014#7  = #dsmom004#4;
    |GRABA 020#dsmow014.a;
    |LIBERA #dsmow014;

     nSwGraba = 1;
|FPRC;

|DEFBUCLE dsmom004;
     #dsmom004#1;
     ;
     nDEmpresa, #dsmoy021#14, #dsmoy021#31, #dsmoy021#30, 00;
     nHEmpresa, #dsmoy021#14, #dsmoy021#31, #dsmoy021#30, 99;
     ;
     NULL, GrabaTempo;
|FIN;
|| ///////////////////////////////////////////////////

|PROCESO Papel;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR eaInforme;
     |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

     nArchivo = 0;
     nSwHay   = 0;

     |ABRE #dsm180ca;
     |BUCLE dsmow014M;
     |CIERRA #dsm180ca;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Archivado;
     nArchivo = 1;
     nSwHay   = 0;

     |ABRE #dsm180ca;
     |BUCLE dsmow014M;
     |CIERRA #dsm180ca;
|FPRC;

|PROCESO IT3;  |TIPO 3;
     eaTMoneda = "Euros";
     |SI #dsmoy021#29 = "PESETAS";
         eaTMoneda = "Ptas.";
     |FINSI;
     eaMoneda = #dsmoy021#29;

     enEjer      = #dsmoy021#14;        || A¤o Calculo
     aAlfa1      = #dsmoy021#14;
     aAlfa1      = aAlfa1 % -102;
     nEjer       = aAlfa1;       || Dos ultimos digitos del A¤o

     aFichero = ("ea" + Usuario) % 108;
     |NOME_DAT #dsmow014#aFichero#;
     |ABRE #dsmow014;  |CIERRA #dsmow014;  |DELINDEX #dsmow014;

     eaInforme = "dsmoy021";
     |SI #dsmoy021#35 = "2"; eaInforme = "dsmoys21"; |FINSI;

     dia    = #dsmoy021#16 % 102;
     mes    = #dsmoy021#16 % 402;
     anyo   = #dsmoy021#16 % 704;
     |HAZ NomMes;

     nSwGraba = 0;
     |ABRE #dsmow014;
     |SI #dsmoy021#0 ! 0;
         nDEmpresa = #dsmoy021#0;
         nHEmpresa = #dsmoy021#1;
         |BUCLE dsmom004;
     |SINO;
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               nDEmpresa = #dsmoy021#nCampo#;
               nHEmpresa = #dsmoy021#nCampo#;
               |BUCLE dsmom004;
         |SIGUE;
     |FINSI;
     |CIERRA #dsmow014;

     |SI nSwGraba = 0;
         |MENAV "     Seleccion Vacia.";
         |DELINDEX #dsmow014;
         |ACABA;
     |FINSI;

     eaVengoDe = "dsmoy021";
     |HAZ MiraSiArchiva;
     |SI enArchi = 0;
         |HAZ Papel;
     |SINO;
         |MENU aMenu;
         nOpcion = FSalida;
         |SI nOpcion = 1;  |HAZ Papel;      |FINSI;
         |SI nOpcion = 2;  |HAZ Archivado;  |FINSI;
         |SI nOpcion = 3;  |HAZ Papel;      |FINSI;
         |SI nOpcion = 3;  |HAZ Archivado;  |FINSI;
     |FINSI;

     |DELINDEX #dsmow014;
|FPRC;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\

|PROCESO NoVale;
     || No tocar para que se puede compilar

     |HAZ ConsuCliente;
|FPRC;

|CALCULO CodigoRenta; |TIPO 0;
     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     |C_M #dsmoy021#34, 1, "S";
     |SI eaPathIntegral = "";
         |C_M #dsmoy021#34, 1, "N";  #dsmoy021#34 = "N";  |PINTA #dsmoy021#34;
     |FINSI;

     |C_M #dsmoy021#35,1,"S";
|FCAL;

|CALCULO T7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #dsmoy021#0 = enEmpresa;  |PINTA #dsmoy021#0;
         #dsmoy021#1 = enEmpresa;  |PINTA #dsmoy021#1;

         |C_M #dsmoy021#0, 1, "N";
         |C_M #dsmoy021#1, 1, "N";
     |FINSI;
     aAlfa1 = #dsmoy021#16; aAlfa1 = aAlfa1 % -104;
     #dsmoy021#14 = aAlfa1;
     #dsmoy021#14 = #dsmoy021#14 - 1;
     |PINTA #dsmoy021#14;
|FCAL;

|CALCULO Parrilla; |TIPO 0;
     |SI #dsmoy021#0 = 0;
         #dsmoy021#0 = 0;  |PINTA #dsmoy021#0;
         #dsmoy021#1 = 0;  |PINTA #dsmoy021#1;  |C_M #dsmoy021#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy021#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #dsmoy021#0, 1, "S";
             |C_M #dsmoy021#1, 1, "S";
         |FINSI;

         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy021#nCampo#, 1, "N";
               #dsmoy021#nCampo# = 0;  |PINTA #dsmoy021#nCampo#;
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO NoMasEmpresas;
     |SI #dsmoy021#Campo# = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               #dsmoy021#nCampo# = 0;  |C_M #dsmoy021#nCampo#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy021#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FCAL;

|PROCESO DesdeDni;
     |SI #dsmoy021#19 = "            ";
         #dsmoy021#20 = "zzzzzzzzzzzz";  |C_M #dsmoy021#20,1,"N"; |PINTA #dsmoy021#20;
         |PARA nCampo = 21;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy021#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #dsmoy021#20,1,"S";
         |PARA nCampo = 21;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy021#nCampo#, 1, "N";
               #dsmoy021#nCampo# = ""; |PINTA #dsmoy021#nCampo#;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasDni;
     |SI #dsmoy021#Campo# = "            ";
         |PARA nCampo = Campo + 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               #dsmoy021#nCampo# = "";  |C_M #dsmoy021#nCampo#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy021#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO LeoCargo;
 |ABRE #agim0029;
 #agim0029#0 = #dsmoy021#Campo#;
 |LEE 001#agim0029.=;
 |SI FSalida = 0;
     #dsmoy021#33 = #agim0029#1; |PINTA #dsmoy021#33;
 |FINSI;
 |CIERRA #agim0029;
|FPRC;

||............... PROGRAMA ......................................
|PROGRAMA;
     eaParam = PARAMETRO; |QBF eaParam;
     |SI eaParam = "";
         eaParam = "180";
     |FINSI;

     #dsmoy021#30 = eaParam;
     #dsmoy021#31 = 99;

     |ABRE #agitab99;
     #agitab99#0 = 950;
     |LEE 041#agitab99.=;
     |SI FSalida ! 0;
         |CIERRA #agitab99;
         enDesde = 950;
         enHasta = 952;
         eaPrograma = "agitab99";
         eaExtension = "bas";
         |SUB_EJECUTA_NP ":basica/dspatron";
     |SINO;
         |CIERRA #agitab99;
     |FINSI;

     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;
         |CIERRA #dsmom107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #dsmom107;
     |FINSI;

     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     |SI enEmpresa ! 0;
         |DDEFECTO #dsmoy021;
         #dsmoy021#0  = enEmpresa;
         #dsmoy021#1  = enEmpresa;
         #dsmoy021#14 = enEjer;
         |HAZ IT3;
     |SINO;
         |CLS;
         |MANTE #dsmoy021;
     |FINSI;
|FPRO;

|PROCESO Tipo88;  |TIPO 88;
     |HAZ Relaciones;
|FPRC;
