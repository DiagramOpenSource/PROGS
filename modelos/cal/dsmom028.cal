|FICHEROS;
     dsmom028;
|FIN;

|VARIABLES;
     nEstado     = 0;
     aTecla      = "";
     aAlfa       = "";
     nCampo6     = 0;
     aCampo7     = "";
     nCampo8     = 0;
     nError      = 0;

     &enImporte  = 0;
     &aCm9       = "";
     &aCm11      = "";
     &aCm13      = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Traemelo;
     enImporte = 0;
     |SUB_EJECUTA_NP "dsmoy007;AUTOMATICO";
|FPRC;

|PROCESO Tipo7C7; |TIPO 7;
     nError = 0;
     aAlfa  = "S";
     |SI aCm11 ! " ";
         |MENAV "0000Modelo Archivado. No puede modificar los datos";
         nError = 1;
         aAlfa  = "N";
     |SINO;
         |SI aCm9 ! " ";
            |MENAV "0000Modelo Impreso. No puede modificar los datos";
             nError = 1;
             aAlfa  = "N";
         |FINSI;
     |FINSI;
     |C_M #dsmom028#6,1,aAlfa;
|FPRC;

|PROCESO Tipo0C7; |TIPO 0;
     |SI FSalida = 10;
         |SUB_EJECUTA_NP "dsmoy007;ENESTE";
         |ERROR;
     |FINSI;

     |SI nError = 1;
         #dsmom028#7 = aCampo7;
         |PINTA #dsmom028#7;
         |ACABA;
     |FINSI;

     aAlfa = "N";
     |SI #dsmom028#7 = "N"; #dsmom028#6 = 0; |FINSI;
     |SI #dsmom028#7 = "S"; |Y enEjer [ 2013;
         aAlfa = "S";
         #dsmom028#6 = #dsmom028#8;
     |FINSI;
     |SI #dsmom028#7 = "M"; aAlfa = "S"; |FINSI;

     |SI #dsmom028#7 ! "N"; |HAZ Campo6; |FINSI;

     |C_M #dsmom028#6,1,aAlfa;
     |PINTA #dsmom028#6;
|FPRC;

|PROCESO Campo6; |TIPO 0;
     |SI #dsmom028#7 = "S";
         |SI nEstado ! 0;
             FSalida = 10;
         |FINSI;
     |FINSI;

     |SI FSalida = 10;
         #dsmom028#6 = #dsmom028#8; |PINTA #dsmom028#6;
         |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     eaNomDef = "dsmom028";

|| \\\\\\ Consulta del Modelo ////////

     |ABRE #dsmom028;
     #dsmom028#0 = enEmpresa;
     #dsmom028#1 = enEjer;
     #dsmom028#2 = enPeriodo;
     #dsmom028#3 = enModelo;
     #dsmom028#4 = enComplem;
     #dsmom028#5 = enActividad;
     |LEE 101#dsmom028.=;
     nEstado = FSalida;
     |SI nEstado ! 0;
         |DDEFECTO #dsmom028;
         #dsmom028#0 = enEmpresa;
         #dsmom028#1 = enEjer;
         #dsmom028#2 = enPeriodo;
         #dsmom028#3 = enModelo;
         #dsmom028#4 = enComplem;
         #dsmom028#5 = enActividad;
         |GRABA 020#dsmom028.b;
     |FINSI;
     nCampo6 = #dsmom028#6;
     aCampo7 = #dsmom028#7;
     nCampo8 = #dsmom028#8;

     |SI enEjer > 2013;
         |HAZ Traemelo;
         #dsmom028#8 = enImporte;
     |FINSI;

     |CABEZA "Prescripciones";
     |PINPA #0#dsmom028;
     |PINDA #0#dsmom028;
     |ENDATOS #1#dsmom028;
     |SI FSalida = 0;
         |GRABA 020#dsmom028.a;
         |SI #dsmom028#6 ! nCampo6; |O #dsmom028#7 ! aCampo7;
             |MENAV "0000Recuerde. Debemos entrar en el Modelo para hacer efectiva la modificacion";
         |FINSI;
     |FINSI;
     |LIBERA #dsmom028;
     |CIERRA #dsmom028;
|FPRO;
