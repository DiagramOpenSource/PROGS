|FICHEROS;
     dsmom006 #0;
     dsmom005;
     dsmom066;
     :/basica/def/agitab99 #199;
|FIN;

|VARIABLES;
 {-1} aMenu       = "";
      aMenu1      = "1262";
      aMenu2      = "1";
      aMenu3      = "2";
      aMenu4      = "DEVOLVER ";
      aMenu5      = "COMPENSAR";
      nModo       = 0;
      aAlfa       = "";
      aAlfa1      = "";
      aBase       = "";
      aMas        = "";
      aLong       = "";
      nLong       = 0;
      nError      = 0;
      aCifDom     = "";
      aNumero     = "";
      nDominante  = 0;
      nOpera      = 0;
      nInkey      = 0;
|FIN;

|INCLUYE i_variar;


|PROCESO ModeloTipo7;  |TIPO 7;
     |HAZ Pantalla;
|FPRC;

|PROCESO Leom005;  |TIPO 6;
     |ABRE #dsmom005;
     #dsmom005#0 = #dsmom006#1;
     |LEE 040#dsmom005.=;
     |SI FSalida ! 0;
         |MENAV "0000No Existe la Configuracion del Modelo ";
         |ERROR;
     |FINSI;
     |CIERRA #dsmom005;
|FPRC;

|PROCESO ModeloTipo0;  |TIPO 0;
     |HAZ Pantalla;
     |SI #dsmom006#1 = 353;
         |MENAV "0000No procede configurar el Modelo 353,";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Pantalla;
     |PINTA 1045, "                              ";
     |C_A #dsmom006#3, 1, 80; |PINTA #dsmom006#3;
     |C_A #dsmom006#4, 1, 80; |PINTA #dsmom006#4;
     |C_V #dsmom006#13, 1, "N"; |C_M #dsmom006#13, 1, "N";
     |C_V #dsmom006#13, 1, "N"; |C_M #dsmom006#13, 1, "N";
     |C_V #dsmom006#15, 1, "N"; |C_M #dsmom006#15, 1, "N";
     |C_V #dsmom006#17, 1, "N"; |C_M #dsmom006#17, 1, "N";
     |SI #dsmom006#1 = 110;
         |PINTA 1059, "Pase Registro:   ";
         |C_V #dsmom006#13, 1, "S"; |PINTA #dsmom006#13;
         |C_M #dsmom006#13, 1, "S";
         |PINTA 1046, "No Per.:   ";
         |C_V #dsmom006#17, 1, "S"; |PINTA #dsmom006#17;
         |C_M #dsmom006#17, 1, "S";
     |FINSI;
     |SI #dsmom006#1 = 322;
         |ATRI P;
         |PINTA 1047, " Num. Grupo:                 ";
         |ATRI 0;
         |C_V #dsmom006#15, 1, "S"; |PINTA #dsmom006#15;
         |C_M #dsmom006#15, 1, "S";
     |FINSI;
|FPRC;

|PROCESO PeriodoTipo7;  |TIPO 7;
     |SI #dsmom006#1 = 349;
         |C_M #dsmom006#6, 1, "S";
         |ACABA;
     |FINSI;

                             |C_M #dsmom006#6, 1, "N";
     |SI #dsmom006#6 = "C";  |C_M #dsmom006#6, 1, "S";  |FINSI;
|FPRC;

|PROCESO PeriodoTipo0;  |TIPO 0;
     |SI #dsmom006#6 = "M";  #dsmom006#7 = "MENSUAL   ";  |FINSI;
     |SI #dsmom006#6 = "T";  #dsmom006#7 = "TRIMESTRAL";  |FINSI;
     |SI #dsmom006#6 = "A";  #dsmom006#7 = "ANUAL     ";  |FINSI;
     |SI #dsmom006#6 = "C";  #dsmom006#7 = "SELECCIONA";  |FINSI;
     |PINTA #dsmom006#6;
     |PINTA #dsmom006#7;
|FPRC;

|PROCESO ConfiguraTipo7;  |TIPO 7;
     |ABRE #agitab99;
     #agitab99#0 = #dsmom006#1;
     |LEE 040#agitab99.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab99;  |FINSI;
     |CIERRA #agitab99;

     |C_M #dsmom006#8, 1, "S";
     |SI #dsmom006#1 ! 110; |Y #dsmom006#1 ! 115;
          |Y #dsmom006#1 ! 123; |Y #dsmom006#1 ! 216;
         |SI #agitab99#6 = "M";  |C_M #dsmom006#8, 1, "N";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO ConfiguraTipo0;  |TIPO 0;
     |SI #agitab99#6 = "F";  |Y #dsmom006#8 = "M";
         |SI #dsmom006#1 ! 110; |Y #dsmom006#1 ! 115;
              |Y #dsmom006#1 ! 123; |Y #dsmom006#1 ! 216;
             |MENAV "     El Modelo no se puede introducir por Empresa.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #agitab99#6 = "X";  |Y #dsmom006#8 ! "M";
         |MENAV "     El Modelo no se puede introducir por Actividades.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #dsmom006#8 = "A";  #dsmom006#9 = "ACTIVIDAD ";  |FINSI;
     |SI #dsmom006#8 = "M";  #dsmom006#9 = "EMPRESA   ";  |FINSI;
     |SI #dsmom006#8 = "C";  #dsmom006#9 = "ACT.+ REG.";  |FINSI;
     |PINTA #dsmom006#8;
     |PINTA #dsmom006#9;
|FPRC;

|PROCESO UltimoPeriodoM6;  |TIPO 7;
     |SI #agitab99#7 = "N";
         #dsmom006#12 = "";
     |SINO;
         |PUSHV 0501 2380;
         |PARA; |SI; |HACIENDO;
                |MENUG aMenu;
                aMenu2 = FSalida;

                |SI aMenu2 = "1";   #dsmom006#12 = aMenu4;  |SAL;  |FINSI;
                |SI aMenu2 = "2";   #dsmom006#12 = aMenu5;  |SAL;  |FINSI;
         |SIGUE;
         |POPV;
     |FINSI;
     |PINTA #dsmom006#12;
|FPRC;

|PROCESO PaseTipo7;  |TIPO 7;
     |C_M #dsmom006#13, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI #dsmom006#1 = 110;
         nModo = (FEntrada / 100) ! 0;
         |SI nModo = 1; |O #dsmom006#13 = " ";
             #dsmom006#13 = #agitab99#8; |PINTA #dsmom006#13;
         |FINSI;

         |PUSHV 1148 2380;
         |BLANCO 1148 1880;
         |CUADRO 1148 1880;
         |PINTA 1249, " <N> Sin Pase Registro         ";
         |PINTA 1349, " <S> Con Pase Registro         ";
         |PINTA 1449, " <L> Con Pase Laboral y profe- ";
         |PINTA 1549, " sionales  desde  Contabilidad ";
         |PINTA 1649, " <G> Con Pase Registro Laboral ";
         |PINTA 1749, " <X> En laboral, SIN MODELO 110";
         |ATRI I; |PINTA 1150, "PASE REGISTRO";
         |PINTA 1251, "N"; |PINTA 1351, "S";
         |PINTA 1451, "L"; |PINTA 1651, "G";
         |PINTA 1751, "X"; |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO PaseTipo0;  |TIPO 0;
     |C_M #dsmom006#13,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |POPV;
     |SI #dsmom006#13 = " ";
         #dsmom006#13 = #agitab99#8; |PINTA #dsmom006#13;
     |FINSI;
|FPRC;

|PROCESO TrasNGrupo; |TIPO 6;
     |C_M #dsmom006#15, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     nInkey = FSalida;
     |SI FSalida = 2; |ACABA; |FINSI;

     aNumero    = "";
     nError     = 0;
     nDominante = 0;

     aAlfa = #dsmom006#15;
     |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Introduzca Numero de Grupo";
         |ERROR;
         |ACABA;
     |FINSI;

     nModo = 0;
     |SI nInkey = 10;  nModo = 4;  |FINSI;

     |ABRE #dsmom066;
     #dsmom066#0 = #dsmom006#15;
     |LEE 041#dsmom066.=;
     |SI FSalida ! 0;
         |CONFI "0000SNo existe el Grupo de Empresas. Desea darlo de Alta";
         |SI FSalida = 0;
             nModo = 1;
         |SINO;
             |ERROR;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom066;
     |SI nModo ! 0;
         aAlfa = #dsmom006#15 + nModo;
         aAlfa = "dsmom066;" + aAlfa;
         |SUB_EJECUTA_NP aAlfa;
     |FINSI;
|FPRC;


|PROCESO ModeloTipo3; |TIPO 3;
     |SI #dsmom006#1 ! 322;
         #dsmom006#15 = "";
     |FINSI;
|FPRC;

|| /////////////////////////////////////////////////////////////////////////

|RUTINA ClaveBaja0;
     #dsmom006#0 = enEmpresa;
     #dsmom006#1 = 000;
|FRUT;

|RUTINA ClaveAlta0;
     #dsmom006#0 = enEmpresa;
     #dsmom006#1 = 999;
|FRUT;

|PROGRAMA;

     |SI enModo ! 4;
         |ENTLINEAL #1#dsmom006, -2, 1, 22, 1, ClaveBaja0, ClaveAlta0;
     |SINO;
         |ENTLINEAL #1#dsmom006, -2, 4, 22, 1, ClaveBaja0, ClaveAlta0;
     |FINSI;
|FPRO;
