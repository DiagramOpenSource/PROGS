|FICHEROS;
   dsmoy082 #0;

   dsmo5830 #1;
   dsmo5831 #583;
   dsmo5832 #584;

   :/basica/def/agicen14 #114;
   :/basica/def/agim0019 #119;

   dsmow030 #900;
|FIN;

|VARIABLES;
   &entrada = 1;

   swBueno    = 0;
   &swerror   = 0;
   nCampo     = 0;
   aAlfa1     = "";
   aAlfa2     = "";
   informe    = "";
   inform1    = "dsmoy082";
   inform2    = "dsmoyn82";

   &enDInst   = 0;
   &enHInst   = 0;

   nDEmpresa   = 0;
   nHEmpresa   = 0;
   nDActividad = 0;
   nHActividad = 0;
   nLaEmpresa  = 0;
   &nCamSel    = 21;
   &nCamTip    = 34;
   nSw = 0;

   &eaTAlta = "";
   &eaTBaja = "";
   nTMov    = 0;
   aTMov    = "";
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varlib;
|INCLUYE i_selcon;

|| //////////////////// Calculos de Pantalla \\\\\\\\\\\\\\\\\\\\\\\\\\
|CALCULO Tipo7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #0#5  = enEmpresa;  |PINTA #0#5;
         #0#6  = enEmpresa;  |PINTA #0#6;

         |C_M #0#5, 1, "N";
         |C_M #0#6, 1, "N";
     |FINSI;
|FCAL;

|CALCULO Parrilla;
     |SI #0#5 = 0;
         #0#5 = 0;  |PINTA #0#5;
         #0#6 = 0;  |PINTA #0#6;  |C_M #0#6, 1, "N";
         |PARA nCampo = 7;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #0#5, 1, "S";
             |C_M #0#6, 1, "S";
         |FINSI;

         |PARA nCampo = 7;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FCAL;

|| **************************************************************
|| //////////////////// Procesos del Informe  \\\\\\\\\\\\\\\\\\\\\\\\\\
|PROCESO imprelin;

 |SI #0#4 = "F";

     nSw = 1;
     |PRINT;
 |FINSI;
 #0#36 = #0#36 + #584#8;
 #0#37 = #0#37 + #584#10;
 #0#38 = #0#38 + #584#12;
 #0#39 = #0#39 + (#584#13 + #584#14);
|FPRC;

|DEFBUCLE LasLineas;
 #584#1;
 ;
 #1#0, 2013, 99, #1#2;
 #1#0, 2099, 99, #1#2;
 e;
 NULL, imprelin;
|FIN;

|PROCESO LaImpresion;
   |SI nLaEmpresa ! #1#0;
       |SI nLaEmpresa ! -1;
           |SI #0#4 = "I"; |PIEINF; nSw = 0; |FINSI;
       |FINSI;
       nLaEmpresa = #1#0;
       enEmpresa  = #1#0;
       swBueno = 0;
       |HAZ LaSelEmpresa;
       |SI enSwSelEmp = 1;  swBueno = 1;  |FINSI;
   |FINSI;
   |SI swBueno = 1; |ACABA; |FINSI;

   |HAZ LeeDatosEmpresa;

   |SI #0#2 = "A";
       |SI #1#6 ] "01.01.1000"; |ACABA; |FINSI;
   |FINSI;
   |SI #0#2 = "B";
       |SI #1#6 < "01.01.1000"; |ACABA; |FINSI;
   |FINSI;

   |PDEFECTO #0,35,40;
   |BUCLE LasLineas;
   |SI #0#4 = "F";
       |SI nSw = 0;
           |DDEFECTO #584;
           #584#1 = 0; #584#11 = 0;
           |PRINT; nSw = 1; |FINSI;
       |PIEINF;
        nSw = 0;
   |SINO;
       |PRINT; nSw = 1;
   |FINSI;
|FPRC;

|DEFBUCLE dsmoy082;
     #1#1;
     5;
     nDEmpresa, #0#0, #0#19;
     nHEmpresa, #0#1, #0#20;
     e;
     NULL, LaImpresion;
|FIN;

|PROCESO imprimir;
     nLaEmpresa = -1;
     swBueno = 0;
     |BUCLE dsmoy082;
|FPRC;

|CALCULO Tipo3;  |TIPO 3;

    informe = inform1;
    |SI #0#4 = "I"; informe = inform2; |FINSI;

    |SI #0#4 = "F";
        Impresora = "CrystalReport";
        |IMPRE -1;
        |SI FSalida ! 0;
            |MENAV "0000 No tiene instalada Impresora CrystalReport, pongase en contacto con su Administrador";
            |ACABA;
       |FINSI;
    |SINO;
        |IMPRE 0;
        |SI FSalida ! 0;  |ACABA;  |FINSI;
    |FINSI;

    |INFOR informe;
    |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     nSw = 0;
     |SI #0#5 ! 0;
         nDEmpresa = #0#5;
         nHEmpresa = #0#6;
         |HAZ imprimir;
     |SINO;
         |PARA nCampo = 7; |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
               nDEmpresa = #0nCampo;
               nHEmpresa = #0nCampo;
               |HAZ imprimir;
         |SIGUE;
     |FINSI;
     |SI nSw = 1;
         |PIEINF;
     |FINSI;
     |FININF;
     |FINIMP;
|FCAL;

|PROGRAMA;
 |HAZ LeeEURODBMOD;
 |SI enEmpresa ! 0;
     |DDEFECTO #0;
     #0#4 = "I";
     |SI enHInst = 0;
         enHInst = enDInst;
         #0#4 = "F";
     |FINSI;
     #0#0 = enDInst;
     #0#1 = enHInst;
     #0#2 = "T";
     #0#5 = enEmpresa;
     #0#6 = enEmpresa;
     #0#21 = "S";
     |HAZ Tipo3;
 |SINO;
     |CLS;
     |MANTE #0;
 |FINSI;
|FPRO;

|PROCESO LeeDatosEmpresa;
  |DDEFECTO #900;
  #900#0 = enEmpresa;
  eaInac = #0#21;
  eaTituloL = "";
  enActividad = 0;
  |HAZ DatosEmpr_w30;
|FPRC;
