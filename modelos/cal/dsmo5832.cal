|FICHEROS;
     dsmo5830 #0;
     dsmo5831 #583;
     dsmo5832 #584,MANTE;

     &reflejo@   #22;
|FIN;

|VARIABLES;
     aPathModelo = "";
     &aDef       = "";
     aAlfa       = "";
     nPara1      = 0;
     nPara2      = 0;

     &enEmpOrigen = 0;
     &enEjeOrigen = 0;
     &eaLinOrigen = "";
     &eaNomOrigen = "";
     &eaNifOrigen = "";
     &enPrvOrigen = 0;
     &eaPrvOrigen = "";
     &enSw999     = 0;

     nCampo8  = 0;
     nCampo10 = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Calculo;
     |SI #584#2 ! 99;
         #584#8  = nCampo8  + #584#7;        |PINTA #584#8;
         #584#10 = nCampo10 + #584#9;        |PINTA #584#10;
     |FINSI;
     #584#12 = ( #584#10 % #584#11) ! 2; |PINTA #584#12;
     #584#14 = #584#12 - #584#13;
     |SI #584#14 < 0; |Y #584#2 ! 99;
         #584#14 = 0;
     |FINSI;
     |PINTA #584#14;
|FPRC;

|PROCESO Tipo12mo5832; |TIPO 12;
|FPRC;

|PROCESO Tipo7C11mo5832; |TIPO 7;
|FPRC;

|PROCESO Tipo2mo5832;  |TIPO 2;
      #583#6  = #583#6  +. #584#8;  |PINTA #583#6;
      #583#7  = #583#7  +. #584#10; |PINTA #583#7;

      #583#8  = #583#8  +. 1;       |PINTA #583#8;
      #583#18 = #583#18 +. #584#12; |PINTA #583#18;
      #583#19 = #583#19 +. #584#13; |PINTA #583#19;
      #583#20 = #583#20 +. #584#14; |PINTA #583#20;
|FPRC;

|PROCESO LeeAcumulados;
      nCampo8  = #584#8  - #584#7;
      nCampo10 = #584#10 - #584#9;
|FPRC;

|RUTINA ClaveBaja22;
     #22#0  = #583#0;
     #22#1  = #583#1;
     #22#2  = #583#2;
     #22#4  = "                         ";
|FRUT;

|RUTINA ClaveAlta22;
     #22#0  = #583#0;
     #22#1  = #583#1;
     #22#2  = #583#2;
     #22#4  = "zzzzzzzzzzzzzzzzzzzzzzzzz";
|FRUT;

|PROCESO CargaReflejo;
     |DBASE aPathModelo;  |QBT aPathModelo;
     aDef = aPathModelo + "def/" + aDef;
     |CARGA_DEF aDef, reflejo@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar " + aDef;
         |MENAV aAlfa;
         aDef = "";
     |FINSI;
|FPRC;

|PROCESO DescargaReflejo;
    |SI aDef ! ""; |DESCARGA_DEF #reflejo@; aDef = ""; |FINSI;
|FPRC;

|PROCESO Tipo7C4mo5832; |TIPO 7;
    aAlfa = "    <F2> Datos Linea; <F3> Consultar por GRID";
    |SI enTipoEntrada = 4;
        aAlfa = "    <F3> Consultar por GRID";
    |FINSI;
    |MENSA aAlfa;
|FPRC;

|PROCESO Tipo11mo5832;  |TIPO 11;

     |SI FSalida = 11;

         aDef = "dsmo5832";
         |HAZ CargaReflejo;
         |SI aDef = "";
             |ERROR;
             |ACABA;
         |FINSI;

         |ABRE #22;
         |CONSULTA_F_CLAVE #1#22, ClaveBaja22, ClaveAlta22;
         |SI FSalida = 0;
             #584#0 = #22#0;
             #584#1 = #22#1;
             #584#2 = #22#2;
             |LEE 000#584=;
         |FINSI;
         |CIERRA #22;

         |HAZ DescargaReflejo;

         |PTEC 809;
         |PTEC 808;
         |PONCONTROL  23, "SI";
     |FINSI;

     |SI FSalida = 10; |Y enTipoEntrada ! 4;

         |LEE 041#584=;

         |HAZ LeeAcumulados;
         |SI #584#2 = 99;
             |C_M #584#7,1,"N"; |C_M #584#8, 1,"S";
             |C_M #584#9,1,"N"; |C_M #584#10,1,"S";
         |SINO;
             |C_M #584#7,1,"S"; |C_M #584#8, 1,"N";
             |C_M #584#9,1,"S"; |C_M #584#10,1,"N";
         |FINSI;

         |ENDATOS #2#584;
         |GRABA 020#584a;
         |LIBERA #584;

     |FINSI;
     |SI FSalida = 0;
         |ERROR;
     |FINSI;
|FPRC;
