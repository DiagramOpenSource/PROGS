|FICHEROS;
     program@;

     dsmom001;
     dsmom071;

     dsmow016;
     dsmow040;
     dsmow041;

     dsmoy020;
     dsmoy021;
     dsmoy037;
     dsmoy040;
     dsmoy041;
     dsmoy042;
     dsmoy043;
     dsmoy044;
     dsmoy045;
     dsmoy046;
     dsmoy047;
     dsmoy051;
     dsmoy052;
     dsmoy053;
     dsmoy089;

     dsmoz001;
     dsmoz002;
     dsmoz003;
     dsmoz004;
     dsmoz005;
     dsmoz012;
     dsmoz014;
     dsmoz037;
     dsmoz042;
     dsmoz043;
     dsmoz044;
     dsmoz045;
     dsmoz046;
     dsmoz048;
     dsmoz050;
     dsmoz051;
     dsmoz053;

     dsmozpas;
     dsmozpro;

     :/basica/def/agifigen;
     :/laboral/def/labempre;

     :integral/pntm0001;
     :integral/pntm0002;
|FIN;

|VARIABLES;
     nCanal               = 0;
     nCampoCliente        = 0;
     nTecla               = 0;

     nNume1               = 0;
     aAlfa1               = "";
     aQueQuiero           = "";
     aIDCampo             = "";
     aAlfa                = "";
     aBase                = "";
     aUsuario             = "";

     &aPrograma           = "";
     &enSw                = 0;
     &enLabornet          = 0;
     &eaRutaFichLab       = "";
|FIN;

|INCLUYE i_variar;

||******************** RESTRICCIONES PINET ****************

|PROCESO RestriccionPINET_MOD4;
     enErrorPINET = 0;

     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aUsuario = Usuario % 810;

     |ABRE #pntm0001;
     |SELECT #2#pntm0001;
     #pntm0001#1 = aUsuario;
     |LEE 000#pntm0001.=;
     |SI FSalida ! 0;
         |CIERRA #pntm0001;
         |ACABA;
     |FINSI;
     |CIERRA #pntm0001;

     |ABRE #pntm0002;
     #pntm0002#0 = #pntm0001#0;
     #pntm0002#1 = enEmpresaPINET;
     |LEE 000#pntm0002.=;
     |SI FSalida ! 0;
         enErrorPINET = 1;

         #pntm0002#0 = #pntm0001#0;
         #pntm0002#1 = 1;
         |LEE 000#pntm0002.];

         enEmpresaPINET = #pntm0002#1;
     |FINSI;
     |CIERRA #pntm0002;
|FPRC;

|PROCESO CargoRef_1;
     |SI eaElProm = "";
         aPrograma = Control;  |QBF aPrograma;
     |SINO;
         aPrograma = eaElProm;  |QBF aPrograma;
     |FINSI;

     aPrograma = aPrograma % 108;

     enSw = 0;
     |SI aPrograma = "dsmom001"; |REFERENCIA_DEF program@, #dsmom001;  enSw = 1; |FINSI;
     |SI aPrograma = "dsmom071"; |REFERENCIA_DEF program@, #dsmom071;  enSw = 1; |FINSI;

     |SI aPrograma = "dsmow016"; |REFERENCIA_DEF program@, #dsmow016; enSw = 1; |FINSI;
     |SI aPrograma = "dsmow040"; |REFERENCIA_DEF program@, #dsmow040; enSw = 1; |FINSI;
     |SI aPrograma = "dsmow041"; |REFERENCIA_DEF program@, #dsmow041; enSw = 1; |FINSI;

     |SI aPrograma = "dsmoy020"; |REFERENCIA_DEF program@, #dsmoy020; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy021"; |REFERENCIA_DEF program@, #dsmoy021; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy037"; |REFERENCIA_DEF program@, #dsmoy037; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy040"; |REFERENCIA_DEF program@, #dsmoy040; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy041"; |REFERENCIA_DEF program@, #dsmoy041; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy042"; |REFERENCIA_DEF program@, #dsmoy042; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy043"; |REFERENCIA_DEF program@, #dsmoy043; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy044"; |REFERENCIA_DEF program@, #dsmoy044; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy045"; |REFERENCIA_DEF program@, #dsmoy045; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy046"; |REFERENCIA_DEF program@, #dsmoy046; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy047"; |REFERENCIA_DEF program@, #dsmoy047; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy051"; |REFERENCIA_DEF program@, #dsmoy051; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy052"; |REFERENCIA_DEF program@, #dsmoy052; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy053"; |REFERENCIA_DEF program@, #dsmoy053; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoy089"; |REFERENCIA_DEF program@, #dsmoy089; enSw = 1; |FINSI;

     |SI aPrograma = "dsmoz001"; |REFERENCIA_DEF program@, #dsmoz001; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz002"; |REFERENCIA_DEF program@, #dsmoz002; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz003"; |REFERENCIA_DEF program@, #dsmoz003; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz004"; |REFERENCIA_DEF program@, #dsmoz004; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz005"; |REFERENCIA_DEF program@, #dsmoz005; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz012"; |REFERENCIA_DEF program@, #dsmoz012; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz014"; |REFERENCIA_DEF program@, #dsmoz014; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz037"; |REFERENCIA_DEF program@, #dsmoz037; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz042"; |REFERENCIA_DEF program@, #dsmoz042; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz043"; |REFERENCIA_DEF program@, #dsmoz043; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz044"; |REFERENCIA_DEF program@, #dsmoz044; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz045"; |REFERENCIA_DEF program@, #dsmoz045; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz046"; |REFERENCIA_DEF program@, #dsmoz046; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz048"; |REFERENCIA_DEF program@, #dsmoz048; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz050"; |REFERENCIA_DEF program@, #dsmoz050; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz051"; |REFERENCIA_DEF program@, #dsmoz051; enSw = 1; |FINSI;
     |SI aPrograma = "dsmoz053"; |REFERENCIA_DEF program@, #dsmoz053; enSw = 1; |FINSI;

     |SI aPrograma = "dsmozpas"; |REFERENCIA_DEF program@, #dsmozpas; enSw = 1; |FINSI;
     |SI aPrograma = "dsmozpro"; |REFERENCIA_DEF program@, #dsmozpro; enSw = 1; |FINSI;
|FPRC;

||******************* PROCESOS CONSULTA DE EMPRESAS LABORAL ****************

|PROCESO ConsuCliente_Lab;
     |SI eaRutaFichLab ! "";
          |PATH_DAT #labempre#eaRutaFichLab#;
     |FINSI;

     |HAZ CargoRef_1;
     |SI enSw = 0; |ACABA; |FINSI;

     |ATRI R; |BLIN 04; |ATRI 0;

     |SI nTecla ! 10; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     nCampoCliente  = Campo;

     |ABRE #labempre;
     #labempre#0 = #program@#nCampoCliente#;
     |LEE 040#labempre.=;

     |CONSULTA_CLAVE #2#labempre;
     |CIERRA #labempre;
     #program@#nCampoCliente# = #labempre#0;

     |POPV;
     |PINTA #program@#nCampoCliente#;
|FPRC;

|| *************** FIN PROCESOS CONSULTA DE EMPRESAS LABORAL ****************

|PROCESO MensaCliente; |TIPO 7;
     |HAZ CargoRef_1;
     |SI enSw = 0; |ACABA; |FINSI;

     nNume1 = Campo;
     aAlfa1 = ("000" + nNume1) % -103;
     aQueQuiero = "|C" + aAlfa1 + "IDCAMPO";
     aIDCampo = #program@#aQueQuiero#;
     |QBF aIDCampo;

     |SI aIDCampo = "parrilla";
          aAlfa1 = "     <00000> Seleccion Parrilla. <F2> Consulta Clientes";
     |SINO;
         aAlfa1 = "      <F2> Consulta Clientes";
     |FINSI;
     |MENSA aAlfa1;
|FPRC;

|PROCESO ConsuCliente; |TIPO 0;
     nTecla = FSalida;

     |SI nTecla ! 10;  |Y #program@#Campo# ! 0;
         enEmpresaPINET = #program@#Campo#;
         |HAZ RestriccionPINET_MOD4;
         |SI enErrorPINET = 1;
             #program@#Campo# = enEmpresaPINET;   |PINTA #program@#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enLabornet = 1;
          |HAZ ConsuCliente_Lab;
     |SINO;
          |HAZ CargoRef_1;
          |SI enSw = 0; |ACABA; |FINSI;

          |ATRI R; |BLIN 04; |ATRI 0;

          |SI nTecla ! 10; |ACABA; |FINSI;

          |PUSHV 0501 2380;
          nCampoCliente  = Campo;

          |ABRE #agifigen;
          #agifigen#0 = #program@#nCampoCliente#;
          |LEE 040#agifigen.=;

          |CONSULTA_CLAVE #2#agifigen;
          |CIERRA #agifigen;
          #program@#nCampoCliente# = #agifigen#0;

          |POPV;
          |PINTA #program@#nCampoCliente#;
     |FINSI;
|FPRC;
