|FICHEROS;
   dsmow300 #0;
|FIN;

|VARIABLES;
   fHoy   = @;
   aAlfa  = "";
   aAlfa1 = "";
   nDia1  = 0;
   nDia2  = 0;
   nMes1  = 0;
   nMes2  = 0;
   nAny1  = 0;
   nAny2  = 0;
   nEdad  = 0;
|FIN;

|PROCESO PonSiglo20;
     aAlfa1 = #0Campo;
     aAlfa1 = (aAlfa1 % 106) + "19" + (aAlfa1 % -102);
     #0Campo = aAlfa1;
     |PINTA #0Campo;
|FPRC;

|PROCESO CumpleAnyos;
     aAlfa1 = fHoy;    aAlfa1 = aAlfa1 % -104; nAny1 = aAlfa1;
     aAlfa1 = #0Campo; aAlfa1 = aAlfa1 % -104; nAny2 = aAlfa1;
     nEdad  = nAny1 - nAny2;

     |SI nEdad ! 18; |ACABA; |FINSI;

     aAlfa1 = fHoy;    aAlfa1 = aAlfa1 % 402; nMes1 = aAlfa1;
     aAlfa1 = #0Campo; aAlfa1 = aAlfa1 % 402; nMes2 = aAlfa1;

     |SI nMes2 > nMes1;  nEdad = nEdad - 1; |FINSI;
     |SI nMes1 ! nMes2;  |ACABA;            |FINSI;

     aAlfa1 = fHoy;    aAlfa1 = aAlfa1 % 102; nDia1 = aAlfa1;
     aAlfa1 = #0Campo; aAlfa1 = aAlfa1 % 102; nDia2 = aAlfa1;

     |SI nDia2 > nDia1;  nEdad = nEdad - 1; |FINSI;
|FPRC;

|PROCESO ValFechaNacim;
     |SI #0Campo = "01.01.0000";  |ACABA;  |FINSI;

     fHoy = ~;

     |SI #0Campo > fHoy;    || nacimientos futuros como que no
          |HAZ PonSiglo20;    ||/se cambia sin preguntar
     |FINSI;

     |SI #0Campo ] "01.01.2000"; |Y #0Campo [ fHoy;     || presuntos ni¤os,
                                                            ||/se pregunta
         |HAZ CumpleAnyos;
         |SI nEdad < 18;
             aAlfa = "0000SLa fecha puede ser incorrecta. Ha introducido un contribuyente menor de edad. Corregir fecha?";
             |CONFI aAlfa;
             |SI FSalida = 0;
                 |ERROR;
                 || |HAZ PonSiglo20;
             |FINSI;
         |FINSI;
     |FINSI;

|FPRC;
