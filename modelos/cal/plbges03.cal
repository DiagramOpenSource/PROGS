|FICHEROS;
    dsmom072 #72;
    dsmom72@ #972;
|FIN;

|VARIABLES;
     &enSwCobro  = 0;
     &enOpCobro  = 0;
     &enEjerCob  = 0;
     &enImpoCob  = 0;
     &eaClCobro  = "";
     &eaNifCobro = "";
     &eaSeguro   = "";
     &eaArrenda  = "";
     &eaOp1      = "";
     &eaOp2      = "";
     &eaOp5      = "";
     nHEjer     = 0;
     nImporte   = 0;
     aDef       = "";
|FIN;

|INCLUYE i_variar;

|PROCESO BuscaAcumulado;
   enImpoCob = enImpoCob + #72#7;
   |SI #72#1 = enEjer; enSwCobro = 0; |FINSI;
|FPRC;

|DEFBUCLE BuscaAcumulado;
    #72#1;
    ;
    enEmpresa, 2008,   eaClCobro, eaNifCobro, eaOp1, eaOp2, eaSeguro, eaArrenda, eaOp5, enEjerCob;
    enEmpresa, enEjer, eaClCobro, eaNifCobro, eaOp1, eaOp2, eaSeguro, eaArrenda, eaOp5, enEjerCob;
    e;
    NULL, BuscaAcumulado;
|FIN;

|PROCESO eImporteCobro;
    nHEjer = enEjer - 1;
    enImpoCob = 0;
    enSwCobro = 1;
    |BUCLE BuscaAcumulado;
|FPRC;

|PROCESO eActCobro;

    |SI enEjer ! enEjerCob;
        nImporte = enImpoCob;
        |HAZ eImporteCobro;
    |FINSI;

    |ABRE #72;
    #72#0 = enEmpresa;
    #72#1 = enEjer;
    #72#2 = eaClCobro;
    #72#3 = eaNifCobro;
    #72#8  = eaOp1;
    #72#9  = eaOp2;
    #72#4 = eaSeguro;
    #72#5 = eaArrenda;
    #72#10 = eaOp5;
    #72#6 = enEjerCob;
    |LEE 041#72=;
    |SI FSalida ! 0;
        |DDEFECTO #72;
        #72#0 = enEmpresa;
        #72#1 = enEjer;
        #72#2 = eaClCobro;
        #72#3 = eaNifCobro;
        #72#8 = eaOp1;
        #72#9 = eaOp2;
        #72#4 = eaSeguro;
        #72#5 = eaArrenda;
        #72#10 = eaOp5;
        #72#6 = enEjerCob;
        |GRABA 020#72b;
    |FINSI;

    |SI enEjer ! enEjerCob;
        enImpoCob = enImpoCob - #72#7;
        #72#7 = nImporte - enImpoCob;
    |SINO;
        #72#7 = enImpoCob;
    |FINSI;
    |SI #72#7 ! 0;
       |GRABA 020#72a;
    |SINO;
       |BORRA 020#72a;
    |FINSI;
    |LIBERA #72;
    |CIERRA #72;
|FPRC;
