|FICHEROS;
     dsmow006 #998;

     dsmom014;
     dsmom013 #13,MANTE;
     dsmopl13,MANTE;
|FIN;

|VARIABLES;
     aConcepto = "";
     nDosIntro = 0;
     nCampo    = 0;
     nCampo1   = 0;
     nTecla    = 0;
     &enCalculado = 0;
     nConte    = 0;
     nModo     = 0;
     aAlfa     = "";
     nAlta     = 0;
     &eaDCta   = "";
     &eaHCta   = "";
     &enTotal  = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo11m013;
|FPRC;

|PROCESO DosIntrom013;  |TIPO 7;
     |SI nDosIntro = 0;
         |PTEC 802;
         |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Sumapl13;
    nConte = nConte + #dsmopl13#8;
|FPRC;

|DEFBUCLE Sumapl13;
    #dsmopl13#1;
    ;
    #dsmom013#0, #dsmom013#1, #dsmom013#2, #dsmom013#3, #dsmom013#4, eaDCta;
    #dsmom013#0, #dsmom013#1, #dsmom013#2, #dsmom013#3, #dsmom013#4, eaHCta;
    e;
    NULL, Sumapl13;
|FIN;

|PROCESO Bajapl13;
    #dsmopl13#0 = #dsmom013#0;
    #dsmopl13#1 = #dsmom013#1;
    #dsmopl13#2 = #dsmom013#2;
    #dsmopl13#3 = #dsmom013#3;
    #dsmopl13#4 = #dsmom013#4;
    #dsmopl13#5 = eaDCta;
|FPRC;

|PROCESO Altapl13;
    #dsmopl13#0 = #dsmom013#0;
    #dsmopl13#1 = #dsmom013#1;
    #dsmopl13#2 = #dsmom013#2;
    #dsmopl13#3 = #dsmom013#3;
    #dsmopl13#4 = #dsmom013#4;
    #dsmopl13#5 = eaHCta;
|FPRC;

|PROCESO Verpl13;
    nAlta = 0;
    |ABRE #dsmopl13;
    #dsmopl13#0 = #dsmom013#0;
    #dsmopl13#1 = #dsmom013#1;
    #dsmopl13#2 = #dsmom013#2;
    #dsmopl13#3 = #dsmom013#3;
    #dsmopl13#4 = #dsmom013#4;
    #dsmopl13#5 = #dsmom013#5;
    |LEE 041#dsmopl13.];
    |SI FSalida ! 0;
        nAlta = 1;
    |SINO;
        aAlfa = #dsmopl13#5 % 104;
        |SI aAlfa ! #dsmom013#5;
            nAlta = 1;
        |FINSI;
    |FINSI;
    |SI nAlta = 1; |Y #dsmom013#8 ! 0;
        #dsmopl13#0 = #dsmom013#0;
        #dsmopl13#1 = #dsmom013#1;
        #dsmopl13#2 = #dsmom013#2;
        #dsmopl13#3 = #dsmom013#3;
        #dsmopl13#4 = #dsmom013#4;
        #dsmopl13#5 = #dsmom013#5;
        #dsmopl13#6 = #dsmom013#6;
        #dsmopl13#7 = #dsmom013#7;
        #dsmopl13#8 = #dsmom013#8;
        |GRABA 041#dsmopl13.n;
    |FINSI;
    |CIERRA #dsmopl13;

    |SI #998#60 = "X"; |Y nModo ! 4;
        |MENAV "    Modificar Importes por Introduccion Datos Agrupados";
        nModo = 4;
    |FINSI;

    eaDCta = #dsmom013#5;
    eaHCta = #dsmom013#5 + "zzzzzzzz";

    |PUSHV 0501 2380;
    |PINPA #0#dsmopl13;
    |PINTA 2069, #dsmom013#8;
    |ENTLINEAL #1#dsmopl13, -6, nModo, 18, 0, Bajapl13, Altapl13;
    |POPV;

    |SI nModo ! 4;
        nConte = 0;
        |BUCLE Sumapl13;
        #dsmom013#8 = nConte; |PINTA #dsmom013#8;
    |FINSI;
|FPRC;

|PROCESO NoPasom013;  |TIPO 7;
     |ABRE #dsmom014;
     |SELECT #1#dsmom014;
     #dsmom014#10 = enPlan14;
     #dsmom014#0  = #13#5;
     |LEE 040#dsmom014.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom014;  |FINSI;
     |CIERRA #dsmom014;

     eaCta60 = #dsmom013#5;
     eaTip60 = "G";
     |HAZ HayDesglose60;

     nModo = 2;
     |C_M #13#8,  1, "S";
     |SI #dsmom014#6 = "N";
         |C_M #13#8,  1, "N";
         nModo = 4;
     |FINSI;

     |SI enEjer ] 2019; |Y enDesglose60 = 1;
         |HAZ Verpl13;
     |SINO;
         |MENSA "    <F5> Calculadora";
     |FINSI;

|FPRC;

|PROCESO Teclam013;
     nTecla = FSalida;
     nConte = Contenido;
     |SI enDesglose60 = 1; |ACABA; |FINSI;

     |SI nTecla = 2;
         |PTEC 802;
         |PTEC 802;
         |PTEC 808;
         aConcepto = "";

         nDosIntro = 1;
         |ACABA;
     |FINSI;

     |SI nTecla = 1;
         |PTEC 806;
         nDosIntro = 1;
         aConcepto = #13#5;
         |ACABA;
     |FINSI;

     |SI nTecla = 13;
         enCalculado = #13#8;
         |HAZ Calculadora;
         #13#8 = enCalculado;
         |PINTA #13#8;
     |FINSI;

     |SI aConcepto = #13#5;
         |ERROR;
         aConcepto = "";
     |SINO;
         nDosIntro = 0;
         aConcepto = #13#5;
     |FINSI;

     |SI #998#60 = "X";
         |SI #13#8 ! nConte;
             |MENAV "    Modificar Importes por Introduccion Datos Agrupados";
         |FINSI;
         #13#8 = nConte; |PINTA #13#8;
     |FINSI;
|FPRC;

|PROCESO Tipo2m013;  |TIPO 2;
     |SI #13#7 = "+";
         #998#23 = #998#23 +. #13#8;
     |SINO;
         #998#23 = #998#23 -. #13#8;
     |FINSI;

     |ATRI S;  |PINTA 2269, #998#23;  |ATRI s;
|FPRC;

|PROCESO Descarga13;
     nDosIntro = 0;
|FPRC;
