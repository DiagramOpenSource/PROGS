|FICHEROS;
     &program@;

     &provinc@;
     :/basica/def/agiprovi;
     :/integral/def/dsam0100;

     &poblaci@;
     :/basica/def/agipobla;
     :/integral/def/dsam0101;
|FIN;

|VARIABLES;
     aPrograma     = "";
     aBase          = "";
     nCanal         = 0;
     &enSw           = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO LeeProvincia;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF provinc@, #dsam0100;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF provinc@, #agiprovi;
     |FINSI;

     |ABRE #provinc@;
     #provinc@#0 = enCodProv;
     |LEE 040#provinc@.=;
     |SI FSalida ! 0; |DDEFECTO #provinc@; |FINSI;
     eaProvincia = #provinc@#1;
     |CIERRA #provinc@;
|FPRC;

|PROCESO LeeLocalidad;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF provinc@, #dsam0100;
         |REFERENCIA_DEF poblaci@, #dsam0101;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF provinc@, #agiprovi;
         |REFERENCIA_DEF poblaci@, #agipobla;
     |FINSI;

     |ABRE #poblaci@;
     |DDEFECTO #poblaci@;
     #poblaci@#0 = enCodProv;
     #poblaci@#1 = enCodPobl;
     |LEE 040#poblaci@.=;
     |SI FSalida = 0;
         |HAZ ParrillaPobla;
     |SINO;
         |SI enSwMensa = 0;
             |MENAV "    No existe Poblacion.";
             |ERROR;
         |FINSI;
     |FINSI;
     |CIERRA #poblaci@;

     |ABRE #provinc@;
     #provinc@#0 = enCodProv;
     |LEE 040#provinc@.=;
     |SI FSalida ! 0; |DDEFECTO #provinc@; |FINSI;
     |CIERRA #provinc@;
     eaProvincia = #provinc@#1;
|FPRC;

|PROCESO ParrillaPobla;
     |SI enSwDeDonde = 1;
         eaPoblacion = #poblaci@#3;
         enModoPob   = 1;
         |SUB_EJECUTA_NP ":integral/dsaw9996";
         |SI eaPoblaParri ! "";
             eaPoblacion = eaPoblaParri;
         |SINO;
             eaPoblacion = #poblaci@#3;
         |FINSI;
     |SINO;
         eaPoblacion = #poblaci@#2;
         enModoPob   = 1;
         |SUB_EJECUTA_NP ":basica/agiw9996";
         |SI eaPoblaParri ! "";
             eaPoblacion = eaPoblaParri;
         |SINO;
             eaPoblacion = #poblaci@#2;
         |FINSI;
     |FINSI;
|FPRC;
