|FICHEROS;
     dsmod110;
     dsm190li;
     dsm19001;
     dsmom073;
     dsmom004;

     dsmod110@;
|FIN;

|VARIABLES;
     aBase      = "";
     aDef       = "";
     aAlfa      = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Justificante;  |TIPO 7;
     |SI #dsmod110#30 = "             ";  |Y #dsmod110#4 ! 0;
         |ABRE #dsmom004;
         #dsmom004#0 = #dsmod110#0;
         #dsmom004#1 = #dsmod110#1;
         #dsmom004#2 = #dsmod110#2;
         #dsmom004#3 = #dsmod110#3;
         #dsmom004#4 = #dsmod110#4 - 1;
         |LEE 000#dsmom004.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom004;  |FINSI;
         |CIERRA #dsmom004;

         #dsmod110#30 = #dsmom004#25;  |PINTA #dsmod110#30;
     |FINSI;

     |C_M #dsmod110#30, 1, "N";
     |SI #dsmod110#4 ! 0;
         |C_M #dsmod110#30, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Totales;
     #dsmod110#27 = #dsmod110#8 + #dsmod110#11 + #dsmod110#14 + #dsmod110#17 + #dsmod110#20 + #dsmod110#23 + #dsmod110#26 + #dsmod110#33 + #dsmod110#36;
     #dsmod110#29 = #dsmod110#27 - #dsmod110#28;

     |PINTA #dsmod110#27;
     |PINTA #dsmod110#29;
|FPRC;

|PROCESO dsm190li;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #dsm190li#8;
     #dsmom073#2 = #dsm190li#9;
     |LEE 040#dsmom073.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom073;  |FINSI;

     |SI #dsmom073#4 = 0;  |ACABA;  |FINSI;

     |SI #dsmom073#4 = 1;
         |SI #dsm190li#16 ! 0;  |O #dsm190li#17 ! 0;
             #dsmod110#6 = #dsmod110#6 + 1;
             #dsmod110#7 = #dsmod110#7 + #dsm190li#16;
             #dsmod110#8 = #dsmod110#8 + #dsm190li#17;
         |FINSI;

         |SI #dsm190li#18 ! 0;  |O #dsm190li#19 ! 0;  |O #dsm190li#20 ! 0;
             #dsmod110#9  = #dsmod110#9 + 1;
             #dsmod110#10 = #dsmod110#10 + #dsm190li#18;
             #dsmod110#11 = #dsmod110#11 + #dsm190li#19 + #dsm190li#20;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 2;
         |SI #dsm190li#16 ! 0;  |O #dsm190li#17 ! 0;
             #dsmod110#12 = #dsmod110#12 + 1;
             #dsmod110#13 = #dsmod110#13 + #dsm190li#16;
             #dsmod110#14 = #dsmod110#14 + #dsm190li#17;
         |FINSI;

         |SI #dsm190li#18 ! 0;  |O #dsm190li#19 ! 0;  |O #dsm190li#20 ! 0;
             #dsmod110#15 = #dsmod110#15 + 1;
             #dsmod110#16 = #dsmod110#16 + #dsm190li#18;
             #dsmod110#17 = #dsmod110#17 + #dsm190li#19 + #dsm190li#20;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 3;
         |SI #dsm190li#16 ! 0;  |O #dsm190li#17 ! 0;
             #dsmod110#18 = #dsmod110#18 + 1;
             #dsmod110#19 = #dsmod110#19 + #dsm190li#16;
             #dsmod110#20 = #dsmod110#20 + #dsm190li#17;
         |FINSI;

         |SI #dsm190li#18 ! 0;  |O #dsm190li#19 ! 0;  |O #dsm190li#20 ! 0;
             #dsmod110#21 = #dsmod110#21 + 1;
             #dsmod110#22 = #dsmod110#22 + #dsm190li#18;
             #dsmod110#23 = #dsmod110#23 + #dsm190li#19 + #dsm190li#20;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 4;
         |SI #dsm190li#16 ! 0;  |O #dsm190li#17 ! 0;
          |O #dsm190li#18 ! 0;  |O #dsm190li#19 ! 0;  |O #dsm190li#20 ! 0;
             #dsmod110#24 = #dsmod110#24 + 1;
             #dsmod110#25 = #dsmod110#25 + #dsm190li#16 + #dsm190li#18;
             #dsmod110#26 = #dsmod110#26 + #dsm190li#17 + #dsm190li#19 + #dsm190li#20;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 5;
         |SI #dsm190li#16 ! 0;  |O #dsm190li#17 ! 0;
             #dsmod110#31 = #dsmod110#31 + 1;
             #dsmod110#32 = #dsmod110#32 + #dsm190li#16;
             #dsmod110#33 = #dsmod110#33 + #dsm190li#17;
         |FINSI;

         |SI #dsm190li#18 ! 0;  |O #dsm190li#19 ! 0;  |O #dsm190li#20 ! 0;
             #dsmod110#34 = #dsmod110#34 + 1;
             #dsmod110#35 = #dsmod110#35 + #dsm190li#18;
             #dsmod110#36 = #dsmod110#36 + #dsm190li#19 + #dsm190li#20;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm190li;
     #dsm190li#1;
     ;
     #dsmod110#0, #dsmod110#1, 99, 190, 00, 0, "            ", 0000, " ", "  ", 0;
     #dsmod110#0, #dsmod110#1, 99, 190, 00, 0, "zzzzzzzzzzzz", 9999, "z", "zz", 9;
     ;
     NULL, dsm190li;
|FIN;

|PROCESO dsm19001;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #dsm19001#8;
     #dsmom073#2 = #dsm19001#9;
     |LEE 040#dsmom073.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom073;  |FINSI;

     |SI #dsmom073#4 = 0;  |ACABA;  |FINSI;

     |SI #dsmom073#4 = 1;
         |SI #dsm19001#16 ! 0;  |O #dsm19001#17 ! 0;
          |O #dsm19001#65 ! 0;  |O #dsm19001#66 ! 0;
             #dsmod110#6 = #dsmod110#6 + 1;
             #dsmod110#7 = #dsmod110#7 + #dsm19001#16;
             #dsmod110#7 = #dsmod110#7 + #dsm19001#65;
             #dsmod110#8 = #dsmod110#8 + #dsm19001#17;
             #dsmod110#8 = #dsmod110#8 + #dsm19001#66;
         |FINSI;

         |SI #dsm19001#18 ! 0;  |O #dsm19001#19 ! 0;  |O #dsm19001#20 ! 0;
          |O #dsm19001#67 ! 0;  |O #dsm19001#68 ! 0;  |O #dsm19001#69 ! 0;
             #dsmod110#9  = #dsmod110#9 + 1;
             #dsmod110#10 = #dsmod110#10 + #dsm19001#18;
             #dsmod110#10 = #dsmod110#10 + #dsm19001#67;
             #dsmod110#11 = #dsmod110#11 + #dsm19001#19 + #dsm19001#20;
             #dsmod110#11 = #dsmod110#11 + #dsm19001#68 + #dsm19001#69;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 2;
         |SI #dsm19001#16 ! 0;  |O #dsm19001#17 ! 0;
          |O #dsm19001#65 ! 0;  |O #dsm19001#66 ! 0;
             #dsmod110#12 = #dsmod110#12 + 1;
             #dsmod110#13 = #dsmod110#13 + #dsm19001#16;
             #dsmod110#13 = #dsmod110#13 + #dsm19001#65;
             #dsmod110#14 = #dsmod110#14 + #dsm19001#17;
             #dsmod110#14 = #dsmod110#14 + #dsm19001#66;
         |FINSI;

         |SI #dsm19001#18 ! 0;  |O #dsm19001#19 ! 0;  |O #dsm19001#20 ! 0;
          |O #dsm19001#67 ! 0;  |O #dsm19001#68 ! 0;  |O #dsm19001#69 ! 0;
             #dsmod110#15 = #dsmod110#15 + 1;
             #dsmod110#16 = #dsmod110#16 + #dsm19001#18;
             #dsmod110#16 = #dsmod110#16 + #dsm19001#67;
             #dsmod110#17 = #dsmod110#17 + #dsm19001#19 + #dsm19001#20;
             #dsmod110#17 = #dsmod110#17 + #dsm19001#68 + #dsm19001#69;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 3;
         |SI #dsm19001#16 ! 0;  |O #dsm19001#17 ! 0;
          |O #dsm19001#65 ! 0;  |O #dsm19001#66 ! 0;
             #dsmod110#18 = #dsmod110#18 + 1;
             #dsmod110#19 = #dsmod110#19 + #dsm19001#16;
             #dsmod110#19 = #dsmod110#19 + #dsm19001#65;
             #dsmod110#20 = #dsmod110#20 + #dsm19001#17;
             #dsmod110#20 = #dsmod110#20 + #dsm19001#66;
         |FINSI;

         |SI #dsm19001#18 ! 0;  |O #dsm19001#19 ! 0;  |O #dsm19001#20 ! 0;
          |O #dsm19001#67 ! 0;  |O #dsm19001#68 ! 0;  |O #dsm19001#69 ! 0;
             #dsmod110#21 = #dsmod110#21 + 1;
             #dsmod110#22 = #dsmod110#22 + #dsm19001#18;
             #dsmod110#22 = #dsmod110#22 + #dsm19001#67;
             #dsmod110#23 = #dsmod110#23 + #dsm19001#19 + #dsm19001#20;
             #dsmod110#23 = #dsmod110#23 + #dsm19001#68 + #dsm19001#69;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 4;
         |SI #dsm19001#16 ! 0;  |O #dsm19001#17 ! 0;
          |O #dsm19001#65 ! 0;  |O #dsm19001#66 ! 0;
          |O #dsm19001#18 ! 0;  |O #dsm19001#19 ! 0;  |O #dsm19001#20 ! 0;
          |O #dsm19001#67 ! 0;  |O #dsm19001#68 ! 0;  |O #dsm19001#69 ! 0;
             #dsmod110#24 = #dsmod110#24 + 1;
             #dsmod110#25 = #dsmod110#25 + #dsm19001#16 + #dsm19001#18;
             #dsmod110#25 = #dsmod110#25 + #dsm19001#65 + #dsm19001#67;
             #dsmod110#26 = #dsmod110#26 + #dsm19001#17 + #dsm19001#19 + #dsm19001#20;
             #dsmod110#26 = #dsmod110#26 + #dsm19001#66 + #dsm19001#68 + #dsm19001#69;
         |FINSI;
     |FINSI;

     |SI #dsmom073#4 = 5;
         |SI #dsm19001#16 ! 0;  |O #dsm19001#17 ! 0;
          |O #dsm19001#65 ! 0;  |O #dsm19001#66 ! 0;
             #dsmod110#31 = #dsmod110#31 + 1;
             #dsmod110#32 = #dsmod110#32 + #dsm19001#16;
             #dsmod110#32 = #dsmod110#32 + #dsm19001#65;
             #dsmod110#33 = #dsmod110#33 + #dsm19001#17;
             #dsmod110#33 = #dsmod110#33 + #dsm19001#66;
         |FINSI;

         |SI #dsm19001#18 ! 0;  |O #dsm19001#19 ! 0;  |O #dsm19001#20 ! 0;
          |O #dsm19001#67 ! 0;  |O #dsm19001#68 ! 0;  |O #dsm19001#69 ! 0;
             #dsmod110#34 = #dsmod110#34 + 1;
             #dsmod110#35 = #dsmod110#35 + #dsm19001#18;
             #dsmod110#35 = #dsmod110#35 + #dsm19001#67;
             #dsmod110#36 = #dsmod110#36 + #dsm19001#19 + #dsm19001#20;
             #dsmod110#36 = #dsmod110#36 + #dsm19001#68 + #dsm19001#69;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm19001;
     #dsm19001#1;
     ;
     #dsmod110#0, #dsmod110#1, 99, 190, 00, 0, "            ", 0000, " ", "  ", 0;
     #dsmod110#0, #dsmod110#1, 99, 190, 00, 0, "zzzzzzzzzzzz", 9999, "z", "zz", 9;
     ;
     NULL, dsm19001;
|FIN;

|PROCESO dsmod110;
     #dsmod110#7  = #dsmod110#7  - #dsmod110@#7;
     #dsmod110#8  = #dsmod110#8  - #dsmod110@#8;
     #dsmod110#10 = #dsmod110#10 - #dsmod110@#10;
     #dsmod110#11 = #dsmod110#11 - #dsmod110@#11;

     #dsmod110#13 = #dsmod110#13 - #dsmod110@#13;
     #dsmod110#14 = #dsmod110#14 - #dsmod110@#14;
     #dsmod110#16 = #dsmod110#16 - #dsmod110@#16;
     #dsmod110#17 = #dsmod110#17 - #dsmod110@#17;

     #dsmod110#19 = #dsmod110#19 - #dsmod110@#19;
     #dsmod110#20 = #dsmod110#20 - #dsmod110@#20;
     #dsmod110#22 = #dsmod110#22 - #dsmod110@#22;
     #dsmod110#23 = #dsmod110#23 - #dsmod110@#23;

     #dsmod110#25 = #dsmod110#25 - #dsmod110@#25;
     #dsmod110#26 = #dsmod110#26 - #dsmod110@#26;

     #dsmod110#32 = #dsmod110#32 - #dsmod110@#32;
     #dsmod110#33 = #dsmod110#33 - #dsmod110@#32;
     #dsmod110#35 = #dsmod110#35 - #dsmod110@#32;
     #dsmod110#36 = #dsmod110#36 - #dsmod110@#32;
|FPRC;

|DEFBUCLE dsmod110;
     #dsmod110@#1006;
     ;
     #dsmod110#0, #dsmod110#1, 01, 110, 00, 00;
     #dsmod110#0, #dsmod110#1, 11, 110, 99, 99;
     ;
     NULL, dsmod110;
|FIN;

|PROCESO SacaPantallas110;
     enEntrada = 1;
     |PUSHV 0401 2380;

     |ABRE #dsmod110;
     #dsmod110#0 = enEmpresa;
     #dsmod110#1 = enEjer;
     #dsmod110#2 = enPeriodo;
     #dsmod110#3 = enModelo;
     #dsmod110#4 = enComplem;
     #dsmod110#5 = enActividad;
     |LEE 101#dsmod110.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmod110;
         #dsmod110#0 = enEmpresa;
         #dsmod110#1 = enEjer;
         #dsmod110#2 = enPeriodo;
         #dsmod110#3 = enModelo;
         #dsmod110#4 = enComplem;
         #dsmod110#5 = enActividad;
         |GRABA 020#dsmod110.b;
     |FINSI;

     |SI enPeriodo = 12;
         |CONFI "0000NDesea Regularizacion de los Periodos Anteriores con el Modelo 190.";
         |SI FSalida = 0;
             |PDEFECTO #dsmod110, 6, 30;
             |ABRE #dsmom073;

             |SI #dsmod110#1 [ 2015;
                 |BUCLE dsm190li;
             |FINSI;

             |SI #dsmod110#1 [ 2015;
                 |BUCLE dsm19001;
             |FINSI;

             |CIERRA #dsmom073;

             |DBASE aBase;  |QBT aBase;
             aDef = aBase + "def/dsmod110.mas";
             |CARGA_DEF aDef, dsmod110@;
             |SI FSalida ! 0;
                 aAlfa = "     Error en cargar el Def dsmod110";
                 |MENAV aAlfa;
             |SINO;
                 |BUCLE dsmod110;
             |FINSI;
             |DESCARGA_DEF #dsmod110@;
         |FINSI;
     |FINSI;

     |PINPA #0#dsmod110;
     |PINDA #0#dsmod110;

     |ENDATOS #2#dsmod110;
     |SI FSalida = 0; |Y #dsmod110#29 ! 0;
         |GRABA 020#dsmod110.a;
     |SINO;
        |CONFI "0000NEl Importe es igual a Cero, desea Impreso SIN Actividad ";
        |SI FSalida = 0;
            |GRABA 020#dsmod110.a;
        |SINO;
            enEntrada = 0;
            |BORRA 020#dsmod110.a;
        |FINSI;
     |FINSI;

     |LIBERA #dsmod110;
     |CIERRA #dsmod110;
     |POPV;
|FPRC;

|PROGRAMA;
     |HAZ PatronM073;

     enEjerIRPF = enEjer;
     |HAZ BuscaEjerIRPF;

     eaNomDef  = "dsmod110";

|| \\\\\\ Consulta del Modelo ////////

     |SI enTipoEntrada = 4;              || Consulta del Modelo
         |CABEZA "Modelo 0";
         |SI enComplem = 0;
              |HAZ SacaPantallas;
         |SINO;
             |ABRE #dsmod110;
             #dsmod110#0 = enEmpresa;
             #dsmod110#1 = enEjer;
             #dsmod110#2 = enPeriodo;
             #dsmod110#3 = enModelo;
             #dsmod110#4 = enComplem;
             #dsmod110#5 = enActividad;
             |LEE 101#dsmod110.=;
             |SI FSalida ! 0;  |ACABA;  |FINSI;
             |PINPA #0#dsmod110;
             |PINDA #0#dsmod110;
             |ENDATOS #1#dsmod110;
             |SI FSalida = 0;
                 |GRABA 020#dsmod110.a;
             |FINSI;
             |LIBERA #dsmod110;
             |CIERRA #dsmod110;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI enTipoEntrada = 1;              || Alta del Modelo
          |CABEZA "Modelo 110";
          |HAZ SacaPantallas110;
          enResultado = #dsmod110#29;
          |ACABA;
     |FINSI;

|| \\\\\\ Comprobacion Existencia del Modelo

     |SI enTipoEntrada = 99;              || Existencia del Modelo ????
         |ABRE #dsmod110;
         #dsmod110#0 = enEmpresa;
         #dsmod110#1 = enEjer;
         #dsmod110#2 = enPeriodo;
         #dsmod110#3 = enModelo;
         #dsmod110#4 = enComplem;
         #dsmod110#5 = enActividad;
         |LEE 040#dsmod110.=;
         |SI FSalida ! 0;  enExistencia = 1;  |DDEFECTO #dsmod110; |FINSI;
         |CIERRA #dsmod110;

         |SI enActividad = 0;  enResultado = #dsmod110#29;  |FINSI;
     |FINSI;
|FPRO;
