|FICHEROS;
     dsmom004;
     dsmom005;
     dsmom006;
     dsmom008;

     dsmo3401;

     &program@;

     &haciend@;
     :/basica/def/agihacie;
     :/integral/def/dsam0102;

     &regisnif@;
     :/basica/def/agim0003;
     :/integral/def/dsam0103;

     &clientes@;
     :/basica/def/agifigen;
     :/integral/def/dsam0000;

     &datosper@;
     :/integral/def/dsam0003;

     &bancosc@;
     :/basica/def/agibanco;
     :/integral/def/dsam0116;
|FIN;

|VARIABLES;
     &aPrograma     = "";
     aPathModelo    = "";
     aDef           = "";
     aAlfa          = "";
     aAlfa1         = "";
     aEscape        = "";
     aAvance        = "";
     aRetroceso     = "";
     aQueQuiero     = "";
     aNumPanta      = "";
     aLong          = "";
     aCampo         = "";
     aBase          = "";
     aParametro     = "";

     nPanta         = 0;
     nNumPanta      = 0;
     nLong          = 0;
     nPosi          = 0;
     nConta         = 0;
     nCampo         = 0;
     nContador      = 0;
     nSinDatos      = 0;
     nCanal         = 0;
     nActivi        = 0;
     nRegulacion    = 0;
     nCNif          = 0;
  {1}aContiene       = "";

     &eaUnidadBasico = "";
     &eaUnidadBTmp   = "";

     &enSw = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO PintaPantalla;
     |SI nPanta < 0;   nPanta = 0;                   |FINSI;
     |SI nPanta = 0;   |PINPA #00#program@;  |PINDA #00#program@;  |FINSI;
     |SI nPanta = 1;   |PINPA #01#program@;  |PINDA #01#program@;  |FINSI;
     |SI nPanta = 2;   |PINPA #02#program@;  |PINDA #02#program@;  |FINSI;
     |SI nPanta = 3;   |PINPA #03#program@;  |PINDA #03#program@;  |FINSI;
     |SI nPanta = 4;   |PINPA #04#program@;  |PINDA #04#program@;  |FINSI;
     |SI nPanta = 5;   |PINPA #05#program@;  |PINDA #05#program@;  |FINSI;
     |SI nPanta = 6;   |PINPA #06#program@;  |PINDA #06#program@;  |FINSI;
     |SI nPanta = 7;   |PINPA #07#program@;  |PINDA #07#program@;  |FINSI;
     |SI nPanta = 8;   |PINPA #08#program@;  |PINDA #08#program@;  |FINSI;
     |SI nPanta = 9;   |PINPA #09#program@;  |PINDA #09#program@;  |FINSI;
     |SI nPanta = 10;  |PINPA #10#program@;  |PINDA #10#program@;  |FINSI;
     |SI nPanta = 11;  |PINPA #11#program@;  |PINDA #11#program@;  |FINSI;
     |SI nPanta = 12;  |PINPA #12#program@;  |PINDA #12#program@;  |FINSI;
     |SI nPanta = 13;  |PINPA #13#program@;  |PINDA #13#program@;  |FINSI;
     |SI nPanta = 14;  |PINPA #14#program@;  |PINDA #14#program@;  |FINSI;
|FPRC;

|PROCESO NoVisual;
     |QBF eaNoVisu;
     |SI eaNoVisu ! "";
         aLong = eaNoVisu % 0;
         nLong = aLong;
         |PARA nConta = 1;  |SI nConta [ nLong;  |HACIENDO nConta = nConta + 3;
               nPosi  = (nConta * 100) + 3
               aCampo = eaNoVisu % nPosi;
               nCampo = aCampo;

               |C_V #program@#nCampo#, 1, "N";
               |C_M #program@#nCampo#, 1, "N";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO PintaDatos;
     enCodCli = enEmpresa;
     |HAZ LeePersona;

     aAlfa    = (("00000" + enEmpresa) % -105) + " " + #clientes@#2;
     |SI enActividad = 0;
         aAlfa = aAlfa + " EMISION";
     |SINO;
         aAlfa = aAlfa + " Actividad: " + enActividad;
     |FINSI;
     aAlfa = aAlfa + " Periodo: " + enPeriodo + " / " + enEjer;

     |ATRI I;
     |PINTA 2401, aAlfa;
     |ATRI i;
|FPRC;

|PROCESO SacaPantallas;
     |DBASE aPathModelo;  |QBT aPathModelo;
     aDef = aPathModelo + "def/" + eaNomDef + ".mas";
     |CARGA_DEF aDef, program@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + eaNomDef;
         |MENAV aAlfa;
         |ERROR;
     |FINSI;

     aQueQuiero = "|NP";
     aNumPanta  = #program@#aQueQuiero#;
     nNumPanta  = aNumPanta;
     nNumPanta  = nNumPanta - 1;

     aEscape    = &255 + "806";
     aAvance    = &255 + "815";
     aRetroceso = &255 + "814";

     |SI nNumPanta ] 1;
         |MENSA "0000 Av.Pag Pant.Siguiente. Re.Pag Pant.Anterior. ESC Salir.";
     |SINO;
         |MENSA "      ESC Salir.";
     |FINSI;

     |ABRE #program@;
     #program@#0 = enEmpresa;
     #program@#1 = enEjer;
     #program@#2 = enPeriodo;
     #program@#3 = enModelo;
     #program@#4 = enComplem;
     #program@#5 = enActividad;
     |LEE 000#program@.=;
     |SI FSalida ! 0;
         |MENAV "     No existe Registro.";
         |CIERRA #program@;
         |DESCARGA_DEF #program@;
         |ACABA;
     |FINSI;
     |CIERRA #program@;

     |SI enActividad ! 0;  |HAZ NoVisual;  |FINSI;

     |PUSHV 0401 2380;
     |PINPA #0#program@;
     |PINDA #0#program@;

     |HAZ PintaDatos;

     nPanta = 0;
     |PARA;  |SI;  |HACIENDO;
          |LEETECLA aAlfa;
          |SI aAlfa = aEscape;  |SAL;  |FINSI;
          |SI aAlfa = aAvance;
              |SI nPanta < nNumPanta;
                  nPanta = nPanta + 1;
                  |HAZ PintaPantalla;
             |FINSI;
          |FINSI;

          |SI aAlfa = aRetroceso;
              |SI nPanta [ nNumPanta;
                  nPanta = nPanta - 1;
                  |HAZ PintaPantalla;
              |FINSI;
          |FINSI;
     |SIGUE;
     |POPV;

     |DESCARGA_DEF #program@;
|FPRC;


|PROCESO UltimoPeriodo;
     |ABRE #dsmom005;
     |ABRE #dsmom006;
     #dsmom006#0 = enEmpresa;
     #dsmom006#1 = enModelo;
     |LEE 040#dsmom006.=;
     |SI FSalida = 0;
         eaUltimoPer = #dsmom006#12;
     |SINO;
         #dsmom005#0 = enModelo;
         |LEE 040#dsmom005.=;
         |SI FSalida ! 0;  |DDEFECTO #dsmom005;  |FINSI;

         eaUltimoPer = #dsmom005#11;
     |FINSI;
     |CIERRA #dsmom005;
     |CIERRA #dsmom006;
|FPRC;

|PROCESO EntraModelo;
     enEntrada = 0;
     aParametro = ("00000" + #dsmom008#0) % -105;
     aParametro = aParametro + ("0000" + #dsmom008#1) % -104;
     aParametro = aParametro + ("00" + #dsmom008#2) % -102;
     aParametro = aParametro + ("000" + #dsmom008#3) % -103;
     aParametro = aParametro + ("00" + #dsmom008#4) % -102;
     aParametro = aParametro + ("00" + #dsmom008#5) % -102;
     aParametro = aParametro + ("00" + enTipoEntrada) % -102;
     aParametro = aParametro + ("0" + enExistencia) % -101;

     |SI #dsmom008#12 = 110;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod110";  |FINSI;

         |SI enActividad ! 0;
             |SI enEjer [ 2010;  |SUB_EJECUTA_NP "dsmoc110";  |FINSI;

             |SI enEjer ] 2011;  |Y enEjer [ 2015;
                 |SUB_EJECUTA_NP "dsmoc111";
             |FINSI;

             |SI enEjer ] 2016; |SUB_EJECUTA_NP "dsm11101";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 115;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod115";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc115";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 123;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod123";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc123";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 216;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod216";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc216";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 300;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod300";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmociva";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 303;
         |SI enActividad = 0;
             |SI #dsmom008#1 [ 2013;
                  |SUB_EJECUTA_NP "dsmod303";
             |FINSI;

             |SI #dsmom008#1 ] 2014;
                 aAlfa = "|:modelos/dsm30301;" + aParametro;
                 |SI enTipoEntrada = 99;
                     aAlfa = "dsm30301;" + aParametro;
                 |FINSI;
                 |SUB_EJECUTA_NP aAlfa;
             |FINSI;
         |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmociva";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 320;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod320";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmociva";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 322;
         |SI enActividad = 0;
             aAlfa = "|:modelos/dsm32201;" + aParametro;
             |SI enTipoEntrada = 99;
                 aAlfa = "dsm32201;" + aParametro;
             |FINSI;
             |SUB_EJECUTA_NP aAlfa;
         |FINSI;

         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc322";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 330;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod330";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmociva";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 332;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod332";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmociva";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 353;
         aAlfa = "|:modelos/dsm35301;" + aParametro;
         |SUB_EJECUTA_NP aAlfa;
     |FINSI;

     |SI #dsmom008#12 = 130;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod130";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc130";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 310;
         |SI enActividad = 0;
             |SI #dsmom008#1 [ 2013;
                  |SUB_EJECUTA_NP "dsmod310";
             |FINSI;

             |SI #dsmom008#1 ] 2014;
                 aAlfa = "|:modelos/dsm30301;" + aParametro;
                 |SI enTipoEntrada = 99;
                     aAlfa = "dsm30301;" + aParametro;
                 |FINSI;
                 |SUB_EJECUTA_NP aAlfa;
             |FINSI;
         |FINSI;

         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc310";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 131;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod131";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc131";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 370;
         |SI enActividad = 0;
             |SI #dsmom008#1 [ 2013;
                  |SUB_EJECUTA_NP "dsmod370";
             |FINSI;

             |SI #dsmom008#1 ] 2014;
                 aAlfa = "|:modelos/dsm30301;" + aParametro;
                 |SI enTipoEntrada = 99;
                     aAlfa = "dsm30301;" + aParametro;
                 |FINSI;
                 |SUB_EJECUTA_NP aAlfa;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 349;
         enModelo349 = 349;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmod349";  |FINSI;
         |SI enActividad ! 0; |SUB_EJECUTA_NP "dsmoc349";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 340;
         aAlfa = "|:modelos/dsmo3401;";
         aAlfa = aAlfa + (("00000" + enEmpresa) % -105);
         aAlfa = aAlfa + (("0000" + enEjer) % -104);
         aAlfa = aAlfa + (("00" + enPeriodo) % -102);
         aAlfa = aAlfa + (("000" + enModelo) % -103);
         aAlfa = aAlfa + (("00" + enComplem) % -102);
         aAlfa = aAlfa + (("00" + enActividad) % -102);
         aAlfa = aAlfa + (("00" + enTipoEntrada) % -102);
         aAlfa = aAlfa +  enMensa;

         |SUB_EJECUTA_NP aAlfa;

         enEntrada = 1;

         |ABRE #dsmo3401;
         #dsmo3401#0 = enEmpresa;
         #dsmo3401#1 = enEjer;
         #dsmo3401#2 = enPeriodo;
         #dsmo3401#3 = enModelo;
         #dsmo3401#4 = enComplem;
         #dsmo3401#5 = enActividad;
         |LEE 040#dsmo3401.=;
         |SI FSalida ! 0;  enEntrada = 0;  |FINSI;

         #dsmo3401#0 = enEmpresa;
         #dsmo3401#1 = enEjer;
         #dsmo3401#2 = enPeriodo;
         #dsmo3401#3 = enModelo;
         #dsmo3401#4 = enComplem;
         #dsmo3401#5 = 0;
         |LEE 040#dsmo3401.=;
         |SI FSalida = 0;  enEntrada = 1;  |FINSI;
         |CIERRA #dsmo3401;
     |FINSI;

     |SI #dsmom008#12 = 347;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsmo1347";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 180;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm180ca";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 184;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm18401";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 187;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm187ca";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 190;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm190ca";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 193;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm193ca";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 296;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm296ca";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 390;
         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm39001";  |FINSI;
     |FINSI;

     |SI #dsmom008#12 = 392;
         |SI enEjer ] 2009;
             |MENAV "0000Modelo desactivado a partir del ejercicio 2009";
             |ACABA;
         |FINSI;

         |SI enActividad = 0; |SUB_EJECUTA_NP "dsm39201";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO ChequeaSitua;
     enActividad   = #dsmom008#5;
     enTipoEntrada = 99;
     enExistencia  = 0;

     |SI #dsmom008#5 ! 0;  |Y #dsmom008#5 ! 99;
         nContador = nContador + 1;
     |FINSI;

     |SI #dsmom008#3 = 340;
         |ABRE #dsmo3401;
         #dsmo3401#0 = enEmpresa;
         #dsmo3401#1 = enEjer;
         #dsmo3401#2 = enPeriodo;
         #dsmo3401#3 = enModelo;
         #dsmo3401#4 = enComplem;
         #dsmo3401#5 = enActividad;
         |LEE 040#dsmo3401.=;
         |SI FSalida ! 0;  enExistencia = 1;  |FINSI;
         |CIERRA #dsmo3401;

         |SI enActividad = 0;
             nContador = nContador + 1;
             enResultado = 0;
             |SI enExistencia = 0;
                 nSinDatos = nSinDatos + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmom008#3 ! 340;
         |HAZ EntraModelo;
     |FINSI;

     |SI #dsmom008#5  = 0;    |ACABA;  |FINSI;
     |SI #dsmom008#12 = 370;  |ACABA;  |FINSI;

     |SI enExistencia = 0;
         |SI #dsmom008#5 = 99;
             nRegulacion = 1;
             |ACABA;
         |FINSI;

         nSinDatos = nSinDatos + 1;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom008;
     #dsmom008#1;
     ;
     #dsmom004#0, #dsmom004#1, #dsmom004#2, #dsmom004#3, #dsmom004#4, 00;
     #dsmom004#0, #dsmom004#1, #dsmom004#2, #dsmom004#3, #dsmom004#4, 99;
     ;
     NULL, ChequeaSitua;
|FIN;

|PROCESO ChequeaSituacion;
     |MENSA "      Recalculando Planing";

     enExistencia = 0;
     nSinDatos    = 0;
     nContador    = 0;
     nRegulacion  = 0;
     enResultado  = 0;
     nActivi      = enActividad;

     |BUCLE dsmom008;

     enActividad  = nActivi;

     |SI nSinDatos = 0;  |Y nRegulacion = 0;
         #dsmom004#17 = "SIN DATOS";
         #dsmom004#7  = " ";
         #dsmom004#9  = " ";
         #dsmom004#11 = " ";
     |FINSI;

     |SI nRegulacion = 1;
         #dsmom004#17 = "PARCIALES";
         #dsmom004#7  = "X";
     |FINSI;

     |SI nSinDatos ! 0;  |Y nSinDatos ! nContador;
         #dsmom004#17 = "PARCIALES";
         #dsmom004#7  = "X";
     |FINSI;

     |SI nSinDatos = nContador;  |Y nSinDatos ! 0;
         #dsmom004#7  = "X";
         #dsmom004#8  = ~;
         #dsmom004#17 = "COMPLETADO";
     |FINSI;

     #dsmom004#15 = enResultado;
     #dsmom004#16 = eaUltimoPer;
|FPRC;

|PROCESO LeePersona;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
          enSwDeDonde = 1;
          |REFERENCIA_DEF clientes@, #dsam0000;
          |REFERENCIA_DEF datosper@, #dsam0003;
          nCNif = 3;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF clientes@,  #agifigen;
         |REFERENCIA_DEF datosper@,  #agifigen;
          nCNif = 13;
     |FINSI;

     |ABRE #clientes@;
     #clientes@#0 = enCodCli;
     |LEE 040#clientes@.=;
     |SI FSalida ! 0; |DDEFECTO #clientes@; |FINSI;
     |CIERRA #clientes@;
     eaCliNif = #clientes@#nCNif#;

     |ABRE #datosper@;
     #datosper@#0 = enCodCli;
     |LEE 040#datosper@.=;
     |SI FSalida ! 0; |DDEFECTO #datosper@; |FINSI;
     |CIERRA #datosper@;
|FPRC;

|PROCESO LeeHacienda;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         |REFERENCIA_DEF haciend@, #dsam0102;
     |SINO;
         |REFERENCIA_DEF haciend@,  #agihacie;
     |FINSI;

     |ABRE #haciend@;
     #haciend@#0 = enCodDeleg;
     #haciend@#1 = enCodAdmin;
     |LEE 040#haciend@.=;
     |SI FSalida ! 0; |DDEFECTO #haciend@; |FINSI;
     |CIERRA #haciend@;
|FPRC;

|PROCESO LeeNifs;
     eswNif = 0;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF regisnif@, #dsam0103;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF regisnif@, #agim0003;
     |FINSI;

     |ABRE #regisnif@;
     #regisnif@#0 = eaCodNif;
     |LEE 040#regisnif@.=;
     |SI FSalida ! 0; |DDEFECTO #regisnif@; eswNif = 1; |FINSI;
     eaNomNif = #regisnif@#1;
     |CIERRA #regisnif@;
|FPRC;

|PROCESO LeeBancoCliente;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
          enSwDeDonde = 1;
          |REFERENCIA_DEF bancosc@, #dsam0116;
     |SINO;
          enSwDeDonde = 0;
          |REFERENCIA_DEF bancosc@, #agibanco;
     |FINSI;

     |ABRE #bancosc@;
     #bancosc@#0 = enCodBanco;
     |LEE 040#bancosc@.=;
     |SI FSalida ! 0; |DDEFECTO #bancosc@; |FINSI;
     |CIERRA #bancosc@;
|FPRC;

|PROCESO ModoRelacion;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         ||Desactivado

         |MODO_RELACION #program@, 1, "agihacie", "N", "N";
         |MODO_RELACION #program@, 1, "agim0003", "N", "N";
         |MODO_RELACION #program@, 1, "agibanco", "N", "N";
         |MODO_RELACION #program@, 1, "agim0016", "N", "N";

         |MODO_RELACION #program@, 1, "agihacie", "X", "X";
         |MODO_RELACION #program@, 1, "agim0003", "X", "X";
         |MODO_RELACION #program@, 1, "agibanco", "X", "X";
         |MODO_RELACION #program@, 1, "agim0016", "X", "X";

         || Activado

         |MODO_RELACION #program@, 0, "dsam0102", "X", "X";
         |MODO_RELACION #program@, 0, "dsam0103", "X", "X";
         |MODO_RELACION #program@, 0, "dsam0116", "X", "X";
         |MODO_RELACION #program@, 0, "dsam0104", "X", "X";

         |MODO_RELACION #program@, 1, "dsam0102", "S", "S";
         |MODO_RELACION #program@, 1, "dsam0116", "S", "S";
         |MODO_RELACION #program@, 1, "dsam0104", "N", "N";

         |SI aPrograma = "dsmoy020"; |O aPrograma = "dsmoy021"; |O aPrograma = "dsmoy027";
             |O aPrograma = "dsmoy080"; |O aPrograma = "dsmoz066";
               |O aPrograma = "dsmoy087"; |O aPrograma = "dsmoy088";
             |MODO_RELACION #program@, 1, "dsam0103", "N", "N";
         |SINO;
             |MODO_RELACION #program@, 1, "dsam0103", "S", "S";
         |FINSI;

         |REFERENCIA_DEF haciend@, #dsam0102;
         |REFERENCIA_DEF haciend@, #dsam0102;
         |REFERENCIA_DEF haciend@, #dsam0102;
         |REFERENCIA_DEF haciend@, #dsam0102;
         |REFERENCIA_DEF haciend@, #dsam0102;
         |REFERENCIA_DEF regisnif@, #dsam0103;
         |REFERENCIA_DEF bancosc@, #dsam0116;
     |SINO;
         |MODO_RELACION #program@, 1, "dsam0102", "N", "N";
         |MODO_RELACION #program@, 1, "dsam0103", "N", "N";
         |MODO_RELACION #program@, 1, "dsam0116", "N", "N";
         |MODO_RELACION #program@, 1, "dsam0104", "N", "N";

         |MODO_RELACION #program@, 1, "dsam0102", "X", "X";
         |MODO_RELACION #program@, 1, "dsam0103", "X", "X";
         |MODO_RELACION #program@, 1, "dsam0116", "X", "X";
         |MODO_RELACION #program@, 1, "dsam0104", "X", "X";

         |MODO_RELACION #program@, 0, "agihacie", "X", "X";
         |MODO_RELACION #program@, 0, "agim0003", "X", "X";
         |MODO_RELACION #program@, 0, "agibanco", "X", "X";
         |MODO_RELACION #program@, 0, "agim0016", "X", "X";

         |MODO_RELACION #program@, 1, "agihacie", "S", "S";
         |MODO_RELACION #program@, 1, "agibanco", "S", "S";
         |MODO_RELACION #program@, 1, "agim0016", "N", "N";

         |SI aPrograma = "dsmoy020"; |O aPrograma = "dsmoy021"; |O aPrograma = "dsmoy027";
             |O aPrograma = "dsmoy080"; |O aPrograma = "dsmoz066";
                |O aPrograma = "dsmoy087"; |O aPrograma = "dsmoy088";
             |MODO_RELACION #program@, 1, "agim0003", "N", "N";
         |SINO;
             |MODO_RELACION #program@, 1, "agim0003", "S", "S";
         |FINSI;

         |REFERENCIA_DEF haciend@, #agihacie;
         |REFERENCIA_DEF regisnif@, #agim0003;
         |REFERENCIA_DEF bancosc@, #agibanco;
     |FINSI;
|FPRC;
