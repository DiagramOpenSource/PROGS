|FICHEROS;
    dsmoz038,MANTE;
    dsmow035,MANTE;  || Temporal de Fra. de Inversion

    dsmow034;

   :/contagen/def/canempre;
   :/contagen/def/camaniva;
   :/contagen/def/caivalin;
   :/contagen/def/camaasic;
   :/contagen/def/calibros;
|FIN;

|VARIABLES;
   &aCamp1 = "";
   &nCamp2 = 0;
   &fCamp3 = @;
   &nCamp4 = 0;
   &nCamp5 = 0;
   &aCamp6 = "";
   &nCamp7 = 0;
   &aCamp8 = "";
   &nCamp9 = 0;
   &nCamp10 = 0;

   &aCamp41_8  = "";
   &nCamp41_43 = 0;
   &nCamp41_46 = 0;
   &aCamp41_47 = "";
   &aCamp41_48 = "";
   &aCamp41_49 = "";
   &aCamp41_53 = "";
   &aCamp41_50 = "";
   &nCamp41_51 = 0;
   &nCamp41_52 = 0;
   &nCamp41_67 = 0;

  aFichero    = "";
  fecalf      = "";
  nDEmpresa   = 0;
  nHEmpresa   = 0;
  nDActividad = 0;
  nHActividad = 0;
  nExiste     = 0;
  nModifica   = 0;
  nRecoge     = 0;

  aAlfa  = "";
  aAlfa1 = "";
  aAlfa2 = "";
  nNume1 = 0;
  nPara1 = 0;

  nSwElem = 0;
  &errconta = 0;
  nInkey = 0;
  nElAny = 0;

  aPath  = "";
  fecsys = @;
  nDepar = 0;
  &aComVen = "";
  &aRepSop = "";

  &enSwBien = 0;

  nLibro    = 0;
  aSerie    = "";
  nRegis    = 0;
  nDocum    = 0;
  nLinea    = 0;
  nElModo   = 0;
  nSwEste   = 0;
  swpaso    = 0;
  nElnumero = 0;
  nNoBusco  = 0;
  fDFecha   = @;
  fHFecha   = @;
  nBueno    = 0;
  nSwAlgun  = 0;
  aParam    = "";

  aDeducible = "";
  nImporte   = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;
|| ----------------------------------------------------------------------
|PROCESO BuscaPeriodo;
   nBueno = 0;
   |SI #canempre#11 = 1;
       |SI #canempre#26 = nElAny;
           nBueno = 1;
       |FINSI;
   |SINO;
        |HAZ LaFecha;
        |SI fHFecha ] fec1; |Y fDFecha [ fec2;
            nBueno = 1;
        |FINSI;
   |FINSI;
   |SI nBueno = 0; |ACABA; |FINSI;
   nNume1     = #canempre#3 + 15;
   #dsmoz038#nNume1# = 1;
   nSwAlgun   = 1;
|FPRC;

|DEFBUCLE BuscaPeriodo;
   #canempre#1;
   ;
   enEmpresa, 0;
   enEmpresa, 9;
   ;
   NULL, BuscaPeriodo;
|FIN;

|| ////////////////////////////////
|PROCESO CargoVariables;
   nCamp10 = #dsmow035#2;
   fCamp3  = #dsmow035#17;
   nCamp4  = #dsmow035#26;
   nCamp5  = #dsmow035#15;
   aCamp6  = #dsmow035#16;
   |SI aRepSop = "S";
       aCamp41_8  = #dsmow035#10;
       nCamp41_43 = #dsmow035#12;
       nCamp41_46 = #dsmow035#19;

       aCamp41_47 = #dsmow035#20;
       aCamp41_48 = #dsmow035#21;
       aCamp41_49 = #dsmow035#14;
       aCamp41_53 = #dsmow035#23;
       |SI #dsmow035#24 ! "S";
           nCamp41_43 = 0;
           nCamp41_46 = 0;
       |FINSI;
   |SINO;
       aCamp41_50 = #dsmow035#14;
       nCamp41_67 = #dsmow035#11;
       nCamp41_51 = #dsmow035#19;
       nCamp41_52 = #dsmow035#12;
   |FINSI;
|FPRC;
|| ////////////////////////////////

|PROCESO BuscolaFactura;
 |SI nElnumero = 0;
     nLibro    = #dsmow035#1;
     nElnumero = #dsmow035#2;
     nLinea    = #dsmow035#6;
 |FINSI;
 |SI #dsmow035#26 = nCamp4;
     nLibro    = #dsmow035#1;
     nElnumero = #dsmow035#2;
     nLinea    = #dsmow035#6;
 |FINSI;
 |SI aComVen = "C";
     |SI #dsmoz038#27 = #dsmow035#20;
         nLibro    = #dsmow035#1;
         nElnumero = #dsmow035#2;
         nLinea    = #dsmow035#6;
         nSwEste = 3;
         |ERROR10;
     |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE BuscolaFactura;
 #dsmow035#1;
 17,7,26;
 #dsmoz038#0, 01, 00000000001, 01, #dsmoz038#6, #dsmoz038#13, #dsmoz038#7;
 #dsmoz038#0, 99, 99999999999, 99, #dsmoz038#6, #dsmoz038#13, #dsmoz038#7;
 ;
 NULL, BuscolaFactura;
|FIN;


|| ----------------------------------------------------------------------
|PROCESO LecturaW035;
 nExiste = 0;
 |ABRE #dsmow035;
 |DDEFECTO #dsmow035;
 |SELECT #2#dsmow035;
 #dsmow035#0 = #dsmoz038#0;  || Empresa
 #dsmow035#1 = #dsmoz038#10; || Libro
 #dsmow035#3 = #dsmoz038#11; || Serie
 #dsmow035#4 = #dsmoz038#12; || Factura
 #dsmow035#6 = #dsmoz038#25; || linea
 |LEE 001#dsmow035.=;
 |SI FSalida ! 0;
     nExiste = 1;
 |SINO;
     nElnumero = #dsmow035#2;
     nLinea    = #dsmow035#6;
 |FINSI;
 |SELECT #1#dsmow035;
 |CIERRA #dsmow035;
|FPRC;

|| ----------------------------------------------------------------------
|PROGRAMA;

  aParam = PARAMETRO; |QBF aParam;
  |SI aComVen = "C";  aRepSop = "S"; |FINSI;
  |SI aComVen = "V";  aRepSop = "R"; |FINSI;

  nNoBusco = 0;
  |SI enSwBien = -1; nNoBusco = 1; |FINSI;

  enSwBien = 0;

  nDActividad = 01;
  nHActividad = 99;
  aAlfa1      = enEjer;     |QBF aAlfa1;
      aAlfa2  = "01.01." + aAlfa1; fDFecha = aAlfa2;
      aAlfa2  = "31.12." + aAlfa1; fHFecha = aAlfa2;
  aAlfa1      = aAlfa1 % -102;
  nElAny      = aAlfa1;

  nSwAlgun = 0;
  |PDEFECTO #dsmoz038, 15, 25;
  |BUCLE BuscaPeriodo;
  |SI nSwAlgun = 0;
      aAlfa1 = "Compra";
      |SI aComVen = "V";  aAlfa1 = "Venta"; |FINSI;
      aAlfa1 = "    No existe Contabilidad del A¤o de la " + aAlfa1;
      |SI aParam = ""; |MENAV aAlfa1; |FINSI;
      |ACABA;
  |FINSI;

|| .................. Graba Fichero Auxiliar de Amortizaciones
  aFichero = ("38z" + Usuario) % 108;
  |NOME_DAT #dsmoz038#aFichero#;
  |DELINDEX #dsmoz038;

  |HAZ Graba997;
  |SI nSwElem = 0; |ACABA; |FINSI;

|| .................. Graba Fichero Auxiliar de Facturas
  aFichero = ("35w" + Usuario) % 108;
  |NOME_DAT #dsmow035#aFichero#;
  |DELINDEX #dsmow035;

  nSwElem = 0;
  |PARA nPara1 = 0; |SI nPara1 [ 9; |HACIENDO nPara1 = nPara1 + 1;
        nNume1 = nPara1 + 15;
        |SI #dsmoz038#nNume1# = 1;
            |ABRE #canempre;
            #canempre#2 = enEmpresa;
            #canempre#3 = nPara1;
            |LEE 001#canempre.=;
            |CIERRA #canempre;
            |HAZ Graba995;
       |FINSI;
  |SIGUE;

  |SI nSwElem = 0;
      |SI aParam = ""; |MENAV "    Error No existe ninguna factura de Inversion"; |FINSI;
      |ACABA;
  |FINSI;

  |SI aParam = "";
      |PINPA #0#dsmoz038;

      |ATRI P;
      |SI aComVen = "C";
          |PINTA 1152, "COMPRA";
      |SINO;
          |PINTA 1152, "VENTA";
      |FINSI;
      |ATRI 0;

      |PINDA #0#dsmoz038;
  |FINSI;

  nLibro = #dsmoz038#10;
  aSerie = #dsmoz038#11;
  nDocum = #dsmoz038#12;
  nCamp4 = #dsmoz038#7;
  nLinea = #dsmoz038#25;
  nRegis = #dsmoz038#26;
  nSwEste = 0;

|| .................... Lo leo
  nElnumero = 0;
  |HAZ LecturaW035;
  |SI nExiste = 1; |Y nNoBusco = 0;
      |BUCLE BuscolaFactura;
  |FINSI;
|| ................................
  |SI nElnumero ! 0;
      #dsmoz038#26 = nElnumero;
      #dsmoz038#10 = nLibro;
  |FINSI;

  |SI nNoBusco = 1;
      |SI nElnumero ! 0;
          |ABRE #dsmow035;
          #dsmow035#0 = enEmpresa;
          #dsmow035#1 = nLibro;
          #dsmow035#2 = nElnumero;
          #dsmow035#6 = nLinea;
          |LEE 001#dsmow035.=;
          |CIERRA #dsmow035;
          |SI aParam = "";
              |SI aRepSop ! "S";
                  |PINTA 1663, "                 ";
                  |C_V #dsmow035#24,1, "N";
              |FINSI;
              |PINDA #0#dsmow035;
              |PAUSA;
          |FINSI;
          nCamp7  = #dsmow035#1;
          aCamp8  = #dsmow035#3;
          nCamp9  = #dsmow035#4;
          nCamp10 = #dsmow035#2;
||          |HAZ CargoVariables;
      |SINO;
          |SI aParam = ""; |MENAV "    Error, No existe Factura"; |FINSI;
      |FINSI;

  |SINO;
      |ENDATOS #2#dsmoz038;
      |SI FSalida = 0;
          nCamp7  = #dsmoz038#10;
          aCamp8  = #dsmoz038#11;
          nCamp9  = #dsmoz038#12;
          nCamp10 = #dsmoz038#26;

         |HAZ LecturaW035;
         |SI nExiste = 0;
             enSwBien = 1;
             |HAZ CargoVariables;
         |FINSI;
      |SINO;
         enSwBien = 0;
      |FINSI;

   |FINSI;

  |DELINDEX #dsmoz038;
  |DELINDEX #dsmow035;
|FPRO;

|| ///////////////////////////////////////////////////////////////////
|| /////////////////////////// Procesos \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
|PROCESO CalImporteAmor;
  aDeducible = #caivalin#5;
  nImporte   = #caivalin#6;
  |SI #caivalin#5 = "N"; |Y aRepSop = "S";
      |SI #caivalin#12 = #caivalin#13;
          aDeducible = "I";
          nImporte   = #caivalin#6 + #caivalin#8; || la base + el IVA
     |SINO;
          #camaasic#0 = #camaniva#7;
          #camaasic#1 = #camaniva#8;
          #camaasic#2 = #camaniva#9;
          |LEE 001#camaasic.=;
          |SI FSalida = 0; |Y #camaasic#13 > 100;
              aDeducible = "I";
              nImporte   = #caivalin#6 + #caivalin#8; || la base + el IVA
         |FINSI;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO LeeFacturas0;
 #camaniva#0 = #caivalin#0;
 #camaniva#1 = #caivalin#1;
 |LEE 001#camaniva.=;
 |SI FSalida ! 0;   |ACABA;  |FINSI;

 |SI #camaniva#36 ! aRepSop; |ACABA; |FINSI;

 nDepar = #camaniva#10;
 |SI nDepar < nDActividad; |O nDepar > nHActividad;   |ACABA;  |FINSI;

 |SI #camaniva#4 < fDFecha; |O #camaniva#4 > fHFecha; |ACABA; |FINSI;

 |SI #caivalin#17 = "N"; |Y #camaniva#19 ] 3005.06; |ACABA; |FINSI;

 #caivalin#6  =(#caivalin#6 / enConversor) ! EURODBMOD;
 #caivalin#8  =(#caivalin#8 / enConversor) ! EURODBMOD;
 #caivalin#10 =(#caivalin#10 / enConversor) ! EURODBMOD;

 #dsmow035#0 = enEmpresa;
 #dsmow035#1 = #camaniva#0;
 #dsmow035#2 = #camaniva#1;
 #dsmow035#6 = #caivalin#2;
 |LEE 101#dsmow035.=;
 |SI FSalida ! 0;
     |DDEFECTO #dsmow035;
     #dsmow035#0 = enEmpresa;
     #dsmow035#1 = #camaniva#0;
     #dsmow035#2 = #camaniva#1;
     #dsmow035#6 = #caivalin#2;
     |GRABA 020#dsmow035.b;
 |FINSI;
 #dsmow035#3  = #camaniva#2;
 #dsmow035#17 = #camaniva#4;
 #dsmow035#4  = #camaniva#3;
 aAlfa1  = #camaniva#4; aAlfa1 = (aAlfa1 % 102) + (aAlfa1 % 402);
 #dsmow035#5  = aAlfa1;
 #dsmow035#7  = #caivalin#30;
 #dsmow035#8  = #camaniva#24;
 #dsmow035#9  = #camaniva#12;
 #dsmow035#10 = #camaniva#13;
 #dsmow035#11 = #caivalin#6;
 #dsmow035#12 = #caivalin#8;
 #dsmow035#13 = #caivalin#6 + #caivalin#8;
 #dsmow035#14 = #camaniva#22;
 #dsmow035#15 = #caivalin#3;
 #dsmow035#16 = #caivalin#4;
 #dsmow035#19 = #caivalin#7;
 #dsmow035#20 = #camaniva#14;
 #dsmow035#21 = #camaniva#42;
 #dsmow035#27 = #caivalin#31;
 aAlfa   = (("00" + #camaniva#0) % -102) + "-" + (("0000000000" + #camaniva#1) % -110) + " / ";
 |SI #camaniva#2 ! "     ";
     aAlfa   = aAlfa + #camaniva#2 + "-" + (("000000" + #camaniva#3) % -106);
 |SINO;
     aAlfa   = aAlfa + (("000000" + #camaniva#3) % -106);
 |FINSI;
 #dsmow035#22 = aAlfa;

 #dsmow035#25 = #caivalin#12;  ||Contrapartida
 |HAZ CalImporteAmor;
 #dsmow035#26 = nImporte;     ||Importe de la Amortizacion La Base de la Compra
 #dsmow035#24 = aDeducible;   ||deducible S/N

 |DDEFECTO #calibros;
 #calibros#0 = #camaniva#0;
 |LEE 001#calibros.=;
 #dsmow035#23 = #calibros#3;

 |GRABA 020#dsmow035.a;
 |LIBERA #dsmow035;
 nSwElem = 1;
|FPRC;

|DEFBUCLE LeeFacturas;
 #caivalin#1;
 ;
 01,0000000001,01;
 99,9999999999,99;
 e;
 NULL, LeeFacturas0;
|FIN;

|PROCESO Graba995;
  aAlfa1 = #canempre#2; |QBF aAlfa1;  aAlfa1 = ("00000" + aAlfa1) % -105;
  aAlfa2 = #canempre#3; |QBF aAlfa2;  aAlfa2 = ("0" + aAlfa2) % -101;

  enEmpresa  = #canempre#2;
  enPerConta = #canempre#3;
  eaLaMonEmp = #canempre#28;
  |HAZ EnConversor;

  |DBASS aPath; |QBT aPath;
  aPathConta    = aPath + "contagen/fich/" + aAlfa1 + aAlfa2 + "/";

  |PATH_DAT #camaniva#aPathConta#;
  |PATH_DAT #caivalin#aPathConta#;
  |PATH_DAT #camaasic#aPathConta#;
  |PATH_DAT #calibros#aPathConta#;

  nSwElem = 0;
  |ABRE #dsmow035;
  |ABRE #camaniva;
  |ABRE #camaasic;
  |ABRE #calibros;
  |BUCLE LeeFacturas;
  |CIERRA #calibros;
  |CIERRA #camaasic;
  |CIERRA #camaniva;
  |CIERRA #dsmow035;
|FPRC;
||************************************************************************
|PROCESO Graba997;
   |ABRE #dsmoz038;
   nSwElem = 1;
   #dsmoz038#0 = enEmpresa;
   #dsmoz038#1 = eaElemento;
   #dsmoz038#2 = enElemeNum;

   #dsmoz038#3 = aCamp1;   || descripcion
   #dsmoz038#4 = nCamp2;   || Linea
   #dsmoz038#5 = enEjer;   || A¤o Venta
   #dsmoz038#6 = fCamp3;   || Fecha Venta
   #dsmoz038#7 = nCamp4;   || Importe Venta
   #dsmoz038#8 = nCamp5;   || Concepto
   #dsmoz038#9 = aCamp6;   || Descripcion

   #dsmoz038#10 = nCamp7;  || Libro
   #dsmoz038#11 = aCamp8;  || Serie
   #dsmoz038#12 = nCamp9;  || Factura
   #dsmoz038#26 = nCamp10;  || Registro
   #dsmoz038#13 = enActividad;  || Actividad
   #dsmoz038#14 = eaNombreAct;
   #dsmoz038#27 = aCamp41_47;
   #dsmoz038#28 = aCamp41_8;
   |GRABA 020#dsmoz038.n;
   |CIERRA #dsmoz038;
|FPRC;
||************************************************************************
|PROCESO Igualdad;

 #dsmoz038#10 = #dsmow035#1; || Libro
 #dsmoz038#11 = #dsmow035#3; || Serie
 #dsmoz038#12 = #dsmow035#4; || Factura
 #dsmoz038#25 = #dsmow035#6; || Linea
 #dsmoz038#26 = #dsmow035#2; || Registro

 #dsmoz038#7  = #dsmow035#26; || Importe
 #dsmoz038#8  = #dsmow035#15; || Concepto
 #dsmoz038#9  = #dsmow035#16; || Descripcion

 |SI aComVen = "C";
     #dsmoz038#28 = #dsmow035#10; || nombre
     #dsmoz038#27 = #dsmow035#20; ||Nif
  |FINSI;
|FPRC;

|RUTINA ClaveBaja995;
 #dsmow035#0 = enEmpresa;
 #dsmow035#1 = 01;
 #dsmow035#2 = 0000000000;
 #dsmow035#6 = 01;
 |SI FSalida = "POSICION";
     #dsmow035#1 = nLibro;
     #dsmow035#2 = nElnumero;
     #dsmow035#6 = nLinea;
 |FINSI;
|FRUT;

|RUTINA ClaveAlta995;
 #dsmow035#0 = enEmpresa;
 #dsmow035#1 = 99;
 #dsmow035#2 = 99999999999;
 #dsmow035#6 = 99;
|FRUT;

|CALCULO Verlos; |TIPO 7;

  |ENTLINEAL #1#dsmow035, -4, 7, 22, 0, ClaveBaja995, ClaveAlta995;
  |SI nElnumero ! 0; |Y swpaso = 0;
      |PTEC 824;
  |FINSI;
  swpaso = 1;
|FCAL;

|CALCULO lasfunciones; |TIPO 0;
 nInkey = FSalida;

 |SI nInkey = 11;
     |HAZ BuscaEste;
 |FINSI;

 |SI nInkey = 10;
     nRecoge = 0;
     nLibro =  #dsmoz038#10;
     aSerie =  #dsmoz038#11;
     nDocum =  #dsmoz038#12;
     |ENTLINEAL #1#dsmow035, -4, 5, 22, 0, ClaveBaja995, ClaveAlta995;
     |SI nRecoge = 1;
         |HAZ Igualdad;
     |FINSI;
     #dsmoz038#10 = nLibro;
     #dsmoz038#11 = aSerie;
     #dsmoz038#12 = nDocum;
     |PINTA #dsmoz038#10;
     |PINTA #dsmoz038#11;
     |PINTA #dsmoz038#12;
     |PINTA #dsmoz038#7;
 |FINSI;
|FCAL;

|PROCESO Comprobar;
     nModifica = 0;
     nRecoge   = 0;
     |SI #dsmow035#7 ! #dsmoz038#13;
         |MENAV "    Error. La Actividad NO es la del Elemento de Amortizacion";
         |ERROR;
         |ACABA;
     |FINSI;
     |SI #dsmow035#17 ! #dsmoz038#6;
         |MENAV "    La Factura no tiene la misma fecha.";
         |ERROR;
         |ACABA;
     |FINSI;
     |SI #dsmow035#26 ! #dsmoz038#7;
         |CONFI "    NLa Factura no tiene el mismo IMPORTE. Continuar ";
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |SINO;
             nModifica = 1;
         |FINSI;
     |FINSI;
     |SI aComVen = "C"; |Y #dsmow035#20 ! #dsmoz038#27;
         |CONFI "    NLa factura es de otro Proveedor. Continuar ";
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |SINO;
             nModifica = 1;
         |FINSI;
     |FINSI;
     nRecoge = 1;
|FPRC;

|CALCULO loleo; |TIPO 0;
 |SI #dsmoz038#10 ! 0;
     |HAZ LecturaW035;
     |SI nExiste ! 0;
         |MENAV "    Error, No existe Factura";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ Comprobar;
     |SI nRecoge = 0;
         #dsmoz038#10 = nLibro; |PINTA #dsmoz038#10;
         #dsmoz038#26 = nRegis;
         #dsmoz038#11 = aSerie; |PINTA #dsmoz038#11;
         #dsmoz038#12 = nDocum; |PINTA #dsmoz038#12;
         #dsmoz038#25 = nLinea; |PINTA #dsmoz038#25;
     |FINSI;
 |FINSI;
|FCAL;

|CALCULO LaRecoge;
 |SI FSalida = 0;
     |HAZ Comprobar;
     |SI nRecoge = 1;
         |SI nModifica = 1;
             |CONFI "0000SCambiar datos en elemento de Amortizaciones";
             |SI FSalida ! 0;
                 nRecoge = 0;
                 |ACABA;
             |FINSI;
         |FINSI;
         nLibro = #dsmow035#1;
         nRegis = #dsmow035#2;
         aSerie = #dsmow035#3;
         nDocum = #dsmow035#4;
         nLinea = #dsmow035#6;
         |PTEC 806;
     |FINSI;
 |FINSI;
|FCAL;

|| *********************************************************************
|| *********************************************************************
|PROCESO Busca1;
 |SI nSwEste = 0;
     nLibro =  #dsmow035#1;
     nRegis =  #dsmow035#2;
     aSerie =  #dsmow035#3;
     nDocum =  #dsmow035#4;
     nLinea =  #dsmow035#6;
 |FINSI;
 nSwEste = 1;
 |SI #dsmoz038#7 = #dsmow035#26; |Y #dsmoz038#6 = #dsmow035#17;
     nLibro =  #dsmow035#1;
     nRegis =  #dsmow035#2;
     aSerie =  #dsmow035#3;
     nDocum =  #dsmow035#4;
     nLinea =  #dsmow035#6;
     nSwEste = 2;
 |FINSI;
 |SI aComVen = "C";
     |SI #dsmoz038#7 = #dsmow035#26; |Y #dsmoz038#6 = #dsmow035#17; |Y #dsmoz038#27 = #dsmow035#20;
         nLibro =  #dsmow035#1;
         nRegis =  #dsmow035#2;
         aSerie =  #dsmow035#3;
         nDocum =  #dsmow035#4;
         nLinea =  #dsmow035#6;
         nSwEste = 3;
         |ERROR10;
     |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE Busca1;
 #dsmow035#1;
 17,7, 26;
 #dsmoz038#0, 00, 0000000001, 01, #dsmoz038#6, #dsmoz038#13, #dsmoz038#7;
 #dsmoz038#0, 99, 9999999999, 99, #dsmoz038#6, #dsmoz038#13, #dsmoz038#7;
 ;
 NULL, Busca1;
|FIN;

|PROCESO BuscaEste;
 |HAZ LecturaW035;
 |SI nExiste = 1;
     nLibro =  #dsmoz038#10;
     aSerie =  #dsmoz038#11;
     nDocum =  #dsmoz038#12;
     nLinea =  #dsmoz038#25;
     nRegis =  #dsmoz038#26;
     nSwEste = 0;
     |BUCLE Busca1;
     |SI nSwEste ! 0;
         #dsmoz038#10 = nLibro; |PINTA #dsmoz038#10;
         #dsmoz038#11 = aSerie; |PINTA #dsmoz038#11;
         #dsmoz038#12 = nDocum; |PINTA #dsmoz038#12;
         #dsmoz038#25 = nLinea; |PINTA #dsmoz038#25;
         #dsmoz038#26 = nRegis;
     |SINO;
         |MENAV "    No encontrada factura correspondiente ";
     |FINSI;
  |FINSI;
  nInkey = 10;
|FPRC;
