|FICHEROS;
     dsmoy015 #0;

     dsmom004 #4;
     dsmom008 #8;
     dsmom105 #105;

     dsmow038 #99;

     :/basica/def/agitab10 #110;
     :/basica/def/agitab11 #111;
     :/basica/def/agitab12 #112;
     :/basica/def/agitab13 #113;
     :/basica/def/agicen14 #114;
     :/basica/def/agitab99 #199;
     :/integral/def/dsam0012 #212;
     :/integral/def/dsam0105 #215;

     &clientes@ #715;
     referen@ #200;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nCampo1      = 0;
     nMod         = 0;
     nElModelo    = 0;
     nModelo      = 0;
     nModelo1     = 0;
     nModelo2     = 0;
     nModelo3     = 0;
     nModelo4     = 0;
     nModelo5     = 0;
     nModelo6     = 0;
     nModelo7     = 0;
     nModelo8     = 0;
     nModelo9     = 0;
     nModelo10    = 0;
     nModelo11    = 0;
     nModelo12    = 0;
     nModelo13    = 0;
     nModelo14    = 0;
     nModelo15    = 0;
     nDPer        = 0;
     nHPer        = 0;
     nDTributa    = 0;
     nHTributa    = 0;
     nDIVA        = 0;
     nHIVA        = 0;
     nWord        = 0;
     nEmpresas    = 0;
     nAscci       = 0;
     nGraba       = 0;
     nSw          = 0;
     nSwHay       = 0;
     nEsta        = 0;
     nCampoMod    = 0;
     nPrimero     = 0;

     fFecha       = @;
     aMes         = "";
     nAgente      = 0;
     aAgente      = "";
     nSwAgen      = 0;
     nAntAgente   = 0;
     aAntAgente   = "";
     aAntNombre   = "";
     aAlfa        = "";
     aAlfa1       = "";
     aTipo        = "";
     aFichero     = "";
     aBase        = "";
     aOrigen      = "";
     aDestino     = "";
     aIPRemoto    = "";
     aPlaning     = "";
     aLetra       = "";
     aDocumento   = "";
     aDef         = "";
     aTitulo      = "";

     aDFecha      = @;
     aHFecha      = @;
     nNume        = 0;
     &eaUnidadBasico  = "";
|FIN;

|INCLUYE i_variar;

|PROCESO Regimen;
     nCampo = Campo + 1;
     |C_M #0nCampo, 1, "S";

     |SI #0Campo = 0;
         |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
     |FINSI;
|FPRC;

|PROCESO AntesCondicion; |TIPO 7;
  aAlfa1 = "S";
  |SI #0#0 = 0; |O #0#2 = 0;
      aAlfa1 = "N";
      #0#68 = "N"; |PINTA #0#68;
  |FINSI;
  |C_M #0#68, 1, aAlfa1;
|FPRC;

|PROCESO Parrilla;
     |SI #0#4 = 0;
         #0#4 = 0;  |PINTA #0#4;
         #0#5 = 0;  |PINTA #0#5;  |C_M #0#5, 1, "N";
         |PARA nCampo = 6;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#5, 1, "S";
         |PARA nCampo = 6;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Periodo;
     |SI #0#42 = 1;   #0#43 = "ENERO     ";  |FINSI;
     |SI #0#42 = 2;   #0#43 = "FEBRERO   ";  |FINSI;
     |SI #0#42 = 3;   #0#43 = "MARZO     ";  |FINSI;
     |SI #0#42 = 4;   #0#43 = "ABRIL     ";  |FINSI;
     |SI #0#42 = 5;   #0#43 = "MAYO      ";  |FINSI;
     |SI #0#42 = 6;   #0#43 = "JUNIO     ";  |FINSI;
     |SI #0#42 = 7;   #0#43 = "JULIO     ";  |FINSI;
     |SI #0#42 = 8;   #0#43 = "AGOSTO    ";  |FINSI;
     |SI #0#42 = 9;   #0#43 = "SEPTIEMBRE";  |FINSI;
     |SI #0#42 = 10;  #0#43 = "OCTUBRE   ";  |FINSI;
     |SI #0#42 = 11;  #0#43 = "NOVIEMBRE ";  |FINSI;
     |SI #0#42 = 12;  #0#43 = "DICIEMBRE ";  |FINSI;
     |SI #0#42 = 13;  #0#43 = "DIC/ANUAL ";  |FINSI;
     |SI #0#42 = 99;  #0#43 = "ANUAL     ";  |FINSI;

     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#44  = aAlfa;

     |PINTA #0#43;
     |PINTA #0#44;
|FPRC;

|PROCESO Modelos;
     |SI #0#47 = "S";
         |PARA nCampo = 50;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |PARA nCampo = 50;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasModelos;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Modelos66;  |TIPO 66;
     |ABRE #199;
     #199#0 = #0Campo;
     |LEE 040#199=;
     |SI FSalida ! 0;  |DDEFECTO #199;  |FINSI;

     |CONSULTA_CLAVE #1#199;
     |SI FSalida = 0;
         #0Campo = #199#0;   |PINTA #0Campo;
     |FINSI;
     |CIERRA #199;
|FPRC;

|PROCESO Modelos0;
     |SI #0Campo = 0;  |ACABA;  |FINSI;

     |ABRE #199;
     #199#0 = #0Campo;
     |LEE 040#199=;
     |SI FSalida ! 0;  |DDEFECTO #199;  |FINSI;
     |CIERRA #199;

     |SI #0Campo = 180;  |O #0Campo = 190;  |O #0Campo = 390;  |O #0Campo = 392;
      |O #0Campo = 100;  |O #0Campo = 101;  |O #0Campo = 714;  |O #0Campo = 201;
      |O #0Campo = 200;  |O #0Campo = 193;  |O #0Campo = 184;  |O #0Campo = 296;
      |O #0Campo = 187;
         #199#4 = "S";
     |FINSI;

     |SI #199#4 ! "S";
         |MENAV "     Modelo sin Activar.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #0#44 ] 2014;
         |SI #0Campo = 310; |O #0Campo = 370;
             |MENAV "0000Modelo no vigente a partir del Ejercicio 2014";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0Campo = 347;  |O #0Campo = 180;  |O #0Campo = 190; |O #0Campo = 390;
      |O #0Campo = 392;  |O #0Campo = 100;  |O #0Campo = 101; |O #0Campo = 714;
      |O #0Campo = 201;  |O #0Campo = 200;  |O #0Campo = 193; |O #0Campo = 184;
      |O #0Campo = 296;  |O #0Campo = 187;
         |SI #0#42 ! 99; |Y #0#42 ! 13;
             |MENAV "0000 El Periodo del Modelo no corresponde con el Periodo Seleccionado.";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ordeno; |TIPO 0;
 |C_M #0#67,1,"S";
 |SI #0#46 = 4;
     |C_M #0#67,1,"N";
      #0#67 = "A"; |PINTA #0#67;
 |FINSI;
 |SI #0#46 = 3;
     #0#67 = "G"; |PINTA #0#67;
 |FINSI;
|FPRC;

|PROCESO AntAct; |TIPO 7;
 |C_M #0#48,1,"S";
 |SI #0#67 = "G";
     |C_M #0#48,1,"N";
     #0#48 = "N"; |PINTA #0#48;
 |FINSI;
|FPRC;

|PROCESO AsignaCabecera;
     |SI #0#49 = 2;
         aTitulo  = "PLANING DE MODELOS POR CLIENTES";
         aPlaning = "";
         |SI #0#67 = "G"; aTitulo  = aTitulo + " Y AGENTES"; |FINSI;
     |FINSI;

     |SI #0#46 = 4;
         |SI #0#49 = 2; aTitulo = "PLANING MODELOS CLIENTES Y AGENTE " + aAntAgente + " " + aAntNombre; |FINSI;  ||ESTO HAY QUE MODIFICARLO
         |SI #0#49 = 1; aTitulo = aTitulo + "Y AGENTE " + aAntAgente + " " + aAntNombre; |FINSI;  ||ESTO HAY QUE MODIFICARLO
     |FINSI;

     aAlfa = "A1," + aTitulo;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa = "A2," + aPlaning;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa = "B2, PERIODO : " + (("00" + #0#42) % -102) + " " + #0#43 + "  " +  #0#44;
     |ALFACALLDLL "agixl97.dll", "poke_dato", aAlfa;

     |SI #0#67 = "G";
         aAlfa = "B3,Agente     ";
         |ALFACALLDLL "agixl97.dll", "poke_dato", aAlfa;
     |FINSI;

     |SI #0#49 ! 1;  |ACABA;  |FINSI;

     aAlfa   = nModelo1;
     |SI nModelo1 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "C3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo2;
     |SI nModelo2 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "D3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo3;
     |SI nModelo3 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "E3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo4;
     |SI nModelo4 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "F3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo5;
     |SI nModelo5 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "G3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo6;
     |SI nModelo6 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "H3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo7;
     |SI nModelo7 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "I3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo8;
     |SI nModelo8 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "J3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo9;
     |SI nModelo9 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "K3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     aAlfa   = nModelo10;
     |SI nModelo10 = 0;  aAlfa = "  ";  |FINSI;
     aAlfa   = "L3," + aAlfa;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     |SI #0#42 = 13;
         aAlfa   = nModelo11;
         |SI nModelo11 = 0;  aAlfa = "  ";  |FINSI;
         aAlfa   = "M3," + aAlfa;
         |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

         aAlfa   = nModelo12;
         |SI nModelo12 = 0;  aAlfa = "  ";  |FINSI;
         aAlfa   = "N3," + aAlfa;
         |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

         aAlfa   = nModelo13;
         |SI nModelo13 = 0;  aAlfa = "  ";  |FINSI;
         aAlfa   = "O3," + aAlfa;
         |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

         aAlfa   = nModelo14;
         |SI nModelo14 = 0;  aAlfa = "  ";  |FINSI;
         aAlfa   = "P3," + aAlfa;
         |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

         aAlfa   = nModelo15;
         |SI nModelo15 = 0;  aAlfa = "  ";  |FINSI;
         aAlfa   = "Q3," + aAlfa;
         |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     |FINSI;
|FPRC;

|PROCESO CargaVariables;
     nSw = 0;
     |PARA nCampo = 4;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           |SI #99nCampo ! "    ";  nSw = 1;  |SAL;  |FINSI;
     |SIGUE;

     |SI nSw = 0;  |ACABA;  |FINSI;

     |SI #0#69 ! "T";
         |SI #0#49 = 1;
             nSw = 0;
             |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
                   |SI #0#69 = "P"; |Y #99nCampo = "PDTE";  nSw = 1;  |SAL;  |FINSI;
                   |SI #0#69 = "I"; |Y #99nCampo = "IMPR";  nSw = 1;  |SAL;  |FINSI;
                   |SI #0#69 = "R"; |Y #99nCampo = "REME";  nSw = 1;  |SAL;  |FINSI;
                   |SI #0#69 = "A"; |Y #99nCampo = "ARCH";  nSw = 1;  |SAL;  |FINSI;
                   |SI #0#69 = "X"; |Y #99nCampo ! "ARCH"; |Y #99nCampo ! "    "; nSw = 1;  |SAL;  |FINSI;
                   |SI #0#69 = "E"; |Y #99nCampo = "ELAB";  nSw = 1;  |SAL;  |FINSI;
                   |SI nCampo = 16; nCampo = 21; |FINSI;
             |SIGUE;

             |SI nSw = 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #0#49 = 2;
             nSw = 0;
             |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
                   aAlfa = #99nCampo % -101;
                   |SI #0#69 ! "X";
                       |SI #0#69 = aAlfa;  nSw = 1;  |SAL;  |FINSI;
                   |SINO;
                       |SI aAlfa ! "A"; |Y aAlfa ! " "; nSw = 1;  |SAL;  |FINSI;
                   |FINSI;
                   |SI nCampo = 16; nCampo = 21; |FINSI;
             |SIGUE;

             |SI nSw = 0;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;


     |SI #0#46 = 4;

          |SI nPrimero = 0;
               nPrimero = 1;
               nAntAgente = #99#18;
               aAntAgente = #99#18; aAntAgente = ("00" + aAntAgente) % -102;
               aAntNombre = #99#19 % 120;
               |HAZ AsignaCabecera;
          |FINSI;

          |SI nAntAgente ! #99#18; || 3237_340
              |SI #0#45 = "I";
                 |ALFACALLDLL "agixl97.dll","fin_book", "imprime";
              |SINO;
                 |ALFACALLDLL "agixl97.dll","fin_book", "";
              |FINSI;

              aAlfa = eaUnidadBasico + "\MODELOS\DOCUMENTOS\" + aDocumento;
              |ALFACALLDLL "agixl97.dll", "carga_book", aAlfa;
              |ALFACALLDLL "agixl97.dll", "selecciona_hoja", "Intro";

              nAntAgente = #99#18;
              aAntAgente = #99#18; aAntAgente = ("00" + aAntAgente) % -102;
              aAntNombre = #99#19 % 120;
              |HAZ AsignaCabecera;
              nEmpresas  = 3;
           |FINSI;
           nAntAgente = #99#18;
           aAntAgente = #99#18; aAntAgente = ("00" + aAntAgente) % -102;
           aAntNombre = #99#19 % 120;
     |FINSI;

     nEmpresas  = nEmpresas  + 1;

     |SI #0#70 = "N";
         aAlfa     = "A" + nEmpresas + "," + (("00000" + #99#0) % -105) + " " + #99#2;
     |SINO;
         aAlfa     = "A" + nEmpresas + "," + (("00000" + #99#0) % -105) + " " + #99#2 + " " + #99#20;
     |FINSI;
     |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;


     |SI #0#67 ! "G";  || imprime agente o actividad
          |SI #99#1 ! 0;
              aAlfa     = "B" + nEmpresas + "," + (("00" + #99#1) % -102) + " " + #99#3;
              |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
          |SINO;
              aAlfa     = "B" + nEmpresas + "," + #99#3;
              |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
          |FINSI;
     |SINO;
          aAlfa     = "B" + nEmpresas + "," + (("00" + #99#18) % -102) + " " + #99#19;
          |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |FINSI;


     nAscci = 66;
     |PARA nCampo = 4;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
           |SI #0#69 ! "T";
               |SI #0#49 = 1;
                   aAlfa1 = #99nCampo % 101;
                   nAscci    = nAscci + 1;
                   aLetra    = &nAscci;
                   aAlfa     = aLetra + nEmpresas + "," + #99nCampo;
                   |SI #0#69 ! "X";
                       |SI aAlfa1 = #0#69;
                           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
                       |FINSI;
                   |SINO;
                       |SI aAlfa1 ! "A"; |Y aAlfa1 ! " ";
                           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
                       |FINSI;
                   |FINSI;
               |FINSI;

               |SI #0#49 = 2;
                   aAlfa1 = #99nCampo % -101;
                   |SI #0#69 ! "X";
                       |SI aAlfa1 = #0#69;
                           nAscci    = nAscci + 1;
                           aLetra    = &nAscci;
                           aAlfa     = aLetra + nEmpresas + "," + #99nCampo;
                           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
                       |FINSI;
                   |SINO;
                       |SI aAlfa1 ! "A"; |Y aAlfa1 ! " ";
                           nAscci    = nAscci + 1;
                           aLetra    = &nAscci;
                           aAlfa     = aLetra + nEmpresas + "," + #99nCampo;
                           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
                       |FINSI;
                   |FINSI;
               |FINSI;
           |SINO;
               nAscci    = nAscci + 1;
               aLetra    = &nAscci;
               aAlfa     = aLetra + nEmpresas + "," + #99nCampo;
               |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
           |FINSI;

           |SI nCampo = 16; nCampo = 21; |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE dsmow038C;
     #99#1;
     ;
     00000, 00;
     99999, 99;
     ;
     NULL, CargaVariables;
|FIN;

|DEFBUCLE dsmow038N;
     #99#2;
     ;
     "                                        ", 00;
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", 99;
     ;
     NULL, CargaVariables;
|FIN;

|DEFBUCLE dsmow038A;
     #99#3;
     ;
     00, 00000, 00;
     99, 99999, 99;
     ;
     NULL, CargaVariables;
|FIN;

|PROCESO CopiaFichero;
     aAlfa = eaUnidadBasico + "\MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "\MODELOS\DOCUMENTOS";        |RMKDIR aAlfa;

     aOrigen   = aBase + "basica/word/" + aDocumento;
     aDestino  = eaUnidadBasico + "/MODELOS/DOCUMENTOS/" + aDocumento;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|PROCESO EmiteDocumento;
     |HAZ CopiaFichero;

     |CARGADLL "agixl97.dll";
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aAlfa = eaUnidadBasico + "\MODELOS\DOCUMENTOS\" + aDocumento;
     |ALFACALLDLL "agixl97.dll", "carga_book", aAlfa;
     |ALFACALLDLL "agixl97.dll", "selecciona_hoja", "Intro";

     |SI #0#46 ! 4; |HAZ AsignaCabecera; |FINSI;                || 3237_340

     |MENSA "      Cargando Campos al Documento, espere un Momento.";

     nAntAgente = -1;
     aAntAgente = "";
     nPrimero   = 0;
     nEmpresas  = 3;
     |SI #0#46 = 1; |BUCLE dsmow038C; |FINSI;
     |SI #0#46 = 2; |BUCLE dsmow038N; |FINSI;
     |SI #0#46 ] 3; |BUCLE dsmow038A; |FINSI;

     |MENSA "      Imprimiendo el Documento, espere un Momento.";

     |SI #0#45 = "I";
         |ALFACALLDLL "agixl97.dll","fin_book", "imprime";
     |SINO;
         |ALFACALLDLL "agixl97.dll","fin_book", "";
     |FINSI;

     |DESCARGADLL "agixl97.dll";

     |RFBORRA aDestino;
|FPRC;

|PROCESO CargaModelo;
     nEsta = 0;
     |PARA nCampoMod = 4;  |SI nCampoMod [ 23;  |HACIENDO nCampoMod = nCampoMod + 1;
           aAlfa1 = #99nCampoMod % 103;
           |SI aAlfa1 = aAlfa;
               nEsta = 1;
               #99nCampoMod = aAlfa + aTipo;
           |FINSI;
           |SI nCampoMod = 16; nCampoMod = 21; |FINSI;
     |SIGUE;

     |SI nEsta = 1;  |ACABA;  |FINSI;

     |PARA nCampoMod = 4;  |SI nCampoMod [ 23;  |HACIENDO nCampoMod = nCampoMod + 1;
           |SI #99nCampoMod = "    ";
               #99nCampoMod = aAlfa + aTipo;
               |SAL;
           |FINSI;
           |SI nCampoMod = 16; nCampoMod = 21; |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CargaVar2;
     aTipo = " ";
     |SI #4#5 ! "EMPRESA   ";  |Y #4#5 ! "MANUAL    "; |Y #0#48 = "S";
         |ABRE #8;
         #8#0 = #4#0;
         #8#1 = #4#1;
         #8#2 = #4#2;
         #8#3 = #4#3;
         #8#4 = #4#4;
         #8#5 = #114#1;
         |LEE 040#8=;
         |SI FSalida = 0;
             aTipo = "P";

             |SI #8#11 = "COMPLETADO";  |Y #0#48 = "S";
                 aTipo = "C";
             |FINSI;

             |SI #4#7  = "X";  aTipo = "E";  |FINSI;
             |SI #4#9  = "X";  aTipo = "I";  |FINSI;
             |SI #4#11 = "X";  aTipo = "R";  |FINSI;
             |SI #4#13 = "X";  aTipo = "A";  |FINSI;
         |SINO;
             aTipo = "x";
         |FINSI;
         |CIERRA #8;
     |SINO;
         aTipo = "P";
         |SI #4#7  = "X";  aTipo = "E";  |FINSI;
         |SI #4#9  = "X";  aTipo = "I";  |FINSI;
         |SI #4#11 = "X";  aTipo = "R";  |FINSI;
         |SI #4#13 = "X";  aTipo = "A";  |FINSI;
     |FINSI;

     |SI aTipo ! "x";
         aAlfa = #4#3;   |HAZ CargaModelo;
     |FINSI;
|FPRC;

|PROCESO BuscaModelo;
     nModelo = 0;

     |SI #4#3 = nModelo1;   nModelo = 4;    |FINSI;
     |SI #4#3 = nModelo2;   nModelo = 5;    |FINSI;
     |SI #4#3 = nModelo3;   nModelo = 6;    |FINSI;
     |SI #4#3 = nModelo4;   nModelo = 7;    |FINSI;
     |SI #4#3 = nModelo5;   nModelo = 8;    |FINSI;
     |SI #4#3 = nModelo6;   nModelo = 9;    |FINSI;
     |SI #4#3 = nModelo7;   nModelo = 10;   |FINSI;
     |SI #4#3 = nModelo8;   nModelo = 11;   |FINSI;
     |SI #4#3 = nModelo9;   nModelo = 12;   |FINSI;
     |SI #4#3 = nModelo10;  nModelo = 13;   |FINSI;
     |SI #4#3 = nModelo11;  nModelo = 14;   |FINSI;
     |SI #4#3 = nModelo12;  nModelo = 15;   |FINSI;
     |SI #4#3 = nModelo13;  nModelo = 16;   |FINSI;
     |SI #4#3 = nModelo14;  nModelo = 22;   |FINSI;
     |SI #4#3 = nModelo15;  nModelo = 23;   |FINSI;

     |SI nModelo = 0;  |ACABA;  |FINSI;

     |SI #0#49 = 2;
         |HAZ CargaVar2;
         |ACABA;
     |FINSI;

     |SI #4#5 ! "EMPRESA   ";  |Y #4#5 ! "MANUAL    "; |Y #0#48 = "S"; ||3237_340
         |ABRE #8;
         #8#0 = #4#0;
         #8#1 = #4#1;
         #8#2 = #4#2;
         #8#3 = #4#3;
         #8#4 = #4#4;
         #8#5 = #114#1;
         |LEE 040#8=;
         |SI FSalida = 0;
             #99nModelo = "PDTE";

             |SI #8#11 = "COMPLETADO";  |Y #0#48 = "S";
                 #99nModelo = "COMP";
             |FINSI;

             |SI #4#7  = "X";  #99nModelo = "ELAB";  |FINSI;
             |SI #4#9  = "X";  #99nModelo = "IMPR";  |FINSI;
             |SI #4#11 = "X";  #99nModelo = "REME";  |FINSI;
             |SI #4#13 = "X";  #99nModelo = "ARCH";  |FINSI;
         |FINSI;
         |CIERRA #8;
     |SINO;
         #99nModelo = "PDTE";
         |SI #4#7  = "X";  #99nModelo = "ELAB";  |FINSI;
         |SI #4#9  = "X";  #99nModelo = "IMPR";  |FINSI;
         |SI #4#11 = "X";  #99nModelo = "REME";  |FINSI;
         |SI #4#13 = "X";  #99nModelo = "ARCH";  |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom004;
     #4#1;
     ;
     #114#0, #0#44, nDPer, 000, 00;
     #114#0, #0#44, nHPer, 999, 99;
     ;
     NULL, BuscaModelo;
|FIN;

|PROCESO SelAgente;
     nAgente = 0;
     nSwAgen = 0;
     aAgente = "";

 || Seleccion de Agente para Integrada
     aAlfa = "|FICHERO"; aAlfa = #715#aAlfa#; |QBF aAlfa;
     |DBASS aAlfa1; |QBF aAlfa1; aAlfa1 = aAlfa1 + "integral";
     aAlfa = aAlfa - aAlfa1;
     |SI FSalida ! 0;
         nAgente = #715#72;
         aAgente = #715#52;
         |ABRE #212;
         #212#0 = #715#0;
         #212#1 = 2;       || Area Fiscal;
         |LEE 041#212=;
         |SI FSalida = 0;
             nAgente = #212#2;
             aAgente = #212#3;
         |FINSI;
         |CIERRA #212;

        |SI nAgente < #0#65; |O nAgente > #0#66;
            nSwAgen = 1;
        |SINO;
            |QBF aAgente;
            |SI aAgente = ""; |Y nAgente ! 0;
                |ABRE #215;
                #215#0 = nAgente;
                |LEE 041#215=;
                |SI FSalida = 0;
                    aAgente = #215#2;
                |FINSI;
                |CIERRA #215;
            |FINSI;
        |FINSI;
     |FINSI;
|FPRC;


|PROCESO GrabaModelos;
     enCodCli = #114#0;
     |HAZ LeePersona;

     |HAZ SelAgente;
     |SI nSwAgen ! 0; |ACABA; |FINSI;

     aAlfa = #715#7 % -104;
     |SI aAlfa ! "0000";
         nNume   = aAlfa;
         |SI nNume > #0#44;  |ACABA;  |FINSI;
     |FINSI;

     aAlfa = #114#6 % -104;
     |SI aAlfa ! "0000";
         nNume   = aAlfa;
         |SI nNume < #0#44;  |ACABA;  |FINSI;
     |FINSI;

     #99#0 = #114#0;
     #99#1 = #114#1;
     |SI #0#48 = "N";  |O #0#42 = 99;
         #99#1 = 0;
     |FINSI;

     |LEE 101#99=;
     |SI FSalida ! 0;
         |DDEFECTO #99;
         #99#0 = #114#0;
         #99#1 = #114#1;
         |SI #0#48 = "N";  |O #0#42 = 99;
             #99#1 = 0;
         |FINSI;
         #99#2 = #715#1;
         #99#3 = #114#4;   ||recogera la primera Actividad
         |SI enSwDeDonde = 1;
             #99#20= #715#3;
         |SINO;
             #99#20= #715#13;
         |FINSI;
         |GRABA 020#99b;
     |FINSI;

     |BUCLE dsmom004;

     aDef = aBase + "ren" + #0#44 + "/def/reacceso.mas";
     |CARGA_DEF aDef, referen@;
     |SI FSalida = 0;
         |ABRE #200;
         #200#0 = #114#0;
         |LEE 040#200=;
         |SI FSalida = 0;
                                    nModelo = 0;
             |SI nModelo1  = 100;   nModelo = 4;    |FINSI;
             |SI nModelo2  = 100;   nModelo = 5;    |FINSI;
             |SI nModelo3  = 100;   nModelo = 6;    |FINSI;
             |SI nModelo4  = 100;   nModelo = 7;    |FINSI;
             |SI nModelo5  = 100;   nModelo = 8;    |FINSI;
             |SI nModelo6  = 100;   nModelo = 9;    |FINSI;
             |SI nModelo7  = 100;   nModelo = 10;   |FINSI;
             |SI nModelo8  = 100;   nModelo = 11;   |FINSI;
             |SI nModelo9  = 100;   nModelo = 12;   |FINSI;
             |SI nModelo10 = 100;   nModelo = 13;   |FINSI;
             |SI nModelo11 = 100;   nModelo = 14;   |FINSI;
             |SI nModelo12 = 100;   nModelo = 15;   |FINSI;
             |SI nModelo13 = 100;   nModelo = 16;   |FINSI;
             |SI nModelo14 = 100;   nModelo = 22;   |FINSI;
             |SI nModelo15 = 100;   nModelo = 23;   |FINSI;

             |SI nModelo ! 0;
                 |SI #0#49 = 1;
                     #99nModelo = "PDTE";
                     |SI #200#12 = "*";
                         |SI #200#14 = "INACTIVO  ";
                             #99nModelo = "    ";
                         |SINO;
                             #99nModelo = "ELAB";
                         |FINSI;
                     |FINSI;
                     |SI #200#14 = "IMPRESO   ";  #99nModelo = "IMPR";  |FINSI;
                 |FINSI;

                 |SI #0#49 = 2;
                     aTipo = "P";
                     |SI #200#12 = "*";
                         |SI #200#14 = "INACTIVO  ";
                             aTipo = " ";
                         |SINO;
                             aTipo = "E";
                         |FINSI;
                     |FINSI;
                     |SI #200#14 = "IMPRESO   ";  aTipo = "I";  |FINSI;

                     aAlfa = "100";   |HAZ CargaModelo;
                 |FINSI;
             |FINSI;

                                    nModelo = 0;
             |SI nModelo1  = 714;   nModelo = 4;    |FINSI;
             |SI nModelo2  = 714;   nModelo = 5;    |FINSI;
             |SI nModelo3  = 714;   nModelo = 6;    |FINSI;
             |SI nModelo4  = 714;   nModelo = 7;    |FINSI;
             |SI nModelo5  = 714;   nModelo = 8;    |FINSI;
             |SI nModelo6  = 714;   nModelo = 9;    |FINSI;
             |SI nModelo7  = 714;   nModelo = 10;   |FINSI;
             |SI nModelo8  = 714;   nModelo = 11;   |FINSI;
             |SI nModelo9  = 714;   nModelo = 12;   |FINSI;
             |SI nModelo10 = 714;   nModelo = 13;   |FINSI;
             |SI nModelo11 = 714;   nModelo = 14;   |FINSI;
             |SI nModelo12 = 714;   nModelo = 15;   |FINSI;
             |SI nModelo13 = 714;   nModelo = 16;   |FINSI;
             |SI nModelo14 = 714;   nModelo = 22;   |FINSI;
             |SI nModelo15 = 714;   nModelo = 23;   |FINSI;

             |SI nModelo ! 0;
                 |SI #0#49 = 1;
                     #99nModelo = "PDTE";
                     |SI #200#12 = "*";
                         |SI #200#15 = "INACTIVO  ";
                             #99nModelo = "    ";
                         |SINO;
                             #99nModelo = "ELAB";
                         |FINSI;
                     |FINSI;
                     |SI #200#15 = "IMPRESO   ";  #99nModelo = "IMPR";  |FINSI;
                 |FINSI;

                 |SI #0#49 = 2;
                     aTipo = "P";
                     |SI #200#12 = "*";
                         |SI #200#15 = "INACTIVO  ";
                             aTipo = " ";
                         |SINO;
                             aTipo = "E";
                         |FINSI;
                     |FINSI;
                     |SI #200#15 = "IMPRESO   ";  aTipo = "I";  |FINSI;

                     aAlfa = "714";   |HAZ CargaModelo;
                 |FINSI;
             |FINSI;
         |FINSI;
         |CIERRA #200;
         |DESCARGA_DEF #referen@;
     |FINSI;

     aDef = aBase + "contasoc/def/isacceso.mas";
     |CARGA_DEF aDef, referen@;
     |SI FSalida = 0;
         |ABRE #200;
         #200#0 = #114#0;
         #200#1 = #0#44;
         |LEE 040#200=;
         |SI FSalida = 0;
                                    nModelo = 0;
             |SI nModelo1  = 201;   nModelo = 4;    |FINSI;
             |SI nModelo2  = 201;   nModelo = 5;    |FINSI;
             |SI nModelo3  = 201;   nModelo = 6;    |FINSI;
             |SI nModelo4  = 201;   nModelo = 7;    |FINSI;
             |SI nModelo5  = 201;   nModelo = 8;    |FINSI;
             |SI nModelo6  = 201;   nModelo = 9;    |FINSI;
             |SI nModelo7  = 201;   nModelo = 10;   |FINSI;
             |SI nModelo8  = 201;   nModelo = 11;   |FINSI;
             |SI nModelo9  = 201;   nModelo = 12;   |FINSI;
             |SI nModelo10 = 201;   nModelo = 13;   |FINSI;
             |SI nModelo11 = 201;   nModelo = 14;   |FINSI;
             |SI nModelo12 = 201;   nModelo = 15;   |FINSI;
             |SI nModelo13 = 201;   nModelo = 16;   |FINSI;
             |SI nModelo14 = 201;   nModelo = 22;   |FINSI;
             |SI nModelo15 = 201;   nModelo = 23;   |FINSI;

             |SI nModelo ! 0;
                 |SI #0#49 = 1;
                     #99nModelo = "PDTE";
                     |SI #200#6 = "S";
                         #99nModelo = "IMPR";
                     |FINSI;
                 |FINSI;

                 |SI #0#49 = 2;
                     aTipo = "P";
                     |SI #200#6 = "S";
                         aTipo = "I";
                     |FINSI;

                     aAlfa = "201";   |HAZ CargaModelo;
                |FINSI;
             |FINSI;
         |FINSI;
         |CIERRA #200;
         |DESCARGA_DEF #referen@;
     |FINSI;

     #99#18 = nAgente;
     #99#19 = aAgente;

     |GRABA 020#99a;
     |LIBERA #99;

     nGraba = 1;
     nSwHay = 1;
|FPRC;

|DEFBUCLE agicen14;
     #114#1;
     9, 7;
     #0#4, 01, nDTributa, nDIVA;
     #0#5, 99, nHTributa, nHIVA;
     ;
     NULL, GrabaModelos;
|FIN;

|PROCESO PonModelosTrib;
     #199#0 = #113#1;
     |LEE 040#199=;
     |SI FSalida ! 0;  |DDEFECTO #199;  |FINSI;

     |SI #199#4 ! "S"; |ACABA;  |FINSI;

     |SI #0#42 [ 12;
         |SI #199#5 = "A"; |ACABA;  |FINSI;
     |SINO;
         |SI #0#42 = 99;
             |SI #199#5 ! "A";  |Y #199#5 ! "C";
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #199#0 = 110; |O #199#0 = 115;
        |O #199#0 = 123; |O #199#0 = 216;
         |ACABA;     || .. se ponen luego adrede
     |FINSI;
     |SI #199#0 = 190; |O #199#0 = 180;
        |O #199#0 = 193; |O #199#0 = 296; |O #199#0 = 187;
          |ACABA;
     |FINSI;

     |SI #0#47 = "S";
         nSw = 0;
         |PARA nCampo = 50;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #199#0;  nSw = 1;  |FINSI;
         |SIGUE;

         |SI nSw = 0;  |ACABA;  |FINSI;
     |FINSI;

     nModelo = nModelo + 1;

     |SI nModelo = 1;   nModelo1  = #199#0;  |FINSI;
     |SI nModelo = 2;   nModelo2  = #199#0;  |FINSI;
     |SI nModelo = 3;   nModelo3  = #199#0;  |FINSI;
     |SI nModelo = 4;   nModelo4  = #199#0;  |FINSI;
     |SI nModelo = 5;   nModelo5  = #199#0;  |FINSI;
     |SI nModelo = 6;   nModelo6  = #199#0;  |FINSI;
     |SI nModelo = 7;   nModelo7  = #199#0;  |FINSI;
     |SI nModelo = 8;   nModelo8  = #199#0;  |FINSI;
     |SI nModelo = 9;   nModelo9  = #199#0;  |FINSI;
     |SI nModelo = 10;  nModelo10 = #199#0;  |FINSI;
     |SI nModelo = 11;  nModelo11 = #199#0;  |FINSI;
     |SI nModelo = 12;  nModelo12 = #199#0;  |FINSI;
     |SI nModelo = 13;  nModelo13 = #199#0;  |FINSI;
     |SI nModelo = 14;  nModelo14 = #199#0;  |FINSI;
     |SI nModelo = 15;  nModelo15 = #199#0;  |FINSI;
|FPRC;

|DEFBUCLE agitab13;
     #113#1;
     ;
     #112#0, 000;
     #112#0, 899;
     ;
     NULL, PonModelosTrib;
|FIN;

|PROCESO PonLo;
     |SI #0#47 = "S";
         nSw = 0;
         |PARA nCampo = 50;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = nMod;  nSw = 1;  |FINSI;
         |SIGUE;
         |SI nSw = 0;  |ACABA;  |FINSI;
     |FINSI;

     nModelo = nModelo + 1;

     |SI nModelo = 1;   nModelo1  = nMod;  |FINSI;
     |SI nModelo = 2;   nModelo2  = nMod;  |FINSI;
     |SI nModelo = 3;   nModelo3  = nMod;  |FINSI;
     |SI nModelo = 4;   nModelo4  = nMod;  |FINSI;
     |SI nModelo = 5;   nModelo5  = nMod;  |FINSI;
     |SI nModelo = 6;   nModelo6  = nMod;  |FINSI;
     |SI nModelo = 7;   nModelo7  = nMod;  |FINSI;
     |SI nModelo = 8;   nModelo8  = nMod;  |FINSI;
     |SI nModelo = 9;   nModelo9  = nMod;  |FINSI;
     |SI nModelo = 10;  nModelo10 = nMod;  |FINSI;
     |SI nModelo = 11;  nModelo11 = nMod;  |FINSI;
     |SI nModelo = 12;  nModelo12 = nMod;  |FINSI;
     |SI nModelo = 13;  nModelo13 = nMod;  |FINSI;
     |SI nModelo = 14;  nModelo14 = nMod;  |FINSI;
     |SI nModelo = 15;  nModelo15 = nMod;  |FINSI;
|FPRC;

|PROCESO PonResto;
     |SI #0#42 ! 99;
         nMod = 110;  |HAZ PonLo;
         nMod = 115;  |HAZ PonLo;
         nMod = 123;  |HAZ PonLo;
         nMod = 216;  |HAZ PonLo;
     |FINSI;

     |SI #0#42 ] 13;
         nMod = 190;  |HAZ PonLo;
         nMod = 180;  |HAZ PonLo;
         nMod = 187;  |HAZ PonLo;
         nMod = 193;  |HAZ PonLo;
         nMod = 296;  |HAZ PonLo;

         |SI #112#0 ! 2;   |Y #112#0 ! 8;   |Y #112#0 ! 9;  |Y #112#0 ! 10;
          |Y #112#0 ! 11;  |Y #112#0 ! 12;  |Y #112#0 ! 18;
             nMod = 100;  |HAZ PonLo;
             nMod = 714;  |HAZ PonLo;
         |FINSI;

         |SI #112#0 = 2;
             nMod = 201;  |HAZ PonLo;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tributacion;
     |SI #0#49 = 1;
         |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

         aTitulo  = "PLANING REGIMEN DE TRIBUTACION ";
         aPlaning = (("00" + #112#0) % -102) + "  " + #112#5;
     |FINSI;

     nModelo   = 0;
     nModelo1  = 0;
     nModelo2  = 0;
     nModelo3  = 0;
     nModelo4  = 0;
     nModelo5  = 0;
     nModelo6  = 0;
     nModelo7  = 0;
     nModelo8  = 0;
     nModelo9  = 0;
     nModelo10 = 0;
     nModelo11 = 0;
     nModelo12 = 0;
     nModelo13 = 0;
     nModelo14 = 0;
     nModelo15 = 0;

     |ABRE #199;
     |BUCLE agitab13;
     |CIERRA #199;

     |HAZ PonResto;

     |SI nModelo1 = 0;  |ACABA;  |FINSI;

     nDTributa = #112#0;
     nHTributa = #112#0;
     nDIVA     = 01;
     nHIVA     = 99;
     |SI #0#68 = "S"; nDIVA = #0#2; nHIVA = #0#3; |FINSI;
     nGraba    = 0;

     |ABRE #99;
     |SI #0#4 ! 0;
         |BUCLE agicen14;
     |SINO;
         |PARA nCampo = 6;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#4 = #0nCampo;
                   #0#5 = #0nCampo;
                   |BUCLE agicen14;
               |FINSI;
         |SIGUE;
         #0#4 = 0; #0#5 = 0;
     |FINSI;
     |CIERRA #99;

     |SI nGraba = 1;  |Y #0#49 = 1;
         |HAZ EmiteDocumento;
     |FINSI;
|FPRC;

|DEFBUCLE agitab12;
     #112#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, Tributacion;
|FIN;

|PROCESO ModeloIVA;
     #199#0 = nElModelo;
     |LEE 040#199=;
     |SI FSalida ! 0;  |DDEFECTO #199;  |FINSI;

     |SI #0#42 [ 12;
         |SI #199#4 ! "S"; |ACABA;  |FINSI;
         |SI #199#5 = "A"; |ACABA;  |FINSI;
     |FINSI;
     |SI #0#42 = 99;
         |SI #199#5 ! "A";  |Y #199#5 ! "C";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #0#47 = "S";
         nSw = 0;
         |PARA nCampo = 50;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = #199#0;  nSw = 1;  |FINSI;
         |SIGUE;
         |SI nSw = 0;  |ACABA;  |FINSI;
     |FINSI;

     nModelo = nModelo + 1;

     |SI nModelo = 1;   nModelo1  = #199#0;  |FINSI;
     |SI nModelo = 2;   nModelo2  = #199#0;  |FINSI;
     |SI nModelo = 3;   nModelo3  = #199#0;  |FINSI;
     |SI nModelo = 4;   nModelo4  = #199#0;  |FINSI;
     |SI nModelo = 5;   nModelo5  = #199#0;  |FINSI;
     |SI nModelo = 6;   nModelo6  = #199#0;  |FINSI;
     |SI nModelo = 7;   nModelo7  = #199#0;  |FINSI;
     |SI nModelo = 8;   nModelo8  = #199#0;  |FINSI;
     |SI nModelo = 9;   nModelo9  = #199#0;  |FINSI;
     |SI nModelo = 10;  nModelo10 = #199#0;  |FINSI;
     |SI nModelo = 11;  nModelo11 = #199#0;  |FINSI;
     |SI nModelo = 12;  nModelo12 = #199#0;  |FINSI;
     |SI nModelo = 13;  nModelo13 = #199#0;  |FINSI;
     |SI nModelo = 14;  nModelo14 = #199#0;  |FINSI;
     |SI nModelo = 15;  nModelo15 = #199#0;  |FINSI;
|FPRC;

|PROCESO PonModelosIVA;
     nElModelo = #111#1;
     |SI #0#44 ] 2014;
         |SI #111#1 = 310; |O #111#1 = 370;
             nElModelo = 303;
         |FINSI;
     |FINSI;

     |SI #0#44 ] 2014; |Y nElModelo = 300;
         |ACABA;
     |FINSI;

     |SI #0#44 [ 2017;
         |SI nElModelo = 322; |O nElModelo = 353;
             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ ModeloIVA;
     |SI nElModelo = 322;
         nElModelo = 353;
         |HAZ ModeloIVA;
     |FINSI;
|FPRC;

|DEFBUCLE agitab11;
     #111#1;
     ;
     #110#0, 000;
     #110#0, 899;
     ;
     NULL, PonModelosIVA;
|FIN;

|PROCESO IVA;
     |SI #0#49 = 1;
         |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

         aTitulo  = "PLANING REGIMEN DE IVA ";
         aPlaning = (("00" + #110#0) % -102) + "  " + #110#5;
     |FINSI;

     nModelo   = 0;
     nModelo1  = 0;
     nModelo2  = 0;
     nModelo3  = 0;
     nModelo4  = 0;
     nModelo5  = 0;
     nModelo6  = 0;
     nModelo7  = 0;
     nModelo8  = 0;
     nModelo9  = 0;
     nModelo10 = 0;
     nModelo11 = 0;
     nModelo12 = 0;
     nModelo13 = 0;
     nModelo14 = 0;
     nModelo15 = 0;

     |ABRE #199;
     |BUCLE agitab11;
     |CIERRA #199;

     |SI nModelo1 = 0;  |ACABA;  |FINSI;

     nDTributa = 01;
     nHTributa = 99;
     |SI #0#68 = "S"; nDTributa = #0#0; nHTributa = #0#1; |FINSI;
     nDIVA     = #110#0;
     nHIVA     = #110#0;
     nGraba    = 0;

     |ABRE #99;
     |SI #0#4 ! 0;
         |BUCLE agicen14;
     |SINO;
         |PARA nCampo = 6;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#4 = #0nCampo;
                   #0#5 = #0nCampo;
                   |BUCLE agicen14;
               |FINSI;
         |SIGUE;
         #0#4 = 0; #0#5 = 0;
     |FINSI;
     |CIERRA #99;

     |SI nGraba = 1;  |Y #0#49 = 1;
         |HAZ EmiteDocumento;
     |FINSI;
|FPRC;

|DEFBUCLE agitab10;
     #110#1;
     ;
     #0#2;
     #0#3;
     ;
     NULL, IVA;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ LeeUnidadBasico;

     aMes    = ("00" + #0#42) % -102;
     |SI #0#42 ] 13; aMes = "12"; |FINSI;

     aAlfa   = "01." + aMes + "." + #0#44; aDFecha = aAlfa;
     aAlfa   = "31." + aMes + "." + #0#44; aHFecha = aAlfa;

     |SI #0#42 = 3;
         aAlfa   = "01.01." + #0#44; aDFecha = aAlfa;
         aAlfa   = "31.03." + #0#44; aHFecha = aAlfa;
     |FINSI;

     |SI #0#42 = 6;
         aAlfa   = "01.04." + #0#44; aDFecha = aAlfa;
         aAlfa   = "31.06." + #0#44; aHFecha = aAlfa;
     |FINSI;

     |SI #0#42 = 9;
         aAlfa   = "01.07." + #0#44; aDFecha = aAlfa;
         aAlfa   = "31.09." + #0#44; aHFecha = aAlfa;
     |FINSI;

     |SI #0#42 = 12; |O #0#42 = 13;
         aAlfa   = "01.10." + #0#44; aDFecha = aAlfa;
         aAlfa   = "31.12." + #0#44; aHFecha = aAlfa;
     |FINSI;

     |SI #0#42 = 99; |O #0#42 = 13;
         aAlfa   = "01.01." + #0#44; aDFecha = aAlfa;
         aAlfa   = "31.12." + #0#44; aHFecha = aAlfa;
     |FINSI;

     nDPer = #0#42;
     nHPer = #0#42;
     |SI #0#42 = 13;
         nDPer = 12;
         nHPer = 99;
     |FINSI;

     |DBASS aBase;   |QBF aBase;

     |CARGADLL "agixl97.dll";
     |SI FSalida < 0;
         |MENAV "0000No tiene instalada el agixl97.dll, Consulte a su Distribuidor";
         |ACABA;
     |FINSI;
     |DESCARGADLL "agixl97.dll";

     |SUB_EJECUTA_NP ":basica/wordm000;CREALOS";

     |SI #0#49 = 1;
         aDocumento = "exce0001.xls";
         |SI #0#42 = 13; aDocumento = "exce0151.xls"; |FINSI;
     |FINSI;
     |SI #0#49 = 2;
         aDocumento = "exce0003.xls";
         |SI #0#42 = 13; aDocumento = "exce0153.xls"; |FINSI;
     |FINSI;

     aFichero = ("w38" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #99 aFichero;

     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

     |BUCLE agitab12;
     |BUCLE agitab10;

     |SI nSwHay = 1; |Y #0#49 = 2;
         |HAZ EmiteDocumento;
     |FINSI;

     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;
|FPRC;
