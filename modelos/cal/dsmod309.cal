|FICHEROS;
     dsmod309 #309,MANTE;

     dsmoc349 #349;

     dsmow056 #956;
     dsmow057 #957;
     dsmow058 #958;
     dsmow059 #959;
     dsmow070 #970;
     dsmow167 #967;
     dsmow069 #999,MANTE;

     dsmom032 #32;
     dsmom030 #30;

     :/contagen/def/canempre #101;
     :/contagen/def/camaniva #102;
     :/contagen/def/caivalin #103;
     :/contagen/def/caivaasi #104;
     :/contagen/def/caivam03 #105;

     :/basica/def/agicen14 #214;

     referen@   #800;
     espejo1@   #1300;
     &regisnif@ #709;
|FIN;

|VARIABLES;
     nForma            = 0;
     nCampo1           = 0;
     nCampo2           = 0;
     nCampo3           = 0;
     nCampo11          = 0;
     nCampo22          = 0;
     nCampo33          = 0;
     nPorce            = 0;
     nBaseImpo         = 0;
     nCuota            = 0;
     nCompl            = 0;
     nSwPasa           = 0;
     nDepar            = 0;
     nDPeriodo         = 0;
     nHPeriodo         = 0;
     nEjer             = 0;
     nCompensado       = 0;
     nChequeo          = 0;
     nHandle           = 0;

     aJustif           = "";
     aBase             = "";
     aMas              = "";
     aPathConta        = "";

     fFechaEmi         = @;

     &enConversor      = 0;
     &enPerConta       = 0;
     &eaLaMonEmp       = 0;
     &enControla       = 0;
     &enP2013          = 0;

     &enEjer           = 0;
     &enSwOpPar        = 0;
     &enPeriodoPar     = 0;
     &enSwPartido      = 0;
     &swerror          = 0;
     &eaCamp9_11       = "";
     &efCamp9_12       = @;
     &eaCamp9_73       = "";

     &nDPer349       = 0;
     &nHPer349       = 0;
     &nPer349        = 0;
     nBaseImpo349    = 0;
     nCuota349       = 0;
     nPorce349       = 0;
     &enPeriodo      = 0;
     &enActividad    = 0;
     &enTipoEntrada  = 0;
     nModelo         = 0;
     &eaNombreAct    = 0;
     &enModelo349    = 0;
     &enComplem      = 0;
     nPeriodo        = 0;
     nEntrada        = 0;
     nTp100          = 0;
     &eaCaptura      = "";
     &eaComunidad    = "";
     &eaComunero     = "";

     aMulDep         = "";
     nSwCuotaNeg     = 0;

     nMesCont        = 0;
     nEsRecti        = 0;
     nConcepto       = 0;
     nCtrl32         = 0;
     nSw             = 0;
     nNume1          = 0;
     nNume2          = 0;
     swPrimero       = 0;
     nSwBoton6       = 0;
     nSwBoton8       = 0;
     nSwBoton9       = 0;
     nSwBoton        = 0;
     &enDatosTec     = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO LeeElConcepto;
    nCtrl32 = 0;

    |DDEFECTO #30;
    #30#0 = nConcepto;
    |LEE 041#30=;
    |SI FSalida ! 0; |ACABA; |FINSI;

    |SI enP2013 = 1; nCtrl32 = 1; |ACABA; |FINSI;

    |DDEFECTO #32;
    #32#0 = #30#0;
    |LEE 041#32=;
    |SI FSalida ! 0; |ACABA; |FINSI;

    nCtrl32 = 1;
|FPRC;

|PROCESO Baja349;                    ||Correcto
     nModelo       = enModelo;
     enTipoEntrada = 3;
     enModelo      = 349;
     eaNombreAct   = #309#8;
     enModelo349   = 309;
     enPeriodo     = nPer349;
     |SUB_EJECUTA "dsmoc349";
     enModelo      = nModelo;
|FPRC;

|PROCESO GrabaIVASAnt;
     nSwEsta = 0;
     |PARA nCampo22 = 38;  |SI nCampo22 [ 56;  |HACIENDO nCampo22 = nCampo22 + 3;
           nCampo11 = nCampo22 - 1;
           nCampo33 = nCampo22 + 1;
           |SI #349nCampo22 = #105nCampo2;
               #349nCampo11 = #349nCampo11 + #105nCampo1;
               #349nCampo22 = #105nCampo2;
               #349nCampo33 = #349nCampo33 + #105nCampo3;
               nSwEsta = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwEsta = 0;
         |PARA nCampo22 = 38;  |SI nCampo22 [ 56;  |HACIENDO nCampo22 = nCampo22 + 3;
               nCampo11 = nCampo22 - 1;
               nCampo33 = nCampo22 + 1;
               |SI #349nCampo22 = 0; |Y #349nCampo11 = 0;  |Y #349nCampo33 = 0;
                   #349nCampo11 = #349nCampo11 + #105nCampo1;
                   #349nCampo22 = #105nCampo2;
                   #349nCampo33 = #349nCampo33 + #105nCampo3;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;
         #349#55 = #349#55 + #105nCampo1;
         #349#56 = 0;
         #349#57 = #349#57 + #105nCampo3;
     |FINSI;

     #349#27 = #349#37 + #349#40 + #349#43 + #349#46 + #349#49 + #349#52 + #349#55;

     nSwEsta = 0;
     |PARA nCampo22 = 11;  |SI nCampo22 [ 20;  |HACIENDO nCampo22 = nCampo22 + 3;
           nCampo11 = nCampo22 - 1;
           nCampo33 = nCampo22 + 1;
           |SI #349nCampo22 = #105nCampo2;
               #349nCampo11 = #349nCampo11 + #105nCampo1;
               #349nCampo22 = #105nCampo2;
               #349nCampo33 = #349nCampo33 + #105nCampo3;
               nSwEsta = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwEsta = 0;
         |PARA nCampo22 = 29;  |SI nCampo22 [ 35;  |HACIENDO nCampo22 = nCampo22 + 3;
               nCampo11 = nCampo22 - 1;
               nCampo33 = nCampo22 + 1;
               |SI #349nCampo22 = #105nCampo2;
                   #349nCampo11 = #349nCampo11 + #105nCampo1;
                   #349nCampo22 = #105nCampo2;
                   #349nCampo33 = #349nCampo33 + #105nCampo3;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;
         |PARA nCampo22 = 11;  |SI nCampo22 [ 20;  |HACIENDO nCampo22 = nCampo22 + 3;
               nCampo11 = nCampo22 - 1;
               nCampo33 = nCampo22 + 1;
               |SI #349nCampo22 = 0; |Y #349nCampo11 = 0;  |Y #349nCampo33 = 0;
                   #349nCampo11 = #349nCampo11 + #105nCampo1;
                   #349nCampo22 = #105nCampo2;
                   #349nCampo33 = #349nCampo33 + #105nCampo3;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;
         |PARA nCampo22 = 29;  |SI nCampo22 [ 35;  |HACIENDO nCampo22 = nCampo22 + 3;
               nCampo11 = nCampo22 - 1;
               nCampo33 = nCampo22 + 1;
               |SI #349nCampo22 = 0; |Y #349nCampo11 = 0;  |Y #349nCampo33 = 0;
                   #349nCampo11 = #349nCampo11 + #105nCampo1;
                   #349nCampo22 = #105nCampo2;
                   #349nCampo33 = #349nCampo33 + #105nCampo3;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;
         #349#34 = #349#34 + #105nCampo1;
         #349#35 = 0;
         #349#36 = #349#35 + #105nCampo3;
     |FINSI;

     #349#22 = #349#10 + #349#13 + #349#16 + #349#19 + #349#28 + #349#31 + #349#34;
|FPRC;

|PROCESO Graba349Rec;
     nModelo       = enModelo;
     enTipoEntrada = 95;
     enModelo      = 349;
     eaNombreAct   = #309#8;
     enModelo349   = 309;
     |SUB_EJECUTA "dsmoc349";

     eaCodNif = #102#14;
     |HAZ LeeNifs;

     |SI nMesCont < nDPer349; |ACABA; |FINSI;

     nTp100 = 0;
     |ABRE #103;
     #103#0 = #102#0;
     #103#1 = #102#1;
     #103#2 = 1;
     |LEE 041#103];
     |SI FSalida = 0; |Y #103#0 = #102#0; |Y #103#1 = #102#1;
         nTp100 = #103#7;
     |FINSI;
     |CIERRA #103;
     |SI #105#10 = 0; |Y #105#13 = 0; |Y #105#16 = 0; |Y #105#19 = 0;
        |Y #105#22 = 0; |Y #105#25 = 0; |Y #105#28 = 0;
          |SI #105#9 ! 0;
              #105#10 = nTp100;
              #105#11 = (#105#9 % #105#10) ! 2;
         |FINSI;
     |FINSI;

     |ABRE #349;
     #349#0  = enEmpresa;
     #349#1  = enEjer;
     #349#2  = nMesCont;
     #349#3  = enModelo;
     #349#4  = enComplem;
     #349#5  = enActividad;
     #349#6  = aTipo;
     #349#7  = #102#14;
     #349#25 = #105#5; || Ejercicio Declarado;
     #349#26 = #105#4;
     |LEE 101#349=;
     |SI FSalida ! 0;
         |DDEFECTO #349;
         #349#0  = enEmpresa;
         #349#1  = enEjer;
         #349#2  = nMesCont;
         #349#3  = enModelo;
         #349#4  = enComplem;
         #349#5  = enActividad;
         #349#6  = aTipo;
         #349#7  = #102#14;
         #349#25 = #105#5; || Ejercicio Declarado;
         #349#26 = #105#4;

         |SI #709#12 !  "   ";  #349#8  = #709#12;  |FINSI;
         #349#9  = #709#1;
         |GRABA 020#349b;
     |FINSI;

     |SI #349#6 = "AR"; |O #349#6 = "IR";
         nSwEsta = 0;
         |PARA nCampo2 = 10;  |SI nCampo2 [ 28;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |SI #105nCampo1 ! 0;  |O #105nCampo3 ! 0;
                   |HAZ GrabaIVASAnt;
               |FINSI;
         |SIGUE;
     |SINO;
         #349#22 = #105#6;
         #349#27 = #105#6;
     |FINSI;

     #349#24 = "-";

     |GRABA 020#349a;
     |LIBERA #349;
     |CIERRA #349;

     enModelo = nModelo;
|FPRC;

|PROCESO Graba349;
     nModelo       = enModelo;
     enTipoEntrada = 95;
     enModelo      = 349;
     eaNombreAct   = #309#8;
     enModelo349   = 309;
     enPeriodo     = nPer349;
     |SUB_EJECUTA "dsmoc349";

     eaCodNif = #102#14;
     |HAZ LeeNifs;

     |SI nMesCont < nDPer349; |ACABA; |FINSI;

     |ABRE #349;
     #349#0  = enEmpresa;
     #349#1  = enEjer;
     #349#2  = nMesCont;
     #349#3  = enModelo;
     #349#4  = enComplem;
     #349#5  = enActividad;
     #349#6  = aTipo;
     #349#7  = #102#14;
     #349#25 = 0;
     #349#26 = 0;
     |SI aTipo = "ER"; |O aTipo = "AR";  |O aTipo = "SR";
           |O aTipo = "IR"; |O aTipo = "HR";
           |O aTipo = "MR"; |O aTipo = "TR";
         |SI #105#5 ! 0;
             #349#25 = #105#5; || Ejercicio Declarado;
             #349#26 = #105#4;
         |FINSI;
     |FINSI;
     |LEE 101#349=;
     |SI FSalida ! 0;
         |DDEFECTO #349;
         #349#0  = enEmpresa;
         #349#1  = enEjer;
         #349#2  = nMesCont;
         #349#3  = enModelo;
         #349#4  = enComplem;
         #349#5  = enActividad;
         #349#6  = aTipo;
         #349#7  = #102#14;
         #349#25 = 0;
         #349#26 = 0;
        |SI aTipo = "ER"; |O aTipo = "AR";  |O aTipo = "SR";
            |O aTipo = "IR"; |O aTipo = "HR";
            |O aTipo = "MR"; |O aTipo = "TR";
             |SI #105#5 ! 0;
                 #349#25 = #105#5; || Ejercicio Declarado;
                 #349#26 = #105#4;
             |FINSI;
         |FINSI;
         |SI #709#12 !  "   ";  #349#8  = #709#12;  |FINSI;
         #349#9  = #709#1;
         |GRABA 020#349b;
     |FINSI;

     |SI #349#6 = "A "; |O #349#6 = "I ";
      |O #349#6 = "AR"; |O #349#6 = "IR";
         nSwEsta = 0;
         |PARA nCampo2 = 11;  |SI nCampo2 [ 20;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |SI #349nCampo2 = nPorce349;
                   #349nCampo1 = #349nCampo1 + nBaseImpo349;
                   #349nCampo2 = nPorce349;
                   #349nCampo3 = #349nCampo3 + nCuota349;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;

         |SI nSwEsta = 0;
             |PARA nCampo2 = 29;  |SI nCampo2 [ 35;  |HACIENDO nCampo2 = nCampo2 + 3;
                   nCampo1 = nCampo2 - 1;
                   nCampo3 = nCampo2 + 1;
                   |SI #349nCampo2 = nPorce349;
                       #349nCampo1 = #349nCampo1 + nBaseImpo349;
                       #349nCampo2 = nPorce349;
                       #349nCampo3 = #349nCampo3 + nCuota349;
                       nSwEsta = 1;
                       |SAL;
                   |FINSI;
             |SIGUE;
         |FINSI;

         |SI nSwEsta = 0;
             |PARA nCampo2 = 11;  |SI nCampo2 [ 20;  |HACIENDO nCampo2 = nCampo2 + 3;
                   nCampo1 = nCampo2 - 1;
                   nCampo3 = nCampo2 + 1;
                   |SI #349nCampo2 = 0; |Y #349nCampo1 = 0;  |Y #349nCampo3 = 0;
                       #349nCampo1 = #349nCampo1 + nBaseImpo349;
                       #349nCampo2 = nPorce349;
                       #349nCampo3 = #349nCampo3 + nCuota349;
                       nSwEsta = 1;
                       |SAL;
                   |FINSI;
              |SIGUE;
         |FINSI;

         |SI nSwEsta = 0;
             |PARA nCampo2 = 29;  |SI nCampo2 [ 35;  |HACIENDO nCampo2 = nCampo2 + 3;
                   nCampo1 = nCampo2 - 1;
                   nCampo3 = nCampo2 + 1;
                   |SI #349nCampo2 = 0; |Y #349nCampo1 = 0;  |Y #349nCampo3 = 0;
                       #349nCampo1 = #349nCampo1 + nBaseImpo349;
                       #349nCampo2 = nPorce349;
                       #349nCampo3 = #349nCampo3 + nCuota349;
                       nSwEsta = 1;
                       |SAL;
                   |FINSI;
              |SIGUE;
         |FINSI;

         |SI nSwEsta = 0;
             #349#34 = #349#34 + nBaseImpo349;
             #349#35 = 0;
             #349#36 = #349#36 + nCuota349;
         |FINSI;

         #349#22 = #349#10 + #349#13 + #349#16 + #349#19 + #349#28 + #349#31 + #349#34;
     |SINO;
         #349#22 = #349#22 + nBaseImpo349;
     |FINSI;

     |GRABA 020#349a;
     |LIBERA #349;
     |CIERRA #349;

     enModelo = nModelo;
|FPRC;

|PROCESO PonCasilla349;
     || Clave A

     |SI nEsRecti = 0;
         aTipo = "";
     |FINSI;

     |SI nPorce   = 0;  |Y nCuota349 = 0;  |ACABA;  |FINSI;
     |SI nEsRecti = 0;
         aTipo = "A";
         |SI enP2013 = 0;  aTipo = #32#2; |FINSI;
     |FINSI;

     aAlfa1 = aTipo % 101;
     |SI aAlfa1 ! "X";
         |HAZ Graba349;
     |FINSI;
|FPRC;

|| ..........................................................................
|PROCESO PonRecargo_Total;
     nSwEsta = 0;
     |PARA nCampo2 = 58;  |SI nCampo2 [ 67;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
           |SI #309nCampo2 = nPorce;
               #309nCampo1 = #309nCampo1 + nBaseImpo;
               #309nCampo2 = nPorce;
               #309nCampo3 = #309nCampo3 + nCuota;
               nSwEsta = 1;
                |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwEsta = 0;
         |PARA nCampo2 = 58;  |SI nCampo2 [ 67;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |SI #309nCampo2 = 0; |Y #309nCampo1 = 0;  |Y #309nCampo3 = 0;
                   #309nCampo1 = #309nCampo1 + nBaseImpo;
                   #309nCampo2 = nPorce;
                   #309nCampo3 = #309nCampo3 + nCuota;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;
         #309#66 = #309#66 + nBaseImpo;
         #309#67 = 0;
         #309#68 = #309#68 + nCuota;
     |FINSI;
|FPRC;

|PROCESO PonIVA_Total;
     nSwEsta = 0;
     |PARA nCampo2 = 49;  |SI nCampo2 [ 55;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
           |SI #309nCampo2 = nPorce;
               #309nCampo1 = #309nCampo1 + nBaseImpo;
               #309nCampo2 = nPorce;
               #309nCampo3 = #309nCampo3 + nCuota;
               nSwEsta = 1;
                |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwEsta = 0;
         |PARA nCampo2 = 49;  |SI nCampo2 [ 55;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |SI #309nCampo2 = 0; |Y #309nCampo1 = 0;  |Y #309nCampo3 = 0;
                   #309nCampo1 = #309nCampo1 + nBaseImpo;
                   #309nCampo2 = nPorce;
                   #309nCampo3 = #309nCampo3 + nCuota;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nSwEsta = 0;
         #309#54 = #309#54 + nBaseImpo;
         #309#55 = 0;
         #309#56 = #309#56 + nCuota;
     |FINSI;
|FPRC;

|PROCESO SumaIVA_Total;   || suma todos

     |PARA nCampo1 = 74; |SI nCampo1 [ 94; |HACIENDO nCampo1 = nCampo1 + 1;
           nCampo2 = nCampo1 - 26;
           #309nCampo2 = #309nCampo1;
     |SIGUE;

     |PARA nCampo22 = 96; |SI nCampo22 [ 102; |HACIENDO nCampo22 = nCampo22 + 3;
           nCampo11 = nCampo22 - 1;
           nCampo33 = nCampo22 + 1;
           nBaseImpo = #309nCampo11;
           nPorce    = #309nCampo22;
           nCuota    = #309nCampo33;
           |SI nBaseImpo ! 0; |O nCuota ! 0;
               |HAZ PonIVA_Total;
           |FINSI;
     |SIGUE;

     |PARA nCampo22 = 117; |SI nCampo22 [ 123; |HACIENDO nCampo22 = nCampo22 + 3;
           nCampo11 = nCampo22 - 1;
           nCampo33 = nCampo22 + 1;
           nBaseImpo = #309nCampo11;
           nPorce    = #309nCampo22;
           nCuota    = #309nCampo33;
           |SI nBaseImpo ! 0; |O nCuota ! 0;
               |HAZ PonIVA_Total;
           |FINSI;
     |SIGUE;

     |PARA nCampo22 = 105; |SI nCampo22 [ 114; |HACIENDO nCampo22 = nCampo22 + 3;
           nCampo11 = nCampo22 - 1;
           nCampo33 = nCampo22 + 1;
           nBaseImpo = #309nCampo11;
           nPorce    = #309nCampo22;
           nCuota    = #309nCampo33;
           |SI nBaseImpo ! 0; |O nCuota ! 0;
               |HAZ PonRecargo_Total;
           |FINSI;
     |SIGUE;

     |PARA nCampo22 = 126; |SI nCampo22 [ 135; |HACIENDO nCampo22 = nCampo22 + 3;
           nCampo11 = nCampo22 - 1;
           nCampo33 = nCampo22 + 1;
           nBaseImpo = #309nCampo11;
           nPorce    = #309nCampo22;
           nCuota    = #309nCampo33;
           |SI nBaseImpo ! 0; |O nCuota ! 0;
               |HAZ PonRecargo_Total;
           |FINSI;
     |SIGUE;
|FPRC;
|| ...................................................................

|PROCESO PonRecargo;

    |SI #32#2 = "A"; nNume1 =  84; nNume2 =  93; |FINSI;
    |SI #32#2 = "I"; nNume1 = 105; nNume2 = 114; |FINSI;
    |SI #32#2 = "X"; nNume1 = 126; nNume2 = 135; |FINSI;

     nSwEsta = 0;
     |PARA nCampo2 = nNume1;  |SI nCampo2 [ nNume2;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
           |SI #309nCampo2 = nPorce;
               #309nCampo1 = #309nCampo1 + nBaseImpo;
               #309nCampo2 = nPorce;
               #309nCampo3 = #309nCampo3 + nCuota;
               nSwEsta = 1;
                |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwEsta = 0;
         |PARA nCampo2 = nNume1;  |SI nCampo2 [ nNume2;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |SI #309nCampo2 = 0; |Y #309nCampo1 = 0;  |Y #309nCampo3 = 0;
                   #309nCampo1 = #309nCampo1 + nBaseImpo;
                   #309nCampo2 = nPorce;
                   #309nCampo3 = #309nCampo3 + nCuota;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #32#2= "A"; nNume1 =  92; |FINSI;
     |SI #32#2= "I"; nNume1 = 113; |FINSI;
     |SI #32#2= "X"; nNume1 = 134; |FINSI;
     |SI nSwEsta = 0;
                              #309nNume1 = #309nNume1 + nBaseImpo;
         nNume1 = nNume1 + 1; #309nNume1 = 0;
         nNume1 = nNume1 + 1; #309nNume1 = #309nNume1 + nCuota;
     |FINSI;
|FPRC;

|PROCESO PonIVA;
     |SI #32#2 = "A"; nNume1 =  75; nNume2 =  81; |FINSI;
     |SI #32#2 = "I"; nNume1 =  96; nNume2 = 102; |FINSI;
     |SI #32#2 = "X"; nNume1 = 117; nNume2 = 123; |FINSI;

     nSwEsta = 0;
     |PARA nCampo2 = nNume1;  |SI nCampo2 [ nNume2;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1 = nCampo2 - 1;
           nCampo3 = nCampo2 + 1;
           |SI #309nCampo2 = nPorce;
               #309nCampo1 = #309nCampo1 + nBaseImpo;
               #309nCampo2 = nPorce;
               #309nCampo3 = #309nCampo3 + nCuota;
               nSwEsta = 1;
                |SAL;
           |FINSI;
     |SIGUE;

     |SI nSwEsta = 0;
         |PARA nCampo2 = nNume1;  |SI nCampo2 [ nNume2;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |SI #309nCampo2 = 0; |Y #309nCampo1 = 0;  |Y #309nCampo3 = 0;
                   #309nCampo1 = #309nCampo1 + nBaseImpo;
                   #309nCampo2 = nPorce;
                   #309nCampo3 = #309nCampo3 + nCuota;
                   nSwEsta = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #32#2= "A"; nNume1 =  80; |FINSI;
     |SI #32#2= "I"; nNume1 = 101; |FINSI;
     |SI #32#2= "X"; nNume1 = 122; |FINSI;
     |SI nSwEsta = 0;
                              #309nNume1 = #309nNume1 + nBaseImpo;
         nNume1 = nNume1 + 1; #309nNume1 = 0;
         nNume1 = nNume1 + 1; #309nNume1 = #309nNume1 + nCuota;
     |FINSI;

     |SI #103#10 ! 0;
         nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
         nPorce    = #103#9;
         nCuota    = (#103#10 / enConversor) ! EURODBMOD;
         |HAZ PonRecargo;
     |FINSI;
|FPRC;

|PROCESO LeeLinea309;
    ||  |SI #103#5 = "N"; |ACABA;  |FINSI;  ||Paco Hellin 1243_1310

    aAlfa1 = #103#30; |QBF aAlfa1; |SI aAlfa1 = ""; #103#30 = #102#10; |FINSI;
    |SI aMulDep = "S";
        nDepar = #103#30;
        |SI nDepar = 0;  nDepar = 1;   |FINSI;
        |SI nChequeo = 0;
            |ABRE #214;
            #214#0 = #309#0;
            #214#1 = nDepar;
            |LEE 040#214=;
            |SI FSalida ! 0;  nDepar = 1;  |FINSI;
            |CIERRA #214;
        |FINSI;
        |SI #309#1 ! nDepar;  |ACABA;  |FINSI;
    |FINSI;

     nConcepto = #103#3;
     |HAZ LeeElConcepto;
     |SI nCtrl32 = 0; |ACABA; |FINSI;

     |SI #30#4 = "N";  |ACABA;  |FINSI;

     |SI enP2013 = 1;    || ... pase fijo hasta el 2013
         |SI #30#0 ! 611;  |Y #30#0 ! 615;  |Y #30#0 ! 619;  |Y #30#0 ! 622;
            |Y #30#0 ! 612;  |Y #30#0 ! 616;  |Y #30#0 ! 620;  |Y #30#0 ! 623;
              |ACABA;
         |FINSI;
     |FINSI;

     |SI nChequeo = 1;
         enControla = 1;
         |ERROR10;
         |ACABA;
     |FINSI;

     |SI enP2013 = 1;   || pase fijo hasta 2013

         #32#2 = "A";
         |SI #30#0 = 611;  |O #30#0 = 615;  |O #30#0 = 619;  |O #30#0 = 622;
             #309#28 = "X";
         |FINSI;

         |SI #30#0 = 612;  |O #30#0 = 616;  |O #30#0 = 620;  |O #30#0 = 623;
             #309#29 = "X";
         |FINSI;

         |SI #30#0 = 611;  |O #30#0 = 612;
             nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
             nPorce    = #103#9;
             |SI nPorce = 0;
                 nPorce = 4; |SI #102#4 ] "01.09.2012"; nPorce = 5.20; |FINSI;
             |FINSI;
             nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
             |HAZ PonRecargo;

             #103#10 = 0;
             nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
             nPorce    = #103#7;
             |SI nPorce = 0;
                 nPorce = 16; |SI #102#4 ] "01.07.2010"; nPorce = 18; |FINSI;
                              |SI #102#4 ] "01.09.2012"; nPorce = 21; |FINSI;
             |FINSI;
             nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
             nSwPasa   = 1;
             |HAZ PonIVA;
         |FINSI;

         |SI #30#0 = 615;  |O #30#0 = 616;  |O #30#0 = 620;  |O #30#0 = 623;
             nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
             nPorce    = #103#7;
             |SI nPorce = 0;
                 nPorce = 16; |SI #102#4 ] "01.07.2010"; nPorce = 18; |FINSI;
                              |SI #102#4 ] "01.09.2012"; nPorce = 21; |FINSI;
             |FINSI;
             nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
             nSwPasa   = 1;
             |HAZ PonIVA;
         |FINSI;

         |SI #30#0 = 619;  |O #30#0 = 622;
             nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
             nPorce    = #103#7;
             |SI nPorce = 0;
                 nPorce = 7; |SI #102#4 ] "01.07.2010"; nPorce = 8;  |FINSI;
                             |SI #102#4 ] "01.09.2012"; nPorce = 10; |FINSI;
             |FINSI;
             nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
             nSwPasa   = 1;
             |HAZ PonIVA;
         |FINSI;
   |SINO;
          |SI #32#3 = 1; #309#28 = "X"; |FINSI;
          |SI #32#3 = 2; #309#29 = "X"; |FINSI;
          |SI #32#3 = 3; #309#30 = "X"; |FINSI;
          |SI #32#3 = 4; #309#31 = "X"; |FINSI;
          |SI #32#3 = 5; #309#32 = "X"; |FINSI;
          |SI #32#3 = 6; #309#33 = "X"; |FINSI;

          |SI #309#2 ] 2016;
              |SI #32#3 ! 1; #309#28 = " "; |FINSI;
              |SI #32#3 ! 2; #309#29 = " "; |FINSI;
              |SI #32#3 ! 3; #309#30 = " "; |FINSI;
              |SI #32#3 ! 4; #309#31 = " "; |FINSI;
              |SI #32#3 ! 5; #309#32 = " "; |FINSI;
              |SI #32#3 ! 6; #309#33 = " "; |FINSI;
          |FINSI;

          |SI #30#24 = 3;
              nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
              nPorce    = #103#9;
              |SI nPorce = 0;
                  nPorce = 4; |SI #102#4 ] "01.09.2012"; nPorce = 5.20; |FINSI;
              |FINSI;
              nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
              |HAZ PonRecargo;

              #103#10 = 0;
              nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
              nPorce    = #103#7;
              |SI nPorce = 0;
                  nPorce = 16; |SI #102#4 ] "01.07.2010"; nPorce = 18; |FINSI;
                               |SI #102#4 ] "01.09.2012"; nPorce = 21; |FINSI;
              |FINSI;
              nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
              nSwPasa   = 1;

              nPorce349    = nPorce;
              nCuota349    = nCuota;
              nBaseImpo349 = nBaseImpo;

              |HAZ PonIVA;
          |FINSI;

          |SI #30#24 ! 3;  |Y #30#24 ! 9;
              nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
              nPorce    = #103#7;
              |SI nPorce = 0;
                  nPorce = 16; |SI #102#4 ] "01.07.2010"; nPorce = 18; |FINSI;
                               |SI #102#4 ] "01.09.2012"; nPorce = 21; |FINSI;
              |FINSI;
              nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
              nSwPasa   = 1;

              nPorce349    = nPorce;
              nCuota349    = nCuota;
              nBaseImpo349 = nBaseImpo;

              |HAZ PonIVA;
          |FINSI;

          |SI #30#24 = 9;
              nBaseImpo = (#103#6 / enConversor) ! EURODBMOD;
              nPorce    = #103#7;
              |SI nPorce = 0;
                  nPorce = 7; |SI #102#4 ] "01.07.2010"; nPorce = 8;  |FINSI;
                              |SI #102#4 ] "01.09.2012"; nPorce = 10; |FINSI;
              |FINSI;
              nCuota    = ((#103#6 % nPorce) / enConversor) ! EURODBMOD;
              nSwPasa   = 1;

              nPorce349    = nPorce;
              nCuota349    = nCuota;
              nBaseImpo349 = nBaseImpo;

              |HAZ PonIVA;
          |FINSI;
    |FINSI;

     |SI nPorce349 = 0;  |Y nCuota349 = 0;  |ACABA;  |FINSI;

     |HAZ PonCasilla349;
|FPRC;

|DEFBUCLE caivalin309;
     #103#1;
     ;
     #102#0, #102#1, 01;
     #102#0, #102#1, 99;
     ;
     NULL, LeeLinea309;
|FIN;

|PROCESO LeeCabecera309;
     |SI aMulDep ! "S";
         nDepar = #102#10;
         |SI nDepar = 0;  nDepar = 1;   |FINSI;

         |SI nChequeo = 0;
             |ABRE #214;
             #214#0 = #309#0;
             #214#1 = nDepar;
             |LEE 040#214=;
             |SI FSalida ! 0;  nDepar = 1;  |FINSI;
             |CIERRA #214;
         |FINSI;
         |SI #309#1 ! nDepar;  |ACABA;  |FINSI;
     |FINSI;

     |ABRE #105;
     |DDEFECTO #105;
     #105#0 = #102#0;
     #105#1 = #102#1;
     |LEE 040#105=;
     |CIERRA #105;

     nEsRecti = 0;
     nMesCont = #102#5;
     aTipo    = "";

     |SI #105#6 ! 0;   |Y #105#8 = 0;
         |SI enP2013 = 1;
             #30#0 = #102#29;
             |SI #30#0 = 611;  |O #30#0 = 615;  |O #30#0 = 619;  |O #30#0 = 622;
                |O #30#0 = 612;  |O #30#0 = 616;  |O #30#0 = 620;  |O #30#0 = 623;
                 aTipo = "AR";
             |FINSI;
         |SINO;
             nConcepto = #102#29;
             |HAZ LeeElConcepto;
             |SI nCtrl32 = 1; aTipo = #32#2 + "R"; |FINSI;
         |FINSI;

         |SI aTipo ! ""; |Y nChequeo = 0;
             aAlfa1 = aTipo % 101;

             nEsRecti = 1;
             |SI aAlfa1 ! "X";
                 |HAZ Graba349Rec;
             |FINSI;
         |FINSI;

     |FINSI;

     |BUCLE caivalin309;

     |SI enControla = 1;  |Y nChequeo = 1;
         |ERROR10;
     |FINSI;
     |LIBERA #102;
|FPRC;

|DEFBUCLE camaniva309;
     #102#1;
     5;
     00, 0000000000, nDPeriodo;
     99, 9999999999, nHPeriodo;
     be;
     NULL, LeeCabecera309;
|FIN;

|PROCESO Cambio2015_800;
     nSw = 0;
     |PARA nCampo1 = 74; |SI nCampo1 [ 136; |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2 = nCampo1 + 2;
           |SI #800nCampo1 ! 0; |O #800nCampo2 ! 0;
               nSw = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSw = 0;
         |PARA nCampo1 = 74; |SI nCampo1 [ 94; |HACIENDO nCampo1 = nCampo1 + 1;
               nCampo2 = nCampo1 - 26;
               #800nCampo1 = #800nCampo2;
         |SIGUE;
         |GRABA 020#800a;
     |FINSI;
|FPRC;

|PROCESO dsmod309C;
     |SI #800#3 > #309#3;  |ACABA;  |FINSI;

     |SI #309#3 = #800#3;  |Y  #309#4 = #800#4;  |Y #309#5 = #800#5;
         |ACABA;
     |FINSI;

     |HAZ Cambio2015_800;
|| ... Primera parte total
     |PARA nCampo2 = 49;  |SI nCampo2 [ 55;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 49;  |SI nCampo22 [ 55;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#48 = 0;  |Y #309#49 = 0;  |Y #309#50 = 0;
                   #309#48 = #309#48 - #800nCampo1;
                   #309#49 = #800nCampo2;
                   #309#50 = #309#50 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#51 = 0;  |Y #309#52 = 0;  |Y #309#53 = 0;
                   #309#51 = #309#51 - #800nCampo1;
                   #309#52 = #800nCampo2;
                   #309#53 = #309#53 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#54 = 0;  |Y #309#55 = 0;  |Y #309#56 = 0;
                   #309#54 = #309#54 - #800nCampo1;
                   #309#55 = #800nCampo2;
                   #309#56 = #309#56 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 58;  |SI nCampo2 [ 67;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 58;  |SI nCampo22 [ 67;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#57 = 0;  |Y #309#58 = 0;  |Y #309#59 = 0;
                   #309#57 = #309#57 - #800nCampo1;
                   #309#58 = #800nCampo2;
                   #309#59 = #309#59 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#60 = 0;  |Y #309#61 = 0;  |Y #309#62 = 0;
                   #309#60 = #309#60 - #800nCampo1;
                   #309#61 = #800nCampo2;
                   #309#62 = #309#62 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#63 = 0;  |Y #309#64 = 0;  |Y #309#65 = 0;
                   #309#63 = #309#63 - #800nCampo1;
                   #309#64 = #800nCampo2;
                   #309#65 = #309#65 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#66 = 0;  |Y #309#67 = 0;  |Y #309#68 = 0;
                   #309#66 = #309#66 - #800nCampo1;
                   #309#67 = #800nCampo2;
                   #309#68 = #309#68 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

|| ... Segunda Parte parte <Clave A>

     |PARA nCampo2 = 75;  |SI nCampo2 [ 81;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 75;  |SI nCampo22 [ 81;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#74 = 0;  |Y #309#75 = 0;  |Y #309#76 = 0;
                   #309#74 = #309#74 - #800nCampo1;
                   #309#75 = #800nCampo2;
                   #309#76 = #309#76 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#77 = 0;  |Y #309#78 = 0;  |Y #309#79 = 0;
                   #309#77 = #309#77 - #800nCampo1;
                   #309#78 = #800nCampo2;
                   #309#79 = #309#79 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#80 = 0;  |Y #309#81 = 0;  |Y #309#82 = 0;
                   #309#80 = #309#80 - #800nCampo1;
                   #309#81 = #800nCampo2;
                   #309#82 = #309#82 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 84;  |SI nCampo2 [ 93;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 84;  |SI nCampo22 [ 93;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#83 = 0;  |Y #309#84 = 0;  |Y #309#85 = 0;
                   #309#83 = #309#83 - #800nCampo1;
                   #309#84 = #800nCampo2;
                   #309#85 = #309#85 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#86 = 0;  |Y #309#87 = 0;  |Y #309#88 = 0;
                   #309#88 = #309#88 - #800nCampo1;
                   #309#89 = #800nCampo2;
                   #309#90 = #309#90 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#89 = 0;  |Y #309#90 = 0;  |Y #309#91 = 0;
                   #309#89 = #309#89 - #800nCampo1;
                   #309#90 = #800nCampo2;
                   #309#91 = #309#91 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#92 = 0;  |Y #309#93 = 0;  |Y #309#94 = 0;
                   #309#92 = #309#92 - #800nCampo1;
                   #309#93 = #800nCampo2;
                   #309#94 = #309#94 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

|| ... Tercera Parte parte <Clave I>
     |PARA nCampo2 = 96;  |SI nCampo2 [ 102; |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 96;  |SI nCampo22 [ 102;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#95 = 0;  |Y #309#96 = 0;  |Y #309#97 = 0;
                   #309#95 = #309#95 - #800nCampo1;
                   #309#96 = #800nCampo2;
                   #309#97 = #309#97 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#98 = 0;  |Y #309#99 = 0;  |Y #309#100 = 0;
                   #309#98 = #309#98 - #800nCampo1;
                   #309#99 = #800nCampo2;
                   #309#100 = #309#100 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#101 = 0;  |Y #309#102 = 0;  |Y #309#103 = 0;
                   #309#101 = #309#101 - #800nCampo1;
                   #309#102 = #800nCampo2;
                   #309#103 = #309#103 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 105;  |SI nCampo2 [ 114;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 105;  |SI nCampo22 [ 114;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#104 = 0;  |Y #309#105 = 0;  |Y #309#106 = 0;
                   #309#104 = #309#104 - #800nCampo1;
                   #309#105 = #800nCampo2;
                   #309#106 = #309#106 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#107 = 0;  |Y #309#108 = 0;  |Y #309#109 = 0;
                   #309#107 = #309#107 - #800nCampo1;
                   #309#108 = #800nCampo2;
                   #309#109 = #309#109 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#110 = 0;  |Y #309#111 = 0;  |Y #309#112 = 0;
                   #309#110 = #309#110 - #800nCampo1;
                   #309#111 = #800nCampo2;
                   #309#112 = #309#112 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#113 = 0;  |Y #309#114 = 0;  |Y #309#115 = 0;
                   #309#113 = #309#113 - #800nCampo1;
                   #309#114 = #800nCampo2;
                   #309#115 = #309#115 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

|| ... Tercera Parte parte <Clave X>
     |PARA nCampo2 = 117;  |SI nCampo2 [ 123; |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 117;  |SI nCampo22 [ 123;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#116 = 0;  |Y #309#117 = 0;  |Y #309#118 = 0;
                   #309#116 = #309#116 - #800nCampo1;
                   #309#117 = #800nCampo2;
                   #309#118 = #309#118 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#119 = 0;  |Y #309#120 = 0;  |Y #309#121 = 0;
                   #309#119 = #309#119 - #800nCampo1;
                   #309#120 = #800nCampo2;
                   #309#121 = #309#121 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#122 = 0;  |Y #309#123 = 0;  |Y #309#124 = 0;
                   #309#122 = #309#122 - #800nCampo1;
                   #309#123 = #800nCampo2;
                   #309#124 = #309#124 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

     |PARA nCampo2 = 126;  |SI nCampo2 [ 135;  |HACIENDO nCampo2 = nCampo2 + 3;
           nCampo1     = nCampo2 - 1;
           nCampo3     = nCampo2 + 1;
           nCompensado = 0;
           |PARA nCampo22 = 126;  |SI nCampo22 [ 135;  |HACIENDO nCampo22 = nCampo22 + 3;
                 nCampo11 = nCampo22 - 1;
                 nCampo33 = nCampo22 + 1;
                 |SI #309nCampo22 = #800nCampo2;
                     #309nCampo11 = #309nCampo11 - #800nCampo1;
                     #309nCampo33 = #309nCampo33 - #800nCampo3;
                     nCompensado = 1;
                     |SAL;
                 |FINSI;
           |SIGUE;

           |SI nCompensado = 0;
               |SI #309#125 = 0;  |Y #309#126 = 0;  |Y #309#127 = 0;
                   #309#125 = #309#125 - #800nCampo1;
                   #309#126 = #800nCampo2;
                   #309#127 = #309#127 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#128 = 0;  |Y #309#129 = 0;  |Y #309#130 = 0;
                   #309#128 = #309#128 - #800nCampo1;
                   #309#129 = #800nCampo2;
                   #309#130 = #309#130 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#131 = 0;  |Y #309#132 = 0;  |Y #309#133 = 0;
                   #309#131 = #309#131 - #800nCampo1;
                   #309#132 = #800nCampo2;
                   #309#133 = #309#133 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;

           |SI nCompensado = 0;
               |SI #309#134 = 0;  |Y #309#134 = 0;  |Y #309#136 = 0;
                   #309#134 = #309#134 - #800nCampo1;
                   #309#135 = #800nCampo2;
                   #309#136 = #309#136 - #800nCampo3;
                   nCompensado = 1;
               |FINSI;
           |FINSI;
     |SIGUE;

     |LIBERA #800;
|FPRC;

|DEFBUCLE dsmod309C;
     #800#1006;
     ;
     #309#0, #309#1, #309#2, 00, 00, 01;
     #309#0, #309#1, #309#2, 99, 99, 99;
     be;
     NULL, dsmod309C;
|FIN;

|PROCESO Compensa349;
||     |SI #1300#6 ! "A "; |Y #1300#6 ! "E ";  |ACABA;  |FINSI;

     #349#0  = #1300#0;
     #349#1  = #1300#1;
     #349#2  = nPer349;
     #349#3  = #1300#3;
     #349#4  = #1300#4;
     #349#5  = #1300#5;
     #349#6  = #1300#6;
     #349#7  = #1300#7;
     #349#25 = #1300#25;
     #349#26 = #1300#26;
     |LEE 101#349=;
     |SI FSalida = 0;
         #349#22 = #349#22 - #1300#22;

         |PARA nCampo2 = 11;  |SI nCampo2 [ 20;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |PARA nCampo22 = 11;  |SI nCampo22 [ 20;  |HACIENDO nCampo22 = nCampo22 + 3;
                      nCampo11 = nCampo22 - 1;
                      nCampo33 = nCampo22 + 1;
                      |SI #349nCampo22 = #1300nCampo2;
                          #349nCampo11 = #349nCampo11 - #1300nCampo1;
                          #349nCampo33 = #349nCampo33 - #1300nCampo3;
                          |SAL;
                      |FINSI;
                |SIGUE;
         |SIGUE;

         |PARA nCampo2 = 29;  |SI nCampo2 [ 35;  |HACIENDO nCampo2 = nCampo2 + 3;
               nCampo1 = nCampo2 - 1;
               nCampo3 = nCampo2 + 1;
               |PARA nCampo22 = 29;  |SI nCampo22 [ 35;  |HACIENDO nCampo22 = nCampo22 + 3;
                      nCampo11 = nCampo22 - 1;
                      nCampo33 = nCampo22 + 1;
                      |SI #349nCampo22 = #1300nCampo2;
                          #349nCampo11 = #349nCampo11 - #1300nCampo1;
                          #349nCampo33 = #349nCampo33 - #1300nCampo3;
                          |SAL;
                      |FINSI;
                |SIGUE;
         |SIGUE;

         |GRABA 020#349a;
         |LIBERA #349;
     |FINSI;
|FPRC;

|DEFBUCLE dsmoc349;
     #1300#1010;
     ;
     #309#0, #309#2, nPeriodo, 349, 0, #309#1, "A ", 0000, 00, "            ";
     #309#0, #309#2, nPeriodo, 349, 0, #309#1, "ZZ", 9999, 99, "zzzzzzzzzzzz";
     ;
     NULL, Compensa349;
|FIN;

|PROCESO BorraCero349;
||      |SI #349#6 ! "A "; |Y #349#6 ! "E ";  |ACABA;  |FINSI;
     |SI #349#22 < 0; nSwCuotaNeg = 1; |FINSI;
     |SI #349#22 ! 0;  |O #349#27 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#349a;
     |LIBERA #349;
|FPRC;

|DEFBUCLE dsmoc349Cero;
     #349#1;
     ;
     #309#0, #309#2, nDPer349, 349, 00, 00, "A ", 0000, 00, "            ";
     #309#0, #309#2, nHPer349, 349, 99, 99, "zz", 9999, 99, "zzzzzzzzzzzz";
     be;
     NULL, BorraCero349;
|FIN;

|PROCESO PaseContab;  |TIPO 0;
     |HAZ FinBoton6y8;
     |SI #309#11 = "X";
         |ACABA;
     |FINSI;

     eaCaptura    = "REGISTROS";
     enEmpresa    = #309#0;
     enEjer       = #309#2;
     enPeriodo    = #309#3;
     enModelo     = 309;
     enComplem    = #309#4;
     enActividad  = #309#1;
     eaNombreAct  = #309#8;
     enModelo349  = 309;
     enSwOpPar    = 0;
     |HAZ SituaEmpresa;
     |SI swerror = 1;
         eaCaptura = "MANUAL";
         |ACABA;
     |FINSI;

     |CONFI "0000NDesea realizar el pase desde Contabilidad.";
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     |SI enSwPartido = 0;
         aAlfa = #309#2;
         aAlfa = aAlfa % -102;
         nEjer = aAlfa;

         |ABRE #101;
         |SELECT #4#101;
         #101#2  = #309#0;
         #101#26 = nEjer;
         |LEE 040#101=;
         |SI FSalida ! 0;  |CIERRA #101;  |ACABA;   |FINSI;
         |CIERRA #101;

         |DBASS aPathConta;   |QBT aPathConta;
         aPathConta = aPathConta + "contagen/fich/" + (("00000" + #101#2) % -105) + #101#3 + "/";

         enEmpresa  = #101#2;
         enPerConta = #101#3;
         eaLaMonEmp = #101#28;
     |SINO;
         enPerConta = enPeriodoPar;
         eaLaMonEmp = "E";
     |FINSI;
     |HAZ Baja349;

     |HAZ EnConversor;
     |PATH_DAT #102 aPathConta;
     |PATH_DAT #103 aPathConta;
     |PATH_DAT #104 aPathConta;
     |PATH_DAT #105 aPathConta;

     |ABRE #caivaasi;
     |DDEFECTO #caivaasi;
     |LEE 000#caivaasi.p;
     |CIERRA #caivaasi;
     aMulDep = #caivaasi#132;

     |SI enEjer [ 2009;
          |SI #999#5 = "T";
              |SI #309#3 = 1;   nDPeriodo = 1;  nHPeriodo = 1;   nPer349 = 3; |FINSI;
              |SI #309#3 = 2;   nDPeriodo = 1;  nHPeriodo = 1;   nPer349 = 3; |FINSI;
              |SI #309#3 = 3;   nDPeriodo = 1;  nHPeriodo = 1;   nPer349 = 3; |FINSI;
              |SI #309#3 = 4;   nDPeriodo = 1;  nHPeriodo = 2;   nPer349 = 6; |FINSI;
              |SI #309#3 = 5;   nDPeriodo = 1;  nHPeriodo = 2;   nPer349 = 6; |FINSI;
              |SI #309#3 = 6;   nDPeriodo = 1;  nHPeriodo = 2;   nPer349 = 6; |FINSI;
              |SI #309#3 = 7;   nDPeriodo = 1;  nHPeriodo = 3;   nPer349 = 9; |FINSI;
              |SI #309#3 = 8;   nDPeriodo = 1;  nHPeriodo = 3;   nPer349 = 9; |FINSI;
              |SI #309#3 = 9;   nDPeriodo = 1;  nHPeriodo = 3;   nPer349 = 9; |FINSI;
              |SI #309#3 = 10;  nDPeriodo = 1;  nHPeriodo = 4;   nPer349 = 12;|FINSI;
              |SI #309#3 = 11;  nDPeriodo = 1;  nHPeriodo = 4;   nPer349 = 12;|FINSI;
              |SI #309#3 = 12;  nDPeriodo = 1;  nHPeriodo = 4;   nPer349 = 12;|FINSI;
          |SINO;
              |SI #309#3 = 1;   nDPeriodo = 1;  nHPeriodo = 1;   |FINSI;
              |SI #309#3 = 2;   nDPeriodo = 1;  nHPeriodo = 2;   |FINSI;
              |SI #309#3 = 3;   nDPeriodo = 1;  nHPeriodo = 3;   |FINSI;
              |SI #309#3 = 4;   nDPeriodo = 1;  nHPeriodo = 4;   |FINSI;
              |SI #309#3 = 5;   nDPeriodo = 1;  nHPeriodo = 5;   |FINSI;
              |SI #309#3 = 6;   nDPeriodo = 1;  nHPeriodo = 6;   |FINSI;
              |SI #309#3 = 7;   nDPeriodo = 1;  nHPeriodo = 7;   |FINSI;
              |SI #309#3 = 8;   nDPeriodo = 1;  nHPeriodo = 8;   |FINSI;
              |SI #309#3 = 9;   nDPeriodo = 1;  nHPeriodo = 9;   |FINSI;
              |SI #309#3 = 10;  nDPeriodo = 1;  nHPeriodo = 10;  |FINSI;
              |SI #309#3 = 11;  nDPeriodo = 1;  nHPeriodo = 11;  |FINSI;
              |SI #309#3 ] 12;  nDPeriodo = 1;  nHPeriodo = 12;  |FINSI;
              nPer349 = 12;
          |FINSI;
     |SINO;
          |SI #999#5 = "T";
              |SI #309#3 = 1;   nDPeriodo = 1;  nHPeriodo = 3;   nPer349 = 3; nDPer349 = 1; nHPer349 = 3; |FINSI;
              |SI #309#3 = 2;   nDPeriodo = 1;  nHPeriodo = 3;   nPer349 = 3; nDPer349 = 1; nHPer349 = 3; |FINSI;
              |SI #309#3 = 3;   nDPeriodo = 1;  nHPeriodo = 3;   nPer349 = 3; nDPer349 = 1; nHPer349 = 3; |FINSI;
              |SI #309#3 = 4;   nDPeriodo = 1;  nHPeriodo = 6;   nPer349 = 6; nDPer349 = 4; nHPer349 = 6; |FINSI;
              |SI #309#3 = 5;   nDPeriodo = 1;  nHPeriodo = 6;   nPer349 = 6; nDPer349 = 4; nHPer349 = 6; |FINSI;
              |SI #309#3 = 6;   nDPeriodo = 1;  nHPeriodo = 6;   nPer349 = 6; nDPer349 = 4; nHPer349 = 6; |FINSI;
              |SI #309#3 = 7;   nDPeriodo = 1;  nHPeriodo = 9;   nPer349 = 9; nDPer349 = 7; nHPer349 = 9; |FINSI;
              |SI #309#3 = 8;   nDPeriodo = 1;  nHPeriodo = 9;   nPer349 = 9; nDPer349 = 7; nHPer349 = 9; |FINSI;
              |SI #309#3 = 9;   nDPeriodo = 1;  nHPeriodo = 9;   nPer349 = 9; nDPer349 = 7; nHPer349 = 9; |FINSI;
              |SI #309#3 = 10;  nDPeriodo = 1;  nHPeriodo = 12;  nPer349 = 12;nDPer349 = 10; nHPer349 = 12; |FINSI;
              |SI #309#3 = 11;  nDPeriodo = 1;  nHPeriodo = 12;  nPer349 = 12;nDPer349 = 10; nHPer349 = 12; |FINSI;
              |SI #309#3 = 12;  nDPeriodo = 1;  nHPeriodo = 12;  nPer349 = 12;nDPer349 = 10; nHPer349 = 12; |FINSI;
          |SINO;
              |SI #309#3 = 1;   nDPeriodo = 1;  nHPeriodo = 1;   |FINSI;
              |SI #309#3 = 2;   nDPeriodo = 1;  nHPeriodo = 2;   |FINSI;
              |SI #309#3 = 3;   nDPeriodo = 1;  nHPeriodo = 3;   |FINSI;
              |SI #309#3 = 4;   nDPeriodo = 1;  nHPeriodo = 4;   |FINSI;
              |SI #309#3 = 5;   nDPeriodo = 1;  nHPeriodo = 5;   |FINSI;
              |SI #309#3 = 6;   nDPeriodo = 1;  nHPeriodo = 6;   |FINSI;
              |SI #309#3 = 7;   nDPeriodo = 1;  nHPeriodo = 7;   |FINSI;
              |SI #309#3 = 8;   nDPeriodo = 1;  nHPeriodo = 8;   |FINSI;
              |SI #309#3 = 9;   nDPeriodo = 1;  nHPeriodo = 9;   |FINSI;
              |SI #309#3 = 10;  nDPeriodo = 1;  nHPeriodo = 10;  |FINSI;
              |SI #309#3 = 11;  nDPeriodo = 1;  nHPeriodo = 11;  |FINSI;
              |SI #309#3 ] 12;  nDPeriodo = 1;  nHPeriodo = 12;  |FINSI;
              nDPer349 = nHPeriodo;
              nHPer349 = nHPeriodo;
              nPer349 = 12;
          |FINSI;
     |FINSI;

     |PDEFECTO #309, 48, 72;

     |PDEFECTO #309, 74, 137;

     nChequeo = 0;

     |ABRE #32;
     |ABRE #30;
     |BUCLE camaniva309;
     |CIERRA #30;
     |CIERRA #32;

     |SI enSwPartido = 1;
         enSwOpPar   = 2;
         |HAZ FinalPartido;
     |FINSI;

     |DBASE aPathModelo;  |QBT aPathModelo;
     aDef = aPathModelo + "def/dsmod309.mas";
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     |BUCLE dsmod309C;

     |DESCARGA_DEF #referen@;

     |SI enEjer [ 2009;
         |DBASE aPathModelo;  |QBT aPathModelo;  || Nuevo 349
         aDef = aPathModelo + "def/dsmoc349.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida = 0;
             |ABRE #349;
             |PARA nPeriodo = 1;  |SI nPeriodo < nPer349;  |HACIENDO nPeriodo = nPeriodo + 1;
                   |BUCLE dsmoc349;
             |SIGUE;
             |CIERRA #349;
         |FINSI;
         |DESCARGA_DEF #espejo1@;
     |FINSI;

     nSwCuotaNeg = 0;
     |BUCLE dsmoc349Cero;
     |SI nSwCuotaNeg = 1;
         |MENAV "    Aviso.! Existen registros del Modelo 349 con Cuota Negativa";
     |FINSI;

     enTipoEntrada = 96;
     |SUB_EJECUTA "dsmoc349";

     |HAZ SumaIVA_Total;
     #309#69 = #309#50 + #309#53 + #309#56 + #309#59 + #309#62 + #309#65 + #309#68;
     #309#71 = #309#69 - #309#70;

     |ABRE #214;
     #214#0 = #309#0;
     #214#1 = #309#1;
     |LEE 040#214=;
     |SI FSalida ! 0;  |DDEFECTO #214;  |FINSI;
     |CIERRA #214;

     |SI #214#7 = 9;  #309#22 = "X";  |FINSI;
     |SI #214#7 = 3;  #309#23 = "X";  |FINSI;
     |SI #214#7 = 1;  #309#24 = "X";  |FINSI;

     |SI #309#69 = 0;
         |CONFI "0000SSin movimientos en Contabilidad. Continuar";
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
     |C_M #309#6, 1, "N";
     |PINTA #309#18;

     nEntrada = (FEntrada / 100) ! 0;
     |SI nEntrada = 2;
         |GRABA 040#309a;
         |LIBERA #309;
         |LEE 101#309=;
     |FINSI;
     |PINTA #309#18;
|FPRC;

|PROCESO ControlaContab;  |TIPO 0;

     enEmpresa   = #999#0;
     enEjer      = #999#2;
     enSwOpPar   = 0;
     enModelo    = 309;
     enComplem   = 00;
     enActividad = #999#1;
     |HAZ SituaEmpresa;
     |SI enSwPartido = 0;
         aAlfa = #999#2;
         aAlfa = aAlfa % -102;
         nEjer = aAlfa;

         |ABRE #101;
         |SELECT #4#101;
         #101#2  = #999#0;
         #101#26 = nEjer;
         |LEE 040#101=;
         |SI FSalida ! 0;  |CIERRA #101;  |ACABA;   |FINSI;
         |CIERRA #101;

         |DBASS aPathConta;   |QBT aPathConta;
         aPathConta = aPathConta + "contagen/fich/" + (("00000" + #101#2) % -105) + #101#3 + "/";

         enEmpresa  = #101#2;
         enPerConta = #101#3;
         eaLaMonEmp = #101#28;
     |SINO;
         enPerConta = enPeriodoPar;
         eaLaMonEmp = "E";
     |FINSI;
     |HAZ EnConversor;

     |PATH_DAT #102 aPathConta;
     |PATH_DAT #103 aPathConta;
     |PATH_DAT #104 aPathConta;
     |PATH_DAT #105 aPathConta;
     |ABRE #caivaasi;
     |DDEFECTO #caivaasi;
     |LEE 000#caivaasi.p;
     |CIERRA #caivaasi;
     aMulDep = #caivaasi#132;

     |SI #999#5 = "T"; |Y #999#2 [ 2009;
         nDPeriodo = 1;  nHPeriodo = 4;
     |SINO;
         nDPeriodo = 1;  nHPeriodo = 12;
     |FINSI;

     nChequeo = 1;

     #309#0 = #999#0;
     #309#1 = #999#1;
     #309#2 = #999#2;

     |ABRE #32;
     |ABRE #30;
     |BUCLE camaniva309;
     |CIERRA #30;
     |CIERRA #32;
     |SI enSwPartido = 1;
         enSwOpPar   = 2;
         |HAZ FinalPartido;
     |FINSI;
|FPRC;

|PROCESO Periodo;
     |SI #999#5 = "M";
         nDPer349 = #309#3;
         nHPer349 = #309#3;
     |FINSI;

     |SI #999#5 = "T";
         |SI #309#3 ! 3;  |Y #309#3 ! 6;  |Y #309#3 ! 9; |Y #309#3 ! 12;
             |MENAV "     El Modelo lo tiene configurado Trimestral debe ser debe 3, 6, 9 o 12";
             |ERROR;
         |FINSI;
         |SI #309#3 = 3;  nDPer349 = 1;  nHPer349 = 3;  |FINSI;
         |SI #309#3 = 6;  nDPer349 = 4;  nHPer349 = 6;  |FINSI;
         |SI #309#3 = 9;  nDPer349 = 7;  nHPer349 = 9;  |FINSI;
         |SI #309#3 = 12; nDPer349 = 10; nHPer349 = 12; |FINSI;
         nPer349 = #309#3;
     |FINSI;

     |SI #999#5 = "A";
         |SI #309#3 ! 99;
             |MENAV "     El Modelo lo tiene configurado Anual debe ser debe 99";
             |ERROR;
         |FINSI;
         nDPer349 = 1; nHPer349 = 12;
         nPer349 = 12;
     |FINSI;
|FPRC;

|PROCESO Tipo1_309; |TIPO 1;
 nEntrada = (FEntrada / 100) ! 0;
 |SI nEntrada = 3;
     enEmpresa   = #309#0;
     enEjer      = #309#2;
     enPeriodo   = #309#3;
     enModelo    = 309;
     enComplem   = #309#4;
     enActividad = #309#1;
     |HAZ Baja349;
 |FINSI;
|FPRC;
|| //////////////////////////////////////////

|PROCESO Tipo7C5; |TIPO 7;
     |SI nSwBoton = 0;
         nBoton9 = -1;

        |SI #309#2 ] 2016;
            aAlfa = "LBOTON, <F7> Emision PDF pagina hacienda ";
        |SINO;
            aAlfa = "LBOTON, <F7> Emision Modelo papel  ";
        |FINSI;
        |CONTROL_SIMPLE 0, aAlfa, 2224, 2351, Boton6;
        nBoton6 = FSalida;

        |SI #309#2 [ 2018;
            |SI #309#2 ] 2016;
                aAlfa = "LBOTON, <F8> Presentacion Telematica";
            |SINO;
                aAlfa = "LBOTON, <F8> Emision Modelo internet";
            |FINSI;

            |CONTROL_SIMPLE 0, aAlfa, 2252, 2379, Boton8;
            nBoton8 = FSalida;
        |FINSI;

        |SI #309#2 ] 2019;
            |CONTROL_SIMPLE 0, "LBOTON, <F8>  Presentacion Telematica MANUAL", 2252, 2279, Boton8;
            nBoton8 = FSalida;

            |CONTROL_SIMPLE 0, "LBOTON, <F9>  Presentacion Telematica DIRECTA", 2352, 2379, Boton9;
            nBoton9 = FSalida;
        |FINSI;

        nSwBoton = 1;
     |FINSI;

     |ESTADO_CONTROL nBoton6,  "DISABLE";  nSwBoton6  = 0;
     |ESTADO_CONTROL nBoton8,  "DISABLE";  nSwBoton8  = 0;
     |ESTADO_CONTROL nBoton9,  "DISABLE";  nSwBoton9  = 0;

     nEntrada = (FEntrada / 100) ! 0;

     |SI nEntrada ] 2;
         |ESTADO_CONTROL nBoton6,  "ENABLE";  nSwBoton6  = 1;
         |ESTADO_CONTROL nBoton8,  "ENABLE";  nSwBoton8  = 1;

         |SI nBoton9 ! -1;
             |ESTADO_CONTROL nBoton9,  "ENABLE";  nSwBoton9  = 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO FinBoton6y8;
    |SI nSwBoton = 1;
       |FIN_CONTROL_WINDOWS nBoton6;
       |FIN_CONTROL_WINDOWS nBoton8;

       |SI nBoton9 ! -1;
           |FIN_CONTROL_WINDOWS nBoton9;
       |FINSI;
    |FINSI;
    nSwBoton = 0;
    |PULSATECLA;
|FPRC;

|PROCESO Tipo11C5; |TIPO 11;
     nTecla = FSalida;
     |HAZ FinBoton6y8;

     |SI nTecla = 15; |Y nSwBoton6 = 1;
         |HAZ Boton6;
     |FINSI;

     |SI nTecla = 16; |Y nSwBoton8 = 1;
         |HAZ Boton8;
     |FINSI;

     |SI nTecla = 17; |Y nSwBoton9 = 1;
         |HAZ Boton9;
     |FINSI;
|FPRC;

|PROCESO QuitaBoton;
     |ESTADO_CONTROL nBoton1, "HIDE";
     |ESTADO_CONTROL nBoton2, "HIDE";
     |ESTADO_CONTROL nBoton3, "HIDE";
     |ESTADO_CONTROL nBoton4, "HIDE";
     |ESTADO_CONTROL nBoton5, "HIDE";
     |ESTADO_CONTROL nBoton7, "HIDE";
|FPRC;

|PROCESO PonBoton;
     |ESTADO_CONTROL nBoton1, "SHOW";
     |ESTADO_CONTROL nBoton2, "SHOW";
     |ESTADO_CONTROL nBoton3, "SHOW";
     |ESTADO_CONTROL nBoton4, "SHOW";
     |ESTADO_CONTROL nBoton5, "SHOW";
     |ESTADO_CONTROL nBoton7, "SHOW";
|FPRC;

|PROCESO Boton1_2016;
     |C_V #956#3, 1, "S";
     |C_M #956#3, 1, "S";
     |C_P #956#2, 1, 2224;
     |PUSHV 0501 2380;
     #956#0 = #309#19;
     #956#1 = #309#20;
     #956#2 = #309#21;
     #956#3 = #309#137;
     |PINPA #0#956;
     |SI #309#2 < 2016;
         |C_V #956#3, 1, "N"; |C_M #956#3, 1, "N";
         |PINTA 1624, "Apellidos y Nombre               ";
         |PINTA 1824, "                                 ";
         |PINTA 1924, "Pais                             ";
         |C_P #956#2, 1, 2024;
         |PINTA 2124, "Pais                             ";
     |FINSI;
     |PINDA #0#956;
     |ENDATOS #1#956;
     |SI FSalida = 0;
         #309#19 = #956#0;
         #309#20 = #956#1;
         #309#21 = #956#2;
         #309#137= #956#3;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Boton1_2018;

     |PUSHV 0501 2380;
     #967#0 = #309#19;
     #967#1 = #309#20;
     #967#2 = #309#21;
     #967#3 = #309#137;
     #967#4 = #309#139;
     #967#5 = #309#140;
     #967#6 = #309#141;
     #967#7 = #309#142;
     |PINPA #0#967;
     |PINDA #0#967;
     |ENDATOS #1#967;
     |SI FSalida = 0;
         #309#19  = #967#0;
         #309#20  = #967#1;
         #309#21  = #967#2;
         #309#137 = #967#3;
         #309#139 = #967#4;
         #309#140 = #967#5;
         #309#141 = #967#6;
         #309#142 = #967#7;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Boton1;
     |HAZ QuitaBoton;

     |SI #309#2 < 2018;
         |HAZ Boton1_2016;
     |SINO;
         |HAZ Boton1_2018;
     |FINSI;

     |HAZ PonBoton;
|FPRC;


|PROCESO Boton2;
     |HAZ QuitaBoton;

     |PUSHV 0501 2380;
     #957#0 = #309#22;
     #957#1 = #309#23;
     #957#2 = #309#24;
     #957#3 = #309#25;
     #957#4 = #309#26;
     #957#5 = #309#27;
     |PINPA #0#957;
     |PINDA #0#957;
     |ENDATOS #1#957;
     |SI FSalida = 0;
         #309#22 = #957#0;
         #309#23 = #957#1;
         #309#24 = #957#2;
         #309#25 = #957#3;
         #309#26 = #957#4;
         #309#27 = #957#5;
     |FINSI;
     |POPV;

     |HAZ PonBoton;
|FPRC;

|PROCESO Boton3;
     |HAZ QuitaBoton;

     |PUSHV 0501 2380;
     #958#0 = #309#28;
     #958#1 = #309#29;
     #958#2 = #309#30;
     #958#3 = #309#31;
     #958#4 = #309#32;
     #958#5 = #309#33;
     |PINPA #0#958;
     |PINDA #0#958;
     |ENDATOS #1#958;
     |SI FSalida = 0;
         #309#28 = #958#0;
         #309#29 = #958#1;
         #309#30 = #958#2;
         #309#31 = #958#3;
         #309#32 = #958#4;
         #309#33 = #958#5;
     |FINSI;
     |POPV;

     |HAZ PonBoton;
|FPRC;

|PROCESO QuitaBoton11;
     |ESTADO_CONTROL nBoton11, "HIDE";
     |ESTADO_CONTROL nBoton12, "HIDE";
     |ESTADO_CONTROL nBoton13, "HIDE";
     |ESTADO_CONTROL nBoton14, "HIDE";
|FPRC;

|PROCESO PonBoton11;
     |ESTADO_CONTROL nBoton11, "SHOW";
     |ESTADO_CONTROL nBoton12, "SHOW";
     |ESTADO_CONTROL nBoton13, "SHOW";
     |ESTADO_CONTROL nBoton14, "SHOW";
|FPRC;

|PROCESO Boton11;

     |HAZ QuitaBoton11;

     |PUSHV 0501 2380;
     |PINPA #0#959;

     |C_M #959#4,  1, "N";  |C_V #959#4,  1, "N";
     |C_M #959#5,  1, "N";  |C_V #959#5,  1, "N";
     |C_M #959#6,  1, "N";  |C_V #959#6,  1, "N";
     |C_M #959#7,  1, "N";  |C_V #959#7,  1, "N";
     |C_M #959#8,  1, "N";  |C_V #959#8,  1, "N";
     |C_M #959#9,  1, "N";  |C_V #959#9,  1, "N";
     |C_M #959#10, 1, "N";  |C_V #959#10, 1, "N";
     |C_M #959#11, 1, "N";  |C_V #959#11, 1, "N";
     |C_M #959#12, 1, "N";  |C_V #959#12, 1, "N";
     |C_M #959#13, 1, "N";  |C_V #959#13, 1, "N";
     |C_M #959#14, 1, "N";  |C_V #959#14, 1, "N";
     |C_M #959#15, 1, "N";  |C_V #959#15, 1, "N";

     |C_M #959#0,  1, "S";  |C_V #959#0,  1, "S";  |C_P #959#0, 1, 1350;
     |C_M #959#1,  1, "S";  |C_V #959#1,  1, "S";  |C_P #959#1, 1, 1450;
     |C_M #959#2,  1, "S";  |C_V #959#2,  1, "S";  |C_P #959#2, 1, 1550;
     |C_M #959#3,  1, "S";  |C_V #959#3,  1, "S";  |C_P #959#3, 1, 1650;

     |SI #309#2 ] 2016;
         |C_M #959#15, 1, "S";  |C_V #959#15, 1, "S";  |C_P #959#15, 1, 1750;
     |SINO;
         |C_M #959#4,  1, "S";  |C_V #959#4,  1, "S";  |C_P #959#4, 1, 1750;
     |FINSI;

     |ATRI S;  |PINTA 1124, "Vehiculos                 ";  |ATRI s;
     |PINTA 1324, "Marca ..................: ";
     |PINTA 1424, "Tipo ...................: ";
     |PINTA 1524, "Modelo (Denom.Comercial): ";
     |PINTA 1624, "N.Identif. (Bastidor) .: ";
     |PINTA 1724, "Clasificacion ..........: ";

     #959#0  = #309#34;
     #959#1  = #309#35;
     #959#2  = #309#36;
     #959#3  = #309#37;
     #959#4  = #309#38;
     #959#15 = #309#38;
     |PINDA #0#959;
     |ENDATOS #1#959;
     |SI FSalida = 0;
         #309#34 = #959#0;
         #309#35 = #959#1;
         #309#36 = #959#2;
         #309#37 = #959#3;
         |SI #309#2 ] 2016;
             #309#38 = #959#15;
         |SINO;
             #309#38 = #959#4;
         |FINSI;
     |FINSI;

     |POPV;

     |HAZ PonBoton11;
|FPRC;

|PROCESO Boton12;

     |HAZ QuitaBoton11;

     |PUSHV 0501 2380;
     |PINPA #0#959;

     |C_M #959#0,  1, "N";  |C_V #959#0,  1, "N";
     |C_M #959#1,  1, "N";  |C_V #959#1,  1, "N";
     |C_M #959#2,  1, "N";  |C_V #959#2,  1, "N";
     |C_M #959#3,  1, "N";  |C_V #959#3,  1, "N";
     |C_M #959#4,  1, "N";  |C_V #959#4,  1, "N";
     |C_M #959#8,  1, "N";  |C_V #959#8,  1, "N";
     |C_M #959#9,  1, "N";  |C_V #959#9,  1, "N";
     |C_M #959#10, 1, "N";  |C_V #959#10, 1, "N";
     |C_M #959#11, 1, "N";  |C_V #959#11, 1, "N";
     |C_M #959#12, 1, "N";  |C_V #959#12, 1, "N";
     |C_M #959#13, 1, "N";  |C_V #959#13, 1, "N";
     |C_M #959#14, 1, "N";  |C_V #959#14, 1, "N";
     |C_M #959#15, 1, "N";  |C_V #959#15, 1, "N";

     |C_M #959#5,  1, "S";  |C_V #959#5,  1, "S";  |C_P #959#5, 1, 1350;
     |C_M #959#6,  1, "S";  |C_V #959#6,  1, "S";  |C_P #959#6, 1, 1450;
     |C_M #959#7,  1, "S";  |C_V #959#7,  1, "S";  |C_P #959#7, 1, 1550;
     |SI #309#2 ] 2016;
         |C_M #959#14, 1, "S";  |C_V #959#14, 1, "S";  |C_P #959#14,1, 1650;
     |SINO;
         |C_M #959#8,  1, "S";  |C_V #959#8,  1, "S";  |C_P #959#8, 1, 1650;
     |FINSI;

     |ATRI S;  |PINTA 1124, "Embarcaciones             ";  |ATRI s;
     |PINTA 1324, "Fabricante .............: ";
     |PINTA 1424, "Tipo-Modelo ............: ";
     |PINTA 1524, "N.Identif. (Construc.) : ";
     |PINTA 1624, "Eslora maxima ..........: ";

     #959#5  = #309#39;
     #959#6  = #309#40;
     #959#7  = #309#41;
     #959#8  = #309#42;
     #959#14 = #309#138;
     aAlfa   = #309#42; |QBF aAlfa;
     |SI #309#138 = 0; |Y aAlfa ! "";
         #959#14 = #309#42;
     |FINSI;
     |PINDA #0#959;
     |ENDATOS #1#959;
     |SI FSalida = 0;
         #309#39  = #959#5;
         #309#40  = #959#6;
         #309#41  = #959#7;
         #309#42  = #959#8;
         #309#138 = #959#14;
     |FINSI;

     |POPV;

     |HAZ PonBoton11;
|FPRC;

|PROCESO Boton13;

     |HAZ QuitaBoton11;

     |PUSHV 0501 2380;
     |PINPA #0#959;

     |C_M #959#0,  1, "N";  |C_V #959#0,  1, "N";
     |C_M #959#1,  1, "N";  |C_V #959#1,  1, "N";
     |C_M #959#2,  1, "N";  |C_V #959#2,  1, "N";
     |C_M #959#3,  1, "N";  |C_V #959#3,  1, "N";
     |C_M #959#4,  1, "N";  |C_V #959#4,  1, "N";
     |C_M #959#5,  1, "N";  |C_V #959#5,  1, "N";
     |C_M #959#6,  1, "N";  |C_V #959#6,  1, "N";
     |C_M #959#7,  1, "N";  |C_V #959#7,  1, "N";
     |C_M #959#8,  1, "N";  |C_V #959#8,  1, "N";
     |C_M #959#14, 1, "N";  |C_V #959#14, 1, "N";
     |C_M #959#15, 1, "N";  |C_V #959#15, 1, "N";

     |C_M #959#9,  1, "S";  |C_V #959#9,  1, "S";  |C_P #959#9,  1, 1350;
     |C_M #959#10, 1, "S";  |C_V #959#10, 1, "S";  |C_P #959#10, 1, 1450;
     |C_M #959#11, 1, "S";  |C_V #959#11, 1, "S";  |C_P #959#11, 1, 1550;
     |C_M #959#12, 1, "S";  |C_V #959#12, 1, "S";  |C_P #959#12, 1, 1650;
     |C_M #959#13, 1, "S";  |C_V #959#13, 1, "S";  |C_P #959#13, 1, 1750;

     |ATRI S;  |PINTA 1124, "Aeronaves                 ";  |ATRI s;
     |PINTA 1324, "Fabricante .............: ";
     |PINTA 1424, "Marca-Tipo-Modelo ......: ";
     |PINTA 1524, "N. Serie ..............: ";
     |PINTA 1624, "Ao Fabricacion ........: ";
     |PINTA 1724, "Peso maximo despegue Kg.: ";

     #959#9  = #309#43;
     #959#10 = #309#44;
     #959#11 = #309#45;
     #959#12 = #309#46;
     #959#13 = #309#47;
     |PINDA #0#959;
     |ENDATOS #1#959;
     |SI FSalida = 0;
         #309#43 = #959#9;
         #309#44 = #959#10;
         #309#45 = #959#11;
         #309#46 = #959#12;
         #309#47 = #959#13;
     |FINSI;

     |POPV;

     |HAZ PonBoton11;
|FPRC;

|PROCESO Boton4;

     |HAZ QuitaBoton;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Vehiculos ", 1124, 1279, Boton11;
     nBoton11 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Embarcaciones ", 1324, 1479, Boton12;
     nBoton12 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Aeronaves ", 1524, 1679, Boton13;
     nBoton13 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Salir", 2124, 2279, Boton7;
     nBoton14 = FSalida;

     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  |HAZ Boton11;  |FINSI;
         |SI aTecla = aF3;  |HAZ Boton12;  |FINSI;
         |SI aTecla = aF4;  |HAZ Boton13;  |FINSI;
         |SI aTecla = aEsc; |SAL;          |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBoton11;
     |FIN_CONTROL_WINDOWS nBoton12;
     |FIN_CONTROL_WINDOWS nBoton13;
     |FIN_CONTROL_WINDOWS nBoton14;

     |PULSATECLA;

     |HAZ PonBoton;
|FPRC;

|PROCESO Boton5;

     |HAZ QuitaBoton;

     |PUSHV 0501 2380;
     |PARA nCampo1 = 0;  |SI nCampo1 [ 24;  |HACIENDO nCampo1 = nCampo1 + 1;
           nCampo2 = nCampo1 + 48;
           #970nCampo1 = #309nCampo2;
     |SIGUE;

     |PARA nCampo1 = 25;  |SI nCampo1 [ 87;  |HACIENDO nCampo1 = nCampo1 + 1;
           nCampo2 = nCampo1 + 49;
           #970nCampo1 = #309nCampo2;
     |SIGUE;

     |C_M #970#22, 1, "S";  |C_V #970#22, 1, "S";
     |C_M #970#24, 1, "S";  |C_V #970#24, 1, "S";
     |SI #309#4 = 0;
         #970#22 = 0;
         |C_M #970#22, 1, "N";  |C_V #970#22, 1, "N";
         |C_M #970#24, 1, "N";  |C_V #970#24, 1, "N";
     |FINSI;

     enEmpresa    = #309#0;
     enEjer       = #309#2;
     enActividad  = #309#1;
     enPeriodo    = #309#3;
     enComplem    = #309#4;
     enModelo     = 309;
     eaNombreAct  = #309#8;
     enModelo349  = 309;

     |PINPA #0#970;
     |PINDA #0#970;
     |ENDATOS #1#970;
     |SI FSalida = 0;
         |PARA nCampo1 = 0;  |SI nCampo1 [ 24;  |HACIENDO nCampo1 = nCampo1 + 1;
               nCampo2 = nCampo1 + 48;
               #309nCampo2 = #970nCampo1;
         |SIGUE;
         |PARA nCampo1 = 25;  |SI nCampo1 [ 87;  |HACIENDO nCampo1 = nCampo1 + 1;
               nCampo2 = nCampo1 + 49;
               #309nCampo2 = #970nCampo1;
         |SIGUE;
     |FINSI;
     |POPV;

     |HAZ PonBoton;
|FPRC;

|PROCESO Boton6y8;
    |LEE 101#309=;
    eaCamp9_11  = #309#11;
    efCamp9_12  = #309#12;
    eaCamp9_73  = #309#73;

    #309#11 = "";
    #309#12 = "01.01.0000";
    #309#73 = "";
    |GRABA 020#309a;
    |LIBERA #309;

    enEmpresa   = #309#0;
    enActividad = #309#1;
    enEjer      = #309#2;
    enPeriodo   = #309#3;
    enComplem   = #309#4;
    enDatosTec  = #309#5;

    |SUB_EJECUTA_NP "dsmoy309";

    |LEE 101#309=;
    #309#11 = eaCamp9_11;
    #309#12 = efCamp9_12;
    #309#73 = eaCamp9_73;
    |GRABA 020#309a;
    |LIBERA #309;

    |LEE 101#309=;
    |HAZ Refresco;

    |ERROR;
    |PTEC 809;
|FPRC;

|PROCESO Boton6;
    eaOpcion = "1";
    |HAZ Boton6y8;
|FPRC;

|PROCESO Boton8;
    eaOpcion = "3";
    |HAZ Boton6y8;
|FPRC;

|PROCESO Boton9;
    eaOpcion = "6";
    |HAZ Boton6y8;
|FPRC;



|PROCESO Boton7;
     |PTEC  806;
|FPRC;

|PROCESO CargaComple;
     |ABRE #800;
     |PARA nCompl = #309#4 - 1;  |SI nCompl ] 0;  |HACIENDO nCompl = nCompl - 1;
           #800#0 = #309#0;
           #800#1 = #309#1;
           #800#2 = #309#2;
           #800#3 = #309#3;
           #800#4 = nCompl;
           #800#5 = #309#5;
           |LEE 040#800=;
           |SI FSalida = 0;
               |PARA nCampo1 = 19;  |SI nCampo1 [ 47;  |HACIENDO nCampo1 = nCampo1 + 1;
                     #309nCampo1 = #800nCampo1;
               |SIGUE;
               #309#70 = #800#71;
               |SI #800#73 ! "                ";
                   #309#72 = #800#73;
               |FINSI;
               |SAL;
           |FINSI;
     |SIGUE;
     |CIERRA #800;
|FPRC;

|PROCESO Cambio2015;
     nSw = 0;
     |PARA nCampo1 = 74; |SI nCampo1 [ 136; |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2 = nCampo1 + 2;
           |SI #309nCampo1 ! 0; |O #309nCampo2 ! 0;
               nSw = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nSw = 0;
         |PARA nCampo1 = 74; |SI nCampo1 [ 94; |HACIENDO nCampo1 = nCampo1 + 1;
               nCampo2 = nCampo1 - 26;
               #309nCampo1 = #309nCampo2;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     nEntrada = (FEntrada / 100) ! 0;

     |SI nEntrada = 2; aAlfa1 = "modificar."; |FINSI;
     |SI nEntrada = 3; aAlfa1 = "dar de baja."; |FINSI;
     |SI #309#13 = "X";  |O #309#16 = "X";
         aAlfa1 = "     Modelo Remesado o Archivado. No se puede " + aAlfa1;
         |MENAV aAlfa1;
         |ERROR;
         |ACABA;
     |FINSI;

     nForma = 0 +. 1;
     |SI nForma < 0;  |ACABA;  |FINSI;

     |SI nEntrada = 2;
         |HAZ Cambio2015;
     |FINSI;

     |PUSHV 0501 2380;

     |BLANCO 1023 2380;
     |CUADRO 1023 2380;

     |SI #309#4 ! 0;
         |SI #309#9 = " ";
             |DBASE aBase;  |QBF aBase;
             aMas = aBase + "def/dsmod309.mas";
             |CARGA_DEF aMas, referen@;
             |SI FSalida = 0;
                 |HAZ CargaComple;
                 |DESCARGA_DEF #referen@;
             |FINSI;
         |FINSI;

         |SI #309#72 = "             ";
             |PINTA 1525, "Introduzca numero justificante declaracion anterior";

             E_inf   = "";
             E_sup   = "13";

             aJustif = "";
             aJustif = 1745 ? 1;
             #309#72 = aJustif;

             |BLANCO 1023 2380;
             |CUADRO 1023 2380;
         |FINSI;
     |FINSI;

     |SI #309#2 < 2018;
         aAlfa = "LBOTON, <F2> Transmitente ";
     |SINO;
         aAlfa = "LBOTON, <F2> Transmitente/Adjudicatario";
     |FINSI;

     |CONTROL_SIMPLE 0, aAlfa, 1124, 1279, Boton1;
      nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Situacion Tributaria", 1324, 1479, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Hecho Imponible", 1524, 1679, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Datos Tecnicos ", 1724, 1879, Boton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Liquidacion ", 1924, 2079, Boton5;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Salir", 2124, 2279, Boton7;
     nBoton7 = FSalida;

     aF2  = &255 + "824";
     aF3  = &255 + "825";
     aF4  = &255 + "826";
     aF5  = &255 + "827";
     aF6  = &255 + "828";
     aF7  = &255 + "829";
     aF8  = &255 + "830";
     aEsc = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  |HAZ Boton1;  |FINSI;
         |SI aTecla = aF3;  |HAZ Boton2;  |FINSI;
         |SI aTecla = aF4;  |HAZ Boton3;  |FINSI;
         |SI aTecla = aF5;  |HAZ Boton4;  |FINSI;
         |SI aTecla = aF6;  |HAZ Boton5;  |FINSI;
         |SI aTecla = aEsc; |SAL;         |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton7;

     |PULSATECLA;

     |POPV;

     aAlfa = #309#36;  |QBF aAlfa;
     |SI aAlfa ! "";  #309#6 = #309#36;  |FINSI;

     aAlfa = #309#40;  |QBF aAlfa;
     |SI aAlfa ! "";  #309#6 = #309#40;  |FINSI;

     aAlfa = #309#44;  |QBF aAlfa;
     |SI aAlfa ! "";  #309#6 = #309#44;  |FINSI;

     #309#7  = #999#3;
     #309#8  = #999#4;
     #309#9  = "X";
     #309#10 = ~;
     #309#18 = #309#71;

     |PINTA #309#6;
     |PINTA #309#9;
     |PINTA #309#71;
|FPRC;
