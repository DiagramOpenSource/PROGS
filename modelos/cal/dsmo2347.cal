|FICHEROS;
     dsmo1347 #1;
     dsmo2347 #2;
     dsmo4347 #44,MANTE;
     dsmom072 #72;    || Importe Cobros efectivo

     dsmow143 #943,MANTE;

     &regisnif@ #709;
     reflejo@   #22;
|FIN;

|VARIABLES;
     nMax        = 0;
     nMaxCobro   = 0;
     nCampo1     = 0;
     nCampo2     = 0;
     nCampo3     = 0;
     nNegativo   = 0;
     aMenav      = "";
     aPathModelo = "";
     aDef        = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     nEjerCobro  = 0;
     nEjer       = 0;
     nSwSolo     = 0;
     nOpera      = 0;
     nModo       = 0;
     nPara1      = 0;
     nPara2      = 0;

     &enOpCobro  = 0;
     &enEjerCob  = 0;
     &enImpoCob  = 0;
     &eaClCobro  = "";
     &eaNifCobro = "";
     &eaSeguro   = "";
     &eaArrenda  = "";
     &eaOp1      = "";
     &eaOp2      = "";
     &eaOp5      = "";
     &enSwCobro  = 0;

     nInkey      = 0;
     nImporteA   = 0;
     nSw         = 0;
     nSi         = 0;
     &eSwDniH    = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO PintaClave;
     |ATRI S;
     |PINTA 0835, eaClave347;
     |SI eaClave347 = "A";  |PINTA 0839, #1#6;   |PINTA 0845, #1#7;  |FINSI;
     |SI eaClave347 = "B";  |PINTA 0839, #1#8;   |PINTA 0845, #1#9;  |FINSI;
     |SI eaClave347 = "C";  |PINTA 0839, #1#10;  |PINTA 0845, #1#11; |FINSI;
     |SI eaClave347 = "D";  |PINTA 0839, #1#12;  |PINTA 0845, #1#13; |FINSI;
     |SI eaClave347 = "E";  |PINTA 0839, #1#14;  |PINTA 0845, #1#15; |FINSI;
     |SI eaClave347 = "F";  |PINTA 0839, #1#20;  |PINTA 0845, #1#21; |FINSI;
     |SI eaClave347 = "G";  |PINTA 0839, #1#22;  |PINTA 0845, #1#23; |FINSI;
     |ATRI s;
|FPRC;

|PROCESO Arrendamiento;

     |SI FSalida = 3; |Y #2#6 = "B"; |Y #2#9 = "S";
         |ERROR;
     |FINSI;

     |SI #2#6 = "B";  |Y #2#9 = "S";
         |MENAV "     Introduzca el Arrendamiento por el Apartado de Arrendamientos.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 7;
     eaCodNif  = #2#7;
     |HAZ LeeNifs;

     #2#11 = #709#1;   |PINTA #2#11;
|FPRC;


|RUTINA ClaveBaja44;
     #44#0  = #2#0;
     #44#1  = #2#1;
     #44#2  = #2#2;
     #44#3  = #2#3;
     #44#4  = #2#4;
     #44#5  = #2#5;
     #44#6  = #2#6;
     #44#7  = #2#7;
     #44#12 = #2#25;
     #44#13 = #2#26;
     #44#8  = #2#8;
     #44#9  = #2#9;
     #44#14 = #2#27;
     #44#10 = nEjerCobro;
|FRUT;

|RUTINA ClaveAlta44;
     #44#0  = #2#0;
     #44#1  = #2#1;
     #44#2  = #2#2;
     #44#3  = #2#3;
     #44#4  = #2#4;
     #44#5  = #2#5;
     #44#6  = #2#6;
     #44#7  = #2#7;
     #44#12 = #2#25;
     #44#13 = #2#26;
     #44#8  = #2#8;
     #44#9  = #2#9;
     #44#14 = #2#27;
     #44#10 = 2008;
|FRUT;

|PROCESO SumayBorra;
   |SI nOpera = 1;
       |SI #2#6 = "A"; #1#6 = #1#6 - 1; |FINSI;
       |SI #2#6 = "B"; #1#8 = #1#8 - 1; |FINSI;
       |BORRA 020#44a;
   |FINSI;
   |SI nOpera = 0;
       |SI #44#11 < nMaxCobro;
           #44#11 = 0;
           |SI #2#6 = "A"; #1#6 = #1#6 - 1; |FINSI;
           |SI #2#6 = "B"; #1#8 = #1#8 - 1; |FINSI;
           |BORRA 020#44a;
       |FINSI;
       #2#15 = #2#15 + #44#11;
   |FINSI;
   |LIBERA #44;
|FPRC;

|DEFBUCLE SumayBorra;
   #44#1;
   ;
   #2#0,  #2#1, #2#2, #2#3, #2#4, #2#5, #2#6 , #2#7, #2#25, #2#26, #2#8, #2#9, #2#27, nEjerCobro;
   #2#0,  #2#1, #2#2, #2#3, #2#4, #2#5, #2#6 , #2#7, #2#25, #2#26, #2#8, #2#9, #2#27, 2008;
   be;
   NULL, SumayBorra;
|FIN;

|PROCESO Metalico;
    |CIERRA #44;
    |ENTLINEAL #1#44, -11, 2, 21,0, ClaveBaja44,ClaveAlta44;

    #2#15 = 0; nOpera = 0; |BUCLE SumayBorra;

    |ENTLINEAL #1#44, -11, 7, 21,0, ClaveBaja44,ClaveAlta44;
|FPRC;

|PROCESO Tipo7C410; |TIPO 7;
   nModo = (FEntrada / 100) ! 0;
   |SI nModo = 1;
       |SI #44#10 > 2999;
           #44#10 = nEjer - 1; |PINTA #44#10;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Tipo11C410; |TIPO 11;
   nInkey = FSalida;
   |SI FSalida = 10; |Y #44#1 > 2010; |Y #44#10 ! 0;
       enEjerCob  = #44#10;
       enImpoCob  = #44#11;
       eaClCobro  = #44#6;
       eaNifCobro = #44#7;
       eaSeguro   = #44#8;
       eaArrenda  = #44#9;
       eaOp1      = #44#12;
       eaOp2      = #44#13;
       eaOp5      = #44#14;
       enOpCobro  = 1;
       |SUB_EJECUTA_NP "dsmom072";
       #44#11 = enImpoCob;
       |SI #44#11 < nMaxCobro;
           #44#11 = 0;
       |FINSI;
       |PINTA #44#11;
       |ERROR;
   |FINSI;
|FPRC;

|PROCESO Tipo7C411; |TIPO 7;
     |SI #44#1 > 2010;
        enEjerCob = #44#10;
        |HAZ eImporteCobro;
        #44#11 = enImpoCob;
        |SI #44#11 < nMaxCobro; |O enSwCobro = 1;
            #44#11 = 0;
        |FINSI;
        |PINTA #44#11;
     |FINSI;
|FPRC;

|PROCESO ImporteCobro; |TIPO 0;
     nInkey = FSalida;

     enEjerCob  = #44#10;
     enImpoCob  = #44#11;
     eaClCobro  = #44#6;
     eaNifCobro = #44#7;
     eaSeguro   = #44#8;
     eaOp1      = #44#12;
     eaOp2      = #44#13;
     eaOp5      = #44#14;

     |SI nInkey = 10; |Y #44#1 > 2010;
         enOpCobro = 0;
         |SUB_EJECUTA_NP "dsmom072";
         #44#11 = enImpoCob;
         |VETE PintaCobro;
     |FINSI;

     |SI #44#11 < nMaxCobro;
         aMenav = "    NEl Importe es inferior a " + nMaxCobro + "es correcto";
         |CONFI aMenav;
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #44#11 ! 0;
         |HAZ eActCobro;
     |FINSI;

|ET PintaCobro;
     |SI #44#11 < nMaxCobro;
         #44#11 = 0; |PINTA #44#11;
     |FINSI;
     nEjer = #44#10;
|FPRC;

|PROCESO Modi2011;

     aAlfa = "S"; aAlfa1 = "N";
     |SI #2#6  ! "A"; |Y #2#6 ! "B"; aAlfa = "N"; |FINSI;
     |SI #2#6  = "B"; |O #2#6 = "A";
         |SI #2#8 = "N"; |Y #2#9 = "N"; aAlfa1 = "S"; |FINSI;
     |FINSI;
     aAlfa2 = aAlfa;
     |SI enEjer ] 2012; |Y #2#6 = "A";  aAlfa2 = "N"; |FINSI;

     |C_V #943#1,  1, aAlfa2; |C_M #943#1,  1, aAlfa2;
     |C_V #943#3,  1, aAlfa2; |C_M #943#3,  1, aAlfa2;
     |C_V #943#2,  1, aAlfa;
     |C_V #943#8,  1, aAlfa; |C_M #943#8,  1, aAlfa1;
     |C_V #943#9,  1, aAlfa; |C_M #943#9,  1, aAlfa1;
     |C_V #943#10, 1, aAlfa; |C_M #943#10, 1, aAlfa1;
     |C_V #943#11, 1, aAlfa; |C_M #943#11, 1, aAlfa1;

     |C_M #943#0,  1, "N";
     |C_M #943#4,  1, "S";
     |C_M #943#5,  1, "S";
     |C_M #943#6,  1, "S";
     |C_M #943#7,  1, "S";
     |C_M #943#12, 1, "N";  |C_V #943#12, 1, "N";
     |C_M #943#13, 1, "N";  |C_V #943#13, 1, "N";
     |SI nSwSolo = 1;
         |C_M #943#1, 1, "N";
         |C_M #943#4, 1, "N";
         |C_M #943#5, 1, "N";
         |C_M #943#6, 1, "N";
         |C_M #943#7, 1, "N";
     |SINO;
         |SI #2#27 = "S";
             |C_M #943#0, 1, "S";
             |C_M #943#4, 1, "N";
             |C_M #943#5, 1, "N";
             |C_M #943#6, 1, "N";
             |C_M #943#7, 1, "N";
             |C_M #943#12, 1, "S";  |C_V #943#12, 1, "S";
             |SI #2#1 ] 2018;
                 |C_M #943#13, 1, "S";  |C_V #943#13, 1, "S";
             |FINSI;
        |FINSI;
     |FINSI;

     |SI eSwDniH = 1;
         |C_M #943#4, 0, aAlfa;
         |SI aAlfa = "S";
             |C_M #943#0,  1, "S";
             |C_M #943#4,  1, "N";
             |C_M #943#5,  1, "N";
             |C_M #943#6,  1, "N";
             |C_M #943#7,  1, "N";
         |FINSI;
         |C_M #943#8, 0, aAlfa;
         |SI aAlfa = "S";
             |C_M #943#2,  1, "S";
             |C_M #943#8,  1, "N";
             |C_M #943#9,  1, "N";
             |C_M #943#10, 1, "N";
             |C_M #943#11, 1, "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Sacar2011;
     |DDEFECTO #943;

     nNegativo = #2#12;
     |SI nNegativo < 0; nNegativo = - #2#12; |FINSI;
     |SI nNegativo < nMax;
         |SI enEjer < 2012; |O #2#6 ! "B";
             #2#13 = 0;
         |FINSI;
     |FINSI;

     |PARA nPara1 = 12; |SI nPara1 [ 23; |HACIENDO nPara1 = nPara1 + 1;
           nPara2 = nPara1 - 12;
           #943nPara2 = #2nPara1;
     |SIGUE;
     #943#12 = #2#28;
     #943#13 = #2#30;

     |PINPA #0#943;
     |SI #2#6 ! "A"; |Y #2#6 ! "B";
         |BLANCO 1325 2280;
         |CUADRO 0925 1380;
     |FINSI;
     |SI enEjer ] 2012;
         |SI #2#6 = "A";
             |BLANCO 1625 2280;
             |CUADRO 0925 1680;
         |FINSI;
     |FINSI;

     |HAZ Modi2011;
     |SI #2#27 = "N";
         |PINTA 0958, "컴컴컴컴컴컴컴컴컴컴";
         |PINTA 1058, "                     ";
     |SINO;
         |ATRI S; |PINTA 0958, "RECC Ant: 컴컴컴컴컴"; |ATRI 0;
     |FINSI;
     |SI #2#1 < 2018;
         |PINTA 0958, "컴컴컴컴컴컴컴컴컴컴";
     |FINSI;
     |PINDA #0#943;

     |SI enEjer ] 2012;
         |SI #2#6 = "B";
             |PINPA #0#44;
             |ENTLINEAL #1#44, -11, 7, 21,1, ClaveBaja44,ClaveAlta44;
         |FINSI;
     |SINO;
         |SI #2#6 = "A"; |O #2#6 = "B";
             |PINPA #0#44;
             |ENTLINEAL #1#44, -11, 7, 21,1, ClaveBaja44,ClaveAlta44;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO ImporteW143; |TIPO 0;
      |SI eSwDniH = 0;
          |SI #2#27 = "N";
              #943#0 = #943#4 + #943#5 + #943#6  + #943#7;  |PINTA #943#0;
          |FINSI;
          #943#2 = #943#8 + #943#9 + #943#10 + #943#11; |PINTA #943#2;
      |FINSI;

      |SI FSalida = 2; |ACABA; |FINSI;

      nSw = 0;
      |SI Campo = 7; nSw = 1; |FINSI;
      |SI Campo < 7; |Y FSalida = 1; nSw = 1; |FINSI;
      |SI nSw = 1;
          |HAZ Modi2011;

          aMenav = "";
          nNegativo = #943#0;
          |SI nNegativo < 0; nNegativo = - #943#0; |FINSI;
          |SI nNegativo < nMax;
              aMenav = "     Introduzca Importe igual o superior a " + nMax + ".(sin signo)";
          |FINSI;
          |SI enEjer ] 2012;
              |SI #2#6 = "B";
                  |SI #943#0 = 0;
                      aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                  |FINSI;
              |FINSI;
          |SINO;
              |SI #2#6 = "A"; |O #2#6 = "B";
                  |SI #943#0 = 0;
                      aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                  |FINSI;
              |FINSI;
          |FINSI;

          |SI aMenav ! "";
              nSw = 0;
              nSi = 0;
              |SI #2#6 = "B"; |O #2#6 = "A"; nSi = 1; |FINSI;

              |SI nSi = 1;  |Y enEjer ] 2012; |Y #943#0 ! 0;

                  aMenav = "    NImporte inferior a " + nMax + ". Es Correcto";
                  |CONFI aMenav;
                  |SI FSalida = 0; nSw = 1; |FINSI;
              |SINO;
                  |MENAV aMenav;
              |FINSI;

              |SI #943#0 ! 0;
                  |SI nSw = 0; |ERROR; |FINSI;
                  |ACABA;
              |SINO;
                  |C_M #943#1,  1, "N";
                  |C_M #943#8,  1, "N";
                  |C_M #943#9,  1, "N";
                  |C_M #943#10, 1, "N";
                  |C_M #943#11, 1, "N";
                  |C_M #943#12, 1, "N";
                  |C_M #943#13, 1, "N";
                  |SI enEjer ] 2012;
                      |SI #2#6 ! "B";
                          |ERROR;
                      |FINSI;
                  |SINO;
                      |SI #2#6 ! "A"; |Y #2#6 ! "B";
                          |ERROR;
                      |FINSI;
                  |FINSI;
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C12w143; |TIPO 0;
     |C_M #943#12, 0, aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;
     |SI FSalida = 10;
         #943#12 = #943#0; |PINTA #943#12;
     |FINSI;
|FPRC;

|PROCESO Tipo12w143; |TIPO 12;
|FPRC;

|PROCESO Tipo7C1w143; |TIPO 7;

    |SI #2#6 = "A"; |Y enEjer ] 2012; |ACABA; |FINSI;

    enEjerCob  = enEjer;
    eaClCobro  = #2#6;
    eaNifCobro = #2#7;
    eaSeguro   = #2#8;
    eaArrenda  = #2#9;
    eaOp1      = #2#25;
    eaOp2      = #2#26;
    eaOp5      = #2#27;
    |HAZ eImporteCobro;
    #943#1 = enImpoCob;
    |PINTA #943#1;

    |SI #943#0 = 0;
        #943#1 = 0;
       |C_V #943#1,0,aAlfa1;
       |SI aAlfa1 = "S";
           |PINTA #943#1;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO Tipo0C1w143; |TIPO 0;
   |C_M #943Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;

   |SI #943#1 < nMaxCobro; || |Y #943#1 ! 0;
       aMenav = "    SEl Importe es inferior a " + nMaxCobro + ". Continuar";
       |CONFI aMenav;
       |SI FSalida ! 0;
           #943#1 = 0; |PINTA #943#1;
           |ERROR;
           |ACABA;
       |FINSI;
   |FINSI;

    enEjerCob  = enEjer;
    enImpoCob  = #943#1;
    eaClCobro  = #2#6;
    eaNifCobro = #2#7;
    eaSeguro   = #2#8;
    eaArrenda  = #2#9;
    eaOp1      = #2#25;
    eaOp2      = #2#26;
    eaOp5      = #2#27;
    |HAZ eActCobro;

    |SI #943#1 < nMaxCobro;
        #943#1 = 0; |PINTA #943#1;
    |FINSI;
|FPRC;

|PROCESO Tipo7C3w143; |TIPO 7;
   |C_M #943Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;

   |HAZ Metalico;
   #943#3 = #2#15;  |PINTA #943#3;
|FPRC;

|PROCESO Tipo0C3w143; |TIPO 0;
   #943#3 = #2#15;
   |C_V #943#3,0,aAlfa1;
   |SI aAlfa1 = "S"; |PINTA #943#3; |FINSI;
|FPRC;

|PROCESO Pedir2011;

     nSwSolo = 0;
     |SI #2#6 = "B"; |Y #2#9 = "S";
          nSwSolo = 1;
     |FINSI;
     |HAZ Sacar2011;

     |SI nSwSolo = 1;
         |ATRI I; |PINTA 0926, "Introduzca Importes en Metalico Ejercicios Anteriores"; |ATRI 0;
     |FINSI;

     |ENDATOS #2#943;
     |SI FSalida = 0;
         |SI eSwDniH = 0;
             |SI #2#27 = "N";
                 #943#0 = #943#4 + #943#5 + #943#6  + #943#7;
             |FINSI;
             #943#2 = #943#8 + #943#9 + #943#10 + #943#11;
         |SINO;
             #943#4  = 0; #943#5  = 0;
             #943#6  = 0; #943#7  = 0;
             #943#8  = 0; #943#9  = 0;
             #943#10 = 0; #943#11 = 0;
         |FINSI;
         |PARA nPara1 = 12; |SI nPara1 [ 23; |HACIENDO nPara1 = nPara1 + 1;
               nPara2 = nPara1 - 12;
               #2nPara1 = #943nPara2;
         |SIGUE;
         #2#28 = #943#12;
         #2#30 = #943#13;
     |FINSI;
|FPRC;

|PROCESO Importe;
     |HAZ LeeEURODBMOD;

     nEjer = #2#1;
     nEjerCobro = #2#1 - 1;
     |SI EURODBMOD = 0;
         nMax = 500000;
         |SI #2#6 = "C";                 nMax = 50000;   |FINSI;
         |SI #2#6 = "B"; |Y #2#9 = "S";  nMax = 0;       |FINSI;
         |SI #2#6 = "F";                 nMax = 0;       |FINSI;
         |SI #2#6 = "G";                 nMax = 0;       |FINSI;
         nMaxCobro = 1000000;
     |SINO;
         nMax = 3005.06;
         |SI #2#6 = "C";                 nMax = 300.51;  |FINSI;
         |SI #2#6 = "B"; |Y #2#9 = "S";  nMax = 0;       |FINSI;
         |SI #2#6 = "F";                 nMax = 0;       |FINSI;
         |SI #2#6 = "G";                 nMax = 0;       |FINSI;
         nMaxCobro = 6000.01;
     |FINSI;

     |C_M #2#12, 0, aAlfa;
     |SI aAlfa = "S";
         nNegativo = #2#12;
         |SI nNegativo < 0; |Y #2#1 > 2010; nNegativo = - #2#12; |FINSI;

         aMenav = "";
         |SI nNegativo < nMax;
             aMenav = "     Introduzca Importe igual o superior a " + nMax;
         |FINSI;
         |SI enEjer ] 2012;
             |SI #2#6 = "B";
                 |SI #2#12 = 0; |Y #2#1 ] 2010;
                     aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                 |FINSI;
             |FINSI;
         |SINO;
             |SI #2#6 = "A"; |O #2#6 = "B";
                 |SI #2#12 = 0; |Y #2#1 ] 2010;
                     aMenav=  "    Introducir solo Importes en Metalico Ejercicios Anteriores";
                 |FINSI;
             |FINSI;
         |FINSI;
         |SI aMenav ! "";
             |MENAV aMenav;
             |SI #2#12 ! 0; |O #2#1 < 2010;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #2#6 ! "A";  |Y #2#6 ! "B"; |Y #2#1 < 2011;
         |ACABA;
     |FINSI;

     |SI #2#1 < 2008; |ACABA; |FINSI;

|SI #2#1 ] 2010;

     |PUSHV 0925 2380;
     |SI #2#1 = 2010;
         |BLANCO 1025 2280;
         |CUADRO 1025 1480;

         nSwSolo = 0;
         |SI #2#12 = 0;
             nSwSolo = 1;
         |SINO;
             |SI #2#6 = "B"; |Y #2#9 = "S";
                 nSwSolo = 1;
             |FINSI;
         |FINSI;

         |SI nSwSolo = 1;
             |ATRI I; |PINTA 1026, "Introduzca Importes en Metalico Ejercicios Anteriores"; |ATRI 0;
         |FINSI;

         |PINTA 1126, "Percibido en metalico Ejercicio Actual...:            ";
         |PINTA 1226, "Percibido en metalico Ejer.Anteriores....:            ";
         |PINTA 1326, "Percibido por transmisiones sujetas a IVA:            ";

         |PINPA #0#44;

         E_inf = "-999999999.?EURO";
         E_sup = "9999999999";

         |SI #2#12 < nMax; #2#13 = 0; |FINSI;
         nCampo1  = #2#13;   |PINTA 1169, #2#13;
         nCampo3  = #2#15;   |PINTA 1269, #2#15;
         nCampo2  = #2#14;   |PINTA 1369, #2#14;
         |ENTLINEAL #1#44, -11, 7, 21,1, ClaveBaja44,ClaveAlta44;

         |ET nCampo1;
             E_inf = "-999999999.?EURO";
             E_sup = "9999999999";
             #2#15 = nCampo3;  |PINTA 1269, #2#15;
             |SI #2#12 ] nMax; |Y nSwSolo = 0;
                 nCampo1 = 1169 ? 1;
                 |SI FSalida = 1;  |VETE Abajo;    |FINSI;
                 |SI FSalida = 7;  |VETE Abajo;    |FINSI;
                 #2#13 = nCampo1;  |PINTA 1169, #2#13;
                 |SI #2#13 < nMaxCobro; |Y #2#13 ! 0;
                     aMenav = "     Introduzca Importe igual o superior a " + nMaxCobro;
                     |MENAV aMenav;
                     #2#13 = 0; |PINTA 1169, #2#13;
                     |VETE nCampo1;
                 |FINSI;
             |FINSI;

         |ET nCampo3;
             #2#14 = nCampo2;  |PINTA 1369, #2#14;
             nCampo3 = 1269 ? 1;
             |SI FSalida = 1;  |VETE Abajo;    |FINSI;
             |SI FSalida = 2;  |VETE nCampo1;  |FINSI;
             |SI FSalida = 7;  |VETE Abajo;    |FINSI;
             nCampo3  = #2#15;   |PINTA 1269, #2#15;
             |SI FSalida = 3;  |VETE nCampo2;    |FINSI;
             |HAZ Metalico;
             nCampo3  = #2#15;   |PINTA 1269, #2#15;

         |ET nCampo2;
             E_inf = "-999999999.?EURO";
             E_sup = "9999999999";
             |SI #2#12 ] nMax; |Y nSwSolo = 0;
                 nCampo2 = 1369 ? 1;
                 |SI FSalida = 2;  |VETE nCampo3;  |FINSI;
                 #2#14 = nCampo2;  |PINTA 1369, #2#14;
             |FINSI;

         |ET Abajo;
             #2#13 = nCampo1;  |PINTA 1169, #2#13;
             #2#15 = nCampo3;  |PINTA 1269, #2#15;
             #2#14 = nCampo2;  |PINTA 1369, #2#14;

     |SINO;

         |HAZ Pedir2011;

     |FINSI;
     |POPV;
     |BLIN 4;

     |SI #2#1 > 2010; |PINTA #2#12; |FINSI;

|SINO;

     |PUSHV 1325 1680;
     |BLANCO 1325 1680;
     |CUADRO 1325 1680;

     |PINTA 1426, "Percibido en metalico ...................:            ";
     |PINTA 1526, "Percibido por transmisiones sujetas a IVA:            ";

     E_inf = "-999999999.?EURO";
     E_sup = "9999999999";

     nCampo1  = #2#13;   |PINTA 1469, #2#13;
     nCampo2  = #2#14;   |PINTA 1569, #2#14;

     |ET nCampo1_2008;
         E_inf = "-999999999.?EURO";
         E_sup = "9999999999";
         nCampo1 = 1469 ? 1;
         |SI FSalida = 1;  |VETE Abajo_2008;    |FINSI;
         |SI FSalida = 7;  |VETE Abajo_2008;    |FINSI;

     |ET nCampo2_2008;
         E_inf = "-999999999.?EURO";
         E_sup = "9999999999";
         nCampo2 = 1569 ? 1;
         |SI FSalida = 2;  |VETE nCampo1_2008;  |FINSI;

     |ET Abajo_2008;
         #2#13 = nCampo1;  |PINTA 1469, #2#13;
         #2#14 = nCampo2;  |PINTA 1569, #2#14;

     |POPV;
     |BLIN 4;
|FINSI;

|FPRC;

|PROCESO Tipo7C207;  |TIPO 7;
     aMenav = "    <F2>Calcular NIF/Comprobacion CIF; <F3> Consultar por GRID; <F4>Importes";
     |SI #2#6 = "B"; |Y #2#9 = "S";
         aMenav = "    F2-Calcular NIF/Comp. CIF; F3-Consultar GRID; F4-Importes, F5-Metalico Ej.Ant";
     |FINSI;
     |MENSA aMenav;
|FPRC;

|PROCESO Tipo2C410; |TIPO 2;
  |SI #2#6 = "A";  #1#6 = #1#6 +. 1; |FINSI;
  |SI #2#6 = "B";  #1#8 = #1#8 +. 1; |FINSI;
|FPRC;

|PROCESO Tipo2mo2347;  |TIPO 2;
     |SI #2#6 = "A";
         |SI #2#12 ! 0; |O #2#30 ! 0;
             #1#6 = #1#6 +. 1;
         |FINSI;
         #1#7 = #1#7 +. #2#12;
     |FINSI;

     |SI #2#6 = "B";
         |SI #2#12 ! 0;
             #1#8 = #1#8 +. 1;
         |FINSI;
         #1#9 = #1#9 +. #2#12;
     |FINSI;

     |SI #2#6 = "C";
         #1#10 = #1#10 +. 1;
         #1#11 = #1#11 +. #2#12;
     |FINSI;

     |SI #2#6 = "D";
         #1#12 = #1#12 +. 1;
         #1#13 = #1#13 +. #2#12;
     |FINSI;

     |SI #2#6 = "E";
         #1#14 = #1#14 +. 1;
         #1#15 = #1#15 +. #2#12;
     |FINSI;

     |SI #2#6 = "F";
         #1#20 = #1#20 +. 1;
         #1#21 = #1#21 +. #2#12;
     |FINSI;

     |SI #2#6 = "G";
         #1#22 = #1#22 +. 1;
         #1#23 = #1#23 +. #2#12;
     |FINSI;

     |HAZ PintaClave;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         nOpera = 1; |BUCLE SumayBorra;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja22;
     #22#0  = #1#0;
     #22#1  = #1#1;
     #22#2  = #1#2;
     #22#3  = #1#3;
     #22#4  = #1#4;
     #22#5  = #1#5;
     #22#6  = eaClave347;
     #22#11 = " ";
     #22#8  = "N";
     #22#9  = "N";
     #22#25 = "N";
     #22#26 = "N";
     #22#27 = "N";
|FRUT;

|RUTINA ClaveAlta22;
     #22#0  = #1#0;
     #22#1  = #1#1;
     #22#2  = #1#2;
     #22#3  = #1#3;
     #22#4  = #1#4;
     #22#5  = #1#5;
     #22#6  = eaClave347;
     #22#11 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     #22#8  = "S";
     #22#9  = "S";
     #22#25 = "S";
     #22#26 = "S";
     #22#27 = "S";
|FRUT;

|PROCESO Tipo11mo2347;  |TIPO 11;
     nEjerCobro = #2#1 - 1;
     |SI FSalida = 10;
         eaVarDni  = #2Campo;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #2Campo = eaVarDni;
         |PINTA #2Campo;
         |ERROR;
     |FINSI;

     |SI FSalida = 11;
         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/dsmo2347.mas";
         |CARGA_DEF aDef, reflejo@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def dsmo2347.mas";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |C_V #22#13, 1, "S";
         |C_V #22#14, 1, "S";
         |C_V #22#15, 1, "S";

         |ABRE #22;
         |CONSULTA_F_CLAVE #2#22, ClaveBaja22, ClaveAlta22;
         |SI FSalida = 0;
             #2#0 = #22#0;
             #2#1 = #22#1;
             #2#2 = #22#2;
             #2#3 = #22#3;
             #2#4 = #22#4;
             #2#5 = #22#5;
             #2#6 = #22#6;
             #2#7 = #22#7;
             #2#8 = #22#8;
             #2#9 = #22#9;
             #2#25 = #22#25;
             #2#26 = #22#26;
             #2#27 = #22#27;
             |LEE 000#2=;
         |FINSI;
         |CIERRA #22;

         |DESCARGA_DEF #reflejo@;

         |PTEC 809;
         |PTEC 808;
         |PONCONTROL  23, "SI";
     |FINSI;

     |SI FSalida = 12;
         |SI #2#6 ! "A";  |Y #2#6 ! "B"; |Y #2#1 < 2011;
             |ACABA;
         |FINSI;
         |SI #2#1 < 2008; |ACABA; |FINSI;

         |SI #2#1 ] 2010;
             |PUSHV 0925 2480;
             |SI #2#1 > 2010;
                 |HAZ Sacar2011;
             |SINO;
                 |BLANCO 1025 2280;
                 |CUADRO 1025 1480;

                 |PINTA 1126, "Percibido en metalico Ejercicio Actual...:            ";
                 |PINTA 1226, "Percibido en metalico Ejer. Anteriores ..:            ";
                 |PINTA 1326, "Percibido por transmisiones sujetas a IVA:            ";

                 |PINTA 1169, #2#13;
                 |PINTA 1269, #2#15;
                 |PINTA 1369, #2#14;

                 |ENTLINEAL #1#44, -11, 7, 21,1, ClaveBaja44,ClaveAlta44;
             |FINSI;
         |SINO;

              |PUSHV 1325 1680;
              |BLANCO 1325 1680;
              |CUADRO 1325 1680;

              |PINTA 1426, "Percibido en metalico ...................:            ";
              |PINTA 1526, "Percibido por transmisiones sujetas a IVA:            ";
              |PINTA 1469, #2#13;
              |PINTA 1469, #2#14;
         |FINSI;

         |PAUSA;

         |POPV;

         |ERROR;
     |FINSI;

     |SI FSalida = 13;
         |SI #2#6 = "B"; |Y #2#9 = "S";

             |LEE 141#2=;
             |SI #2#1 [ 2010;  |C_M #2#12, 1, "N";  |FINSI;
             |ENCAMPO #12#2;
             |SI #2#1 [ 2010;  |C_M #2#12, 1, "S";  |FINSI;

             |GRABA 000#2a;
             |LIBERA #2;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO MiraDnimo2347;  |TIPO 6;
    nModo    = (FEntrada / 100) ! 0;
    eaVarDni = #2Campo;
    enCalcCif = 0;
    |HAZ CalculameDNI;
    eaVarDni = (eaVarDni + "             ") % 112;
    |SI #2Campo ! eaVarDni;
        |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
        |SI FSalida = 0;
            #2Campo = eaVarDni;  |PINTA #2Campo;
            |ERROR;
            |ACABA;
        |FINSI;
    |FINSI;

    |QBF eaVarDni; |QBF eaCliNif;
    |SI eaVarDni = eaCliNif;
        |CONFI "    NIntroducido NIF de la Empresa Actual. Continuar";
        |SI FSalida ! 0;
            |ERROR;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO TipoOpe;
     |C_M #2Campo, 0, aAlfa1;
     |SI aAlfa1 = "N";
         |PINTA #2Campo;
         |ACABA;
     |FINSI;

     |SI FSalida = 2; |ACABA; |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     aAlfa = #2Campo;
     |SI aAlfa = "S";
         |SI Campo = 25;
             #2#26 = "N"; |PINTA #2#26;
             #2#8  = "N"; |PINTA #2#8;
             #2#9  = "N"; |PINTA #2#9;
         |FINSI;
         |SI Campo = 26;
             #2#25 = "N"; |PINTA #2#25;
             #2#8  = "N"; |PINTA #2#8;
             #2#9  = "N"; |PINTA #2#9;
         |FINSI;
         |SI Campo = 8;
             #2#25 = "N"; |PINTA #2#25;
             #2#26 = "N"; |PINTA #2#26;
             #2#9  = "N"; |PINTA #2#9;
         |FINSI;
         |SI Campo = 9;
             #2#25 = "N"; |PINTA #2#25;
             #2#26 = "N"; |PINTA #2#26;
             #2#8  = "N"; |PINTA #2#8;
         |FINSI;
     |FINSI;
     |C_M #2#27, 1, "S";
     |SI #2#25 = "S"; |O #2#26 = "S";
        |C_M #2#27, 1, "N";
        #2#27 = "N"; |PINTA #2#27;
     |FINSI;
|FPRC;
