|FICHEROS;
     dsmozp82 #0;

     dsmom080 #80;
     dsmom081 #81,MANTE;
     dsmom082 #82;
     dsmom083 #83;

     dsmow082 #982,MANTE;
     dsmow083 #983,MANTE;

     :/basica/def/agifigen #1000;
     :/basica/def/agicen14 #1014;

     reflejo@ #182;
|FIN;

|VARIABLES;
     nNume1      = 0;
     nNume2      = 0;
     &nAny       = 0;
     &aTipoPr    = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";

     fFecIni   = @;
     fFecFin   = @;
     nInkey    = 0;
     esalta    = 0;
     esaltaL   = 0;
     nSwSal    = 0;

     aBlanc      = "";

     &aFichw82   = "";
     &nSwLinea   = 0;
     &eaCam1     = "";
     &eaCam2     = "";
     &eaCam3     = "";
     &enCam4     = "";
     &eaCa4      = "";
     &eaCam8     = "";
     &enCam10    = 0;
     &enCam11    = 0;
     &enCam12    = 0;
     &enCam22    = 0;
     &enCam13    = 0;
     &eaCam15    = "";
     &eaTit      = "";
     &enEj82     = "";

     aBase = "";
     aDef  = "";
     nDEmp = 0;
     nHEmp = 0;
     nDAct = 0;
     nHAct = 0;
     informe = "";
     inform1 = "dsmow082";
     inform2 = "dsmow083";

     nBoton2    = 0;
     nBoton3    = 0;
     nBoton5    = 0;
     nBoton6    = 0;
     &aParam    = "";
|FIN;

|INCLUYE i_variar;

**************************************************************************
|PROCESO ClaveBajaL83;
  #983#0  = #0#0;
  #983#1  = enEmpresa;
  #983#2  = 00;
|FPRC;

|PROCESO ClaveAltaL83;
  #983#0  = #0#0;
  #983#1  = enEmpresa;
  #983#2  = 99;
|FPRC;

|PROCESO MTipo5;  |TIPO 5;
       |LEE 040#983p;
       #983#2 = 00; |LINEAS_BI_ATRI #983#2, P, D, -1;
|FPRC;

|CALCULO Siesgeneral; |TIPO 0;
 |SI #982#3 = "G";
     |C_M #982#4,1,"S";
 |SINO;
     |C_M #982#4,1,"N";
 |FINSI;
|FCAL;

|PROCESO PintaCab;
        aBlanc = " " * 79;
        |PINTA 0601, aBlanc;
        |PINTA 0701, aBlanc;
        |PINTA 0801, aBlanc;
        |PINTA 0702, "Empresa: "; |PINTA 0711, #982#1;
        |PINTA 0717, #982#2;
        |PINTA 0759, "NIF: "; |PINTA 0764, #982#15;
|FPRC;

|PROCESO FinBotonw082;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo0w082;  |TIPO 0;
     |HAZ FinBotonw082;
|FPRC;

|CALCULO Tipo7w082;  |TIPO 7;

     |CONTROL_SIMPLE 0, "LBOTON,F2  Consulta Actividades ", 0557, 0580, Boton2w082;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F3  Vol.Operaciones de Actividades", 0657, 0680, Boton3w082;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F5  Modificar Prorrata            ", 0757, 0780, Boton5w082;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F6  Imprimir Relacion Empresas  ", 0857, 0880, Boton6w082;
     nBoton6 = FSalida;
|FCAL;

|CALCULO Tipo11w082; |TIPO 11;
    nInkey    = FSalida;
    |HAZ FinBotonw082;

    enEmpresa = #982#1;
    nAny      = #0#0;
    |SI nInkey <10; |O nInkey > 14;
        |ACABA;
    |FINSI;

    |PUSHV 0501 2380;
    |LEE 001#982=;

    |SI nInkey = 10; || (F2)
        |HAZ PintaCab;
        enModo    = 4;
        |SUB_EJECUTA_NP ":basica/agicen14";
    |FINSI;

    |SI nInkey = 11; || (F3)
        nSwSal = 0;
        |PINPA #0#983;
        |PINTA 0718, #982#2;  |PINTA 0767, #982#15;
        |PINTA 2217, #982#5;  |PINTA 2229, #982#6;
        |PINTA 2241, #982#22; |PINTA 2252, #982#9;
        |PINTA 2273, #982#3;  |PINTA 2275, #982#19;
        |ENTLINEAL #1#983, -3, 4, 20, 0, ClaveBajaL83, ClaveAltaL83;
    |FINSI;

    |POPV;

    |SI nInkey = 13;
        |HAZ PideProrrata;

        |PINTA #982#3;
        aTipoPr = #982#3;
        |HAZ CalNueProrr;
        #982#19 = "";
        |SI #982#3 = "G";
            aAlfa1  = #982#4; |QBF aAlfa1;
            #982#23 = " GENERAL";
        |SINO;
            aAlfa1  = #982#18; |QBF aAlfa1;
            #982#23 = " ESPECIAL";
        |FINSI;
        aAlfa1  = ("   " + aAlfa1) % -103;
        #982#19 = aAlfa1;
        |PINTA #982#19;

        |GRABA 020#982a;
    |FINSI;

    |SI nInkey = 14; || (F6)
        |HAZ Imprimir;
    |FINSI;
|FCAL;


|CALCULO SalgoYa;  |TIPO 7;
     |SI nSwSal = 1;  |PTEC 807;  |FINSI;
|FCAL;

|| ************************************************************************

|PROCESO Leew82_Aux83;

  |SI aTipoPr = "G";
      #983#5 = #982#4;
      #983#9 = #982#4;
  |SINO;
      |SI #983#2 = 99; |O #983#2 = 00;
          #983#9 = #982#18;
      |FINSI;
      #983#5 = #983#9;
  |FINSI;
  |GRABA 020#983a;
|FPRC;

|DEFBUCLE Leew82_Aux83;
 #983#1;
 ;
 #982#0,#982#1, 00;
 #982#0,#982#1, 99;
 ;
 NULL, Leew82_Aux83;
|FIN;

|PROCESO CalNueProrr;

    |SI aTipoPr = "G";
        #982#4 = #982#18;
    |SINO;
        #982#4 = #982#18;
    |FINSI;
    |SI #982#4 > 100; #982#4 = 100; |FINSI;

    |BUCLE Leew82_Aux83;
|FPRC;

|| ********************** Imprimo Datos
|PROCESO LeoInfw83;
 |SI eaCa4 = ""; eaCa4 = #983#13; |FINSI;
 |PRINT;
|FPRC;

|DEFBUCLE LeoInfw83;
 #983#1;
 ;
 #0#0, enEmpresa, 00;
 #0#0, enEmpresa, 99;
 ;
 NULL, LeoInfw83;
|FIN;

|PROCESO LeoReflejo;

 enEmpresa = #182#1;
 nSwLinea  = 0;
 eaCam1    = #182#1; |QBF eaCam1;
 eaCam1    = ("00000" + eaCam1) % -105;
 eaCam2    = #182#2;
 eaCam3    = "ESPECIAL";
 enCam4    = "";
 |SI #182#3 = "G";
     eaCam3 = "GENERAL ";
     enCam4 = #182#19;
     enCam4 = enCam4 + "%";
     enCam4 = ("     " + enCam4) % -104;
 |FINSI;
 eaCam8    = "NO";
 |SI #182#8 = "S";
     eaCam8 = "SI";
 |FINSI;
 enCam10   = #182#5;
 enCam11   = #182#9;
 enCam13   = #182#6;
 enCam12   = #182#16;
 eaCam15   = #182#15;
 enCam22   = #182#22;

 |SI nInkey = 15;
     |BUCLE LeoInfw83;
 |SINO;
     |PRINT;
 |FINSI;
|FPRC;

|DEFBUCLE LeoReflejo;
 #182#1002;
 ;
 #0#0, nDEmp;
 #0#0, nHEmp;
 ;
 NULL, LeoReflejo;
|FIN;

|PROCESO Imprimir;
   eaTit  = "DEFINITIVA";
   enEj82 = #0#0;
  || |SI aParam = "P";
       eaTit = "PROVISIONAL";
       enEj82 = #0#0;
  || |FINSI;

   |DBASE aBase;  |QBT aBase;
   aDef = aBase + "def/dsmow082.mas";
   |CARGA_DEF aDef, reflejo@;
   |SI FSalida ! 0;
       aAlfa = "     Error en cargar el Def dsmow082";
       |MENAV aAlfa;
       |ACABA;
   |FINSI;
   |NOME_DAT #182 aFichw82;

   |IMPRE 0;
   |SI FSalida ! 0;
       |DESCARGA_DEF #reflejo@;
       |ACABA;
   |FINSI;

   informe = inform1;
   nDEmp   = 1;
   nHEmp   = 99999;
   |SI nInkey = 15;
       informe = inform2;
       nDEmp   = enEmpresa;
       nHEmp   = enEmpresa;
   |FINSI;

   |INFOR informe;
   |SI FSalida ! 0;
       |FINIMP;
       |DESCARGA_DEF #reflejo@;
       |ACABA;
   |FINSI;

   |BUCLE LeoReflejo;

   |PIEINF;
   |FININF;
   |FINIMP;
   |DESCARGA_DEF #reflejo@;
|FPRC;

|| ***********************************************************************
|PROCESO Baja81;
 #81#0 = enEmpresa;
 #81#1 = nAny;
 #81#2 = 00;
|FPRC;

|PROCESO Alta81;
 #81#0 = enEmpresa;
 #81#1 = nAny;
 #81#2 = 99;
|FPRC;

|PROCESO Baja82;
 #82#0 = enEmpresa;
 #82#1 = #0#0;
 #82#2 = 01;
|FPRC;

|PROCESO Alta82;
 #82#0 = enEmpresa;
 #82#1 = #0#0;
 #82#2 = 99;
|FPRC;

|PROCESO Baja83;
 #83#0 = enEmpresa;
 #83#1 = #0#0;
 #83#2 = #81#2;
 #83#3 = 01;
|FPRC;

|PROCESO Alta83;
 #83#0 = enEmpresa;
 #83#1 = #0#0;
 #83#2 = #81#2;
 #83#3 = 99;
|FPRC;

|PROCESO Verel83; |TIPO 7;
    |ENTLINEAL #1#83, -4, 7, 20, 0, Baja83, Alta83;
|FPRC;

|PROCESO Entrarel83; |TIPO 11;
  |SI FSalida = 10;
      |ENTLINEAL #1#83, -4, 4, 20, 0, Baja83, Alta83;
  |FINSI;
|FPRC;

|PROCESO Canvi;
|FPRC;
|PROCESO sector83;
|FPRC;
|PROCESO tipo83;
|FPRC;
|PROCESO Tipo11w83;
|FPRC;
|PROCESO Tipo7w83;
|FPRC;
|PROCESO Tipo0w83;
|FPRC;

|PROCESO PideProrrata;
        |C_V #982#21,1,"S"; |C_M #982#21,1,"S";
        |C_V #982#18,1,"S"; |C_M #982#18,1,"S";

        #982#21 = #982#3;
        |PUSHV  1137 1549;
        |PINTA 1138, "           ";
        |PINTA 1438, "           ";
        |ATRI P; |PINTA 1238, " Tipo      "; |ATRI 0; |PINTA #982#21;
        |ATRI P; |PINTA 1338, "    %      "; |ATRI 0; |PINTA #982#18;
        |CUADRO 1137 1549;
        |SI #982#17 = 1;
            #982#21 = "G";
        |SINO;
            |ENCAMPO #21#982;
        |FINSI;
        |ENCAMPO #18#982;
        aTipoPr = #982#21;
        |HAZ CalNueProrr;
        |SI #982#21 = "E";
            |POPV;
            |PUSHV 0501 2380;
            nSwSal = 0;
            |C_M #983#9,1,"S";
            |PINPA #0#983;
            |PINTA 0718, #982#2;  |PINTA 0767, #982#15;
            |PINTA 2217, #982#5;  |PINTA 2229, #982#6;
            |PINTA 2241, #982#16; |PINTA 2252, #982#9;
            |PINTA 2273, #982#3;  |PINTA 2275, #982#4;
            |ENTLINEAL #1#983, -3, 2, 20, 0, ClaveBajaL83, ClaveAltaL83;
            |C_M #983#9,1,"N";
        |FINSI;
        #982#3 = #982#21;
        |SI #982#3 = "G"; #982#23 = " GENERAL"; |FINSI;
        |SI #982#3 = "E"; #982#23 = " ESPECIAL"; |FINSI;
        |POPV;

        |C_V #982#21,1,"N"; |C_M #982#21,1,"N";
        |C_V #982#18,1,"N"; |C_M #982#18,1,"N";
|FPRC;

|PROCESO Boton2w082;
     |PTEC 824;
|FPRC;

|PROCESO Boton3w082;
     |PTEC 825;
|FPRC;

|PROCESO Boton5w082;
     |PTEC 827;
|FPRC;

|PROCESO Boton6w082;
     |PTEC 828;
|FPRC;
