|FICHEROS;
     dsmow056 #956,MANTE;
     dsmow057 #957,MANTE;
     dsmow058 #958,MANTE;
     dsmow059 #959,MANTE;
     dsmow167 #967,MANTE;

     &regisnif@ #709;
|FIN;

|VARIABLES;
    aAlfa  = "";
    aAlfa1 = "";
    aAlfa2 = "";
    aLong  = "";
    nLong  = 0;
    nComa  = 0;
    nPos   = 0;
    aCaracter = "";
    nCaracter = 0;
    nCampo1 = 0;
    nCampo2 = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO Tipo0w57;
    |SI #957Campo = "X"; |Y enEjer ] 2016;
        |SI Campo ! 0; #957#0 = " "; |PINTA #957#0; |FINSI;
        |SI Campo ! 1; #957#1 = " "; |PINTA #957#1; |FINSI;
        |SI Campo ! 2; #957#2 = " "; |PINTA #957#2; |FINSI;
        |SI Campo ! 3; #957#3 = " "; |PINTA #957#3; |FINSI;
        |SI Campo ! 4; #957#4 = " "; |PINTA #957#4; |FINSI;
        |SI Campo ! 5; #957#5 = " "; |PINTA #957#5; |FINSI;
    |FINSI;
|FPRC;

|PROCESO Tipo0w58;
    |SI #958Campo = "X"; |Y enEjer ] 2016;
        |SI Campo ! 0; #958#0 = " "; |PINTA #958#0; |FINSI;
        |SI Campo ! 1; #958#1 = " "; |PINTA #958#1; |FINSI;
        |SI Campo ! 2; #958#2 = " "; |PINTA #958#2; |FINSI;
        |SI Campo ! 3; #958#3 = " "; |PINTA #958#3; |FINSI;
        |SI Campo ! 4; #958#4 = " "; |PINTA #958#4; |FINSI;
        |SI Campo ! 5; #958#5 = " "; |PINTA #958#5; |FINSI;
    |FINSI;
|FPRC;

|PROCESO CalcDni;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #Fichero@#Campo#;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #956Campo = eaVarDni;
         |PINTA #Fichero@#Campo#;
         |ERROR;
         |ACABA;
      |FINSI;

      eaVarDni  = #Fichero@#Campo#;
      enCalcCif = 0;
      |HAZ CalculameDNI;
      eaVarDni = (eaVarDni + "             ") % 112;
      |SI #Fichero@#Campo# ! eaVarDni;
          |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
          |SI FSalida = 0;
              #Fichero@#Campo# = eaVarDni;  |PINTA #Fichero@#Campo#;
              |ERROR;
          |FINSI;
      |FINSI;
|FPRC;

|PROCESO BuscaNombre_w56;
     |QBF aAlfa;
     aAlfa1 = "";
     aAlfa2 = "";
     aLong  = aAlfa % 0;
     nLong  = aLong;
     nComa  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (nCaracter * 100) + 1;
           aCaracter = aAlfa % nPos;

           |SI aCaracter = ",";
               nComa = 1;
           |SINO;
               |SI nComa = 0;
                   aAlfa1 = aAlfa1 + aCaracter;
               |SINO;
                   |SI aCaracter = " ";  |Y aAlfa2 = "";
                   |SINO;
                       aAlfa2 = aAlfa2 + aCaracter;
                   |FINSI;
               |FINSI;
           |FINSI;
      |SIGUE;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 0;
     eaCodNif  = #956#0;
     |HAZ LeeNifs;

     #956#1 = #709#1;
     #956#2 = #709#13;

     |SI enEjer ] 2016;
         aAlfa = eaCodNif % 101;
        |SI aAlfa = "0"; |O aAlfa = "1"; |O aAlfa = "2"; |O aAlfa = "3";
          |O aAlfa = "4"; |O aAlfa = "5"; |O aAlfa = "6"; |O aAlfa = "7";
          |O aAlfa = "8"; |O aAlfa = "9"; |O aAlfa = "X"; |O aAlfa = "Y";
          |O aAlfa = "Z";
             aAlfa = #709#1;     |HAZ BuscaNombre_w56;
             #956#1 = aAlfa1;
             #956#3 = aAlfa2; |PINTA #956#3;
        |FINSI;
     |FINSI;
     |PINTA #956#1;
     |PINTA #956#2;
|FPRC;

|PROCESO PonDatosNif167;  |TIPO 0;
     eaCodNif  = #967Campo;
     |HAZ LeeNifs;

     nCampo1     = Campo + 1;
     nCampo2     = 7;
     #967nCampo1 = #709#1;
     |SI Campo = 0;
         #967#2  = #709#13; |PINTA #967#2;
         nCampo2 = 3;
     |FINSI;

     aAlfa = eaCodNif % 101;
     |SI aAlfa = "0"; |O aAlfa = "1"; |O aAlfa = "2"; |O aAlfa = "3";
        |O aAlfa = "4"; |O aAlfa = "5"; |O aAlfa = "6"; |O aAlfa = "7";
          |O aAlfa = "8"; |O aAlfa = "9"; |O aAlfa = "X"; |O aAlfa = "Y";
           |O aAlfa = "Z";
              aAlfa = #709#1;     |HAZ BuscaNombre_w56;
              #967nCampo1 = aAlfa1;
              #967nCampo2 = aAlfa2;
     |SINO;
        #967nCampo2 = "";
     |FINSI;
     |PINTA #967nCampo1;
     |PINTA #967nCampo2;
|FPRC;

|PROCESO Tipo12w56;  |TIPO 12;
     |SI #956#0 = "            ";
         #956#1 = "";
         #956#2 = "";
         #956#3 = "";
     |FINSI;

     |SI #967#0 = "            ";
         #967#1 = "";
         #967#2 = "";
         #967#3 = "";
         #967#4 = "";
     |FINSI;
     |SI #967#5 = "            ";
         #967#6 = "";
         #967#7 = "";
     |FINSI;
|FPRC;

|| /////////////////////////////////////////////////////////////////
