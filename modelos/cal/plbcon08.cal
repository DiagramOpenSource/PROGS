|FICHEROS;
     dsmom014;
     dsmom060;
     dsmom061;
     dsmom050;
     dsmom062;
     dsmom088;
     dsmom162;

     dsmow178;
|FIN;

|VARIABLES;
     &eaPrograma   = "";
     &eaExtension  = "";
     &eaPlanilla   = "";
     &enEjer       = 0;
     &enPlan       = 0;
     &enPlan60     = 0;
     &enPlan14     = 0;
     &enSignos     = 0;
     nQueHago      = 0;
     &eaCta60      = "";
     &eaTip60      = "";
     &enDesglose60 = 0;
     &eaNFw178     = "";
     &enCreaFAnyo  = 0;
     &enClAgrupa   = 0;
     &enClAgrup0   = 0;
     &eaClave60    = ""

     nOk           = 0;
     aAlfa1        = "";
     nNume1        = 0;
     aUnoD         = "";
     aDosD         = "";
     aFichero      = "";
     nCampo0       = 0;
     nCampo1       = 0;
     nPara1        = 0;
|FIN;


|| .... Proceso para ver si tiene desglose una cuenta en el 61
|PROCESO eLeoDsmom061;
     aAlfa1 = #dsmom061#4; |QBF aAlfa1;
     aAlfa1 = aAlfa1 % 0;
     nNume1 = aAlfa1;
     |SI nNume1 > 4;
         enDesglose60 = 1;
     |FINSI;
|FPRC;

|DEFBUCLE eLeoDsmom061;
   #dsmom061#2;
   ;
   enPlan60, "N", eaTip60, aUnoD, 01;
   enPlan60, "N", eaTip60, aDosD, 99;
   e;
   NULL, eLeoDsmom061;
|FIN;

|PROCESO HayDesglose60;
    |QBF eaCta60;
    aUnoD = (eaCta60 + "            ") % 112;
    aDosD = (eaCta60 + "zzzzzzzzzzzz") % 112;
    enDesglose60 = 0;
    |BUCLE eLeoDsmom061;
|FPRC;
|| ////////////////////////////////////////////

||  Ver que clase de clave del libro es, enClAgrupa = 1 subtotal (GY4 ...)
                                         enClAgrupa = 2 incluida en subtotal (G14, G15 ...)
                                         enClAgrupa = 0 normal
|PROCESO eClaveAgrupa;
    enClAgrupa = 0;
    enClAgrup0 = 0;
    |SI eaClave60 = "   "; |ACABA; |FINSI;

    nCampo0 = 1; nCampo1 = 55;
    |SI eaTip60 = "G"; nCampo0 = 56; nCampo1 = 110; |FINSI;
    |PARA nPara1 = nCampo0; |SI nPara1 [ nCampo1; |HACIENDO nPara1 = nPara1 + 1;
          |SI eaClave60 = #dsmom162#nPara1#;
              |SI nPara1 = 1; |O nPara1 = 12; |O nPara1 = 23; |O nPara1 = 34;
                  |O nPara1 = 45; |O nPara1 = 56; |O nPara1 = 67; |O nPara1 = 78;
                    |O nPara1 = 89; |O nPara1 = 100;
                  enClAgrupa = 1;
                  enClAgrup0 = nPara1;
              |SINO;
                  enClAgrupa = 2;
                  enClAgrup0 = nPara1;
              |FINSI;
              |SAL;
          |FINSI;
    |SIGUE;
|FPRC;
|| //////////////////////////////////////////////////////////////////////////////////////
||  .... Ejercicio vigente del dsmom014 y dsmom060
|PROCESO EjerPlan14;
    |SI nQueHago = 1;
        #dsmow178#0 = #dsmom014#10;
        #dsmow178#1 = "Cuentas ingresos, gastos y consumos";
        |GRABA 040#dsmow178.n;
        |ACABA;
    |FINSI;

    enPlan14 = #dsmom014#10;
|FPRC;

|DEFBUCLE EjerPlan14;
    #dsmom014#1;
    ;
    1990,   "6000";
    enEjer, "6000";
    e;
    NULL, EjerPlan14;
|FIN;

|PROCESO Verm014Plan;

    enPlan14 = 0;
    |BUCLE EjerPlan14;
    |SI enPlan14 = 0;
        enPlan = 0;
        |HAZ Planes60y14;

        |BUCLE EjerPlan14;
    |FINSI;
    |SI enPlan14 = 0;
        |MENAV "0000No existe la planilla de las cuentas para Planillas";
        |MENAV "0000Consulte con su administrador";
    |FINSI;
|FPRC;

|PROCESO EjerPlan;
    |SI nQueHago = 1;
        #dsmow178#0 = #dsmom060#6;
        #dsmow178#1 = "Cuentas para balance de rendimientos de actividades economicas";
        |GRABA 040#dsmow178.n;
        |ACABA;
    |FINSI;

    enPlan60 = #dsmom060#6;
|FPRC;

|DEFBUCLE EjerPlan;
    #dsmom060#1;
    ;
    1990,   "N", "I", 01;
    enEjer, "N", "I", 02;
    e;
    NULL, EjerPlan;
|FIN;

|PROCESO Verm060Plan;
     enPlan60 = 0;
     |BUCLE EjerPlan;
     |SI enPlan60 = 0;
         enPlan = 0;
         |HAZ Planes60y14;

         |BUCLE EjerPlan;
     |FINSI;
     |SI enPlan60 = 0;
         |MENAV "0000No existe la planilla de las cuentas para Rendimientos de Actividades Economicas para el Plan del 2008";
         |MENAV "0000Consulte con su administrador";
     |FINSI;
|FPRC;

|| ////////////////////////////////////////////////////////////////////
|PROCESO eCreaFAnyo;   ||auxilar de a¤os creados en dsmo014 y dsmom060
     nNume1   = enEjer;
     enEjer   = 2999;
     nQueHago = 1;
     eaNFw178 = ("6k" + Usuario) % 108;
     |NOME_DAT #dsmow178#eaNFw178#;
     |DELINDEX #dsmow178;
     |ABRE #dsmow178;
     |SI enCreaFAnyo = 1; |BUCLE EjerPlan;   |FINSI;
     |SI enCreaFAnyo = 2; |BUCLE EjerPlan14; |FINSI;
     |CIERRA #dsmow178;
     nQueHago = 0;
     enEjer   = nNume1;
|FPRC;

|| ////////////////////////////////////////////////////////////////////

|PROCESO Planes60y14;
    |SI enPlan ! 2015;
        eaPrograma  = "dsmom014";
        eaExtension = "mod";
        |SUB_EJECUTA_NP ":basica/dspatron";
    |FINSI;

    eaPrograma  = "dsmom060";
    eaExtension = "mod";
    |SUB_EJECUTA_NP ":basica/dspatron";

    eaPrograma  = "dsmom061";
    eaExtension = "mod";
    |SUB_EJECUTA_NP ":basica/dspatron";

    eaPrograma  = "dsmom160";
    eaExtension = "mod";
    |SUB_EJECUTA_NP ":basica/dspatron";

    eaPrograma  = "dsmom161";
    eaExtension = "mod";
    |SUB_EJECUTA_NP ":basica/dspatron";

    eaPrograma  = "dsmom162";
    eaExtension = "mod";
    |SUB_EJECUTA_NP ":basica/dspatron";
|FPRC;

|PROCESO dsmom014_60Plan;
     nOk = 0;
     |ABRE #dsmom014;
     #dsmom014#10 = enPlan;
     #dsmom014#0  = "";
     |LEE 000#dsmom014.];
     |SI FSalida ! 0;  |O #dsmom014#10 ! enPlan;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom014;

     |ABRE #dsmom060;
     #dsmom060#6  = enPlan;
     #dsmom060#0  = "N";
     #dsmom060#1  = "G";
     #dsmom060#2  = 50;
     |LEE 000#dsmom060.=;
     |SI FSalida ! 0;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom060;

     |SI nOk = 1;
         |HAZ Planes60y14;
     |FINSI;

     nOk = 0;
     |ABRE #dsmom014;
     #dsmom014#10 = enPlan;
     #dsmom014#0  = "";
     |LEE 000#dsmom014.];
     |SI FSalida ! 0;  |O #dsmom014#10 ! enPlan;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom014;

     |ABRE #dsmom060;
     #dsmom060#6  = enPlan;
     #dsmom060#0  = "N";
     #dsmom060#1  = "G";
     #dsmom060#2  = 50;
     |LEE 000#dsmom060.=;
     |SI FSalida ! 0;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom060;

     |SI nOk = 1;
         |MENAV "0000No existe la planilla de las cuentas";
         |MENAV "0000Consulte con su administrador";
         enPlan = 0;
     |FINSI;
|FPRC;

|PROCESO dsmom060Plan;
     nOk = 0;
     |ABRE #dsmom060;
     #dsmom060#6  = enPlan;
     #dsmom060#0  = "N";
     #dsmom060#1  = "G";
     #dsmom060#2  = 50;
     |LEE 000#dsmom060.=;
     |SI FSalida ! 0;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom060;
     |ABRE #dsmom162;
     #dsmom162#0  = enPlan;
     |LEE 000#dsmom162.=;
     |SI FSalida ! 0;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom162;

     |SI nOk = 1;
         |HAZ Planes60y14;
     |FINSI;

     nOk = 0;
     |ABRE #dsmom060;
     #dsmom060#6  = enPlan;
     #dsmom060#0  = "N";
     #dsmom060#1  = "G";
     #dsmom060#2  = 50;
     |LEE 000#dsmom060.=;
     |SI FSalida ! 0;
         nOk = 1;
     |FINSI;
     |CIERRA #dsmom060;

     |SI nOk = 1;
         |MENAV "0000No existe la planilla de las cuentas";
         |MENAV "0000Consulte con su administrador";
         enPlan = 0;
     |FINSI;
|FPRC;
|| /////////////////////////////////////////////////////////////////////////////
|PROCESO dsmom050Plan;
     |ABRE #dsmom050;
     #dsmom050#3  = enPlan;
     #dsmom050#0  = "";
     |LEE 000#dsmom050.];
     |SI FSalida ! 0;  |O #dsmom050#3 ! enPlan;
         |CIERRA #dsmom050;

         eaPrograma  = "dsmom050";
         eaExtension = "mod";
         |SUB_EJECUTA_NP ":basica/dspatron";

         |ABRE #dsmom050;
     |FINSI;

     #dsmom050#3  = enPlan;
     #dsmom050#0  = "";
     |LEE 000#dsmom050.];
     |SI FSalida ! 0;  |O #dsmom050#3 ! enPlan;
         |MENAV "0000No existe la planilla de las cuentas contable de Determinacion del Valor Patrimonial para el Plan del 2008";
         |MENAV "0000Consulte con su administrador";
     |FINSI;
     |CIERRA #dsmom050;
|FPRC;

|PROCESO dsmom088Plan;
     |ABRE #dsmom088;
     #dsmom088#3  = enPlan;
     #dsmom088#0  = "";
     |LEE 000#dsmom088.];
     |SI FSalida ! 0;  |O #dsmom088#3 ! enPlan;
         |CIERRA #dsmom088;

         eaPrograma  = "dsmom088";
         eaExtension = "mod";
         |SUB_EJECUTA_NP ":basica/dspatron";

         |ABRE #dsmom088;
     |FINSI;

     #dsmom088#3  = enPlan;
     #dsmom088#0  = "";
     |LEE 000#dsmom088.];
     |SI FSalida ! 0;  |O #dsmom088#3 ! enPlan;
         |MENAV "0000No existe la planilla de las ctas contable de Determinacion Exclusion Reg.Tributacion";
         |MENAV "0000Consulte con su administrador";
     |FINSI;
     |CIERRA #dsmom088;
|FPRC;

|PROCESO dsmom062Plan;
     |ABRE #dsmom062;
     #dsmom062#4  = enPlan;
     #dsmom062#0  = 0;
     |LEE 000#dsmom062.];
     |SI FSalida ! 0;  |O #dsmom062#4 ! enPlan;
         |CIERRA #dsmom062;

         eaPrograma  = "dsmom062";
         eaExtension = "mod";
         |SUB_EJECUTA_NP ":basica/dspatron";

         eaPrograma  = "dsmom063";
         eaExtension = "mod";
         |SUB_EJECUTA_NP ":basica/dspatron";

         eaPrograma  = "dsmom064";
         eaExtension = "mod";
         |SUB_EJECUTA_NP ":basica/dspatron";

         |ABRE #dsmom062;
     |FINSI;

     #dsmom062#4  = enPlan;
     #dsmom062#0  = 0;
     |LEE 000#dsmom062.];
     |SI FSalida ! 0;  |O #dsmom062#4 ! enPlan;
         |MENAV "0000No existe la planilla de las cuentas para el Informe interno de situacion contable para el Plan del 2008";
         |MENAV "0000Consulte con su administrador";
     |FINSI;
     |CIERRA #dsmom062;
|FPRC;

|PROCESO PlanDePlanillas;

     |SI enEjer ! 0;
         |SI enEjer [ 2007;  enPlan = 1990;  |FINSI;
         |SI enEjer ] 2008;  enPlan = 2008;  |FINSI;
     |FINSI;

     enSignos = 0;
     |SI eaPlanilla = "dsmom060";
         enPlan = 2015;
         |HAZ dsmom060Plan;
     |FINSI;

     |SI eaPlanilla = "dsmom014"; |O eaPlanilla = "dsmom060";
         enPlan = 2019;
         |HAZ dsmom014_60Plan;
     |FINSI;

     |SI enPlan < 2008;  |ACABA;  |FINSI;

     |SI eaPlanilla = "dsmom050";  |HAZ dsmom050Plan;  |FINSI;
     |SI eaPlanilla = "dsmom062";  |HAZ dsmom062Plan;  |FINSI;
     |SI eaPlanilla = "dsmom088";  |HAZ dsmom088Plan;  |FINSI;
|FPRC;
