|FICHEROS;
     dsmoz090 #0;
     dsmom090 #90;
     dsmom091 #91;
     dsmom092 #92;

    :/basica/def/agicen14 #114;
    :/basica/def/agifigen #1000;

    &imagen90@ #441;
    &imagen91@ #442;
|FIN;

|VARIABLES;
     aFichero  = "";

     nCampo    = 0;
     nDEmpresa = 0;
     nHEmpresa = 0;
     enGraba   = 0;
     nSwExiste = 0;
     nEmpresa  = 0;
     nExiste   = 0;
     &nNingunaMas = 0;
     &nLaPrimera  = 0;

     aAlfa1 = "";
     aAlfa2 = "";
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\
|PROCESO LeoNombre;
    nExiste = 0;
    |ABRE #1000;
    |DDEFECTO #1000;
    #1000#0 = nEmpresa;
    |LEE 041#1000=;
    |SI FSalida ! 0; nExiste = 1; |FINSI;
    |CIERRA #1000;
|FPRC;

|CALCULO PeroLaCreo;
    nEmpresa = #0#1;
    |HAZ LeoNombre;
    |SI nExiste = 1; |ACABA; |FINSI;

    #92#0 = #1000#0;
    |LEE 101#92=;
    |SI FSalida ! 0;
        #92#0 = #1000#0;
        #92#1 = #1000#1;
        |GRABA 000#92b;
    |FINSI;
    |LIBERA #92;
|FCAL;

|PROCESO GrabaTempo;
     |SI nEmpresa ! #90#0;
         nEmpresa = #90#0;
         |HAZ LeoNombre;

         #92#0 = #90#0;
         |LEE 101#92=;
         |SI FSalida ! 0;
             #92#0 = #90#0;
             #92#1 = #1000#1;
             |GRABA 020#92n;
             enGraba = 1;
             |SI #90#0 = #0#1; nSwExiste = 1; |FINSI;
         |SINO;
             #92#1 = #1000#1;
            |GRABA 020#92a;
         |FINSI;
         |LIBERA #92;
    |FINSI;
|FPRC;

|DEFBUCLE dsmom090;
     #90#1;
     ;
     nDEmpresa, 00001;
     nHEmpresa, 99999;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA ClaveBaja999;
  |SI FSalida = "POSICION";
      #92#0 = #0#1;
  |SINO;
      #92#0 = 1;
  |FINSI;
|FRUT;

|RUTINA ClaveAlta999;
     #92#0 = 99999;
|FRUT;

|PROCESO Tipo3;  |TIPO 3;

     nSwExiste = 0;
     nDEmpresa = 00000;
     nHEmpresa = 99999;
     |SI nNingunaMas = 1;
         nDEmpresa = #0#1;
         nHEmpresa = #0#1;
     |FINSI;

     nEmpresa = -1;
     |ABRE #92;
     |BUCLE dsmom090;
     |SI nSwExiste = 0;
         |HAZ PeroLaCreo;
     |FINSI;
     |CIERRA #92;

     |PINPA #0#92;
     nLaPrimera = 1;
     |PTEC 825;
     |ENTLINEAL #1#92, -1, 2, 5, 0, ClaveBaja999, ClaveAlta999;

|FPRC;

|PROGRAMA;

      |DBASE aAlfa1; |QBF aAlfa1;
      aAlfa2 = aAlfa1 + "def/dsmom091.mas";
      |CARGA_DEF aAlfa2, imagen91@;
      |SI FSalida ! 0;
          |MENAV "    Error cargando el def dsmom091";
          |ACABA;
      |FINSI;

      aAlfa2 = aAlfa1 + "def/dsmom090.mas";
      |CARGA_DEF aAlfa2, imagen90@;
      |SI FSalida ! 0;
          |MENAV "    Error cargando el def dsmom090";
          |DESCARGA_DEF #imagen91@;
          |ACABA;
      |FINSI;

     |SI enEmpresa ! 0;
         nNingunaMas = 1;
         #0#1 = enEmpresa;
         #0#2 = enActividad;
         |HAZ Tipo3;
     |SINO;
         |CLS;
         |CABEZA "Entrada de Maquinas o Aparatos Automaticos";
         |DDEFECTO #0;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |FINSI;

     |DESCARGA_DEF #imagen90@;
     |DESCARGA_DEF #imagen91@;
|FPRO;
