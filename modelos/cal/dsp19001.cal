|FICHEROS;
     dsmom004;
     dsmom107;

     dsm190li;
     dsmoc110;
     dsmoc111;

     :/basica/def/agidanif;

     dsmow013;
     dsmow107;

     espejo1@;
     dsm190co@;
     &regisnif@;
|FIN;

|VARIABLES;
     aFichero     = "";
     nOpera       = 0;
     aAlfa        = "";
     nOp          = 0;
     nLaImpresora = 0;
     nSwHay       = 0;
     nSumaCampo1  = 0;
     nSumaCampo2  = 0;
     nSumaCampo3  = 0;
     nSumaCampo4  = 0;
     nSumaCampo5  = 0;
     nSumaCampo6  = 0;
     nTRelacion   = 0;
     &enTRela     = 0;
     &enBRela     = 0;
     nSuma        = 0;
     nCampoD      = 0;

     aVariable    = "";
     aPathModelo  = "";
     aDef         = "";

     &eaVariable  = "";
     &enNumError  = 0;
     &enError     = 0;
     &enSwPartir  = 0;

     nDComplem    = 0;
     nHComplem    = 0;
     Periodo      = 0;
     nImporte     = 0;

     &enDEmpresa  = 0;
     &enHEmpresa  = 0;
     nSiEsta      = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO LeoLi190;
   |DDEFECTO #dsm190li;
   #dsm190li#0  = #dsmow107#0;
   #dsm190li#1  = #dsmow107#1;
   #dsm190li#2  = #dsmow107#2;
   #dsm190li#3  = #dsmow107#3;
   #dsm190li#4  = #dsmow107#4;
   #dsm190li#5  = #dsmow107#5;
   #dsm190li#6  = #dsmow107#6;
   #dsm190li#7  = #dsmow107#7;
   #dsm190li#8  = #dsmow107#8;
   #dsm190li#9  = #dsmow107#9;
   #dsm190li#10 = #dsmow107#10;
   |LEE 101#dsm190li.=;
   |SI FSalida = 0;
       #dsm190li#22 = #dsmow107#11 + #dsmow107#12;
       |GRABA 020#dsm190li.a;
   |FINSI;
   |LIBERA #dsm190li;
|FPRC;

|DEFBUCLE LeoLi190;
     #dsmow107#1;
     ;
     enEmpresa,enEjer,enPeriodo,enModelo,enComplem,0,"            ",0000," ","  ", 0;
     enEmpresa,enEjer,enPeriodo,enModelo,enComplem,0,"zzzzzzzzzzzz",9999,"z","zz", 9;
     ;
     NULL, LeoLi190;
|FIN;

|PROCESO RecojoGastos;
   |ABRE #dsm190li;
   |BUCLE LeoLi190;
   |CIERRA #dsm190li;
|FPRC;

|PROCESO GraboAuxiliar;
   |DDEFECTO #dsmow107;
   #dsmow107#0  = #dsm190li#0;
   #dsmow107#1  = #dsm190li#1;
   #dsmow107#2  = #dsm190li#2;
   #dsmow107#3  = #dsm190li#3;
   #dsmow107#4  = #dsm190li#4;
   #dsmow107#5  = #dsm190li#5;
   #dsmow107#6  = #dsm190li#6;
   #dsmow107#7  = #dsm190li#7;
   #dsmow107#8  = #dsm190li#8;
   #dsmow107#9  = #dsm190li#9;
   #dsmow107#10 = #dsm190li#10;
   |LEE 101#dsmow107.=;
   |SI FSalida ! 0;
      |DDEFECTO #dsmow107;
      #dsmow107#0  = #dsm190li#0;
      #dsmow107#1  = #dsm190li#1;
      #dsmow107#2  = #dsm190li#2;
      #dsmow107#3  = #dsm190li#3;
      #dsmow107#4  = #dsm190li#4;
      #dsmow107#5  = #dsm190li#5;
      #dsmow107#6  = #dsm190li#6;
      #dsmow107#7  = #dsm190li#7;
      #dsmow107#8  = #dsm190li#8;
      #dsmow107#9  = #dsm190li#9;
      #dsmow107#10 = #dsm190li#10;
      |GRABA 020#dsmow107.b;
   |FINSI;

   |SI nOpera = 1; #dsmow107#11 = #dsmow107#11 + nImporte; |FINSI;
   |SI nOpera = 2; #dsmow107#12 = nImporte; |FINSI;

   |GRABA 020#dsmow107.a;
   |LIBERA #dsmow107;
|FPRC;

|PROCESO GrabaError;
    eaVariable = aVariable;
    enNumError = enNumError + 1;
    |HAZ eGrabaW156;
|FPRC;

|PROCESO GrabaPerceptor190;
     |SI #dsmoc110#6 = "PASEANTERIOR";  |ACABA;  |FINSI;
     |SI #dsmoc110#6 = "MANUAL      ";  |ACABA;  |FINSI;

     nSumaCampo1  = #dsmoc110#10 + #dsmoc110#15 + #dsmoc110#20;
     nSumaCampo2  = #dsmoc110#11 + #dsmoc110#16 + #dsmoc110#21;
     nSumaCampo3  = #dsmoc110#12 + #dsmoc110#17 + #dsmoc110#22;
     nSumaCampo4  = #dsmoc110#13 + #dsmoc110#18 + #dsmoc110#23;
     nSumaCampo5  = #dsmoc110#14 + #dsmoc110#19 + #dsmoc110#24;

     nSumaCampo4 = nSumaCampo4 + nSumaCampo5;

     nSuma = nSumaCampo1 + nSumaCampo2 + nSumaCampo3 +  nSumaCampo4;
     nSuma = nSuma       + nSumaCampo6 + #dsmoc110#25 + #dsmoc110#26 + #dsmoc110#27 + #dsmoc110#28;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     nImporte   = 0;
     enImporte1 = 0;
     enImporte2 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     #dsm190li#0  = #dsmoc110#0;
     #dsm190li#1  = #dsmoc110#1;
     #dsm190li#6  = #dsmoc110#6;
     #dsm190li#7  = #dsmoc110#7;
     enError = 1;

     |HAZ GrabaDatosNif;

     #dsm190li#0  = #dsmoc110#0;
     #dsm190li#1  = #dsmoc110#1;
     #dsm190li#6  = #dsmoc110#6;

     |ABRE #agidanif;
     #agidanif#0  = #dsm190li#6;
     #agidanif#1  = 1;
     |LEE 040#agidanif.=;
     |SI FSalida ! 0;  |DDEFECTO #agidanif; |FINSI;
     |CIERRA #agidanif;

     nTRelacion = #agidanif#36;

     #dsm190li#0  = #dsmoc110#0;
     #dsm190li#1  = #dsmoc110#1;
     #dsm190li#2  = 99;
     #dsm190li#3  = 190;
     #dsm190li#4  = enComplem;
     #dsm190li#5  = 0;
     #dsm190li#6  = #dsmoc110#6;
     #dsm190li#7  = #dsmoc110#7;
     #dsm190li#8  = #dsmoc110#8;
     #dsm190li#9  = #dsmoc110#9;
     #dsm190li#10 = 0;
     |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;
     |LEE 101#dsm190li.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm190li;
         #dsm190li#0  = #dsmoc110#0;
         #dsm190li#1  = #dsmoc110#1;
         #dsm190li#2  = 99;
         #dsm190li#3  = 190;
         #dsm190li#4  = enComplem;
         #dsm190li#5  = 0;
         #dsm190li#6  = #dsmoc110#6;
         #dsm190li#7  = #dsmoc110#7;
         #dsm190li#8  = #dsmoc110#8;
         #dsm190li#9  = #dsmoc110#9;
         #dsm190li#10 = 0;
         |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;

         eaCodNif = #dsm190li#6;
         |HAZ LeeNifs;

         #dsm190li#12 = #regisnif@#1;
         #dsm190li#13 = #regisnif@#4;

         |HAZ CalculaDatosNif;

         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
             #dsm190li#14 = 0;  #dsm190li#21 = 0;  #dsm190li#22 = 0;  #dsm190li#23 = 0;
             #dsm190li#24 = 0;  #dsm190li#25 = 0;  #dsm190li#26 = 0;

             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;

             |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;
         |FINSI;

         |SI #dsm190li#26 ! 2;
             #dsm190li#27 = "";
         |FINSI;

         |GRABA 020#dsm190li.b;
     |FINSI;

     |SI enMasivo = 0;
         |SI #dsm190li#8 = "A"; |O #dsm190li#8 = "B";  |O #dsm190li#8 = "C";  |O #dsm190li#8 = "D"; || ...  |O #dsm190li#8 = "E"; 98_2962
             |SI #dsm190li#14 = 0;  |O #dsm190li#26 = 0;
                 aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                 |SI nLaImpresora = 0; |HAZ LaImprMasivo; |FINSI;
                 |IMPRIME aVariable;
             |SINO;
                 |SI enError = 1;
                     aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                     |SI nLaImpresora = 0; |HAZ LaImprMasivo; |FINSI;
                     |IMPRIME aVariable;
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #dsm190li#8 = "A"; |O #dsm190li#8 = "B";  |O #dsm190li#8 = "C";  |O #dsm190li#8 = "D"; || ...  |O #dsm190li#8 = "E"; 98_2962
             |SI #dsm190li#14 = 0;  |O #dsm190li#26 = 0;
                 aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                 |HAZ GrabaError;
             |SINO;
                 |SI enError = 1;
                     aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                     |HAZ GrabaError;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #dsm190li#16 = #dsm190li#16 + nSumaCampo1;
     #dsm190li#17 = #dsm190li#17 + nSumaCampo2;
     #dsm190li#18 = #dsm190li#18 + nSumaCampo3;
     #dsm190li#19 = #dsm190li#19 + nSumaCampo4;
     #dsm190li#20 = #dsm190li#20 + nSumaCampo5;

     |SI #dsm190li#20 > #dsm190li#19;
         #dsm190li#20 = #dsm190li#19;
     |FINSI;

     |SI #dsmoc110#5 ! 99;
         |SI enImporte1 ! 0; |O enImporte2 ! 0; |O enImporte3 ! 0; |O enImporte4 ! 0;
              #dsm190li#21 = enImporte1;
              #dsm190li#22 = enImporte2;
              #dsm190li#23 = enImporte3;
              #dsm190li#24 = enImporte4;
         |SINO;
             #dsm190li#21 = #dsm190li#21 + #dsmoc110#25;
             #dsm190li#22 = #dsm190li#22 + #dsmoc110#26;
             #dsm190li#23 = #dsm190li#23 + #dsmoc110#27;
             #dsm190li#24 = #dsm190li#24 + #dsmoc110#28;
         |FINSI;
         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
              nImporte =  0;
         |SINO;
              nImporte = #dsm190li#22;
              |SI #dsmom107#21 = "S"; nOpera = 2; |HAZ GraboAuxiliar; |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
         #dsm190li#14 = 0;
         #dsm190li#21 = 0;
         #dsm190li#22 = 0;
         #dsm190li#23 = 0;
         #dsm190li#24 = 0;
         #dsm190li#25 = 0;
         #dsm190li#26 = 0;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;
     |FINSI;

     |SI #dsm190li#16 ! 0; |O #dsm190li#17 ! 0; |O #dsm190li#18 ! 0;
         |O #dsm190li#19 ! 0; |O #dsm190li#20 ! 0; |O #dsm190li#21 ! 0;
           |O #dsm190li#22 ! 0; |O #dsm190li#23 ! 0; |O #dsm190li#24 ! 0;
            |GRABA 020#dsm190li.a;
         nSwHay = 1;
     |SINO;
         |BORRA 020#dsm190li.a;
     |FINSI;
     |LIBERA #dsm190li;
|FPRC;

|DEFBUCLE dsmoc110;
     #dsmoc110#1;
     ;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nDComplem, 01, "            ", 0000, " ", "  ";
     #dsmow013#0, #dsmow013#2, Periodo, 110, nHComplem, 99, "zzzzzzzzzzzz", 9999, "z", "zz";
     ;
     NULL, GrabaPerceptor190;
|FIN;

|PROCESO GrabaPerceptor190Reg;
     |SI #dsmoc110#6 = "PASEANTERIOR";  |ACABA;  |FINSI;
     |SI #dsmoc110#6 = "MANUAL      ";  |ACABA;  |FINSI;

     nSumaCampo1  = #dsmoc110#10 + #dsmoc110#15 + #dsmoc110#20;
     nSumaCampo2  = #dsmoc110#11 + #dsmoc110#16 + #dsmoc110#21;
     nSumaCampo3  = #dsmoc110#12 + #dsmoc110#17 + #dsmoc110#22;
     nSumaCampo4  = #dsmoc110#13 + #dsmoc110#18 + #dsmoc110#23;
     nSumaCampo5  = #dsmoc110#14 + #dsmoc110#19 + #dsmoc110#24;

     nSumaCampo4 = nSumaCampo4 + nSumaCampo5;

     nSuma = nSumaCampo1 + nSumaCampo2 + nSumaCampo3 +  nSumaCampo4
     nSuma = nSuma       + nSumaCampo6 + #dsmoc110#25 + #dsmoc110#26 + #dsmoc110#27 + #dsmoc110#28;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     nImporte   = 0;
     enImporte1 = 0;
     enImporte2 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     #dsm190li#0  = #dsmoc110#0;
     #dsm190li#1  = #dsmoc110#1;
     #dsm190li#6  = #dsmoc110#6;
     #dsm190li#7  = #dsmoc110#7;
     enError = 1;

     |HAZ GrabaDatosNif;

     #dsm190li#0  = #dsmoc110#0;
     #dsm190li#1  = #dsmoc110#1;
     #dsm190li#6  = #dsmoc110#6;

     |ABRE #agidanif;
     #agidanif#0  = #dsm190li#6;
     #agidanif#1  = 1;
     |LEE 040#agidanif.=;
     |SI FSalida ! 0;  |DDEFECTO #agidanif; |FINSI;
     |CIERRA #agidanif;

     nTRelacion = #agidanif#36;

     #dsm190li#0  = #dsmoc110#0;
     #dsm190li#1  = #dsmoc110#1;
     #dsm190li#2  = 99;
     #dsm190li#3  = 190;
     #dsm190li#4  = enComplem;
     #dsm190li#5  = 0;
     #dsm190li#6  = #dsmoc110#6;
     #dsm190li#7  = #dsmoc110#7;
     #dsm190li#8  = #dsmoc110#8;
     #dsm190li#9  = #dsmoc110#9;
     #dsm190li#10 = 0;
     |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;
     |LEE 101#dsm190li.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm190li;
         #dsm190li#0  = #dsmoc110#0;
         #dsm190li#1  = #dsmoc110#1;
         #dsm190li#2  = 99;
         #dsm190li#3  = 190;
         #dsm190li#4  = enComplem;
         #dsm190li#5  = 0;
         #dsm190li#6  = #dsmoc110#6;
         #dsm190li#7  = #dsmoc110#7;
         #dsm190li#8  = #dsmoc110#8;
         #dsm190li#9  = #dsmoc110#9;
         #dsm190li#10 = 0;
         |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;

         eaCodNif = #dsm190li#6;
         |HAZ LeeNifs;

         #dsm190li#12 = #regisnif@#1;
         #dsm190li#13 = #regisnif@#4;

         |HAZ CalculaDatosNif;

         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
             #dsm190li#14 = 0;  #dsm190li#21 = 0;  #dsm190li#22 = 0;  #dsm190li#23 = 0;
             #dsm190li#24 = 0;  #dsm190li#25 = 0;  #dsm190li#26 = 0;

             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;

             |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;
         |FINSI;

         |SI #dsm190li#26 ! 2;
             #dsm190li#27 = "";
         |FINSI;

         |GRABA 020#dsm190li.b;
     |SINO;
         enImporte1 = 0;
         enImporte2 = 0;
         enImporte3 = 0;
         enImporte4 = 0;
     |FINSI;

     #dsm190li#21 = #dsm190li#21 + #dsmoc110#25 + enImporte1;
     #dsm190li#22 = #dsm190li#22 + #dsmoc110#26 + enImporte2;
     #dsm190li#23 = #dsm190li#23 + #dsmoc110#27 + enImporte3;
     #dsm190li#24 = #dsm190li#24 + #dsmoc110#28 + enImporte4;

     |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
         #dsm190li#14 = 0;
         #dsm190li#21 = 0;
         #dsm190li#22 = 0;
         #dsm190li#23 = 0;
         #dsm190li#24 = 0;
         #dsm190li#25 = 0;
         #dsm190li#26 = 0;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;
     |FINSI;
     |GRABA 020#dsm190li.a;
     |LIBERA #dsm190li;
     nSwHay = 1;

    |SI #dsmom107#21 = "S";
        nImporte = #dsmoc110#26;
        nOpera = 1; |HAZ GraboAuxiliar;
    |FINSI;
|FPRC;

|DEFBUCLE dsmoc110Reg;
     #dsmoc110#1;
     ;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nDComplem, 99, "            ", 0000, " ", "  ";
     #dsmow013#0, #dsmow013#2, Periodo, 110, nHComplem, 99, "zzzzzzzzzzzz", 9999, "z", "zz";
     ;
     NULL, GrabaPerceptor190Reg;
|FIN;

|PROCESO BuscaRelacion;
     |SI #espejo1@#24 = "S";
         nTRelacion = #espejo1@#11;
         enBRela    = 1;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaRelacion;
     #espejo1@#3006;
     ;
     #dsmoc111#6, "A", #dsmoc111#0, #dsmoc111#1, 00, "";
     #dsmoc111#6, "A", #dsmoc111#0, #dsmoc111#1, 99, "z";
     ;
     NULL, BuscaRelacion;
|FIN;

|PROCESO SoloClaveA;
     #dsm190co@#0 = #dsm190li#0;
     #dsm190co@#1 = #dsm190li#1;
     #dsm190co@#2 = #dsm190li#2;
     #dsm190co@#3 = #dsm190li#3;
     #dsm190co@#4 = #dsm190li#4;
     #dsm190co@#5 = #dsm190li#5;
     #dsm190co@#6 = #dsm190li#6;
     #dsm190co@#7 = #dsm190li#7;
     #dsm190co@#8 = "A";
     #dsm190co@#9 = "  ";
     #dsm190co@#10 = #dsm190li#10;
     |LEE 041#dsm190co@.=;
     |SI FSalida = 0;
         #dsm190li#21 = #dsm190co@#21;
         #dsm190li#22 = #dsm190co@#22;
         #dsm190li#23 = #dsm190co@#23;
         #dsm190li#24 = #dsm190co@#24;
         |GRABA 020#dsm190li.a;
     |FINSI;
     |LIBERA #dsm190li;
|FPRC;

|DEFBUCLE SoloClaveA;
     #dsm190li#1;
     ;
     #dsmow013#0, #dsmow013#2, 99, 190, enComplem, 00, "            ", 0000, "A", "01", 0;
     #dsmow013#0, #dsmow013#2, 99, 190, enComplem, 00, "zzzzzzzzzzzz", 9999, "A", "02", 9;
     be;
     NULL, SoloClaveA;
|FIN;

|PROCESO GastosEsp;
     nSiEsta = 0;
     |SI #dsm190li#8 = "A"; |Y #dsm190li#9 = "02"; |Y #dsmow013#2 = 2015;
         |ABRE #espejo1@;
         |DDEFECTO #espejo1@;
         #espejo1@#0 = #dsmoc111#0;
         #espejo1@#1 = #dsmoc111#1;
         #espejo1@#2 = #dsmoc111#2;
         #espejo1@#3 = #dsmoc111#3;
         #espejo1@#4 = #dsmoc111#4;
         #espejo1@#5 = #dsmoc111#5;
         #espejo1@#6 = #dsmoc111#6;
         #espejo1@#7 = #dsmoc111#7;
         #espejo1@#8 = #dsmoc111#8;
         #espejo1@#9 = #dsmoc111#9;
         #espejo1@#10 = "01";
         #espejo1@#11 = #dsmoc111#11;
         |LEE 041#espejo1@.=;
         |SI FSalida = 0;
             nSiEsta = 1;
             |SI #espejo1@#17 ] 0; |Y #espejo1@#18 ] 0; |Y #espejo1@#19 ] 0; |Y #espejo1@#20 ] 0;
                 |CIERRA #espejo1@;
                 |ACABA;
             |FINSI;
             |SI #dsmoc111#5 = 99;
                 |CIERRA #espejo1@;
                 |ACABA;
             |FINSI;
         |FINSI;
         |CIERRA #espejo1@;
     |FINSI;

     #dsm190co@#0 = #dsm190li#0;
     #dsm190co@#1 = #dsm190li#1;
     #dsm190co@#2 = #dsm190li#2;
     #dsm190co@#3 = #dsm190li#3;
     #dsm190co@#4 = #dsm190li#4;
     #dsm190co@#5 = #dsm190li#5;
     #dsm190co@#6 = #dsm190li#6;
     #dsm190co@#7 = #dsm190li#7;
     #dsm190co@#8 = "A";
     #dsm190co@#9 = "  ";
     #dsm190co@#10 = #dsm190li#10;
     |LEE 041#dsm190co@.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm190co@;
         #dsm190co@#0 = #dsm190li#0;
         #dsm190co@#1 = #dsm190li#1;
         #dsm190co@#2 = #dsm190li#2;
         #dsm190co@#3 = #dsm190li#3;
         #dsm190co@#4 = #dsm190li#4;
         #dsm190co@#5 = #dsm190li#5;
         #dsm190co@#6 = #dsm190li#6;
         #dsm190co@#7 = #dsm190li#7;
         #dsm190co@#8 = "A";
         #dsm190co@#9 = "  ";
         #dsm190co@#10 = #dsm190li#10;
         |GRABA 020#dsm190co@.b;
    |FINSI;

    |SI #dsmoc111#5 ! 99;
        |SI enImporte1 ! 0; |O enImporte3 ! 0; |O enImporte4 ! 0;
            #dsm190co@#21 = enImporte1;
            #dsm190co@#23 = enImporte3;
            #dsm190co@#24 = enImporte4;
        |SINO;
            |SI nSiEsta = 0;
                #dsm190co@#21 = #dsm190co@#21 + #dsmoc111#17;
                #dsm190co@#23 = #dsm190co@#23 + #dsmoc111#19;
                #dsm190co@#24 = #dsm190co@#24 + #dsmoc111#20;
            |SINO;
                |SI #espejo1@#17 < 0; #dsm190co@#21 = #dsm190co@#21 + #dsmoc111#17; |FINSI;
                |SI #espejo1@#19 < 0; #dsm190co@#23 = #dsm190co@#23 + #dsmoc111#19; |FINSI;
                |SI #espejo1@#20 < 0; #dsm190co@#24 = #dsm190co@#25 + #dsmoc111#20; |FINSI;
            |FINSI;
        |FINSI;
        |SI nSiEsta = 0;
            #dsm190co@#22 = #dsm190co@#22 + #dsmoc111#18;
        |SINO;
            |SI #espejo1@#18 < 0; #dsm190co@#22 = #dsm190co@#22 + #dsmoc111#18; |FINSI;
        |FINSI;
    |SINO;
         #dsm190co@#21 = #dsm190co@#21 + #dsmoc111#17 + enImporte1;
         #dsm190co@#22 = #dsm190co@#22 + #dsmoc111#18 + enImporte2;
         #dsm190co@#23 = #dsm190co@#23 + #dsmoc111#19 + enImporte3;
         #dsm190co@#24 = #dsm190co@#24 + #dsmoc111#20 + enImporte4;
    |FINSI;
    |GRABA 020#dsm190co@.a;
    |LIBERA #dsm190co@;
|FPRC;

|PROCESO dsmoc111;
     |SI #dsmoc111#6 = "PASEANTERIOR";  |ACABA;  |FINSI;
     |SI #dsmoc111#6 = "MANUAL      ";  |ACABA;  |FINSI;

     nSumaCampo1  = #dsmoc111#12;
     nSumaCampo2  = #dsmoc111#13;
     nSumaCampo3  = #dsmoc111#14;
     nSumaCampo4  = #dsmoc111#15;
     nSumaCampo5  = #dsmoc111#16;

     nSumaCampo4 = nSumaCampo4 + nSumaCampo5;

     nSuma = nSumaCampo1 + nSumaCampo2 + nSumaCampo3 +  nSumaCampo4;
     nSuma = nSuma       + nSumaCampo6 + #dsmoc111#17 + #dsmoc111#18 + #dsmoc111#19 + #dsmoc111#20;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     nImporte   = 0;
     enImporte1 = 0;
     enImporte2 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     #dsm190li#0  = #dsmoc111#0;
     #dsm190li#1  = #dsmoc111#1;
     #dsm190li#6  = #dsmoc111#6;
     #dsm190li#7  = #dsmoc111#7;

     #dsm190li#8  = #dsmoc111#9;
     #dsm190li#9  = #dsmoc111#10;
     enError = 1;
     enTRela = #dsmoc111#11;
     enBRela = 0;
     nTRelacion = #dsmoc111#11;
     |BUCLE BuscaRelacion;

     |HAZ GrabaDatosNif;

     #dsm190li#0  = #dsmoc111#0;
     #dsm190li#1  = #dsmoc111#1;
     #dsm190li#6  = #dsmoc111#6;

     #dsm190li#0  = #dsmoc111#0;
     #dsm190li#1  = #dsmoc111#1;
     #dsm190li#2  = 99;
     #dsm190li#3  = 190;
     #dsm190li#4  = enComplem;
     #dsm190li#5  = 0;
     #dsm190li#6  = #dsmoc111#6;
     #dsm190li#7  = #dsmoc111#7;
     #dsm190li#8  = #dsmoc111#9;
     #dsm190li#9  = #dsmoc111#10;
     #dsm190li#10 = 0;
     |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;
     |LEE 101#dsm190li.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm190li;
         #dsm190li#0  = #dsmoc111#0;
         #dsm190li#1  = #dsmoc111#1;
         #dsm190li#2  = 99;
         #dsm190li#3  = 190;
         #dsm190li#4  = enComplem;
         #dsm190li#5  = 0;
         #dsm190li#6  = #dsmoc111#6;
         #dsm190li#7  = #dsmoc111#7;
         #dsm190li#8  = #dsmoc111#9;
         #dsm190li#9  = #dsmoc111#10;
         #dsm190li#10 = 0;
         |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;

         eaCodNif = #dsm190li#6;
         |HAZ LeeNifs;

         #dsm190li#12 = #regisnif@#1;
         #dsm190li#13 = #regisnif@#4;

         |HAZ CalculaDatosNif;

         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
             #dsm190li#14 = 0;  #dsm190li#21 = 0;  #dsm190li#22 = 0;  #dsm190li#23 = 0;
             #dsm190li#24 = 0;  #dsm190li#25 = 0;  #dsm190li#26 = 0;

             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;

             |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;
         |FINSI;

         |SI #dsm190li#26 ! 2;
             #dsm190li#27 = "";
         |FINSI;

         |GRABA 020#dsm190li.b;
     |FINSI;

     |SI enMasivo = 0;
         |SI #dsm190li#8 = "A"; |O #dsm190li#8 = "B";  |O #dsm190li#8 = "C";  |O #dsm190li#8 = "D"; || ...  |O #dsm190li#8 = "E"; Tique 98_2962
             |SI #dsm190li#14 = 0;  |O #dsm190li#26 = 0;
                 aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                 |SI nLaImpresora = 0; |HAZ LaImprMasivo; |FINSI;
                 |IMPRIME aVariable;
             |SINO;
||  El enError = 1 significa que no esta en laboral, pero ahora es desde 110
||                 |SI enError = 1;
||                     aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
||                     |SI nLaImpresora = 0; |HAZ LaImprMasivo; |FINSI;
||                     |IMPRIME aVariable;
||                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #dsm190li#8 = "A"; |O #dsm190li#8 = "B";  |O #dsm190li#8 = "C";  |O #dsm190li#8 = "D"; || ...  |O #dsm190li#8 = "E"; 98_2962
             |SI #dsm190li#14 = 0;  |O #dsm190li#26 = 0;
                 aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
                 |HAZ GrabaError;
             |SINO;
||                 |SI enError = 1;
||                     aVariable = "NIF : " + #dsm190li#6 + " REVISAR DATOS PERSONALES, PUEDEN ESTAR INCOMPLETOS";
||                     |HAZ GrabaError;
||                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #dsm190li#16 = #dsm190li#16 + nSumaCampo1;
     #dsm190li#17 = #dsm190li#17 + nSumaCampo2;
     #dsm190li#18 = #dsm190li#18 + nSumaCampo3;
     #dsm190li#19 = #dsm190li#19 + nSumaCampo4;
     #dsm190li#20 = #dsm190li#20 + nSumaCampo5;

     |SI #dsm190li#20 > #dsm190li#19;
         #dsm190li#20 = #dsm190li#19;
     |FINSI;

     |SI #dsmoc111#5 ! 99;
         |SI #dsmow013#2 > 2011;
             |SI enImporte1 ! 0; |O enImporte3 ! 0; |O enImporte4 ! 0;
                  #dsm190li#21 = enImporte1;
                  #dsm190li#23 = enImporte3;
                  #dsm190li#24 = enImporte4;
             |SINO;
                 #dsm190li#21 = #dsm190li#21 + #dsmoc111#17;
                 #dsm190li#23 = #dsm190li#23 + #dsmoc111#19;
                 #dsm190li#24 = #dsm190li#24 + #dsmoc111#20;
             |FINSI;
             #dsm190li#22 = #dsm190li#22 + #dsmoc111#18;

             |SI #dsmow013#2 ] 2015; |Y #dsm190li#8 = "A";
                 |HAZ GastosEsp;
             |FINSI;
         |SINO;
             |SI enImporte1 ! 0; |O enImporte2 ! 0; |O enImporte3 ! 0; |O enImporte4 ! 0;
                  #dsm190li#21 = enImporte1;
                  #dsm190li#22 = enImporte2;
                  #dsm190li#23 = enImporte3;
                  #dsm190li#24 = enImporte4;
             |SINO;
                 #dsm190li#21 = #dsm190li#21 + #dsmoc111#17;
                 #dsm190li#22 = #dsm190li#22 + #dsmoc111#18;
                 #dsm190li#23 = #dsm190li#23 + #dsmoc111#19;
                 #dsm190li#24 = #dsm190li#24 + #dsmoc111#20;
             |FINSI;
         |FINSI;
         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
              nImporte =  0;
         |SINO;
              nImporte = #dsm190li#22;
              |SI #dsmom107#21 = "S"; nOpera = 2; |HAZ GraboAuxiliar; |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
         #dsm190li#14 = 0;
         #dsm190li#21 = 0;
         #dsm190li#22 = 0;
         #dsm190li#23 = 0;
         #dsm190li#24 = 0;
         #dsm190li#25 = 0;
         #dsm190li#26 = 0;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;
     |FINSI;

     |SI #dsm190li#16 ! 0; |O #dsm190li#17 ! 0; |O #dsm190li#18 ! 0;
         |O #dsm190li#19 ! 0; |O #dsm190li#20 ! 0; |O #dsm190li#21 ! 0;
           |O #dsm190li#22 ! 0; |O #dsm190li#23 ! 0; |O #dsm190li#24 ! 0;
            |GRABA 020#dsm190li.a;
         nSwHay = 1;
     |SINO;
         |BORRA 020#dsm190li.a;
     |FINSI;
     |LIBERA #dsm190li;
|FPRC;

|DEFBUCLE dsmoc111;
     #dsmoc111#1;
     ;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nDComplem, 01, "            ", 0000, 00, " ", "  ", 0;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nHComplem, 99, "zzzzzzzzzzzz", 9999, 99, "z", "zz", 9;
     ;
     NULL, dsmoc111;
|FIN;

|PROCESO dsmoc111Reg;
     |SI #dsmoc111#6 = "PASEANTERIOR";  |ACABA;  |FINSI;
     |SI #dsmoc111#6 = "MANUAL      ";  |ACABA;  |FINSI;

     nSumaCampo1  = #dsmoc111#12;
     nSumaCampo2  = #dsmoc111#13;
     nSumaCampo3  = #dsmoc111#14;
     nSumaCampo4  = #dsmoc111#15;
     nSumaCampo5  = #dsmoc111#16;

     nSumaCampo4 = nSumaCampo4 + nSumaCampo5;

     nSuma = nSumaCampo1 + nSumaCampo2 + nSumaCampo3 +  nSumaCampo4;
     nSuma = nSuma       + nSumaCampo6 + #dsmoc111#17 + #dsmoc111#18 + #dsmoc111#19 + #dsmoc111#20;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     nImporte   = 0;
     enImporte1 = 0;
     enImporte2 = 0;
     enImporte3 = 0;
     enImporte4 = 0;

     #dsm190li#0  = #dsmoc111#0;
     #dsm190li#1  = #dsmoc111#1;
     #dsm190li#6  = #dsmoc111#6;
     #dsm190li#7  = #dsmoc111#7;
     #dsm190li#8  = #dsmoc111#9;
     #dsm190li#9  = #dsmoc111#10;
     enError = 1;
     enTRela = #dsmoc111#11;
     enBRela = 0;
     nTRelacion = #dsmoc111#11;
     |BUCLE BuscaRelacion;

     |HAZ GrabaDatosNif;

     #dsm190li#0  = #dsmoc111#0;
     #dsm190li#1  = #dsmoc111#1;
     #dsm190li#6  = #dsmoc111#6;

     nTRelacion = #dsmoc111#11;
     |BUCLE BuscaRelacion;

     #dsm190li#0  = #dsmoc111#0;
     #dsm190li#1  = #dsmoc111#1;
     #dsm190li#2  = 99;
     #dsm190li#3  = 190;
     #dsm190li#4  = enComplem;
     #dsm190li#5  = 0;
     #dsm190li#6  = #dsmoc111#6;
     #dsm190li#7  = #dsmoc111#7;
     #dsm190li#8  = #dsmoc111#9;
     #dsm190li#9  = #dsmoc111#10;
     #dsm190li#10 = 0;
     |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;
     |LEE 101#dsm190li.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm190li;
         #dsm190li#0  = #dsmoc111#0;
         #dsm190li#1  = #dsmoc111#1;
         #dsm190li#2  = 99;
         #dsm190li#3  = 190;
         #dsm190li#4  = enComplem;
         #dsm190li#5  = 0;
         #dsm190li#6  = #dsmoc111#6;
         #dsm190li#7  = #dsmoc111#7;
         #dsm190li#8  = #dsmoc111#9;
         #dsm190li#9  = #dsmoc111#10;
         #dsm190li#10 = 0;
         |SI #dsm190li#8 = "A";  #dsm190li#10 = nTRelacion;  |FINSI;

         eaCodNif = #dsm190li#6;
         |HAZ LeeNifs;

         #dsm190li#12 = #regisnif@#1;
         #dsm190li#13 = #regisnif@#4;

         |HAZ CalculaDatosNif;

         |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
             #dsm190li#14 = 0;  #dsm190li#21 = 0;  #dsm190li#22 = 0;  #dsm190li#23 = 0;
             #dsm190li#24 = 0;  #dsm190li#25 = 0;  #dsm190li#26 = 0;

             |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;

             |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
                   #dsm190li#nCampoD# = 0;
             |SIGUE;
         |FINSI;

         |SI #dsm190li#26 ! 2;
             #dsm190li#27 = "";
         |FINSI;

         |GRABA 020#dsm190li.b;
     |SINO;
         enImporte1 = 0;
         enImporte2 = 0;
         enImporte3 = 0;
         enImporte4 = 0;
     |FINSI;

     #dsm190li#21 = #dsm190li#21 + #dsmoc111#17 + enImporte1;
     #dsm190li#22 = #dsm190li#22 + #dsmoc111#18 + enImporte2;
     #dsm190li#23 = #dsm190li#23 + #dsmoc111#19 + enImporte3;
     #dsm190li#24 = #dsm190li#24 + #dsmoc111#20 + enImporte4;

     |SI #dsm190li#2 ] 2015; |Y #dsm190li#8 = "A";
         |HAZ GastosEsp;
     |FINSI;

     |SI #dsm190li#8 ! "A"; |Y #dsm190li#8 ! "B";  |Y #dsm190li#8 ! "C";  |Y #dsm190li#8 ! "E";
         #dsm190li#14 = 0;
         #dsm190li#21 = 0;
         #dsm190li#22 = 0;
         #dsm190li#23 = 0;
         #dsm190li#24 = 0;
         #dsm190li#25 = 0;
         #dsm190li#26 = 0;

         |PARA nCampoD = 28;  |SI nCampoD [ 38;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;

         |PARA nCampoD = 41;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
               #dsm190li#nCampoD# = 0;
         |SIGUE;
     |FINSI;
     |GRABA 020#dsm190li.a;
     |LIBERA #dsm190li;
     nSwHay = 1;

    |SI #dsmom107#21 = "S";
        nImporte = #dsmoc111#18;
        nOpera = 1; |HAZ GraboAuxiliar;
    |FINSI;
|FPRC;

|DEFBUCLE dsmoc111Reg;
     #dsmoc111#1;
     ;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nDComplem, 99, "            ", 0000, 00, " ", "  ", 0;
     #dsmow013#0, #dsmow013#2, Periodo, 110, nHComplem, 99, "zzzzzzzzzzzz", 9999, 99, "z", "zz", 9;
     ;
     NULL, dsmoc111Reg;
|FIN;

|PROCESO LaImprMasivo;
     |SI enMasivo = 0; |Y nLaImpresora = 0;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
         nLaImpresora = 1;
     |FINSI;
|FPRC;

|PROCESO Pase190_2015;
     |ABRE #dsmom107;
     |DDEFECTO #dsmom107;
     |LEE 040#dsmom107.p;
     |CIERRA #dsmom107;

     aFichero = ("x" + Usuario) % 108;
     |NOME_DAT #dsmow107#aFichero#;
     |DELINDEX #dsmow107;

     nLaImpresora = 0;
     enNumError   = 0;                    || para graba los errores
     |ABRE #dsmom004;
     #dsmom004#0 = #dsmow013#0;
     #dsmom004#1 = #dsmow013#2;
     #dsmom004#2 = #dsmow013#3;
     #dsmom004#3 = #dsmow013#7;
     #dsmom004#4 = #dsmow013#9;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |CIERRA #dsmom004; |ACABA;   |FINSI;
     |CIERRA #dsmom004;

     enSwPartir    = 0;
     enEmpresa     = #dsmow013#0;
     enEjer        = #dsmow013#2;
     enPeriodo     = #dsmow013#3;
     enModelo      = #dsmow013#7;
     enComplem     = #dsmom004#4;
     enActividad   = 0;
     enTipoEntrada = 3;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm190ca";

     |ABRE #dsm190li;
     |ABRE #dsmow107;

     |SI #dsmow013#2 [ 2010;
         |PARA Periodo = 1;  |SI Periodo [ 12;  |HACIENDO Periodo = Periodo + 1;
               nDComplem = -1;
               |ABRE #dsmoc110;
               |DDEFECTO #dsmoc110;
               #dsmoc110#0 = #dsmow013#0;
               #dsmoc110#1 = #dsmow013#2;
               #dsmoc110#2 = Periodo
               #dsmoc110#3 = 110;
               #dsmoc110#4 = 99;
               |LEE 040#dsmoc110.];
               |SI FSalida = 0;
                   |LEE 040#dsmoc110.a;
               |SINO;
                   |LEE 040#dsmoc110.u;
               |FINSI;
               |SI FSalida = 0; |Y #dsmoc110#0 = #dsmow013#0; |Y #dsmoc110#1 = #dsmow013#2;
                        |Y #dsmoc110#2 = Periodo; |Y #dsmoc110#3 = 110;
                            nDComplem = #dsmoc110#4;
                            nHComplem = #dsmoc110#4;
               |FINSI;
               |CIERRA #dsmoc110;
               |SI nDComplem ] 0;
                  |BUCLE dsmoc110;
                  |BUCLE dsmoc110Reg;       || por el 110.
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #dsmow013#2 ] 2011;
         |DBASE aPathModelo;  |QBT aPathModelo;
         aDef = aPathModelo + "def/dsmoc111.mas";
         |CARGA_DEF aDef, espejo1@;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         aDef = aPathModelo + "def/dsm190li.mas";
         |CARGA_DEF aDef, dsm190co@;
         |SI FSalida ! 0;  |DESCARGA_DEF #espejo1@; |ACABA;  |FINSI;
         aFichero = "9y" + Usuario;
         |NOME_DAT #dsm190co@#aFichero#;
         |DELINDEX #dsm190co@;

         enSwPartir = 0;
         |PARA Periodo = 1;  |SI Periodo [ 12;  |HACIENDO Periodo = Periodo + 1;
               nDComplem = -1;
               |ABRE #dsmoc111;
               |DDEFECTO #dsmoc111;
               #dsmoc111#0 = #dsmow013#0;
               #dsmoc111#1 = #dsmow013#2;
               #dsmoc111#2 = Periodo
               #dsmoc111#3 = 110;
               #dsmoc111#4 = 99;
               |LEE 040#dsmoc111.];
               |SI FSalida = 0;
                   |LEE 040#dsmoc111.a;
               |SINO;
                   |LEE 040#dsmoc111.u;
               |FINSI;
               |SI FSalida = 0; |Y #dsmoc111#0 = #dsmow013#0; |Y #dsmoc111#1 = #dsmow013#2;
                        |Y #dsmoc111#2 = Periodo; |Y #dsmoc111#3 = 110;
                            nDComplem = #dsmoc111#4;
                            nHComplem = #dsmoc111#4;
               |FINSI;
               |CIERRA #dsmoc111;
               |SI nDComplem ] 0;
                  |ABRE #dsm190co@;
                  |BUCLE dsmoc111;
                  |BUCLE dsmoc111Reg;       || por el 111.
                  |SI #dsmow013#2 ] 2015;
                      |CIERRA #dsm190li;
                      |BUCLE SoloClaveA;
                      |ABRE #dsm190li;
                  |FINSI;
                  |CIERRA #dsm190co@;

               |FINSI;
         |SIGUE;

         |DESCARGA_DEF #dsm190co@;
         |DESCARGA_DEF #espejo1@;
     |FINSI;

     |CIERRA #dsmow107;
     |CIERRA #dsm190li;

     |SI nSwHay = 0;
         |SI enMasivo = 0;
             |MENAV "      Seleccion Vacia";
             |CONFI "0000NDesea Crear el Modelo sin Actividad ";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |SINO;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #dsmom107#21 = "S"; |Y #dsmow013#2 [ 2011; |HAZ RecojoGastos; |FINSI;

     enEmpresa     = #dsmow013#0;
     enEjer        = #dsmow013#2;
     enPeriodo     = #dsmow013#3;
     enModelo      = #dsmow013#7;
     enComplem     = #dsmom004#4;
     enActividad   = 0;
     enTipoEntrada = 98;
     enMensa       = 1;
     |SUB_EJECUTA_NP "dsm190ca";

     |ABRE #dsmom004;
     #dsmom004#0 = #dsmow013#0;
     #dsmom004#1 = #dsmow013#2;
     #dsmom004#2 = #dsmow013#3;
     #dsmom004#3 = #dsmow013#7;
     #dsmom004#4 = #dsmow013#9;
     |LEE 101#dsmom004.=;
     |SI FSalida = 0;
         #dsmom004#7  = "X";
         #dsmom004#8  = ~;
         #dsmom004#15 = 0;
         #dsmom004#17 = "COMPLETADO";

         |GRABA 020#dsmom004.a;
         |LIBERA #dsmom004;
     |FINSI;
     |CIERRA #dsmom004;

     |SI enMasivo = 0; |Y nLaImpresora = 1;
         |FINIMP;
     |FINSI;
     |DELINDEX #dsmow107;
|FPRC;
