|FICHEROS;
     dsmom107 #107;
|FIN;

|VARIABLES;
     aAlfa        =  "";
     aAlfa1       =  "";
     aPass1       =  "";
     aPass2       =  "";

     &eaPass      =  "";
|FIN;

|PROCESO PidePassword;
    |PUSHV 1824 2342;
    |BLANCO 1824 2342;
    |CUADRO 1824 2342;

    |ATRI R;
    |PINTA 1925, "    Password     ";
    |PINTA 2125, " Repita password ";
    |ATRI 0;

    E_inf = "";
    E_sup = 10;

    aPass1    = "";
    aPass1    = 2028 ? -1;
    eaPass    = aPass1;  |HAZ PonPassword;
    aPass1    = eaPass;

    aPass2    = "";
    aPass2    = 2228 ? -1;
    eaPass    = aPass2;  |HAZ PonPassword;
    aPass2    = eaPass;

    |SI aPass1 ! aPass2;
        |MENAV "0000Password incorrecto.";
    |SINO;
        #dsmom107#34 = aPass1;
    |FINSI;

    |POPV;
|FPRC;

|PROCESO Tipo0C35;  |TIPO 0;
     |SI #dsmom107#35 = "N";
         aAlfa = #dsmom107#34;  |QBF aAlfa;
         |SI aAlfa = "";  |ACABA;  |FINSI;

         |PUSHV 2025 2035
         |MENSA "     Introduzca Password Actual";
         E_inf = "";
         E_sup = 10;
         eaPass = "";
         eaPass = 2025 ? -1;
         |HAZ PonPassword;
         |SI eaPass ! #dsmom107#34;
             |MENAV "0000Password actual incorrecto";

             #dsmom107#35 = "S";  |PINTA #dsmom107#35;
         |SINO;
             #dsmom107#35 = "N";  |PINTA #dsmom107#35;
             #dsmom107#34 = "";
         |FINSI;

         |POPV;

         |ERROR;
         |ACABA;
     |FINSI;

     |SI #dsmom107#35 = "S";
         aAlfa = #dsmom107#34;  |QBF aAlfa;
         |SI aAlfa ! "";  |ACABA;  |FINSI;

         |HAZ PidePassword;

         |SI aPass1 ! aPass2;
             #dsmom107#35 = "N";  |PINTA #dsmom107#35;
             #dsmom107#34 = "";
         |FINSI;
     |FINSI;

     |SI #dsmom107#35 = "M";
         aAlfa = #dsmom107#34;  |QBF aAlfa;
         |SI aAlfa = "";
             #dsmom107#35 = "N";  |PINTA #dsmom107#35;
             #dsmom107#34 = "";

             |ERROR;
             |ACABA;
         |FINSI;

         |MENSA "     Introduzca Password Actual";

         |PUSHV 2025 2035
         E_inf = "";
         E_sup = 10;
         eaPass = "";
         eaPass = 2025 ? -1;
         |HAZ PonPassword;
         |SI eaPass ! #dsmom107#34;
             |MENAV "0000Password actual incorrecto";

             #dsmom107#35 = "S";  |PINTA #dsmom107#35;

             |POPV;
             |ERROR;
             |ACABA;
         |FINSI;
         |POPV;

         |HAZ PidePassword;

         #dsmom107#35 = "S";  |PINTA #dsmom107#35;

         |ERROR;
     |FINSI;
|FPRC;

|CALCULO Antes10; |TIPO 7;
  |C_M #107#10,1,"S";
  |C_M #107#12,1,"S";
  |SI #107#9 = "N";
      #107#10 = "N"; |PINTA #107#10;
      |C_M #107#10,1,"N";
      |C_M #107#12,1,"N";
  |FINSI;
|FCAL;

|CALCULO AbreTabla; |TIPO 0;
  |SI #107#31 = "S"; |Y FSalida = 0;
      |SUB_EJECUTA "dsmoz073;control";
  |FINSI;
|FCAL;

|PROGRAMA;
     |ABRET #107;
     |LEE 101#107p;
     |SI FSalida ! 0;
         |DDEFECTO #107;
         |GRABA 020#107b;
     |FINSI;

     |CLS;
     |CABEZA "Control de Firmas";

     |PINPA #0#107;
     |PINDA #0#107;
     |ENDATOS #1#107;
     |SI FSalida = 0;
         |GRABA 020#107a;
     |FINSI;
     |LIBERA #107;
     |CIERRAT #107;
|FPRO;
