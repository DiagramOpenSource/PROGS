|FICHEROS;
     dsmoy000 #0;
     dsmom004 #4;
     dsmom107 #107;
     dsmow600 #600;
     dsmow601 #601,MANTE;

     dsmod131 #131;
     dsmow014 #999;
     dsmow511 #511;
     dsmow512 #512;
     dsmow543 #543;
     dsmow571 #571;
     dsmow577 #577;
     dsmow594 #594;

     &regisnif@ #709;
     &clientes@ #715;
     &datosper@ #718;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_varemi;

|PROCESO Registro131;
     |DDEFECTO #511;

     #511#1  = "131";
     #511#2  = "01";
     #511#3  = "";

     |SI enSwDeDonde = 1;
         #511#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #511#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #511#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #511#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #511#6  = eaAlfa;
             #511#7  = ".";
         |FINSI;
         #511#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #511#9 = eaAlfa;
         #511#10 = #715#31 % 104;
         #511#11 = #715#32;
         #511#12 = #715#33;
         #511#13 = #715#34;
         #511#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #511#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #511#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #511#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #131#33 > 0;
             enModelo = 131;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #511#55 = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #511#56 = "X";  |FINSI;

             #511#57 = eaEntidad;
             #511#58 = eaOficina;
             #511#59 = eaDC;
             #511#60 = eaCuenta;
         |FINSI;
     |SINO;
         #511#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #511#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #511#6  = eaAlfa;
         #511#7   = ".";
         #511#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #511#9 = eaAlfa;
         #511#10 = #715#5 % 104;
         #511#11 = #715#6;
         #511#12 = #715#7;
         #511#13 = #715#8;
         #511#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #511#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #511#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #511#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #131#33 > 0;
             |SI #715#84 = "                    ";
                 #511#55  = "X";
             |SINO;
                 #511#56  = "X";
                 #511#57 = #715#81;
                 #511#58 = #715#82;
                 #511#59 = #715#83;
                 #511#60 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #511#18  = #131#1;

     |SI #131#2 = 3;   #511#19 = 1;  |FINSI;
     |SI #131#2 = 6;   #511#19 = 2;  |FINSI;
     |SI #131#2 = 9;   #511#19 = 3;  |FINSI;
     |SI #131#2 = 12;  #511#19 = 4;  |FINSI;

     #511#20 = #131#6;
     enNume  = #131#7;   |HAZ Conver12;  #511#21 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("0000" + nNume) % -104;
     #511#22 = aAlfa % 102;
     #511#23 = aAlfa % 302;
     enNume  = #131#9;   |HAZ Conver12;  #511#24 = eaAlfa;

     #511#25 = #131#10;
     enNume  = #131#11;  |HAZ Conver12;  #511#26 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("0000" + nNume) % -104;
     #511#27 = aAlfa % 102;
     #511#28 = aAlfa % 302;
     enNume  = #131#13;  |HAZ Conver12;  #511#29 = eaAlfa;

     #511#30 = #131#14;
     enNume  = #131#15;  |HAZ Conver12;  #511#31 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("0000" + nNume) % -104;
     #511#32 = aAlfa % 102;
     #511#33 = aAlfa % 302;
     enNume  = #131#17;  |HAZ Conver12;  #511#34 = eaAlfa;

     #511#35 = #131#18;
     enNume  = #131#19;  |HAZ Conver12;  #511#36 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("0000" + nNume) % -104;
     #511#37 = aAlfa % 102;
     #511#38 = aAlfa % 302;
     enNume  = #131#21;  |HAZ Conver12;  #511#39 = eaAlfa;

     #511#40 = #131#22;
     enNume  = #131#23;  |HAZ Conver12;  #511#41 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("0000" + nNume) % -104;
     #511#42 = aAlfa % 102;
     #511#43 = aAlfa % 302;
     enNume  = #131#25;  |HAZ Conver12;  #511#44 = eaAlfa;

     enNume = #131#26;  |HAZ Conver12;  #511#45 = eaAlfa;
     enNume = #131#27;  |HAZ Conver12;  #511#46 = eaAlfa;
     enNume = #131#28;  |HAZ Conver12;  #511#47 = eaAlfa;
     enNume = #131#29;  |HAZ Conver12;  #511#48 = eaAlfa;
     enNume = #131#30;  |HAZ Conver12;  #511#49 = eaAlfa;
     enNume = #131#31;  |HAZ Conver12;  #511#50 = eaAlfa;
     enNume = #131#32;  |HAZ Conver12;  #511#51 = eaAlfa;
     enNume = #131#33;  |HAZ Conver12;  #511#52 = eaAlfa;

     |SI #131#33 [ 0;
         #511#53 = "X";
         enNume = 0;        |HAZ Conver12;  #511#54 = eaAlfa;
     |SINO;
         enNume = #131#33;  |HAZ Conver12;  #511#54 = eaAlfa;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #511#66 = #511#15;
     #511#67 = eaDiaB;
     #511#68 = eaMesB;
     #511#69 = eaAnyoB;
     #511#70 = &13 + &10;
|FPRC;

|PROCESO Registro133;
     |DDEFECTO #512;

     #512#1  = "133";
     #512#2  = "01";
     #512#3  = "";

     |SI enSwDeDonde = 1;
         #512#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #512#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #512#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #512#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #512#6  = eaAlfa;
             #512#7  = ".";
         |FINSI;
         #512#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #512#9 = eaAlfa;
         #512#10 = #715#31 % 104;
         #512#11 = #715#32;
         #512#12 = #715#33;
         #512#13 = #715#34;
         #512#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #512#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #512#16 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;  #512#17 = eaAlfa;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;

         |SI #131#33 > 0;
             enModelo = 131;  enForzar = 0;  |HAZ CogeDatosBancos;

             |SI eaFormaPago = "1";  #512#56 = "X";  |FINSI;
             |SI eaFormaPago ! "1";  #512#57 = "X";  |FINSI;

             #512#58 = eaEntidad;
             #512#59 = eaOficina;
             #512#60 = eaDC;
             #512#61 = eaCuenta;
         |FINSI;
     |SINO;
         #512#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #512#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #512#6  = eaAlfa;
         #512#7   = ".";
         #512#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #512#9 = eaAlfa;
         #512#10 = #715#5 % 104;
         #512#11 = #715#6;
         #512#12 = #715#7;
         #512#13 = #715#8;
         #512#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #512#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #512#16 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #512#17 = eaAlfa;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;

         |SI #131#33 > 0;
             |SI #715#84 = "                    ";
                 #512#56  = "X";
             |SINO;
                 #512#57  = "X";
                 #512#58 = #715#81;
                 #512#59 = #715#82;
                 #512#60 = #715#83;
                 #512#61 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     #512#18  = #131#1;

     |SI #131#2 = 3;   #512#19 = 1;  |FINSI;
     |SI #131#2 = 6;   #512#19 = 2;  |FINSI;
     |SI #131#2 = 9;   #512#19 = 3;  |FINSI;
     |SI #131#2 = 12;  #512#19 = 4;  |FINSI;

     #512#20 = #131#6;
     enNume  = #131#7;   |HAZ Conver12;  #512#21 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("0000" + nNume) % -104;
     #512#22 = aAlfa % 102;
     #512#23 = aAlfa % 302;
     enNume  = #131#9;   |HAZ Conver12;  #512#24 = eaAlfa;

     #512#25 = #131#10;
     enNume  = #131#11;  |HAZ Conver12;  #512#26 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("0000" + nNume) % -104;
     #512#27 = aAlfa % 102;
     #512#28 = aAlfa % 302;
     enNume  = #131#13;  |HAZ Conver12;  #512#29 = eaAlfa;

     #512#30 = #131#14;
     enNume  = #131#15;  |HAZ Conver12;  #512#31 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("0000" + nNume) % -104;
     #512#32 = aAlfa % 102;
     #512#33 = aAlfa % 302;
     enNume  = #131#17;  |HAZ Conver12;  #512#34 = eaAlfa;

     #512#35 = #131#18;
     enNume  = #131#19;  |HAZ Conver12;  #512#36 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("0000" + nNume) % -104;
     #512#37 = aAlfa % 102;
     #512#38 = aAlfa % 302;
     enNume  = #131#21;  |HAZ Conver12;  #512#39 = eaAlfa;

     #512#40 = #131#22;
     enNume  = #131#23;  |HAZ Conver12;  #512#41 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("0000" + nNume) % -104;
     #512#42 = aAlfa % 102;
     #512#43 = aAlfa % 302;
     enNume  = #131#25;  |HAZ Conver12;  #512#44 = eaAlfa;

     enNume = #131#26;  |HAZ Conver12;  #512#45 = eaAlfa;
     enNume = #131#27;  |HAZ Conver12;  #512#46 = eaAlfa;
     enNume = #131#28;  |HAZ Conver12;  #512#47 = eaAlfa;
     enNume = #131#29;  |HAZ Conver12;  #512#48 = eaAlfa;
     enNume = #131#30;  |HAZ Conver12;  #512#49 = eaAlfa;
     enNume = #131#31;  |HAZ Conver12;  #512#50 = eaAlfa;
     enNume = #131#32;  |HAZ Conver12;  #512#51 = eaAlfa;
     enNume = #131#33;  |HAZ Conver12;  #512#52 = eaAlfa;
     enNume = 0;        |HAZ Conver12;  #512#53 = eaAlfa;
     enNume = #131#33;  |HAZ Conver12;  #512#54 = eaAlfa;

     |SI #131#33 [ 0;
         #512#62 = "X";
         enNume = 0;        |HAZ Conver12;  #512#55 = eaAlfa;
     |SINO;
         enNume = #131#33;  |HAZ Conver12;  #512#55 = eaAlfa;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #512#70 = #512#15;
     #512#71 = eaDiaB;
     #512#72 = eaMesB;
     #512#73 = eaAnyoB;
     #512#74 = &13 + &10;
|FPRC;

|PROCESO Carga131_2001;
     |SI eaMoneda = "PESETAS";
         |HAZ Registro131;

         |SI nTecla = 1;
             aAlfa = "";
             |PARA nCampo = 1;  |SI nCampo [ 70;  |HACIENDO nCampo = nCampo + 1;
                   aAlfa = #511nCampo;
                   |XGRABA nHandle2, aAlfa;
             |SIGUE;
             |XCIERRA nHandle2;

             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;
         |FINSI;
     |SINO;
         |SI nTecla = 4;
             |HAZ Registro131;
         |SINO;
             |HAZ Registro133;
         |FINSI;

         |SI nTecla = 1;
             aAlfa = "";
             |PARA nCampo = 1;  |SI nCampo [ 74;  |HACIENDO nCampo = nCampo + 1;
                   aAlfa = #512nCampo;
                   |XGRABA nHandle2, aAlfa;
             |SIGUE;
             |XCIERRA nHandle2;

             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;
         |FINSI;
     |FINSI;

     |SI nTecla = 1;
         aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "wait mipf " + "131" + (("00000" + #999#0) % -105) + ".TXT";

         |SI #600#0 = "N";  aAlfa = aAlfa + " s";  |FINSI;
         |SI #600#1 = "S";  aAlfa = aAlfa + " a";  |FINSI;
         aAlfa = aAlfa + " " + #600#2;
         aAlfa = aAlfa + &13 + &10;
         |XGRABA nHandle1, aAlfa;

         aAlfa = "move errores.txt err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
         aAlfa = aAlfa + &13 + &10;

         |XGRABA nHandle1, aAlfa;
     |FINSI;

     |SI nTecla = 4;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO CargaImprime131;
     aAlfa = "del err" + (("00000" + #999#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:131" + (("00000" + #999#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #999#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO TDeclaracion131;
    |SI #131#33 > 0;
        enNume = #131#33;  |HAZ Conver13;  #543#52 = eaAlfa;

        enModelo = 131;  enForzar = 0;  |HAZ CogeDatosBancos;

        |SI eaFormaPago = "1";  #543#53 = "X";  |FINSI;
        |SI eaFormaPago ! "1";  #543#54 = "X";  |FINSI;

        #543#55 = eaEntidad;
        #543#56 = eaOficina;
        #543#57 = eaDC;
        #543#58 = eaCuenta;
     |SINO;
        enNume  = 0;  |HAZ Conver13;  #543#52 = eaAlfa;
     |FINSI;

     #543#4 = "";
     |SI nTecla ! 3;
         |SI #131#33 [ 0;  #543#4 = "N";  |FINSI;
     |SINO;
         #543#4 = "N";
         |SI #131#33 > 0;  #543#4 = "I";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga131_2002;
     enCodCli = #131#0;
     |HAZ LeePersona;

     |DDEFECTO #543;

     #543#1  = "131";
     #543#2  = "01";
     #543#3  = "";

     |SI enSwDeDonde = 1;
         #543#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #543#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #543#7   = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #543#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #543#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #543#8  = eaAlfa;
             #543#9  = ".";
         |FINSI;
         #543#10 = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #543#11 = eaAlfa;
         #543#12 = #715#31 % 104;
         #543#13 = #715#32;
         #543#14 = #715#33;
         #543#15 = #715#34;
         #543#16 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #543#17 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;       #543#18 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #543#19 = eaAlfa;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #543#61 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #543#62 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #543#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #543#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #543#8   = eaAlfa;
         #543#9   = ".";
         #543#10  = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #543#11  = eaAlfa;
         #543#12 = #715#5 % 104;
         #543#13 = #715#6;
         #543#14 = #715#7;
         #543#15 = #715#8;
         #543#16 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #543#17 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #543#18 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #543#19 = eaAlfa;
         eaAlfa  = #715#96;  |HAZ QuitaRaros;     #543#61 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno; #543#62 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #543#20  = #131#1;

     |SI #131#2 = 3;   #543#21 = "1T";  |FINSI;
     |SI #131#2 = 6;   #543#21 = "2T";  |FINSI;
     |SI #131#2 = 9;   #543#21 = "3T";  |FINSI;
     |SI #131#2 = 12;  #543#21 = "4T";  |FINSI;

     #543#22 = #131#6;
     enNume  = #131#7;   |HAZ Conver13;  #543#23 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("00000" + nNume) % -105;
     #543#24 = aAlfa;
     enNume  = #131#9;   |HAZ Conver13;  #543#25 = eaAlfa;

     #543#26 = #131#10;
     enNume  = #131#11;  |HAZ Conver13;  #543#27 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("00000" + nNume) % -105;
     #543#28 = aAlfa;
     enNume  = #131#13;  |HAZ Conver13;  #543#29 = eaAlfa;

     #543#30 = #131#14;
     enNume  = #131#15;  |HAZ Conver13;  #543#31 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("00000" + nNume) % -105;
     #543#32 = aAlfa;
     enNume  = #131#17;  |HAZ Conver13;  #543#33 = eaAlfa;

     #543#34 = #131#18;
     enNume  = #131#19;  |HAZ Conver13;  #543#35 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("00000" + nNume) % -105;
     #543#36 = aAlfa;
     enNume  = #131#21;  |HAZ Conver13;  #543#37 = eaAlfa;

     #543#38 = #131#22;
     enNume  = #131#23;  |HAZ Conver13;  #543#39 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("00000" + nNume) % -105;
     #543#40 = aAlfa;
     enNume  = #131#25;  |HAZ Conver13;  #543#41 = eaAlfa;

     enNume = #131#26;  |HAZ Conver13;  #543#42 = eaAlfa;
     enNume = #131#27;  |HAZ Conver13;  #543#43 = eaAlfa;
     enNume = #131#28;  |HAZ Conver13;  #543#44 = eaAlfa;
     enNume = #131#29;  |HAZ Conver13;  #543#45 = eaAlfa;
     enNume = #131#30;  |HAZ Conver13;  #543#46 = eaAlfa;
     enNume = #131#31;  |HAZ Conver13;  #543#47 = eaAlfa;
     enNume = #131#32;  |HAZ Conver13;  #543#48 = eaAlfa;
     enNume = #131#33;  |HAZ Conver13;  #543#49 = eaAlfa;
     enNume = 0;        |HAZ Conver13;  #543#50 = eaAlfa;
     enNume = #131#33;  |HAZ Conver13;  #543#51 = eaAlfa;

     |HAZ TDeclaracion131;

     |SI #131#4 > 0;
         #543#59 = #4#20;
         #543#60 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #543#72 = #543#17;
     #543#73 = eaDiaB;
     #543#74 = eaMesB;
     #543#75 = eaAnyoB;
     #543#76 = &13 + &10;

     |SI nTecla = 1;
         #543#7  = "";
         #543#59 = "";
         #543#62 = "";
         #543#63 = "";
         #543#64 = "";
         nTCampo = 76;
     |FINSI;

     |SI nTecla = 3;
         #543#2  = "";
         #543#3  = "";
         #543#5  = "";
         #543#8  = "";
         #543#9  = "";
         #543#10 = "";
         #543#11 = "";
         #543#12 = "";
         #543#13 = "";
         #543#14 = "";
         #543#15 = "";
         #543#16 = "";
         #543#17 = "";
         #543#18 = "";
         #543#19 = "";
         #543#53 = "";
         #543#54 = "";
         #543#55 = "";
         #543#56 = "";
         #543#57 = "";
         #543#58 = "";
         #543#67 = "";
         #543#68 = "";
         #543#69 = "";
         #543#70 = "";
         #543#71 = "";
         #543#72 = "";
         #543#73 = "";
         #543#74 = "";
         #543#75 = "";
         #543#76 = "";
         nTCampo = 75;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #543nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime131;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion131_2007;
     |SI #131#33 > 0;
         enNume = #131#33;  |HAZ Conver13;  #571#44 = eaAlfa;

         enModelo = 131;  enForzar = 0;  |HAZ CogeDatosBancos;

                                 #571#45 = "0";
         |SI eaFormaPago = "1";  #571#45 = "1";  |FINSI;
         |SI eaFormaPago = "2";  #571#45 = "2";  |FINSI;
         |SI eaFormaPago = "3";  |O  eaFormaPago = "4";  |O  eaFormaPago = "5";
                                 #571#45 = "2";
             |SI nTecla = 3;     #571#45 = eaFormaPago;  |FINSI;
         |FINSI;

         #571#46 = eaEntidad;
         #571#47 = eaOficina;
         #571#48 = eaDC;
         #571#49 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #571#44 = eaAlfa;
                                       #571#45 = "0";

         |SI #131#33 < 0;  #571#50 = "X";  |FINSI; || Incluir tambien el ultimo
     |FINSI;

     #571#4 = "";
     |SI nTecla ! 3;
         |SI #131#33 [ 0;  |Y #571#50 = " ";  #571#4 = "N";  |FINSI;
     |SINO;
                                              #571#4 = "B";

         |SI #131#33 = 0;                     #571#4 = "N";  |FINSI;

         |SI #131#33 > 0;
                                     #571#4 = "I";
             |SI eaFormaPago = "3";  #571#4 = "U";  |FINSI;
             |SI eaFormaPago = "4";  #571#4 = "A";  |FINSI;
             |SI eaFormaPago = "5";  #571#4 = "E";  |FINSI;
             |SI eaFormaPago = "6";  #571#4 = "G";  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga131_2007;
     enCodCli = #131#0;
     |HAZ LeePersona;

     |DDEFECTO #571;

     #571#1  = "131";
     #571#2  = "01";
     #571#3  = "";

     |SI enSwDeDonde = 1;
         #571#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #571#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #571#7   = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #571#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #571#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #571#8  = eaAlfa;
             #571#9  = ".";
         |FINSI;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #571#53 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #571#54 = eaAlfa;
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #571#59 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #571#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #571#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #571#8   = eaAlfa;
         #571#9   = ".";
         eaAlfa  = #715#96;  |HAZ QuitaRaros;      #571#53 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno;  #571#54 = eaAlfa;
         eaAlfa  = #715#11;  |HAZ QuitaRaros;      #571#59 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #571#10  = #131#1;

     |SI #131#2 = 3;   #571#11 = "1T";  |FINSI;
     |SI #131#2 = 6;   #571#11 = "2T";  |FINSI;
     |SI #131#2 = 9;   #571#11 = "3T";  |FINSI;
     |SI #131#2 = 12;  #571#11 = "4T";  |FINSI;

     #571#12 = #131#6;
     enNume  = #131#7;   |HAZ Conver13;  #571#13 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("00000" + nNume) % -105;
     #571#14 = aAlfa;
     enNume  = #131#9;   |HAZ Conver13;  #571#15 = eaAlfa;

     #571#16 = #131#10;
     enNume  = #131#11;  |HAZ Conver13;  #571#17 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("00000" + nNume) % -105;
     #571#18 = aAlfa;
     enNume  = #131#13;  |HAZ Conver13;  #571#19 = eaAlfa;

     #571#20 = #131#14;
     enNume  = #131#15;  |HAZ Conver13;  #571#21 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("00000" + nNume) % -105;
     #571#22 = aAlfa;
     enNume  = #131#17;  |HAZ Conver13;  #571#23 = eaAlfa;

     #571#24 = #131#18;
     enNume  = #131#19;  |HAZ Conver13;  #571#25 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("00000" + nNume) % -105;
     #571#26 = aAlfa;
     enNume  = #131#21;  |HAZ Conver13;  #571#27 = eaAlfa;

     #571#28 = #131#22;
     enNume  = #131#23;  |HAZ Conver13;  #571#29 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("00000" + nNume) % -105;
     #571#30 = aAlfa;
     enNume  = #131#25;  |HAZ Conver13;  #571#31 = eaAlfa;

     enNume = #131#26;  |HAZ Conver13;  #571#32 = eaAlfa;
     enNume = #131#34;  |HAZ Conver13;  #571#33 = eaAlfa;
     enNume = #131#35;  |HAZ Conver13;  #571#34 = eaAlfa;
     enNume = #131#29;  |HAZ Conver13;  #571#35 = eaAlfa;
     enNume = #131#30;  |HAZ Conver13;  #571#36 = eaAlfa;
     enNume = #131#36;  |HAZ Conver13;  #571#37 = eaAlfa;
     enNume = #131#37;  |HAZ Conver13;  #571#38 = eaAlfa;
     enNume = #131#38;  |HAZ Conver13;  #571#39 = eaAlfa;
     enNume = #131#39;  |HAZ Conver13;  #571#40 = eaAlfa;
     enNume = #131#40;  |HAZ Conver13;  #571#41 = eaAlfa;
     enNume = #131#41;  |HAZ Conver13;  #571#42 = eaAlfa;
     enNume = #131#33;  |HAZ Conver13;  #571#43 = eaAlfa;

     |HAZ TDeclaracion131_2007;

     |SI #131#4 > 0;
         #571#51 = #4#20;
         #571#52 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #571#60 = eaDiaB;
     #571#61 = eaMesB;
     #571#62 = eaAnyoB;
     #571#63 = &13 + &10;

     |SI nTecla = 1;
         #571#7  = "";
         #571#51 = "";
         #571#53 = "";
         #571#54 = "";
         #571#55 = "";
         nTCampo = 63;
     |FINSI;

     |SI nTecla = 3;
         #571#2  = "";
         #571#3  = "";
         #571#5  = "";
         #571#8  = "";
         #571#9  = "";
         #571#59 = "";
         #571#60 = "";
         #571#61 = "";
         #571#62 = "";
         #571#63 = "";
         nTCampo = 62;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #571nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime131;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion131_2008_04;
     |SI #131#33 > 0;
         enNume = #131#33;  |HAZ Conver13;  #577#45 = eaAlfa;

         enModelo = 131;  enForzar = 0;  |HAZ CogeDatosBancos;

                                  #577#46 = "0";
         |SI eaFormaPago = "1";   #577#46 = "1";  |FINSI;
         |SI eaFormaPago = "2";   #577#46 = "2";  |FINSI;
         |SI eaFormaPago = "3";  |O  eaFormaPago = "4";  |O  eaFormaPago = "5";
                                  #577#46 = "2";
              |SI nTecla = 3;     #577#46 = eaFormaPago;  |FINSI;
         |FINSI;

         #577#47 = eaEntidad;
         #577#48 = eaOficina;
         #577#49 = eaDC;
         #577#50 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #577#45 = eaAlfa;
                                       #577#46 = "0";

         |SI #131#33 < 0;  |Y #131#2 ! 12;  #577#51 = "X";  |FINSI;
     |FINSI;

     #577#4 = "";
     |SI nTecla ! 3;
         |SI #131#33 [ 0;  |Y #577#51 = " ";  #577#4 = "N";  |FINSI;
     |SINO;
         #577#4 = "N";
         |SI #131#33 = 0;                     #577#4 = "N";  |FINSI;
         |SI #131#33 < 0; |Y #131#2 ! 12;     #577#4 = "B";  |FINSI;

         |SI #131#33 > 0;
                                     #577#4 = "I";
             |SI eaFormaPago = "3";  #577#4 = "U";  |FINSI;
             |SI eaFormaPago = "4";  #577#4 = "A";  |FINSI;
             |SI eaFormaPago = "5";  #577#4 = "E";  |FINSI;
             |SI eaFormaPago = "6";  #577#4 = "G";  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga131_2008_04;
     enCodCli = #131#0;
     |HAZ LeePersona;

     |DDEFECTO #577;

     #577#1  = "131";
     #577#2  = "01";
     #577#3  = "";

     |SI enSwDeDonde = 1;
         #577#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #577#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #577#7   = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #577#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #577#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #577#8  = eaAlfa;
             #577#9  = ".";
         |FINSI;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #577#54 = eaAlfa;
         eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #577#55 = eaAlfa;
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #577#60 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #577#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #577#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #577#8   = eaAlfa;
         #577#9   = ".";
         eaAlfa  = #715#96;  |HAZ QuitaRaros;      #577#54 = eaAlfa;
         eaAlfa  = #715#14;  |HAZ QuitaRarosTfno;  #577#55 = eaAlfa;
         eaAlfa  = #715#11;  |HAZ QuitaRaros;      #577#60 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #577#10  = #131#1;

     |SI #131#2 = 3;   #577#11 = "1T";  |FINSI;
     |SI #131#2 = 6;   #577#11 = "2T";  |FINSI;
     |SI #131#2 = 9;   #577#11 = "3T";  |FINSI;
     |SI #131#2 = 12;  #577#11 = "4T";  |FINSI;

     #577#12 = #131#6;
     enNume  = #131#7;   |HAZ Conver13;  #577#13 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("00000" + nNume) % -105;
     #577#14 = aAlfa;
     enNume  = #131#9;   |HAZ Conver13;  #577#15 = eaAlfa;

     #577#16 = #131#10;
     enNume  = #131#11;  |HAZ Conver13;  #577#17 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("00000" + nNume) % -105;
     #577#18 = aAlfa;
     enNume  = #131#13;  |HAZ Conver13;  #577#19 = eaAlfa;

     #577#20 = #131#14;
     enNume  = #131#15;  |HAZ Conver13;  #577#21 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("00000" + nNume) % -105;
     #577#22 = aAlfa;
     enNume  = #131#17;  |HAZ Conver13;  #577#23 = eaAlfa;

     #577#24 = #131#18;
     enNume  = #131#19;  |HAZ Conver13;  #577#25 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("00000" + nNume) % -105;
     #577#26 = aAlfa;
     enNume  = #131#21;  |HAZ Conver13;  #577#27 = eaAlfa;

     #577#28 = #131#22;
     enNume  = #131#23;  |HAZ Conver13;  #577#29 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("00000" + nNume) % -105;
     #577#30 = aAlfa;
     enNume  = #131#25;  |HAZ Conver13;  #577#31 = eaAlfa;

     enNume = #131#26;  |HAZ Conver13;  #577#32 = eaAlfa;
     enNume = #131#34;  |HAZ Conver13;  #577#33 = eaAlfa;
     enNume = #131#35;  |HAZ Conver13;  #577#34 = eaAlfa;
     enNume = #131#29;  |HAZ Conver13;  #577#35 = eaAlfa;
     enNume = #131#30;  |HAZ Conver13;  #577#36 = eaAlfa;
     enNume = #131#36;  |HAZ Conver13;  #577#37 = eaAlfa;
     enNume = #131#37;  |HAZ Conver13;  #577#38 = eaAlfa;
     enNume = #131#42;  |HAZ Conver13;  #577#39 = eaAlfa;  ||campo minoracion

     enNume = #131#38;  |HAZ Conver13;  #577#40 = eaAlfa;
     enNume = #131#39;  |HAZ Conver13;  #577#41 = eaAlfa;
     enNume = #131#40;  |HAZ Conver13;  #577#42 = eaAlfa;
     enNume = #131#41;  |HAZ Conver13;  #577#43 = eaAlfa;
     enNume = #131#33;  |HAZ Conver13;  #577#44 = eaAlfa;

     |HAZ TDeclaracion131_2008_04;

     |SI #131#4 > 0;
         #577#52 = #4#20;
         #577#53 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #577#61 = eaDiaB;
     #577#62 = eaMesB;
     #577#63 = eaAnyoB;
     #577#64 = &13 + &10;

     |SI nTecla = 1;
         #577#7  = "";
         #577#52 = "";
         #577#54 = "";
         #577#55 = "";
         #577#56 = "";
         nTCampo = 64;
     |FINSI;

     |SI nTecla = 3;
         #577#2  = "";
         #577#3  = "";
         #577#5  = "";
         #577#8  = "";
         #577#9  = "";
         #577#60 = "";
         #577#61 = "";
         #577#62 = "";
         #577#63 = "";
         #577#64 = "";
         nTCampo = 63;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #577nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime131;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO TDeclaracion131_2009;
     |SI #131#33 > 0;
         enNume = #131#33;  |HAZ Conver13;  #594#47 = eaAlfa;

         enModelo = 131;  enForzar = 0;  |HAZ CogeDatosBancos;

                                  #594#48 = "0";
         |SI eaFormaPago = "1";   #594#48 = "1";  |FINSI;
         |SI eaFormaPago = "2";   #594#48 = "2";  |FINSI;
         |SI eaFormaPago = "3";   #594#48 = "3";  |FINSI;

|| |SI eaFormaPago = "4";  #594#48 = "4";  |FINSI;
|| |SI eaFormaPago = "5";  #594#48 = "5";  |FINSI;
|| |SI nTecla = 3;     #594#48 = eaFormaPago;  |FINSI;

         #594#49 = eaEntidad;
         #594#50 = eaOficina;
         #594#51 = eaDC;
         #594#52 = eaCuenta;
     |SINO;
         enNume  = 0;  |HAZ Conver13;  #594#47 = eaAlfa;
                                       #594#48 = "0";

         |SI #131#33 < 0;  |Y #131#2 ! 12;  #594#53 = "X";  |FINSI;
     |FINSI;

     #594#4 = "";
     |SI nTecla ! 3;
         |SI #131#33 [ 0;  |Y #594#53 = " ";  #594#4 = "N";  |FINSI;
     |SINO;
         #594#4 = "N";
         |SI #131#33 = 0;                     #594#4 = "N";  |FINSI;
         |SI #131#33 < 0; |Y #131#2 ! 12;     #594#4 = "B";  |FINSI;

         |SI #131#33 > 0;
                                                      #594#4 = "I";
             |SI eaFormaPago = "3";                   #594#4 = "U";  |FINSI;
             |SI eaFormaPago = "4";  |Y #0#6 < 2013;  #594#4 = "A";  |FINSI;
             |SI eaFormaPago = "5";  |Y #0#6 < 2013;  #594#4 = "E";  |FINSI;
             |SI eaFormaPago = "6";                   #594#4 = "G";  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga131_2009;
     enCodCli = #131#0;
     |HAZ LeePersona;

     |DDEFECTO #594;

     #594#1  = "131";
     #594#2  = "01";
     #594#3  = "";

     |SI enSwDeDonde = 1;
         #594#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #594#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #594#7   = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #594#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #594#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #594#8  = eaAlfa;
             #594#9  = ".";
         |FINSI;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #594#56 = eaAlfa;
         eaAlfa  = #715#55;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#55; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |SINO;
             eaAlfa  = #715#54; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |FINSI;
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #594#62 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #594#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #594#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #594#8   = eaAlfa;
         #594#9   = ".";
         eaAlfa  = #715#96;  |HAZ QuitaRaros;      #594#56 = eaAlfa;
         eaAlfa  = #715#61;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#61; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |SINO;
             eaAlfa  = #715#14; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |FINSI;
         eaAlfa  = #715#11;  |HAZ QuitaRaros;      #594#62 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #594#10  = #131#1;

     |SI #131#2 = 3;   #594#11 = "1T";  |FINSI;
     |SI #131#2 = 6;   #594#11 = "2T";  |FINSI;
     |SI #131#2 = 9;   #594#11 = "3T";  |FINSI;
     |SI #131#2 = 12;  #594#11 = "4T";  |FINSI;

     #594#12 = #131#6;
     enNume  = #131#7;   |HAZ Conver13;  #594#13 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#14 = aAlfa;
     enNume  = #131#9;   |HAZ Conver13;  #594#15 = eaAlfa;

     #594#16 = #131#10;
     enNume  = #131#11;  |HAZ Conver13;  #594#17 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#18 = aAlfa;
     enNume  = #131#13;  |HAZ Conver13;  #594#19 = eaAlfa;

     #594#20 = #131#14;
     enNume  = #131#15;  |HAZ Conver13;  #594#21 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#22 = aAlfa;
     enNume  = #131#17;  |HAZ Conver13;  #594#23 = eaAlfa;

     #594#24 = #131#18;
     enNume  = #131#19;  |HAZ Conver13;  #594#25 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#26 = aAlfa;
     enNume  = #131#21;  |HAZ Conver13;  #594#27 = eaAlfa;

     #594#28 = #131#22;
     enNume  = #131#23;  |HAZ Conver13;  #594#29 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#30 = aAlfa;
     enNume  = #131#25;  |HAZ Conver13;  #594#31 = eaAlfa;

     #131#43 = #131#7  + #131#11 + #131#15 + #131#19 + #131#23;

     enNume = #131#43;  |HAZ Conver13;  #594#32 = eaAlfa;
     enNume = #131#26;  |HAZ Conver13;  #594#33 = eaAlfa;
     enNume = #131#34;  |HAZ Conver13;  #594#34 = eaAlfa;
     enNume = #131#35;  |HAZ Conver13;  #594#35 = eaAlfa;
     enNume = #131#29;  |HAZ Conver13;  #594#36 = eaAlfa;
     enNume = #131#30;  |HAZ Conver13;  #594#37 = eaAlfa;
     enNume = #131#36;  |HAZ Conver13;  #594#38 = eaAlfa;
     enNume = #131#37;  |HAZ Conver13;  #594#39 = eaAlfa;
     enNume = #131#42;  |HAZ Conver13;  #594#40 = eaAlfa;  ||campo minoracion

     enNume = #131#38;  |HAZ Conver13;  #594#41 = eaAlfa;
     enNume = #131#39;  |HAZ Conver13;  #594#42 = eaAlfa;
     enNume = #131#44;  |HAZ Conver13;  #594#43 = eaAlfa;
     enNume = #131#40;  |HAZ Conver13;  #594#44 = eaAlfa;
     enNume = #131#41;  |HAZ Conver13;  #594#45 = eaAlfa;
     enNume = #131#33;  |HAZ Conver13;  #594#46 = eaAlfa;

     |HAZ TDeclaracion131_2009;

     |SI #131#4 > 0;
         #594#54 = #4#20;
         #594#55 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #594#63 = eaDiaB;
     #594#64 = eaMesB;
     #594#65 = eaAnyoB;
     #594#66 = &13 + &10;

     |SI nTecla = 1;
         #594#7  = "";
         #594#54 = "";
         #594#56 = "";
         #594#57 = "";
         #594#58 = "";
         nTCampo = 66;
     |FINSI;

     |SI nTecla = 3;
         #594#2  = "";
         #594#3  = "";
         #594#5  = "";
         #594#8  = "";
         #594#9  = "";
         #594#62 = "";
         #594#63 = "";
         #594#64 = "";
         #594#65 = "";
         #594#66 = "";
         nTCampo = 65;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 3;
         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #594nCampo;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         |XCIERRA nHandle2;

         |SI nTecla = 1;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ CargaImprime131;
         |FINSI;

         |SI nTecla = 3;
             eaFOrigen  = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
             eaFDestino = eaPathInternet + "131" + (("00000" + #999#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             |HAZ GrabaImpreso;
         |FINSI;
     |SINO;
         |PRINT;
         |PIEINF;
     |FINSI;
|FPRC;

|PROCESO QueHacemos131;
     |ABRE #4;
     #4#0  = #999#0;
     #4#1  = #999#1;
     #4#2  = #999#2;
     #4#3  = #999#5;
     #4#4  = #999#7;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #4;

     |ABRE #131;
     #131#0 = #4#0;
     #131#1 = #4#1;
     #131#2 = #4#2;
     #131#3 = #4#3;
     #131#4 = #4#4;
     #131#5 = 0;
     |LEE 040#131=;
     |SI FSalida ! 0;  |CIERRA #131;  |ACABA;  |FINSI;
     |CIERRA #131;

     |SI nTecla = 1;  |O nTecla = 3;
         aAbre = eaPathEmision + "131" + (("00000" + #999#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;
     |FINSI;

     enCodCli = #131#0;
     |HAZ LeePersona;

     |SI #0#6 [ 2001;
         |HAZ Carga131_2001;
     |FINSI;

     |SI #0#6 ] 2002;  |Y #0#6 [ 2006;
         |HAZ Carga131_2002;
     |FINSI;

     |SI #0#6 = 2007;
         |HAZ Carga131_2007;
     |FINSI;

     |SI #0#6 = 2008;
         |SI #0#4 ] 4;
             |HAZ Carga131_2008_04;
         |SINO;
             |HAZ Carga131_2007;
         |FINSI;
     |FINSI;

     |SI #0#6 ] 2009;
         |HAZ Carga131_2009;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014C131;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos131;
|FIN;

|DEFBUCLE dsmow014N131;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos131;
|FIN;

|PROCESO AbreImprime131;
     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD " + eaPathLanza + &13 + &10;    |XGRABA nHandle1, aAlfa;

     aAlfa    = #0#6;
     aAlfa    = aAlfa % -102;
     aVersion = "";

     |SI #0#6 ] 2008;
         aVersion = "01";
         |SI #0#6 = 2008;
             |SI #0#4 ] 4;
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + eaPathLanza + &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + eaPathLanza + &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO EmiteEsto131_2001;
     aAlfa = "DEL die*.*" + &13 + &10;         |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL mipf32.exe"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL wait.exe"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;         |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.imp"  + &13 + &10;         |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |DBASS aModelos;  |QBT aModelos;
     aModelos = aModelos + "basica/";
     eaFOrigen  = aModelos + "patrones/zls01mpf.exe";
     eaFDestino = eaPathLanza + "zls01mpf.exe";
     |HAZ CopiaFichero;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |HAZ BuscaErroresL;
|FPRC;

|PROCESO EmiteEsto131_2002;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL mipf32.exe"  + &13 + &10;       |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL wait.exe"  + &13 + &10;         |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     |HAZ Copiampf;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     eaFichError = "err";
     eaFichDatos = #0#0;
     eaFichAuxil = "";

     |HAZ BuscaErroresL;
|FPRC;

|PROCESO Boton1311;
     |PTEC 824;
|FPRC;

|PROCESO Boton1312;
     |PTEC 825;
|FPRC;

|PROCESO Boton1313;
     |PTEC 826;
|FPRC;

|PROCESO Boton1314;
     |PTEC 827;
|FPRC;

|PROCESO Boton1315;
     |PTEC 806;
|FPRC;

|PROCESO Botones131;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser          ", 0513, 0754, Boton1311;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Continuo       ", 0913, 1154, Boton1312;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica              ", 1313, 1554, Boton1313;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de Comprobacion              ", 1713, 1954, Boton1314;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1315;
     nBoton5 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1;   |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF4;  nTecla = 3;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF6;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;

     |PULSATECLA;
|FPRC;

|PROCESO Bloque2012;
     |SI eaParametro ! "131C";
         |HAZ Botones131;
     |SINO;
         nTecla = 4;
     |FINSI;

     |SI nTecla = 0;  enInfComp = 1;  |ACABA;  |FINSI;
     |SI nTecla = 4;  enInfComp = 1;  |FINSI;

     |SI nTecla = 1;
         |HAZ CompruebaEjecutable;
         |SI enError = 1;  |ACABA;  |FINSI;

         |SI #0#6 [ 2001;
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #600;
                  |PINPA #0#600;
                  |PINDA #0#600;
                  |ENDATOS #1#600;
                  |SI FSalida = 0;
                      |HAZ AbreImprime131;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |SINO;
             |PARA;  |SI;  |HACIENDO;
                  #601#0 = #107#5;
                  #601#1 = #107#7;

                  |C_M #601#0, 1, "S";
                  |C_M #601#1, 1, "S";
                  |SI #107#6 = "N";  |C_M #601#0, 1, "N";  |FINSI;
                  |SI #107#8 = "N";  |C_M #601#1, 1, "N";  |FINSI;

                  nPedirPanta = 0;
                  |SI #107#6 = "N";  |Y #107#8 = "N";  |Y #107#7 = "N";
                      nPedirPanta = 1;
                  |FINSI;

                  FSalida = 0;
                  |SI nPedirPanta = 0;
                      |PINPA #0#601;
                      |PINDA #0#601;
                      |ENDATOS #1#601;
                  |FINSI;

                  |SI FSalida = 0;
                      |HAZ AbreImprime131;
                      |SAL;
                  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |SI nTecla = 2;
         |MENAV "     Opcion no instalada";
         |ACABA;
     |FINSI;

     |SI nTecla = 3;
         |SI #0#6 [ 2001;
             |MENAV "     Opcion no instalada";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI nTecla = 4;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #0#6 [ 2001; |INFOR "m131co01";  |FINSI;
         |SI #0#6 ] 2002; |Y #0#6 [ 2006;  |INFOR "m131co02";  |FINSI;
         |SI #0#6 = 2007; |INFOR "m131co03";  |FINSI;

         |SI #0#6 = 2008;
             |SI #0#4 ] 4;
                 |INFOR "m131co04";
             |SINO;
                 |INFOR "m131co03";
             |FINSI;
         |FINSI;

         |SI #0#6 ] 2009;
             |INFOR "m131co05";
         |FINSI;

         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
     |FINSI;

     nSwLee = 0;
     |SI #0#8 = "C";
         |BUCLE dsmow014C131;
     |SINO;
         |BUCLE dsmow014N131;
     |FINSI;

     |SI nTecla = 1;
         |SI #0#6 [ 2001;
             |HAZ EmiteEsto131_2001;
         |FINSI;

         |SI #0#6 ] 2002;
             |HAZ EmiteEsto131_2002;
         |FINSI;
     |FINSI;

     |SI nTecla = 3;
         aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;
     |FINSI;

     |SI nTecla = 4;
         |FININF;
         |FINIMP;
     |FINSI;
|FPRC;

|| ---------------------------------------------------------------------------
|PROCESO Carga131_2013;
     enCodCli = #131#0;
     |HAZ LeePersona;

     |DDEFECTO #594;

     #594#1  = "131";
     #594#2  = "01";
     #594#3  = "";

     |SI enSwDeDonde = 1;
         #594#5   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #594#6   = eaVarDni;
         eaAlfa   = #715#57; |HAZ QuitaRaros;     #594#7   = eaAlfa;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #594#8 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #594#9 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #594#8  = eaAlfa;
             #594#9  = ".";
         |FINSI;
         eaAlfa  = #715#53;  |HAZ QuitaRaros;       #594#56 = eaAlfa;
         eaAlfa  = #715#55;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#55; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |SINO;
             eaAlfa  = #715#54; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |FINSI;
         eaAlfa  = #715#37;  |HAZ QuitaRaros;       #594#62 = eaAlfa;
         eaDeleg = #715#17;
         eaAdmin = #715#18;
     |SINO;
         aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
         #594#5   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #594#6   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #594#8   = eaAlfa;
         #594#9   = ".";
         eaAlfa  = #715#96;  |HAZ QuitaRaros;      #594#56 = eaAlfa;
         eaAlfa  = #715#61;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#61; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |SINO;
             eaAlfa  = #715#14; |HAZ QuitaRarosTfno; #594#57 = eaAlfa;
         |FINSI;
         eaAlfa  = #715#11;  |HAZ QuitaRaros;      #594#62 = eaAlfa;
         eaDeleg = #715#91;
         eaAdmin = #715#92;
     |FINSI;

     #594#10  = #131#1;

     |SI #131#2 = 3;   #594#11 = "1T";  |FINSI;
     |SI #131#2 = 6;   #594#11 = "2T";  |FINSI;
     |SI #131#2 = 9;   #594#11 = "3T";  |FINSI;
     |SI #131#2 = 12;  #594#11 = "4T";  |FINSI;

     #594#12 = #131#6;
     enNume  = #131#7;   |HAZ Conver13;  #594#13 = eaAlfa;
     nNume   = #131#8  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#14 = aAlfa;
     enNume  = #131#9;   |HAZ Conver13;  #594#15 = eaAlfa;

     #594#16 = #131#10;
     enNume  = #131#11;  |HAZ Conver13;  #594#17 = eaAlfa;
     nNume   = #131#12  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#18 = aAlfa;
     enNume  = #131#13;  |HAZ Conver13;  #594#19 = eaAlfa;

     #594#20 = #131#14;
     enNume  = #131#15;  |HAZ Conver13;  #594#21 = eaAlfa;
     nNume   = #131#16  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#22 = aAlfa;
     enNume  = #131#17;  |HAZ Conver13;  #594#23 = eaAlfa;

     #594#24 = #131#18;
     enNume  = #131#19;  |HAZ Conver13;  #594#25 = eaAlfa;
     nNume   = #131#20  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#26 = aAlfa;
     enNume  = #131#21;  |HAZ Conver13;  #594#27 = eaAlfa;

     #594#28 = #131#22;
     enNume  = #131#23;  |HAZ Conver13;  #594#29 = eaAlfa;
     nNume   = #131#24  * 100; aAlfa = ("00000" + nNume) % -105;
     #594#30 = aAlfa;
     enNume  = #131#25;  |HAZ Conver13;  #594#31 = eaAlfa;

     #131#43 = #131#7  + #131#11 + #131#15 + #131#19 + #131#23;

     enNume = #131#43;  |HAZ Conver13;  #594#32 = eaAlfa;
     enNume = #131#26;  |HAZ Conver13;  #594#33 = eaAlfa;
     enNume = #131#34;  |HAZ Conver13;  #594#34 = eaAlfa;
     enNume = #131#35;  |HAZ Conver13;  #594#35 = eaAlfa;
     enNume = #131#29;  |HAZ Conver13;  #594#36 = eaAlfa;
     enNume = #131#30;  |HAZ Conver13;  #594#37 = eaAlfa;
     enNume = #131#36;  |HAZ Conver13;  #594#38 = eaAlfa;
     enNume = #131#37;  |HAZ Conver13;  #594#39 = eaAlfa;
     enNume = #131#42;  |HAZ Conver13;  #594#40 = eaAlfa;  ||campo minoracion

     enNume = #131#38;  |HAZ Conver13;  #594#41 = eaAlfa;
     enNume = #131#39;  |HAZ Conver13;  #594#42 = eaAlfa;
     enNume = #131#44;  |HAZ Conver13;  #594#43 = eaAlfa;
     enNume = #131#40;  |HAZ Conver13;  #594#44 = eaAlfa;
     enNume = #131#41;  |HAZ Conver13;  #594#45 = eaAlfa;
     enNume = #131#33;  |HAZ Conver13;  #594#46 = eaAlfa;

     |HAZ TDeclaracion131_2009;

     |SI #131#4 > 0;
         #594#54 = #4#20;
         #594#55 = #4#21;
     |FINSI;

     eaAlfa  = #0#7;  |HAZ FechaBonito;
     #594#63 = eaDiaB;
     #594#64 = eaMesB;
     #594#65 = eaAnyoB;
     #594#66 = &13 + &10;

     |SI nTecla = 1;
         #594#7  = "";
         #594#54 = "";
         #594#56 = "";
         #594#57 = "";
         #594#58 = "";
         nTCampo = 66;
     |FINSI;

     |SI nTecla = 3;
         #594#2  = "";
         #594#3  = "";
         #594#5  = "";
         #594#8  = "";
         #594#9  = "";
         #594#62 = "";
         #594#63 = "";
         #594#64 = "";
         #594#65 = "";
         #594#66 = "";
         nTCampo = 65;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #594nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO dsmow014_2013;

     |ABRE #4;
     #4#0  = #999#0;
     #4#1  = #999#1;
     #4#2  = #999#2;
     #4#3  = #999#5;
     #4#4  = #999#7;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #4;

     |ABRE #131;
     #131#0 = #4#0;
     #131#1 = #4#1;
     #131#2 = #4#2;
     #131#3 = #4#3;
     #131#4 = #4#4;
     #131#5 = 0;
     |LEE 040#131=;
     |SI FSalida ! 0;  |CIERRA #131;  |ACABA;  |FINSI;
     |CIERRA #131;

     eaFicheroPlano = "131" + (("00000" + #999#0) % -105) + ".txt";
     eaFicheroImpre = "131" + (("00000" + #999#0) % -105) + ".pdf";
     eaFicheroError = "err" + (("00000" + #999#0) % -105) + ".txt";

     aAlfa = eaPathLanza + eaFicheroPlano;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroImpre;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroError;  |RFBORRA aAlfa;

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     |HAZ Carga131_2013;

     |XCIERRA nHandle2;

     enEmpresa    = #999#0;
     eaNomEmpresa = #999#3;

     |SI enTecla = 3;
         eaFOrigen  = eaPathEmision  + eaFicheroPlano;
         eaFDestino = eaPathInternet + eaFicheroPlano;
         |HAZ CopiaFichero;

         |HAZ GrabaImpreso;
         |ACABA;
     |FINSI;

     |HAZ PresentaMPF;
|FPRC;

|DEFBUCLE dsmow014C_2013;
     #999#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, dsmow014_2013;
|FIN;

|DEFBUCLE dsmow014N_2013;
     #999#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, dsmow014_2013;
|FIN;

|PROCESO Bloque2013;
     |HAZ BotonesMPF;
     nTecla = enTecla;

     |SI nTecla = 0;  |ACABA;  |FINSI;

     nSwLee = 0;
     |SI #0#8 = "C";
         |BUCLE dsmow014C_2013;
     |SINO;
         |BUCLE dsmow014N_2013;
     |FINSI;

     |HAZ SacaErrorPtl;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO moy13101;
     |ABRE #107;
     |LEE 040#107p;
     |SI FSalida ! 0;
         |CIERRA #107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #107;
     |FINSI;

     |LEE 040#107p;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     enCambiaMoneda = 1;
     enSwTrata      = 0;

     |SI #0#6 [ 2012;  |O eaParametro= "131C";
         |HAZ Bloque2012;
         |ACABA;
     |FINSI;

     |HAZ Bloque2013;
|FPRC;
