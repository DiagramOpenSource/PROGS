|FICHEROS;
     dsmoz005 #0;
     dsmom017 #17;
     dsmom018 #18;
     dsmom019 #19;
     dsmom901 #901;
     dsmow007 #999,MANTE;
|FIN;

|VARIABLES;
     &enBoton1 = 0;
     &enBoton2 = 0;
     &enSw     = 0;
     &eaCodRenta  = "";
     &eaTituloL   = "";
|FIN;

|INCLUYE i_variar;

|PROCESO dsmom901I;
  |PRINT;
  enSw = 1;
|FPRC;

|DEFBUCLE dsmom901I;
  #901#1;
  ;
  #17#0, #17#1, #17#2, #17#3, 1;
  #17#0, #17#1, #17#2, #17#3, 99;
  ;
  NULL, dsmom901I;
|FIN;

|PROCESO Imprimelos;
     eaCodRenta  = "";

     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     |LEE 040#18=;
     |SI FSalida ! 0;  |DDEFECTO #18;  |FINSI;

     #19#0 = #17#0;
     #19#1 = #17#1;
     #19#2 = #17#2;
     #19#3 = #17#3;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

     enSw = 0;
     |SI #999#1 > 2009;
         |BUCLE dsmom901I;
     |FINSI;
     |SI enSw = 0;
         |DDEFECTO #901;
         |PRINT;
     |FINSI;
     |PIEINF;
|FPRC;

|DEFBUCLE dsmom017;
     #17#1;
     ;
     #999#0, #999#1, 00, 01;
     #999#0, #999#1, 99, 98;
     ;
     NULL, Imprimelos;
|FIN;

|PROCESO EmisionLinea;
     eaTituloL = "* INFORME MODULO *";
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #999#1 [ 2009;
         |INFOR "dsmoz006";
     |SINO;
         |INFOR "dsmoz106";
     |FINSI;

     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |ABRE #18;
     |ABRE #19;
     |BUCLE dsmom017;
     |CIERRA #18;
     |CIERRA #19;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Lee17;
     |BUCLE dsmom017;
|FPRC;

|DEFBUCLE dsmow007;
     #999#1;
     ;
     00001;
     99999;
     ;
     NULL, Lee17;
|FIN;

|PROCESO EmisionTodo;
     eaTituloL = "* INFORME MODULO *";

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #999#1 [ 2009;
         |INFOR "dsmoz006";
     |SINO;
         |INFOR "dsmoz106";
     |FINSI;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |ABRE #18;
     |ABRE #19;
     |BUCLE dsmow007;
     |CIERRA #18;
     |CIERRA #19;

     |FININF;
     |FINIMP;

     |PONCONTROL 23, "SI";
|FPRC;

|RUTINA ClaveBaja17;
     #17#0 = #999#0;
     #17#1 = #999#1;
     #17#2 = 00;
     #17#3 = 01;
|FRUT;

|RUTINA ClaveAlta17;
     #17#0 = #999#0;
     #17#1 = #999#1;
     #17#2 = 99;
     #17#3 = 98;
|FRUT;

|PROCESO Tipo7;  |TIPO 7;
     |ENTLINEAL #1#17, -4, 7, 22, 0, ClaveBaja17, ClaveAlta17;
|FPRC;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida = 10;
         enEmpresa = #dsmow007#0;
         |HAZ MiraBloqueo;
         |SI eaBloqueo = "3";
             |ACABA;
         |FINSI;

         |ESTADO_CONTROL enBoton1, "HIDE";
         |ESTADO_CONTROL enBoton2, "HIDE";
         |ENTLINEAL #1#17, -4, 4, 22, 0, ClaveBaja17, ClaveAlta17;
         |ESTADO_CONTROL enBoton1, "SHOW";
         |ESTADO_CONTROL enBoton2, "SHOW";
     |FINSI;

     |SI FSalida = 11;
         |HAZ EmisionLinea;
     |FINSI;

     |SI FSalida = 12;
         |HAZ EmisionTodo;
     |FINSI;
|FPRC;
