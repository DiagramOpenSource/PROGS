|FICHEROS;
     dsm18401;   || DEF general del modelo

     dsm18402,MANTE;
     dsm18403,MANTE;
     dsm18404,MANTE;
     dsm18405,MANTE;
     dsm18406,MANTE;
     dsm18407,MANTE;
     dsm18408,MANTE;
     dsm18409,MANTE;
     dsm18410,MANTE;
     dsm18411,MANTE;
     dsm18412,MANTE;
     dsm18413,MANTE;
     dsm18414,MANTE;
     dsm18415,MANTE;
     dsm18430,MANTE;
     dsm18431,MANTE;
     dsm18432,MANTE;

     dsmom004;
     dsm18401@;
|FIN;

|INCLUYE m18401va;
|INCLUYE i_variar;

||--------------------------------------------------------------------------

|PROCESO dsm18430Inm;
     #dsm18432#0  = #dsm18401#0;
     #dsm18432#1  = #dsm18401#1;
     #dsm18432#2  = #dsm18401#3;
     #dsm18432#3  = #dsm18405#3;
     #dsm18432#4  = #dsm18430#34;
     |LEE 101#dsm18432.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsm18432;

         #dsm18432#0  = #dsm18401#0;
         #dsm18432#1  = #dsm18401#1;
         #dsm18432#2  = #dsm18401#3;
         #dsm18432#3  = #dsm18405#3;

         #dsm18432#4  = #dsm18430#34;

         |GRABA 020#dsm18432.b;
     |FINSI;

     #dsm18432#5  = #dsm18430#2;
     #dsm18432#11 = #dsm18430#4;
     #dsm18432#6  = #dsm18405#16;
     #dsm18432#7  = #dsm18405#14;
     #dsm18432#9  = #dsm18405#15;

     |SI #dsm18432#8 = " ";  |O enCambio = 1;
         #dsm18432#8  = #dsm18405#17;
     |FINSI;

     |SI #dsm18432#10 = 0;  |O enCambio = 1;
         #dsm18432#10 = #dsm18405#18 % #dsm18430#11;
     |FINSI;

     #dsm18432#12 = #dsm18405#8  % #dsm18430#11;

     nReduc = #dsm18405#10;
     |SI nReduc > 300000;
         nReduc = 300000;
     |FINSI;

     #dsm18432#13 = (nReduc % #dsm18405#09) % #dsm18430#11;

     |GRABA 020#dsm18432.a;
     |LIBERA #dsm18432;
|FPRC;

|DEFBUCLE dsm18430Inm;
     #dsm18430#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, dsm18430Inm;
|FIN;

|PROCESO dsm18405Soc;
     enCambio = 0;
     |ABRE #dsm18432;
     |BUCLE dsm18430Inm;
     |CIERRA #dsm18432;
|FPRC;

|DEFBUCLE dsm18405Soc;
     #dsm18405#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     be;
     NULL, dsm18405Soc;
|FIN;

|PROCESO dsm18432Cheq;
     #dsm18405#0 = #dsm18432#0;
     #dsm18405#1 = #dsm18432#1;
     #dsm18405#2 = #dsm18432#2;
     #dsm18405#3 = #dsm18432#3;
     |LEE 000#dsm18405.=;
     |SI FSalida ! 0;
         |BORRA 020#dsm18432.a;
         |LIBERA #dsm18432;
         |ACABA;
     |FINSI;

     #dsm18430#0  = #dsm18432#0;
     #dsm18430#1  = #dsm18432#1;
     #dsm18430#33 = #dsm18432#2;
     #dsm18430#34 = #dsm18432#4;
     |LEE 000#dsm18430.=;
     |SI FSalida ! 0;
         |BORRA 020#dsm18432.a;
         |LIBERA #dsm18432;
         |ACABA;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18432Cheq;
     #dsm18432#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999, 999;
     be;
     NULL, dsm18432Cheq;
|FIN;

|PROCESO Refres18432;
     |BUCLE dsm18405Soc;

     |ABRE #dsm18405;
     |ABRE #dsm18430;
     |BUCLE dsm18432Cheq;
     |CIERRA #dsm18405;
     |CIERRA #dsm18430;
|FPRC;

|PROCESO RevExcesoA;
     |SI #dsm18403#12 = "N"; |Y #dsm18403#7 > #dsm18403#6;
        |DDEFECTO #dsm18414;
        #dsm18414#0 = #dsm18401#0;
        #dsm18414#1 = #dsm18401#1;
        #dsm18414#2 = #dsm18401#3;
        #dsm18414#3 = nLinea; nLinea = nLinea + 1;
        #dsm18414#4 = "A";
        #dsm18414#5 = #dsm18403#5;
        #dsm18414#6 = #dsm18403#7 - #dsm18403#6;
        #dsm18414#7 = #dsm18403#11;
        |GRABA 020#dsm18414.n;

        #dsm18403#8 = 0; |GRABA 020#dsm18403.a;
     |FINSI;
|FPRC;

|DEFBUCLE RevExcesoA;
     #dsm18403#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     be;
     NULL,RevExcesoA;
|FIN;

|PROCESO RevExcesoC;
     |SI #dsm18405#12 = "N"; |Y #dsm18405#7 > #dsm18405#6;
        |DDEFECTO #dsm18414;
        #dsm18414#0 = #dsm18401#0;
        #dsm18414#1 = #dsm18401#1;
        #dsm18414#2 = #dsm18401#3;
        #dsm18414#3 = nLinea; nLinea = nLinea + 1;
        #dsm18414#4 = "C";
        #dsm18414#5 = #dsm18405#5;
        #dsm18414#6 = #dsm18405#7 - #dsm18405#6;
        #dsm18414#7 = #dsm18405#11;
        |GRABA 020#dsm18414.n;

        #dsm18405#8 = 0; |GRABA 020#dsm18405.a;
     |FINSI;
|FPRC;

|DEFBUCLE RevExcesoC;
     #dsm18405#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     be;
     NULL,RevExcesoC;
|FIN;

|PROCESO RevExcesoD;
     |SI #dsm18431#10 = "N"; |Y #dsm18431#7 > #dsm18431#6;
        |DDEFECTO #dsm18414;
        #dsm18414#0 = #dsm18401#0;
        #dsm18414#1 = #dsm18401#1;
        #dsm18414#2 = #dsm18401#3;
        #dsm18414#3 = nLinea; nLinea = nLinea + 1;
        #dsm18414#4 = "D";
        #dsm18414#5 = #dsm18431#4;
        #dsm18414#6 = #dsm18431#7 - #dsm18431#6;
        #dsm18414#7 = #dsm18431#5;
        |GRABA 020#dsm18414.n;

        #dsm18431#8 = 0; |GRABA 020#dsm18431.a;
     |FINSI;
|FPRC;

|DEFBUCLE RevExcesoD;
     #dsm18431#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001, "  ", " ";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999, "zz", "z";
     be;
     NULL,RevExcesoD;
|FIN;

|PROCESO RevExcesoE;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont;
        |SI aPais = ""; |SAL; |FINSI;
        |SI aPais = #dsm18407#10;
           |SI #dsm18407#8 > #dsm18407#7;
              |DDEFECTO #dsm18414;
              #dsm18414#0 = #dsm18401#0;
              #dsm18414#1 = #dsm18401#1;
              #dsm18414#2 = #dsm18401#3;
              #dsm18414#3 = nLinea; nLinea = nLinea + 1;
              #dsm18414#4 = "E";
              #dsm18414#5 = #dsm18407#10;
              #dsm18414#6 = #dsm18407#8 - #dsm18407#7;
              #dsm18414#7 = #dsm18407#11;
              |GRABA 020#dsm18414.n;
           |FINSI;
        |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE RevExcesoE;
     #dsm18407#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL,RevExcesoE;
|FIN;

|PROCESO ExcesoE;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
        InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
        InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
     |SIGUE;

     |BUCLE RevExcesoE;
|FPRC;

|PROCESO RevExcesoF;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont;
        |SI aPais = ""; |SAL; |FINSI;
        |SI aPais = #dsm18408#4;
           |SI #dsm18408#5 = "G";
              InGast = nGast1<-; InGast = InGast + nCont;
              |SI nGast > #dsm18408#6;
                 |DDEFECTO #dsm18414;
                 #dsm18414#0 = #dsm18401#0;
                 #dsm18414#1 = #dsm18401#1;
                 #dsm18414#2 = #dsm18401#3;
                 #dsm18414#3 = nLinea; nLinea = nLinea + 1;
                 #dsm18414#4 = "F";
                 #dsm18414#5 = aPais;
                 #dsm18414#6 = nGast - #dsm18408#6;
                 #dsm18414#7 = aDescPais;
                 |GRABA 020#dsm18414.n;
              |FINSI;
           |SINO;
              InIngr = nIngr1<-; InIngr = InIngr + nCont;
              |SI nIngr < #dsm18408#6;
                 |DDEFECTO #dsm18414;
                 #dsm18414#0 = #dsm18401#0;
                 #dsm18414#1 = #dsm18401#1;
                 #dsm18414#2 = #dsm18401#3;
                 #dsm18414#3 = nLinea; nLinea = nLinea + 1;
                 #dsm18414#4 = "F";
                 #dsm18414#5 = aPais;
                 #dsm18414#6 = #dsm18408#6 - nIngr;
                 #dsm18414#7 = aDescPais;
                 |GRABA 020#dsm18414.n;
              |FINSI;
           |FINSI;
        |FINSI;
     |SIGUE;

     |SI aPais = "";
        aPais = #dsm18408#4; aDescPais = #dsm18408#8;
        |SI #dsm18408#5 = "G";
           InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = #dsm18408#6;
        |SINO;
           InGast = nGast1<-; InGast = InGast + nCont; nGast = #dsm18408#6;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RevExcesoF;
     #dsm18408#1;
     7;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001, "N";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999, "N";
     ;
     NULL,RevExcesoF;
|FIN;

|PROCESO ExcesoF;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
        InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
        InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
     |SIGUE;
     |BUCLE RevExcesoF;
|FPRC;

|PROCESO RevExcesoG;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont;
        |SI aPais = ""; |SAL; |FINSI;
        |SI aPais = #dsm18409#5;
           |SI #dsm18409#6 = "G";
              InGast = nGast1<-; InGast = InGast + nCont;
              |SI nGast > #dsm18409#7;
                 |DDEFECTO #dsm18414;
                 #dsm18414#0 = #dsm18401#0;
                 #dsm18414#1 = #dsm18401#1;
                 #dsm18414#2 = #dsm18401#3;
                 #dsm18414#3 = nLinea; nLinea = nLinea + 1;
                 #dsm18414#4 = "G";
                 #dsm18414#5 = aPais;
                 #dsm18414#6 = nGast - #dsm18409#7;
                 #dsm18414#7 = aDescPais;
                 |GRABA 020#dsm18414.n;
              |FINSI;
           |SINO;
              InIngr = nIngr1<-; InIngr = InIngr + nCont;
              |SI nIngr < #dsm18409#7;
                 |DDEFECTO #dsm18414;
                 #dsm18414#0 = #dsm18401#0;
                 #dsm18414#1 = #dsm18401#1;
                 #dsm18414#2 = #dsm18401#3;
                 #dsm18414#3 = nLinea; nLinea = nLinea + 1;
                 #dsm18414#4 = "G";
                 #dsm18414#5 = aPais;
                 #dsm18414#6 = #dsm18409#7 - nIngr;
                 #dsm18414#7 = aDescPais;
                 |GRABA 020#dsm18414.n;
              |FINSI;
           |FINSI;
        |FINSI;
     |SIGUE;

     |SI aPais = "";
        aPais = #dsm18409#5; aDescPais = #dsm18409#10;
        |SI #dsm18409#6 = "G";
           InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = #dsm18409#7;
        |SINO;
           InGast = nGast1<-; InGast = InGast + nCont; nGast = #dsm18409#7;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RevExcesoG;
     #dsm18409#1;
     8;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001, "N";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999, "N";
     ;
     NULL,RevExcesoG;
|FIN;

|PROCESO ExcesoG;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
        InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
        InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
     |SIGUE;
     |BUCLE RevExcesoG;
|FPRC;

|PROCESO RevExcesoM;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
        IaPais = aPais1<-; IaPais = IaPais + nCont;
        |SI aPais = ""; |SAL; |FINSI;
        |SI aPais = #dsm18415#4;
           |SI #dsm18415#5 = "G";
              InGast = nGast1<-; InGast = InGast + nCont;
              |SI nGast > #dsm18415#6;
                 |DDEFECTO #dsm18414;
                 #dsm18414#0 = #dsm18401#0;
                 #dsm18414#1 = #dsm18401#1;
                 #dsm18414#2 = #dsm18401#3;
                 #dsm18414#3 = nLinea; nLinea = nLinea + 1;
                 #dsm18414#4 = "F";
                 #dsm18414#5 = aPais;
                 #dsm18414#6 = nGast - #dsm18415#6;
                 #dsm18414#7 = aDescPais;
                 |GRABA 020#dsm18414.n;
              |FINSI;
           |SINO;
              InIngr = nIngr1<-; InIngr = InIngr + nCont;
              |SI nIngr < #dsm18415#6;
                 |DDEFECTO #dsm18414;
                 #dsm18414#0 = #dsm18401#0;
                 #dsm18414#1 = #dsm18401#1;
                 #dsm18414#2 = #dsm18401#3;
                 #dsm18414#3 = nLinea; nLinea = nLinea + 1;
                 #dsm18414#4 = "F";
                 #dsm18414#5 = aPais;
                 #dsm18414#6 = #dsm18415#6 - nIngr;
                 #dsm18414#7 = aDescPais;
                 |GRABA 020#dsm18414.n;
              |FINSI;
           |FINSI;
        |FINSI;
     |SIGUE;

     |SI aPais = "";
        aPais = #dsm18415#4; aDescPais = #dsm18415#8;
        |SI #dsm18415#5 = "G";
           InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = #dsm18415#6;
        |SINO;
           InGast = nGast1<-; InGast = InGast + nCont; nGast = #dsm18415#6;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RevExcesoM;
     #dsm18415#1;
     7;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001, "N";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999, "N";
     ;
     NULL, RevExcesoM;
|FIN;

|PROCESO ExcesoM;
     |PARA nCont = 0; |SI nCont [ 999; |HACIENDO nCont = nCont + 1;
         IaPais = aPais1<-; IaPais = IaPais + nCont; aPais = "";
         InIngr = nIngr1<-; InIngr = InIngr + nCont; nIngr = 0;
         InGast = nGast1<-; InGast = InGast + nCont; nGast = 0;
     |SIGUE;
     |BUCLE RevExcesoM;
|FPRC;

|PROCESO CalcExcesos;
     |ABRE #dsm18414;
     #dsm18414#0 = #dsm18401#0;
     #dsm18414#1 = #dsm18401#1;
     #dsm18414#2 = #dsm18401#3;
     #dsm18414#3 = 1;
     |LEE 000#dsm18414.];
     |PARA; |SI FSalida = 0; |Y #dsm18414#0 = #dsm18401#0; |Y #dsm18414#1 = #dsm18401#1;
             |Y #dsm18414#2 = #dsm18401#3; |HACIENDO;
        |BORRA 020#dsm18414.a; |LEE 000#dsm18414.s;
     |SIGUE;

     nLinea = 1;

     |BUCLE RevExcesoA;
     |BUCLE RevExcesoC;
     |BUCLE RevExcesoD;
     |HAZ   ExcesoF;
     |HAZ   ExcesoG;
     |HAZ   ExcesoM;
     |CIERRA #dsm18414;
|FPRC;

|PROCESO infPuntoM;
     #dsm18415#0 = #dsm18401#0;
     #dsm18415#1 = #dsm18401#1;
     #dsm18415#2 = #dsm18401#3;
     #dsm18415#3 = 001;
|FPRC;

|PROCESO supPuntoM;
     #dsm18415#0 = #dsm18401#0;
     #dsm18415#1 = #dsm18401#1;
     #dsm18415#2 = #dsm18401#3;
     #dsm18415#3 = 999;
|FPRC;

|PROCESO PuntoM;
     |PUSHV 0905 2276;

     |PINPA #0#dsm18415;
     |ATRI R; |PINTA 1006, aMenuGen9;
     |ATRI 0;

     |ENTLINEAL #1#dsm18415, -4, nModo, 20, 0, infPuntoM, supPuntoM;
     |HAZ CalcExcesos;
     |POPV;
|FPRC;

|PROCESO PuntoK;
     |PARA nCont = 50; |SI nCont [ 54; |HACIENDO nCont = nCont + 1;
        nCalc = nCont - 50;
        #dsm18413#nCalc# = #dsm18401#nCont#;
     |SIGUE;
     |PUSHV 0501 2380;
     |PINPA #0#dsm18413; |PINDA #0#dsm18413;
     |ENDATOS #1#dsm18413;
     |SI FSalida = 0;
        |PARA nCont = 50; |SI nCont [ 54; |HACIENDO nCont = nCont + 1;
           nCalc = nCont - 50;
           #dsm18401#nCont# = #dsm18413#nCalc#;
        |SIGUE;
        |GRABA 020#dsm18401.a;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO PuntoJ;
     |PARA nCont = 44; |SI nCont [ 49; |HACIENDO nCont = nCont + 1;
        nCalc = nCont - 44;
        #dsm18412#nCalc# = #dsm18401#nCont#;
     |SIGUE;

     |PUSHV 0501 2380;
     |PINPA #0#dsm18412;
     |SI #dsm18401#1 > 2006;
        |PINTA 1732, "42 ....";
     |FINSI;
     |SI #dsm18401#1 ] 2015;
         |C_M #dsm18412#0,1,"N"; |C_V #dsm18412#0,1,"N";
         |PINTA 1407, "01. Deducciones por doble imposicion internacional ....";
         |C_P #dsm18412#1, 1, 1463;
         |PINTA 1507, "02. Deducciones con limite de cuota ...................";
         |C_P #dsm18412#2, 1, 1563;
         |C_M #dsm18412#3,1,"N"; |C_V #dsm18412#3,1,"N";
         |PINTA 1607, "03. Deduccion por donativos a entidades sin fines lucra";
         |C_P #dsm18412#4, 1, 1663;
         |PINTA 1707, "04. Otras deducciones .................................";
         |C_P #dsm18412#5, 1, 1763;
         |PINTA 1807, "                                                        ";
         |PINTA 1907, "                                                        ";
     |FINSI;

     |SI #dsm18401#1 ] 2010;
         aAlfa = aMenuGen11;
         |SI #dsm18401#1 < 2015; aAlfa = aMenuGen12; |FINSI;
         |ATRI R; |PINTA 1006, aAlfa;
         |ATRI 0;
     |FINSI;

     |PINDA #0#dsm18412;
     |ENDATOS #1#dsm18412;
     |SI FSalida = 0;
        |PARA nCont = 44; |SI nCont [ 49; |HACIENDO nCont = nCont + 1;
           nCalc = nCont - 44;
           #dsm18401#nCont# = #dsm18412#nCalc#;
        |SIGUE;
        |GRABA 020#dsm18401.a;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO PuntoI;
   |PARA nCont = 38; |SI nCont [ 43; |HACIENDO nCont = nCont + 1;
      nCalc = nCont - 38;
      #dsm18411#nCalc# = #dsm18401#nCont#;
   |SIGUE;

   |PUSHV 0501 2380;
   |PINPA #0#dsm18411;

   |SI #dsm18401#1 < 2015;
      |C_M #dsm18411#4, 1, "N"; |C_V #dsm18411#4, 1, "N";
      |PINTA 1807, "                                                       ";
   |FINSI;
   |SI #dsm18401#1 [ 2006;
      |C_M #dsm18411#4, 1, "S"; |C_V #dsm18411#4, 1, "S";
      |PINTA 1707, "05. Deduccion por doble imposicion de dividendos ......";
      |PINTA 1807, "06. Deduccion por doble imposicion internacional ......";
      |C_P #dsm18411#4, 1, 1763;
      |C_P #dsm18411#5, 1, 1863;
   |FINSI;

   |SI #dsm18401#1 ] 2010;
      aAlfa = aMenuGen10;
      |SI #dsm18401#1 < 2015; aAlfa = aMenuGen11; |FINSI;
      |ATRI R; |PINTA 1006, aAlfa;
      |ATRI 0;
   |FINSI;

   |PINDA #0#dsm18411;
   |ENDATOS #1#dsm18411;
   |SI FSalida = 0;
      |PARA nCont = 38; |SI nCont [ 43; |HACIENDO nCont = nCont + 1;
         nCalc = nCont - 38;
         #dsm18401#nCont# = #dsm18411#nCalc#;
      |SIGUE;
      |GRABA 020#dsm18401.a;
   |FINSI;
   |POPV;
|FPRC;

|PROCESO PuntoH;
     |SI #dsm18401#56 = "N";
         |MENAV "0000Debe marcar Tributa en regimen del Impuesto sobre Sociedades, en datos generales";
         |ACABA;
     |FINSI;

     |PARA nCont = 34; |SI nCont [ 37; |HACIENDO nCont = nCont + 1;
        nCalc = nCont - 34;
        #dsm18410#nCalc# = #dsm18401#nCont#;
     |SIGUE;
     |PUSHV 0501 2380;
     |PINPA #0#dsm18410; |PINDA #0#dsm18410;
     |ENDATOS #1#dsm18410;
     |SI FSalida = 0;
        |PARA nCont = 34; |SI nCont [ 37; |HACIENDO nCont = nCont + 1;
           nCalc = nCont - 34;
           #dsm18401#nCont# = #dsm18410#nCalc#;
        |SIGUE;
        |GRABA 020#dsm18401.a;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO inf14;
     #dsm18414#0 = #dsm18401#0;
     #dsm18414#1 = #dsm18401#1;
     #dsm18414#2 = #dsm18401#3;
     #dsm18414#3 = 01;
|FPRC;

|PROCESO sup14;
     #dsm18414#0 = #dsm18401#0;
     #dsm18414#1 = #dsm18401#1;
     #dsm18414#2 = #dsm18401#3;
     #dsm18414#3 = 99;
|FPRC;

|PROCESO PuntoL;
     |PUSHV 1005 2276;
     |ENTLINEAL #1#dsm18414,-4,nModo,20,1,inf14,sup14;
     |POPV;
|FPRC;

|PROCESO inf09;
     #dsm18409#0 = #dsm18401#0;
     #dsm18409#1 = #dsm18401#1;
     #dsm18409#2 = #dsm18401#3;
     #dsm18409#3 = 001;
|FPRC;

|PROCESO sup09;
     #dsm18409#0 = #dsm18401#0;
     #dsm18409#1 = #dsm18401#1;
     #dsm18409#2 = #dsm18401#3;
     #dsm18409#3 = 999;
|FPRC;

|PROCESO PuntoG;
     |PUSHV 1005 2276;
     |PINPA #0#dsm18409;
     |SI #dsm18401#1 ] 2015;
         |ATRI R; |PINTA 1005, aMenuGen8;
         |ATRI 0;
     |FINSI;
     |ENTLINEAL #1#dsm18409,-4,nModo,20,0,inf09,sup09;
     |HAZ CalcExcesos;
     |POPV;
|FPRC;

|PROCESO inf08;
     #dsm18408#0 = #dsm18401#0;
     #dsm18408#1 = #dsm18401#1;
     #dsm18408#2 = #dsm18401#3;
     #dsm18408#3 = 001;
|FPRC;

|PROCESO sup08;
     #dsm18408#0 = #dsm18401#0;
     #dsm18408#1 = #dsm18401#1;
     #dsm18408#2 = #dsm18401#3;
     #dsm18408#3 = 999;
|FPRC;

|PROCESO PuntoF;
     |PUSHV 0905 2276;

     |PINPA #0#dsm18408;
     |ATRI R; |PINTA 1006, aMenuGen7;
     |ATRI 0;

     |ENTLINEAL #1#dsm18408, -4, nModo, 20, 0, inf08, sup08;
     |HAZ CalcExcesos;
     |POPV;
|FPRC;

|PROCESO inf07;
     #dsm18407#0 = #dsm18401#0;
     #dsm18407#1 = #dsm18401#1;
     #dsm18407#2 = #dsm18401#3;
     #dsm18407#3 = 001;
|FPRC;

|PROCESO sup07;
     #dsm18407#0 = #dsm18401#0;
     #dsm18407#1 = #dsm18401#1;
     #dsm18407#2 = #dsm18401#3;
     #dsm18407#3 = 999;
|FPRC;

|PROCESO PuntoE;
     |PUSHV 1005 2276;
     |ENTLINEAL #1#dsm18407,-4,nModo,20,1,inf07,sup07;
     |POPV;
|FPRC;

|PROCESO inf06;
     #dsm18406#0 = #dsm18401#0;
     #dsm18406#1 = #dsm18401#1;
     #dsm18406#2 = #dsm18401#3;
     #dsm18406#3 = 001;
|FPRC;

|PROCESO sup06;
     #dsm18406#0 = #dsm18401#0;
     #dsm18406#1 = #dsm18401#1;
     #dsm18406#2 = #dsm18401#3;
     #dsm18406#3 = 999;
|FPRC;

|PROCESO PuntoD;
     |PUSHV 0901 2380;
     |ENTLINEAL #1#dsm18406,-4,nModo,22,1,inf06,sup06;
     |HAZ CalcExcesos;
     |POPV;
|FPRC;

|PROCESO inf05;
     #dsm18405#0 = #dsm18401#0;
     #dsm18405#1 = #dsm18401#1;
     #dsm18405#2 = #dsm18401#3;
     #dsm18405#3 = 001;
|FPRC;

|PROCESO sup05;
     #dsm18405#0 = #dsm18401#0;
     #dsm18405#1 = #dsm18401#1;
     #dsm18405#2 = #dsm18401#3;
     #dsm18405#3 = 999;
|FPRC;

|PROCESO inf32;
     #dsm18432#0  = #dsm18401#0;
     #dsm18432#1  = #dsm18401#1;
     #dsm18432#2  = #dsm18401#3;
     #dsm18432#3  = #dsm18405#3;
     #dsm18432#4  = 001;
|FPRC;

|PROCESO sup32;
     #dsm18432#0  = #dsm18401#0;
     #dsm18432#1  = #dsm18401#1;
     #dsm18432#2  = #dsm18401#3;
     #dsm18432#3  = #dsm18405#3;
     #dsm18432#4  = 999;
|FPRC;


|PROCESO Btn05;
     |ABRE #dsm18432;
     |BUCLE dsm18430Inm;

     |PUSHV 1005 2380;
     |BLANCO 1005 2376;

     |ENTLINEAL #1#dsm18432, -5, nModo, 21, 1, inf32, sup32;
     |CIERRA #dsm18432;

     |POPV;

     |ERROR;
|FPRC;

|PROCESO T12F05;  |TIPO 12;
     |ABRE #dsm18432;
     |BUCLE dsm18430Inm;
     |CIERRA #dsm18432;

     enCambio = 0;
|FPRC;

|PROCESO PuntoC;
     |PUSHV 1005 2376;
     |BLANCO 1005 2376;
     aAlfa1 = "S";
     |SI #dsm18401#1 < 2015;
         aAlfa1 = "N";
     |FINSI;

     |C_M #dsm18405#14, 1, aAlfa1;
     |C_M #dsm18405#15, 1, aAlfa1;

     |CONTROL_SIMPLE 0, "BOTON,Datos del inmueble por socio", 2247, 2267, Btn05;
     nBtn05 = FSalida;

     |ENTLINEAL #1#dsm18405, -4, nModo, 21, 1, inf05, sup05;

     |HAZ Refres18432;

     |FIN_CONTROL_WINDOWS nBtn05;

     |HAZ CalcExcesos;
     |POPV;
|FPRC;

|PROCESO inf04;
     #dsm18404#0 = #dsm18401#0;
     #dsm18404#1 = #dsm18401#1;
     #dsm18404#2 = #dsm18401#3;
     #dsm18404#3 = 001;
|FPRC;

|PROCESO sup04;
     #dsm18404#0 = #dsm18401#0;
     #dsm18404#1 = #dsm18401#1;
     #dsm18404#2 = #dsm18401#3;
     #dsm18404#3 = 999;
|FPRC;

|PROCESO PuntoB;
     |PUSHV 1005 2276;
     |ENTLINEAL #1#dsm18404,-4,nModo,20,1,inf04,sup04;
     |POPV;
|FPRC;

|PROCESO inf03;
     #dsm18403#0 = #dsm18401#0;
     #dsm18403#1 = #dsm18401#1;
     #dsm18403#2 = #dsm18401#3;
     #dsm18403#3 = 001;
|FPRC;

|PROCESO sup03;
     #dsm18403#0 = #dsm18401#0;
     #dsm18403#1 = #dsm18401#1;
     #dsm18403#2 = #dsm18401#3;
     #dsm18403#3 = 999;
|FPRC;

|PROCESO PuntoA;
     |PUSHV 1005 2276; |BLANCO 1005 2276;
     |ENTLINEAL #1#dsm18403,-4,nModo,21,1,inf03,sup03;
     |HAZ CalcExcesos;
     |POPV;
|FPRC;

|PROCESO dsm18430Cheq;
     aAlfa = #dsm18430#2 % 101;
     |SI aAlfa = "0";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "1";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "2";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "3";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "4";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "5";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "6";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "7";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "8";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "9";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "X";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "Y";  nError = 1;  |ERROR10;  |FINSI;
     |SI aAlfa = "Z";  nError = 1;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE dsm18430Cheq;
     #dsm18430#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, dsm18430Cheq;
|FIN;

|PROCESO DatosGen;
     |PUSHV 1005 2276;

     |PARA nCont = 8; |SI nCont [ 33; |HACIENDO nCont = nCont + 1;
        nCalc = nCont - 8;
        #dsm18402#nCalc#  = #dsm18401#nCont#;
     |SIGUE;
     #dsm18402#26 = #dsm18401#55;
     #dsm18402#27 = #dsm18401#56;

     |PINPA #0#dsm18402;
     |PINDA #0#dsm18402;
     |ENDATOS #1#dsm18402;
     |SI FSalida = 0;
        |PARA nCont = 8; |SI nCont [ 33; |HACIENDO nCont = nCont + 1;
           nCalc = nCont - 8;
           #dsm18401#nCont# = #dsm18402#nCalc#;
        |SIGUE;
        #dsm18401#55 = #dsm18402#26;
        #dsm18401#56 = #dsm18402#27;
     |FINSI;

     |SI #dsm18401#56 = "S";
         nError = 0;
         |BUCLE dsm18430Cheq;
         |SI nError = 1;
             |MENAV "0000Hay socios que no son sociedades, revise los datos";
         |FINSI;
     |FINSI;

     |HAZ Refres18432;

     |POPV;
|FPRC;

|PROCESO dsm18403;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18403.a;
     |SINO;
         #dsm18403#2 = #dsm18401#3;
         |GRABA 020#dsm18403.n;
         |LIBERA #dsm18403;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18403;
     #dsm18403#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL,dsm18403;
|FIN;

|PROCESO dsm18404;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18404.a;
     |SINO;
         #dsm18404#2 = #dsm18401#3;
         |GRABA 020#dsm18404.n;
         |LIBERA #dsm18404;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18404;
     #dsm18404#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18404;
|FIN;

|PROCESO dsm18405;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18405.a;
     |SINO;
         #dsm18405#2 = #dsm18401#3;
         |GRABA 020#dsm18405.n;
         |LIBERA #dsm18405;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18405;
     #dsm18405#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18405;
|FIN;

|PROCESO dsm18406;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18406.a;
     |SINO;
         #dsm18406#2 = #dsm18401#3;
         |GRABA 020#dsm18406.n;
         |LIBERA #dsm18406;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18406;
     #dsm18406#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18406;
|FIN;

|PROCESO dsm18407;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18407.a;
     |SINO;
         #dsm18407#2 = #dsm18401#3;
         |GRABA 020#dsm18407.n;
         |LIBERA #dsm18407;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18407;
     #dsm18407#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18407;
|FIN;

|PROCESO dsm18408;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18408.a;
     |SINO;
         #dsm18408#2 = #dsm18401#3;
         |GRABA 020#dsm18408.n;
         |LIBERA #dsm18408;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18408;
     #dsm18408#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18408;
|FIN;

|PROCESO dsm18409;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18409.a;
     |SINO;
         #dsm18409#2 = #dsm18401#3;
         |GRABA 020#dsm18409.n;
         |LIBERA #dsm18409;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18409;
     #dsm18409#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL,dsm18409;
|FIN;

|PROCESO dsm18414;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18414.a;
     |SINO;
         #dsm18414#2 = #dsm18401#3;
         |GRABA 020#dsm18414.n;
         |LIBERA #dsm18414;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18414;
     #dsm18414#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL,dsm18414;
|FIN;

|PROCESO dsm18415;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18415.a;
     |SINO;
         #dsm18415#2 = #dsm18401#3;
         |GRABA 020#dsm18415.n;
         |LIBERA #dsm18415;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18415;
     #dsm18415#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18415;
|FIN;

|PROCESO dsm18430;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18430.a;
     |SINO;
         #dsm18430#33 = #dsm18401#3;
         |GRABA 020#dsm18430.n;
         |LIBERA #dsm18430;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18430;
     #dsm18430#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999;
     be;
     NULL, dsm18430;
|FIN;

|PROCESO dsm18431;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18431.a;
     |SINO;
         #dsm18431#2 = #dsm18401#3;
         |GRABA 020#dsm18431.n;
         |LIBERA #dsm18431;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18431;
     #dsm18431#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001, "  ", " ";
     #dsm18401#0, #dsm18401#1, nComp, 999, "zz", "z";
     be;
     NULL, dsm18431;
|FIN;

|PROCESO dsm18432;
     |SI nSwBorra = 1;
         |BORRA 020#dsm18432.a;
     |SINO;
         #dsm18432#2 = #dsm18402#3;
         |GRABA 020#dsm18432.n;
         |LIBERA #dsm18432;
     |FINSI;
|FPRC;

|DEFBUCLE dsm18432;
     #dsm18432#1;
     ;
     #dsm18401#0, #dsm18401#1, nComp, 001, 001;
     #dsm18401#0, #dsm18401#1, nComp, 999, 999;
     be;
     NULL, dsm18432;
|FIN;

|PROCESO dsm18403C;
     #dsm18403#1  = #dsm18401#1;
     #dsm18403#6  = 0;
     #dsm18403#7  = 0;
     #dsm18403#8  = 0;
     #dsm18403#10 = 0;
     |GRABA 020#dsm18403.n;
     |LIBERA #dsm18403;
|FPRC;

|DEFBUCLE dsm18403C;
     #dsm18403#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18403C;
|FIN;

|PROCESO dsm18404C;
     #dsm18404#1  = #dsm18401#1;
     #dsm18404#6  = 0;
     |GRABA 020#dsm18404.n;
     |LIBERA #dsm18404;
|FPRC;

|DEFBUCLE dsm18404C;
     #dsm18404#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18404C;
|FIN;

|PROCESO dsm18405C;
     #dsm18405#1  = #dsm18401#1;
     #dsm18405#6  = 0;
     #dsm18405#7  = 0;
     #dsm18405#8  = 0;
     #dsm18405#10 = 0;
     |PDEFECTO #dsm18405, 20, 30;
     |GRABA 020#dsm18405.n;
     |LIBERA #dsm18405;
|FPRC;

|DEFBUCLE dsm18405C;
     #dsm18405#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18405C;
|FIN;

|PROCESO dsm18407C;
     #dsm18407#1  = #dsm18401#1;
     #dsm18407#7  = 0;
     #dsm18407#8  = 0;
     #dsm18407#9  = 0;
     |GRABA 020#dsm18407.n;
     |LIBERA #dsm18407;
|FPRC;

|DEFBUCLE dsm18407C;
     #dsm18407#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18407C;
|FIN;

|PROCESO dsm18408C;
     #dsm18408#1  = #dsm18401#1;
     #dsm18408#6  = 0;
     |GRABA 020#dsm18408.n;
     |LIBERA #dsm18408;
|FPRC;

|DEFBUCLE dsm18408C;
     #dsm18408#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18408C;
|FIN;

|PROCESO dsm18409C;
     #dsm18409#1  = #dsm18401#1;
     #dsm18409#7  = 0;
     |GRABA 020#dsm18409.n;
     |LIBERA #dsm18409;
|FPRC;

|DEFBUCLE dsm18409C;
     #dsm18409#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18409C;
|FIN;

|PROCESO dsm18414C;
     #dsm18414#1  = #dsm18401#1;
     #dsm18414#6  = 0;
     |GRABA 020#dsm18414.n;
     |LIBERA #dsm18414;
|FPRC;

|DEFBUCLE dsm18414C;
     #dsm18414#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18414C;
|FIN;

|PROCESO dsm18415C;
     #dsm18415#1  = #dsm18401#1;
     #dsm18415#6  = 0;
     |GRABA 020#dsm18415.n;
     |LIBERA #dsm18415;
|FPRC;

|DEFBUCLE dsm18415C;
     #dsm18415#1;
     ;
     #dsm18401#0, enAnyo, #dsm18401#3, 001;
     #dsm18401#0, enAnyo, #dsm18401#3, 999;
     be;
     NULL, dsm18415C;
|FIN;

|PROCESO PuntoZ;
     |CONFI "0000NSi nos traemos los Datos del Ejercicio Anterior perderemos lo que tenemos ahora. Continuar";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsm18401.mas";
     |CARGA_DEF aMas, dsm18401@;
     |SI FSalida ! 0;
         |MENAV "0000 Problemas en Crear Copia.";
         |ACABA;
     |FINSI;

     |ABRE #dsm18401@;
     #dsm18401@#0 = #dsm18401#0;
     #dsm18401@#1 = #dsm18401#1 - 1;
     #dsm18401@#2 = #dsm18401#2;
     #dsm18401@#3 = #dsm18401#3;
     |LEE 000#dsm18401@.=;
     |SI FSalida = 0;
         |PARA nCampo = 8;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               #dsm18401#nCampo# = #dsm18401@#nCampo#;
         |SIGUE;
         #dsm18401#24 = 0;
         #dsm18401#55 = #dsm18401@#55;
         #dsm18401#56 = #dsm18401@#56;

         nSwBorra = 1;
         nComp    = #dsm18401#3;

         |BUCLE dsm18403;
         |BUCLE dsm18404;
         |BUCLE dsm18405;
         |BUCLE dsm18407;
         |BUCLE dsm18408;
         |BUCLE dsm18409;
         |BUCLE dsm18414;
         |BUCLE dsm18415;

         enAnyo = #dsm18401@#1;

         |BUCLE dsm18403C;
         |BUCLE dsm18404C;
         |BUCLE dsm18405C;
         |BUCLE dsm18407C;
         |BUCLE dsm18408C;
         |BUCLE dsm18409C;
         |BUCLE dsm18414C;
         |BUCLE dsm18415C;
         |HAZ CopiaSocAnt;
     |SINO;
         |MENAV "0000 No hay registro en el Ejercicio Anterior";
     |FINSI;
     |CIERRA #dsm18401@;
     |DESCARGA_DEF #dsm18401@;
|FPRC;

|PROCESO Justificante;
     |SI #dsm18401#3 = 0;  |ACABA;  |FINSI;

     |SI #dsm18401#5 ! "C";  |Y #dsm18401#5 ! "S";
         |MENAV "      Introduzca Complementaria o Sustitutoria";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #dsm18401#7, 1, "S";
     |SI #dsm18401#5 = "S";
         |SI #dsm18401#7 = 0;
             |ABRE #dsmom004;
             #dsmom004#0 = #dsm18401#0;
             #dsmom004#1 = #dsm18401#1;
             #dsmom004#2 = 99;
             #dsmom004#3 = #dsm18401#2;
             #dsmom004#4 = #dsm18401#3 - 1;
             |LEE 000#dsmom004.=;
             |SI FSalida ! 0;  |DDEFECTO #dsmom004;  |FINSI;
             |CIERRA #dsmom004;

             #dsm18401#7 = #dsmom004#25;  |PINTA #dsm18401#7;
         |FINSI;
     |FINSI;

     |SI #dsm18401#5 = "S";
         nSwBorra = 0;
         nComp    = #dsm18401#3 - 1;

         |DBASE aBase;  |QBF aBase;
         aMas = aBase + "def/dsm18401.mas";
         |CARGA_DEF aMas, dsm18401@;
         |SI FSalida = 0;
             |ABRE #dsm18401@;
             #dsm18401@#0 = #dsm18401#0;
             #dsm18401@#1 = #dsm18401#1;
             #dsm18401@#2 = #dsm18401#2;
             #dsm18401@#3 = #dsm18401#3 - 1;
             |LEE 000#dsm18401@.=;
             |SI FSalida = 0;
                 |PARA nCampo = 8;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
                       #dsm18401#nCampo# = #dsm18401@#nCampo#;
                 |SIGUE;
             |FINSI;
             |CIERRA #dsm18401@;
             |DESCARGA_DEF #dsm18401@;
         |FINSI;

         |SI nRecoge = 1;
             |BUCLE dsm18403;
             |BUCLE dsm18404;
             |BUCLE dsm18405;
             |BUCLE dsm18406;
             |BUCLE dsm18407;
             |BUCLE dsm18408;
             |BUCLE dsm18409;
             |BUCLE dsm18414;
             |BUCLE dsm18415;
             |BUCLE dsm18430;
             |BUCLE dsm18431;
             |BUCLE dsm18432;
         |FINSI;

         |HAZ LaPantalla;
         |PINDA #0#dsm18401;
         |HAZ PintaDatos;
     |FINSI;
|FPRC;

|PROCESO VerComplem;
     |SI #dsm18401#3 > 0;
         |ABRE #dsmom004;
         #dsmom004#0 = #dsm18401#0;
         #dsmom004#1 = #dsm18401#1;
         #dsmom004#2 = 99;
         #dsmom004#3 = #dsm18401#2;
         #dsmom004#4 = #dsm18401#3;
         |LEE 141#dsmom004.=;
         |SI FSalida = 0;
             |SI nOpera = 0;
                 #dsm18401#5  = #dsmom004#24;
                 #dsm18401#7  = #dsmom004#21;
             |SINO;
                 #dsmom004#24 = #dsm18401#5;
                 #dsmom004#21 = #dsm18401#7;
                 |GRABA 020#dsmom004.a;
             |FINSI;
         |FINSI;
         |LIBERA #dsmom004;
         |CIERRA #dsmom004;
     |FINSI;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO Menu2012;
     aMenuGen1  = " 1) Datos generales                                                    ";
     aMenuGen2  = " A) Rendimientos del capital mobiliario                                ";
     aMenuGen3  = " B) Identificacion persona/entidad cesionaria de los capitales propios ";
     aMenuGen4  = " C) Rendimientos del capital inmobiliario                              ";
     aMenuGen5  = " D) Rendimientos de actividades economicas                             ";
     aMenuGen6  = " E) Rentas contab.derivadas de participar en Inst.inversion colectiva  ";
     aMenuGen7  = " F) Ganancias y perdidas patrimoniales con periodo generacion <= 1 a¤o ";
     aMenuGen8  = " G) Ganancias y perdidas patrimoniales con periodo generacion > 1 a¤o  ";
     aMenuGen9  = " H) Entidades que determinan renta atribuible segun el Imp.Sociedades  ";
     aMenuGen10 = " I) Deducciones Ley 40/1998                                            ";
     aMenuGen11 = " J) Deducciones Ley 43/1995                                            ";
     aMenuGen12 = " K) Retenciones e ingresos a cuenta soportados por la entidad          ";
     aMenuGen13 = " L) Exceso de rentas negativos                                         ";
     aMenuGen14 = " Z) Recoger Datos Ejercicio Anterior                                   ";

     |SI enEjer ] 2010;
         aMenuGen10 = " I) Deducciones Ley 35/2006 de IRPF                                    ";
         aMenuGen11 = " J) Deducciones Ley 4/2004 de Impuesto Sociedades                      ";
     |FINSI;

     |BLANCO 0901 2480;
     |CUADRO 0901 2480;
     nOpcion = 1; nPosic = 1005; nOpcs = 14;

     |PARA;  |SI;  |HACIENDO;
         |PARA nCont = 1; |SI nCont [ nOpcs; |HACIENDO nCont = nCont + 1;
             IaMenuGen = aMenuGen1<-; IaMenuGen = IaMenuGen + (nCont - 1);
             nCalc  = ((nPosic / 100) ! 0);
             nCalc  = nCalc + (nCont - 1);
             nCalc1 = nPosic - (((nPosic / 100) ! 0) * 100);
             nCalc  = (nCalc * 100) + nCalc1;
             |SI nCont = nOpcion;
                 |ATRI R;
             |SINO;
                 |ATRI N;
             |FINSI;

             |PINTA nCalc, aMenuGen;
         |SIGUE;

         |LEETECLA aTecla;
         aTecla = aTecla % -103;

         |SI aTecla = "806"; |O aTecla = "807";
             |PTEC 806;
             |SAL;
         |FINSI;

         |SI aTecla = "809";
             nOpcion = nOpcion + 1;
         |FINSI;

         |SI aTecla = "808";
             nOpcion = nOpcion - 1;
         |FINSI;

         |SI nOpcion > nOpcs; nOpcion = 1;     |FINSI;
         |SI nOpcion < 1;     nOpcion = nOpcs; |FINSI;

         |SI aTecla = "802";
             |PULSATECLA;

             |SI nOpcion = 1;  |HAZ DatosGen; |FINSI;
             |SI nOpcion = 2;  |HAZ PuntoA;   |FINSI;
             |SI nOpcion = 3;  |HAZ PuntoB;   |FINSI;
             |SI nOpcion = 4;  |HAZ PuntoC;   |FINSI;
             |SI nOpcion = 5;  |HAZ PuntoD;   |FINSI;
             |SI nOpcion = 6;  |HAZ PuntoE;   |FINSI;
             |SI nOpcion = 7;  |HAZ PuntoF;   |FINSI;
             |SI nOpcion = 8;  |HAZ PuntoG;   |FINSI;
             |SI nOpcion = 9;  |HAZ PuntoH;   |FINSI;
             |SI nOpcion = 10; |HAZ PuntoI;   |FINSI;
             |SI nOpcion = 11; |HAZ PuntoJ;   |FINSI;
             |SI nOpcion = 12; |HAZ PuntoK;   |FINSI;
             |SI nOpcion = 13; |HAZ PuntoL;   |FINSI;
             |SI nOpcion = 14; |HAZ PuntoZ;   |FINSI;
        |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Menu2013;
     aMenuGen1  = " 1) Datos generales                                                    ";
     aMenuGen2  = " A) Rendimientos del capital mobiliario                                ";
     aMenuGen3  = " B) Identificacion persona/entidad cesionaria de los capitales propios ";
     aMenuGen4  = " C) Rendimientos del capital inmobiliario                              ";
     aMenuGen5  = " D) Rendimientos de actividades economicas                             ";
     aMenuGen6  = " E) Rentas contab.derivadas de participar en Inst.inversion colectiva  ";
     aMenuGen7  = " F) Ganancias y perdidas patrimoniales no derivadas de transmisiones   ";
     aMenuGen8  = " G) Ganancias y perdidas patrimoniales con periodo generacion > 1 a¤o  ";
     aMenuGen9  = " M) Ganancias y perdidas patrimoniales con periodo generacion <= 1 a¤o ";
     aMenuGen10 = " H) Entidades que determinan renta atribuible segun el Imp.Sociedades  ";
     aMenuGen11 = " I) Deducciones Ley IRPF                                               ";
     aMenuGen12 = " J) Deducciones Ley LIS                                                ";
     aMenuGen13 = " K) Retenciones e ingresos a cuenta soportados por la entidad          ";
     aMenuGen14 = " L) Exceso de rentas negativos                                         ";
     aMenuGen15 = " Z) Recoger Datos Ejercicio Anterior (Menos Actividades Economicas)    ";

     |BLANCO 0801 2480;
     |CUADRO 0801 2480;
     nOpcion = 1; nPosic = 0905; nOpcs = 15;

     |PARA;  |SI;  |HACIENDO;
        |PARA nCont = 1; |SI nCont [ nOpcs; |HACIENDO nCont = nCont + 1;
              IaMenuGen = aMenuGen1<-; IaMenuGen = IaMenuGen + (nCont - 1);
              nCalc  = ((nPosic / 100) ! 0);
              nCalc  = nCalc + (nCont - 1);
              nCalc1 = nPosic - (((nPosic / 100) ! 0) * 100);
              nCalc  = (nCalc * 100) + nCalc1;
              |SI nCont = nOpcion;
                  |ATRI R;
              |SINO;
                  |ATRI N;
              |FINSI;

              |PINTA nCalc, aMenuGen;
         |SIGUE;

         |LEETECLA aTecla;
         aTecla = aTecla % -103;

         |SI aTecla = "806"; |O aTecla = "807";
             |PTEC 806;
             |SAL;
         |FINSI;

         |SI aTecla = "809";
             nOpcion = nOpcion + 1;
         |FINSI;

         |SI aTecla = "808";
             nOpcion = nOpcion - 1;
         |FINSI;

         |SI nOpcion > nOpcs; nOpcion = 1;     |FINSI;
         |SI nOpcion < 1;     nOpcion = nOpcs; |FINSI;

         |SI aTecla = "802";
             |PULSATECLA;
             |PINTA 0902, "                                                                          ";

             |SI nOpcion = 1;  |HAZ DatosGen; |FINSI;
             |SI nOpcion = 2;  |HAZ PuntoA;   |FINSI;
             |SI nOpcion = 3;  |HAZ PuntoB;   |FINSI;
             |SI nOpcion = 4;  |HAZ PuntoC;   |FINSI;
             |SI nOpcion = 5;  |HAZ PuntoD;   |FINSI;
             |SI nOpcion = 6;  |HAZ PuntoE;   |FINSI;
             |SI nOpcion = 7;  |HAZ PuntoF;   |FINSI;
             |SI nOpcion = 8;  |HAZ PuntoG;   |FINSI;
             |SI nOpcion = 9;  |HAZ PuntoM;   |FINSI;
             |SI nOpcion = 10; |HAZ PuntoH;   |FINSI;
             |SI nOpcion = 11; |HAZ PuntoI;   |FINSI;
             |SI nOpcion = 12; |HAZ PuntoJ;   |FINSI;
             |SI nOpcion = 13; |HAZ PuntoK;   |FINSI;
             |SI nOpcion = 14; |HAZ PuntoL;   |FINSI;
             |SI nOpcion = 15; |HAZ PuntoZ;   |FINSI;
         |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Menu2015;
     aMenuGen1  = " 1) Datos generales                                                    ";
     aMenuGen2  = " A) Rendimientos del capital mobiliario                                ";
     aMenuGen3  = " B) Identificacion persona/entidad cesionaria de los capitales propios ";
     aMenuGen4  = " C) Rendimientos del capital inmobiliario                              ";
     aMenuGen5  = " D) Rendimientos de actividades economicas                             ";
     aMenuGen6  = " E) Rentas contab.derivadas de participar en Inst.inversion colectiva  ";
     aMenuGen7  = " F) Ganancias y perdidas patrimoniales no derivadas de transmisiones   ";
     aMenuGen8  = " G) Ganancias y perdidas patrimoniales derivadas de transmisiones elem.";
     aMenuGen9  = " H) Entidades que determinan renta atribuible segun el Imp.Sociedades  ";
     aMenuGen10 = " I) Deducciones Ley IRPF                                               ";
     aMenuGen11 = " J) Deducciones Ley LIS                                                ";
     aMenuGen12 = " K) Retenciones e ingresos a cuenta soportados por la entidad          ";
     aMenuGen13 = " L) Exceso de rentas negativos                                         ";
     aMenuGen14 = " Z) Recoger Datos Ejercicio Anterior (Menos Actividades Economicas)    ";

     |BLANCO 0801 2480;
     |CUADRO 0801 2480;
     nOpcion = 1; nPosic = 0905; nOpcs = 14;

     |PARA;  |SI;  |HACIENDO;
        |PARA nCont = 1; |SI nCont [ nOpcs; |HACIENDO nCont = nCont + 1;
              IaMenuGen = aMenuGen1<-; IaMenuGen = IaMenuGen + (nCont - 1);
              nCalc  = ((nPosic / 100) ! 0);
              nCalc  = nCalc + (nCont - 1);
              nCalc1 = nPosic - (((nPosic / 100) ! 0) * 100);
              nCalc  = (nCalc * 100) + nCalc1;
              |SI nCont = nOpcion;
                  |ATRI R;
              |SINO;
                  |ATRI N;
              |FINSI;

              |PINTA nCalc, aMenuGen;
         |SIGUE;

         |LEETECLA aTecla;
         aTecla = aTecla % -103;

         |SI aTecla = "806"; |O aTecla = "807";
             |PTEC 806;
             |SAL;
         |FINSI;

         |SI aTecla = "809";
             nOpcion = nOpcion + 1;
         |FINSI;

         |SI aTecla = "808";
             nOpcion = nOpcion - 1;
         |FINSI;

         |SI nOpcion > nOpcs; nOpcion = 1;     |FINSI;
         |SI nOpcion < 1;     nOpcion = nOpcs; |FINSI;

         |SI aTecla = "802";
             |PULSATECLA;
             |PINTA 0902, "                                                                          ";

             |SI nOpcion = 1;  |HAZ DatosGen; |FINSI;
             |SI nOpcion = 2;  |HAZ PuntoA;   |FINSI;
             |SI nOpcion = 3;  |HAZ PuntoB;   |FINSI;
             |SI nOpcion = 4;  |HAZ PuntoC;   |FINSI;
             |SI nOpcion = 5;  |HAZ PuntoD;   |FINSI;
             |SI nOpcion = 6;  |HAZ PuntoE;   |FINSI;
             |SI nOpcion = 7;  |HAZ PuntoF;   |FINSI;
             |SI nOpcion = 8;  |HAZ PuntoG;   |FINSI;
             |SI nOpcion = 9;  |HAZ PuntoH;   |FINSI;
             |SI nOpcion = 10; |HAZ PuntoI;   |FINSI;
             |SI nOpcion = 11; |HAZ PuntoJ;   |FINSI;
             |SI nOpcion = 12; |HAZ PuntoK;   |FINSI;
             |SI nOpcion = 13; |HAZ PuntoL;   |FINSI;
             |SI nOpcion = 14; |HAZ PuntoZ;   |FINSI;
         |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Menu;
     |SI #dsm18401#1 [ 2012;
         |HAZ Menu2012;
     |FINSI;

     |SI #dsm18401#1 = 2013; |O #dsm18401#1 = 2014;
         |HAZ Menu2013;
     |FINSI;

     |SI #dsm18401#1 ] 2015;
         |HAZ Menu2015;
     |FINSI;
|FPRC;

|PROCESO Boton1;
     nModo = 4;
     |SI enTipoEntrada ! 4;
         FSalida = -1;
         |SI #dsm18401#57 = "M";
             |CONFI "0000NQuiere recoger los datos de los modelos en estos momentos";
         |FINSI;

         |SI #dsm18401#57 = "C";
             |CONFI "0000NQuiere recoger los datos de la contabilidad en estos momentos";
         |FINSI;

         |SI FSalida = 0;
             |HAZ RecogeDatos;
         |FINSI;
         nModo = 1;
     |FINSI;

     |ESTADO_CONTROL nBoton1, "HIDE";

     |HAZ Menu;
|FPRC

|PROCESO LaPantalla;
     |PINPA #0#dsm18401;
     |SI enEjer ] 2018; |Y enComplem > 0;
         |CUADRO 1902 2355;
         |ATRI P;
         |PINTA 2003, " Solo se contemplan las declaraciones sustitutivas. ";
         |PINTA 2103, " Para complementarias usar el formulario web de la  ";
         |PINTA 2203, " Sede electronica de la AEAT.                       ";
         |ATRI 0;
     |FINSI;
|FPRC;

|PROGRAMA;
     eaPlanilla = "dsmom014";  |HAZ PlanDePlanillas;

     |HAZ LeeEURODBMOD;

     eaNomDef = "dsm18401";

|| \\\\\\ Alta del Modelo ////////

     |SI enTipoEntrada = 1;              || Alta del Modelo
         |CABEZA "Modelo 184";
         |ABRE #dsm18401;
         nRecoge = 0;
         #dsm18401#0 = enEmpresa;
         #dsm18401#1 = enEjer;
         #dsm18401#2 = enModelo;
         #dsm18401#3 = enComplem;
         |LEE 040#dsm18401.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsm18401;
             #dsm18401#0 = enEmpresa;
             #dsm18401#1 = enEjer;
             #dsm18401#2 = enModelo;
             #dsm18401#3 = enComplem;
             nRecoge = 1;
             nOpera = 0; |HAZ VerComplem;
             |GRABA 020#dsm18401.b;
         |FINSI;

         |HAZ LaPantalla;
         |PINDA #0#dsm18401;
         |HAZ PintaDatos;

         |CONTROL_SIMPLE 0, "BOTON,  Entrada de Datos  ", 1155, 1379, Boton1;
         nBoton1 = FSalida;

         |ESTADO_CONTROL nBoton1, "DISABLE";

         |C_M #dsm18401#5, 1, "N";
         |C_M #dsm18401#7, 1, "N";
         |SI #dsm18401#3 ! 0; |Y enEjer < 2018;
             |C_M #dsm18401#5, 1, "S";
         |FINSI;

         |ENDATOS #1#dsm18401;

         |ESTADO_CONTROL nBoton1, "ENABLE";

         |LEETECLA aTecla;

         |FIN_CONTROL_WINDOWS nBoton1;
         |PULSATECLA;

         |GRABA 020#dsm18401.a;
         nOpera = 1; |HAZ VerComplem;
         enEntrada = 1;
         |LIBERA #dsm18401;
         |CIERRA #dsm18401;

         |ACABA;
     |FINSI;

|| \\\\\\ Consulta del Modelo ////////

     |SI enTipoEntrada = 4;              || Consulta del Modelo
         |CABEZA "Modelo 184";
         |ABRE #dsm18401;
         #dsm18401#0 = enEmpresa;
         #dsm18401#1 = enEjer;
         #dsm18401#2 = enModelo;
         #dsm18401#3 = enComplem;
         |LEE 040#dsm18401.=;
         |SI FSalida ! 0;
             |MENAV "      No existe Registro.";
             |CIERRA #dsm18401;
             |ACABA;
         |FINSI;

         |HAZ LaPantalla;
         |PINDA #0#dsm18401;
         |HAZ PintaDatos;

         |CONTROL_SIMPLE 0, "BOTON,  Entrada de Datos  ", 1155, 1379, Boton1;
         nBoton1 = FSalida;

         |LEETECLA aTecla;

         |FIN_CONTROL_WINDOWS nBoton1;
         |PULSATECLA;

         |CIERRA #dsm18401;

         |ACABA;
     |FINSI;

|| \\\\\\ Baja del Modelo ////////

     |SI enTipoEntrada = 3;              || Baja del Modelo
         |ABRE #dsm18401;
         #dsm18401#0 = enEmpresa;
         #dsm18401#1 = enEjer;
         #dsm18401#2 = enModelo;
         #dsm18401#3 = enComplem;
         |LEE 040#dsm18401.=;
         |SI FSalida ! 0;
             |SI enMensa = 0;
                 |MENAV "      No existe Registro.";
             |FINSI;
             |CIERRA #dsm18401;
             |ACABA;
         |FINSI;

         nSwBorra = 1;
         nComp    = #dsm18401#3;

         |BUCLE dsm18403;
         |BUCLE dsm18404;
         |BUCLE dsm18405;
         |BUCLE dsm18406;
         |BUCLE dsm18407;
         |BUCLE dsm18408;
         |BUCLE dsm18409;
         |BUCLE dsm18414;
         |BUCLE dsm18415;
         |BUCLE dsm18430;
         |BUCLE dsm18431;
         |BUCLE dsm18432;

         |BORRA 020#dsm18401.a;
         |LIBERA #dsm18401;
         |CIERRA #dsm18401;

         |ACABA;
     |FINSI;

|| \\\\\\ Comprobacion Existencia del Modelo

     |SI enTipoEntrada = 99;              || Existencia del Modelo ????
         |ABRE #dsm18401;
         #dsm18401#0 = enEmpresa;
         #dsm18401#1 = enEjer;
         #dsm18401#2 = enModelo;
         #dsm18401#3 = enComplem;
         |LEE 040#dsm18401.=;
         |SI FSalida ! 0;  enExistencia = 1;  |FINSI;
         |CIERRA #dsm18401;

         |SI enActividad = 0;  enResultado = 0;  |FINSI;
     |FINSI;
|FPRO;

|PROCESO Tipo88;  |TIPO 88;
     |HAZ Relaciones;
|FPRC;
