|FICHEROS;
     dsmoy020;

     dsmom001;
     dsmom004;
     dsmom026;
     dsmom073;

     dsm190ca;
     dsm190li;
     dsm19001;
     dsmom107;

     :/basica/def/agifigen;
     :/basica/def/agim0024;
     :/basica/def/agim0026;
     :/basica/def/agim0029;
     :/basica/def/agitab99;

     :/integral/def/dsam0003;
     :/laboral/def/labempre;
     :/laboral/def/labtraba;

     dsmow036;
     dsmow093;
     dsmow101;
     dsmow171;

     espejo1@;

     &regisnif@;
     &clientes@;
|FIN;

|VARIABLES;
     nCodCentro          = 0;

     nSwGraba            = 0;
     nCampo              = 0;
     nPara1              = 0;
     nPara2              = 0;
     nEmpresa            = 0;
     nDEmpresa           = 0;
     nHEmpresa           = 0;
     nEjer               = 0;
     nSwHay              = 0;
     nSw                 = 0;
     nEmpr               = 0;
     nContador           = 0;
     nCont               = 0;
     nCalc               = 0;
     nSuma21             = 0;
     nSSocial            = 0;
     SwPrimer            = 0;
     sw_valido           = 0;
     nVale               = 0;
     nHayRepre           = 0;
     nLectura            = 0;
     nDComple            = 0;
     nHComple            = 0;
     nCanal              = 0;
     nSwLaboral          = 0;
     nSwExiLab           = 0;
     nBase1              = 0;
     nBase2              = 0;
     nCuota1             = 0;
     nCuota2_1           = 0;
     nCuota2_2           = 0;
     nOpcion             = 0;
     nPorGrupos          = 0;
     nOk                 = 0;
     nAlguno             = 0;

     aFechaAlta          = "";
     aClv1               = "";
     aClv2               = "";
     aClv3               = "";
     aSubClv             = "";
     aSClave             = "";
     aClave              = "";
     aClave1             = "";
     aClave2             = "";
     aClave3             = "";
     aAlfa               = "";
     aAlfa1              = "";
     aAlfa2              = "";
     aAlfa3              = "";
     aAlfa4              = "";
     aFichero            = "";
     aPath               = "";
     aDNIF               = "";
     aHNIF               = "";
     aBase               = "";
     aPathModelo         = "";
     aDef                = "";

     fFechaAltaAnt       = @;
     fFechaAlta          = @;
     fecsys              = @;

     {-1}aMenu           = "";
         aMenu1          = "2400";
         aMenu2          = "1";
         aMenu3          = "Archivo documental activado. Elija opci줻: ";
         aMenu4          = "IAB";
         aMenu5          = "Imprimir";
         aMenu6          = "Archivar";
         aMenu7          = "Ambos";

     &eaMoneda           = "";
     &eaTMoneda          = "";
     &aElDni             = "";
     &aElNombre          = "";
     &aElDniEmp          = "";
     &aElNomEmp          = "";
     &aElMunEmp          = "";
     &aElProEmp          = "";
     &aElCPEmp           = "";
     &aElSg              = "";
     &aElCl              = "";
     &aElNu              = "";
     &aElEs              = "";
     &aElPi              = "";
     &aElPt              = "";
     &aElTl              = "";
     &aElRe              = "";

     &periodo            = 0;
     &codemp             = "";
     &nomrep             = "";
     &dnirep             = "";
     &carrep             = "";
     &nomemp             = "";
     &dniemp             = "";
     &domemp             = "";
     &munemp             = "";
     &cpoemp             = "";
     &proemp             = "";
     &nomtra             = "";
     &dnitra             = "";
     &domtra             = "";
     &muntra             = "";
     &cpotra             = "";
     &protra             = "";

     &190sg              = "";
     &190cl              = "";
     &190nu              = "";
     &190es              = "";
     &190pi              = "";
     &190pt              = "";
     &190tl              = "";
     &190fp              = "";

     &fletra             = "";
     &fprese             = @;
     &tbases1            = 0;
     &tbases2            = 0;
     &tbases3            = 0;
     &tbases4            = 0;
     &treten1            = 0;
     &treten2            = 0;
     &treten3            = 0;
     &treten4            = 0;
     &trep1              = 0;
     &trep2              = 0;
     &trep3              = 0;
     &trep4              = 0;
     &tdescue            = 0;
     &texenta            = 0;
     &letrai             = 0;
     &clave1             = "";
     &clave2             = "";
     &clave3             = "";
     &clave4             = "";
     &especie1           = "";
     &especie2           = "";
     &especie3           = "";
     &xespe4             = "";
     &eaPathIntegral     = "";
     &eaCodRenta         = "";
     &enSwHay            = 0;
     &enLabornet         = 0;
     &eaRutaFichLab      = "";
     &dirtra1            = "";
     &dirtra2            = "";
     &dirtra3            = "";
     &nTipo              = 0;

     &eaParam            = "";
     &eaEmpr             = "";
     &eaTrab             = "";

     &RetDin1            = 0;
     &ImpDin1            = 0;
     &ValDin1            = 0;
     &InCDin1            = 0;
     &ICRDin1            = 0;
     &RetEsp1            = 0;
     &ImpEsp1            = 0;
     &ValEsp1            = 0;
     &InCEsp1            = 0;
     &ICREsp1            = 0;

     &RetDin2            = 0;
     &ImpDin2            = 0;
     &ValDin2            = 0;
     &InCDin2            = 0;
     &ICRDin2            = 0;
     &RetEsp2            = 0;
     &ImpEsp2            = 0;
     &ValEsp2            = 0;
     &InCEsp2            = 0;
     &ICREsp2            = 0;

     &RetDin3            = 0;
     &ImpDin3            = 0;
     &ValDin3            = 0;
     &InCDin3            = 0;
     &ICRDin3            = 0;
     &RetEsp3            = 0;
     &ImpEsp3            = 0;
     &ValEsp3            = 0;
     &InCEsp3            = 0;
     &ICREsp3            = 0;

     &RetDin4            = 0;
     &ImpDin4            = 0;
     &ValDin4            = 0;
     &InCDin4            = 0;
     &ICRDin4            = 0;
     &RetEsp4            = 0;
     &ImpEsp4            = 0;
     &ValEsp4            = 0;
     &InCEsp4            = 0;
     &ICREsp4            = 0;

     &RetDin5            = 0;
     &ImpDin5            = 0;
     &ValDin5            = 0;
     &InCDin5            = 0;
     &ICRDin5            = 0;
     &RetEsp5            = 0;
     &ImpEsp5            = 0;
     &ValEsp5            = 0;
     &InCEsp5            = 0;
     &ICREsp5            = 0;

     &enErrorDSArchi     = 0;
     &eaVengoDe          = "";
     &enArchi            = 0;
     &eaInforme          = "";
     &enEjercicio        = 0;
     &eaNifEmp           = "";
     &enCodTrab          = 0;
     &eaNombreTra        = "";
     &eaNifTra           = "";
     &eaObservacion1     = "";
     &eaObservacion2     = "";
     &eaObservacion3     = "";
     &enM2               = 0;

     &enDesde            = 0;
     &enHasta            = 0;
|FIN;

|INCLUYE i_variar;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\
|PROCESO Orden;
     |SI #dsmoy020#15 = 3;
          |C_M #dsmoy020#35, 1, "S";
          |C_V #dsmoy020#35, 1, "S";
          |PINTA 2142, "Orden.:";
          |PINTA #dsmoy020#35;
     |SINO;
          |C_M #dsmoy020#35, 1, "N";
          |C_V #dsmoy020#35, 1, "N";
          |PINTA 2142, "          ";
          |PINTA 2242, "컴컴컴컴컴";
     |FINSI;
|FPRC;

|PROCESO T7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #dsmoy020#0 = enEmpresa;  |PINTA #dsmoy020#0;
         #dsmoy020#1 = enEmpresa;  |PINTA #dsmoy020#1;

         |C_M #dsmoy020#0, 1, "N";
         |C_M #dsmoy020#1, 1, "N";
     |FINSI;
     aAlfa1 = #dsmoy020#16;
     aAlfa1 = aAlfa1 % -104;
     #dsmoy020#14 = aAlfa1;
     #dsmoy020#14 = #dsmoy020#14 - 1;
     |PINTA #dsmoy020#14;
     |HAZ Orden;
|FPRC;

|PROCESO CodigoRenta;
     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     |C_M #dsmoy020#33, 1, "S";
     |SI eaPathIntegral = "";
         |C_M #dsmoy020#33, 1, "N";  #dsmoy020#33 = "N";  |PINTA #dsmoy020#33;
     |SINO;
         |SI #dsmoy020#15 = 1;
             |C_M #dsmoy020#33, 1, "N";  #dsmoy020#33 = "N";  |PINTA #dsmoy020#33;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Parrilla;
     |SI #dsmoy020#0 = 0;
         #dsmoy020#0 = 0;  |PINTA #dsmoy020#0;
         #dsmoy020#1 = 0;  |PINTA #dsmoy020#1;  |C_M #dsmoy020#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy020#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #dsmoy020#0, 1, "S";
             |C_M #dsmoy020#1, 1, "S";
         |FINSI;

         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy020#nCampo#, 1, "N";
               #dsmoy020#nCampo# = 0;  |PINTA #dsmoy020#nCampo#;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #dsmoy020#Campo# = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               #dsmoy020#nCampo# = 0;  |C_M #dsmoy020#nCampo#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy020#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO DesdeDni;
     |SI #dsmoy020#19 = "            ";
         #dsmoy020#20 = "zzzzzzzzzzzz";  |C_M #dsmoy020#20,1,"N"; |PINTA #dsmoy020#20;
         |PARA nCampo = 21;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy020#nCampo#, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #dsmoy020#20,1,"S";
         |PARA nCampo = 21;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy020#nCampo#, 1, "N";
               #dsmoy020#nCampo# = ""; |PINTA #dsmoy020#nCampo#;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasDni;
     |SI #dsmoy020#Campo# = "            ";
         |PARA nCampo = Campo + 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               #dsmoy020#nCampo# = "";  |C_M #dsmoy020#nCampo#, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
               |C_M #dsmoy020#nCampo#, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO AntesCargo;  |TIPO 7;
     |PUSHV 1501 1980;
     |SI nSwLaboral = 1; |Y enEmpresa = 0;
         |CUADRO 1605 1969;
         |ATRI R;
         |PINTA 1706, " Introduzca cargo de la Persona de la Empresa que  figurara en ";
         |PINTA 1806, " el Certificado, en caso de no llevar Nominas de dicha Empresa ";
         |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO LeeCargo;
 |POPV;
 |ABRE #agim0029;
 #agim0029#0 = #dsmoy020#Campo#;
 |LEE 001#agim0029.=;
 |SI FSalida = 0;
     #dsmoy020#17 = #agim0029#1; |PINTA #dsmoy020#17;
 |FINSI;
 |CIERRA #agim0029;
|FPRC;

|PROCESO Tipo0C36y020; |TIPO 0;
     |SI #dsmoy020#36 = "S";
          #dsmoy020#15 = 3;
          |C_M #dsmoy020#15, 1, "N";
          |C_M #dsmoy020#37, 1, "S";
          |C_M #dsmoy020#38, 1, "S";
     |SINO;
          |C_M #dsmoy020#15, 1, "S";
          |C_M #dsmoy020#37, 1, "N";
          |C_M #dsmoy020#38, 1, "N";
     |FINSI;
     |PINTA #dsmoy020#15;
     |PINTA #dsmoy020#37;
     |PINTA #dsmoy020#38;
|FPRC;

|| *******************************************************

|PROCESO ElTrabajador;
     especie1 = "";
     especie2 = "";
     especie3 = "";
     xespe4   = "N";

     tbases1 = 0;
     tbases2 = 0;
     tbases3 = 0;

     treten1 = 0;
     treten2 = 0;
     treten3 = 0;

     trep1 = 0;
     trep2 = 0;
     trep3 = 0;

     tdescue = 0;
     texenta = 0;
     aClave1 = "";
     aClave2 = "";
     aClave3 = "";
     aClave  = "";

     nContador = 0;

     |SI #dsmoy020#14 [ 2015;
         aElDni   = #dsm190li#6;
         eaCodNif = #dsm190li#6;
     |FINSI;

     |SI #dsmoy020#14 ] 2016;
         aElDni   = #dsm19001#6;
         eaCodNif = #dsm19001#6;
     |FINSI;

     |HAZ LeeNifs;

     nomtra = #regisnif@#1;
     dnitra = aElDni;

     dirtra1 = "";
     dirtra2 = "";
     dirtra3 = "";

     dirtra1 = nomtra;
     aAlfa = #regisnif@#9;  |QBF aAlfa;      || tipo via
     dirtra2 = aAlfa + " ";
     aAlfa = #regisnif@#2;  |QBF aAlfa;      || nombre via
     dirtra2 = dirtra2 + aAlfa + ", ";
     aAlfa = #regisnif@#3;  |QBF aAlfa;      || numero
     dirtra2 = dirtra2 + aAlfa + " - ";
     aAlfa = #regisnif@#10;  |QBF aAlfa;     || piso
     dirtra2 = dirtra2 + aAlfa;

     aAlfa = (("00" + #regisnif@#4) % -102) + (("000" + #regisnif@#5) % -103);
     aAlfa = "(" + aAlfa + ") " + #regisnif@#6;   || cod. pos. + poblacion
     |QBF aAlfa;
     dirtra3 = aAlfa + " - ";
     aAlfa = #regisnif@#7;  |QBF aAlfa;     || provincia
     dirtra3 = dirtra3 + aAlfa;

     aElNombre = nomtra;
     aElDniEmp = #dsmow093#38;
     aElNomEmp = #dsmow093#37;
     aElMunEmp = #dsmow093#40;
     aElProEmp = #dsmow093#42;
     aElCPEmp  = #dsmow093#41;
     aElSg     = #dsmow093#43;
     aElCl     = #dsmow093#44;
     aElNu     = #dsmow093#45;
     aElEs     = #dsmow093#46;
     aElPi     = #dsmow093#47;
     aElPt     = #dsmow093#48;
     aElTl     = #dsmow093#49;
     aElRe     = #dsmow093#34;

     aAlfa1 = #regisnif@#9; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
     aAlfa2 = #regisnif@#2; |QBF aAlfa2; |SI aAlfa2 ! ""; aAlfa2 = aAlfa2 + " "; |FINSI;
     aAlfa3 = #regisnif@#3;
     domtra = aAlfa1 + aAlfa2 + aAlfa3;
     muntra = #regisnif@#6;
     protra = #regisnif@#7;

     aAlfa1 = #regisnif@#4; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa2 = #regisnif@#5; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
     cpotra = aAlfa1 + aAlfa2;
|FPRC;

|PROCESO dsmow093;
     |SI #dsmow093#1 ! aClv1; |Y #dsmow093#1 ! aClv2; |Y #dsmow093#1 ! aClv3;
         |ACABA;
     |FINSI;

     |SI aSubClv ! "";
         |SI aClv1 = "K"; |Y aSubClv = "01";        || Tique 700000 10182
             |SI aSubClv ! #dsmow093#2; |Y #dsmow093#2 ! "03"; |ACABA; |FINSI;
         |SINO;
             |SI aSubClv ! #dsmow093#2; |ACABA; |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmoy020#36 = "S";
         |SI #dsmow093#58 < #dsmoy020#37; |O #dsmow093#58 > #dsmoy020#38;
             |ACABA;
         |FINSI;
     |FINSI;

     nSwHay    = 1;

     |SI nSw = 1;  |ACABA;  |FINSI;

     |SI SwPrimer = 0; |O aElDni ! #dsmow093#0; |O nEmpr ! #dsmow093#33;
         |SI eaInforme = "dsmor121"; |O eaInforme = "dsmor122";
             |SI SwPrimer ! 0;
                 |PRINT; |PIEINF;
             |FINSI;
             RetDin1 = 0; ImpDin1 = 0; ValEsp1 = 0; InCEsp1 = 0; ICREsp1 = 0;
             RetDin2 = 0; ImpDin2 = 0; ValEsp2 = 0; InCEsp2 = 0; ICREsp2 = 0;
             RetDin3 = 0; ImpDin3 = 0; ValEsp3 = 0; InCEsp3 = 0; ICREsp3 = 0;
             RetDin4 = 0; ImpDin4 = 0; ValEsp4 = 0; InCEsp4 = 0; ICREsp4 = 0;
             RetDin5 = 0; ImpDin5 = 0; ValEsp5 = 0; InCEsp5 = 0; ICREsp5 = 0;
         |FINSI;

         |SI #dsmoy020#14 [ 2015;
             #dsm190li#6  = #dsmow093#0;
         |FINSI;

         |SI #dsmoy020#14 ] 2016;
             #dsm19001#6  = #dsmow093#0;
         |FINSI;

         |HAZ ElTrabajador;
         SwPrimer = 1;

         |SI nSwLaboral = 1;
             #labtraba#7 = #dsmow093#0;
             |LEE 000#labtraba.=;
             |PARA; |SI FSalida = 0; |Y #labtraba#7 = #dsmow093#0; |HACIENDO;
                    |SI #labtraba#0 = #dsmow093#33; |SAL; |FINSI;
                    |LEE 000#labtraba.s;
             |SIGUE;

             |SI #labtraba#0 = #dsmow093#33; |Y FSalida = 0;
                 eaEmpr = #labtraba#0;
                 eaTrab = #labtraba#1;
                 eaTrab = ("00000" + eaTrab) % -105;
             |SINO;
                 eaEmpr = #dsmow093#50; eaTrab = #dsmow093#51;
             |FINSI;
         |SINO;
             eaEmpr = #dsmow093#50;
             eaTrab = #dsmow093#51;
         |FINSI;

         eaEmpr = ("000000" + eaEmpr) % -106;
         nEmpr  = #dsmow093#33;
     |FINSI;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #dsmow093#1;
     #dsmom073#2 = #dsmow093#2;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom073;  |FINSI;
     |CIERRA #dsmom073;

     eaCodRenta = "";
     |SI #dsmoy020#33 = "S";
         |ABRE #dsam0003;
         |SELECT #2#dsam0003;
         #dsam0003#1 = #dsmow093#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
         |SINO;
             |SELECT #3#dsam0003;
             #dsam0003#35 = #dsmow093#0;
             |LEE 040#dsam0003.=;
             |SI FSalida = 0;
                 eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
             |FINSI;
         |FINSI;
         |CIERRA #dsam0003;
     |FINSI;

     |SI eaInforme ! "dsmor121"; |Y eaInforme ! "dsmor122";
        |PRINT;
        |PIEINF;
        |ACABA;
     |FINSI;

     |SI #dsmow093#1 = "G";
         RetDin1 = (RetDin1 + #dsmow093#4) ! 2;
         ImpDin1 = (ImpDin1 + #dsmow093#3) ! 2;
         ValEsp1 = (ValEsp1 + #dsmow093#5) ! 2;
         InCEsp1 = (InCEsp1 + #dsmow093#6) ! 2;
         ICREsp1 = (ICREsp1 + #dsmow093#7) ! 2;
     |FINSI;

     |SI #dsmow093#1 = "H";
         |SI #dsmow093#2 ! "03"; |Y #dsmow093#2 ! "04";
             RetDin2 = (RetDin2 + #dsmow093#4) ! 2;
             ImpDin2 = (ImpDin2 + #dsmow093#3) ! 2;
             ValEsp2 = (ValEsp2 + #dsmow093#5) ! 2;
             InCEsp2 = (InCEsp2 + #dsmow093#6) ! 2;
             ICREsp2 = (ICREsp2 + #dsmow093#7) ! 2;
         |SINO;
             |SI #dsmow093#2 = "03";
                 RetDin4 = (RetDin4 + #dsmow093#4) ! 2;
                 ImpDin4 = (ImpDin4 + #dsmow093#3) ! 2;
                 ValEsp4 = (ValEsp4 + #dsmow093#5) ! 2;
                 InCEsp4 = (InCEsp4 + #dsmow093#6) ! 2;
                 ICREsp4 = (ICREsp4 + #dsmow093#7) ! 2;
             |FINSI;

             |SI #dsmow093#2 = "04";
                 RetDin5 = (RetDin5 + #dsmow093#4) ! 2;
                 ImpDin5 = (ImpDin5 + #dsmow093#3) ! 2;
                 ValEsp5 = (ValEsp5 + #dsmow093#5) ! 2;
                 InCEsp5 = (InCEsp5 + #dsmow093#6) ! 2;
                 ICREsp5 = (ICREsp5 + #dsmow093#7) ! 2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmow093#1 = "K";
         |SI #dsmow093#2 = "01";
             RetDin1 = (RetDin1 + #dsmow093#4) ! 2;
             ImpDin1 = (ImpDin1 + #dsmow093#3) ! 2;
             ValEsp1 = (ValEsp1 + #dsmow093#5) ! 2;
             InCEsp1 = (InCEsp1 + #dsmow093#6) ! 2;
             ICREsp1 = (ICREsp1 + #dsmow093#7) ! 2;
         |FINSI;
         |SI #dsmow093#2 = "03";
             RetDin2 = (RetDin2 + #dsmow093#4) ! 2;
             ImpDin2 = (ImpDin2 + #dsmow093#3) ! 2;
             ValEsp2 = (ValEsp2 + #dsmow093#5) ! 2;
             InCEsp2 = (InCEsp2 + #dsmow093#6) ! 2;
             ICREsp2 = (ICREsp2 + #dsmow093#7) ! 2;
         |FINSI;
     |FINSI;

     |SI #dsmow093#1 = "I";
         RetDin3 = (RetDin3 + #dsmow093#4) ! 2;
         ImpDin3 = (ImpDin3 + #dsmow093#3) ! 2;
         ValEsp3 = (ValEsp3 + #dsmow093#5) ! 2;
         InCEsp3 = (InCEsp3 + #dsmow093#6) ! 2;
         ICREsp3 = (ICREsp3 + #dsmow093#7) ! 2;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow093;
     #dsmow093#1;
     ;
     00000, "            ", " ", "  ";
     99999, "zzzzzzzzzzzz", "z", "zz";
     ;
     NULL, dsmow093;
|FIN;

|PROCESO Papel;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida ! 0; |ACABA; |FINSI;

     SwPrimer  = 0;
     aElDni    = "";
     aElNombre = "";
     aElDniEmp = "";
     aElNomEmp = "";
     aElMunEmp = "";
     aElProEmp = "";
     aElCPEmp  = "";
     aElSg     = "";
     aElCl     = "";
     aElNu     = "";
     aElEs     = "";
     aElPi     = "";
     aElPt     = "";
     aElTl     = "";
     aElRe     = "";

     |SI nSwLaboral = 1;
         |ABRE #labtraba;
         |SELECT #2#labtraba;
     |FINSI;

     aClv1    = "Z";
     aClv2    = "";
     aClv3    = "";  ||La clave Z engloba las claves A, L, F, E y M
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         nSw     = 0;
         eaInforme = "dsmor120";
         |INFOR eaInforme;
         aClv1 = "Z";
         aClv2 = "";
         aClv3 = "";

         |BUCLE dsmow093;

         |FININF;
     |FINSI;

     aClv1    = "G";
     aClv2    = "H";
     aClv3    = "I";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         eaInforme = "dsmor121";
         |INFOR eaInforme;
         aClv1 = "G";
         aClv2 = "H";
         aClv3 = "I";

         |BUCLE dsmow093;

         |PRINT;
         |PIEINF;
         |FININF;
     |FINSI;

     aClv1    = "K";
     aClv2    = "";
     aClv3    = "";
     aSubClv  = "01";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         |SI #dsmoy020#14 ] 2015;
             eaInforme = "dsmor122";
         |SINO;
             eaInforme = "dsmor125";
         |FINSI;
         |INFOR eaInforme;
         aClv1 = "K";
         aClv2 = "";
         aClv3 = "";
         |BUCLE dsmow093;

         |SI #dsmoy020#14 ] 2015;
             |PRINT;
             |PIEINF;
         |FINSI;
         |FININF;
     |FINSI;

     aClv1    = "K";
     aClv2    = "";
     aClv3    = "";
     aSubClv  = "02";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;

     nSw      = 0;
     SwPrimer = 0;
     |SI nSwHay > 0;
         eaInforme = "dsmor124";
         |INFOR eaInforme;
         aClv1 = "K";
         aClv2 = "";
         aClv3 = "";
         |BUCLE dsmow093;
         |FININF;
     |FINSI;
     aSubClv = "";

     aClv1    = "J";
     aClv2    = "";
     aClv3    = "";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         eaInforme = "dsmor123";
         |INFOR eaInforme;

         aClv1 = "J";
         aClv2 = "";
         aClv3 = "";
         |BUCLE dsmow093;
         |FININF;
     |FINSI;

     |FINIMP;
|FPRC;

|PROCESO CargaVar;
     || eaObservacion1 = "Certificado de IRPF (modelo 190), ejercicio " + #dsmoy020#14;
     eaObservacion1 = "Certificado de IRPF - ";

     |SI eaInforme = "dsmor120";
         eaObservacion1 = eaObservacion1 + "Trabajadores ";
     |FINSI;

     |SI eaInforme = "dsmor121";
         eaObservacion1 = eaObservacion1 + "Actividades econ줺icas ";
     |FINSI;

     |SI eaInforme = "dsmor122"; |O eaInforme = "dsmor125";
         eaObservacion1 = eaObservacion1 + "Premios ";
     |FINSI;

     |SI eaInforme = "dsmor123";
         eaObservacion1 = eaObservacion1 + "Derecho de imagen ";
     |FINSI;

     |SI eaInforme = "dsmor124";
         eaObservacion1 = eaObservacion1 + "Aprovechamientos forestales ";
     |FINSI;

     enEmpresa   = nEmpr;        || #dsmow093#33;
     eaNombreEmp = aElNomEmp;    || #dsmow093#37;
     eaNifEmp    = aElDniEmp;    || #dsmow093#38;
     enEjercicio = #dsmoy020#14;
     enM2        = 99;
     enCodTrab   = eaTrab;       || #dsmow093#51;
     eaNombreTra = aElNombre;    || #dsmow093#52;
     eaNifTra    = aElDni;       || #dsmow093#53;
|FPRC;

|PROCESO Archiva;
     |HAZ IMPREArchi;

     |PRINT;
     |PIEINF;
     |FININF;
     |FINIMP;

     |SI enErrorDSArchi = 0;
         |HAZ CargaVar;
         |HAZ Archivando;
     |FINSI;
|FPRC;

|PROCESO dsmow093Archi;
     |SI #dsmow093#1 ! aClv1; |Y #dsmow093#1 ! aClv2; |Y #dsmow093#1 ! aClv3;
         |ACABA;
     |FINSI;

     |SI aSubClv ! "";
         |SI aClv1 = "K"; |Y aSubClv = "01";        || Tique 700000 10182
             |SI aSubClv ! #dsmow093#2; |Y #dsmow093#2 ! "03"; |ACABA; |FINSI;
         |SINO;
             |SI aSubClv ! #dsmow093#2; |ACABA; |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmoy020#36 = "S";
         |SI #dsmow093#58 < #dsmoy020#37; |O #dsmow093#58 > #dsmoy020#38;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI SwPrimer = 0; |O aElDni ! #dsmow093#0; |O nEmpr ! #dsmow093#33;
         |SI eaInforme = "dsmor121"; |O eaInforme = "dsmor122";
            |SI SwPrimer ! 0;
                |HAZ Archiva;
            |FINSI;
             RetDin1 = 0; ImpDin1 = 0; ValEsp1 = 0; InCEsp1 = 0; ICREsp1 = 0;
             RetDin2 = 0; ImpDin2 = 0; ValEsp2 = 0; InCEsp2 = 0; ICREsp2 = 0;
             RetDin3 = 0; ImpDin3 = 0; ValEsp3 = 0; InCEsp3 = 0; ICREsp3 = 0;
             RetDin4 = 0; ImpDin4 = 0; ValEsp4 = 0; InCEsp4 = 0; ICREsp4 = 0;
             RetDin5 = 0; ImpDin5 = 0; ValEsp5 = 0; InCEsp5 = 0; ICREsp5 = 0;
         |FINSI;

         |SI #dsmoy020#14 [ 2015;
             #dsm190li#6  = #dsmow093#0;
         |FINSI;

         |SI #dsmoy020#14 ] 2016;
             #dsm19001#6  = #dsmow093#0;
         |FINSI;

         |HAZ ElTrabajador;
         SwPrimer = 1;

         |SI nSwLaboral = 1;
             #labtraba#7 = #dsmow093#0;
             |LEE 000#labtraba.=;
             |PARA; |SI FSalida = 0; |Y #labtraba#7 = #dsmow093#0; |HACIENDO;
                    |SI #labtraba#0 = #dsmow093#33; |SAL; |FINSI;
                    |LEE 000#labtraba.s;
             |SIGUE;

             |SI #labtraba#0 = #dsmow093#33; |Y FSalida = 0;
                 eaEmpr = #labtraba#0;
                 eaTrab = #labtraba#1;
                 eaTrab = ("00000" + eaTrab) % -105;
             |SINO;
                 eaEmpr = #dsmow093#50; eaTrab = #dsmow093#51;
             |FINSI;
         |SINO;
             eaEmpr = #dsmow093#50;
             eaTrab = #dsmow093#51;
         |FINSI;

         eaEmpr = ("000000" + eaEmpr) % -106;
         nEmpr  = #dsmow093#33;
     |FINSI;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #dsmow093#1;
     #dsmom073#2 = #dsmow093#2;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom073;  |FINSI;
     |CIERRA #dsmom073;

     eaCodRenta = "";
     |SI #dsmoy020#33 = "S";
         |ABRE #dsam0003;
         |SELECT #2#dsam0003;
         #dsam0003#1 = #dsmow093#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
         |SINO;
             |SELECT #3#dsam0003;
             #dsam0003#35 = #dsmow093#0;
             |LEE 040#dsam0003.=;
             |SI FSalida = 0;
                 eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
             |FINSI;
         |FINSI;
         |CIERRA #dsam0003;
     |FINSI;

     |SI eaInforme ! "dsmor121"; |Y eaInforme ! "dsmor122";
         |HAZ Archiva;
         |ACABA;
     |FINSI;

     |SI #dsmow093#1 = "G";
         RetDin1 = (RetDin1 + #dsmow093#4) ! 2;
         ImpDin1 = (ImpDin1 + #dsmow093#3) ! 2;
         ValEsp1 = (ValEsp1 + #dsmow093#5) ! 2;
         InCEsp1 = (InCEsp1 + #dsmow093#6) ! 2;
         ICREsp1 = (ICREsp1 + #dsmow093#7) ! 2;
     |FINSI;

     |SI #dsmow093#1 = "H";
         |SI #dsmow093#2 ! "03"; |Y #dsmow093#2 ! "04";
             RetDin2 = (RetDin2 + #dsmow093#4) ! 2;
             ImpDin2 = (ImpDin2 + #dsmow093#3) ! 2;
             ValEsp2 = (ValEsp2 + #dsmow093#5) ! 2;
             InCEsp2 = (InCEsp2 + #dsmow093#6) ! 2;
             ICREsp2 = (ICREsp2 + #dsmow093#7) ! 2;
         |SINO;
             |SI #dsmow093#2 = "03";
                 RetDin4 = (RetDin4 + #dsmow093#4) ! 2;
                 ImpDin4 = (ImpDin4 + #dsmow093#3) ! 2;
                 ValEsp4 = (ValEsp4 + #dsmow093#5) ! 2;
                 InCEsp4 = (InCEsp4 + #dsmow093#6) ! 2;
                 ICREsp4 = (ICREsp4 + #dsmow093#7) ! 2;
             |FINSI;

             |SI #dsmow093#2 = "04";
                 RetDin5 = (RetDin5 + #dsmow093#4) ! 2;
                 ImpDin5 = (ImpDin5 + #dsmow093#3) ! 2;
                 ValEsp5 = (ValEsp5 + #dsmow093#5) ! 2;
                 InCEsp5 = (InCEsp5 + #dsmow093#6) ! 2;
                 ICREsp5 = (ICREsp5 + #dsmow093#7) ! 2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmow093#1 = "K";
         |SI #dsmow093#2 = "01";
             RetDin1 = (RetDin1 + #dsmow093#4) ! 2;
             ImpDin1 = (ImpDin1 + #dsmow093#3) ! 2;
             ValEsp1 = (ValEsp1 + #dsmow093#5) ! 2;
             InCEsp1 = (InCEsp1 + #dsmow093#6) ! 2;
             ICREsp1 = (ICREsp1 + #dsmow093#7) ! 2;
         |FINSI;
         |SI #dsmow093#2 = "03";
             RetDin2 = (RetDin2 + #dsmow093#4) ! 2;
             ImpDin2 = (ImpDin2 + #dsmow093#3) ! 2;
             ValEsp2 = (ValEsp2 + #dsmow093#5) ! 2;
             InCEsp2 = (InCEsp2 + #dsmow093#6) ! 2;
             ICREsp2 = (ICREsp2 + #dsmow093#7) ! 2;
         |FINSI;
     |FINSI;

     |SI #dsmow093#1 = "I";
         RetDin3 = (RetDin3 + #dsmow093#4) ! 2;
         ImpDin3 = (ImpDin3 + #dsmow093#3) ! 2;
         ValEsp3 = (ValEsp3 + #dsmow093#5) ! 2;
         InCEsp3 = (InCEsp3 + #dsmow093#6) ! 2;
         ICREsp3 = (ICREsp3 + #dsmow093#7) ! 2;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow093Archi;
     #dsmow093#1;
     ;
     00000, "            ", " ", "  ";
     99999, "zzzzzzzzzzzz", "z", "zz";
     ;
     NULL, dsmow093Archi;
|FIN;

|PROCESO Archivado;
     SwPrimer  = 0;
     aElDni    = "";
     aElNombre = "";
     aElDniEmp = "";
     aElNomEmp = "";
     aElMunEmp = "";
     aElProEmp = "";
     aElCPEmp  = "";
     aElSg     = "";
     aElCl     = "";
     aElNu     = "";
     aElEs     = "";
     aElPi     = "";
     aElPt     = "";
     aElTl     = "";
     aElRe     = "";

     |SI nSwLaboral = 1;
         |ABRE #labtraba;
         |SELECT #2#labtraba;
     |FINSI;

     aClv1    = "Z";
     aClv2    = "";
     aClv3    = "";  ||La clave Z engloba las claves A, L, F, E y M
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         nSw       = 0;
         eaInforme = "dsmor120";
         aClv1     = "Z";
         aClv2     = "";
         aClv3     = "";

         |BUCLE dsmow093Archi;
     |FINSI;

     aClv1    = "G";
     aClv2    = "H";
     aClv3    = "I";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         eaInforme = "dsmor121";
         aClv1     = "G";
         aClv2     = "H";
         aClv3     = "I";

         |BUCLE dsmow093Archi;

         |HAZ Archiva;
     |FINSI;

     aClv1    = "K";
     aClv2    = "";
     aClv3    = "";
     aSubClv  = "01";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         |SI #dsmoy020#14 ] 2015;
             eaInforme = "dsmor122";
         |SINO;
             eaInforme = "dsmor125";
         |FINSI;
         aClv1     = "K";
         aClv2     = "";
         aClv3     = "";
         aSubClv   = "01";
         |BUCLE dsmow093Archi;

         |SI #dsmoy020#14 ] 2015;
             |HAZ Archiva;
         |FINSI;
     |FINSI;

     aClv1    = "K";
     aClv2    = "";
     aClv3    = "";
     aSubClv  = "02";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;

     nSw      = 0;
     SwPrimer = 0;
     |SI nSwHay > 0;
         eaInforme = "dsmor124";
         aClv1     = "K";
         aClv2     = "";
         aClv3     = "";
         aSubClv   = "02";
         |BUCLE dsmow093Archi;
     |FINSI;
     aSubClv = "";

     aClv1    = "J";
     aClv2    = "";
     aClv3    = "";
     nSwHay   = 0;
     nSw      = 1;
     |BUCLE dsmow093;
     nSw      = 0;
     SwPrimer = 0;

     |SI nSwHay > 0;
         eaInforme = "dsmor123";
         aClv1     = "J";
         aClv2     = "";
         aClv3     = "";
         |BUCLE dsmow093Archi;
     |FINSI;
|FPRC;

|| /////////////////////// //////////////////////////////////////////////////
|| /////////////////////// PROCESOS DE INFORMES \\\\\\\\\\\\\\\\\\\\\
|| \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

|PROCESO OtraSeleccion;
     nVale = 0;
     |ABRE #dsmow101;

     |SI #dsmoy020#14 [ 2015;
         #dsmow101#0 = #dsm190li#0;
         #dsmow101#1 = #dsm190li#1;
         #dsmow101#2 = #dsm190li#2;
         #dsmow101#8 = #dsm190li#6;
         |LEE 001#dsmow101.=;
         |SI FSalida ! 0;
             nVale = 1;
         |SINO;
             |SI #dsmow101#6 = "N";
                 nVale = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmoy020#14 ] 2016;
         #dsmow101#0 = #dsmow171#8;  ||dsm19001#0
         #dsmow101#1 = #dsm19001#1;
         #dsmow101#2 = #dsm19001#2;
         #dsmow101#8 = #dsm19001#6;
         |LEE 001#dsmow101.=;
         |SI FSalida ! 0;
             nVale = 1;
         |SINO;
             |SI #dsmow101#6 = "N";
                 nVale = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |CIERRA #dsmow101;
|FPRC;


|| **********************************************************************
____________________________________/ CALCULOS DE LECTURA E IMPRESION

|PROCESO ElCerti;
     sw_valido = 1;
     |SI texenta = 0;|Y #dsmoy020#18 = "S"; sw_valido = 0; |FINSI; || exentas S/N

     |SI sw_valido = 1;
          |PRINT;
          |PIEINF;
    |FINSI;
|FPRC;

|| ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
|PROCESO FechaPres;
 |ABRE #dsmom004;
 #dsmom004#0 = #dsm190ca#0;
 #dsmom004#1 = #dsm190ca#1;
 #dsmom004#2 = #dsm190ca#2;
 #dsmom004#3 = #dsm190ca#3;
 #dsmom004#4 = #dsm190ca#4;
 |LEE 000#dsmom004.=;
 fprese = #dsmom004#10;
 |CIERRA #dsmom004;
|FPRC;


||/////////////////////////////////////////////////////////////////////////
||///// Calculos para el Tipo 1 de Informe ////////////////////////////////
||/////////////////////////////////////////////////////////////////////////

|PROCESO Imprimir;
  |SI tbases1!0;|O tbases2!0;|O tbases3!0;|O treten1!0;
                  |O treten2!0;|O treten3!0;|O tdescue!0;
          letrai = 0;
          clave1 = aClave1;
          clave2 = aClave2;
          clave3 = aClave3;
          |HAZ ElCerti;
  |FINSI;

  |SI texenta ! 0;
          letrai = 1;
          clave1 = "L";
          clave2 = "";
          clave3 = "";
          |HAZ ElCerti;
  |FINSI;
|FPRC;

|PROCESO GastosEsp;
     |SI #dsmoy020#14 [ 2015;
         |SI #dsm190li#9 = "02";
             |ABRE #espejo1@;
             |DDEFECTO #espejo1@;
             #espejo1@#0 = #dsm190li#0;
             #espejo1@#1 = #dsm190li#1;
             #espejo1@#2 = #dsm190li#2;
             #espejo1@#3 = #dsm190li#3;
             #espejo1@#4 = #dsm190li#4;
             #espejo1@#5 = #dsm190li#5;
             #espejo1@#6 = #dsm190li#6;
             #espejo1@#8 = #dsm190li#8;
             #espejo1@#9 = "01";
             #espejo1@#10 = #dsm190li#10;
             |LEE 041#espejo1@.=;
             |SI FSalida = 0;
                 nSSocial = 0;
                 nSuma21  = 0;
             |FINSI;
             |CIERRA #espejo1@;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO dsm190liC1;
     |SI #dsmoy020#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy020#nCampo# ! "            ";
                   nVale = 1;
                   |SI #dsmoy020#nCampo# = #dsm190li#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;
     |SI nVale = 1; |ACABA; |FINSI;

     |SI #dsmoy020#34 = "S"; |HAZ OtraSeleccion; |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI SwPrimer = 0;
         |HAZ ElTrabajador;
         SwPrimer = 1;
     |FINSI;

     |SI aElDni ! #dsm190li#6;
         |HAZ Imprimir;
         |HAZ ElTrabajador;
     |FINSI;

     |SI #dsm190li#8 = "L";
         texenta = texenta + (#dsm190li#16 + #dsm190li#18);     || bases
         |ACABA;
     |FINSI;

     |SI aClave ! #dsm190li#8;
         aClave = #dsm190li#8;
         nContador = nContador + 1;
     |FINSI;

     |SI nContador > 3;  |ERROR10;  |ACABA;  |FINSI;

     nSuma21  = #dsm190li#21;
     nSSocial = #dsm190li#22;
     |SI #dsm190li#8 = "A"; |Y #dsm190li#1 ] 2015;
         |HAZ GastosEsp;
     |FINSI;
     tdescue = tdescue + nSSocial;                 || seg.social

     |SI nContador = 1;
         |SI #dsm190li#16 ! 0;  |Y #dsm190li#18 = 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #dsm190li#16;     || bases
                 treten1   = treten1   + #dsm190li#17;     || cuota
                 aClave1   = #dsm190li#8;
                 especie1  = "N";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + #dsm190li#16;     || bases
                     treten1   = treten1   + #dsm190li#17;     || cuota
                     aClave1   = #dsm190li#8;
                     especie1  = "N";
                 |SINO;
                     tbases2   = tbases2   + #dsm190li#16;     || bases
                     treten2   = treten2   + #dsm190li#17;     || cuota
                     aClave2   = #dsm190li#8;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #dsm190li#16 = 0;  |Y #dsm190li#18 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #dsm190li#18;     || bases
                 treten1   = treten1   + #dsm190li#19;     || cuota
                 trep1     = trep1     + #dsm190li#20;     || cuota
                 aClave1   = #dsm190li#8;
                 especie1  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI especie1 = "S";
                     tbases1   = tbases1   + #dsm190li#18;    || bases
                     treten1   = treten1   + #dsm190li#19;    || cuota
                     trep1     = trep1     + #dsm190li#20;     || cuota
                     aClave1   = #dsm190li#8;
                     especie1  = "S";
                     xespe4    = "S";
                 |SINO;
                     tbases2   = tbases2   + #dsm190li#18;    || bases
                     treten2   = treten2   + #dsm190li#19;    || cuota
                     trep2     = trep2     + #dsm190li#20;     || cuota
                     aClave2   = #dsm190li#8;
                     especie2  = "S";
                     xespe4    = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #dsm190li#16 ! 0;  |Y #dsm190li#18 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + #dsm190li#16;     || bases
                 treten1   = treten1   + #dsm190li#17;     || cuota
                 aClave1   = #dsm190li#8;
                 especie1  = "N";

                 tbases2   = tbases2   + #dsm190li#18;     || bases
                 treten2   = treten2   + #dsm190li#19;     || cuota
                 trep2     = trep2     + #dsm190li#20;     || cuota
                 xespe4    = "S";
                 aClave2   = #dsm190li#8;
                 especie2  = "S";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + #dsm190li#16;     || bases
                     treten1   = treten1   + #dsm190li#17;     || cuota
                     aClave1   = #dsm190li#8;
                     especie1  = "N";

                     tbases2   = tbases2   + #dsm190li#18;     || bases
                     treten2   = treten2   + #dsm190li#19;     || cuota
                     trep2     = trep2     + #dsm190li#20;     || cuota
                     aClave2   = #dsm190li#8;
                     especie2  = "S";
                     xespe4    = "S";
                 |SINO;
                     tbases2   = tbases2   + #dsm190li#16;     || bases
                     treten2   = treten2   + #dsm190li#17;     || cuota
                     aClave2   = #dsm190li#8;
                     especie2  = "N";

                     tbases1   = tbases1   + #dsm190li#18;     || bases
                     treten1   = treten1   + #dsm190li#19;     || cuota
                     trep1     = trep1     + #dsm190li#20;     || cuota
                     aClave1   = #dsm190li#8;
                     especie1  = "S";
                     xespe4    = "S";
                 |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 2;
         |SI #dsm190li#16 ! 0;  |Y #dsm190li#18 = 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #dsm190li#16;     || bases
                 treten2   = treten2   + #dsm190li#17;     || cuota
                 aClave2   = #dsm190li#8;
                 especie2  = "N";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + #dsm190li#16;     || bases
                         treten2   = treten2   + #dsm190li#17;     || cuota
                         aClave2   = #dsm190li#8;
                         especie2  = "N";
                     |SINO;
                         tbases3   = tbases3   + #dsm190li#16;     || bases
                         treten3   = treten3   + #dsm190li#17;     || cuota
                         aClave3   = #dsm190li#8;
                         especie3  = "N";
                     |FINSI;
                 |SINO;
                     tbases3   = tbases3   + #dsm190li#16 + #dsm190li#18;     || bases
                     treten3   = treten3   + #dsm190li#17 + #dsm190li#19;     || cuota
                     aClave3   = #dsm190li#8;
                     especie3  = "N";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #dsm190li#16 = 0;  |Y #dsm190li#18 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #dsm190li#18;     || bases
                 treten2   = treten2   + #dsm190li#19;     || cuota
                 trep2     = trep2     + #dsm190li#20;     || cuota
                 aClave2   = #dsm190li#8;
                 especie2  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "S";
                         tbases2   = tbases1   + #dsm190li#18;    || bases
                         treten2   = treten1   + #dsm190li#19;    || cuota
                         trep2     = trep2     + #dsm190li#20;     || cuota
                         aClave2   = #dsm190li#8;
                         especie2  = "S";
                         xespe4    = "S";
                     |SINO;
                         tbases3   = tbases3   + #dsm190li#18;    || bases
                         treten3   = treten3   + #dsm190li#19;    || cuota
                         trep3     = trep3     + #dsm190li#20;     || cuota
                         aClave3   = #dsm190li#8;
                         especie3  = "S";
                         xespe4    = "S";
                     |FINSI;
                  |SINO;
                      tbases3   = tbases3   + #dsm190li#16 + #dsm190li#18;     || bases
                      treten3   = treten3   + #dsm190li#17 + #dsm190li#19;     || cuota
                      aClave3   = #dsm190li#8;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
         |FINSI;

         |SI #dsm190li#16 ! 0;  |Y #dsm190li#18 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + #dsm190li#16;     || bases
                 treten2   = treten2   + #dsm190li#17;     || cuota
                 aClave2   = #dsm190li#8;
                 especie2  = "N";

                 tbases3   = tbases3   + #dsm190li#18;     || bases
                 treten3   = treten3   + #dsm190li#19;     || cuota
                 trep3     = trep3     + #dsm190li#20;     || cuota
                 aClave3   = #dsm190li#8;
                 especie3  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + #dsm190li#16;     || bases
                         treten2   = treten2   + #dsm190li#17;     || cuota
                         aClave2   = #dsm190li#8;
                         especie2  = "N";

                         tbases3   = tbases3   + #dsm190li#18;     || bases
                         treten3   = treten3   + #dsm190li#19;     || cuota
                         trep3     = trep3     + #dsm190li#20;     || cuota
                         aClave3   = #dsm190li#8;
                         especie3  = "S";
                         xespe4    = "S";
                     |SINO;
                         tbases3   = tbases3   + #dsm190li#16;     || bases
                         treten3   = treten3   + #dsm190li#17;     || cuota
                         aClave3   = #dsm190li#8;
                         especie3  = "N";

                         tbases2   = tbases2   + #dsm190li#18;     || bases
                         treten2   = treten2   + #dsm190li#19;     || cuota
                         trep2     = trep2     + #dsm190li#20;     || cuota
                         aClave2   = #dsm190li#8;
                         especie2  = "S";
                         xespe4    = "S";
                    |FINSI;
                  |SINO;
                      tbases3   = tbases3   + #dsm190li#16 + #dsm190li#18;     || bases
                      treten3   = treten3   + #dsm190li#17 + #dsm190li#19;     || cuota
                      aClave3   = #dsm190li#8;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 3;
         |SI aClave3 = "";
             tbases3   = tbases3   + #dsm190li#16 + #dsm190li#18;     || bases
             treten3   = treten3   + #dsm190li#17 + #dsm190li#19;     || cuota
             aClave3   = #dsm190li#8;
             especie3  = "N";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm190liC1;
 #dsm190li#1;
 ;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aDNIF,0000," ","  ",0;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aHNIF,9999,"z","zz",9;
 ;
 NULL, dsm190liC1;
|FIN;

|PROCESO dsm19001C1;
     |SI #dsmoy020#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy020#nCampo# ! "            ";
                   nVale = 1;
                   |SI #dsmoy020#nCampo# = #dsm19001#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI #dsmoy020#34 = "S"; |HAZ OtraSeleccion; |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI #dsmoy020#39 = "S";
         |SI #dsmow171#9 ! 0; |Y nSwLaboral = 1;
             |ABRE #labtraba;
             |SELECT #5#labtraba;
             #labtraba#0 = #dsmow171#8;
             #labtraba#7 = #dsm19001#6;
             |LEE 000#labtraba.=;
             |SI FSalida ! 0;
                 nVale = 1;
             |FINSI;
             |SELECT #1#labtraba;
             |CIERRA #labtraba;
             |SI nVale = 1; |ACABA; |FINSI;
         |FINSI;
     |FINSI;

     |SI SwPrimer = 0;
         |HAZ ElTrabajador;
         SwPrimer = 1;
     |FINSI;

     |SI aElDni ! #dsm19001#6;
         |HAZ Imprimir;
         |HAZ ElTrabajador;
     |FINSI;

     |SI #dsm19001#8 = "L";
         texenta = texenta + (nBase1 + nBase2);     || bases
         texenta = texenta + (#dsm19001#65 + #dsm19001#67);     || bases
         |ACABA;
     |FINSI;

     |SI aClave ! #dsm19001#8;
         aClave = #dsm19001#8;
         nContador = nContador + 1;
     |FINSI;

     |SI nContador > 3;  |ERROR10;  |ACABA;  |FINSI;

     nSuma21  = #dsm19001#21;
     nSSocial = #dsm19001#22;
     tdescue = tdescue + nSSocial;                 || seg.social

     nBase1    = #dsm19001#16 + #dsm19001#65;
     nBase2    = #dsm19001#18 + #dsm19001#67;
     nCuota1   = #dsm19001#17 + #dsm19001#66;
     nCuota2_1 = #dsm19001#19 + #dsm19001#68;
     nCuota2_2 = #dsm19001#20 + #dsm19001#69;

     |SI nContador = 1;
         |SI nBase1 ! 0;  |Y nBase2 = 0;
             |SI aClave1 = "";
                 tbases1   = tbases1 + nBase1;     || bases
                 treten1   = treten1 + nCuota1;    || cuota
                 aClave1   = #dsm19001#8;
                 especie1  = "N";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + nBase1;     || bases
                     treten1   = treten1   + nCuota1;    || cuota
                     aClave1   = #dsm19001#8;
                     especie1  = "N";
                 |SINO;
                     tbases2   = tbases2   + nBase1;     || bases
                     treten2   = treten2   + nCuota1;    || cuota
                     aClave2   = #dsm19001#8;
                     especie2  = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nBase1 = 0;  |Y nBase2 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + nBase2;     || bases
                 treten1   = treten1   + nCuota2_1;  || cuota
                 trep1     = trep1     + nCuota2_2;  || cuota
                 aClave1   = #dsm19001#8;
                 especie1  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI especie1 = "S";
                     tbases1   = tbases1   + nBase2;    || bases
                     treten1   = treten1   + nCuota2_1; || cuota
                     trep1     = trep1     + nCuota2_2; || cuota
                     aClave1   = #dsm19001#8;
                     especie1  = "S";
                     xespe4    = "S";
                 |SINO;
                     tbases2   = tbases2   + nBase2;    || bases
                     treten2   = treten2   + nCuota2_1; || cuota
                     trep2     = trep2     + nCuota2_2; || cuota
                     aClave2   = #dsm19001#8;
                     especie2  = "S";
                     xespe4    = "S";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nBase1 ! 0;  |Y nBase2 ! 0;
             |SI aClave1 = "";
                 tbases1   = tbases1   + nBase1;     || bases
                 treten1   = treten1   + nCuota1;     || cuota
                 aClave1   = #dsm19001#8;
                 especie1  = "N";

                 tbases2   = tbases2   + nBase2;     || bases
                 treten2   = treten2   + nCuota2_1;     || cuota
                 trep2     = trep2     + nCuota2_2;     || cuota
                 xespe4    = "S";
                 aClave2   = #dsm19001#8;
                 especie2  = "S";
             |SINO;
                 |SI especie1 = "N";
                     tbases1   = tbases1   + nBase1;     || bases
                     treten1   = treten1   + nCuota1;     || cuota
                     aClave1   = #dsm19001#8;
                     especie1  = "N";

                     tbases2   = tbases2   + nBase2;     || bases
                     treten2   = treten2   + nCuota2_1;     || cuota
                     trep2     = trep2     + nCuota2_2;     || cuota
                     aClave2   = #dsm19001#8;
                     especie2  = "S";
                     xespe4    = "S";
                 |SINO;
                     tbases2   = tbases2   + nBase1;     || bases
                     treten2   = treten2   + nCuota1;     || cuota
                     aClave2   = #dsm19001#8;
                     especie2  = "N";

                     tbases1   = tbases1   + nBase2;     || bases
                     treten1   = treten1   + nCuota2_1;     || cuota
                     trep1     = trep1     + nCuota2_2;     || cuota
                     aClave1   = #dsm19001#8;
                     especie1  = "S";
                     xespe4    = "S";
                 |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 2;
         |SI nBase1 ! 0;  |Y nBase2 = 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + nBase1;     || bases
                 treten2   = treten2   + nCuota1;     || cuota
                 aClave2   = #dsm19001#8;
                 especie2  = "N";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + nBase1;     || bases
                         treten2   = treten2   + nCuota1;     || cuota
                         aClave2   = #dsm19001#8;
                         especie2  = "N";
                     |SINO;
                         tbases3   = tbases3   + nBase1;     || bases
                         treten3   = treten3   + nCuota1;     || cuota
                         aClave3   = #dsm19001#8;
                         especie3  = "N";
                     |FINSI;
                 |SINO;
                     tbases3   = tbases3   + nBase1 + nBase2;     || bases
                     treten3   = treten3   + nCuota1 + nCuota2_1;     || cuota
                     aClave3   = #dsm19001#8;
                     especie3  = "N";
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI nBase1 = 0;  |Y nBase2 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + nBase2;     || bases
                 treten2   = treten2   + nCuota2_1;     || cuota
                 trep2     = trep2     + nCuota2_2;     || cuota
                 aClave2   = #dsm19001#8;
                 especie2  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "S";
                         tbases2   = tbases1   + nBase2;    || bases
                         treten2   = treten1   + nCuota2_1;    || cuota
                         trep2     = trep2     + nCuota2_2;     || cuota
                         aClave2   = #dsm19001#8;
                         especie2  = "S";
                         xespe4    = "S";
                     |SINO;
                         tbases3   = tbases3   + nBase2;    || bases
                         treten3   = treten3   + nCuota2_1;    || cuota
                         trep3     = trep3     + nCuota2_2;     || cuota
                         aClave3   = #dsm19001#8;
                         especie3  = "S";
                         xespe4    = "S";
                     |FINSI;
                  |SINO;
                      tbases3   = tbases3   + nBase1 + nBase2;     || bases
                      treten3   = treten3   + nCuota1 + nCuota2_1;     || cuota
                      aClave3   = #dsm19001#8;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
         |FINSI;

         |SI nBase1 ! 0;  |Y nBase2 ! 0;
             |SI aClave2 = "";
                 tbases2   = tbases2   + nBase1;     || bases
                 treten2   = treten2   + nCuota1;     || cuota
                 aClave2   = #dsm19001#8;
                 especie2  = "N";

                 tbases3   = tbases3   + nBase2;     || bases
                 treten3   = treten3   + nCuota2_1;     || cuota
                 trep3     = trep3     + nCuota2_2;     || cuota
                 aClave3   = #dsm19001#8;
                 especie3  = "S";
                 xespe4    = "S";
             |SINO;
                 |SI aClave2 = aClave;
                     |SI especie2 = "N";
                         tbases2   = tbases2   + nBase1;     || bases
                         treten2   = treten2   + nCuota1;     || cuota
                         aClave2   = #dsm19001#8;
                         especie2  = "N";

                         tbases3   = tbases3   + nBase2;     || bases
                         treten3   = treten3   + nCuota2_1;     || cuota
                         trep3     = trep3     + nCuota2_2;     || cuota
                         aClave3   = #dsm19001#8;
                         especie3  = "S";
                         xespe4    = "S";
                     |SINO;
                         tbases3   = tbases3   + nBase1;     || bases
                         treten3   = treten3   + nCuota1;     || cuota
                         aClave3   = #dsm19001#8;
                         especie3  = "N";

                         tbases2   = tbases2   + nBase2;     || bases
                         treten2   = treten2   + nCuota2_1;     || cuota
                         trep2     = trep2     + nCuota2_2;     || cuota
                         aClave2   = #dsm19001#8;
                         especie2  = "S";
                         xespe4    = "S";
                    |FINSI;
                  |SINO;
                      tbases3   = tbases3   + nBase1 + nBase2;     || bases
                      treten3   = treten3   + nCuota1 + nCuota2_1;     || cuota
                      aClave3   = #dsm19001#8;
                      especie3  = "N";
                  |FINSI;
             |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     |SI nContador = 3;
         |SI aClave3 = "";
             tbases3   = tbases3   + nBase1 + nBase2;     || bases
             treten3   = treten3   + nCuota1 + nCuota2_1;     || cuota
             aClave3   = #dsm19001#8;
             especie3  = "N";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm19001C1;
 #dsm19001#1;
 ;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aDNIF,0000," ","  ",0;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aHNIF,9999,"z","zz",9;
 ;
 NULL, dsm19001C1;
|FIN;

||\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

||/////////////////////////////////////////////////////////////////////////
||///// Calculos para el Tipo 2 de Informe ////////////////////////////////
||/////////////////////////////////////////////////////////////////////////

|PROCESO ElAuxw36;
 |SI SwPrimer = 0; |O aElDni ! #dsmow036#0;
     |SI #dsmoy020#14 [ 2015;
         #dsm190li#6  = #dsmow036#0;
     |FINSI;

     |SI #dsmoy020#14 ] 2016;
         #dsm19001#6  = #dsmow036#0;
     |FINSI;

     |HAZ ElTrabajador;

     SwPrimer = 1;
 |FINSI;

 |ABRE #dsmom073;
 #dsmom073#0 = enEjerIRPF;
 #dsmom073#1 = #dsmow036#1;
 #dsmom073#2 = #dsmow036#2;
 |LEE 000#dsmom073.=;
 |SI FSalida ! 0;  |DDEFECTO #dsmom073;  |FINSI;
 |CIERRA #dsmom073;

 eaCodRenta = "";
 |SI #dsmoy020#33 = "S";
     |ABRE #dsam0003;
     |SELECT #2#dsam0003;
     #dsam0003#1 = #dsmow036#0;
     |LEE 040#dsam0003.=;
     |SI FSalida = 0;
         eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
     |SINO;
         |SELECT #3#dsam0003;
         #dsam0003#35 = #dsmow036#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             eaCodRenta = "Codigo de Renta : " + (("00000" + #dsam0003#0) % -105);
         |FINSI;
     |FINSI;
     |CIERRA #dsam0003;
 |FINSI;

 |PRINT;
 |PIEINF;
|FPRC;

|DEFBUCLE ElAuxw36;
 #dsmow036#1;
 ;
 "            ", " ", "  ";
 "zzzzzzzzzzzz", "z", "zz";
 ;
 NULL, ElAuxw36;
|FIN;

|PROCESO Imprimir_2;
   aElDni = ""; aElNombre = "";
   aElDniEmp = ""; aElNomEmp = "";
   aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
   aElSg     = ""; aElCl     = ""; aElNu     = "";
   aElEs     = ""; aElPi     = ""; aElPt     = "";
   aElTl     = ""; aElRe     = "";
   SwPrimer = 0;
   aElDni   = ""; aElNombre = "";
   aElDniEmp = ""; aElNomEmp = "";
   aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
   aElSg     = ""; aElCl     = ""; aElNu     = "";
   aElEs     = ""; aElPi     = ""; aElPt     = "";
   aElTl     = ""; aElRe     = "";
   |BUCLE ElAuxw36;
|FPRC;

||\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

||/////////////////////////////////////////////////////////////////////////
||///// Calculos para el Tipo 3 de Informe ////////////////////////////////
||/////////////////////////////////////////////////////////////////////////


||\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

|PROCESO LeeLaboral;
    nSwExiLab = 0;
    |SI nSwLaboral = 1;
        |ABRE #labempre;
        |DDEFECTO #labempre;
        #labempre#0 = #dsm190ca#0;
        |LEE 000#labempre.=;
        |SI FSalida = 0;
            nSwExiLab = 1;
            nomrep = #labempre#15;
            dnirep = #labempre#17;
            carrep = #labempre#18;
        |FINSI;
        |CIERRA #labempre;
        |QBF nomrep;
        |SI nomrep = "";
            nSwExiLab = 0;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO BuscaCargo190;
   nomrep = #agim0026#4;
   dnirep = #agim0026#3;
   carrep = #agim0026#17;
|FPRC;

|DEFBUCLE agim0026;
    #agim0026#1;
    16;
    #dsm190ca#0, 01, 01, #dsmoy020#32;
    #dsm190ca#0, 99, 99, #dsmoy020#32;
    ;
    NULL, BuscaCargo190;
|FIN;

|PROCESO BuscaCargo190R;
     |SI #agim0024#15 ! "A";
         nomrep = #agim0024#4;
         dnirep = #agim0024#3;
         carrep = "REPRESENTANTE";
         nHayRepre = 1;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#2;
     ;
     #dsm190ca#0, 99, 01;
     #dsm190ca#0, 01, 99;
     ;
     NULL, BuscaCargo190R;
|FIN;

|PROCESO BuscaComuneros;
     aAlfa = "31.12." + #dsm190ca#1;
     |SI #dsmom001#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #dsm190ca#1;
     |SI #dsmom001#9 > "01.01.0000";
         |SI #dsmom001#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nHayRepre = 1;

     enCodCli = #dsmom001#3;
     |HAZ LeePersona;

     |SI enSwDeDonde = 1;
         nomrep = #clientes@#1;
         dnirep = #clientes@#3;
         carrep = "REPRESENTANTE";
     |SINO;
         nomrep = #clientes@#1;
         dnirep = #clientes@#13;
         carrep = "REPRESENTANTE";
     |FINSI;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#1;
     ;
     #dsm190ca#0, 01, 0001;
     #dsm190ca#0, 99, 9999;
     ;
     NULL, BuscaComuneros;
|FIN;

|PROCESO dsm190liC2;
     |SI #dsmoy020#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy020#nCampo# ! "            ";
                   nVale = 1;
                   |SI #dsmoy020#nCampo# = #dsm190li#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
          |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;
     |SI #dsmoy020#34 = "S"; |HAZ OtraSeleccion; |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI SwPrimer = 0; |O aElDni ! #dsm190li#6;
         aElDni = #dsm190li#6;
         eaCodNif = #dsm190li#6;
         |HAZ LeeNifs;
         aElNombre = #regisnif@#1;
         aElDniEmp = #dsmow093#38;
         aElNomEmp = #dsmow093#37;
         aElMunEmp = #dsmow093#40;
         aElProEmp = #dsmow093#42;
         aElCPEmp  = #dsmow093#41;
         aElSg     = #dsmow093#43;
         aElCl     = #dsmow093#44;
         aElNu     = #dsmow093#45;
         aElEs     = #dsmow093#46;
         aElPi     = #dsmow093#47;
         aElPt     = #dsmow093#48;
         aElTl     = #dsmow093#49;
         aElRe     = #dsmow093#34;
         SwPrimer = 1;
     |FINSI;

     || ............................. Sumo Cantidades donde van

     |SI #dsm190li#8 = "L";
         texenta = texenta + (#dsm190li#16 + #dsm190li#18);     || bases
         aClave  = "A";
         aSClave = "";
     |SINO;
         aClave  = #dsm190li#8;
         aSClave = #dsm190li#9;
     |FINSI;
     |SI aClave = "A"; |Y #dsm190li#1 ] 2015; aSClave = ""; |FINSI;

     nSuma21  = #dsm190li#21;
     nSSocial = #dsm190li#22;
     |SI #dsm190li#8 = "A"; |Y #dsm190li#1 ] 2015;
         |HAZ GastosEsp;
     |FINSI;

     #dsmow036#0 = aElDni;
     #dsmow036#1 = aClave;
     #dsmow036#2 = aSClave;
     |LEE 001#dsmow036.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmow036;
         #dsmow036#0 = aElDni;
         #dsmow036#1 = aClave;
         #dsmow036#2 = aSClave;
         |GRABA 020#dsmow036.c;
     |FINSI;

     |SI #dsm190li#8 = "L";
        aAlfa = #dsm190li#9; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
        |SI aAlfa = "01";
           #dsmow036#11 = #dsmow036#11 + #dsm190li#16;
        |SINO;
           #dsmow036#12 = #dsmow036#12 + (#dsm190li#16 + #dsm190li#18);
        |FINSI;
     |SINO;
         |SI #dsm190li#7 ! 0;
             |SI #dsmow036#13 = 0; |O #dsmow036#13 = #dsm190li#7;
                 #dsmow036#13 = #dsm190li#7;
                 #dsmow036#14 = #dsmow036#14 + #dsm190li#17;
                 #dsmow036#15 = #dsmow036#15 + #dsm190li#16;
                 #dsmow036#25 = #dsmow036#25 + nSSocial;
                 #dsmow036#29 = #dsmow036#29 + nSuma21;
             |SINO;
                 |SI #dsmow036#16 = 0; |O #dsmow036#16 = #dsm190li#7;
                     #dsmow036#16 = #dsm190li#7;
                     #dsmow036#17 = #dsmow036#17 + #dsm190li#17;
                     #dsmow036#18 = #dsmow036#18 + #dsm190li#16;
                     #dsmow036#26 = #dsmow036#26 + nSSocial;
                     #dsmow036#30 = #dsmow036#30 + nSuma21;
                 |SINO;
                     |SI #dsmow036#19 = 0; |O #dsmow036#19 = #dsm190li#7;
                         #dsmow036#19 = #dsm190li#7;
                         #dsmow036#20 = #dsmow036#20 + #dsm190li#17;
                         #dsmow036#21 = #dsmow036#21 + #dsm190li#16;
                         #dsmow036#27 = #dsmow036#27 + nSSocial;
                         #dsmow036#31 = #dsmow036#31 + nSuma21;
                     |SINO;
                         |SI #dsmow036#22 = 0; |O #dsmow036#22 = #dsm190li#7;
                             #dsmow036#22 = #dsm190li#7;
                             #dsmow036#23 = #dsmow036#23 + #dsm190li#17;
                             #dsmow036#24 = #dsmow036#24 + #dsm190li#16;
                             #dsmow036#28 = #dsmow036#28 + nSSocial;
                             #dsmow036#32 = #dsmow036#32 + nSuma21;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |SINO;
             #dsmow036#3 = #dsmow036#3 + #dsm190li#16;
             #dsmow036#4 = #dsmow036#4 + #dsm190li#17;
             #dsmow036#5 = #dsmow036#5 + #dsm190li#18;
             #dsmow036#6 = #dsmow036#6 + #dsm190li#19;
             #dsmow036#7 = #dsmow036#7 + #dsm190li#20;
         |FINSI;
     |FINSI;

     #dsmow036#8 = #dsmow036#8 + nSuma21;
     #dsmow036#9 = #dsmow036#9 + nSSocial;

     |GRABA 020#dsmow036.a;

     |SI #dsmoy020#15 = "3";
        |SI aClave = "A"; |O aClave = "L"; |O aClave = "E";
         |O aClave = "F"; |O aClave = "M";
           #dsmow036#0 = aElDni;
           #dsmow036#1 = "Z";    || La clave Z agrupa las claves A, L, E, F y M
           #dsmow036#2 = 00;
           |LEE 001#dsmow036.=;
           |SI FSalida ! 0;
               |DDEFECTO #dsmow036;
               #dsmow036#0 = aElDni;
               #dsmow036#1 = "Z";
               #dsmow036#2 = 00;
               |GRABA 020#dsmow036.c;
           |FINSI;

           |SI #dsm190li#8 = "L";
              aAlfa = #dsm190li#9; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
              |SI aAlfa = "01";
                 #dsmow036#11 = #dsmow036#11 + #dsm190li#16;
              |SINO;
                 #dsmow036#12 = #dsmow036#12 + (#dsm190li#16 + #dsm190li#18);
              |FINSI;
           |SINO;
               |SI #dsm190li#7 ! 0;
                   |SI #dsmow036#13 = 0; |O #dsmow036#13 = #dsm190li#7;
                       #dsmow036#13 = #dsm190li#7;
                       #dsmow036#14 = #dsmow036#14 + #dsm190li#17;
                       #dsmow036#15 = #dsmow036#15 + #dsm190li#16;
                       #dsmow036#25 = #dsmow036#25 + nSSocial;
                       #dsmow036#29 = #dsmow036#29 + nSuma21;
                   |SINO;
                       |SI #dsmow036#16 = 0; |O #dsmow036#16 = #dsm190li#7;
                           #dsmow036#16 = #dsm190li#7;
                           #dsmow036#17 = #dsmow036#17 + #dsm190li#17;
                           #dsmow036#18 = #dsmow036#18 + #dsm190li#16;
                           #dsmow036#26 = #dsmow036#26 + nSSocial;
                           #dsmow036#30 = #dsmow036#30 + nSuma21;
                       |SINO;
                           |SI #dsmow036#19 = 0; |O #dsmow036#19 = #dsm190li#7;
                               #dsmow036#19 = #dsm190li#7;
                               #dsmow036#20 = #dsmow036#20 + #dsm190li#17;
                               #dsmow036#21 = #dsmow036#21 + #dsm190li#16;
                               #dsmow036#27 = #dsmow036#27 + nSSocial;
                               #dsmow036#31 = #dsmow036#31 + nSuma21;
                           |SINO;
                               |SI #dsmow036#22 = 0; |O #dsmow036#22 = #dsm190li#7;
                                   #dsmow036#22 = #dsm190li#7;
                                   #dsmow036#23 = #dsmow036#23 + #dsm190li#17;
                                   #dsmow036#24 = #dsmow036#24 + #dsm190li#16;
                                   #dsmow036#28 = #dsmow036#28 + nSSocial;
                                   #dsmow036#32 = #dsmow036#32 + nSuma21;
                               |FINSI;
                           |FINSI;
                       |FINSI;
                   |FINSI;
               |SINO;
                   #dsmow036#3 = #dsmow036#3 + #dsm190li#16;
                   #dsmow036#4 = #dsmow036#4 + #dsm190li#17;
                   #dsmow036#5 = #dsmow036#5 + #dsm190li#18;
                   #dsmow036#6 = #dsmow036#6 + #dsm190li#19;
                   #dsmow036#7 = #dsmow036#7 + #dsm190li#20;
               |FINSI;
           |FINSI;

           #dsmow036#8 = #dsmow036#8 + nSuma21;
           #dsmow036#9 = #dsmow036#9 + nSSocial;

           |GRABA 020#dsmow036.a;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm190liC2;
 #dsm190li#1;
 ;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aDNIF,0000," ","  ",0;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aHNIF,9999,"z","zz",9;
 ;
 NULL, dsm190liC2;
|FIN;

|PROCESO dsm19001C2;
     nBase1    = #dsm19001#16 + #dsm19001#65;
     nBase2    = #dsm19001#18 + #dsm19001#67;
     nCuota1   = #dsm19001#17 + #dsm19001#66;
     nCuota2_1 = #dsm19001#19 + #dsm19001#68;
     nCuota2_2 = #dsm19001#20 + #dsm19001#69;

     |SI #dsmoy020#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy020#nCampo# ! "            ";
                   nVale = 1;
                   |SI #dsmoy020#nCampo# = #dsm19001#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
          |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI #dsmoy020#34 = "S"; |HAZ OtraSeleccion; |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI #dsmoy020#39 = "S";
         |SI #dsmow171#9 ! 0; |Y nSwLaboral = 1;
             |ABRE #labtraba;
             |SELECT #5#labtraba;
             #labtraba#0 = #dsmow171#8;
             #labtraba#7 = #dsm19001#6;
             |LEE 000#labtraba.=;
             |SI FSalida ! 0;
                 nVale = 1;
             |FINSI;
             |SELECT #1#labtraba;
             |CIERRA #labtraba;
             |SI nVale = 1; |ACABA; |FINSI;
         |FINSI;
     |FINSI;

     |SI SwPrimer = 0; |O aElDni ! #dsm19001#6;
         aElDni = #dsm19001#6;
         eaCodNif = #dsm19001#6;
         |HAZ LeeNifs;
         aElNombre = #regisnif@#1;
         aElDniEmp = #dsmow093#38;
         aElNomEmp = #dsmow093#37;
         aElMunEmp = #dsmow093#40;
         aElProEmp = #dsmow093#42;
         aElCPEmp  = #dsmow093#41;
         aElSg     = #dsmow093#43;
         aElCl     = #dsmow093#44;
         aElNu     = #dsmow093#45;
         aElEs     = #dsmow093#46;
         aElPi     = #dsmow093#47;
         aElPt     = #dsmow093#48;
         aElTl     = #dsmow093#49;
         aElRe     = #dsmow093#34;
         SwPrimer = 1;
     |FINSI;

     || ............................. Sumo Cantidades donde van

     |SI #dsm19001#8 = "L";
         texenta = texenta + (nBase1 + nBase2);     || bases
         aClave  = "A";
         aSClave = "";
     |SINO;
         aClave  = #dsm19001#8;
         aSClave = #dsm19001#9;
     |FINSI;

     nSuma21  = #dsm19001#21;
     nSSocial = #dsm19001#22;

     #dsmow036#0 = aElDni;
     #dsmow036#1 = aClave;
     #dsmow036#2 = aSClave;
     |LEE 001#dsmow036.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmow036;
         #dsmow036#0 = aElDni;
         #dsmow036#1 = aClave;
         #dsmow036#2 = aSClave;
         |GRABA 020#dsmow036.c;
     |FINSI;

     |SI #dsm19001#8 = "L";
        aAlfa = #dsm19001#9; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
        |SI aAlfa = "01";
           #dsmow036#11 = #dsmow036#11 + nBase1;
        |SINO;
           #dsmow036#12 = #dsmow036#12 + (nBase1 + nBase2);
        |FINSI;
     |SINO;
         |SI #dsm19001#7 ! 0;
             |SI #dsmow036#13 = 0; |O #dsmow036#13 = #dsm19001#7;
                 #dsmow036#13 = #dsm19001#7;
                 #dsmow036#14 = #dsmow036#14 + nCuota1;
                 #dsmow036#15 = #dsmow036#15 + nBase1;
                 #dsmow036#25 = #dsmow036#25 + nSSocial;
                 #dsmow036#29 = #dsmow036#29 + nSuma21;
             |SINO;
                 |SI #dsmow036#16 = 0; |O #dsmow036#16 = #dsm19001#7;
                     #dsmow036#16 = #dsm19001#7;
                     #dsmow036#17 = #dsmow036#17 + nCuota1;
                     #dsmow036#18 = #dsmow036#18 + nBase1;
                     #dsmow036#26 = #dsmow036#26 + nSSocial;
                     #dsmow036#30 = #dsmow036#30 + nSuma21;
                 |SINO;
                     |SI #dsmow036#19 = 0; |O #dsmow036#19 = #dsm19001#7;
                         #dsmow036#19 = #dsm19001#7;
                         #dsmow036#20 = #dsmow036#20 + nCuota1;
                         #dsmow036#21 = #dsmow036#21 + nBase1;
                         #dsmow036#27 = #dsmow036#27 + nSSocial;
                         #dsmow036#31 = #dsmow036#31 + nSuma21;
                     |SINO;
                         |SI #dsmow036#22 = 0; |O #dsmow036#22 = #dsm19001#7;
                             #dsmow036#22 = #dsm19001#7;
                             #dsmow036#23 = #dsmow036#23 + nCuota1;
                             #dsmow036#24 = #dsmow036#24 + nBase1;
                             #dsmow036#28 = #dsmow036#28 + nSSocial;
                             #dsmow036#32 = #dsmow036#32 + nSuma21;
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |SINO;
             #dsmow036#3 = #dsmow036#3 + nBase1;
             #dsmow036#4 = #dsmow036#4 + nCuota1;
             #dsmow036#5 = #dsmow036#5 + nBase2;
             #dsmow036#6 = #dsmow036#6 + nCuota2_1;
             #dsmow036#7 = #dsmow036#7 + nCuota2_2;
         |FINSI;
     |FINSI;

     #dsmow036#8 = #dsmow036#8 + nSuma21;
     #dsmow036#9 = #dsmow036#9 + nSSocial;

     |GRABA 020#dsmow036.a;

     |SI #dsmoy020#15 = "3";
        |SI aClave = "A"; |O aClave = "L"; |O aClave = "E";
         |O aClave = "F"; |O aClave = "M";
           #dsmow036#0 = aElDni;
           #dsmow036#1 = "Z";    || La clave Z agrupa las claves A, L, E, F y M
           #dsmow036#2 = 00;
           |LEE 001#dsmow036.=;
           |SI FSalida ! 0;
               |DDEFECTO #dsmow036;
               #dsmow036#0 = aElDni;
               #dsmow036#1 = "Z";
               #dsmow036#2 = 00;
               |GRABA 020#dsmow036.c;
           |FINSI;

           |SI #dsm19001#8 = "L";
              aAlfa = #dsm19001#9; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
              |SI aAlfa = "01";
                 #dsmow036#11 = #dsmow036#11 + nBase1;
              |SINO;
                 #dsmow036#12 = #dsmow036#12 + (nBase1 + nBase2);
              |FINSI;
           |SINO;
               |SI #dsm19001#7 ! 0;
                   |SI #dsmow036#13 = 0; |O #dsmow036#13 = #dsm19001#7;
                       #dsmow036#13 = #dsm19001#7;
                       #dsmow036#14 = #dsmow036#14 + nCuota1;
                       #dsmow036#15 = #dsmow036#15 + nBase1;
                       #dsmow036#25 = #dsmow036#25 + nSSocial;
                       #dsmow036#29 = #dsmow036#29 + nSuma21;
                   |SINO;
                       |SI #dsmow036#16 = 0; |O #dsmow036#16 = #dsm19001#7;
                           #dsmow036#16 = #dsm19001#7;
                           #dsmow036#17 = #dsmow036#17 + nCuota1;
                           #dsmow036#18 = #dsmow036#18 + nBase1;
                           #dsmow036#26 = #dsmow036#26 + nSSocial;
                           #dsmow036#30 = #dsmow036#30 + nSuma21;
                       |SINO;
                           |SI #dsmow036#19 = 0; |O #dsmow036#19 = #dsm19001#7;
                               #dsmow036#19 = #dsm19001#7;
                               #dsmow036#20 = #dsmow036#20 + nCuota1;
                               #dsmow036#21 = #dsmow036#21 + nBase1;
                               #dsmow036#27 = #dsmow036#27 + nSSocial;
                               #dsmow036#31 = #dsmow036#31 + nSuma21;
                           |SINO;
                               |SI #dsmow036#22 = 0; |O #dsmow036#22 = #dsm19001#7;
                                   #dsmow036#22 = #dsm19001#7;
                                   #dsmow036#23 = #dsmow036#23 + nCuota1;
                                   #dsmow036#24 = #dsmow036#24 + nBase1;
                                   #dsmow036#28 = #dsmow036#28 + nSSocial;
                                   #dsmow036#32 = #dsmow036#32 + nSuma21;
                               |FINSI;
                           |FINSI;
                       |FINSI;
                   |FINSI;
               |SINO;
                   #dsmow036#3 = #dsmow036#3 + nBase1;
                   #dsmow036#4 = #dsmow036#4 + nCuota1;
                   #dsmow036#5 = #dsmow036#5 + nBase2;
                   #dsmow036#6 = #dsmow036#6 + nCuota2_1;
                   #dsmow036#7 = #dsmow036#7 + nCuota2_2;
               |FINSI;
           |FINSI;

           #dsmow036#8 = #dsmow036#8 + nSuma21;
           #dsmow036#9 = #dsmow036#9 + nSSocial;

           |GRABA 020#dsmow036.a;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm19001C2;
 #dsm19001#1;
 ;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aDNIF,0000," ","  ",0;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aHNIF,9999,"z","zz",9;
 ;
 NULL, dsm19001C2;
|FIN;

|PROCESO dsm190caC;
     |SI nLectura = 0;
         |SI #dsm190ca#4 ! 0;
             |SI #dsm190ca#10 = "S";
                 nDComple = #dsm190ca#4;
                 nHComple = #dsm190ca#4;
             |SINO;
                 nHComple = #dsm190ca#4;
             |FINSI;
         |SINO;
             nDComple = #dsm190ca#4;
             nHComple = #dsm190ca#4;
         |FINSI;
         |ACABA;
     |FINSI;

     codemp = "";
     nomrep = "";
     dnirep = "";
     carrep = "";
     nomemp = "";
     dniemp = "";
     domemp = "";
     munemp = "";
     cpoemp = "";
     proemp = "";

     nSwExiLab = 0;
     |HAZ LeeLaboral;
     |SI nSwExiLab = 0;
         |SI #dsmom107#1 = "S";
             |BUCLE agim0026;
         |SINO;
             nHayRepre = 0;
             |BUCLE agim0024;
             |SI nHayRepre = 0;
                 |BUCLE dsmom001;
                 |SI nHayRepre = 0;
                     nomrep  = #dsmow171#3;
                     carrep  = "TITULAR";
                     dnirep  = "";
                 |FINSI;
             |FINSI;
         |FINSI;
    |FINSI;

    codemp = #dsm190ca#0; |QBF codemp; codemp = ("00000" + codemp) % -105;
    enCodCli = #dsm190ca#0;
    |HAZ LeePersona;

    |SI enSwDeDonde = 1;
          nomemp = #clientes@#1;   || tique 1222_1187
          dniemp = #clientes@#3;

          aAlfa1 = #clientes@#29; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
          aAlfa2 = #clientes@#30; |QBF aAlfa2; aAlfa2 = aAlfa2 + " ";
          aAlfa3 = #clientes@#31;
          domemp = aAlfa1 + aAlfa2 + aAlfa3;
          190sg = #clientes@#29; 190cl = #clientes@#30; 190nu = #clientes@#31;
          190es = #clientes@#32; 190pi = #clientes@#33; 190pt = #clientes@#34;
          190tl = #clientes@#54;
          munemp = #clientes@#37;
          aAlfa1 = #clientes@#35;  |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #clientes@#36; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          cpoemp = aAlfa1 + aAlfa2;
          proemp = #clientes@#38;
     |SINO;
          nomemp = #clientes@#2;  || tique 1222_1187
          dniemp = #clientes@#13;
          aAlfa1 = #clientes@#3; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
          aAlfa2 = #clientes@#4; |QBF aAlfa2; aAlfa2 = aAlfa2 + " ";
          aAlfa3 = #clientes@#5;
          domemp = aAlfa1 + aAlfa2 + aAlfa3;
          munemp = #clientes@#11;
          aAlfa1 = #clientes@#9;  |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #clientes@#10; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          cpoemp = aAlfa1 + aAlfa2;
          proemp = #clientes@#12;
          190sg = #clientes@#3;  190cl = #clientes@#4;  190nu = #clientes@#5;
          190es = #clientes@#6;  190pi = #clientes@#7;  190pt = #clientes@#8;
          190tl = #clientes@#14;
     |FINSI;

     |SI dnirep = ""; dnirep = dniemp; |FINSI;

     periodo = #dsmoy020#14;

     fprese = #dsmoy020#16;
     aAlfa1 = #dsmoy020#16;
     fecsys = aAlfa1 % 2;    || pasa la fecha a letras
     190fp = fecsys;
     fletra = fecsys % 11;   || coge la parte literal de la fecha
     aAlfa1 = munemp; |QBF aAlfa1;
     fletra = aAlfa1 + ", a " + fletra;  || une la localidad a la fecha literal
     |HAZ FechaPres;

     |SI #dsmoy020#15 = 1;
         SwPrimer = 0;
         aElDni   = ""; aElNombre = "";
         aElDniEmp = ""; aElNomEmp = "";
         aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
         aElSg     = ""; aElCl     = ""; aElNu     = "";
         aElEs     = ""; aElPi     = ""; aElPt     = "";
         aElTl     = ""; aElRe     = "";

         |SI #dsmoy020#14 [ 2015;
             |BUCLE dsm190liC1;
         |FINSI;

         |SI #dsmoy020#14 ] 2016;
             |BUCLE dsm19001C1;
         |FINSI;

         |SI SwPrimer = 1;
             |HAZ Imprimir;
         |FINSI;
     |FINSI;

     |SI #dsmoy020#15 = 2; |O #dsmoy020#15 = 3;
         |DELINDEX #dsmow036;
         SwPrimer = 0;
         aElDni   = "";
         aElNombre = "";
         aElDniEmp = ""; aElNomEmp = "";
         aElMunEmp = ""; aElProEmp = ""; aElCPEmp = "";
         aElSg     = ""; aElCl     = ""; aElNu     = "";
         aElEs     = ""; aElPi     = ""; aElPt     = "";
         aElTl     = ""; aElRe     = "";
         |ABRE #dsmow036;

         |SI #dsmoy020#14 [ 2015;
             |BUCLE dsm190liC2;
         |FINSI;

         |SI #dsmoy020#14 ] 2016;
             |BUCLE dsm19001C2;
         |FINSI;

         |CIERRA #dsmow036;
         |SI SwPrimer = 1;
             |SI #dsmoy020#15 = 2; |HAZ Imprimir_2; |FINSI;
             |SI #dsmoy020#15 = 3;
                |ABRE #dsmow036;
                |LEE 000#dsmow036.p;
                |PARA; |SI FSalida = 0; |HACIENDO;
                    ||TODO CCC
                   |DDEFECTO #dsmow093;
                   #dsmow093#33 = #dsmow171#8;
                   #dsmow093#0 = #dsmow036#0;
                   #dsmow093#1 = #dsmow036#1;
                   #dsmow093#2 = #dsmow036#2;
                   |LEE 101#dsmow093.=;
                   |SI FSalida ! 0; |GRABA 020#dsmow093.b; |FINSI;

                   aAlfa = "|NC"; aAlfa = #dsmow036#aAlfa#; nCalc = aAlfa; nCalc = nCalc - 1;
                   |PARA nCont = 3; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
                      |SI #dsm190ca#10 = "C";
                           #dsmow093#nCont# = #dsmow093#nCont# + #dsmow036#nCont#;
                      |SINO;
                           #dsmow093#nCont# = #dsmow036#nCont#;
                      |FINSI;
                   |SIGUE;
                   #dsmow093#34 = nomrep;
                   #dsmow093#35 = dnirep;
                   #dsmow093#36 = carrep;
                   #dsmow093#37 = nomemp;
                   #dsmow093#38 = dniemp;
                   #dsmow093#39 = domemp;
                   #dsmow093#40 = munemp;
                   #dsmow093#41 = cpoemp;
                   #dsmow093#42 = proemp;
                   #dsmow093#43 = 190sg;
                   #dsmow093#44 = 190cl;
                   #dsmow093#45 = 190nu;
                   #dsmow093#46 = 190es;
                   #dsmow093#47 = 190pi;
                   #dsmow093#48 = 190pt;
                   #dsmow093#49 = 190tl;

                   eaCodNif = #dsmow036#0; |HAZ LeeNifs;

                   |SI nSwLaboral = 1;
                       |ABRE #labtraba; |SELECT #2#labtraba;

                        ||Obtenemos el centro del trabajador
                        nCodCentro    = 0;
                        fFechaAltaAnt = "01.01.0000";
                        #labtraba#7   = #dsmow093#0;
                        |LEE 000#labtraba.=;
                        |PARA; |SI FSalida = 0; |Y #labtraba#7 = #dsmow093#0; |HACIENDO;
                             |SI #dsmow093#33 = #labtraba#0;
                                  aFechaAlta = #labtraba#36;
                                  fFechaAlta = aFechaAlta;
                                  |SI fFechaAlta > fFechaAltaAnt;
                                       nCodCentro = #labtraba#77;
                                       fFechaAltaAnt = fFechaAlta;
                                       aAlfa = ("00000" + #labtraba#1) % -105;
                                       #dsmow093#51 = aAlfa;
                                  |FINSI;
                             |FINSI;
                             |LEE 000#labtraba.s;
                        |SIGUE;
                        #dsmow093#58 = nCodCentro;
                        #dsmow093#59 = ("000" + nCodCentro) % -103;

                       |SELECT #1#labtraba; |CIERRA #labtraba;
                   |FINSI;

                   aAlfa = ("00000" + #dsmow093#33) % -105; #dsmow093#50 = aAlfa;
                   #dsmow093#52 = #regisnif@#1;
                   #dsmow093#53 = #dsmow036#0;
                   aAlfa1 = #regisnif@#9; |QBF aAlfa1; |SI aAlfa1 ! ""; aAlfa1 = aAlfa1 + " "; |FINSI;
                   aAlfa2 = #regisnif@#2; |QBF aAlfa2; |SI aAlfa2 ! ""; aAlfa2 = aAlfa2 + " "; |FINSI;
                   aAlfa3 = #regisnif@#3;
                   #dsmow093#54 = aAlfa1 + aAlfa2 + aAlfa3;
                   #dsmow093#55 = #regisnif@#6;
                   #dsmow093#56 = #regisnif@#7;
                   aAlfa1 = #regisnif@#4; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
                   aAlfa2 = #regisnif@#5; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
                   #dsmow093#57 = aAlfa1 + aAlfa2;

                   |GRABA 020#dsmow093.a;
                   |LIBERA #dsmow093;
                   |LEE 000#dsmow036.s;
                |SIGUE;
                |CIERRA #dsmow036;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsm190caC;
     #dsm190ca#1;
     ;
     #dsmow171#0, #dsmow171#1, #dsmow171#2, #dsmoy020#30, nDComple, 00;
     #dsmow171#0, #dsmow171#1, #dsmow171#2, #dsmoy020#30, nHComple, 99;
     ;
     NULL, dsm190caC;
|FIN;

|RUTINA ClaveBaja998;
     #dsmow101#0 = #dsmow171#8;
     #dsmow101#1 = #dsmow171#1;
     #dsmow101#2 = #dsmow171#2;
     #dsmow101#8 = "            ";
|FRUT;

|RUTINA ClaveAlta998;
     #dsmow101#0 = #dsmow171#8;
     #dsmow101#1 = #dsmow171#1;
     #dsmow101#2 = #dsmow171#2;
     #dsmow101#8 = "zzzzzzzzzzzz";
|FRUT;

|PROCESO dsmow171M;
    |SI #dsmoy020#34 = "S";
        |ABRE #dsmow101;
        #dsmow101#0 = #dsmow171#8;
        #dsmow101#1 = #dsmow171#1;
        #dsmow101#2 = #dsmow171#2;
        #dsmow101#8 = "            ";
        |LEE 001#dsmow101.];
        |SI FSalida = 0; |Y #dsmow101#0 = #dsmow171#8; |Y #dsmow101#1 = #dsmow171#1; |Y #dsmow101#2 = #dsmow171#2;
            |CIERRA #dsmow101;
            |HAZ PonBoton;
            |ENTLINEAL #1#dsmow101, -4, 4, 22, 1, ClaveBaja998, ClaveAlta998;
            |HAZ QuitaBoton;
        |SINO;
            |CIERRA #dsmow101;
        |FINSI;
    |FINSI;

    enEmpresa = #dsmow171#0;
    enSwHay   = enSwHay + 1;

    nDComple  = 0;
    nHComple  = 99;

    nLectura  = 0;  |BUCLE dsm190caC;
    nLectura  = 1;  |BUCLE dsm190caC;
|FPRC;

|DEFBUCLE dsmow171M;
     #dsmow171#1;
     6;
     00000, 00000, 0000, 00, "S";
     99999, 99999, 9999, 99, "S";
     ;
     NULL, dsmow171M;
|FIN;

|| ///////////////////////////////////////////////////


|| Temporales ---------------------------------------------------------------

|PROCESO dsm190li_101;
     eaCodNif = #dsm190li#6;
     |SI #dsmoy020#19 = "            ";
        nVale = 0;
        |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
              |SI #dsmoy020#nCampo# ! "            ";
                  nVale = 1;
                  |SI #dsmoy020#nCampo# = #dsm190li#6;
                       nVale = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |HAZ LeeNifs;

     |ABRE #dsmow101;
     #dsmow101#0 = #dsmow171#0;
     #dsmow101#1 = #dsmow171#1;
     #dsmow101#2 = #dsmow171#2;
     #dsmow101#8 = #dsm190li#6;
     |LEE 001#dsmow101.=;
     |SI FSalida ! 0;
         #dsmow101#0 = #dsmow171#0;
         #dsmow101#1 = #dsmow171#1;
         #dsmow101#2 = #dsmow171#2;
         #dsmow101#3 = #dsmow171#3;
         #dsmow101#4 = #dsmow171#4;
         #dsmow101#5 = #dsmow171#5;
         #dsmow101#6 = #dsmow171#6;
         #dsmow101#7 = #dsmow171#7;
         #dsmow101#8 = #dsm190li#6;
         #dsmow101#9 = #regisnif@#1;
         |GRABA 020#dsmow101.n;
     |FINSI;
     |CIERRA #dsmow101;
|FPRC;

|DEFBUCLE dsm190li_101;
     #dsm190li#1;
     ;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aDNIF,0000," ","  ",0;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aHNIF,9999,"z","zz",9;
     ;
     NULL, dsm190li_101;
|FIN;

|PROCESO dsm19001_101;
     eaCodNif = #dsm19001#6;
     |SI #dsmoy020#19 = "            ";
         nVale = 0;
         |PARA nCampo = 21; |SI nCampo [ 28; |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy020#nCampo# ! "            ";
                   nVale = 1;
                   |SI #dsmoy020#nCampo# = #dsm19001#6;
                        nVale = 2;
                        |SAL;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI nVale = 1; |ACABA; |FINSI;

     |SI #dsmoy020#39 = "S";
         |SI #dsmow171#9 ! 0; |Y nSwLaboral = 1;
             #labtraba#0 = #dsmow171#8;
             #labtraba#7 = #dsm19001#6;
             |LEE 000#labtraba.=;
             |SI FSalida ! 0;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |HAZ LeeNifs;
     |ABRE #dsmow101;
     #dsmow101#0 = #dsmow171#8;
     #dsmow101#1 = #dsmow171#1;
     #dsmow101#2 = #dsmow171#2;
     #dsmow101#8 = #dsm19001#6;
     |LEE 001#dsmow101.=;
     |SI FSalida ! 0;
         #dsmow101#0 = #dsmow171#8;
         #dsmow101#1 = #dsmow171#1;
         #dsmow101#2 = #dsmow171#2;
         #dsmow101#3 = #dsmow171#3;
         #dsmow101#4 = #dsmow171#4;
         #dsmow101#5 = #dsmow171#5;
         #dsmow101#6 = #dsmow171#6;
         #dsmow101#7 = #dsmow171#7;
         #dsmow101#8 = #dsm19001#6;
         #dsmow101#9 = #regisnif@#1;
         |GRABA 020#dsmow101.n;
     |FINSI;
     |CIERRA #dsmow101;
|FPRC;

|DEFBUCLE dsm19001_101;
     #dsm19001#1;
     ;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aDNIF,0000," ","  ",0;
 #dsm190ca#0,#dsm190ca#1,#dsm190ca#2,#dsm190ca#3,#dsm190ca#4,#dsm190ca#5,aHNIF,9999,"z","zz",9;
     ;
     NULL, dsm19001_101;
|FIN;

|PROCESO dsm190ca101;
     |SI #dsmoy020#14 [ 2015;
         |BUCLE dsm190li_101;
     |FINSI;

     |SI #dsmoy020#14 ] 2016;
         |BUCLE dsm19001_101;
     |FINSI;
|FPRC;

|DEFBUCLE dsm190ca101;
     #dsm190ca#1;
     ;
     #dsmow171#0, #dsmow171#1, #dsmow171#2, #dsmoy020#30, nDComple, 00;
     #dsmow171#0, #dsmow171#1, #dsmow171#2, #dsmoy020#30, nHComple, 99;
     ;
     NULL, dsm190ca101;
|FIN;

|PROCESO GrabaTempo;
     enEmpresaPINET = #dsmom004#0;
     |HAZ RestriccionPINET;
     |SI enErrorPINET = 1;  |ACABA;  |FINSI;

     |SI enLabornet = 1; |Y nSwLaboral = 1;
         #labempre#0 = #agifigen#0;
         |LEE 000#labempre.=;
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;
     |FINSI;

     enCodCli = #dsmom004#0;
     |HAZ LeePersona;

     #dsmow171#0  = #dsmom004#0;
     #dsmow171#8  = #agifigen#0;
     #dsmow171#1  = #dsmom004#1;
     #dsmow171#2  = #dsmom004#2;
     |LEE 101#dsmow171.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsmow171;
         #dsmow171#0  = #dsmom004#0;
         #dsmow171#8  = #agifigen#0;
         #dsmow171#1  = #dsmom004#1;
         #dsmow171#2  = #dsmom004#2;
         |GRABA 020#dsmow171.b;
     |FINSI;

     #dsmow171#3  = #clientes@#1;
     #dsmow171#4  = "ANUAL";
     #dsmow171#5  = #dsmoy020#30;
     #dsmow171#6  = "S";
     #dsmow171#7  = #dsmom004#4;
     #dsmow171#9  = nPorGrupos;
     |GRABA 020#dsmow171.a;
     |LIBERA #dsmow171;

     nSwGraba = 1;
     nAlguno  = 1;

     |SI #dsmoy020#34 = "S";
         |BUCLE dsm190ca101;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom004;
     #dsmom004#1;
     ;
     nEmpresa, #dsmoy020#14, #dsmoy020#31, #dsmoy020#30, 00;
     nEmpresa, #dsmoy020#14, #dsmoy020#31, #dsmoy020#30, 99;
     ;
     NULL, GrabaTempo;
|FIN;

|PROCESO PorDsmom026;
/*
      nOk = 0;
      |SI #dsmoy020#0 ! 0;
          |SI #dsmom026#0 ] #dsmoy020#0; |Y #dsmom026#0 [ #dsmoy020#1;
              nOk = 1;
          |FINSI;
      |SINO;
          |PARA nPara2 = 2; |SI nPara2 [ 13; |HACIENDO nPara2 = nPara2 + 1;
                |SI #dsmoy020#nPara2# ! 0;
                    |SI #dsmoy020#nPara2# = #dsmom026#0;  nOk = 1; |FINSI;
               |FINSI;
          |SIGUE;
      |FINSI;
*/

      nAlguno  = 0;
      nEmpresa = #dsmom026#0;
      |BUCLE dsmom004;
|FPRC;

|DEFBUCLE dsmom026;
    #dsmom026#2;
    ;
    nEmpresa, 00001;
    nEmpresa, 99999;
    ;
    NULL, PorDsmom026;
|FIN;

|PROCESO MiroEmpresa;

     nPorGrupos = 0;
     |DDEFECTO #dsmom026;
     |ABRE #dsmom026;
     |SELECT #1#dsmom026;
     #dsmom026#0 = #agifigen#0;
     #dsmom026#1 = 0;
     |LEE 040#dsmom026.];
     |SI FSalida = 0;  |Y #dsmom026#0 = #agifigen#0;
         nPorGrupos = 1;          || empresa Madre
     |SINO;
         |SELECT #2#dsmom026;
         #dsmom026#1 = #agifigen#0;
         #dsmom026#0 = 0;
         |LEE 040#dsmom026.];
         |SI FSalida = 0;  |Y #dsmom026#1 = #agifigen#0;
             |SI #dsmom026#0 ! #dsmom026#1;
                  nPorGrupos = 2;
             |FINSI;
         |FINSI;
      |FINSI;
      |SELECT #1#dsmom026;
      |CIERRA #dsmom026;

      nAlguno  = 0;
      nEmpresa = #agifigen#0;
      |BUCLE dsmom004;
      |SI nAlguno = 0; |Y #dsmoy020#39 = "S";
          |SI nPorGrupos = 2;
              |BUCLE dsmom026;
          |FINSI;
      |FINSI;
|FPRC;

|DEFBUCLE agifigen;
     #agifigen#1;
     ;
     nDEmpresa;
     nHEmpresa;
     ;
     NULL, MiroEmpresa;
|FIN;

|PROCESO Seleccion;
     nSwGraba = 0;
     |SI nSwLaboral = 1;
         |ABRE #labempre;
         |ABRE #labtraba;
         |SELECT #5#labtraba;
     |FINSI;
     |ABRE #dsmow171;
     |SI #dsmoy020#0 ! 0;
         nDEmpresa = #dsmoy020#0;
         nHEmpresa = #dsmoy020#1;
         |BUCLE agifigen;
     |SINO;
         |PARA nPara1 = 2;  |SI nPara1 [ 13;  |HACIENDO nPara1 = nPara1 + 1;
               |SI #dsmoy020#nPara1# ! 0;
                   nDEmpresa = #dsmoy020#nPara1#;
                   nHEmpresa = #dsmoy020#nPara1#;
                   |BUCLE agifigen;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #dsmow171;
     |SI nSwLaboral = 1;
         |SELECT #1#labtraba;
         |CIERRA #labtraba;
         |CIERRA #labempre;
     |FINSI;
|FPRC;

|PROCESO Oficial;
     |DELINDEX #dsmow093;

     |ABRE #dsmow093;
     |ABRE #dsm190ca;

     enSwHay = 0;
     |BUCLE dsmow171M;

     |CIERRA #dsm190ca;
     |CIERRA #dsmow093;

     eaVengoDe = "dsmoy020";
     |HAZ MiraSiArchiva;
     |SI enArchi = 0;
         |HAZ Papel;
     |SINO;
         |MENU aMenu;
         nOpcion = FSalida;
         |SI nOpcion = 1;  |HAZ Papel;      |FINSI;
         |SI nOpcion = 2;  |HAZ Archivado;  |FINSI;
         |SI nOpcion = 3;  |HAZ Papel;      |FINSI;
         |SI nOpcion = 3;  |HAZ Archivado;  |FINSI;
     |FINSI;

     |SI nSwLaboral = 1;
         |SELECT #1#labtraba;
         |CIERRA #labtraba;
     |FINSI;

     |DESCARGA_DEF #espejo1@;
     |DELINDEX #dsmow036;  |DELINDEX #dsmow093;
     |DELINDEX #dsmow101; |DELINDEX #dsmow171;
|FPRC;

|PROCESO IT3;  |TIPO 3;
     eaTMoneda = "Ptas.";
     |SI #dsmoy020#29 ! "PESETAS";
         eaTMoneda = "Euros";
     |FINSI;

     eaMoneda = #dsmoy020#29;
     aDNIF    = #dsmoy020#19;
     aHNIF    = #dsmoy020#20;

     enEjerIRPF = #dsmoy020#14;
     |HAZ BuscaEjerIRPF;

     nTipo       = #dsmoy020#15;
     enEjer      = #dsmoy020#14;        || A쨚 Calculo
     aAlfa1      = #dsmoy020#14;
     aAlfa1      = aAlfa1 % -102;
     nEjer       = aAlfa1;       || Dos ultimos digitos del A쨚

     aFichero = ("ce" + Usuario) % 108;
     |NOME_DAT #dsmow171#aFichero#;
     |ABRE #dsmow171;  |CIERRA #dsmow171;  |DELINDEX #dsmow171;

     aFichero = ("0w" + Usuario) % 108; |NOME_DAT #dsmow036#aFichero#;
     aFichero = ("1w" + Usuario) % 108; |NOME_DAT #dsmow093#aFichero#;
     aFichero = ("2w" + Usuario) % 108; |NOME_DAT #dsmow101#aFichero#;
     |ABRE #dsmow101;  |CIERRA #dsmow101;  |DELINDEX #dsmow101;

     |DBASE aPathModelo;  |QBT aPathModelo;

     |SI #dsmoy020#14 [ 2015;
         aDef = aPathModelo + "def/dsm190li.mas";
     |FINSI;

     |SI #dsmoy020#14 ] 2016;
         aDef = aPathModelo + "def/dsm19001.mas";
     |FINSI;

     |CARGA_DEF aDef, espejo1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ Seleccion;

     |SI nSwGraba = 0;
          |MENAV "     Seleccion Vacia.";
          |DELINDEX #dsmow036; |DELINDEX #dsmow093;
          |DELINDEX #dsmow101; |DELINDEX #dsmow171;
          |ACABA;
     |FINSI;

     |SI #dsmoy020#15 = 3;
         |HAZ Oficial;
         |ACABA;
     |FINSI;

                           eaInforme = "dsmoy020";
     |SI #dsmoy020#15 = 2; eaInforme = "dsmoy120"; |FINSI;
     |SI #dsmoy020#15 = 4; eaInforme = "dsmoy020"; #dsmoy020#15 = 1; |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR eaInforme;
     |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

     |DELINDEX #dsmow093;
     |ABRE #dsmow093;
     |ABRE #dsm190ca;

     enSwHay = 0;
     |BUCLE dsmow171M;
     |CIERRA #dsm190ca;
     |CIERRA #dsmow093;

     |FININF;
     |FINIMP;

     |DESCARGA_DEF #espejo1@;
     |DELINDEX #dsmow036;  |DELINDEX #dsmow093;
     |DELINDEX #dsmow101; |DELINDEX #dsmow171;
|FPRC;

||............... PROGRAMA ......................................

|PROGRAMA;
     eaParam = PARAMETRO; |QBF eaParam;
     |SI eaParam = "LABORNET";
         enLabornet = 1;
         |SI eaRutaFichLab ! "";
             |PATH_DAT #labempre#eaRutaFichLab#;
         |FINSI;
     |FINSI;

     |SI eaParam = ""; |O eaParam = "LABORNET";
         eaParam = "190";
     |FINSI;

     #dsmoy020#30 = eaParam;
     #dsmoy020#31 = 99;

     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;
         |CIERRA #dsmom107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #dsmom107;
     |FINSI;

     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     nSwLaboral = 0;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         nSwLaboral = 1;
     |FINSI;

     |ABRE #agitab99;
     #agitab99#0 = 950;
     |LEE 041#agitab99.=;
     |SI FSalida ! 0;
         |CIERRA #agitab99;
         enDesde = 950;
         enHasta = 952;
         eaPrograma = "agitab99";
         eaExtension = "bas";
         |SUB_EJECUTA_NP ":basica/dspatron";
     |SINO;
         |CIERRA #agitab99;
     |FINSI;

     |SI enEmpresa ! 0;
         |DDEFECTO #dsmoy020;
         #dsmoy020#0  = enEmpresa;
         #dsmoy020#1  = enEmpresa;
         #dsmoy020#14 = enEjer;
         |HAZ IT3;
     |SINO;
         |CLS;
         |MANTE #dsmoy020;
     |FINSI;
|FPRO;

|PROCESO Tipo88;  |TIPO 88;
     |HAZ Relaciones;
|FPRC;
