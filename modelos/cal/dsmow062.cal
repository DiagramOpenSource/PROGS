|FICHEROS;
   dsmoz051 #0;
   dsmom054 #54,MANTE;  ||Mant. Valores por Empresas
   dsmom055 #55,MANTE;  ||Relacion de Socios
   dsmom056 #56;        ||Control de Datos
   dsmow062 #99,MANTE;  ||Temporal V.Empresas Pantalla
|FIN;

|VARIABLES;
 &nBoton2 = 0;
 &nBoton3 = 0;

 aF2     = "";
 aEsc    = "";
 &nTecla  = 0;
 &eaRelCta = "";
 nLnEstado = 0;
 &swUnoSolo = 0;

 nPara1  = 0;
 nNume1  = 0;
|FIN;

|INCLUYE i_variar;
|INCLUYE i_varcon;

|RUTINA ClauBaja55;
 #55#0 = #54#0;
 #55#1 = #54#1;
 #55#2 = 001;
|FRUT;
|RUTINA ClauAlta55;
 #55#0 = #54#0;
 #55#1 = #54#1;
 #55#2 = 999;
|FRUT;

|PROCESO WTipo7;  |TIPO 7;
   |ABRE #54;
   #54#0 = #99#0;
   #54#1 = #99#1;
   |LEE 001#54=;
   |SI FSalida ! 0;
       |DDEFECTO #54;
   |FINSI;
   |CIERRA #54;

   |PINDA #0#54;
   enModo = 7;
   |ENTLINEAL #1#55, -2, 7, 15, 0, ClauBaja55, ClauAlta55;

   |HAZ MTipo7;
   |SI swUnoSolo = 1;
       |PINTA 0501,"      "; |PINTA 0601,"      ";
       |PINTA 0701,"      "; |PINTA 0801,"      ";
       |PINTA 0901,"      ";
       |PTEC 802;
   |FINSI;
|FPRC;

|PROCESO WTipo11;  |TIPO 11;
 nTecla = FSalida;
 |HAZ MTipo0;
|FPRC;

|| **********************************************************************

|PROCESO WTipo0;  |TIPO 0;
 nTecla = FSalida;
 |FIN_CONTROL_WINDOWS nBoton2;
 |FIN_CONTROL_WINDOWS nBoton3;
 |PULSATECLA;

   enEmpresa   = #99#0;
   enEjer      = #99#1;

|| ... Lee Control de Entrada
   |ABRE #56;
   #56#0 = enEjer;
   |LEE 101#56=;
   |SI FSalida ! 0;
      |DDEFECTO #56;
      #56#0 = enEjer;
      #56#1 = enEjer - 1;
      |GRABA 020#56n;
   |FINSI;
   |LIBERA #56;
   |CIERRA #56;

   |ABRE #54;
   #54#0 = enEmpresa;
   #54#1 = enEjer;
   |LEE 001#54=;
   |SI FSalida ! 0;
       |CIERRA #54;
       |ERROR;
       |ACABA;
   |FINSI;

   |PARA nPara1 = 2; |SI nPara1 [ 12; |HACIENDO nPara1 = nPara1 + 1;
         nNume1    = nPara1 + 11;
         |SI #56nPara1 = "M";
             |C_M #54nNume1,1,"S";
         |SINO;
             |C_M #54nNume1,1,"N";
         |FINSI;
   |SIGUE;

   |ENDATOS #2#54;
   |SI FSalida = 0;
       |GRABA 040#54a;
   |FINSI;
   |LIBERA #54;
   |ERROR;
   |SI swUnoSolo = 1;
       swUnoSolo = 0;
       |PTEC 806;
   |FINSI;
|FPRC;
