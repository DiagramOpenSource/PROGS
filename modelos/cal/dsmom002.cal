|FICHEROS;
     dsmom002 #0;
     dsmom005 #5;
     dsmom006 #6;
     :/basica/def/agicen14 #114;
     :/basica/def/agitab11 #111;
     :/basica/def/agitab13 #113;
     :/basica/def/agitab99 #199;
     dsmow001 #900;
|FIN;

|VARIABLES;
      nInstala    = 0;
      aFichero    = "";
      aTipo       = "";

      nModo        = 0;
      nSwGraba     = 0;
      nSwSalir     = 0;
      nModelo      = 0;
      nSwObligados = 0;
      nCodigo      = 0;

 {-1} aMenu       = "";
      aMenu1      = "1262";
      aMenu2      = "1";
      aMenu3      = "3";
      aMenu4      = "TRIMESTRAL";
      aMenu5      = "ANUAL     ";
      aMenu6      = "MENSUAL   ";

      aAlfa  = "";
      nNo322 = 0;
      nNo006 = 0;
|FIN;

|INCLUYE i_variar;

|PROCESO FechaBaja;
     |SI #0#9 ! Contenido;
         enCambio = 1;
     |FINSI;
|FPRC;


|PROCESO Obliga11;
     #5#0 = #111#1;
     |LEE 040#5=;
     |SI FSalida ! 0;     |ACABA;  |FINSI;
     |SI #5#4    = "N";   |ACABA;  |FINSI;

     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = #111#1;
     |LEE 101#0=;
     |SI FSalida ! 0;
         #0#0  = enEmpresa;
         #0#1  = enActividad;
         #0#2  = #111#1;
         #0#10 = 1;
         |GRABA 020#0b;
     |FINSI;

     |ABRE #114;
     #114#0 = #0#0;
     #114#1 = #0#1;
     |LEE 040#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;
     |CIERRA #114;

     aTipo  = #5#5;
     #6#0   = enEmpresa;
     #6#1   = #111#1;
     |LEE 040#6=;
     |SI FSalida = 0;  aTipo = #6#6;  |FINSI;

     #0#3 = #5#1;
     #0#4 = #5#2;
     #0#5 = #5#3;
     #0#6 = eaNombreAct;

     |SI aTipo = "T";  #0#7 = "TRIMESTRAL";  |FINSI;
     |SI aTipo = "A";  #0#7 = "ANUAL     ";  |FINSI;
     |SI aTipo = "M";  #0#7 = "MENSUAL   ";  |FINSI;
     |SI aTipo = "C";  #0#7 = "SELECCIONA";  |FINSI;

     #0#8  = #114#5;
     #0#9  = #114#6;
     #0#10 = 1;

     |GRABA 020#0a;
     |LIBERA #0;

     nSwGraba = 1;
|FPRC;

|DEFBUCLE agitab11_O;
     #111#1;
     5;
     #114#7, 000, "S";
     #114#7, 999, "S";
     ;
     NULL, Obliga11;
|FIN;

|PROCESO Obliga13;
     #5#0 = #113#1;
     |LEE 040#5=;
     |SI FSalida ! 0;     |ACABA;  |FINSI;
     |SI #5#4    = "N";   |ACABA;  |FINSI;

     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = #113#1;
     |LEE 101#0=;
     |SI FSalida ! 0;
         #0#0  = enEmpresa;
         #0#1  = enActividad;
         #0#2  = #113#1;
         #0#10 = 1;
         |GRABA 020#0b;
     |FINSI;

     |ABRE #114;
     #114#0 = #0#0;
     #114#1 = #0#1;
     |LEE 040#114=;
     |SI FSalida ! 0;  |DDEFECTO #114;  |FINSI;
     |CIERRA #114;

     aTipo  = #5#5;
     #6#0   = enEmpresa;
     #6#1   = #113#1;
     |LEE 040#6=;
     |SI FSalida = 0;  aTipo = #6#6;  |FINSI;

     #0#3 = #5#1;
     #0#4 = #5#2;
     #0#5 = #5#3;
     #0#6 = eaNombreAct;

     |SI aTipo = "T";  #0#7 = "TRIMESTRAL";  |FINSI;
     |SI aTipo = "A";  #0#7 = "ANUAL     ";  |FINSI;
     |SI aTipo = "M";  #0#7 = "MENSUAL   ";  |FINSI;
     |SI aTipo = "C";  #0#7 = "SELECCIONA";  |FINSI;

     #0#8  = #114#5;
     #0#9  = #114#6;
     #0#10 = 1;

     |GRABA 020#0a;
     |LIBERA #0;

     nSwGraba = 1;
|FPRC;

|DEFBUCLE agitab13_O;
     #113#1;
     5;
     #114#9, 000, "S";
     #114#9, 999, "S";
     ;
     NULL, Obliga13;
|FIN;

|PROCESO PonObligados;
     |ABRE #5;
     |ABRE #6;
     |BUCLE agitab11_O;
     |BUCLE agitab13_O;
     |CIERRA #5;
     |CIERRA #6;
|FPRC;

|PROCESO CreaTempo11;
     #5#0 = #111#1;
     |LEE 040#5=;
     |SI FSalida ! 0;     |ACABA;  |FINSI;
     |SI #5#4    = "N";   |ACABA;  |FINSI;

     |DDEFECTO #900;
     #900#0 = #5#0;
     #900#1 = #5#1;
     #900#2 = #5#2;
     #900#3 = #5#3;
     #900#6 = #5#5;

     |DDEFECTO #6;
     #6#0   = enEmpresa;
     #6#1   = #111#1;
     |LEE 040#6=;
     |SI FSalida = 0;  #900#6 = #6#6;  |FINSI;

     #0#0   = enEmpresa;
     #0#1   = enActividad;
     #0#2   = #5#0;
     |LEE 040#0=;
     |SI FSalida ! 0;
         #900#4 = " ";
         #900#5 = "*";
         #900#7 = #114#5;
         #900#8 = #114#6;
         #900#9 = "";
     |SINO;
         #900#4 = "*";
         #900#5 = " ";
         #900#7 = #0#8;
         #900#8 = #0#9;
         #900#9 = #0#7;
     |FINSI;
     #900#10 = " ";
     |SI #0#2 = 322;  #900#10 = #6#14;  |FINSI;

     |GRABA 020#900n;
     |LIBERA #900;
|FPRC;

|DEFBUCLE agitab11;
     #111#1;
     ;
     #114#7, 000;
     #114#7, 999;
     ;
     NULL, CreaTempo11;
|FIN;

|PROCESO CreaTempo13;
     #5#0 = #113#1;
     |LEE 040#5=;
     |SI FSalida ! 0;     |ACABA;  |FINSI;
     |SI #5#4    = "N";   |ACABA;  |FINSI;

     |DDEFECTO #900;
     #900#0 = #5#0;
     #900#1 = #5#1;
     #900#2 = #5#2;
     #900#3 = #5#3;
     #900#6 = #5#5;

     #6#0   = enEmpresa;
     #6#1   = #113#1;
     |LEE 040#6=;
     |SI FSalida = 0;  #900#6 = #6#6;  |FINSI;

     #0#0   = enEmpresa;
     #0#1   = enActividad;
     #0#2   = #5#0;
     |LEE 040#0=;
     |SI FSalida ! 0;
         #900#4 = " ";
         #900#5 = "*";
         #900#7 = #114#5;
         #900#8 = #114#6;
         #900#9 = "";
     |SINO;
         #900#4 = "*";
         #900#5 = " ";
         #900#7 = #0#8;
         #900#8 = #0#9;
         #900#9 = #0#7;
     |FINSI;
     #900#10 = "";

     |GRABA 020#900n;
     |LIBERA #900;
|FPRC;

|DEFBUCLE agitab13;
     #113#1;
     ;
     #114#9, 000;
     #114#9, 999;
     ;
     NULL, CreaTempo13;
|FIN;

|PROCESO GrabaFijo;
     |SI nModelo = 187;
         |ABRE #agitab99;
         #agitab99#0 = nModelo;
         |LEE 101#agitab99.=;
         |SI FSalida = 0;
             |SI #agitab99#4 = "N";
                 #agitab99#4 = "S";
                 |GRABA 020#agitab99.a;
             |FINSI;
             |LIBERA #agitab99;
         |FINSI;
         |CIERRA #agitab99;

         #5#0 = nModelo;
         |LEE 101#5=;
         |SI FSalida = 0;
             |SI #5#4 = "N";
                 #5#4 = "S";
                 |GRABA 020#5a;
             |FINSI;
             |LIBERA #5;
         |FINSI;
     |FINSI;

     |SI nModelo = 193;
         |ABRE #agitab99;
         #agitab99#0 = nModelo;
         |LEE 101#agitab99.=;
         |SI FSalida = 0;
             |SI #agitab99#4 = "N";
                 #agitab99#4 = "S";
                 |GRABA 020#agitab99.a;
             |FINSI;
             |LIBERA #agitab99;
         |FINSI;
         |CIERRA #agitab99;

         #5#0 = nModelo;
         |LEE 101#5=;
         |SI FSalida = 0;
             |SI #5#4 = "N";
                 #5#4 = "S";
                 |GRABA 020#5a;
             |FINSI;
             |LIBERA #5;
         |FINSI;
     |FINSI;

     |SI nModelo = 216;
         |ABRE #agitab99;
         #agitab99#0 = nModelo;
         |LEE 101#agitab99.=;
         |SI FSalida = 0;
             |SI #agitab99#4 = "N";
                 #agitab99#4 = "S";
                 #agitab99#5 = "C";
                 #agitab99#6 = "F";
                 #agitab99#7 = "N";
                 #agitab99#8 = "N";
                 |GRABA 020#agitab99.a;
             |FINSI;
             |LIBERA #agitab99;
         |FINSI;
         |CIERRA #agitab99;

         #5#0 = nModelo;
         |LEE 101#5=;
         |SI FSalida = 0;
             |SI #5#4 = "N";
                 #5#4 = "S";
                 #5#5 = "C";
                 #5#6 = "SELECCIONA";
                 #5#7 = "C";
                 #5#8 = "ACT.+ REG.";
                 |GRABA 020#5a;
             |FINSI;
             |LIBERA #5;
         |FINSI;
     |FINSI;

     |SI nModelo = 296;
         |ABRE #agitab99;
         #agitab99#0 = nModelo;
         |LEE 101#agitab99.=;
         |SI FSalida = 0;
             |SI #agitab99#4 = "N";
                 #agitab99#4 = "S";
                 |GRABA 020#agitab99.a;
             |FINSI;
             |LIBERA #agitab99;
         |FINSI;
         |CIERRA #agitab99;

         #5#0 = nModelo;
         |LEE 101#5=;
         |SI FSalida = 0;
             |SI #5#4 = "N";
                 #5#4 = "S";
                 |GRABA 020#5a;
             |FINSI;
             |LIBERA #5;
         |FINSI;
     |FINSI;

     #5#0 = nModelo;
     |LEE 040#5=;
     |SI FSalida ! 0;     |ACABA;  |FINSI;
     |SI #5#4    = "N";   |ACABA;  |FINSI;

     |DDEFECTO #900;

     #900#0 = #5#0;
     |LEE 040#900=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #900#0 = #5#0;
     #900#1 = #5#1;
     #900#2 = #5#2;
     #900#3 = #5#3;
     #900#6 = #5#5;

     #6#0   = enEmpresa;
     #6#1   = nModelo;
     |LEE 040#6=;
     |SI FSalida = 0;  #900#6 = #6#6;  |FINSI;

     #0#0   = enEmpresa;
     #0#1   = enActividad;
     #0#2   = #5#0;
     |LEE 040#0=;
     |SI FSalida ! 0;
         #900#4 = " ";
         #900#5 = "*";
         #900#7 = #114#5;
         #900#8 = #114#6;
         #900#9 = "";
     |SINO;
         #900#4 = "*";
         #900#5 = " ";
         #900#7 = #0#8;
         #900#8 = #0#9;
         #900#9 = #0#7;
     |FINSI;
     #900#10 = "";

     |GRABA 020#900n;
     |LIBERA #900;
|FPRC;

|PROCESO PonFijos;
     nModelo = 110;  |HAZ GrabaFijo;
     nModelo = 115;  |HAZ GrabaFijo;
     nModelo = 123;  |HAZ GrabaFijo;
     nModelo = 216;  |HAZ GrabaFijo;
     nModelo = 180;  |HAZ GrabaFijo;
     nModelo = 190;  |HAZ GrabaFijo;
     nModelo = 193;  |HAZ GrabaFijo;
     nModelo = 296;  |HAZ GrabaFijo;
     nModelo = 187;  |HAZ GrabaFijo;
|FPRC;

|PROCESO CreaModelo;
     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = #900#0;
     |LEE 101#0=;
     |SI FSalida ! 0;
         #0#0  = enEmpresa;
         #0#1  = enActividad;
         #0#2  = #900#0;
         #0#10 = 1;
         |GRABA 020#0b;
     |FINSI;

     #0#3 = #900#1;
     #0#4 = #900#2;
     #0#5 = #900#3;
     #0#6 = eaNombreAct;

     |SI #900#6 = "T";  #0#7 = "TRIMESTRAL";  |FINSI;
     |SI #900#6 = "A";  #0#7 = "ANUAL     ";  |FINSI;
     |SI #900#6 = "M";  #0#7 = "MENSUAL   ";  |FINSI;
     |SI #900#6 = "C";  #0#7 = "SELECCIONA";  |FINSI;

     |SI #900#9 ! "          ";  #0#7 = #900#9;  |FINSI;

     #0#8 = #900#7;
     #0#9 = #900#8;

     |GRABA 020#0a;
     |LIBERA #0;

     nSwGraba = 1;
|FPRC;

|DEFBUCLE dsmow001;
     #900#1;
     4;
     000, "*";
     999, "*";
     ;
     NULL, CreaModelo;
|FIN;

|PROCESO BorraModelo;
     |BORRA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsmom002B;
     #0#1;
     ;
     enEmpresa, enActividad, 000;
     enEmpresa, enActividad, 999;
     be;
     NULL, BorraModelo;
|FIN;

|RUTINA ClaveBaja900;
     #900#0 = 000;
|FRUT;

|RUTINA ClaveAlta900;
     #900#0 = 999;
|FRUT;

|PROCESO CreaModelos;
     nSwGraba = 0;

     |ABRE #114;
     #114#0 = enEmpresa;
     #114#1 = enActividad;
     |LEE 040#114=;
     |SI FSalida ! 0;  |CIERRA #114;  |ACABA;  |FINSI;
     |CIERRA #114;

     |SI nSwObligados = 1;
         |ABRE #0;
         |HAZ PonObligados;
         |CIERRA #0;
         |SI nSwGraba ! 0;  |ACABA;  |FINSI;
     |FINSI;

     aFichero = ("01" + Usuario) % 108;
     |NOME_DAT #900 aFichero;
     |ABRE #900;  |CIERRA #900;  |DELINDEX #900;

     |ABRE #900;
     |ABRE #5;
     |ABRE #6;
     |BUCLE agitab11;
     |BUCLE agitab13;
     |HAZ PonFijos;
     |CIERRA #900;
     |CIERRA #5;
     |CIERRA #6;

     |PUSHV 0501 2380;
     |ENTLINEAL #1#900, -1, 4, 22, 1, ClaveBaja900, ClaveAlta900;
     |POPV;

     |BUCLE dsmom002B;

     |ABRE #0;
     |BUCLE dsmow001;
     |CIERRA #0;

     |DELINDEX #900;
|FPRC;

|PROCESO Tipo1Fm002; |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         enCambio = 1;
     |FINSI;
|FPRC;

|PROCESO Tipo7Fm002; |TIPO 7;
     aAlfa = "0000Pulse <F2> para Crear o Borrar Modelos, <F3> Seleccionar Periodicidad";
     |SI #0#7 ! "SELECCIONA";
         aAlfa = "0000Pulse <F2> para Crear o Borrar Modelos";
     |FINSI;
     |SI #0#2 = 322;
         aAlfa = "0000Pulse <F2> para Crear o Borrar Modelos, <F4> Alta/Consulta Grupo Modelo";
     |FINSI;
     |MENSA aAlfa;
|FPRC;

|PROCESO RefrescaMod;  |TIPO 11;
     |BLIN 4;
     |SI FSalida = 10;
         nSwObligados = 0;
         |HAZ CreaModelos;

         nSwSalir = 1;
         |PTEC 807;
     |FINSI;

     |SI FSalida = 11;
         |SI #0#7 ! "SELECCIONA";
             |ERROR;
             |ACABA;
         |FINSI;

         |LEE 101#0=;

         |PUSHV 0501 2380;
         |PARA; |SI; |HACIENDO;
                |MENUG aMenu;
                aMenu2 = FSalida;

                |SI aMenu2 = "1";   #0#7 = aMenu4;  |SAL;  |FINSI;
                |SI aMenu2 = "2";   #0#7 = aMenu5;  |SAL;  |FINSI;
                |SI aMenu2 = "3";   #0#7 = aMenu6;  |SAL;  |FINSI;
         |SIGUE;
         |POPV;

         |SI #dsmom002#2 = 303;
             |SI #dsmom002#7 ! "MENSUAL   ";
                 |SI #agicen14#7 = 11;  |O #agicen14#7 = 12;
                  |O #agicen14#7 = 13;  |O #agicen14#7 = 15;
                     |CONFI "0000NEl periodo deberia ser MENSUAL por el tipo de IVA de la actividad. Lo cambiamos";
                     |SI FSalida = 0;
                         #dsmom002#7 = "MENSUAL";
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;

         |GRABA 020#0a;
         |LIBERA #0;

         |PINTA #0#7;
         |ERROR;
     |FINSI;

     |SI FSalida = 12;
         |SI #0#2 = 322;
             |LEE 101#0=;

             enEmpresa = #0#0;
             enModelo  = #0#2;
             |SUB_EJECUTA_NP "dsmoz075";
         |FINSI;
         |ERROR;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = 000;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = 999;
|FRUT;

|PROCESO NueMod322;
         nSwSalir = 0;
         nNo322   = 0;
         nNo006   = 0;

         |ABRE #dsmom002;
         |DDEFECTO #dsmom002;
         #dsmom002#0 = enEmpresa;
         #dsmom002#1 = enActividad;
         #dsmom002#2 = 322;
         |LEE 041#dsmom002.=;
         |SI FSalida = 0;
             nNo322 = 1;
         |FINSI;
         |CIERRA #dsmom002;

         |ABRE #dsmom006;
         |DDEFECTO #dsmom006;
         #dsmom006#0 = enEmpresa;
         #dsmom006#1 = 322;
         |LEE 041#dsmom006.=;
         |SI FSalida = 0;
             nNo006 = 1;
         |FINSI;
         |CIERRA #dsmom006;

         |SI nNo006 = 0; |Y nNo322 = 1;
             nSwSalir = 1;
         |FINSI;
|FPRC;

|PROCESO Selecciona;
     nSwSalir = 1;
|FPRC;

|DEFBUCLE dsmom002;
     #0#1;
     7;
     enEmpresa, enActividad, 000, "SELECCIONA";
     enEmpresa, enActividad, 999, "SELECCIONA";
     ;
     NULL, Selecciona;
|FIN;

|PROCESO RecalculaFechas;
     |ABRE #114;
     #114#0 = #0#0;
     #114#1 = #0#1;
     |LEE 040#114=;
     |SI FSalida ! 0;
         |BORRA 020#0a;
         |LIBERA #0;

         |CIERRA #114;
         |ACABA;
     |FINSI;
     |CIERRA #114;

     #0#8  = #114#5;
     #0#9  = #114#6;
     #0#10 = 1;
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsmom002R;
     #0#1;
     10;
     00000, 00, 000, 0;
     99999, 99, 999, 0;
     ;
     NULL, RecalculaFechas;
|FIN;

|PROCESO PonFechas;
     |ABRE #0;
     |LEE 040#0p;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #0;

     |SI #0#10 = 0;
         |BUCLE dsmom002R;   || Recalculo de Fechas;
     |FINSI;
|FPRC;

|PROCESO Graba113;
     #113#0 = nCodigo;
     #113#1 = #agitab99#0;
     |LEE 000#113=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     #113#0 = nCodigo;
     #113#1 = #agitab99#0;
     #113#2 = #agitab99#1;
     #113#3 = #agitab99#2;
     #113#4 = #agitab99#3;
     #113#5 = "N";
     |GRABA 020#113n;
     |LIBERA #113;
|FPRC;

|PROCESO MiraEl184;
     |ABRE #agitab99;
     #agitab99#0 = 184;
     |LEE 000#agitab99.=;
     |SI FSalida = 0;
         |CIERRA #agitab99;
         |ACABA;
     |FINSI;

     |DDEFECTO #agitab99;
     #agitab99#0 = 184;
     #agitab99#1 = "MODELO 184 - IRPF";
     #agitab99#2 = "DECLARACION ANUAL DE ENTIDADES EN REGIMEN DE ATRIBUCION DE RENTAS";
     #agitab99#3 = "DECLARACION INFORMATIVA";
     #agitab99#4 = "S";
     #agitab99#5 = "A";
     #agitab99#6 = "M";
     #agitab99#7 = "N";
     #agitab99#8 = "N";
     |GRABA 020#agitab99.n;
     |LIBERA #agitab99;
     |CIERRA #agitab99;

     eaPrograma = "dsmom002";
     |SUB_EJECUTA_NP "dsmom005";

     |ABRE #113;
     nCodigo = 8;   |HAZ Graba113;
     nCodigo = 9;   |HAZ Graba113;
     nCodigo = 10;  |HAZ Graba113;
     nCodigo = 11;  |HAZ Graba113;
     nCodigo = 12;  |HAZ Graba113;
     nCodigo = 18;  |HAZ Graba113;
     |CIERRA #113;
|FPRC;

|PROCESO MiraEl187;
     |ABRE #agitab99;
     #agitab99#0 = 187;
     |LEE 000#agitab99.=;
     |SI FSalida = 0;
         |CIERRA #agitab99;
         |ACABA;
     |FINSI;

     |DDEFECTO #agitab99;
     #agitab99#0 = 187;
     #agitab99#1 = "MODELO 187 - IRPF";
     #agitab99#2 = "DECLARACION INFORMATIVA DE ACCIONES Y PARTICIPACIONES REPRESENTATIVAS";
     #agitab99#3 = "DEL CAPITAL O DEL PATRIMONIO ...";
     #agitab99#4 = "S";
     #agitab99#5 = "A";
     #agitab99#6 = "M";
     #agitab99#7 = "N";
     #agitab99#8 = "N";
     |GRABA 020#agitab99.n;
     |LIBERA #agitab99;
     |CIERRA #agitab99;

     eaPrograma = "dsmom002";
     |SUB_EJECUTA_NP "dsmom005";

     |ABRE #113;
     nCodigo = 2;   |HAZ Graba113;
     |CIERRA #113;
|FPRC;

|PROCESO MiraEl322;

     |ABRE #agitab99;
     #agitab99#0 = 322;
     |LEE 101#agitab99.=;
     |SI FSalida ! 0;
         |DDEFECTO #agitab99;
         #agitab99#0 = 322;
         #agitab99#1 = "MODELO 322 - I.V.A.";
         #agitab99#2 = "DECLARACION MENSUAL DE GRUPO DE ENTIDADES";
         #agitab99#3 = "MODELO INDIVIDUAL";
         #agitab99#4 = "S";
         #agitab99#5 = "M";
         #agitab99#6 = "F";
         #agitab99#7 = "N";
         #agitab99#8 = "S";
         |GRABA 020#agitab99.n;

         |ABRE #113;
         nCodigo = 16;  |HAZ Graba113;
         |CIERRA #113;
     |FINSI;
     |LIBERA #agitab99;

     #agitab99#0 = 353;
     |LEE 101#agitab99.=;
     |SI FSalida ! 0;
         |DDEFECTO #agitab99;
         #agitab99#0 = 353;
         #agitab99#1 = "MODELO 353 - I.V.A.";
         #agitab99#2 = "DECLARACION MENSUAL DE GRUPO DE ENTIDADES";
         #agitab99#3 = "MODELO AGREGADO";
         #agitab99#4 = "S";
         #agitab99#5 = "M";
         #agitab99#6 = "M";
         #agitab99#7 = "S";
         #agitab99#8 = "N";
         |GRABA 020#agitab99.n;
      |FINSI;
      |LIBERA #agitab99;
      |CIERRA #agitab99;

      |ABRE #113;
      #113#0 = 16;
      #113#1 = 353;
      |LEE 141#113=;
      |SI FSalida = 0;
          |BORRA 020#113.a;
      |FINSI;
      |LIBERA #113;
      |CIERRA #113;

     nInstala = 0;
     |ABRE #dsmom005;
     #dsmom005#0 = 322;
     |LEE 001#dsmom005.=;
     |SI FSalida ! 0;
         nInstala = 1;
     |SINO;
         #dsmom005#0 = 353;
         |LEE 001#dsmom005.=;
         |SI FSalida ! 0;
             nInstala = 1;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom005;

     |SI nInstala = 1;
         eaPrograma = "dsmom002";
         |SUB_EJECUTA_NP "dsmom005";
     |FINSI;
|FPRC;

|PROGRAMA;

     |HAZ MiraEl184;
     |HAZ MiraEl187;
     |HAZ MiraEl322;

     nSwGraba = 1;

     |HAZ PonFechas;

     |ABRE #0;
     #0#0 = enEmpresa;
     #0#1 = enActividad;
     #0#2 = 000;
     |LEE 040#0];
     |SI FSalida ! 0;  |O #0#0 ! enEmpresa;  |O #0#1 ! enActividad;
         |CIERRA #0;
         nSwObligados = 1;
         |HAZ CreaModelos;
     |FINSI;
     |CIERRA #0;

     |SI nSwGraba = 0;  |ACABA;  |FINSI;

     |ET Arriba;
         |ENTLINEAL #1#0, -3, 2, 22, 1, ClaveBaja0, ClaveAlta0;
         |SI nSwSalir = 1;
             nSwSalir = 0;
             |VETE Arriba;
         |FINSI;

         nSwSalir = 0;
         |BUCLE dsmom002;
         |SI nSwSalir = 1;
             |MENAV "     Hay algun modelo sin seleccionar Periodicidad.";
             nSwSalir = 0;
             |VETE Arriba;
         |FINSI;

         nSwSalir = 0;
         |HAZ NueMod322;
         |SI nSwSalir ! 0;
             aAlfa = "0000No informado el Modelo 322 en Modelos por Empresa";
             aAlfa = aAlfa + ". Corrija el Error";
             |MENAV aAlfa;
              nSwSalir = 0;
             |VETE Arriba;
         |FINSI;
|FPRO;
