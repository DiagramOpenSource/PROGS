|FICHEROS;
     dsmom066;
     dsmom067;
|FIN;

|VARIABLES;
      aAlfa    = "";
      aAlfa1   = "";
      aAlfa2   = "";

      nSwEsta  = 0;
      fDFecha  = @;
      fHFecha  = @;

      &eaCifDom    = "";
      &eaNumero    = "";
      &eaDominante = "";
|FIN;

|INCLUYE i_variar;

|PROCESO LeoLinea67;
     nSwEsta = 0;
     |SI #dsmom067#4 [ fHFecha;
         |SI #dsmom067#5 [ "01.01.0000";
             nSwEsta = 1;
         |SINO;
             |SI #dsmom067#5 ] fHFecha;
                 nSwEsta = 1;
             |FINSI;
         |FINSI;
     |FINSI;
     |SI nSwEsta = 1;
         eaCifDom    = #dsmom067#3;
         eaDominante = "P";
         |SI #dsmom067#2 = enEmpresa;
             eaDominante = "D";
         |FINSI;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE LeoLinea67;
    #dsmom067#1;
    ;
    #dsmom066#0, 01;
    #dsmom066#0, 99;
    e;
    NULL, LeoLinea67;
|FIN;

|PROCESO eVerREGE;
    aAlfa1 = ("00" + enPeriodo) % -102;
    aAlfa2 = enEjer;
    aAlfa  = "." + aAlfa1 + "." + aAlfa2;
    aAlfa1 = "01" + aAlfa; fDFecha = aAlfa1;

    aAlfa1 = "31";
    |SI enPeriodo = 4; |O enPeriodo = 6; |O enPeriodo = 9; |O enPeriodo = 11;
        aAlfa1 = "30";
    |FINSI;
    |SI enPeriodo = 2;
        aAlfa1 = "28";
        |SI enEjer = 2012; |O enEjer = 2016; |O enEjer = 2020;
           |O enEjer = 2024; |O enEjer = 2028; |O enEjer = 2032;
              aAlfa1 = "29";
        |FINSI;
    |FINSI;
    aAlfa1 = aAlfa1 + aAlfa; fHFecha = aAlfa1;

    eaCifDom    = "";
    eaDominante = "P";
    |ABRE #dsmom066;
    #dsmom066#0 = eaNumero;
    |LEE 041#dsmom066.=;
    |SI FSalida = 0;
        eaCifDom = #dsmom066#3;
        |SI #dsmom066#2 = enEmpresa;
            eaDominante = "D";
        |FINSI;
        |BUCLE LeoLinea67;
    |FINSI;
    |CIERRA #dsmom066;
|FPRC;
