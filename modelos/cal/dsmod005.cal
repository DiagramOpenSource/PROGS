|FICHEROS;
   dsmoz097 #0;
   dsmod005 #5,MANTE;

   &regisnif@ #709;
|FIN;

|VARIABLES;
  &enDMedio  = 0;
  &enHMedio  = 0;
  inkey      = 0;
  aAlfa1     = "";
  aAlfa2     = "";
  aAlfa3     = "";
  nNume1     = 0;
  aAlfa      = "";
  esalta    =  0;
  fFecha     = @;
  {20}aPopup        = "";
     nID            = 0;
     aID            = "";
     aTexto         = "";

  nBoton5 = 0;
  nBoton6 = 0;
  &enInfComp  = 0;
  aCampo4 = "";
  fCampo5 = @;
|FIN;

|INCLUYE i_variar;

**************************************************************************
|CALCULO DefectoAnyo; |TIPO 7;
   esalta  = (FEntrada / 100) ! 0;
   |SI esalta = 1;
       fFecha = ~;
       aAlfa1 = fFecha % -104;
       #5#2 = aAlfa1; |PINTA #5#2;
   |FINSI;
|FCAL;

|CALCULO elTipo3; |TIPO 3;
   esalta  = (FEntrada / 100) ! 0;
|FCAL;

|PROCESO FinBotond005;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo0d005;  |TIPO 0;
     |HAZ FinBotond005;
|FPRC;

|PROCESO Boton5;
     |PTEC 827;
|FPRC;

|PROCESO Boton6;
     |PTEC 828;
|FPRC;


|CALCULO PresentaLinea;  |TIPO 7;
     |BLIN 04;

     |CONTROL_SIMPLE 0, "LBOTON,F5  Informe Medios Transporte ", 0556, 0579, Boton5;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F6  Emitir Modelo 05    ", 0656, 0679, Boton6;
     nBoton6 = FSalida;

     |HAZ TipoClaves;
|FCAL;

|CALCULO T11; |TIPO 11;
  inkey = FSalida;
  |HAZ FinBotond005;

  |SI inkey = 14;
      |LEE 101#5=
      enEmpresa  = #5#0;
      enEjer     = #5#2;
      enDMedio   = #5#1;
      enHMedio   = 0;
      aCampo4 = #5#4;
      fCampo5 = #5#5;
      #5#4 = " ";
      #5#5 = "01.01.0000";
      |GRABA 020#5a;
      |LIBERA #5;

      enInfComp  = 0;
      |SUB_EJECUTA_NP "dsmoy091;M";
      |SI enInfComp = 1;
          |LEE 101#5=
          #5#4 = aCampo4;
          #5#5 = fCampo5;
          |GRABA 020#5a;
          |LIBERA #5;
      |FINSI;

      |HAZ Refresco;
  |FINSI;

  |SI inkey = 13;
      enEmpresa = #5#0;
      enEjer    = #5#2;
      enDMedio   = 1;
      enHMedio   = 99999;
      |SUB_EJECUTA_NP "dsmoy091;I";
  |FINSI;
|FCAL;

|CALCULO QueTrans; |TIPO 0;
   esalta  = (FEntrada / 100) ! 0;
   aAlfa1 = "S"; aAlfa2 = "N"; aAlfa3 = "N";

   |SI #5#6 = 2; aAlfa1 = "N"; aAlfa2 = "S"; aAlfa3 = "N"; |FINSI;
   |SI #5#6 = 3; aAlfa1 = "N"; aAlfa2 = "N"; aAlfa3 = "S"; |FINSI;

   |C_M #5#8,  1, aAlfa1; |C_M #5#9,  1, aAlfa1; |C_M #5#10, 1, aAlfa1;
   |C_M #5#11, 1, aAlfa1; |C_M #5#12, 1, aAlfa1;

   |C_M #5#13, 1, aAlfa2; |C_M #5#14, 1, aAlfa2;
   |C_M #5#15, 1, aAlfa2; |C_M #5#16, 1, aAlfa2;

   |C_M #5#17, 1, aAlfa3; |C_M #5#18, 1, aAlfa3; |C_M #5#19, 1, aAlfa3;
   |C_M #5#20, 1, aAlfa3; |C_M #5#21, 1, aAlfa3;

   |SI #5#6 ! 1;
       #5#8  = ""; |PINTA #5#8;
       #5#9  = ""; |PINTA #5#9;
       #5#10 = ""; |PINTA #5#10;
       #5#11 = ""; |PINTA #5#11;
       #5#12 = ""; |PINTA #5#12;
   |FINSI;
   |SI #5#6 ! 2;
       #5#13 = ""; |PINTA #5#13;
       #5#14 = ""; |PINTA #5#14;
       #5#15 = ""; |PINTA #5#15;
       #5#16 = 0;  |PINTA #5#16;
   |SINO;
       |SI esalta  = 1;
           #5#22 = "RE5 "; |PINTA #5#22;
       |FINSI;
   |FINSI;
   |SI #5#6 ! 3;
       #5#17 = ""; |PINTA #5#17;
       #5#18 = ""; |PINTA #5#18;
       #5#19 = ""; |PINTA #5#19;
       #5#20 = 0;  |PINTA #5#20;
       #5#21 = ""; |PINTA #5#21;
   |FINSI;
|FCAL;

|PROCESO Tipo66C22;  |TIPO 66;

     aAlfa = "|C022WID";
     aID   = #5#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 10;
     aPopup3  = "NS1  - Fuerzas Armadas y Cuerpos de Seguridad. NO SUJECION";
     aPopup4  = "NS2  - Ambulancias. NO SUJECION";
     aPopup5  = "ER1  - Autotaxis, autoturismos. EXENCION";
     aPopup6  = "ER2  - Vehiculos ense바nza de conductores. EXENCION";
     aPopup7  = "ER3  - Vehiculos alquiler. EXENCION";
     aPopup8  = "ER4  - Vehiculos uso discapacitados. EXENCION";
     aPopup9  = "ER5  - Embarcaciones deportivas o recreo alquiler. EXENCION";
     aPopup10 = "ER6  - Aeronaves ense바nza pilotos. EXENCION";
     aPopup11 = "ER7  - Aeronaves arrendamiento. EXENCION";
     aPopup12 = "RE1  - Vehiculos familia numerosa. REDUCCION";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 104; #5#22 = aAlfa;
     |FINSI;

     |PINTA #5#22;
|FPRC;

|CALCULO TClaves; |TIPO 0;

     |HAZ TipoClaves;
     aAlfa = aTexto; |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000 Clave de Solicitud incorrecta";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = "";
     |SI #5#6 = 1;
         |SI #5#22 = "ER5 "; |O #5#22 = "ER6 "; |O #5#22 = "ER7 ";
             aAlfa = "    NClave incorrecta para Vehiculo. Continuar ";
         |FINSI;
     |FINSI;
     |SI #5#6 = 2;
         |SI #5#22 ! "ER5 ";
             aAlfa = "    NClave incorrecta para Embarcacion. Continuar ";
         |FINSI;
     |FINSI;
     |SI #5#6 = 3;
         |SI #5#22 ! "ER6 "; |Y #5#22 ! "ER7 ";
             aAlfa = "    NClave incorrecta para Aeronave. Continuar ";
         |FINSI;
     |FINSI;
     |SI aAlfa ! "";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             aAlfa = " " * 52;
             |PINTA 2125, aAlfa;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #5#22 = "RE1 ";
         |C_M #5#23,1,"S";
         |C_M #5#24,1,"S";
     |SINO;
         |C_M #5#23,1,"N"; #5#23 = ""; |PINTA #5#23;
         |C_M #5#24,1,"N"; #5#24 = ""; |PINTA #5#24;
     |FINSI;
|FCAL;

|CALCULO TipoClaves; |TIPO 0;
     aTexto = " " * 52;
     |SI #5#22 = "NS1 "; aTexto = "Fuerzas Armadas y Cuerpos de Seguridad. NO SUJECION"; |FINSI;
     |SI #5#22 = "NS2 "; aTexto = "Ambulancias. NO SUJECION                           "; |FINSI;
     |SI #5#22 = "ER1 "; aTexto = "Autotaxis. Autoturismos. EXENCION                  "; |FINSI;
     |SI #5#22 = "ER2 "; aTexto = "Vehiculos ense바nza de conductores. EXENCION       "; |FINSI;
     |SI #5#22 = "ER3 "; aTexto = "Vehiculos alquiler. EXENCION                       "; |FINSI;
     |SI #5#22 = "ER4 "; aTexto = "Vehiculos uso discapacitados. EXENCION               "; |FINSI;
     |SI #5#22 = "ER5 "; aTexto = "Embarcaciones deportivas o recreo alquiler.EXENCION"; |FINSI;
     |SI #5#22 = "ER6 "; aTexto = "Aeronaves ense바nza pilotos. EXENCION              "; |FINSI;
     |SI #5#22 = "ER7 "; aTexto = "Aeronaves arrendamiento. EXENCION                  "; |FINSI;
     |SI #5#22 = "RE1 "; aTexto = "Vehiculos familia numerosa. REDUCCION              "; |FINSI;
     |ATRI I; |PINTA 2125, aTexto; |ATRI 0;
|FCAL;

|PROCESO MiraDnimod005;  |TIPO 6;
     eaVarDni  = #5Campo;
     enCalcCif = 0;
     |HAZ CalculameDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #5Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #5Campo = eaVarDni;  |PINTA #5Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Dnimod005;
     inkey = FSalida;
     |C_M #5#23,0,aAlfa1;
     |SI aAlfa1 = ""; |ACABA; |FINSI;

     |SI inkey = 10;
         eaVarDni  = #5Campo;
         enCalcCif = 1;
         |HAZ CalculameDNI;
         #5Campo = eaVarDni;
         |PINTA #5Campo;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO PonDatosNif;  |TIPO 7;
     eaCodNif  = #5#23;
     |HAZ LeeNifs;

     #5#24  = #709#1;   |PINTA #5#24;
|FPRC;
