|FICHEROS;
     dsmod309 #309;

     dsmow518 #518;
     dsmow592 #592;
     dsmow612 #612;

     &clientes@ #715;
     &datosper@ #718;
     &regisnif@ #709;
|FIN;

|VARIABLES;
     nHandle     = 0;
     &fFechaEmi  = @;
     &eaCamp9_11 = "";
     &efCamp9_12 = @;
|FIN;

|INCLUYE i_varemi;

|PROCESO CargaEmpresa;
     enCodCli = #309#0;
     |HAZ LeePersona;

     |DDEFECTO #518;

     enCalcCif = 0;

     |SI enSwDeDonde = 1;
         #518#4   = (("00" + #715#15) % -102) + (("000" + #715#16) % -103);
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #518#5   = eaVarDni;

         aAlfa1   = #718#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #718#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;
             eaAlfa = #718#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;
             #518#6 = aAlfa1 + " " + aAlfa2;
             eaAlfa = #718#4;  |HAZ QuitaRaros;  #518#7 = eaAlfa;
         |SINO;
             eaAlfa = #715#1;  |HAZ QuitaRaros;  #518#6  = eaAlfa;
             #518#7  = ".";
         |FINSI;
         #518#8  = #715#29;
         eaAlfa  = #715#30;  |HAZ QuitaRaros;  #518#9 = eaAlfa;
         #518#10 = #715#31 % 104;
         #518#11 = #715#32;
         #518#12 = #715#33;
         #518#13 = #715#34;
         #518#14 = (("00" + #715#35) % -102) + (("000" + #715#36) % -103);
         eaAlfa  = #715#37;  |HAZ QuitaRaros;      #518#15 = eaAlfa;
         eaAlfa  = #715#38;  |HAZ QuitaRaros;      #518#16 = eaAlfa;
         eaAlfa  = #715#55;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#55; |HAZ QuitaRarosTfno; #518#17 = eaAlfa;
         |SINO;
             eaAlfa  = #715#54;  |HAZ QuitaRarosTfno;   #518#17 = eaAlfa;
         |FINSI;

         eaDeleg     = #715#17;
         eaAdmin     = #715#18;
     |SINO;
         #518#4   = (("00" + #715#63) % -102) + (("000" + #715#64) % -103);
         eaVarDni = #715#13;  |HAZ CalculameDNI;    #518#5   = eaVarDni;
         eaAlfa   = #715#1;  |HAZ QuitaRaros;      #518#6  = eaAlfa;
         #518#7   = ".";
         #518#8   = #715#3;
         eaAlfa   = #715#4;  |HAZ QuitaRaros;      #518#9 = eaAlfa;
         #518#10 = #715#5 % 104;
         #518#11 = #715#6;
         #518#12 = #715#7;
         #518#13 = #715#8;
         #518#14 = (("00" + #715#9) % -102) + (("000" + #715#10) % -103);
         eaAlfa  = #715#11;  |HAZ QuitaRaros;     #518#15 = eaAlfa;
         eaAlfa  = #715#12;  |HAZ QuitaRaros;     #518#16 = eaAlfa;
         eaAlfa  = #715#61;  |QBF eaAlfa;
         |SI eaAlfa ! "";
             eaAlfa  = #715#61; |HAZ QuitaRarosTfno; #518#17 = eaAlfa;
         |SINO;
             eaAlfa  = #715#14;  |HAZ QuitaRarosTfno;   #518#17 = eaAlfa;
         |FINSI;

         eaDeleg     = #715#91;
         eaAdmin     = #715#92;
     |FINSI;

     #518#18  = #309#2;
     |SI #309#3 = 3;   #518#19 = "1T";  |FINSI;
     |SI #309#3 = 6;   #518#19 = "2T";  |FINSI;
     |SI #309#3 = 9;   #518#19 = "3T";  |FINSI;
     |SI #309#3 = 12;  #518#19 = "4T";  |FINSI;
     |SI #309#3 = 99;  #518#19 = "OA";  |FINSI;

     |PUSHV 0501 2380;

     |BLANCO 1023 2380;
     |CUADRO 1023 2380;

     E_inf   = "";
     E_sup   = "10";

     |PINTA 1525, "Introduzca la Fecha de Emision del Modelo";
     fFechaEmi = ~;
     fFechaEmi = 1745 ? 1;

     eaAlfa  = fFechaEmi;  |HAZ FechaBonito;
     #518#31 = eaDiaB;
     #518#32 = eaMesB;
     #518#33 = eaAnyoB;

     |POPV;
|FPRC;

|PROCESO BloquePapel;

         |IMPRE 0;
         |SI FSalida = 0;
             |SI #309#2 ] 2016;
                 |INFOR "m309ch02";
             |SINO;
                 |INFOR "m309ch01";
             |FINSI;
             |SI FSalida = 0;
                 |HAZ CargaEmpresa;

                 |MENAV "      Coloque Impreso 309 y pulse una tecla para continuar";

                 |PRINT;
                 |PIEINF;
                 |FININF;

                 eaCamp9_11 = "X";
                 efCamp9_12 = fFechaEmi;
             |FINSI;
             |FINIMP;
         |FINSI;
|FPRC;
|| ///////////////////////////////////////////////////////////////////////

|PROCESO Bloque2015;

         |HAZ LeeUnidad;
         eaPathInternet = eaUnidad + "/AEAT";                               |RMKDIR eaPathInternet;
         eaPathInternet = eaPathInternet + "/INTERNET";                     |RMKDIR eaPathInternet;
         eaPathInternet = eaPathInternet + "/309";                          |RMKDIR eaPathInternet;
         eaPathInternet = eaPathInternet + "/" + #309#2;                    |RMKDIR eaPathInternet;
         eaPathInternet = eaPathInternet + "/" + (("00" + #309#3) % -102);  |RMKDIR eaPathInternet;
         eaPathInternet = eaPathInternet + "/";

         aAbre = eaPathInternet + "309" + (("00000" + #309#0) % -105) + ".TXT";
         |XABRE "BWC", aAbre, nHandle;

         enCambiaMoneda = 1;

         |DDEFECTO #592;

         enCodCli = #309#0;
         |HAZ LeePersona;

         #592#1 = "309";
         #592#2 = "E";
         #592#3 = "I";

         enCalcCif = 0;

         |SI enSwDeDonde = 1;
             eaVarDni = #715#3;   |HAZ CalculameDNI;   #592#4  = eaVarDni;
             eaAlfa   = #715#57;  |HAZ QuitaRaros;     #592#5  = eaAlfa;
             eaAlfa   = #715#53;  |HAZ QuitaRaros;     #592#62 = eaAlfa;
             eaAlfa   = #715#55;  |QBF eaAlfa;
             |SI eaAlfa ! "";
                 eaAlfa  = #715#55; |HAZ QuitaRarosTfno; #592#63 = eaAlfa;
             |SINO;
                 eaAlfa  = #715#54; |HAZ QuitaRarosTfno; #592#63 = eaAlfa;
             |FINSI;
         |SINO;
             aAlfa = #715#96; |QBF aAlfa; |SI aAlfa = ""; #715#96 = #715#1; |FINSI;
             eaVarDni = #715#13;  |HAZ CalculameDNI;   #592#4  = eaVarDni;
             eaAlfa   = #715#96;  |HAZ QuitaRaros;     #592#62 = eaAlfa;
             eaAlfa   = #715#61;  |QBF eaAlfa;
             |SI eaAlfa ! "";
                 eaAlfa  = #715#61; |HAZ QuitaRarosTfno; #592#63 = eaAlfa;
             |SINO;
                 eaAlfa  = #715#14; |HAZ QuitaRarosTfno; #592#63 = eaAlfa;
             |FINSI;
         |FINSI;

         #592#6   = #309#2;

         |SI #309#3 = 3;   #592#7 = "1T";  |FINSI;
         |SI #309#3 = 6;   #592#7 = "2T";  |FINSI;
         |SI #309#3 = 9;   #592#7 = "3T";  |FINSI;
         |SI #309#3 = 12;  #592#7 = "4T";  |FINSI;
         |SI #309#3 = 99;  #592#7 = "OA";  |FINSI;

         eaVarDni = #309#19;   |HAZ CalculameDNI;   #592#8  = eaVarDni;
         eaAlfa   = #309#20;   |HAZ QuitaRaros;     #592#9  = eaAlfa;
         eaAlfa   = #309#21;   |HAZ QuitaRaros;     #592#10 = eaAlfa;

         #592#11  = #309#22;
         #592#12  = #309#23;
         #592#13  = #309#24;
         #592#14  = #309#25;
         #592#15  = #309#26;
         #592#16  = #309#27;
         #592#17  = #309#28;
         #592#18  = #309#29;
         #592#19  = #309#30;
         #592#20  = #309#31;
         #592#21  = #309#32;
         #592#22  = #309#33;

         eaAlfa   = #309#34;   |HAZ QuitaRaros;                    #592#23 = eaAlfa;
         eaAlfa   = #309#35;   |HAZ QuitaRaros;                    #592#24 = eaAlfa;
         eaAlfa   = #309#36;   |HAZ QuitaRaros;                    #592#25 = eaAlfa;
         eaAlfa   = #309#37;   |HAZ QuitaRaros;                    #592#26 = eaAlfa;
         eaAlfa   = #309#38;   |HAZ QuitaRaros;                    #592#27 = eaAlfa;

         eaAlfa   = #309#39;   |HAZ QuitaRaros;                    #592#28 = eaAlfa;
         eaAlfa   = #309#40;   |HAZ QuitaRaros;                    #592#29 = eaAlfa;
         eaAlfa   = #309#41;   |HAZ QuitaRaros;                    #592#30 = eaAlfa;
         nNume    = #309#42;   eaAlfa = ("00000" + nNume) % -106;  #592#31 = eaAlfa;

         eaAlfa   = #309#43;   |HAZ QuitaRaros;                    #592#32 = eaAlfa;
         eaAlfa   = #309#44;   |HAZ QuitaRaros;                    #592#33 = eaAlfa;
         eaAlfa   = #309#45;   |HAZ QuitaRaros;                    #592#34 = eaAlfa;
                                                                   #592#35 = #309#46;
         nNume    = #309#47;   eaAlfa = ("000000000000" + nNume) % -112;  #592#36 = eaAlfa;


         enNume   = #309#48;  |HAZ Conver13;  #592#37 = eaAlfa;
         enNume   = #309#49 * 100;            #592#38 = ("00000" + enNume) % -105;
         enNume   = #309#50;  |HAZ Conver13;  #592#39 = eaAlfa;
         enNume   = #309#51;  |HAZ Conver13;  #592#40 = eaAlfa;
         enNume   = #309#52 * 100;            #592#41 = ("00000" + enNume) % -105;
         enNume   = #309#53;  |HAZ Conver13;  #592#42 = eaAlfa;
         enNume   = #309#54;  |HAZ Conver13;  #592#43 = eaAlfa;
         enNume   = #309#55 * 100;            #592#44 = ("00000" + enNume) % -105;
         enNume   = #309#56;  |HAZ Conver13;  #592#45 = eaAlfa;
         enNume   = #309#57;  |HAZ Conver13;  #592#46 = eaAlfa;
         enNume   = #309#58 * 100;            #592#47 = ("00000" + enNume) % -105;
         enNume   = #309#59;  |HAZ Conver13;  #592#48 = eaAlfa;
         enNume   = #309#60;  |HAZ Conver13;  #592#49 = eaAlfa;
         enNume   = #309#61 * 100;            #592#50 = ("00000" + enNume) % -105;
         enNume   = #309#62;  |HAZ Conver13;  #592#51 = eaAlfa;
         enNume   = #309#63;  |HAZ Conver13;  #592#52 = eaAlfa;
         enNume   = #309#64 * 100;            #592#53 = ("00000" + enNume) % -105;
         enNume   = #309#65;  |HAZ Conver13;  #592#54 = eaAlfa;
         enNume   = #309#66;  |HAZ Conver13;  #592#55 = eaAlfa;
         enNume   = #309#67 * 100;            #592#56 = ("00000" + enNume) % -105;
         enNume   = #309#68;  |HAZ Conver13;  #592#57 = eaAlfa;
         enNume   = #309#69;  |HAZ Conver13;  #592#58 = eaAlfa;
         enNume   = #309#70;  |HAZ Conver13;  #592#59 = eaAlfa;
         enNume   = #309#71;  |HAZ Conver13;  #592#60 = eaAlfa;

         |SI #309#4 > 0;
             #592#61 = #309#72;
         |FINSI;

         aAlfa = "";
         |PARA nCampo = 1;  |SI nCampo [ 65;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #592nCampo;
               |XGRABA nHandle, aAlfa;
         |SIGUE;

         |XCIERRA nHandle;

         aAlfa =  "      Los ficheros generados estan en: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;

         eaCamp9_11 = "X";
         efCamp9_12 = fFechaEmi;
|FPRC;

|| ///////////////////////////////////////////////////////////////////////
|PROCESO PersonaFis2015;
     aAlfa = eaVarDni % 101;
     |SI aAlfa = "0"; |O aAlfa = "1"; |O aAlfa = "2"; |O aAlfa = "3";
      |O aAlfa = "4"; |O aAlfa = "5"; |O aAlfa = "6"; |O aAlfa = "7";
      |O aAlfa = "8"; |O aAlfa = "9"; |O aAlfa = "X"; |O aAlfa = "Y";
      |O aAlfa = "Z";
         eaAlfa = #715#1;     |HAZ BuscaNombre;
         eaAlfa = eaAlfa1;    |HAZ QuitaRaros;     #612#8   = eaAlfa;
         eaAlfa = eaAlfa2;    |HAZ QuitaRaros;     #612#9   = eaAlfa;
      |SINO;
         eaAlfa   = #clientes@#1;    |HAZ QuitaRaros;    #612#8   = eaAlfa;
                                                         #612#9   = " ";
      |FINSI;
|FPRC;

|PROCESO AbrePagina;
     eaPathAEAT = eaUnidadBasico + "\AEAT";        |RMKDIR eaPathAEAT;
     eaPathAEAT = eaPathAEAT + "\309";             |RMKDIR eaPathAEAT;
     eaPathAEAT = eaPathAEAT + "\" + #309#2;       |RMKDIR eaPathAEAT;
     eaPathAEAT = eaPathAEAT + "\" + (("00" + #309#3) % -102);  |RMKDIR eaPathAEAT;
     eaPathAEAT = eaPathAEAT + "\";

     eaFOrigen  = eaPathEmision  + eaFicheroPlano;
     eaFDestino = eaPathAEAT + eaFicheroPlano;
     |HAZ CopiaFichero;

     aAlfa       = eaPathLanza;
     eaPathLanza = eaPathAEAT;
     |HAZ TraeSoloWait;
     eaPathLanza = aAlfa;

     eaForzExplorador = "N";
     |HAZ Explorador;

     aAbre = eaPathAEAT + "imp" + Usuario + ".bat";
     |XABRE "WBC", aAbre, enHandlePortal;

     eaAlfa = eaPathAEAT + "wait ";
     |HAZ GrabaPortalSin;

     eaAlfa = eaPathExplorador + " " + &34;
     |HAZ GrabaPortalSin;

     |SI eaOpcion = "1";
         eaAlfa = "https://www2.agenciatributaria.gob.es/wlpl/OV16-M309/index.zul";
     |SINO;
         eaAlfa = "https://www1.agenciatributaria.gob.es/wlpl/OV16-M309/index.zul";
     |FINSI;
     |HAZ GrabaPortalSin;

     eaAlfa = "";
     |HAZ GrabaPortal;

     |XCIERRA enHandlePortal;

     |RSYSTEM aAbre;

     aAlfa = eaPathExplorador > "";
     aAlfa = aAlfa - "CHROME.EXE";
     |SI FSalida ! 0;  |SLEEP 1;  |FINSI;

     aAlfa = eaPathAEAT + aFichero;
     |RFBORRA aAlfa;
     |RFBORRA aAbre;
|FPRC;

|PROCESO Carga309_2016;
     |DDEFECTO #612;

     enCodCli = #309#0;
     |HAZ LeePersona;

     #612#6 = "I";

     enCalcCif = 0;

     |SI enSwDeDonde = 1;
         eaVarDni = #715#3;  |HAZ CalculameDNI;   #612#7  = eaVarDni;

         aAlfa1   = #datosper@#2;  |QBT aAlfa1;
         |SI aAlfa1 ! "";
             eaAlfa = #datosper@#2;  |HAZ QuitaRaros;  aAlfa1 = eaAlfa;  |QBF aAlfa1;
             eaAlfa = #datosper@#3;  |HAZ QuitaRaros;  aAlfa2 = eaAlfa;  |QBF aAlfa2;
             #612#8 = aAlfa1 + " " + aAlfa2;

             eaAlfa = #datosper@#4;  |HAZ QuitaRaros;
             #612#9 = eaAlfa;
         |SINO;
             |HAZ PersonaFis2015;
         |FINSI;
     |SINO;
         eaVarDni = #715#13;  |HAZ CalculameDNI;   #612#7   = eaVarDni;
         |HAZ PersonaFis2015;
     |FINSI;

     #612#10   = #309#2;

     |SI #309#3 = 3;   #612#11 = "1T";  |FINSI;
     |SI #309#3 = 6;   #612#11 = "2T";  |FINSI;
     |SI #309#3 = 9;   #612#11 = "3T";  |FINSI;
     |SI #309#3 = 12;  #612#11 = "4T";  |FINSI;
     |SI #309#3 = 99;  #612#11 = "OA";  |FINSI;

     |SI #309#29 = "X";
         eaVarDni = #309#19;   |HAZ CalculameDNI;   #612#12  = eaVarDni;
         eaAlfa   = #309#20;   |HAZ QuitaRaros;     #612#13  = eaAlfa;
         eaAlfa   = #309#137;  |HAZ QuitaRaros;     #612#14  = eaAlfa;
         eaAlfa   = #309#21;   |HAZ QuitaRaros;     #612#15  = eaAlfa;
     |FINSI;

     |SI #309#22 = "X"; #612#16 = "1"; |FINSI;
     |SI #309#23 = "X"; #612#16 = "2"; |FINSI;
     |SI #309#24 = "X"; #612#16 = "3"; |FINSI;
     |SI #309#25 = "X"; #612#16 = "4"; |FINSI;
     |SI #309#26 = "X"; #612#16 = "5"; |FINSI;
     |SI #309#27 = "X"; #612#16 = "6"; |FINSI;

     |SI #309#28 = "X"; #612#17 = "1"; |FINSI;
     |SI #309#29 = "X"; #612#17 = "2"; |FINSI;
     |SI #309#30 = "X"; #612#17 = "3"; |FINSI;
     |SI #309#31 = "X"; #612#17 = "4"; |FINSI;
     |SI #309#32 = "X"; #612#17 = "5"; |FINSI;
     |SI #309#33 = "X"; #612#17 = "6"; |FINSI;

     eaAlfa   = #309#34;   |HAZ QuitaRaros;                    #612#18 = eaAlfa;
     eaAlfa   = #309#35;   |HAZ QuitaRaros;                    #612#19 = eaAlfa;
     eaAlfa   = #309#36;   |HAZ QuitaRaros;                    #612#20 = eaAlfa;
     eaAlfa   = #309#37;   |HAZ QuitaRaros;                    #612#21 = eaAlfa;
     eaAlfa   = #309#38;   |HAZ QuitaRaros;                    #612#22 = eaAlfa;

     eaAlfa   = #309#39;   |HAZ QuitaRaros;                    #612#23 = eaAlfa;
     eaAlfa   = #309#40;   |HAZ QuitaRaros;                    #612#24 = eaAlfa;
     eaAlfa   = #309#41;   |HAZ QuitaRaros;                    #612#25 = eaAlfa;

     aAlfa = #309#42; |QBF aAlfa;
     |SI #309#138 = 0; |Y aAlfa ! ""; #309#138 = #309#42; |FINSI;
     nNume    = (#309#138 * 100) ! 0;   eaAlfa = ("00000" + nNume) % -105;  #612#26 = eaAlfa;

     eaAlfa   = #309#43;   |HAZ QuitaRaros;                    #612#27 = eaAlfa;
     eaAlfa   = #309#44;   |HAZ QuitaRaros;                    #612#28 = eaAlfa;
     eaAlfa   = #309#45;   |HAZ QuitaRaros;                    #612#29 = eaAlfa;
     |SI #309#46 ! 0;
         #612#30 = #309#46;
     |FINSI;

     nNume    = #309#47;   eaAlfa = ("000000000000" + nNume) % -110;  #612#31 = eaAlfa;

     enNume   = #309#48;  |HAZ Conver17;  #612#32 = eaAlfa;
     enNume   = #309#49 * 100;            #612#33 = ("00000" + enNume) % -105;
     enNume   = #309#50;  |HAZ Conver17;  #612#34 = eaAlfa;
     enNume   = #309#51;  |HAZ Conver17;  #612#35 = eaAlfa;
     enNume   = #309#52 * 100;            #612#36 = ("00000" + enNume) % -105;
     enNume   = #309#53;  |HAZ Conver17;  #612#37 = eaAlfa;
     enNume   = #309#54;  |HAZ Conver17;  #612#38 = eaAlfa;
     enNume   = #309#55 * 100;            #612#39 = ("00000" + enNume) % -105;
     enNume   = #309#56;  |HAZ Conver17;  #612#40 = eaAlfa;
     enNume   = #309#57;  |HAZ Conver17;  #612#41 = eaAlfa;
     enNume   = #309#58 * 100;            #612#42 = ("00000" + enNume) % -105;
     enNume   = #309#59;  |HAZ Conver17;  #612#43 = eaAlfa;
     enNume   = #309#60;  |HAZ Conver17;  #612#44 = eaAlfa;
     enNume   = #309#61 * 100;            #612#45 = ("00000" + enNume) % -105;
     enNume   = #309#62;  |HAZ Conver17;  #612#46 = eaAlfa;
     enNume   = #309#63;  |HAZ Conver17;  #612#47 = eaAlfa;
     enNume   = #309#64 * 100;            #612#48 = ("00000" + enNume) % -105;
     enNume   = #309#65;  |HAZ Conver17;  #612#49 = eaAlfa;
     enNume   = #309#66;  |HAZ Conver17;  #612#50 = eaAlfa;
     enNume   = #309#67 * 100;            #612#51 = ("00000" + enNume) % -105;
     enNume   = #309#68;  |HAZ Conver17;  #612#52 = eaAlfa;
     enNume   = #309#69;  |HAZ Conver17;  #612#53 = eaAlfa;
     enNume   = #309#70;  |HAZ Conver17;  #612#54 = eaAlfa;
     enNume   = #309#71;  |HAZ Conver17;  #612#55 = eaAlfa;

     |SI #309#4 > 0;
         #612#56 = "X";
         #612#57 = #309#72;
     |FINSI;

     enModelo = 309;  enForzar = 1;  |HAZ CogeDatosBancos;
     |SI eaOpcion = "1";
         #612#58 = eaIBAN;
     |FINSI;

     #612#63 = &13 + &10;

     aAlfa = "<T3090" + #612#10 + #612#11 + "0000>";  |XGRABA nHandle, aAlfa;
     aAlfa = "<AUX>";                                 |XGRABA nHandle, aAlfa;
     aAlfa = " " * 70;                                |XGRABA nHandle, aAlfa;
     aAlfa = " " * 4;                                 |XGRABA nHandle, aAlfa;
     aAlfa = " " * 4;                                 |XGRABA nHandle, aAlfa;
     aAlfa = " " * 9;                                 |XGRABA nHandle, aAlfa;
     aAlfa = " " * 213;                               |XGRABA nHandle, aAlfa;
     aAlfa = "</AUX>";                                |XGRABA nHandle, aAlfa;


     |PARA nCampo = 1;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #612nCampo;
           |XGRABA nHandle, aAlfa;
     |SIGUE;

     aAlfa = "</T3090" + #612#10 + #612#11 + "0000>";  |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Bloque2016;
     |HAZ PideFecha;

     |HAZ LeeUnidad;
     eaPathLanza = eaUnidadBasico + "\MODELOS";                      |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\309";                             |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + #309#2;                       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + (("00" + #309#3) % -102);     |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";                    |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision +  "/309";                        |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + #309#2;                   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + (("00" + #309#3) % -102); |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                             |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";                   |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet +  "/309";                       |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + #309#2;                  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + (("00" + #309#3) % -102);|RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     eaFicheroPlano = "309" + (("00000" + #309#0) % -105) + ".txt";
     eaFicheroImpre = "309" + (("00000" + #309#0) % -105) + ".pdf";
     eaFicheroError = "err" + (("00000" + #309#0) % -105) + ".txt";

     aAlfa = eaPathLanza + eaFicheroPlano;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroImpre;  |RFBORRA aAlfa;
     aAlfa = eaPathLanza + eaFicheroError;  |RFBORRA aAlfa;

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle;

     enCambiaMoneda = 1;
     |HAZ Carga309_2016;

     |XCIERRA nHandle;

     |SI eaOpcion = "1";
         |HAZ AbrePagina;
     |FINSI;

     |SI eaOpcion = "3";

         eaFOrigen  = eaPathEmision  + eaFicheroPlano;
         eaFDestino = eaPathInternet + eaFicheroPlano;
         |HAZ CopiaFichero;

         aAlfa =  "      Los ficheros generados estan en: " + eaPathInternet + " de su PC";
         |MENAV aAlfa;

         |CONFI "0000SQuiere cargar la pagina de hacienda del modelo";
         |SI FSalida = 0;
             |HAZ AbrePagina;
         |FINSI;
     |FINSI;

     eaCamp9_11 = "X";
     efCamp9_12 = fFechaEmi;
|FPRC;
