|FICHEROS;
     dsmoz062 #0;

     dsmom002 #2;
     dsmom004 #4;
     dsmom008 #8;
     :/basica/def/agitab99 #99;
     :/basica/def/agicen14 #114;
     :/basica/def/agifigen #118;

     dsmow109 #109;

     referen@ #999;
     refere1@ #998;
|FIN;

|VARIABLES;
     nCampo     = 0;
     nDEmpresa  = 0;
     nHEmpresa  = 0;
     nSwHay     = 0;
     nSwAlgun   = 0;
     nDModelo   = 0;
     nHModelo   = 0;
     swBo       = 0;
     &enSwLinea = 0;

     nError     = 0;
     aDirBase   = "";
     aMas       = "";
     aAlfa1     = "";
     aAlfa2     = "";
     nPara1     = 0;
     aFicher1   = "";
     aFicher2   = "";
     aFichero   = "";
     nSw        = 0;
     aCampo6    = "";
     nEmpresa   = 0;
     nEjer      = 0;
     nPeriodo   = 0;
     nModelo    = 0;
     nComplem   = 0;
     nActividad = 0;
     aEmpresa   = "";
     aActividad = "";
     aPeriodo   = "";
     aPeriodicidad = "";
     aError        = "";
     aError0       = "";
     aXm002        = "";
     aXm004        = "";
     aXm008        = "";
     aDAlfa1       = "";
     aDAlfa2       = "";
     aDAlfa3       = "";
     aDAlfa4       = "";
     aHAlfa1       = "";
     aHAlfa2       = "";
     aHAlfa3       = "";
     aHAlfa4       = "";
     nDNume1       = 0;
     nDNume2       = 0;
     nDNume3       = 0;
     nHNume1       = 0;
     nHNume2       = 0;
     nHNume3       = 0;
     fDFech1       = @;
     fHFech1       = @;
     fLaFecha      = @;
     nCompruebo    = 0;
|FIN;

|INCLUYE i_variar;

|| /////////////////////// PROCESOS ENTRADA POR PANTALLA \\\\\\\\\\\\\\\\\\\\
|PROCESO Tipo7;  |TIPO 7;
     |SI enEmpresa ! 0;
         #0#0 = enEmpresa;  |PINTA #0#0;
         #0#1 = enEmpresa;  |PINTA #0#1;

         |C_M #0#0, 1, "N";
         |C_M #0#1, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo7_16;  |TIPO 7;
    |SI enModelo ! 0;
         #0#16 = enModelo;  |PINTA #0#16;
         #0#17 = enModelo;  |PINTA #0#17;

         |C_M #0#16, 1, "N";
         |C_M #0#17, 1, "N";
    |FINSI;
|FPRC;

|PROCESO Parrilla;
     |SI #0#0 = 0;
         #0#0 = 0;  |PINTA #0#0;
         #0#1 = 0;  |PINTA #0#1;  |C_M #0#1, 1, "N";
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enEmpresa = 0;
             |C_M #0#0, 1, "S";
             |C_M #0#1, 1, "S";
         |FINSI;

         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Parrilla_16;
     |SI #0#16 = 0;
         #0#16 = 0;    |PINTA #0#16;
         #0#17 = 899;  |PINTA #0#17;  |C_M #0#17, 1, "N";
         |PARA nCampo = 18;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |SI enModelo = 0;
             |C_M #0#16, 1, "S";
             |C_M #0#17, 1, "S";
         |FINSI;

         |PARA nCampo = 18;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasModelos;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ConsuModelo;
     |ABRE #99;
     #99#0 = #0Campo;
     |LEE 040#99=;
     |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
     |CIERRA #99;

     |SI Campo = 16; |O Campo = 17;  |ACABA;  |FINSI;
     |SI #0Campo = 0; |ACABA; |FINSI;
     |SI #99#4 = "N";
         |MENAV "     Modelo sin Activar.";
         |ERROR;
         |ACABA;
     |FINSI;
     swBo = 0;
     nModelo = #0Campo;
     |SI nModelo = 110; |O nModelo = 115;  |O nModelo = 123; swBo = 1; |FINSI;
     |SI nModelo = 216; |O nModelo = 300;  |O nModelo = 303; swBo = 1; |FINSI;
     |SI nModelo = 320; |O nModelo = 330;  |O nModelo = 332; swBo = 1; |FINSI;
     |SI nModelo = 130; |O nModelo = 310;  |O nModelo = 131; swBo = 1; |FINSI;
     |SI nModelo = 370; |O nModelo = 349;  |O nModelo = 347; swBo = 1; |FINSI;
     |SI nModelo = 180; |O nModelo = 184;  |O nModelo = 190; swBo = 1; |FINSI;
     |SI nModelo = 193; |O nModelo = 296;  |O nModelo = 390; swBo = 1; |FINSI;
     |SI nModelo = 392; |O nModelo = 187;                    swBo = 1; |FINSI;
     |SI swBo = 0;
         |MENAV "     Modelo no Valido para este Chequeo";
         |ERROR;
     |FINSI;
|FPRC;

|CALCULO Eano; |TIPO 7;
 fLaFecha = ~;
 aAlfa1 = fLaFecha; aAlfa1 = aAlfa1 % -104;
 #0#14 = aAlfa1;
 |PINTA #0#14;
|FCAL;

|| ///////////////////////////////////////////////////////////////////
|| /////////////////////// PROCESOS DE INFORMES \\\\\\\\\\\\\\\\\\\\\
|PROCESO SelModelo;
 |ABRE #99;
 #99#0 = nModelo;
 |LEE 040#99=;
 |SI FSalida ! 0;  |DDEFECTO #99;  |FINSI;
 |CIERRA #99;
 swBo = 0;
 |SI #0#16 = 0;
     |PARA nPara1 = 18; |SI nPara1 [ 29; |HACIENDO nPara1 = nPara1 + 1;
           |SI #0nPara1 = nModelo;
               swBo = 1; |SAL;
           |FINSI;
     |SIGUE;
 |SINO;
     |SI nModelo ] #0#16; |Y nModelo [ #0#17;
         swBo = 1;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO CargarFicheros;
 nError = 0;

 |DBASE aDirBase;

 aMas = aDirBase + "def/" + aFicher1;
 |CARGA_DEF aMas, referen@;
 |SI FSalida ! 0;
     aAlfa1 = "    Error cargando fichero " + aFicher1;
     |MENAV aAlfa1;
     nError = 1;
     |ACABA;
 |FINSI;
 |SI aFicher2 ! "";
     aMas = aDirBase + "def/" + aFicher2;
     |CARGA_DEF aMas, refere1@;
     |SI FSalida ! 0;
         aAlfa1 = "    Error cargando fichero " + aFicher2;
         |MENAV aAlfa1;
         nError = 1;
         |DESCARGA_DEF #referen@;
     |FINSI;
 |FINSI;

|FPRC;

|PROCESO DesCargarFicheros;
 |SI aFicher2 ! ""; |DESCARGA_DEF #refere1@; |FINSI;
 |DESCARGA_DEF #referen@;
|FPRC;

|PROCESO GrabaW109;
 #109#0 = nEmpresa;
 #109#1 = nEjer;
 #109#2 = nPeriodo;
 #109#3 = nModelo;
 #109#4 = nComplem;
 #109#5 = nActividad;
 |LEE 101#109=;
 |SI FSalida ! 0;
     #109#0 = nEmpresa;
     #109#1 = nEjer;
     #109#2 = nPeriodo;
     #109#3 = nModelo;
     #109#4 = nComplem;
     #109#5 = nActividad;
     #109#6 = aEmpresa;
     #109#7 = aActividad;
     #109#8 = aPeriodo;
     #109#9 = aPeriodicidad;
     |GRABA 020#109b;
 |FINSI;
 #109#10 = aError;
 #109#11 = aXm002;
 #109#12 = aXm004;
 #109#13 = aXm008;
 #109#14 = aError0;
 |GRABA 020#109a;
 |LIBERA #109;
|FPRC;

|PROCESO LeoActividad;
      |SI nActividad ! 0; |Y nActividad ! 99;
          |DDEFECTO #114;
          #114#0 = nEmpresa;
          #114#1 = nActividad;
          |LEE 001#114=;
          aActividad = #114#4;
      |SINO;
          |SI nActividad = 0;  aActividad = "Registro de Impresion";      |FINSI;
          |SI nActividad = 1;  aActividad = "Registro de Trabajo"  ;      |FINSI;
          |SI nActividad = 99; aActividad = "Registro de Regularizacion"; |FINSI;
      |FINSI;
|FPRC;

|PROCESO LeoEmpresa;
      |DDEFECTO #118;
      #118#0 = nEmpresa;
      |LEE 001#118=;
      aEmpresa = #118#1;
|FPRC;

|PROCESO LeoPeriodo;
     aPeriodo  = "          ";
     |SI nPeriodo = 1;   aPeriodo = "ENERO     ";  |FINSI;
     |SI nPeriodo = 2;   aPeriodo = "FEBRERO   ";  |FINSI;
     |SI nPeriodo = 3;   aPeriodo = "MARZO     ";  |FINSI;
     |SI nPeriodo = 4;   aPeriodo = "ABRIL     ";  |FINSI;
     |SI nPeriodo = 5;   aPeriodo = "MAYO      ";  |FINSI;
     |SI nPeriodo = 6;   aPeriodo = "JUNIO     ";  |FINSI;
     |SI nPeriodo = 7;   aPeriodo = "JULIO     ";  |FINSI;
     |SI nPeriodo = 8;   aPeriodo = "AGOSTO    ";  |FINSI;
     |SI nPeriodo = 9;   aPeriodo = "SEPTIEMBRE";  |FINSI;
     |SI nPeriodo = 10;  aPeriodo = "OCTUBRE   ";  |FINSI;
     |SI nPeriodo = 11;  aPeriodo = "NOVIEMBRE ";  |FINSI;
     |SI nPeriodo = 12;  aPeriodo = "DICIEMBRE ";  |FINSI;
     |SI nPeriodo = 99;  aPeriodo = "ANUAL     ";  |FINSI;
|FPRC;

|PROCESO LeeModelo;
  aError  = "";
  aError0 = "Datos en el Modelo de Trabajo";
  aXm002  = "";
  aXm004  = "";
  aXm008  = "";
  aCampo6 = #99#6;
  nCompruebo = 0;

  |SI nModelo = 184; |O nModelo = 390; |O nModelo = 392;
     nPeriodo   = 99;
     nActividad = 0;
     |SI nSw = 0; |O nEmpresa ! #999#0; |O nComplem ! #999#3;
         nCompruebo = 1;
     |FINSI;
  |SINO;
     |SI nSw = 0; |O nEmpresa ! #999#0; |O nPeriodo ! #999#2;
       |O nComplem ! #999#4; |O nActividad ! #999#5;
          nCompruebo = 1;
     |FINSI;
  |FINSI;

  |SI nCompruebo = 1;

      |SI nSw = 0; |O nEmpresa ! #999#0;
          nEmpresa   = #999#0; |HAZ LeoEmpresa;
          |SI nModelo ! 184; |Y nModelo ! 390; |Y nModelo ! 392;
              nActividad = #999#5; |HAZ LeoActividad;
          |FINSI;
      |FINSI;

      |SI nModelo ! 184; |Y nModelo ! 390; |Y nModelo ! 392;
          |SI nSw = 0; |O nPeriodo ! #999#2;
              nPeriodo = #999#2; |HAZ LeoPeriodo;
          |FINSI;

         |SI nActividad ! #999#5;
             nActividad = #999#5; |HAZ LeoActividad;
         |FINSI;
         nComplem = #999#4;
      |SINO;
         nComplem = #999#3;
      |FINSI;
      nSw      = 1;

      |SI aFicher2 ! "";
          #998#0 = #999#0;
          #998#1 = #999#1;
          #998#2 = #999#2;
          #998#3 = #999#3;
          #998#4 = #999#4;
          #998#5 = 0;
          |LEE 001#998=;
          |SI FSalida = 0;
              aError0 = "Datos en el Modelo de Trabajo y Modelo de Emision";
          |FINSI;
      |SINO;
          aError0 = "Datos en el Modelo ";
      |FINSI;

      |SI nActividad ! 0; |Y nActividad ! 99;
          |DDEFECTO #2;
          |SELECT #2#2;
          #2#0 = nEmpresa;   || Empresa
          #2#1 = nActividad; || Actividad
          #2#2 = nModelo;    || Modelo
          |SI nModelo = 110;  |O nModelo = 115;  |O nModelo = 123;  |O nModelo = 216;
              #2#1 = 1;
              |LEE 001#2];
          |SINO;
              |LEE 001#2=;
          |FINSI;
          |SI FSalida ! 0; |O #2#0 ! nEmpresa; |O #2#2 ! nModelo;
              aXm002 = "X";
          |FINSI;
          aPeriodicidad = #2#7;
          |SELECT #1#2;
      |SINO;
          |SI nPeriodo = 99; |Y nActividad = 0;
              |DDEFECTO #2;
              |SELECT #2#2;
              #2#0 = nEmpresa;   || Empresa
              #2#1 = 0;          || Actividad
              #2#2 = nModelo;    || Modelo
              |LEE 001#2];
              |SI FSalida ! 0; |O #2#0 ! nEmpresa; |O #2#2 ! nModelo;
                  aXm002 = "X";
              |FINSI;
              aPeriodicidad = #2#7;
              |SELECT #1#2;
          |FINSI;
      |FINSI;

      |DDEFECTO #4;
      #4#0 = nEmpresa;
      #4#1 = nEjer;
      #4#2 = nPeriodo;
      #4#3 = nModelo;
      #4#4 = nComplem;
      |LEE 001#4=;
      |SI FSalida ! 0;
          aXm004 = "X";
      |SINO;
          |SI #4#5 ! "ACTIVIDAD "; |Y #4#5 ! "ACT.+ REG."; aCampo6 = ""; |FINSI;
      |FINSI;

      |SI aCampo6 = "A"; |O aCampo6 = "C"; |O aCampo6 = "F";
          |DDEFECTO #8;
          #8#0 = nEmpresa;
          #8#1 = nEjer;
          #8#2 = nPeriodo;
          #8#3 = nModelo;
          #8#4 = nComplem;
          #8#5 = nActividad;
          |LEE 001#8=;
          |SI FSalida ! 0;
              aXm008 = "X";
          |FINSI;
      |FINSI;

      |SI aXm002 ! ""; |O aXm004 ! ""; |O aXm008 ! "";
          |SI aXm002 = "X";
              aError = "NO ESTA DEFINIDO EL MODELO EN LA ACTIVIDAD";
          |SINO;
              |SI aXm004 = "X";
                  aError = "NO ESTA EN EL PLANING DE LA EMPRESA";
              |SINO;
                  |SI aXm008 = "X";
                      aError = "NO ESTA EN EL PLANING DE LA ACTIVIDAD";
                  |FINSI;
              |FINSI;
          |FINSI;
          |HAZ GrabaW109;
          nSwHay = 1;
      |FINSI;
   |FINSI;
   nSwAlgun = 1;
|FPRC;

|DEFBUCLE LeeModelo_X;
 #999#1006;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00;
 nHEmpresa, nEjer, 99, nModelo, 99, 99;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_X4;
 #999#1004;
 ;
 nDEmpresa, nEjer, nModelo, 00;
 nHEmpresa, nEjer, nModelo, 99;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_AFNANN;
 #999#1012;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, aDAlfa1, fDFech1, nDNume1, aDAlfa2, nDNume2, nDNume3;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, aHAlfa1, fHFech1, nHNume1, aHAlfa2, nHNume2, nHNume3;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_ANANN;
 #999#1011;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, aDAlfa1, nDNume1, aDAlfa2, nDNume2, nDNume3;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, aHAlfa1, nHNume1, aHAlfa2, nHNume2, nHNume3;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_AANN;
 #999#1010;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, aDAlfa1, aDAlfa2, nDNume1, nDNume2;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, aHAlfa1, aHAlfa2, nHNume1, nHNume2;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_AN;
 #999#1008;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, aDAlfa1, nDNume1;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, aHAlfa1, nHNume1;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_ANAA;
 #999#1010;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, aDAlfa1, nDNume1, aDAlfa2, aDAlfa3;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, aHAlfa1, nHNume1, aHAlfa2, aHAlfa3;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_ANNAAN;
 #999#1012;
 ;
 nDEmpresa,nEjer,01,nModelo,00,00,aDAlfa1,nDNume1,nDNume2,aDAlfa2,aDAlfa3,nDNume3;
 nHEmpresa,nEjer,99,nModelo,99,99,aHAlfa1,nHNume1,nHNume2,aHAlfa2,aHAlfa3,nHNume3;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_NN;
 #999#1008;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, nDNume1, nDNume2;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, nHNume1, nHNume2;
 e;
 NULL, LeeModelo;
|FIN;

|DEFBUCLE LeeModelo_ANN;
 #999#1009;
 ;
 nDEmpresa, nEjer, 01, nModelo, 00, 00, aDAlfa1, nDNume1,nDNume2;
 nHEmpresa, nEjer, 99, nModelo, 99, 99, aHAlfa1, nHNume1,nDNume2;
 e;
 NULL, LeeModelo;
|FIN;

|| ///////////////////////////////////////////////////////////////////////
|PROCESO dsmod110;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

                    aFicher2 = "dsmod110";
 |SI #0#14 [ 2010;  aFicher1 = "dsmoc110";  |FINSI;
 |SI #0#14 = 2011;  aFicher1 = "dsmoc111";  |FINSI;
 |SI #0#14 = 2012;  aFicher1 = "dsmoc111";  |FINSI;
 |SI #0#14 = 2013;  aFicher1 = "dsmoc111";  |FINSI;
 |SI #0#14 = 2014;  aFicher1 = "dsmoc111";  |FINSI;
 |SI #0#14 = 2015;  aFicher1 = "dsmoc111";  |FINSI;
 |SI #0#14 ] 2016;  aFicher1 = "dsm11101";  |FINSI;
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 aDAlfa1 = "            "; aHAlfa1 = "zzzzzzzzzzzz";
 aDAlfa2 = " ";            aHAlfa2 = "z";
 aDAlfa3 = "  ";           aHAlfa3 = "zz";
 nDNume1 = 0000;           nHNume1 = 9999;
 nDNume2 = 00;             nHNume2 = 99;
 nDNume3 = 0;              nHNume3 = 9;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |SI #0#14 [ 2010;  |BUCLE LeeModelo_ANAA;    |FINSI;
     |SI #0#14 ] 2011;  |BUCLE LeeModelo_ANNAAN;  |FINSI;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |SI #0#14 [ 2010;  |BUCLE LeeModelo_ANAA;    |FINSI;
           |SI #0#14 ] 2011;  |BUCLE LeeModelo_ANNAAN;  |FINSI;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmod115;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher1 = "dsmoc115";
 aFicher2 = "dsmod115";
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 aDAlfa1 = "            "; aHAlfa1 = "zzzzzzzzzzzz";
 nDNume1 = 0000;           nHNume1 = 9999;
 nDNume2 = 01;             nHNume2 = 99;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_ANN;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_ANN;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmod123;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher1 = "dsmoc123";
 aFicher2 = "dsmod123";
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 aDAlfa1 = "            "; aHAlfa1 = "zzzzzzzzzzzz";
 nDNume1 = 0000;           nHNume1 = 9999;
 aDAlfa2 = " ";            aHAlfa2 = "z";
 nDNume2 = 00;             nHNume2 = 12;
 nDNume3 = 1;              nHNume3 = 2;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_ANANN;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_ANANN;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmod216;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher1 = "dsmoc216";
 aFicher2 = "dsmod216";
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 aDAlfa1 = "            "; aHAlfa1 = "zzzzzzzzzzzz";
 fDFech1 = "01.01.0000";   fHFech1 = "31.12.2999";
 nDNume1 = 1;              nHNume1 = 2;
 aDAlfa2 = " ";            aHAlfa2 = "z";
 nDNume2 = 00;             nHNume2 = 12;
 nDNume3 = 1;              nHNume3 = 2;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_AFNANN;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_AFNANN;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmod349;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher1 = "dsmoc349";
 aFicher2 = "dsmod349";
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 aDAlfa1 = "  ";           aHAlfa1 = "zz";
 aDAlfa2 = "            "; aHAlfa2 = "zzzzzzzzzzzz";
 nDNume1 = 0000;           nHNume1 = 9999;
 nDNume2 = 0;              nHNume2 = 4;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_AANN;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_AANN;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmodXXX;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 |SI nModelo = 130;
     aFicher1 = "dsmoc130";
     aFicher2 = "dsmod130";
 |FINSI;
 |SI nModelo = 131;
     aFicher1 = "dsmoc131";
     aFicher2 = "dsmod131";
 |FINSI;
 |SI nModelo = 310;
     aFicher1 = "dsmoc310";
     aFicher2 = "dsmod310";
 |FINSI;
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_X;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_X;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsm1XXca;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher2 = "";
 |SI nModelo = 180;  aFicher1 = "dsm180ca"; |FINSI;
 |SI nModelo = 187;  aFicher1 = "dsm187ca"; |FINSI;
 |SI nModelo = 190;  aFicher1 = "dsm190ca"; |FINSI;
 |SI nModelo = 193;  aFicher1 = "dsm193ca"; |FINSI;
 |SI nModelo = 296;  aFicher1 = "dsm296ca"; |FINSI;
 |SI nModelo = 370;  aFicher1 = "dsmod370"; |FINSI;
 |SI nModelo = 347;  aFicher1 = "dsmo1347"; |FINSI;

 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_X;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_X;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmXXX01;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher2 = "";
 |SI nModelo = 184;  aFicher1 = "dsm18401"; |FINSI;
 |SI nModelo = 390;  aFicher1 = "dsm39001"; |FINSI;
 |SI nModelo = 392;  aFicher1 = "dsm39201"; |FINSI;
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_X4;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_X4;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsmod3XX;
 |HAZ SelModelo;
 |SI swBo = 0; |ACABA; |FINSI;

 aFicher1 = "dsmociva";
 |SI nModelo = 300; aFicher2 = "dsmod300"; |FINSI;
 |SI nModelo = 303; aFicher2 = "dsmod303"; |FINSI;
 |SI nModelo = 320; aFicher2 = "dsmod320"; |FINSI;
 |SI nModelo = 330; aFicher2 = "dsmod330"; |FINSI;
 |SI nModelo = 332; aFicher2 = "dsmod332"; |FINSI;
 |HAZ CargarFicheros;
 |SI nError = 1; |ACABA; |FINSI;

 nDNume1 = 1;  nHNume1 = 1;
 nDNume2 = 00; nHNume2 = 99;
 |ABRE #2;
 |ABRE #4;
 |ABRE #8;
 |ABRE #998;
 |ABRE #118;
 |ABRE #114;
 nSw = 0;
 |SI #0#0 ! 0;
     nDEmpresa = #0#0;
     nHEmpresa = #0#1;
     |BUCLE LeeModelo_NN;
 |SINO;
     |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nDEmpresa = #0nCampo;
           nHEmpresa = #0nCampo;
           |BUCLE LeeModelo_NN;
     |SIGUE;
 |FINSI;
 |CIERRA #114;
 |CIERRA #118;
 |CIERRA #998;
 |CIERRA #8;
 |CIERRA #4;
 |CIERRA #2;
 |HAZ DesCargarFicheros;
|FPRC;

|PROCESO dsm30301;
     |HAZ SelModelo;
     |SI swBo = 0; |ACABA; |FINSI;

     aFicher1 = "dsmociva";
     aFicher2 = "dsm30301";

     |HAZ CargarFicheros;
     |SI nError = 1; |ACABA; |FINSI;

     nDNume1 = 1;  nHNume1 = 1;
     nDNume2 = 00; nHNume2 = 99;

     |ABRE #2;
     |ABRE #4;
     |ABRE #8;
     |ABRE #998;
     |ABRE #118;
     |ABRE #114;

     nSw = 0;
     |SI #0#0 ! 0;
         nDEmpresa = #0#0;
         nHEmpresa = #0#1;
         |BUCLE LeeModelo_NN;
     |SINO;
         |PARA nCampo = 2;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
               nDEmpresa = #0nCampo;
               nHEmpresa = #0nCampo;
               |BUCLE LeeModelo_NN;
         |SIGUE;
     |FINSI;
     |CIERRA #114;
     |CIERRA #118;
     |CIERRA #998;
     |CIERRA #8;
     |CIERRA #4;
     |CIERRA #2;

     |HAZ DesCargarFicheros;
|FPRC;

|| \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
|PROCESO dsmow109;
 |SI nSw = 1;
     enSwLinea = 0;
     nEmpresa = #109#0;
 |FINSI;
 |SI nEmpresa ! #109#0;
     enSwLinea = 2;
     |PRINT;
     nEmpresa = #109#0;
     enSwLinea = 0;
 |FINSI;
 |PRINT;
 enSwLinea = 1;
|FPRC;

|DEFBUCLE dsmow109;
  #109#1;
  ;
  00001, nEjer, 000, 00, 00, 00;
  99999, nEjer, 999, 99, 99, 99;
  ;
  NULL, dsmow109;
|FIN;

|PROCESO Imprimir;
 |IMPRE 0;
 |SI FSalida ! 0; |ACABA; |FINSI;

 |INFOR "dsmoz062";
 |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

 nSw = 0;
 |BUCLE dsmow109;
 |PIEINF;
 |FININF;
 |FINIMP;
|FPRC;

|| \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
|PROCESO ITipo3;  |TIPO 3;
     aFichero = "2z" + Usuario;
     |NOME_DAT #109 aFichero;
     |ABRE #109;  |CIERRA #109;  |DELINDEX #109;

     nEjer    = #0#14;
     nDModelo = 001;
     nHModelo = 999;
     |SI #0#16 ! 0; nDModelo = #0#16; nHModelo = #0#17; |FINSI;

     nSwAlgun = 0;
     nSwHay   = 0;

     |ABRE #109;
     nModelo = 110;  |HAZ dsmod110;
     nModelo = 115;  |HAZ dsmod115;
     nModelo = 123;  |HAZ dsmod123;
     nModelo = 216;  |HAZ dsmod216;

     nModelo = 130;  |HAZ dsmodXXX;
     nModelo = 131;  |HAZ dsmodXXX;

     nModelo = 180;  |HAZ dsm1XXca;
     nModelo = 184;  |HAZ dsmXXX01;
     nModelo = 187;  |HAZ dsm1XXca;
     nModelo = 190;  |HAZ dsm1XXca;
     nModelo = 193;  |HAZ dsm1XXca;
     nModelo = 296;  |HAZ dsm1XXca;

     |SI nEjer [ 2008;
         nModelo = 300;  |HAZ dsmod3XX;
         nModelo = 320;  |HAZ dsmod3XX;
         nModelo = 330;  |HAZ dsmod3XX;
         nModelo = 332;  |HAZ dsmod3XX;
         nModelo = 310;  |HAZ dsmodXXX;
         nModelo = 370;  |HAZ dsm1XXca;
         nModelo = 392;  |HAZ dsmXXX01;
         nModelo = 390;  |HAZ dsmXXX01;
     |FINSI;

     |SI nEjer ] 2009;  |Y nEjer [ 2013;
         nModelo = 303;  |HAZ dsmod3XX;
         nModelo = 310;  |HAZ dsmodXXX;
         nModelo = 370;  |HAZ dsm1XXca;
         nModelo = 390;  |HAZ dsmXXX01;
     |FINSI;

     |SI nEjer ] 2014;
         nModelo = 303;  |HAZ dsm30301;
         nModelo = 390;  |HAZ dsmXXX01;
     |FINSI;

     nModelo = 347;  |HAZ dsm1XXca;
     nModelo = 349;  |HAZ dsmod349;

     |CIERRA #109;

     |SI nSwHay = 1;
         |HAZ Imprimir;
     |SINO;
         |SI nSwAlgun = 0;
             |MENAV "    Seleccion Vacia";
         |SINO;
             |MENAV "    No encontrado ningun Error en la Seleccion";
         |FINSI;
     |FINSI;
     |DELINDEX #109;
|FPRC;
