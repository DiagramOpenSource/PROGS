|FICHEROS;
     dsmoy000;
     dsmom001;
     dsmom004;

     dsm18401;
     dsm18403;
     dsm18404;
     dsm18405;
     dsm18406;
     dsm18407;
     dsm18408;
     dsm18409;
     dsm18414;
     dsm18415;
     dsm18430;
     dsm18431;

     :/basica/def/agim0024;
     :/basica/def/agim0026;

     dsmow014;
     dsmow016;
     dsmow504;
     dsmow565;
     dsmow568;

     &clientes@;
|FIN;

|VARIABLES;
     &enTotSoc = 0;
     &enNumDec = 0;
     &eaFecha  = "";
     &eaJustPr = "";
     &eaJustAn = "";
     &eaPorcen = "";

     nImpI1 = 0; nImpJ1 = 0;
     nImpI2 = 0; nImpJ2 = 0;
     nImpI3 = 0; nImpJ3 = 0;
     nImpI4 = 0; nImpJ4 = 0;
     nImpI5 = 0; nImpJ5 = 0;
     nImpI6 = 0; nImpJ6 = 0;

     nSw        = 0;
     nCont      = 0;
     nCalc      = 0;
     nHandle    = 0;
     nCont1     = 0;
     nSwError   = 0;
     nRegistros = 0;
     nPortada   = 0;
     nSwClaveD = 0;

     nSwClaveGrabada = 0;

     nNumDecl    = 0;
     nNumTotSocs = 0;
     nNumSocs    = 0;
     nNumSocsDec = 0;
     nDEmpresa   = 0;
     nHEmpresa   = 0;

     Cadena    = "";
     aAntPais  = "";
     aRed      = "";
     aDPais    = "";
     aHPais    = "";
     aPais     = "";
     aCadena1  = "";
     aClave    = "";
     aSubClave = "";
     aDerecho  = "";
     aJusti    = "";

     aTRegimen = ""; aTActivid = ""; nEpigrafe = 0;
     aNifCes   = ""; aNomCes   = ""; nAnyoAdq  = 0;
     nMesAdq   = 0;  nDiaAdq   = 0;        nValLiq   = 0;
     nValAdq   = 0;  nImpIngr  = 0;        nImpGast  = 0;
     nImpRtas  = 0;  nPorcRed  = 0;        nImpRtaR  = 0;
     nGanPer   = 0;  nBaseDed  = 0;        nRetIng   = 0;
     nNumeA    = 0;
     nNumeB    = 0;
     nNumeC    = 0;
     nNumeD    = 0;

     TipoDato  = "";
     Vacio1    = ""; Vacio2   = "";
     Long      = 0;  LongDec  = 0;
     nNegativo = 0;
     Calc1     = 0;  Calc2  = 0;
     nPer      = 0;  nGan   = 0;
     nSwDatos  = 0;  nSigno = 0;

     aSubClv   = "";
     nImporte  = 0;

     &sw03 = 0;
     &sw04 = 0;
     &sw05 = 0;
     &sw06 = 0;
     &sw07 = 0;
     &sw08 = 0;
     &sw09 = 0;
     &sw10 = 0;
     &sw14 = 0;
     &sw30 = 0;
     &swB = 0;
     &swC = 0;
     &swCont = 0;
     nNumLin = 0;
     nNumBlan = 0;
     nTotLin = 0;
     nElval = 0;
     nElsw = 0;

     nDatosClvD = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO Formateo1;
        |QBF aAlfa;
        |SI TipoDato = "F";
           aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
           |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
           |ACABA;
        |FINSI;
        |SI TipoDato = "N";
           Vacio1 = "0" * Long;
           Vacio2 = "0" * LongDec;
           aAlfa = aAlfa - "N";
           |SI FSalida ! 0;
              nNegativo = 1;
           |SINO;
              nNegativo = 0;
           |FINSI;
        |SINO;
           Vacio1 = " " * Long;
        |FINSI;

        |SI TipoDato ! "N";
           Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
        |SINO;
           |SI LongDec = 0;
              Calc1 = 0 - (100 + Long);
              aAlfa = (Vacio1 + aAlfa) % Calc1;
           |SINO;
              aAlfa = aAlfa - ".";
              |SI FSalida = 0;
                 Calc1 = 0 - (100 + Long);
                 aAlfa = (Vacio1 + aAlfa) % Calc1;
                 aAlfa1 = "0" * LongDec;
              |SINO;
                 Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
                 Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
                 aAlfa1 = aAlfa % Calc2;
                 aAlfa = aAlfa % Calc1;
                 Calc1 = 0 - (100 + Long);
                 aAlfa = (Vacio1 + aAlfa)  % Calc1;
                 Calc1 = 100 + LongDec;
                 aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
              |FINSI;
              aAlfa = aAlfa + aAlfa1;
           |FINSI;
           |SI nNegativo = 1;
              Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
              aAlfa = aAlfa % Calc1;
              aAlfa = "N" + aAlfa;
           |FINSI;
        |FINSI;

        aAlfa2 = "";

        |SI TipoDato = "A"; |O TipoDato = "An";
           aLong = aAlfa % 0; nLong = aLong;
           |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
              Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
              aAlfa1 = aAlfa1 > aAlfa1;
              |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
              |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
              |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
              |SI TipoDato = "An";
                 |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
                 |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
              |FINSI;
              aAlfa1 = " ";
     |ET Sigue1;
              aAlfa2 = aAlfa2 + aAlfa1;
           |SIGUE;
           aAlfa = aAlfa2;
        |FINSI;
        Calc1 = aAlfa;
        |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO Portada184;
     |SI nTecla = 3;  |O nTecla = 4;
         |SI nRegistros = 0;
             aJusti   = #dsmow016#19;
             enNumDec = nNumDecl;
             enTotSoc = nNumTotSocs;
             |INFOR "dsm184pr";
             |SI FSalida ! 0;  |ACABA; |FINSI;

             |MENAV "0000 Coloque Portada 184 y Pulse una Tecla.";

             |PRINT;
             |PIEINF;
             |FININF;
         |FINSI;
     |FINSI;

     |DDEFECTO #dsmow016;

     enCodCli = #dsmow014#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         #dsmow016#20 = #clientes@#17;
         #dsmow016#21 = #clientes@#18;
         #dsmow016#11 = #clientes@#15;
         #dsmow016#12 = #clientes@#16;
     |SINO;
         #dsmow016#20 = #clientes@#91;
         #dsmow016#21 = #clientes@#92;
         #dsmow016#11 = #clientes@#63;
         #dsmow016#12 = #clientes@#64;
     |FINSI;

     |SI nTecla = 1;  |O nTecla = 2;
         #dsmow016#26 = "X";
     |SINO;
         #dsmow016#27 = "X";
         #dsmow016#19 = aJusti;
     |FINSI;

     #dsmow016#39 = #dsm18401#26;
     #dsmow016#40 = "REPRESENTANTE";

     |INFOR "dsm184dc";
     |SI FSalida ! 0;  |ACABA; |FINSI;

     |MENAV "0000 Coloque Portada 184 y Pulse una Tecla.";

     |PRINT;
     |PIEINF;
     |FININF;
|FPRC;

|PROCESO MiraClaveD;
     |SI #dsm18406#7 ! 0; |O #dsm18406#8 ! 0; |O #dsm18406#10 ! 0; |O #dsm18406#11 ! 0;
         nSwClaveD = 1; |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE MiraClaveD;
     #dsm18406#1;
     ;
     #dsm18430#0, #dsm18430#1, #dsm18430#33, 001;
     #dsm18430#0, #dsm18430#1, #dsm18430#33, 999;
     ;
     NULL,MiraClaveD;
|FIN;

|PROCESO CuentaSocios;
     nCalc = nNumSocs; nSwClaveD = 0;
     |BUCLE MiraClaveD;

     |SI #dsm18430#12 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#14 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#16 ! 0; |O nSwClaveD = 1; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#18 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#19 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#20 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#21 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#22 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#25 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#26 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#27 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#28 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#29 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#30 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#31 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#43 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#45 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#46 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#47 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#48 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#49 ! 0; nNumSocs = nNumSocs + 1; |FINSI;
     |SI #dsm18430#50 ! 0; nNumSocs = nNumSocs + 1; |FINSI;

     |SI nCalc = nNumSocs;
        nNumSocsDec = nNumSocsDec + 1;
     |SINO;
        nNumSocsDec = nNumSocsDec + (nNumSocs - nCalc);
     |FINSI;
|FPRC;

|DEFBUCLE CuentaSocios;
     #dsm18430#2;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, "               ";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, "zzzzzzzzzzzzzzz";
     ;
     NULL, CuentaSocios;
|FIN;

|PROCESO GrabaDomicilio;
   |SI #dsmoy000#6 ] 2006;
      aAlfa = #dsm18430#36; |QBF aAlfa; aAlfa = aAlfa + " ";
      aAlfa1 = #dsm18430#5; aAlfa1 = aAlfa1 % 114;
      aAlfa = aAlfa + aAlfa1;  |QBF aAlfa; aAlfa = aAlfa + ",";
      aAlfa = aAlfa + #dsm18430#37; |QBF aAlfa;
      |SI #dsm18430#37 ! "   "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa = aAlfa + #dsm18430#38; |QBF aAlfa;
      |SI #dsm18430#38 ! " "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa = aAlfa + #dsm18430#39; |QBF aAlfa;
      |SI #dsm18430#39 ! "  "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa = aAlfa + #dsm18430#40; |QBF aAlfa;
      |SI #dsm18430#40 ! "  "; aAlfa = aAlfa + ","; |FINSI;
      aAlfa1 = (("00" + #dsm18430#6) % -102) + (("000" + #dsm18430#41) % -103);
      aAlfa = aAlfa + "C.P." + aAlfa1 + ",";
      aAlfa1 = #dsm18430#42; aAlfa1 = aAlfa1 % 110;
      aAlfa = aAlfa + aAlfa1;  |QBF aAlfa;
      TipoDato = "A"; LongDec = 0;
      Long = 40; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
   |SINO;
      TipoDato = "A"; LongDec = 0;
      Long = 2;  aAlfa = #dsm18430#36;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      Long = 14; aAlfa = #dsm18430#5;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      TipoDato = "N"; LongDec = 0;
      Long = 4;  aAlfa = #dsm18430#37;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      TipoDato = "A"; LongDec = 0;
      Long = 1;  aAlfa = #dsm18430#38;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      Long = 2;  aAlfa = #dsm18430#39;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      Long = 2;  aAlfa = #dsm18430#40;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
      aAlfa = (("00" + #dsm18430#6) % -102) + (("000" + #dsm18430#41) % -103);
      aCadena1 = aCadena1 + aAlfa;
      Long = 10; aAlfa = #dsm18430#42;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
   |FINSI;
|FPRC;

|PROCESO PasaClaveK;
     aCadena1 = aCadena + aSubClv;
     TipoDato = "N"; LongDec = 2;
     |SI nImporte < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - nImporte; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " "; aAlfa = nImporte;
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI nImporte ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO RegistroSoc;
     nSwClaveGrabada = 0;
     aCadena = "2184";
     aCadena = aCadena + #dsm18401#1;
     aCadena = aCadena + #dsmow565#4;

     TipoDato = "A"; LongDec = 0;
     Long = 9;  aAlfa = #dsm18430#2; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 9;  aAlfa = #dsm18430#3; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     TipoDato = "An";
     Long = 40; aAlfa = #dsm18430#4; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     aCadena = aCadena + "S";
     TipoDato = "N"; LongDec = 0;
     Long = 2; aAlfa = #dsm18430#6;  |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "A"; LongDec = 0;
     aPais = #dsm18430#7; |SI aPais = "ES"; aPais = "  "; |FINSI;
     Long = 2;  aAlfa = aPais;       |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "N"; LongDec = 0;
     Long = 1;  aAlfa = #dsm18430#8; |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "A"; LongDec = 0;
     Long = 1; aAlfa = #dsm18430#9;   |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "N"; LongDec = 0;
     Long = 3;  aAlfa = #dsm18430#10; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     LongDec = 4;
     Long = 3;  aAlfa = #dsm18430#11; |HAZ Formateo1; aCadena = aCadena + aAlfa;

     |SI #dsmoy000#6 > 2006;
        aCadena1 = aCadena + "A01";
        TipoDato = "N"; LongDec = 2;
        |SI #dsm18430#12 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#12; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#12;
        |FINSI;
        Long = 10; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |SI #dsm18430#13 < 0;
           aCadena1 = aCadena1 + "0";
           nCalc = 0 - #dsm18430#13; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + "0"; aAlfa = #dsm18430#13;
        |FINSI;
        Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |HAZ GrabaDomicilio;

        |SI #dsm18430#12 ! 0; |O #dsm18430#13 ! 0;
           nSwClaveGrabada = 1;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

           |SI #dsmoy000#6 ] 2008;
               aCadena1 = " " * 250;
               |XGRABA nHandle, aCadena1;
           |FINSI;

           aCadena1 = (" " * 91);
           |XGRABA nHandle, aCadena1;

           |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
               aCadena1 = &13 + &10;
               |XGRABA nHandle, aCadena1;
           |FINSI;
        |FINSI;

        aCadena1 = aCadena + "A02";
        TipoDato = "N"; LongDec = 2;
        |SI #dsm18430#43 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#43; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#43;
        |FINSI;
        Long = 10; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |SI #dsm18430#44 < 0;
           aCadena1 = aCadena1 + "0";
           nCalc = 0 - #dsm18430#44; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + "0"; aAlfa = #dsm18430#44;
        |FINSI;
        Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |HAZ GrabaDomicilio;

        |SI #dsm18430#43 ! 0; |O #dsm18430#44 ! 0;
           nSwClaveGrabada = 1;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

           |SI #dsmoy000#6 ] 2008;
               aCadena1 = " " * 250;
               |XGRABA nHandle, aCadena1;
           |FINSI;

           aCadena1 = (" " * 91);
           |XGRABA nHandle, aCadena1;

           |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
               aCadena1 = &13 + &10;
               |XGRABA nHandle, aCadena1;
           |FINSI;
        |FINSI;
     |SINO;
        aCadena1 = aCadena + "A00";
        TipoDato = "N"; LongDec = 2;
        |SI #dsm18430#12 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#12; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#12;
        |FINSI;
        Long = 10; |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |SI #dsm18430#13 < 0;
           aCadena1 = aCadena1 + "0";
           nCalc = 0 - #dsm18430#13; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + "0"; aAlfa = #dsm18430#13;
        |FINSI;
        Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
        |HAZ GrabaDomicilio;

        |SI #dsm18430#12 ! 0; |O #dsm18430#13 ! 0;
           nSwClaveGrabada = 1;
           aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

           |SI #dsmoy000#6 ] 2008;
               aCadena1 = " " * 250;
               |XGRABA nHandle, aCadena1;
           |FINSI;

           aCadena1 = (" " * 91);
           |XGRABA nHandle, aCadena1;

           |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
               aCadena1 = &13 + &10;
               |XGRABA nHandle, aCadena1;
           |FINSI;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "C00";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#14 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#14; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#14;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |SI #dsm18430#15 < 0;
        aCadena1 = aCadena1 + "0";
        nCalc = 0 - #dsm18430#15; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + "0"; aAlfa = #dsm18430#15;
     |FINSI;
     Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     TipoDato = "A"; LongDec = 0;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#14 ! 0; |O #dsm18430#15 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "D00";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#16 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#16; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#16;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |SI #dsm18430#17 < 0;
        aCadena1 = aCadena1 + "0";
        nCalc = 0 - #dsm18430#17; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + "0";  aAlfa = #dsm18430#17;
     |FINSI;
     Long = 8;   |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#16 ! 0; |O #dsm18430#17 ! 0; |O nDatosClvD = 1;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "E00";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#18 < 0;
        aCadena1 = aCadena1 + "N";  nCalc = 0 - #dsm18430#18; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#18;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#18 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "F01";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#19 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#19; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#19;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#19 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "F02";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#20 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#20; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#20;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#20 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "G01";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#21 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#21; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#21;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#21 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "G02";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#22 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#22; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#22;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#22 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "H01";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#49 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#49; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " ";  aAlfa = #dsm18430#49;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#49 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        aCadena1 = " " * 250;
        |XGRABA nHandle, aCadena1;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "H02";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#50 < 0;
        aCadena1 = aCadena1 + "N";
        nCalc = 0 - #dsm18430#50; aAlfa = nCalc;
     |SINO;
        aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#50;
     |FINSI;
     Long = 10;  |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#50 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        aCadena1 = " " * 250;
        |XGRABA nHandle, aCadena1;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "I01";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#23 = "X";
        |SI #dsm18430#25 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#25; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#25;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = "0";          |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#23 = "X"; |Y #dsm18430#25 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "I02";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#23 = "X";
        |SI #dsm18430#26 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#26; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#26;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#23 = "X"; |Y #dsm18430#26 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "I03";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#23 = "X";
        |SI #dsm18430#27 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#27; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#27;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#23 = "X"; |Y #dsm18430#27 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "I04";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#23 = "X";
        |SI #dsm18430#28 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#28; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#28;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#23 = "X"; |Y #dsm18430#28 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "I05";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#23 = "X";
        |SI #dsm18430#29 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#29; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#29;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#23 = "X"; |Y #dsm18430#29 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "I06";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#23 = "X";
        |SI #dsm18430#30 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#30; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#30;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#23 = "X"; |Y #dsm18430#30 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "J01";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#24 = "X";
        |SI #dsm18430#25 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#25; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#25;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = "0";          |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#24 = "X"; |Y #dsm18430#25 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "J02";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#24 = "X";
        |SI #dsm18430#26 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#26; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#26;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#24 = "X"; |Y #dsm18430#26 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "J03";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#24 = "X";
        |SI #dsm18430#27 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#27; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#27;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#24 = "X"; |Y #dsm18430#27 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "J04";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#24 = "X";
        |SI #dsm18430#28 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#28; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#28;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#24 = "X"; |Y #dsm18430#28 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "J05";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#24 = "X";
        |SI #dsm18430#29 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#29; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#29;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#24 = "X"; |Y #dsm18430#29 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aCadena1 = aCadena + "J06";
     TipoDato = "N"; LongDec = 2;
     |SI #dsm18430#24 = "X";
        |SI #dsm18430#30 < 0;
           aCadena1 = aCadena1 + "N";
           nCalc = 0 - #dsm18430#30; aAlfa = nCalc;
        |SINO;
           aCadena1 = aCadena1 + " "; aAlfa = #dsm18430#30;
        |FINSI;
     |SINO;
        aCadena1 = aCadena1 + " ";     aAlfa = "0";
     |FINSI;
     Long = 10;                        |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     Long = 9;   aAlfa = 0;            |HAZ Formateo1; aCadena1 = aCadena1 + aAlfa;
     |HAZ GrabaDomicilio;
     |SI #dsm18430#24 = "X"; |Y #dsm18430#30 ! 0;
        nSwClaveGrabada = 1;
        aCadena1 = aCadena1; |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;

     aSubClv = "K01"; nImporte = #dsm18430#31; |HAZ PasaClaveK;
     aSubClv = "K02"; nImporte = #dsm18430#45; |HAZ PasaClaveK;
     aSubClv = "K03"; nImporte = #dsm18430#46; |HAZ PasaClaveK;
     aSubClv = "K04"; nImporte = #dsm18430#47; |HAZ PasaClaveK;
     aSubClv = "K05"; nImporte = #dsm18430#48; |HAZ PasaClaveK;

     |SI nSwClaveGrabada = 0; || Si no se ha grabado ninguna clave, hay que
                              ||   presentar el socio con clave vacia
        aCadena1 = (aCadena1 % 0192)  + " 00" + (aCadena1 % 9664);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 ] 2008;
            aCadena1 = " " * 250;
            |XGRABA nHandle, aCadena1;
        |FINSI;

        aCadena1 = (" " * 91);
        |XGRABA nHandle, aCadena1;

        |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
            aCadena1 = &13 + &10;
            |XGRABA nHandle, aCadena1;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RegistroSoc;
     #dsm18430#2;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, "               ";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, "zzzzzzzzzzzzzzz";
     ;
     NULL,RegistroSoc;
|FIN;

|PROCESO RegistroDec;
     aCadena = "2184";
     aCadena = aCadena + #dsm18401#1;
     aCadena = aCadena + #dsmow565#4;
     aCadena = aCadena + #dsmow565#4;
     aCadena = aCadena + (" " * 9);
     eaAlfa  = #dsmow565#5;  |HAZ QuitaRaros;
     aCadena = aCadena + eaAlfa;

     aCadena = aCadena + "E";
     TipoDato = "A"; LongDec = 0;
     Long = 1;  aAlfa = aClave;    |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 2;  aAlfa = aSubClave; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI #dsmoy000#6 [ 2006;
        |SI aPais = "ES"; aPais = "  "; |FINSI;
     |SINO;
        |SI aClave ! "B"; |Y aClave ! "L";
           |SI aPais = "ES"; aPais = "  "; |FINSI;
        |FINSI;
     |FINSI;
     Long = 2;  aAlfa = aPais;     |HAZ Formateo1; aCadena = aCadena + aAlfa;

     TipoDato = "N"; LongDec = 0;
     Long = 1;  aAlfa = aTRegimen; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 1;  aAlfa = aTActivid; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 4;  aAlfa = nEpigrafe; |HAZ Formateo1; aCadena = aCadena + aAlfa;
     TipoDato = "A"; LongDec = 0;
     Long = 9;  aAlfa = aNifCes;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 20; aAlfa = aNomCes;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     TipoDato = "N"; LongDec = 0;
     Long = 4;  aAlfa = nAnyoAdq;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 2;  aAlfa = nMesAdq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 2;  aAlfa = nDiaAdq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     aCadena = aCadena; |XGRABA nHandle, aCadena; aCadena = "";

     TipoDato = "N"; LongDec = 2;
     Long = 11; aAlfa = nValLiq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 11; aAlfa = nValAdq;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI nImpIngr < 0;
        aCadena = aCadena + "N";
        nImpIngr = 0 - nImpIngr;
     |SINO;
        aCadena = aCadena + " ";
     |FINSI;
     Long = 11; aAlfa = nImpIngr;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nImpGast;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SI nImpRtas < 0;
        aCadena = aCadena + "N";
        nImpRtas = 0 - nImpRtas;
     |SINO;
        aCadena = aCadena + " ";
     |FINSI;
     Long = 11; aAlfa = nImpRtas;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 3;  aAlfa = nPorcRed;  |HAZ Formateo1; aCadena = aCadena + aAlfa;

     |SI #dsmoy000#6 ] 2008;
         |SI nImpRtaR < 0;
            aCadena = aCadena + "N";
            nImpRtaR = 0 - nImpRtaR;
         |SINO;
            aCadena = aCadena + " ";
         |FINSI;

         Long = 9;  aAlfa = nImpRtaR;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |SINO;
         Long = 10;  aAlfa = nImpRtaR;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     |FINSI;

     |SI nGanPer < 0; nGanPer = 0 - nGanPer; |FINSI;
     Long = 11; aAlfa = nGanPer;   |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nBaseDed;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
     Long = 10; aAlfa = nRetIng;   |HAZ Formateo1; aCadena = aCadena + aAlfa;

     |SI #dsmoy000#6 < 2015;                 ||cambios 2015
         |XGRABA nHandle, aCadena;
     |FINSI;

     |SI #dsmoy000#6 ] 2008; |Y #dsmoy000#6 < 2015;
         aCadena = " " * 250;
         |XGRABA nHandle, aCadena;
     |FINSI;

     |SI #dsmoy000#6 ] 2015;

         |SI aClave = "C";
             TipoDato = "A"; LongDec = 0;
             Long = 1;  aAlfa = #dsm18405#14;  aCadena = aCadena + aAlfa;
             Long = 20; aAlfa = #dsm18405#15;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
         |SINO;
             aCadena = aCadena + "0" + "                    ";
         |FINSI;
         |SI aClave = "D"; |Y aSubClave [ "02";
             TipoDato = "N"; LongDec = 2;
             Long = 10; aAlfa = nNumeA;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
             Long = 10; aAlfa = nNumeB;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
             Long = 10; aAlfa = nNumeC;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
             Long = 10; aAlfa = nNumeD;  |HAZ Formateo1; aCadena = aCadena + aAlfa;
         |SINO;
             aAlfa = "0" * 48;
             aCadena = aCadena + aAlfa;
         |FINSI;
         |XGRABA nHandle, aCadena;

         aCadena = " " * 181;
         |XGRABA nHandle, aCadena;
     |FINSI;

     aCadena = "      ";
     |XGRABA nHandle, aCadena;

     |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
         aCadena = &13 + &10;
         |XGRABA nHandle, aCadena;
     |FINSI;
|FPRC;

|PROCESO DefectVars;
     aPais     = "";
     aTRegimen = "0";      aTActivid = "0";      nEpigrafe = 0;
     aNifCes   = " " * 9;  aNomCes   = " " * 20; nAnyoAdq  = 0;
     nMesAdq   = 0;        nDiaAdq   = 0;        nValLiq   = 0;
     nValAdq   = 0;        nImpIngr  = 0;        nImpGast  = 0;
     nImpRtas  = 0;        nPorcRed  = 0;        nImpRtaR  = 0;
     nGanPer   = 0;        nBaseDed  = 0;        nRetIng   = 0;
     nNumeA    = 0;        nNumeB    = 0;        nNumeC    = 0;
     nNumeD    = 0;
|FPRC;

|PROCESO CapituloL;
     |HAZ DefectVars; aClave = "L";
     aSubClave = #dsm18414#4; aPais    = #dsm18414#5; nImpGast = #dsm18414#6;
     |SI nImpGast ! 0; |HAZ RegistroDec; |FINSI;
|FPRC;

|DEFBUCLE CapituloL;
     #dsm18414#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL,CapituloL;
|FIN;

|PROCESO CapituloK;
     |HAZ DefectVars;
     aClave = "K"; aSubClave = "01"; nRetIng = #dsm18401#50;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "02"; nRetIng = #dsm18401#51;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "03"; nRetIng = #dsm18401#52;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "04"; nRetIng = #dsm18401#53;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "K"; aSubClave = "05"; nRetIng = #dsm18401#54;
     |SI nRetIng ! 0; |HAZ RegistroDec; |FINSI;
|FPRC;

|PROCESO CapituloJ;
     |SI #dsm18401#1 < 2015;
         |HAZ DefectVars;
         aClave = "J"; aSubClave = "01"; nBaseDed = #dsm18401#44;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "02"; nBaseDed = #dsm18401#45;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "03"; nBaseDed = #dsm18401#46;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "04"; nBaseDed = #dsm18401#47;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "05"; nBaseDed = #dsm18401#48;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "06"; nBaseDed = #dsm18401#49;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
     |SINO;
         |HAZ DefectVars;
         aClave = "J"; aSubClave = "01"; nBaseDed = #dsm18401#45;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "02"; nBaseDed = #dsm18401#46;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "03"; nBaseDed = #dsm18401#48;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

         |HAZ DefectVars;
         aClave = "J"; aSubClave = "04"; nBaseDed = #dsm18401#49;
         |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
     |FINSI;
|FPRC;

|PROCESO CapituloI;
     |HAZ DefectVars;
     aClave = "I"; aSubClave = "01"; nBaseDed = #dsm18401#38;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "I"; aSubClave = "02"; nBaseDed = #dsm18401#39;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "I"; aSubClave = "03"; nBaseDed = #dsm18401#40;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars;
     aClave = "I"; aSubClave = "04"; nBaseDed = #dsm18401#41;
     |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

     |SI #dsmoy000#6 [ 2006;
        |HAZ DefectVars;
        aClave = "I"; aSubClave = "05"; nBaseDed = #dsm18401#42;
        |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;

        |HAZ DefectVars;
        aClave = "I"; aSubClave = "06"; nBaseDed = #dsm18401#43;
        |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
     |SINO;
        |HAZ DefectVars;
        aClave = "I"; aSubClave = "05"; nBaseDed = #dsm18401#43;
        |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
        |SI #dsmoy000#6 ] 2015;
            |HAZ DefectVars;
            aClave = "I"; aSubClave = "06"; nBaseDed = #dsm18401#42;
            |SI nBaseDed ! 0; |HAZ RegistroDec; |FINSI;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO CapituloH;
     |SI #dsm18401#35 = 0;  |Y #dsm18401#36 = 0;  |Y #dsm18401#34 = 0;  |Y #dsm18401#37 = 0;
         |ACABA;
     |FINSI;

     |HAZ DefectVars;
     aClave = "H"; aSubClave = "  ";
     nValLiq  = #dsm18401#35; nValAdq  = #dsm18401#36;
     nImpIngr = #dsm18401#34; nImpRtas = #dsm18401#37;
     |HAZ RegistroDec;
|FPRC;

|PROCESO BCapituloM;
     |SI aDPais = "ES"; |Y aHPais = "ES";
        |SI #dsm18415#5 = "G";
           nGan = nGan + #dsm18415#6;
        |SINO;
           nPer = nPer - #dsm18415#6;
        |FINSI;
     |SINO;
        |SI #dsm18415#4 = "ES"; |ACABA; |FINSI;
        |SI aAntPais ! #dsm18415#4;
           |SI nPer ! 0; |O nGan ! 0;
              aClave = "F";
              |SI nGan ! 0;
                 nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
                 |HAZ RegistroDec;
              |FINSI;
              |SI nPer ! 0;
                 nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
                 |HAZ RegistroDec;
              |FINSI;
           |FINSI;
           aAntPais = #dsm18415#4;
           |HAZ DefectVars; nGan = 0; nPer = 0;
        |FINSI;
        |SI #dsm18415#5 = "G"; nGan = nGan + #dsm18415#6; |FINSI;
        |SI #dsm18415#5 = "P"; nPer = nPer + #dsm18415#6; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BCapituloM;
     #dsm18415#2;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aDPais;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aHPais;
     ;
     NULL,BCapituloM;
|FIN;

|PROCESO CapituloM;
     |HAZ DefectVars; nGan = 0; nPer = 0;
     aDPais = "ES"; aHPais = "ES";
     |BUCLE BCapituloM;
     aClave = "M"; aSubClave = "01"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;
     aClave = "M"; aSubClave = "02"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloM;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "M";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO BCapituloG;
     |SI aDPais = "ES"; |Y aHPais = "ES";
        |SI #dsm18409#6 = "G";
           nGan = nGan + #dsm18409#7;
        |SINO;
           nPer = nPer + #dsm18409#7;
        |FINSI;
     |SINO;
        |SI #dsm18409#5 = "ES"; |ACABA; |FINSI;
        |SI aAntPais ! #dsm18409#5;
           |SI nPer ! 0; |O nGan ! 0;
              aClave = "G";
              |SI nGan ! 0;
                 |SI aDerecho = "N";
                    aSubClave = "03";
                 |SINO;
                    aSubClave = "07";
                 |FINSI;
                 aPais = aAntPais; nGanPer = nGan;
                 |HAZ RegistroDec;
              |FINSI;
              |SI nPer ! 0;
                 |SI aDerecho = "N";
                    aSubClave = "04";
                 |SINO;
                    aSubClave = "08";
                 |FINSI;
                 aPais = aAntPais; nGanPer = nPer;
                 |HAZ RegistroDec;
              |FINSI;
           |FINSI;
           aAntPais = #dsm18409#5;
        |FINSI;
        |SI #dsm18408#6 = "G"; nGan = nGan + #dsm18409#7; |FINSI;
        |SI #dsm18408#6 = "P"; nPer = nPer + #dsm18409#7; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BCapituloG;
     #dsm18409#2;
     9;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aDPais, aDerecho;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aHPais, aDerecho;
     ;
     NULL,BCapituloG;
|FIN;

|PROCESO CapituloG;
     aDerecho = "N";

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "01"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "02"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloG;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "G";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;

     aDerecho = "S";

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "05"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     |HAZ DefectVars; nGan = 0; nPer = 0; aAntPais = "";
     aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloG;
     aClave = "G"; aSubClave = "06"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloG;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "G";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "07"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "08"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO BCapituloF;
     |SI aDPais = "ES"; |Y aHPais = "ES";
        |SI #dsm18408#5 = "G";
           nGan = nGan + #dsm18408#6;
        |SINO;
           nPer = nPer - #dsm18408#6;
        |FINSI;
     |SINO;
        |SI #dsm18408#4 = "ES"; |ACABA; |FINSI;
        |SI aAntPais ! #dsm18408#4;
           |SI nPer ! 0; |O nGan ! 0;
              aClave = "F";
              |SI nGan ! 0;
                 nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
                 |HAZ RegistroDec;
              |FINSI;
              |SI nPer ! 0;
                 nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
                 |HAZ RegistroDec;
              |FINSI;
           |FINSI;
           aAntPais = #dsm18408#4;
           |HAZ DefectVars; nGan = 0; nPer = 0;
        |FINSI;
        |SI #dsm18408#5 = "G"; nGan = nGan + #dsm18408#6; |FINSI;
        |SI #dsm18408#5 = "P"; nPer = nPer + #dsm18408#6; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BCapituloF;
     #dsm18408#2;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aDPais;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aHPais;
     ;
     NULL,BCapituloF;
|FIN;

|PROCESO CapituloF;
     |HAZ DefectVars; nGan = 0; nPer = 0;
     aDPais = "ES"; aHPais = "ES";
     |BUCLE BCapituloF;
     aClave = "F"; aSubClave = "01"; aPais = "ES"; nGanPer = nGan;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;
     aClave = "F"; aSubClave = "02"; aPais = "ES"; nGanPer = nPer;
     |SI nGanPer ! 0; |HAZ RegistroDec; |FINSI;

     aDPais = "  "; aHPais = "zz";
     nPer = 0; nGan = 0;
     |BUCLE BCapituloF;
     |SI nPer ! 0; |O nGan ! 0;
        aClave = "F";
        |SI nGan ! 0;
           nGanPer = nGan; aSubClave = "03"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
        |SI nPer ! 0;
           nGanPer = nPer; aSubClave = "04"; aPais = aAntPais;
           |HAZ RegistroDec;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO BCapituloE;
     |HAZ DefectVars;

     aClave = "E"; aSubClave = "";
     aNifCes = #dsm18407#4; aNomCes = #dsm18407#5;
     aAlfa = #dsm18407#6; |QBF aAlfa;
     aAlfa1 = aAlfa % 0102;  nDiaAdq  = aAlfa1;
     aAlfa1 = aAlfa % 0402;  nMesAdq  = aAlfa1;
     aAlfa1 = aAlfa % 0704;  nAnyoAdq = aAlfa1;
     nValLiq = #dsm18407#7;  nValAdq  = #dsm18407#8;
     nImpRtas = #dsm18407#9;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE BCapituloE;
     #dsm18407#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL,BCapituloE;
|FIN;

|PROCESO CapituloE;
     |BUCLE BCapituloE;
|FPRC;

|PROCESO Paises;
     |SI #dsm18431#4 = "ES"; |ACABA; |FINSI;

     |SI aAntPais ! #dsm18431#4;
        |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
           aSubClave = "02"; aPais = aAntPais;
           aTRegimen = #dsm18406#4; aTActivid = #dsm18406#5; nEpigrafe = #dsm18406#6;
           ||SI nEpigrafe < 1000; nEpigrafe = nEpigrafe * 10; |FINSI;
           |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
              |HAZ RegistroDec; |HAZ DefectVars;
              nImpIngr = 0; nImpGast = 0; nImpRtas = 0;
              nNumeA   = 0; nNumeB   = 0;
              nNumeC   = 0; nNumeD   = 0;
           |FINSI;
        |FINSI;
        aAntPais = #dsm18431#4;
     |FINSI;

     nImpIngr = nImpIngr + #dsm18431#6;
     nImpGast = nImpGast + #dsm18431#7;
     nImpRtas = nImpRtas + #dsm18431#8;

     nNumeA   = nNumeA + #dsm18431#11;
     nNumeB   = nNumeB + #dsm18431#12;
     nNumeC   = nNumeC + #dsm18431#13;
     nNumeD   = nNumeD + #dsm18431#14;
|FPRC;

|DEFBUCLE Paises;
     #dsm18431#1;
     ;
     #dsm18406#0, #dsm18406#1, #dsm18406#2, #dsm18406#3, "  ", " ";
     #dsm18406#0, #dsm18406#1, #dsm18406#2, #dsm18406#3, "zz", "z";
     ;
     NULL,Paises;
|FIN;

|PROCESO ActEcon;
     |HAZ DefectVars;
     aSubClave = "01";
     aTRegimen = #dsm18406#4; aTActivid = #dsm18406#5; nEpigrafe = #dsm18406#6;

     nImpIngr =  #dsm18406#7;  nImpGast =  #dsm18406#8;  nImpRtas =  #dsm18406#9;
     nNumeA   =  #dsm18406#17; nNumeB   =  #dsm18406#18; nNumeC   =  #dsm18406#19;
     nNumeD   =  #dsm18406#20;
     |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
       |O nNumeA ! 0; |O nNumeB ! 0; |O nNumeC ! 0;
         |O nNumeD ! 0;
        nDatosClvD = 1;
        |HAZ RegistroDec;
     |FINSI;

     nImpIngr = 0; nImpGast = 0; nImpRtas = 0;
     nNumeA   = 0; nNumeB   = 0; nNumeC   = 0; nNumeD = 0;
     |HAZ DefectVars; |BUCLE Paises;
     aSubClave = "02"; aPais = aAntPais;
     aTRegimen = #dsm18406#4; aTActivid = #dsm18406#5; nEpigrafe = #dsm18406#6;

     |SI nImpIngr ! 0; |O nImpGast ! 0; |O nImpRtas ! 0;
       |O nNumeA ! 0; |O nNumeB ! 0; |O nNumeC ! 0;
         |O nNumeD ! 0;
        nDatosClvD = 1;
        |HAZ RegistroDec;
     |FINSI;

     |HAZ DefectVars;
     aSubClave = "03";
     aTRegimen = #dsm18406#4; aTActivid = #dsm18406#5; nEpigrafe = #dsm18406#6;

     nImpRtaR =  #dsm18406#13;
     |SI nImpRtaR ! 0;
        nDatosClvD = 1;
        |HAZ RegistroDec;
     |FINSI;
|FPRC;

|DEFBUCLE ActEcon;
     #dsm18406#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 01;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 99;
     ;
     NULL,ActEcon;
|FIN;

|PROCESO CapituloD;
     nDatosClvD = 0;
     aClave = "D"; |BUCLE ActEcon;
|FPRC;

|PROCESO CapituloC;
     |HAZ DefectVars;
     aClave    = "C";
     aSubClave = "  ";
     |SI #dsm18405#4 = "S";
        aSubClave = "03"; aPais = "  ";
        nPorcRed = #dsm18405#9;
        nImpRtaR = #dsm18405#10;
     |SINO;
        aPais    = #dsm18405#5;
        nImpIngr = #dsm18405#6;
        nImpGast = #dsm18405#7;
        nImpRtas = #dsm18405#8;
        |SI aPais = "ES";
           aSubClave = "01";
        |SINO;
           aSubClave = "02";
        |FINSI;
     |FINSI;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE CapituloC;
     #dsm18405#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL,CapituloC;
|FIN;

|PROCESO CapituloB;
     |HAZ DefectVars; aClave = "B";
     aSubClave = "  ";
     aPais    = #dsm18404#7; aNifCes  = #dsm18404#4;
     aNomCes  = #dsm18404#5; nImpIngr = #dsm18404#6;
     |HAZ RegistroDec;
|FPRC;

|DEFBUCLE CapituloB;
     #dsm18404#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL,CapituloB;
|FIN;

|PROCESO BCapituloA;
     |SI nSw = 0;
         |HAZ DefectVars;
         nSw = 1;
     |FINSI;

     aClave = "A";
     |SI #dsm18403#4 = "S";
         aSubClave = "03"; aPais = "  ";
         nPorcRed = #dsm18403#9;
         nImpRtaR = nImpRtaR + #dsm18403#10;
     |SINO;
         aPais    = #dsm18403#5;
         nImpIngr = nImpIngr + #dsm18403#6;
         nImpGast = nImpGast + #dsm18403#7;
         nImpRtas = nImpRtas +  #dsm18403#8;
         |SI aPais = "ES";
             aSubClave = "01";
         |SINO;
             aSubClave = "02";
         |FINSI;
     |FINSI;
     || |HAZ RegistroDec;
|FPRC;

|DEFBUCLE BCapituloA;
     #dsm18403#2;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aRed, aDPais, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, aRed, aHPais, 999;
     ;
     NULL, BCapituloA;
|FIN;

|PROCESO CapituloA;
     nSw  = 0;
     aRed = "N"; aDPais = "ES"; aHPais = "ES"; |BUCLE BCapituloA;
     |SI nSw = 1; |HAZ RegistroDec; |FINSI;

     nSw = 0;
     aRed = "N"; aDPais = " !"; aHPais = "ER"; |BUCLE BCapituloA;
     aRed = "N"; aDPais = "ET"; aHPais = "ZZ"; |BUCLE BCapituloA;
     |SI nSw = 1; |HAZ RegistroDec; |FINSI;

     nSw  = 0;
     aRed = "S"; aDPais = "  "; aHPais = "ZZ"; |BUCLE BCapituloA;
     |SI nSw = 1; |HAZ RegistroDec; |FINSI;
|FPRC;

|PROCESO Declarantes;
     aCadena = "";
     |PARA nCont = 1; |SI nCont [ 24; |HACIENDO nCont = nCont + 1;
           eaAlfa  = #dsmow565#nCont#;  |HAZ QuitaRaros;
           aCadena = eaAlfa;
           |XGRABA nHandle, aCadena;
     |SIGUE;

     |SI #dsmoy000#6 ] 2008;
         aCadena = " " * 250;
         |XGRABA nHandle, aCadena;
     |FINSI;

     |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
         aCadena = &13 + &10;
         |XGRABA nHandle, aCadena;
     |FINSI;

     |HAZ CapituloA;
     |BUCLE CapituloB;
     |BUCLE CapituloC;
     |HAZ CapituloD;
     |HAZ CapituloE;
     |HAZ CapituloF;
     |HAZ CapituloG;
     |HAZ CapituloM;
     |HAZ CapituloH;
     |HAZ CapituloI;
     |HAZ CapituloJ;
     |HAZ CapituloK;
     |BUCLE CapituloL;
     |BUCLE RegistroSoc;
|FPRC;

|PROCESO BuscaCargo;
     eaAlfa  = #agim0026#4;  |HAZ QuitaRaros;
     #dsmow568#13 = eaAlfa;

     eaAlfa  = #agim0026#17;  |HAZ QuitaRaros;
     #dsmow568#14 = eaAlfa;
|FPRC;

|DEFBUCLE agim0026;
     #agim0026#1;
     16;
     #dsm18401#0, 01, 01, 3;
     #dsm18401#0, 99, 99, 3;
     ;
     NULL, BuscaCargo;
|FIN;

|PROCESO BuscaCargo184R;
     |SI #agim0024#15 ! "A";
         eaAlfa  = #agim0024#4;  |HAZ QuitaRaros;
         #dsmow568#13 = eaAlfa;

         eaAlfa  = "REPRESENTANTE";  |HAZ QuitaRaros;
         #dsmow568#14 = eaAlfa;

         nHayRepre = 1;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#2;
     ;
     #dsm18401#0, 99, 01;
     #dsm18401#0, 01, 99;
     ;
     NULL, BuscaCargo184R;
|FIN;

|PROCESO BuscaComuneros184;
     aAlfa = "31.12." + #dsm18401#1;
     |SI #dsmom001#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #dsm18401#1;
     |SI #dsmom001#9 > "01.01.0000";
         |SI #dsmom001#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nHayRepre = 1;

     enCodCli = #dsmom001#3; |HAZ LeePersona;

     eaAlfa  = #clientes@#1;           |HAZ QuitaRaros;   #dsmow568#13 = eaAlfa;
     eaAlfa  = "REPRESENTANTE";  |HAZ QuitaRaros;   #dsmow568#14 = eaAlfa;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#1;
     ;
     #dsm18401#0, 01, 0001;
     #dsm18401#0, 99, 9999;
     ;
     NULL, BuscaComuneros184;
|FIN;

|PROCESO Individual2006;
     |ABRE #dsm18401;
     #dsm18401#0 = #dsmow014#0;
     #dsm18401#1 = #dsmow014#1;
     #dsm18401#2 = #dsmow014#5;
     #dsm18401#3 = #dsmow014#7;
     |LEE 000#dsm18401.=;
     |SI FSalida ! 0;  |DDEFECTO #dsm18401;  |FINSI;
     |CIERRA #dsm18401;

     aAbre = eaPathEmision + "OPA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
     |XABRE "BW", aAbre, nHandle;

     nNumSocsDec = 0;
     nNumSocs = 0; |BUCLE CuentaSocios;

     |DDEFECTO #dsmow565;        ||Declarante
     #dsmow565#0 = #dsm18401#0;
     #dsmow565#3 = #dsm18401#1;
     aAlfa  = #dsm18401#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #dsmow565#4 = aAlfa;
     aAlfa  = #dsm18401#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #dsmow565#5 = aAlfa;

     |SI nTecla = 2; |O nTecla = 3;
         #dsmow565#6 = "T";
     |SINO;
         #dsmow565#6 = "P";
     |FINSI;

     nNume = #dsm18401#16;
     aAlfa = ("000000000" + nNume) % -109; #dsmow565#7 = aAlfa;
     aAlfa = #dsm18401#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #dsmow565#8 = aAlfa;

     #dsmow565#9 = "1840000000000";
     |SI #dsm18401#3 = 0;
         #dsmow565#10 = " ";
         #dsmow565#11 = " ";
         #dsmow565#12 = "0000000000000";
     |SINO;
         |SI #dsm18401#5 = "C";
             #dsmow565#10 = "C";
             #dsmow565#11 = " ";
             ||#dsmow565#12 = "0000000000000";

             aAlfa   = "184" + (("0000000000" + #dsm18401#7) % -110);
             #dsmow565#12 = aAlfa;
         |SINO;
             #dsmow565#10 = " ";
             #dsmow565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #dsm18401#7) % -110);
             #dsmow565#12 = aAlfa;
         |FINSI;
     |FINSI;

     ||aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     aAlfa   = nNumSocsDec; aAlfa = (("0" * 9) + aAlfa) % -109;
     #dsmow565#13 = aAlfa;
     #dsmow565#14 = #dsm18401#18;
     #dsmow565#15 = #dsm18401#19;
     #dsmow565#16 = #dsm18401#20;
     #dsmow565#17 = #dsm18401#21;
     #dsmow565#18 = #dsm18401#22;
     nCalc   = #dsm18401#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #dsmow565#19 = aAlfa;
     |SI #dsm18401#56 = "S";
         #dsmow565#20 = "X";
     |SINO;
         #dsmow565#20 = " ";
     |FINSI;
     nCalc   = #dsm18401#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #dsmow565#21 = aAlfa;
     aAlfa   = #dsm18401#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #dsmow565#22 = aAlfa;
     #dsmow565#23 = #dsm18401#26;

     nNumDecl = 1; |HAZ Declarantes;

     |XCIERRA nHandle;

     eaFOrigen  = eaPathEmision  + "OPA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
     eaFDestino = eaPathLanza + "OPA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
     |HAZ CopiaFichero;

     |FBORRA eaFOrigen;

     |SI nTecla = 2;
        aAbre = eaPathEmision + "AUXILIAR.TXT";
     |SINO;
        aAbre = eaPathEmision + "OPB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
     |FINSI;
     |XABRE "BW", aAbre, nHandle;

     enCodCli = #dsm18401#0;
     |HAZ LeePersona;
     |DDEFECTO #dsmow568;
     #dsmow568#0  = "1";
     #dsmow568#1  = "184";
     #dsmow568#2  = #dsm18401#1;
     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow568#3   = eaVarDni;
         #dsmow568#4   = ("00" + #clientes@#15) % -102;
         #dsmow568#5   = ("000" + #clientes@#16) % -103;
         #dsmow568#6   = #clientes@#29;
         eaAlfa   = #clientes@#30;  |HAZ QuitaRaros;
         #dsmow568#7   = eaAlfa;
         nNume    = #clientes@#31;
         #dsmow568#8   = ("00000" + nNume) % -105;
         eaAlfa   = #clientes@#37;  |HAZ QuitaRaros;
         #dsmow568#9   = eaAlfa;
         #dsmow568#10  = ("00" + #clientes@#35) % -102;
         #dsmow568#11  = (("00" + #clientes@#35) % -102) + (("000" + #clientes@#36) % -103);
     |SINO;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow568#3   = eaVarDni;
         #dsmow568#4   = ("00" + #clientes@#63) % -102;
         #dsmow568#5   = ("000" + #clientes@#64) % -103;
         #dsmow568#6   = #clientes@#3;
         eaAlfa   = #clientes@#4;  |HAZ QuitaRaros;
         #dsmow568#7   = eaAlfa;
         nNume    = #clientes@#5;
         #dsmow568#8   = ("00000" + nNume) % -105;
         #dsmow568#9   = #clientes@#11;
         #dsmow568#10  = ("00" + #clientes@#9) % -102;
         #dsmow568#11  = (("00" + #clientes@#9) % -102) + (("000" + #clientes@#10) % -103);
     |FINSI;
     #dsmow568#12  = (#dsmoy000#7 % -104) + (#dsmoy000#7 % 402) + (#dsmoy000#7 % 102);
     |SI #dsm18407#1 = "S";
         |BUCLE agim0026;
     |SINO;
         nHayRepre = 0;
         |BUCLE agim0024;
         |SI nHayRepre = 0;
            |BUCLE dsmom001;
            |SI nHayRepre = 0;
               eaAlfa  = #dsmow014#3;  |HAZ QuitaRaros;
               #dsmow568#13 = eaAlfa;
               eaAlfa  = "TITULAR";  |HAZ QuitaRaros;
               #dsmow568#14 = eaAlfa;
            |FINSI;
         |FINSI;
     |FINSI;
     #dsmow568#15  = ("00000" + #dsmow014#0) % -105;
     #dsmow568#16  = "";
     eaAlfa  = #dsm18401#27;  |HAZ QuitaRaros; eaAlfa = eaAlfa % 0120;
     #dsmow568#17  = eaAlfa;
     aAlfa = ("00000" + #dsm18401#28) % -105;
     #dsmow568#18  = aAlfa;
     aAlfa = (("00" + #dsm18401#29) % -102) + (("000" + #dsm18401#30) % -103);
     #dsmow568#19  = aAlfa;
     eaAlfa  = #dsm18401#31;  |HAZ QuitaRaros; eaAlfa = eaAlfa % 0112;
     #dsmow568#20  = eaAlfa;
     aAlfa = (("00" + #dsm18401#29) % -102);
     #dsmow568#21  = aAlfa;

     |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
         #dsmow568#22  = &13 + &10;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
        aAlfa = #dsmow568#nCampo#;
        |XGRABA nHandle, aAlfa;
     |SIGUE;

     |XCIERRA nHandle;

     |SI nTecla = 2;
         eaFOrigen  = eaPathEmision  + "AUXILIAR.TXT";
         eaFDestino = eaPathLanza + "AUXILIAR.TXT";
     |SINO;
         eaFOrigen  = eaPathEmision  + "OPB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         eaFDestino = eaPathLanza + "OPB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
     |FINSI;

     |HAZ CopiaFichero;
     |FBORRA eaFOrigen;
|FPRC;

|PROCESO Individual;
     |ABRE #dsm18401;
     #dsm18401#0 = #dsmow014#0;
     #dsm18401#1 = #dsmow014#1;
     #dsm18401#2 = #dsmow014#5;
     #dsm18401#3 = #dsmow014#7;
     |LEE 000#dsm18401.=;
     |SI FSalida ! 0;  |DDEFECTO #dsm18401;  |FINSI;
     |CIERRA #dsm18401;

     aAbre = eaPathEmision + "184" + (("00000" + #dsmow014#0) % -105) + ".seq";
     |XABRE "BW", aAbre, nHandle;

     nNumSocs = 0;
     |BUCLE CuentaSocios;

     |DDEFECTO #dsmow565;        ||Declarante
     #dsmow565#0 = #dsm18401#0;
     #dsmow565#3 = #dsm18401#1;
     aAlfa  = #dsm18401#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #dsmow565#4 = aAlfa;
     aAlfa  = #dsm18401#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #dsmow565#5 = aAlfa;

     |SI nTecla = 2;
         #dsmow565#6 = "T";
     |SINO;
         #dsmow565#6 = "D";
     |FINSI;

     nNume = #dsm18401#16;
     aAlfa = ("000000000" + nNume) % -109; #dsmow565#7 = aAlfa;
     aAlfa = #dsm18401#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #dsmow565#8 = aAlfa;

     #dsmow565#9 = "1840000000000";

     |SI #dsm18401#7 = 0;
         #dsmow565#10 = " ";
         #dsmow565#11 = " ";
         #dsmow565#12 = "0000000000000";
     |SINO;
         |SI #dsm18401#5 = "C";
             #dsmow565#10 = "C";
             #dsmow565#11 = " ";
             #dsmow565#12 = "0000000000000";
         |SINO;
             #dsmow565#10 = " ";
             #dsmow565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #dsm18401#7) % -110);
             #dsmow565#12 = aAlfa;
         |FINSI;
     |FINSI;

     ||aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     aAlfa   = nNumSocsDec; aAlfa = (("0" * 9) + aAlfa) % -109;
     #dsmow565#13 = aAlfa;
     #dsmow565#14 = #dsm18401#18;
     #dsmow565#15 = #dsm18401#19;
     #dsmow565#16 = #dsm18401#20;
     #dsmow565#17 = #dsm18401#21;
     #dsmow565#18 = #dsm18401#22;
     nCalc   = #dsm18401#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #dsmow565#19 = aAlfa;
     |SI #dsm18401#56 = "S";
         #dsmow565#20 = "X";
     |SINO;
         #dsmow565#20 = " ";
     |FINSI;
     nCalc   = #dsm18401#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #dsmow565#21 = aAlfa;
     aAlfa   = #dsm18401#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #dsmow565#22 = aAlfa;
     #dsmow565#23 = #dsm18401#26;

     nNumDecl = 1;

     |HAZ Declarantes;

     |XCIERRA nHandle;

     eaFOrigen  = eaPathEmision  + "184" + (("00000" + #dsmow014#0) % -105) + ".seq";
     eaFDestino = eaPathInternet + "184" + (("00000" + #dsmow014#0) % -105) + ".seq";
     |HAZ CopiaFichero;

     |SI nTecla = 1;
         |MENAV "     Introduzca un diskette vacio en la disketera de su PC.";
         |MENAV "     Pulse una tecla si el diskette esta preparado";

         aOrigen  = eaFDestino;
         aDestino = "a:/184" + (("00000" + #dsmow014#0) % -105) + ".seq";
         |RCOPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |SI nPortada = 1;  |HAZ Portada184;  |FINSI;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO Presentador;
     aCadena = "0184";
     aCadena = aCadena + #dsmow014#1;
     aAlfa   = #dsmow016#0; |QBF aAlfa;
     aAlfa   = (("0" * 9) + aAlfa) % -109; aCadena = aCadena + aAlfa;
     aAlfa   = #dsmow016#1; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 40)) % 0140; aCadena = aCadena + aAlfa;
     aCadena = aCadena + #dsmow016#2;
     aAlfa   = #dsmow016#3; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 20)) % 0120; aCadena = aCadena + aAlfa;
     aAlfa   = #dsmow016#4; |QBF aAlfa;
     aAlfa   = (("0" * 5) + aAlfa) % -105; aCadena = aCadena + aAlfa;
     aCadena = aCadena + (#dsmow016#5 % 102);
     aCadena = aCadena + #dsmow016#6;
     aCadena = aCadena + #dsmow016#7;
     aAlfa   = #dsmow016#8; |QBF aAlfa;
     aAlfa   = (("0" * 2) + aAlfa) % -102; aCadena = aCadena + aAlfa;
     aAlfa   = #dsmow016#9#24; |QBF aAlfa;
     aAlfa   = (("0" * 3) + aAlfa) % -103; aCadena = aCadena + aAlfa;
     aCadena = aCadena + #dsmow016#10;
     aAlfa   = #dsmow016#8; |QBF aAlfa;
     aAlfa   = (("0" * 2) + aAlfa) % -102; aCadena = aCadena + aAlfa;
     aAlfa   = nNumDecl; |QBF aAlfa;
     aAlfa   = (("0" * 5) + aAlfa) % -105; aCadena = aCadena + aAlfa;
     aAlfa   = nNumTotSocs; |QBF aAlfa;
     aAlfa   = (("0" * 9) + aAlfa) % -109; aCadena = aCadena + aAlfa;
     aCadena = aCadena + "D";
     aAlfa   = #dsmow016#14; |QBF aAlfa;
     aAlfa   = (("0" * 9) + aAlfa) % -109; aCadena = aCadena + aAlfa;
     aAlfa   = #dsmow016#13; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 40)) % 0140; aCadena = aCadena + aAlfa;
     aCadena = aCadena + (" " * 77);

     |SI #dsmoy000#6 [ 2011;  |O eaOpcion = "3";
         aCadena = aCadena + &13 + &10;
     |FINSI;

     |XGRABA nHandle, aCadena;
|FPRC;

|PROCESO Colectivo;
     |SI nRegistros = 0;
         aAbre = eaPathEmision + "18400000.seq";

         |XABRE "BW", aAbre, nHandle;

         #dsmow016#17 = nNumDecl;
         #dsmow016#18 = nNumTotSocs;

         |PUSHV 0501 2380;
         |PINPA #0#dsmow016;
         |PINDA #0#dsmow016;
         |ENDATOS #1#dsmow016;
         |SI FSalida ! 0; |POPV;  |ACABA;  |FINSI;
         |POPV;

         |HAZ Presentador;

         |SI nPortada = 1;  |HAZ Portada184;  |FINSI;
     |FINSI;

     nRegistros = 1;

     |ABRE #dsm18401;
     #dsm18401#0 = #dsmow014#0;
     #dsm18401#1 = #dsmow014#1;
     #dsm18401#2 = #dsmow014#5;
     #dsm18401#3 = #dsmow014#7;
     |LEE 000#dsm18401.=;
     |SI FSalida ! 0;  |DDEFECTO #dsm18401;  |FINSI;
     |CIERRA #dsm18401;

     nNumSocs = 0;
     |BUCLE CuentaSocios;

     |DDEFECTO #dsmow565;        ||Declarante
     #dsmow565#0 = #dsm18401#0;
     #dsmow565#3 = #dsm18401#1;
     aAlfa  = #dsm18401#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #dsmow565#4 = aAlfa;
     aAlfa  = #dsm18401#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #dsmow565#5 = aAlfa;

     |SI nTecla = 4;
         #dsmow565#6 = "T";
     |SINO;
         #dsmow565#6 = "D";
     |FINSI;

     nNume = #dsm18401#16;
     aAlfa = ("000000000" + nNume) % -109; #dsmow565#7 = aAlfa;
     aAlfa = #dsm18401#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #dsmow565#8 = aAlfa;

     #dsmow565#9 = "1840000000000";

     |SI #dsm18401#7 = 0;
         #dsmow565#10 = " ";
         #dsmow565#11 = " ";
         #dsmow565#12 = "0000000000000";
     |SINO;
         |SI #dsm18401#5 = "C";
             #dsmow565#10 = "C";
             #dsmow565#11 = " ";
             #dsmow565#12 = "0000000000000";
         |SINO;
             #dsmow565#10 = " ";
             #dsmow565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #dsm18401#7) % -110);
             #dsmow565#12 = aAlfa;
         |FINSI;
     |FINSI;

     ||aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     aAlfa   = nNumSocsDec; aAlfa = (("0" * 9) + aAlfa) % -109;
     #dsmow565#13 = aAlfa;
     #dsmow565#14 = #dsm18401#18;
     #dsmow565#15 = #dsm18401#19;
     #dsmow565#16 = #dsm18401#20;
     #dsmow565#17 = #dsm18401#21;
     #dsmow565#18 = #dsm18401#22;
     nCalc   = #dsm18401#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #dsmow565#19 = aAlfa;
     |SI #dsm18401#56 = "S";
         #dsmow565#20 = "X";
     |SINO;
         #dsmow565#20 = " ";
     |FINSI;
     nCalc   = #dsm18401#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #dsmow565#21 = aAlfa;
     aAlfa   = #dsm18401#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #dsmow565#22 = aAlfa;
     #dsmow565#23 = #dsm18401#26;

     nNumDecl = 1;

     |HAZ Declarantes;

     |SI nPortada = 1;  |HAZ Portada184;  |FINSI;

     |HAZ GrabaImpreso;
|FPRC;

|PROCESO QueHacemos184;
     |SI nSwLee = 1;
         nNumDecl    = nNumDecl + 1;
         nNumTotSocs = 0;
         nNumSocs    = 0;

         |ABRE #dsm18401;
         #dsm18401#0 = #dsmow014#0;
         #dsm18401#1 = #dsmow014#1;
         #dsm18401#2 = #dsmow014#5;
         #dsm18401#3 = #dsmow014#7;
         |LEE 000#dsm18401.=;
         |SI FSalida ! 0;  |DDEFECTO #dsm18401;  |FINSI;
         |CIERRA #dsm18401;

         |BUCLE CuentaSocios;
         nNumTotSocs = nNumTotSocs + nNumSocs;

         |ACABA;
     |FINSI;

     |SI #dsmoy000#6 < 2006;
        |SI nTecla = 1;  |HAZ Individual;     |FINSI;
        |SI nTecla = 2;  |HAZ Individual;     |FINSI;
        |SI nTecla = 3;  |HAZ Colectivo;      |FINSI;
        |SI nTecla = 4;  |HAZ Colectivo;      |FINSI;
     |SINO;
        |HAZ Individual2006;

        |SI nTecla = 2;
           eaTipoV =  "S";
        |FINSI;
        |SI nTecla = 5; |O nTecla = 6;
           eaTipoV =  "N";
        |FINSI;
        eaTipoE =  "OPA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
        eaTipoR =  "OPC" + (("00000" + #dsmow014#0) % -105) + ".TXT";
        eaTipoP =  "PDF" + (("00000" + #dsmow014#0) % -105) + ".PDF";
        eaTipoC =  aTercera;
        eaTipoA =  "OPB" + (("00000" + #dsmow014#0) % -105) + ".TXT";

        |HAZ LineaShellJava;
        |HAZ GrabaImpreso;
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014C184;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos184;
|FIN;

|DEFBUCLE dsmow014N184;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos184;
|FIN;

/**************** PROCESOS PARA INFORME DE COMPROBACION *********************/

|PROCESO PonACero;
     sw03 = 0; sw04 = 0; sw05 = 0; sw06 = 0; sw07 = 0;
     sw08 = 0; sw09 = 0; sw10 = 0; sw14 = 0; sw30 = 0;
|FPRC;

|PROCESO Recupera;
/*
     |SI nElsw = 30; sw30 = nElval; |FINSI;
     |SI nElsw = 03; sw03 = nElval; |FINSI;
     |SI nElsw = 04; sw04 = nElval; |FINSI;
     |SI nElsw = 05; sw05 = nElval; |FINSI;
     |SI nElsw = 06; sw06 = nElval; |FINSI;
     |SI nElsw = 07; sw07 = nElval; |FINSI;
     |SI nElsw = 08; sw08 = nElval; |FINSI;
     |SI nElsw = 09; sw09 = nElval; |FINSI;
     |SI nElsw = 10; sw10 = nElval; |FINSI;
     |SI nElsw = 14; sw14 = nElval; |FINSI;
*/
     |SI nElsw = 30; sw30 = 1; |FINSI;
     |SI nElsw = 03; sw03 = 1; |FINSI;
     |SI nElsw = 04; sw04 = 1; |FINSI;
     |SI nElsw = 05; sw05 = 1; |FINSI;
     |SI nElsw = 06; sw06 = 1; |FINSI;
     |SI nElsw = 07; sw07 = 1; |FINSI;
     |SI nElsw = 08; sw08 = 1; |FINSI;
     |SI nElsw = 09; sw09 = 1; |FINSI;
     |SI nElsw = 10; sw10 = 1; |FINSI;
     |SI nElsw = 14; sw14 = 1; |FINSI;
|FPRC;

|PROCESO Imprime;
     |SI sw30 = 1;  nNumLin = 13; nElval = 1;  nElsw = 30; |FINSI;
     |SI sw30 = 11; nNumLin = 12; nElval = 11; nElsw = 30; |FINSI;
     |SI sw03 = 1;  nNumLin = 3;  nElval = 1;  nElsw = 03; |FINSI;
     |SI sw03 = 11; nNumLin = 1;  nElval = 11; nElsw = 03; |FINSI;
     |SI sw04 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 04; |FINSI;
     |SI sw04 = 11; nNumLin = 1;  nElval = 11; nElsw = 04; |FINSI;
     |SI sw05 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 05; |FINSI;
     |SI sw05 = 11; nNumLin = 1;  nElval = 11; nElsw = 05; |FINSI;
     |SI sw06 = 1;  nNumLin = 6;  nElval = 1;  nElsw = 06; |FINSI;
     |SI sw06 = 11; nNumLin = 3;  nElval = 11; nElsw = 06; |FINSI;
     |SI sw07 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 07; |FINSI;
     |SI sw07 = 11; nNumLin = 1;  nElval = 11; nElsw = 07; |FINSI;
     |SI sw08 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 08; |FINSI;
     |SI sw08 = 11; nNumLin = 1;  nElval = 11; nElsw = 08; |FINSI;
     |SI sw09 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 09; |FINSI;
     |SI sw09 = 11; nNumLin = 1;  nElval = 11; nElsw = 09; |FINSI;
     |SI sw10 = 1;  nNumLin = 16; nElval = 1;  nElsw = 10; |FINSI;
     |SI sw14 = 1;  nNumLin = 4;  nElval = 1;  nElsw = 14; |FINSI;
     |SI sw14 = 11; nNumLin = 1;  nElval = 11; nElsw = 14; |FINSI;

     nTotLin = nTotLin + nNumLin;
     |SI nTotLin > 72;
          swB = 1;
          |HAZ PonACero;
          |SI nElval = 11;    swCont = 1;    |FINSI;
          nNumBlan = 72 - (nTotLin - nNumLin);
          |PARA nNume = 1; |SI nNume [ nNumBlan; |HACIENDO nNume = nNume + 1;
               |PRINT;
          |SIGUE;
          nTotLin = nNumLin;
          swB = 0;
          |HAZ Recupera;
          |PIEINF;
     |FINSI;

     |PRINT;

     |SI sw03 = 1; sw03 = 11; |FINSI;
     |SI sw04 = 1; sw04 = 11; |FINSI;
     |SI sw05 = 1; sw05 = 11; |FINSI;
     |SI sw06 = 1; sw06 = 11; |FINSI;
     |SI sw07 = 1; sw07 = 11; |FINSI;
     |SI sw08 = 1; sw08 = 11; |FINSI;
     |SI sw09 = 1; sw09 = 11; |FINSI;
     |SI sw14 = 1; sw14 = 11; |FINSI;
     |SI sw30 = 1; sw30 = 11; |FINSI;
     |SI swC = 1;  swC = 0;   |FINSI;
     |SI swCont = 1;  swCont = 0;   |FINSI;
|FPRC;

|DEFBUCLE Comp30;
     #dsm18430#2;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, "               ";
     #dsm18401#0, #dsm18401#1, #dsm18401#3, "zzzzzzzzzzzzzzz";
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp14;
     #dsm18414#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp09;
     #dsm18409#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp08;
     #dsm18408#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp07;
     #dsm18407#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp06;
     #dsm18406#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp05;
     #dsm18405#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp04;
     #dsm18404#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|DEFBUCLE Comp03;
     #dsm18403#1;
     ;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 001;
     #dsm18401#0, #dsm18401#1, #dsm18401#3, 999;
     ;
     NULL, Imprime;
|FIN;

|PROCESO ElGranInforme;
     sw03 = 0;
     sw04 = 0;
     sw05 = 0;
     sw06 = 0;
     sw07 = 0;
     sw08 = 0;
     sw09 = 0;
     sw10 = 0;
     sw14 = 0;
     sw30 = 0;
     swC = 1;
     nTotLin = 25;

     sw30 = 1; |BUCLE Comp30; sw30 = 0;
     sw03 = 1; |BUCLE Comp03; sw03 = 0;
     sw04 = 1; |BUCLE Comp04; sw04 = 0;
     sw05 = 1; |BUCLE Comp05; sw05 = 0;
     sw06 = 1; |BUCLE Comp06; sw06 = 0;
     sw07 = 1; |BUCLE Comp07; sw07 = 0;
     sw08 = 1; |BUCLE Comp08; sw08 = 0;
     sw09 = 1; |BUCLE Comp09; sw09 = 0;
     sw10 = 1; |HAZ Imprime;  sw10 = 0;
     sw14 = 1; |BUCLE Comp14; sw14 = 0;
     |PIEINF;
|FPRC;

|DEFBUCLE ElGranInforme;
     #dsm18401#1;
     ;
     #dsmow014#0, #dsmow014#1, #dsmow014#5, 00;
     #dsmow014#0, #dsmow014#1, #dsmow014#5, 99;
     ;
     NULL, ElGranInforme;
|FIN;

|PROCESO InformeComp;
     |BUCLE ElGranInforme;

/*
     |ABRE #dsm18401;
     #dsm18401#0 = #dsmow014#0;
     #dsm18401#1 = #dsmow014#1;
     #dsm18401#2 = #dsmow014#5;
     #dsm18401#3 = #dsmow014#7;
     |LEE 000#dsm18401.=;
     |SI FSalida = 0;
     |FINSI;
*/
|FPRC;

|DEFBUCLE InformeComp;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, InformeComp;
|FIN;

/**************** FIN PROCESOS INFORME DE COMPROBACION **********************/

|PROCESO Boton1841_06;
     |PTEC 824;
|FPRC;

|PROCESO Boton1842_06;
     |PTEC 825;
|FPRC;

|PROCESO Boton1843_06;
     |PTEC 826;
|FPRC;

|PROCESO Boton1844_06;
     |PTEC 827;
|FPRC;

|PROCESO Boton1845_06;
     |PTEC 828;
|FPRC;

|PROCESO Boton1846_06;
     |PTEC 829;
|FPRC;

|PROCESO Boton1847_06;
     |PTEC 830;
|FPRC;

|PROCESO Boton184Esc_06;
     |PTEC 806;
|FPRC;

|PROCESO Botones184Del2006;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser (Directo por impresora)", 0613, 0754, Boton1841_06;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Laser (Vista previa  por el Acrobat)", 0913, 1054, Boton1842_06;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentaci¢n Telem tica Individual (con validacion)", 1213, 1354, Boton1843_06;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de comprobación ", 1513, 1654, Boton1844_06;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Directorio Acrobat ", 1813, 1954, Boton1845_06;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton184Esc_06;
     nBoton7 = FSalida;

     aEsc = &255 + "806";
     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "828";
     aF7 = &255 + "829";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         nTecla = 0;
         |SI aTecla = aEsc;               |SAL;  |FINSI;

         |SI aTecla = aF2; nTecla = 5; eaModoImpre = "I"; |SAL; |FINSI;
         |SI aTecla = aF3; nTecla = 6; eaModoImpre = "P"; |SAL; |FINSI;
         |SI aTecla = aF4;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 4;   |SAL;  |FINSI;
         |SI aTecla = aF6;  |HAZ Acrobat;        |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;

     |SI nTecla = 5; |O nTecla = 6;
        aTercera = "N";
        aAlfa = "    " + &191 + " Desea emitir una tercera copia del modelo ? ";
        |CONFI aAlfa;
        |SI FSalida = 0; aTercera = "S"; |FINSI;
     |FINSI;
     |PULSATECLA;
|FPRC;

|PROCESO Boton1841;
   |PTEC 824;
|FPRC;

|PROCESO Boton1842;
   |PTEC 825;
|FPRC;

|PROCESO Boton1843;
   |PTEC 806;
|FPRC;

|PROCESO Botones184;
     |BLANCO 0501 2380;

||     |CONTROL_SIMPLE 0, "LBOTON, <F2> Soporte Magnetico Individual ", 0813, 1054, Boton1841;
||     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Internet Individual ", 1013, 1254, Boton1841;
     nBoton1 = FSalida;

||     |CONTROL_SIMPLE 0, "LBOTON, <F4> Soporte Magnetico Colectivo ", 1513, 1654, Boton1843;
||     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Internet Colectivo ", 1413, 1654, Boton1842;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1843;
     nBoton3 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF6;  nTecla = 0;   |SAL;  |FINSI;

         |SI aTecla = aF2;  nTecla = 2;   |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 4;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;
|FPRC;

|PROCESO Modelo2005;
     enCambiaMoneda = 1;
     enSwTrata      = 0;
     nTecla         = 0;
     fFecha         = #dsmoy000#7;
     fFecha         = fFecha % 2;
     aAlfa          = fFecha;
     eaFecha        = aAlfa % 1199;

     |SI eaParametro ! "184C";
       |HAZ Botones184;
     |SINO;
       nTecla = 5;
     |FINSI;

     |SI nTecla = 0;  enInfComp = 1;  |ACABA;  |FINSI;
     |SI nTecla = 5;  enInfComp = 1;  |FINSI;

     nPortada = 0;

     |SI nTecla = 5;
       || informe de comprobacion
       |IMPRE 0;
       |SI FSalida = 0;
            |SI #dsmoy000#6 ] 2010;
                |INFOR "dsmoy184";
            |SINO;
                |INFOR "dsmor184";
            |FINSI;
            |BUCLE InformeComp;
            |FININF;
       |FINSI;
       |FINIMP;
       |ACABA;
     |FINSI;

     |SI nTecla = 3;  |O nTecla = 4;
        nSwLee   = 1; nNumDecl = 0;
        |BUCLE dsmow014C184;
     |FINSI;

     nSwLee = 0;
     |SI #dsmoy000#8 = "C";
        |BUCLE dsmow014C184;
     |SINO;
        |BUCLE dsmow014N184;
     |FINSI;

     |SI nPortada = 1;
        |FINIMP;
     |FINSI;

     |SI nTecla = 3;  |O nTecla = 4;
        |XCIERRA nHandle;

        eaFOrigen  = eaPathEmision  + "184" + (("00000" + #dsmow014#0) % -105) + ".seq";
        eaFDestino = eaPathInternet + "184" + (("00000" + #dsmow014#0) % -105) + ".seq";
        |HAZ CopiaFichero;
     |FINSI;

     |SI nTecla = 3;
        |MENAV "     Introduzca un diskette vacio en la disketera de su PC.";
        |MENAV "     Pulse una tecla si el diskette esta preparado";

        aOrigen  = eaFDestino;
        aDestino = "a:/18400000.seq";
        |RCOPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |SI nTecla = 2;  |O nTecla = 4;
        aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
        |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO Modelo2006;
     |SI eaParametro ! "184C";
        |HAZ Botones184Del2006;
     |SINO;
        nTecla = 4;
     |FINSI;

        |SI nTecla = 4; || informe de comprobacion
           |IMPRE 0;
           |SI FSalida = 0;
               |SI #dsmoy000#6 ] 2010;
                   |INFOR "dsmoy184";
               |SINO;
                   |INFOR "dsmor184";
               |FINSI;
               |BUCLE InformeComp;
               |FININF;
           |FINSI;
           |FINIMP;
           enInfComp = 1;
           |ACABA;
        |FINSI;

     |SI nTecla = 0;  enInfComp = 1;  |ACABA;  |FINSI;

     |SI nTecla = 4;
        nSwLee   = 1; nNumDecl = 0;
        |BUCLE dsmow014C184;
     |FINSI;

     |SI nTecla ! 5;
        nSwLee = 0;
        |SI #dsmoy000#8 = "C";
           |BUCLE dsmow014C184;
        |SINO;
           |BUCLE dsmow014N184;
        |FINSI;
     |SINO;
        |BUCLE dsmow014C184;
     |FINSI;

     |SI nTecla = 2;
        enInternet = 1;
        enValidacion = 0;
     |SINO;
        enValidacion = 0;
        enInternet = 0;
     |FINSI;

     eaFichError = "opc";
     eaFichDatos = "opa";
     eaFichAuxil = "opb";

     |HAZ BuscaErroresL;

     |SI nTecla = 2;
        nSwError = 0;
        aAlfa = eaPathLanza + "/opa*.txt";
        |R_PDIR aAlfa;
        |PARA; |SI FSalida = 0; |HACIENDO;
           aOrigen = aAlfa;
           aAlfa1 = aAlfa % -112;
           aDestino = eaPathInternet + aAlfa1;
           |RCOPIA_FICHERO aOrigen, aDestino;
           |RFBORRA aAlfa;
           nSwError = 1; |R_SDIR aAlfa;
        |SIGUE;

        |SI nSwError = 1;
           aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
           |MENAV aAlfa;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Portal184_2012;
     #dsm18401#0  = #dsmow014#0;
     #dsm18401#1  = #dsmow014#1;
     #dsm18401#2  = #dsmow014#5;
     #dsm18401#3  = #dsmow014#7;
     |LEE 040#dsm18401.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     eaFicheroPlano = "184" + (("00000" + #dsmow014#0) % -105) + ".txt";
     eaFicheroImpre = "184" + (("00000" + #dsmow014#0) % -105) + ".imp";
     eaFicheroSalid = "184" + (("00000" + #dsmow014#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #dsmow014#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle;

     nNumSocsDec = 0;
     nNumSocs = 0; |BUCLE CuentaSocios;

     |DDEFECTO #dsmow565;        ||Declarante
     #dsmow565#0 = #dsm18401#0;
     #dsmow565#3 = #dsm18401#1;
     aAlfa  = #dsm18401#8; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 9)) % 0109;  #dsmow565#4 = aAlfa;
     aAlfa  = #dsm18401#9; |QBF aAlfa;
     aAlfa  = (aAlfa + (" " * 40)) % 0140; #dsmow565#5 = aAlfa;

     |SI eaOpcion = "3";
         #dsmow565#6 = "T";
     |SINO;
         #dsmow565#6 = "P";
     |FINSI;

     nNume = #dsm18401#16;
     aAlfa = ("000000000" + nNume) % -109; #dsmow565#7 = aAlfa;
     aAlfa = #dsm18401#55; |QBF aAlfa;
     aAlfa = (aAlfa + (" " * 50)) % 0150; #dsmow565#8 = aAlfa;

     #dsmow565#9 = "1840000000000";
     |SI #dsm18401#3 = 0;
         #dsmow565#10 = " ";
         #dsmow565#11 = " ";
         #dsmow565#12 = "0000000000000";
     |SINO;
         |SI #dsm18401#5 = "C";
             #dsmow565#10 = "C";
             #dsmow565#11 = " ";
             ||#dsmow565#12 = "0000000000000";

             aAlfa   = "184" + (("0000000000" + #dsm18401#7) % -110);
             #dsmow565#12 = aAlfa;
         |SINO;
             #dsmow565#10 = " ";
             #dsmow565#11 = "S";
             aAlfa   = "184" + (("0000000000" + #dsm18401#7) % -110);
             #dsmow565#12 = aAlfa;
         |FINSI;
     |FINSI;

     ||aAlfa   = nNumSocs; aAlfa = (("0" * 9) + aAlfa) % -109;
     aAlfa   = nNumSocsDec; aAlfa = (("0" * 9) + aAlfa) % -109;
     #dsmow565#13 = aAlfa;
     #dsmow565#14 = #dsm18401#18;
     #dsmow565#15 = #dsm18401#19;
     #dsmow565#16 = #dsm18401#20;
     #dsmow565#17 = #dsm18401#21;
     #dsmow565#18 = #dsm18401#22;
     nCalc   = #dsm18401#23; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 5) + aAlfa) % -105;
     #dsmow565#19 = aAlfa;
     |SI #dsm18401#56 = "S";
         #dsmow565#20 = "X";
     |SINO;
         #dsmow565#20 = " ";
     |FINSI;
     nCalc   = #dsm18401#24; nCalc = nCalc * 100; aAlfa = nCalc;
     aAlfa   = (("0" * 15) + aAlfa) % -115;
     #dsmow565#21 = aAlfa;
     aAlfa   = #dsm18401#25; |QBF aAlfa;
     aAlfa   = (aAlfa + (" " * 9)) % 0109;  #dsmow565#22 = aAlfa;
     #dsmow565#23 = #dsm18401#26;

     nNumDecl = 1;
     aCadena  = "";
     |PARA nCont = 1; |SI nCont [ 24; |HACIENDO nCont = nCont + 1;
           eaAlfa  = #dsmow565#nCont#;  |HAZ QuitaRaros;
           aCadena = eaAlfa;
           |XGRABA nHandle, aCadena;
     |SIGUE;

     aCadena = " " * 250;
     |XGRABA nHandle, aCadena;

     |SI #dsmoy000#6 [ 2011;  |O  eaOpcion = "3";
         aCadena = &13 + &10;
         |XGRABA nHandle, aCadena;
     |FINSI;

     |HAZ CapituloA;
     |BUCLE CapituloB;
     |BUCLE CapituloC;
     |HAZ CapituloD;
     |HAZ CapituloE;
     |HAZ CapituloF;
     |HAZ CapituloG;
     |SI #dsmoy000#6 < 2015;
         |HAZ CapituloM;
     |FINSI;
     |HAZ CapituloH;
     |HAZ CapituloI;
     |HAZ CapituloJ;
     |HAZ CapituloK;
     |BUCLE CapituloL;
     |BUCLE RegistroSoc;

     |XCIERRA nHandle;

     enEmpresa    = #dsmow014#0;
     eaNomEmpresa = #dsmow014#3;

     |HAZ PresentaPortal;
|FPRC;

|DEFBUCLE dsmow014C184_2012;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, Portal184_2012;
|FIN;

|DEFBUCLE dsmow014N184_2012;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, Portal184_2012;
|FIN;

|PROCESO Modelo2012;
     |HAZ BtnAnuales2012;

     |SI eaOpcion = "0";  enInfComp = 1;  |ACABA;  |FINSI;

     nTecla = 1;

     |ABRE #dsm18401;
     |ABRE #dsmom004;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C184_2012;
     |SINO;
         |BUCLE dsmow014N184_2012;
     |FINSI;
     |CIERRA #dsm18401;
     |CIERRA #dsmom004;

     |SI eaOpcion = "3";
         |HAZ SacaErrorPtl;

         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Modelo2015;
     |HAZ BtnAnuales2015;

     |SI eaOpcion = "0";  enInfComp = 1;  |ACABA;  |FINSI;

     nTecla = 1;

     |ABRE #dsm18401;
     |ABRE #dsmom004;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C184_2012;
     |SINO;
         |BUCLE dsmow014N184_2012;
     |FINSI;
     |CIERRA #dsm18401;
     |CIERRA #dsmom004;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #dsmoy000#aFichero#;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #dsmow014#aFichero#;

     |ABRE #dsmoy000;
     |LEE 000#dsmoy000.p;
     |CIERRA #dsmoy000;

     |SI #dsmoy000#6 [ 2005;
         |HAZ Modelo2005;
     |FINSI;

     |SI #dsmoy000#6 ] 2006;   |Y  #dsmoy000#6 [ 2011;
         |HAZ Modelo2006;
     |FINSI;

     |SI #dsmoy000#6 ] 2012;
         |SI eaParametro = "184C";
             |HAZ Modelo2006;
             |ACABA;
         |FINSI;

         |SI #dsmoy000#6 [ 2014;  |HAZ Modelo2012;  |FINSI;
         |SI #dsmoy000#6 = 2015;  |HAZ Modelo2015;  |FINSI;
         |SI #dsmoy000#6 ] 2016;  |HAZ Modelo2016;  |FINSI;
     |FINSI;
|FPRO;
