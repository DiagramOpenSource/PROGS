|FICHEROS;
     dsmoy000;
     dsmom001;
     dsmom002;
     dsmom004;
     dsmom025;
     dsmom107;

     dsm190ca #190;
     dsm190li;
     dsm19001;

     dsmow014;
     dsmow016;
     dsmow523;
     dsmow525;
     dsmow526;
     dsmow527;
     dsmow596;
     dsmow597;

     :/basica/def/agim0024;
     :/basica/def/agim0026;

     &clientes@;
|FIN;

|VARIABLES;
     nSwCara        = 0;
     aImprime       = "";
     aNombre        = "";
     aPathAfegir    = "";
     aIPRemoto      = "";
     aBue           = "";
     aExtra         = "";
     aJusti         = "";
     &eaMail        = "";
     &enTipoEntrada = 0;
|FIN;

|INCLUYE i_varemi;

|PROCESO Registro190_1;
     enCodCli = #dsm190ca#0;
     |HAZ LeePersona;

     |DDEFECTO #dsmow523;

     #dsmow523#0  = "1";

     #dsmow523#1  = "190";

     #dsmow523#2  = #dsm190ca#1;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow523#3   = eaVarDni;

         eaAlfa   = #clientes@#1;  |HAZ QuitaRaros;
         #dsmow523#4   = eaAlfa;

         eaAlfa   = #clientes@#1;  enLinea = 2;  |HAZ LeeTelefono;  |QBF eaAlfa;
         |SI eaAlfa = "";
             eaAlfa   = #clientes@#1;  enLinea = 1;  |HAZ LeeTelefono;
         |FINSI;
         |HAZ QuitaRarosTfno;
         #dsmow523#6   = eaAlfa;

         eaAlfa   = #clientes@#1;  enLinea = 1;  |HAZ LeeMail;  |QBF eaAlfa;
         eaMail   = eaAlfa;

         eaAlfa   = #clientes@#53;  |HAZ QuitaRaros;
         #dsmow523#7   = eaAlfa;

         eaDeleg     = #clientes@#17;
         eaAdmin     = #clientes@#18;
         eaProvincia = #clientes@#38;
     |SINO;
         aAlfa = #clientes@#96; |QBF aAlfa; |SI aAlfa = ""; #clientes@#96 = #clientes@#2; |FINSI;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow523#3   = eaVarDni;

         eaAlfa   = #clientes@#1;   |HAZ QuitaRaros;
         #dsmow523#4   = eaAlfa;

         eaAlfa   = #clientes@#14;  |HAZ QuitaRarosTfno;
         #dsmow523#6   = eaAlfa;

         eaAlfa   = #clientes@#96;   |HAZ QuitaRaros;
         #dsmow523#7   = eaAlfa;

         eaDeleg     = #clientes@#91;
         eaAdmin     = #clientes@#92;
         eaProvincia = #clientes@#12;
     |FINSI;

     |SI #dsmoy000#6 [ 2003;
         #dsmow523#5  = "D";
     |SINO;
         #dsmow523#5  = "T";
     |FINSI;

     |SI #dsmoy000#6 [ 2006;
         #dsmow523#8  = "1700000000000";
     |SINO;
         #dsmow523#8  = "1900000000000";
     |FINSI;

     nNume   = #dsm190ca#6;
     #dsmow523#12 = ("000000000" + nNume) % -109;

     enNume  = #dsm190ca#7;  |HAZ Conver15Signo;
     #dsmow523#13 = eaSigno;
     #dsmow523#14 = eaAlfa;

     enNume  = #dsm190ca#8;  |HAZ Conver15Signo;
     #dsmow523#15 = eaAlfa;

     |SI #dsm190ca#10 = "C";
         #dsmow523#9  = "C";
         #dsmow523#11 = #dsm190ca#9;
     |FINSI;

     |SI #dsm190ca#10 = "S";
         #dsmow523#10 = "S";
         #dsmow523#11 = #dsm190ca#9;
     |FINSI;

     #dsmow523#17 = &13 + &10;

     |SI nTecla ! 2;  |Y nTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ 17;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow523#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         nTRegistro = nTRegistro + 1;
     |FINSI;
|FPRC;

|PROCESO CogeNumeroJusti;
     |SI #dsm190ca#11 = "N";
         aJusti = "1900000000000";
         |ACABA;
     |FINSI;

     aCadena = "";
     aLong   = eaVarDni % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos      = (100 * nCampo) + 1;
           aCaracter = eaVarDni % nPos;

           |SI aCaracter = "0";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "1";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "2";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "3";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "4";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "5";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "6";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "7";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "8";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "9";  aCadena = aCadena + aCaracter;  |FINSI;
     |SIGUE;

     aAlfa1  = #dsm190ca#1;
     aAlfa2  = #dsm190ca#4;
     aCadena = ((aCadena + "0000000") % 107) + (aAlfa1 % -102) + (("00" + aAlfa2) % -101);

     aJusti  = "190" + aCadena;
|FPRC;

|PROCESO Registro190_1_2009;
     enCodCli = #dsm190ca#0;
     |HAZ LeePersona;

     |DDEFECTO #dsmow596;

     #dsmow596#0  = "1";

     #dsmow596#1  = "190";

     #dsmow596#2  = #dsm190ca#1;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow596#3   = eaVarDni;

         eaAlfa   = #clientes@#1;  |HAZ QuitaRaros;
         #dsmow596#4   = eaAlfa;

         eaAlfa   = #clientes@#1;  enLinea = 2;  |HAZ LeeTelefono;  |QBF eaAlfa;
         |SI eaAlfa = "";
             eaAlfa   = #clientes@#1;  enLinea = 1;  |HAZ LeeTelefono;
         |FINSI;
         |HAZ QuitaRarosTfno;
         #dsmow596#6   = eaAlfa;

         eaAlfa   = #clientes@#53;  |HAZ QuitaRaros;
         #dsmow596#7   = eaAlfa;

         eaDeleg     = #clientes@#17;
         eaAdmin     = #clientes@#18;
         eaProvincia = #clientes@#38;
     |SINO;
         aAlfa = #clientes@#96; |QBF aAlfa; |SI aAlfa = ""; #clientes@#96 = #clientes@#2; |FINSI;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow596#3   = eaVarDni;

         eaAlfa   = #clientes@#1;   |HAZ QuitaRaros;
         #dsmow596#4   = eaAlfa;

         eaAlfa   = #clientes@#14;  |HAZ QuitaRarosTfno;
         #dsmow596#6   = eaAlfa;

         eaAlfa   = #clientes@#96;   |HAZ QuitaRaros;   || Persona de Contacto
         #dsmow596#7   = eaAlfa;

         eaDeleg     = #clientes@#91;
         eaAdmin     = #clientes@#92;
         eaProvincia = #clientes@#12;
     |FINSI;

     #dsmow596#5  = "T";

     |HAZ CogeNumeroJusti;
     #dsmow596#8  = aJusti;

     nNume   = #dsm190ca#6;
     #dsmow596#12 = ("000000000" + nNume) % -109;

     enNume  = #dsm190ca#7;  |HAZ Conver15Signo;
     #dsmow596#13 = eaSigno;
     #dsmow596#14 = eaAlfa;

     enNume  = #dsm190ca#8;  |HAZ Conver15Signo;
     #dsmow596#15 = eaAlfa;

     |SI #dsm190ca#10 = "C";
         #dsmow596#9  = "C";
         #dsmow596#11 = #dsm190ca#9;
     |FINSI;

     |SI #dsm190ca#10 = "S";
         #dsmow596#10 = "S";
         #dsmow596#11 = #dsm190ca#9;
     |FINSI;

     #dsmow596#18 = &13 + &10;

     nHCampo = 18;
     |SI #dsmoy000#6 ] 2012;  |Y eaOpcion ! "3";
         nHCampo = 17;
     |FINSI;

     |SI nTecla ! 2;  |Y nTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow596#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         nTRegistro = nTRegistro + 1;
     |FINSI;
|FPRC;

|PROCESO Registro190_2_2002;
     enCodCli = #dsm190ca#0;
     |HAZ LeePersona;

     |DDEFECTO #dsmow526;

     #dsmow526#0  = "2";

     #dsmow526#1  = "190";

     #dsmow526#2  = #dsm190ca#1;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow526#3   = eaVarDni;
     |SINO;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow526#3   = eaVarDni;
     |FINSI;

     |ABRE #dsmom025;
     #dsmom025#0 = #dsm190li#6;
     |LEE 040#dsmom025.=;
     |SI FSalida = 0;
         #dsmow526#4 = #dsmom025#2;
     |SINO;
         aAlfa    = #dsm190li#6;  |QBF aAlfa;
         aLong    = aAlfa % 0;
         nLong    = aLong;
         aExtra   = aAlfa % 101;

         |SI nLong > 9;  |Y aExtra = "X";
             aAlfa = (aAlfa % 101) + (aAlfa % 308);
             |SI #dsm190li#11 = "N";
                 #dsmow526#4 = aAlfa;
             |SINO;
                 #dsmow526#5 = aAlfa;
             |FINSI;
         |SINO;
             eaVarDni = #dsm190li#6;  |HAZ CalculameDNI;
             |SI #dsm190li#11 = "N";
                 #dsmow526#4 = eaVarDni;
             |SINO;
                 #dsmow526#5 = eaVarDni;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom025;

     eaAlfa = #dsm190li#12;  |HAZ QuitaRaros;
     #dsmow526#6 = eaAlfa;

     #dsmow526#7 = ("00" + #dsm190li#13) % -102;
     #dsmow526#8 = #dsm190li#8;
     aAlfa  = #dsm190li#9;  |QBF aAlfa;
     #dsmow526#9 = ("00" + aAlfa) % -102;

     enNume  = #dsm190li#16;  |HAZ Conver13Signo;
     #dsmow526#10 = eaSigno;
     #dsmow526#11 = eaAlfa;

     enNume  = #dsm190li#17;  |HAZ Conver13Signo;
     #dsmow526#12 = eaAlfa;

     enNume  = #dsm190li#18;  |HAZ Conver13Signo;
     #dsmow526#13 = eaSigno;
     #dsmow526#14 = eaAlfa;

     enNume  = #dsm190li#19;  |HAZ Conver13Signo;
     #dsmow526#15 = eaAlfa;

     enNume  = #dsm190li#20;  |HAZ Conver13Signo;
     #dsmow526#16 = eaAlfa;

     #dsmow526#17 = ("0000" + #dsm190li#7) % -104;

     #dsmow526#18 = #dsm190li#15;

     #dsmow526#19 = #dsm190li#10;

     #dsmow526#20 = ("0000" + #dsm190li#14) % -104;

     #dsmow526#21 = #dsm190li#25;

     #dsmow526#22 = #dsm190li#26;

     eaVarDni = #dsm190li#27;  |HAZ CalculameDNI;
     #dsmow526#23  = eaVarDni;

     #dsmow526#24 = ("00" + #dsm190li#29) % -102;

     #dsmow526#25 = ("00" + #dsm190li#30) % -102;

     #dsmow526#26 = ("00" + #dsm190li#31) % -102;

     #dsmow526#27 = ("00" + #dsm190li#32) % -102;

     #dsmow526#28 = ("00" + #dsm190li#33) % -102;

     #dsmow526#29 = ("00" + #dsm190li#34) % -102;

     enNume  = #dsm190li#21;  |HAZ Conver13;
     #dsmow526#30 = eaAlfa;

     enNume  = #dsm190li#22;  |HAZ Conver13;
     #dsmow526#31 = eaAlfa;

     enNume  = #dsm190li#23;  |HAZ Conver13;
     #dsmow526#32 = eaAlfa;

     enNume  = #dsm190li#24;  |HAZ Conver13;
     #dsmow526#33 = eaAlfa;

     #dsmow526#34 = ("00" + #dsm190li#28) % -102;

     #dsmow526#35 = ("0" + #dsm190li#38) % -101;

     #dsmow526#36 = ("0" + #dsm190li#35) % -101;

     #dsmow526#37 = ("0" + #dsm190li#36) % -101;

     #dsmow526#38 = ("0" + #dsm190li#37) % -101;

     #dsmow526#40 = &13 + &10;

     |SI nTecla ! 2;  |Y nTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ 40;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow526#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         nTRegistro = nTRegistro + 1;
     |SINO;
         |SI nTecla ! 5;
             nContador = nContador + 1;
             nSwPrint = 1;
             |SI nContador > 5;  nContador = 1;  |PIEINF;  |FINSI;
         |FINSI;

         |PRINT;
     |FINSI;
|FPRC;

|PROCESO Registro190_2_2003;
     enCodCli = #dsm190ca#0;
     |HAZ LeePersona;

     |DDEFECTO #dsmow527;

     #dsmow527#0  = "2";

     #dsmow527#1  = "190";

     #dsmow527#2  = #dsm190ca#1;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow527#3   = eaVarDni;
     |SINO;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow527#3   = eaVarDni;
     |FINSI;

     |ABRE #dsmom025;
     #dsmom025#0 = #dsm190li#6;
     |LEE 040#dsmom025.=;
     |SI FSalida = 0;
         #dsmow527#4 = #dsmom025#2;
     |SINO;
         aAlfa    = #dsm190li#6;  |QBF aAlfa;
         aLong    = aAlfa % 0;
         nLong    = aLong;
         aExtra   = aAlfa % 101;

         |SI nLong > 9;  |Y aExtra = "X";
             aAlfa = (aAlfa % 101) + (aAlfa % 308);
             |SI #dsm190li#11 = "N";
                 #dsmow527#4 = aAlfa;
             |SINO;
                 #dsmow527#5 = aAlfa;
             |FINSI;
         |SINO;
             eaVarDni = #dsm190li#6;  |HAZ CalculameDNI;
             |SI #dsm190li#11 = "N";
                 #dsmow527#4 = eaVarDni;
             |SINO;
                 #dsmow527#5 = eaVarDni;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom025;

     eaAlfa = #dsm190li#12;  |HAZ QuitaRaros;
     #dsmow527#6 = eaAlfa;

     #dsmow527#7 = ("00" + #dsm190li#13) % -102;
     #dsmow527#8 = #dsm190li#8;

     |SI #dsm190li#8 = "K";
         |SI #dsmoy000#6 ] 2007;  |Y #dsm190li#9 = "  ";
             #dsm190li#9 = "01";
         |FINSI;
     |FINSI;

     |SI #dsm190li#8 = "N";
         #dsm190li#8 = "K";
         #dsm190li#9 = "02";
     |FINSI;

     |SI #dsm190li#8 = "I";
         |SI #dsmoy000#6 ] 2004;  |Y #dsm190li#9 = "  ";
             #dsm190li#9 = "02";
         |FINSI;
     |FINSI;

     aAlfa  = #dsm190li#9;  |QBF aAlfa;
     #dsmow527#9 = ("00" + aAlfa) % -102;

     enNume  = #dsm190li#16;  |HAZ Conver13Signo;
     #dsmow527#10 = eaSigno;
     #dsmow527#11 = eaAlfa;

     enNume  = #dsm190li#17;  |HAZ Conver13Signo;
     #dsmow527#12 = eaAlfa;

     enNume  = #dsm190li#18;  |HAZ Conver13Signo;
     #dsmow527#13 = eaSigno;
     #dsmow527#14 = eaAlfa;

     enNume  = #dsm190li#19;  |HAZ Conver13Signo;
     #dsmow527#15 = eaAlfa;

     enNume  = #dsm190li#20;  |HAZ Conver13Signo;
     #dsmow527#16 = eaAlfa;

     #dsmow527#17 = ("0000" + #dsm190li#7) % -104;

     #dsmow527#18 = #dsm190li#15;

     #dsmow527#19 = ("0000" + #dsm190li#14) % -104;

     #dsmow527#20 = #dsm190li#26;

     eaVarDni = #dsm190li#27;  |HAZ CalculameDNI;
     #dsmow527#21  = eaVarDni;

     #dsmow527#22 = #dsm190li#25;

     #dsmow527#23 = #dsm190li#10;

     #dsmow527#24 = "0";
     #dsmow527#25 = "0";
     |SI #dsm190li#39 = "S";  #dsmow527#24 = "1";  |FINSI;
     |SI #dsm190li#40 = "S";  #dsmow527#25 = "1";  |FINSI;

     enNume  = #dsm190li#21;  |HAZ Conver13;
     #dsmow527#26 = eaAlfa;

     enNume  = #dsm190li#22;  |HAZ Conver13;
     #dsmow527#27 = eaAlfa;

     enNume  = #dsm190li#23;  |HAZ Conver13;
     #dsmow527#28 = eaAlfa;

     enNume  = #dsm190li#24;  |HAZ Conver13;
     #dsmow527#29 = eaAlfa;

     #dsmow527#30 = ("0"  + #dsm190li#41) % -101;
     #dsmow527#31 = ("0"  + #dsm190li#42) % -101;
     #dsmow527#32 = ("00" + #dsm190li#43) % -102;
     #dsmow527#33 = ("00" + #dsm190li#44) % -102;
     #dsmow527#34 = ("00" + #dsm190li#45) % -102;
     #dsmow527#35 = ("00" + #dsm190li#46) % -102;
     #dsmow527#36 = ("00" + #dsm190li#47) % -102;
     #dsmow527#37 = ("00" + #dsm190li#48) % -102;
     #dsmow527#38 = ("00" + #dsm190li#49) % -102;
     #dsmow527#39 = ("00" + #dsm190li#50) % -102;

     #dsmow527#40 = ("0"  + #dsm190li#51) % -101;
     #dsmow527#41 = ("0"  + #dsm190li#52) % -101;
     #dsmow527#42 = ("0"  + #dsm190li#53) % -101;
     #dsmow527#43 = ("0"  + #dsm190li#54) % -101;
     #dsmow527#44 = ("0"  + #dsm190li#55) % -101;
     #dsmow527#45 = ("0"  + #dsm190li#56) % -101;
     #dsmow527#46 = ("0"  + #dsm190li#57) % -101;
     #dsmow527#47 = ("0"  + #dsm190li#58) % -101;
     #dsmow527#48 = ("0"  + #dsm190li#59) % -101;
     #dsmow527#49 = ("0"  + #dsm190li#60) % -101;

     #dsmow527#50 = &13 + &10;

     |SI nTecla ! 2;  |Y nTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow527#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         nTRegistro = nTRegistro + 1;
     |SINO;
         |SI nTecla ! 5;
             nContador = nContador + 1;
             nSwPrint = 1;
             |SI nContador > 5;  nContador = 1;  |PIEINF;  |FINSI;
         |FINSI;

         |PRINT;
     |FINSI;
|FPRC;

|PROCESO Registro190_2_2009;
     enCodCli = #dsm190ca#0;
     |HAZ LeePersona;

     |DDEFECTO #dsmow597;

     #dsmow597#0  = "2";

     #dsmow597#1  = "190";

     #dsmow597#2  = #dsm190ca#1;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow597#3   = eaVarDni;
     |SINO;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow597#3   = eaVarDni;
     |FINSI;

     |ABRE #dsmom025;
     #dsmom025#0 = #dsm190li#6;
     |LEE 040#dsmom025.=;
     |SI FSalida = 0;
         #dsmow597#4 = #dsmom025#2;
     |SINO;
         aAlfa    = #dsm190li#6;  |QBF aAlfa;
         aLong    = aAlfa % 0;
         nLong    = aLong;
         aExtra   = aAlfa % 101;

         |SI nLong > 9;  |Y aExtra = "X";
             aAlfa = (aAlfa % 101) + (aAlfa % 308);
             |SI #dsm190li#11 = "N";
                 #dsmow597#4 = aAlfa;
             |SINO;
                 #dsmow597#5 = aAlfa;
             |FINSI;
         |SINO;
             eaVarDni = #dsm190li#6;  |HAZ CalculameDNI;
             |SI #dsm190li#11 = "N";
                 #dsmow597#4 = eaVarDni;
             |SINO;
                 #dsmow597#5 = eaVarDni;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom025;

     eaAlfa = #dsm190li#12;  |HAZ QuitaRaros;
     #dsmow597#6 = eaAlfa;

     #dsmow597#7 = ("00" + #dsm190li#13) % -102;
     #dsmow597#8 = #dsm190li#8;

     |SI #dsm190li#8 = "K";
         |SI #dsm190li#9 = "  ";
             #dsm190li#9 = "01";
         |FINSI;
     |FINSI;

     |SI #dsm190li#8 = "N";
         #dsm190li#8 = "K";
         #dsm190li#9 = "02";
     |FINSI;

     |SI #dsm190li#8 = "I";
         |SI #dsm190li#9 = "  ";
             #dsm190li#9 = "02";
         |FINSI;
     |FINSI;

     aAlfa  = #dsm190li#9;  |QBF aAlfa;
     #dsmow597#9 = ("00" + aAlfa) % -102;

     enNume  = #dsm190li#16;  |HAZ Conver13Signo;
     #dsmow597#10 = eaSigno;
     #dsmow597#11 = eaAlfa;

     enNume  = #dsm190li#17;  |HAZ Conver13Signo;
     #dsmow597#12 = eaAlfa;

     enNume  = #dsm190li#18;  |HAZ Conver13Signo;
     #dsmow597#13 = eaSigno;
     #dsmow597#14 = eaAlfa;

     enNume  = #dsm190li#19;  |HAZ Conver13Signo;
     #dsmow597#15 = eaAlfa;

     enNume  = #dsm190li#20;  |HAZ Conver13Signo;
     #dsmow597#16 = eaAlfa;

     #dsmow597#17 = ("0000" + #dsm190li#7) % -104;

     #dsmow597#18 = #dsm190li#15;

     #dsmow597#19 = ("0000" + #dsm190li#14) % -104;

     #dsmow597#20 = #dsm190li#26;

     eaVarDni = #dsm190li#27;  |HAZ CalculameDNI;
     #dsmow597#21  = eaVarDni;

     #dsmow597#22 = #dsm190li#25;

     #dsmow597#23 = #dsm190li#10;

     |SI #dsm190li#1 < 2015;
         #dsmow597#24 = "0";
         #dsmow597#25 = "0";
         |SI #dsm190li#39 = "S";  #dsmow597#24 = "1";  |FINSI;
         |SI #dsm190li#40 = "S";  #dsmow597#25 = "1";  |FINSI;
     |FINSI;

     |SI #dsm190li#1 ] 2015;
         #dsmow597#24 = " ";
         #dsmow597#25 = "0";
         |SI #dsm190li#65 = "S";  #dsmow597#24 = "X";  |FINSI;
         |SI #dsm190li#40 = "S";  #dsmow597#25 = "1";  |FINSI;
     |FINSI;

     enNume  = #dsm190li#21;  |HAZ Conver13;
     #dsmow597#26 = eaAlfa;

     enNume  = #dsm190li#22;  |HAZ Conver13;
     #dsmow597#27 = eaAlfa;

     enNume  = #dsm190li#23;  |HAZ Conver13;
     #dsmow597#28 = eaAlfa;

     enNume  = #dsm190li#24;  |HAZ Conver13;
     #dsmow597#29 = eaAlfa;

     #dsmow597#30 = ("0"  + #dsm190li#41) % -101;
     #dsmow597#31 = ("0"  + #dsm190li#42) % -101;
     #dsmow597#32 = ("00" + #dsm190li#43) % -102;
     #dsmow597#33 = ("00" + #dsm190li#44) % -102;
     #dsmow597#34 = ("00" + #dsm190li#45) % -102;
     #dsmow597#35 = ("00" + #dsm190li#46) % -102;
     #dsmow597#36 = ("00" + #dsm190li#47) % -102;
     #dsmow597#37 = ("00" + #dsm190li#48) % -102;
     #dsmow597#38 = ("00" + #dsm190li#49) % -102;
     #dsmow597#39 = ("00" + #dsm190li#50) % -102;

     #dsmow597#40 = ("0"  + #dsm190li#51) % -101;
     #dsmow597#41 = ("0"  + #dsm190li#52) % -101;
     #dsmow597#42 = ("0"  + #dsm190li#53) % -101;
     #dsmow597#43 = ("0"  + #dsm190li#54) % -101;
     #dsmow597#44 = ("0"  + #dsm190li#55) % -101;
     #dsmow597#45 = ("0"  + #dsm190li#56) % -101;
     #dsmow597#46 = ("0"  + #dsm190li#57) % -101;
     #dsmow597#47 = ("0"  + #dsm190li#58) % -101;
     #dsmow597#48 = ("0"  + #dsm190li#59) % -101;
     #dsmow597#49 = ("0"  + #dsm190li#60) % -101;
     #dsmow597#50 = #dsm190li#61;
     #dsmow597#51 = #dsm190li#62;
     #dsmow597#52 = #dsm190li#63;
     #dsmow597#53 = #dsm190li#64;

     #dsmow597#55 = &13 + &10;

     |SI #dsmow597#8 ! "A";  |Y #dsmow597#8 ! "B";  |Y #dsmow597#8 ! "C"; |Y #dsmow597#8 ! "D";
         #dsmow597#19 = "0000";
         #dsmow597#20 = "0";
         #dsmow597#21 = "         ";
         #dsmow597#22 = "0";
         #dsmow597#23 = "0";
         #dsmow597#24 = "0";
         |SI #dsm190li#1 ] 2015;
             #dsmow597#24 = " ";
         |FINSI;
         #dsmow597#25 = "0";
         #dsmow597#26 = "0000000000000";
         #dsmow597#27 = "0000000000000";
         #dsmow597#28 = "0000000000000";
         #dsmow597#29 = "0000000000000";
         #dsmow597#30 = "0";
         #dsmow597#31 = "0";
         #dsmow597#32 = "00";
         #dsmow597#33 = "00";
         #dsmow597#34 = "00";
         #dsmow597#35 = "00";
         #dsmow597#36 = "00";
         #dsmow597#37 = "00";
         #dsmow597#38 = "00";
         #dsmow597#39 = "00";
         #dsmow597#40 = "0";
         #dsmow597#41 = "0";
         #dsmow597#42 = "0";
         #dsmow597#43 = "0";
         #dsmow597#44 = "0";
         #dsmow597#45 = "0";
         #dsmow597#46 = "0";
         #dsmow597#47 = "0";
         #dsmow597#48 = "0";
         #dsmow597#49 = "0";
         #dsmow597#50 = "0";
         #dsmow597#51 = "0";
         #dsmow597#52 = "0";
         #dsmow597#53 = "0";
     |FINSI;

     nHCampo = 55;
     |SI #dsmoy000#6 ] 2012;  |Y eaOpcion ! "3";
         nHCampo = 54;
     |FINSI;

     |SI nTecla ! 2;  |Y nTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
               aAlfa = #dsmow597#nCampo#;
               |XGRABA nHandle2, aAlfa;
         |SIGUE;
         nTRegistro = nTRegistro + 1;
     |SINO;
         |SI nTecla ! 5;
             nContador = nContador + 1;
             nSwPrint = 1;
             |SI nContador > 5;  nContador = 1;  |PIEINF;  |FINSI;
         |FINSI;

         |PRINT;
     |FINSI;
|FPRC;

|PROCESO BuscaCargo190;
     eaAlfa  = #agim0026#4;  |HAZ QuitaRaros;
     #dsmow525#13 = eaAlfa;

     eaAlfa  = #agim0026#17;  |HAZ QuitaRaros;
     #dsmow525#14 = eaAlfa;
|FPRC;

|DEFBUCLE agim0026;
     #agim0026#1;
     16;
     #dsm190ca#0, 01, 01, 3;
     #dsm190ca#0, 99, 99, 3;
     ;
     NULL, BuscaCargo190;
|FIN;

|PROCESO BuscaCargo190R;
     |SI #agim0024#15 ! "A";
         eaAlfa  = #agim0024#4;  |HAZ QuitaRaros;
         #dsmow525#13 = eaAlfa;

         eaAlfa  = "REPRESENTANTE";  |HAZ QuitaRaros;
         #dsmow525#14 = eaAlfa;

         nHayRepre = 1;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#2;
     ;
     #dsm190ca#0, 99, 01;
     #dsm190ca#0, 01, 99;
     ;
     NULL, BuscaCargo190R;
|FIN;

|PROCESO BuscaComuneros190;
     aAlfa = "31.12." + #dsm190ca#1;
     |SI #dsmom001#8 > aAlfa;  |ACABA;  |FINSI;

     aAlfa = "01.01." + #dsm190ca#1;
     |SI #dsmom001#9 > "01.01.0000";
         |SI #dsmom001#9 < aAlfa;  |ACABA;  |FINSI;
     |FINSI;

     nHayRepre = 1;

     enCodCli = #dsmom001#3;
     |HAZ LeePersona;

     eaAlfa  = #clientes@#1;           |HAZ QuitaRaros;   #dsmow525#13 = eaAlfa;
     eaAlfa  = "REPRESENTANTE";  |HAZ QuitaRaros;   #dsmow525#14 = eaAlfa;

     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#1;
     ;
     #dsm190ca#0, 01, 0001;
     #dsm190ca#0, 99, 9999;
     ;
     NULL, BuscaComuneros190;
|FIN;

|PROCESO Registro190_Auxiliar0;
     |DDEFECTO #dsmow525;

     #dsmow525#0  = "0";

     #dsmow525#1  = "190";

     #dsmow525#2  = #dsm190ca#1;

     eaVarDni = #dsmow016#0;  |HAZ CalculameDNI;
     #dsmow525#3   = eaVarDni;

     #dsmow525#4   = ("00" + #dsmow016#11) % -102;

     #dsmow525#5   = ("000" + #dsmow016#12) % -103;

     #dsmow525#6   = #dsmow016#2;

     eaAlfa   = #dsmow016#3;  |HAZ QuitaRaros;
     #dsmow525#7   = eaAlfa;

     nNume    = #dsmow016#4;
     #dsmow525#8   = ("00000" + nNume) % -105;

     eaAlfa   = #dsmow016#10;  |HAZ QuitaRaros;
     #dsmow525#9   = eaAlfa;

     #dsmow525#10  = ("00" + #dsmow016#8) % -102;

     #dsmow525#11  = (("00" + #dsmow016#8) % -102) + (("000" + #dsmow016#9) % -103);

     #dsmow525#12  = (#dsmoy000#7 % -104) + (#dsmoy000#7 % 402) + (#dsmoy000#7 % 102);

     eaAlfa   = #dsmow016#15;  |HAZ QuitaRaros;
     #dsmow525#13  = eaAlfa;

     eaAlfa   = #dsmow016#16;  |HAZ QuitaRaros;
     #dsmow525#14  = eaAlfa;

     #dsmow525#16  = &13 + &10;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy000#6 = 2001;
                   |SI nCampo ! 15;
                       aAlfa = #dsmow525#nCampo#;
                       |XGRABA nHandle3, aAlfa;
                   |FINSI;
               |SINO;
                   aAlfa = #dsmow525#nCampo#;
                   |XGRABA nHandle3, aAlfa;
               |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Registro190_Auxiliar1;
     enCodCli = #dsm190ca#0;
     |HAZ LeePersona;

     |DDEFECTO #dsmow525;

     #dsmow525#0  = "1";

     #dsmow525#1  = "190";

     #dsmow525#2  = #dsm190ca#1;

     |SI enSwDeDonde = 1;
         eaVarDni = #clientes@#3;  |HAZ CalculameDNI;
         #dsmow525#3   = eaVarDni;

         #dsmow525#4   = ("00" + #clientes@#15) % -102;

         #dsmow525#5   = ("000" + #clientes@#16) % -103;

         #dsmow525#6   = #clientes@#29;

         eaAlfa   = #clientes@#30;  |HAZ QuitaRaros;
         #dsmow525#7   = eaAlfa;

         nNume    = #clientes@#31;
         #dsmow525#8   = ("00000" + nNume) % -105;

         eaAlfa   = #clientes@#37;  |HAZ QuitaRaros;
         #dsmow525#9   = eaAlfa;

         #dsmow525#10  = ("00" + #clientes@#35) % -102;

         #dsmow525#11  = (("00" + #clientes@#35) % -102) + (("000" + #clientes@#36) % -103);
     |SINO;
         eaVarDni = #clientes@#13;  |HAZ CalculameDNI;
         #dsmow525#3   = eaVarDni;

         #dsmow525#4   = ("00" + #clientes@#63) % -102;

         #dsmow525#5   = ("000" + #clientes@#64) % -103;

         #dsmow525#6   = #clientes@#3;

         eaAlfa   = #clientes@#4;  |HAZ QuitaRaros;
         #dsmow525#7   = eaAlfa;

         nNume    = #clientes@#5;
         #dsmow525#8   = ("00000" + nNume) % -105;

         eaAlfa   = #clientes@#11;  |HAZ QuitaRaros;
         #dsmow525#9   = eaAlfa;

         #dsmow525#10  = ("00" + #clientes@#9) % -102;

         #dsmow525#11  = (("00" + #clientes@#9) % -102) + (("000" + #clientes@#10) % -103);
     |FINSI;

     #dsmow525#12  = (#dsmoy000#7 % -104) + (#dsmoy000#7 % 402) + (#dsmoy000#7 % 102);

     |SI nTecla ! 4;
         |SI #dsmom107#1 = "S";
             |BUCLE agim0026;
         |SINO;
             nHayRepre = 0;
             |BUCLE agim0024;
             |SI nHayRepre = 0;
                 |BUCLE dsmom001;
                 |SI nHayRepre = 0;
                     eaAlfa  = #dsmow014#3;  |HAZ QuitaRaros;
                     #dsmow525#13 = eaAlfa;

                     eaAlfa  = "TITULAR";  |HAZ QuitaRaros;
                     #dsmow525#14 = eaAlfa;
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #dsmom107#2 = "P";
             eaAlfa   = #dsmow016#15;  |HAZ QuitaRaros;
             #dsmow525#13  = eaAlfa;

             eaAlfa   = #dsmow016#16;  |HAZ QuitaRaros;
             #dsmow525#14  = eaAlfa;
         |SINO;
             nHayRepre = 0;
             |BUCLE agim0024;
             |SI nHayRepre = 0;
                 |BUCLE dsmom001;
                 |SI nHayRepre = 0;
                     eaAlfa  = #dsmow014#3;  |HAZ QuitaRaros;
                     #dsmow525#13 = eaAlfa;

                     eaAlfa  = "TITULAR";  |HAZ QuitaRaros;
                     #dsmow525#14 = eaAlfa;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #dsmow525#15 = ("00000" + #dsmow014#0) % -105;
     #dsmow525#16 = &13 + &10;

     |SI nTecla ! 2;  |Y nTecla ! 5;
         aAlfa = "";
         |PARA nCampo = 0;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #dsmoy000#6 = 2001;
                   |SI nCampo ! 15;
                       aAlfa = #dsmow525#nCampo#;
                       |XGRABA nHandle3, aAlfa;
                   |FINSI;
               |FINSI;

               |SI #dsmoy000#6 ] 2002;  |Y #dsmoy000#6 [ 2006;
                   aAlfa = #dsmow525#nCampo#;
                   |XGRABA nHandle3, aAlfa;
               |FINSI;

               |SI #dsmoy000#6 ] 2007;
                   |SI  nCampo ! 4;  |Y  nCampo ! 5;  |Y  nCampo ! 6;
                    |Y  nCampo ! 7;  |Y  nCampo ! 8;  |Y  nCampo ! 9;
                    |Y  nCampo ! 10; |Y  nCampo ! 11
                        aAlfa = #dsmow525#nCampo#;
                        |XGRABA nHandle3, aAlfa;
                    |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Registro190_2;
     |SI #dsmoy000#6 [ 2002;                   |HAZ Registro190_2_2002;  |FINSI;
     |SI #dsmoy000#6 ] 2003;  |Y #dsmoy000#6 [ 2008;  |HAZ Registro190_2_2003;  |FINSI;
     |SI #dsmoy000#6 ] 2009;                   |HAZ Registro190_2_2009;  |FINSI;

     enSinActividad = 0;
|FPRC;

|DEFBUCLE dsm190li;
 #dsm190li#1;
 ;
 #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,"            ",0000," ","  ",0;
 #190#0,#190#1,#190#2,#190#3,#190#4,#190#5,"zzzzzzzzzzzz",9999,"z","zz",4;
 ;
 NULL, Registro190_2;
|FIN;

|PROCESO Lee1900;       || Calculo Total de Declarantes y Declarados
     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsm190ca;
     #dsm190ca#0  = #dsmow014#0;
     #dsm190ca#1  = #dsmow014#1;
     #dsm190ca#2  = #dsmow014#2;
     #dsm190ca#3  = #dsmow014#5;
     #dsm190ca#4  = #dsmow014#7;
     #dsm190ca#5  = 0;
     |LEE 040#dsm190ca.=;
     |SI FSalida = 0;
         #dsmow016#17 = #dsmow016#17 + 1;
         #dsmow016#18 = #dsmow016#18 + #dsm190ca#6;
     |FINSI;
     |CIERRA #dsm190ca;
|FPRC;

|PROCESO Lee1901;        || Creacion de Ficheros
     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsm190ca;
     #dsm190ca#0  = #dsmow014#0;
     #dsm190ca#1  = #dsmow014#1;
     #dsm190ca#2  = #dsmow014#2;
     #dsm190ca#3  = #dsmow014#5;
     #dsm190ca#4  = #dsmow014#7;
     #dsm190ca#5  = 0;
     |LEE 040#dsm190ca.=;
     |SI FSalida = 0;
         |SI nTecla = 1;
             aAbre = eaPathEmision + "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             |XABRE "BW", aAbre, nHandle2;

             aAbre = eaPathEmision + "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             |XABRE "BW", aAbre, nHandle3;
         |FINSI;

         |SI #dsm190ca#1 [ 2008;
             |HAZ Registro190_1;
         |SINO;
             |HAZ Registro190_1_2009;
         |FINSI;

         |BUCLE dsm190li;

         |HAZ Registro190_Auxiliar1;

         |SI nTecla = 1;
             |XCIERRA nHandle2;
             |XCIERRA nHandle3;

             eaFOrigen  = eaPathEmision + "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             |FBORRA eaFOrigen;

             eaFOrigen  = eaPathEmision + "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             eaFDestino = eaPathLanza + "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             |HAZ CopiaFichero;

             aAlfa = "wait 190pdf /E:RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
             aAlfa = aAlfa + "/R:RCC" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
             aAlfa = aAlfa + "/I: ";
             aAlfa = aAlfa + "/C:" + aTercera + " ";
             aAlfa = aAlfa + "/F:FLAG.TXT ";
             aAlfa = aAlfa + "/A:RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
             aAlfa = aAlfa + &13 + &10;
             |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;
     |CIERRA #dsm190ca;
|FPRC;

|PROCESO Lee1901_2004;        || Creacion de Ficheros
     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsm190ca;
     #dsm190ca#0  = #dsmow014#0;
     #dsm190ca#1  = #dsmow014#1;
     #dsm190ca#2  = #dsmow014#2;
     #dsm190ca#3  = #dsmow014#5;
     #dsm190ca#4  = #dsmow014#7;
     #dsm190ca#5  = 0;
     |LEE 040#dsm190ca.=;
     |SI FSalida = 0;
         aAbre = eaPathEmision + "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle2;

         aAbre = eaPathEmision + "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         |XABRE "BW", aAbre, nHandle3;

         |SI #dsm190ca#1 [ 2008;
             |HAZ Registro190_1;
         |SINO;
             |HAZ Registro190_1_2009;
         |FINSI;

         |BUCLE dsm190li;

         |HAZ Registro190_Auxiliar1;

         |XCIERRA nHandle2;
         |XCIERRA nHandle3;

         eaFOrigen  = eaPathEmision + "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         eaFDestino = eaPathLanza + "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         |HAZ CopiaFichero;

         |FBORRA eaFOrigen;

         eaFOrigen  = eaPathEmision + "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         eaFDestino = eaPathLanza + "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
         |HAZ CopiaFichero;

         |FBORRA eaFOrigen;

         |SI #dsmoy000#6 [ 2005;
             |SI nTecla = 1;
                 aAlfa = "wait 190pdf /E:RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
                 aAlfa = aAlfa + "/R:RCC" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
                 aAlfa = aAlfa + "/I: ";
                 aAlfa = aAlfa + "/C:" + aTercera + " ";
                 aAlfa = aAlfa + "/F:FLAG.TXT ";
                 aAlfa = aAlfa + "/A:RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
                 aAlfa = aAlfa + &13 + &10;
                 |XGRABA nHandle1, aAlfa;
             |SINO;
                 aAlfa = "wait VI190 /E:RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
                 aAlfa = aAlfa + "/R:RCC" + (("00000" + #dsmow014#0) % -105) + ".TXT ";
                 aAlfa = aAlfa + &13 + &10;
                 |XGRABA nHandle1, aAlfa;
             |FINSI;
         |SINO;
             eaTipoE =  "RCA" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             eaTipoR =  "RCC" + (("00000" + #dsmow014#0) % -105) + ".TXT";
             eaTipoP =  "PDF" + (("00000" + #dsmow014#0) % -105) + ".PDF";

             |SI nTecla = 1;
                 eaTipoC =  aTercera;
                 eaTipoA =  "RCB" + (("00000" + #dsmow014#0) % -105) + ".TXT";
                 eaTipoV =  "N";
             |SINO;
                 eaTipoV =  "S";
             |FINSI;

             |HAZ LineaShellJava;
         |FINSI;
     |FINSI;
     |CIERRA #dsm190ca;
|FPRC;

|PROCESO Lee190P;       || Emision Papel
     |ABRE #dsmom004;
     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom004;

     |ABRE #dsm190ca;
     #dsm190ca#0  = #dsmow014#0;
     #dsm190ca#1  = #dsmow014#1;
     #dsm190ca#2  = #dsmow014#2;
     #dsm190ca#3  = #dsmow014#5;
     #dsm190ca#4  = #dsmow014#7;
     #dsm190ca#5  = 0;
     |LEE 040#dsm190ca.=;
     |SI FSalida = 0;
         |SI nTecla = 5;
             |HAZ Registro190_1;
             |SI nSwCara = 1;
                 |PRINT;
             |SINO;
                 |HAZ Registro190_Auxiliar1;
                 enSwImpre = 0;
                 |SI #dsmoy000#6 [ 2015; |BUCLE dsm190li; |FINSI;
                 |SI #dsmoy000#6 ] 2016; |HAZ dsm19001c;  |FINSI;
                 |SI nSwPrint = 0;
                     |DDEFECTO #dsm190li;
                     |DDEFECTO #dsm19001;
                     |PRINT;
                 |FINSI;
                 |PIEINF;
             |FINSI;
             |CIERRA #dsm190ca;
             |ACABA;
         |FINSI;

         nHojas   = #dsm190ca#6;
         enTHojas = (((nHojas / 8) + .49) ! 0);

         |SI nTeclaPapel = 1;
             |HAZ Registro190_1;
             |HAZ Registro190_Auxiliar1;

             eaAlfa = #dsmoy000#7;    |HAZ FechaBonito;

             |PRINT;
             |PIEINF;

             |HAZ GrabaImpreso;
         |FINSI;

         |SI nTeclaPapel = 2;
             nContador = 0;
             enNHojas  = 1;
             nSwPrint  = 0;
             |BUCLE dsm190li;
             |SI nSwPrint = 1;  |PIEINF;  |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #dsm190ca;
|FPRC;

|PROCESO QueHacemos190;
     aImprime = "";

     |SI nTeclaPapel ! 0;  |O nTecla = 5;   || En Papel Continuo
         |HAZ Lee190P;
         |ACABA;
     |FINSI;

     |SI nSwLee = 1;        || Lectura para Colectivos para Totales Hoja
         |HAZ Lee1900;
         |ACABA;
     |FINSI;

     |SI nTecla = 1; |O nTecla = 3;
         |ABRE #dsm190ca;
         #dsm190ca#0  = #dsmow014#0;
         #dsm190ca#1  = #dsmow014#1;
         #dsm190ca#2  = #dsmow014#2;
         #dsm190ca#3  = #dsmow014#5;
         #dsm190ca#4  = #dsmow014#7;
         #dsm190ca#5  = 0;
         |LEE 040#dsm190ca.=;
         |SI FSalida ! 0;  |DDEFECTO #dsm190ca;  |FINSI;
         |CIERRA #dsm190ca;

         |SI #dsmoy000#6 ] 2005;  |Y #dsmoy000#6 [ 2010;
             |SI #dsm190ca#6 = 0;
                 aImprime = "0000SEmpresa " + (("00000" + #dsm190ca#0) % -105) + " SIN Perceptores. Marcar Modelo como Impreso";
                 |CONFI aImprime;
                 |SI FSalida = 0;
                     |HAZ GrabaImpreso;
                 |FINSI;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI nTecla = 1;
             |SI #dsmoy000#6 [ 2005;
                 |SI #dsm190ca#6 > 25;
                     aImprime = "0000 Empresa " + (("00000" + #dsm190ca#0) % -105) + " mas de 25 Perceptores Emitir por Internet";
                     |MENAV aImprime;
                     |ACABA;
                 |FINSI;
             |FINSI;

             |SI #dsmoy000#6 ] 2006;
                 |SI #dsm190ca#6 > 15;
                     aImprime = "0000 Empresa " + (("00000" + #dsm190ca#0) % -105) + " mas de 15 Perceptores, emitir por Internet";
                     |MENAV aImprime;
                     |ACABA;
                 |FINSI;
             |FINSI;

             |ABRE #dsmom002;
             #dsmom002#0 = #dsm190ca#0;
             #dsmom002#1 = 1;
             #dsmom002#2 = 110;
             |LEE 040#dsmom002.];
             |SI FSalida ! 0;  |O  #dsmom002#0 ! #dsm190ca#0;  |O  #dsmom002#2 ! 110;
                 |DDEFECTO #dsmom002;
             |FINSI;
             |CIERRA #dsmom002;

             |SI #dsmom002#7 = "MENSUAL   ";
                 aImprime = "0000 Empresa " + (("00000" + #dsm190ca#0) % -105) + " Modelo 110 Mensual, Emitir por Internet";
                 |MENAV aImprime;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 [ 2003;
         |HAZ Lee1901;          || Creacion de los Ficheros Planos.
     |SINO;
         |HAZ Lee1901_2004;     || Creacion de los Ficheros Planos.
     |FINSI;
|FPRC;

|DEFBUCLE dsmow014C190;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, QueHacemos190;
|FIN;

|DEFBUCLE dsmow014N190;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, QueHacemos190;
|FIN;

|PROCESO Boton1901;
     |PTEC 824;
|FPRC;

|PROCESO Boton1902;
     |PTEC 825;
|FPRC;

|PROCESO Boton1903;
     |PTEC 826;
|FPRC;

|PROCESO Boton1904;
     |PTEC 827;
|FPRC;

|PROCESO Boton1905;
     |PTEC 828;
|FPRC;

|PROCESO Boton1906;
     |PTEC 806;
|FPRC;

|PROCESO AbreImprime190;
     aAbre = eaPathLanza + "imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "CD " + eaPathLanza + &13 + &10;    |XGRABA nHandle1, aAlfa;

     |SI #dsmoy000#6 = 2001;
         |SI nTecla = 1;
             aAlfa = "ZLS01190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR01190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2002;
         |SI nTecla = 1;
             aAlfa = "ZLS02190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR02190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2003;
         |SI nTecla = 1;
             aAlfa = "ZLS03190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR03190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2004;
         |SI nTecla = 1;
             aAlfa = "ZLS04190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR04190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2005;
         |SI nTecla = 1;
             aAlfa = "ZLS05190.EXE -y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |SINO;
             aAlfa = "ZPR05190.EXE -Y" + &13 + &10;  |XGRABA nHandle1, aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CopiaInternet;
     eaFOrigen  = eaPathLanza + "/RT" + #dsmoy000#6;
     eaFDestino = eaPathInternet + "RT" + #dsmoy000#6;
     |RCOPIA_FICHERO eaFOrigen, eaFDestino;
     |RFBORRA eaFOrigen;

     eaFOrigen  = eaPathLanza + "AUXILIAR.TXT";
     eaFDestino = eaPathInternet + "AUXILIAR.TXT";
     |RCOPIA_FICHERO eaFOrigen, eaFDestino;
     |RFBORRA eaFOrigen;

     aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO CreaUnico;
     |DBASE aPathAfegir;  |QBF aPathAfegir;
     aPathAfegir = aPathAfegir + "basura";      |MKDIR aPathAfegir;
     aPathAfegir = aPathAfegir + "/tmp";        |MKDIR aPathAfegir;
     aPathAfegir = aPathAfegir + "/";

     aNombre = "19000000.txt";
     |PINTA 1320, "Nombre Fichero: ";
     |PINTA 1346, ".TXT";

     E_inf   = "";
     E_sup   = "8";
     |PARA;  |SI;  |HACIENDO;
             aNombre = 1336 ? 1;  |QBF aNombre;

             aAbre = eaPathInternet + aNombre + ".txt";
             |XABRE "EC", aAbre, nHandle1;
             |SI FSalida ] 0;
                 |CONFI "0000NEl Fichero ya existe, desea reemplazarlo.";
                 |SI FSalida = 0;  |SAL;  |FINSI;
             |SINO;
                 |SAL;
             |FINSI;
     |SIGUE;

     aDestino = eaPathInternet + aNombre + ".txt";
     |RFBORRA aDestino;

     aFichero    = aPathAfegir + "*.*";
     |_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;
            |FBORRA aFichero;
            |_SDIR aFichero;
     |SIGUE;

     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = eaPathLanza + "AInternet";
     aPathInter  = aPathInter + "/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aBue     = aFichero - aPathInter;
            aDestino = aPathAfegir + aBue;

            |SI aIPRemoto = "";
                |COPIA_FICHERO aFichero, aDestino;
            |SINO;
                |RECIBE_FICHERO aFichero, aDestino;
            |FINSI;

            |RFBORRA aFichero

            aOrigen  = aDestino;
            aDestino = aPathAfegir + aNombre + ".txt";
            |AFEGIR_FICHERO aOrigen, aDestino;

            |FBORRA aOrigen

            |ABRE #dsmow014;
            aAlfa = aBue % 405;
            #dsmow014#0 = aAlfa;
            #dsmow014#1 = #dsmoy000#6;
            #dsmow014#2 = #dsmoy000#4;
            |LEE 000#dsmow014.=;
            |SI FSalida = 0;
                enInternet = 1;
                |HAZ GrabaImpreso;
            |FINSI;
            |CIERRA #dsmow014;

            |R_SDIR aFichero;
     |SIGUE;

     aOrigen  = aDestino;
     aDestino = eaPathInternet  + aNombre + ".txt";
     |SI aIPRemoto = "";
         |COPIA_FICHERO aOrigen, aDestino;
     |SINO;
         |ENVIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |FBORRA aOrigen;

     aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO CreaVarios;
     aIPRemoto   = "";
     |IP_REMOTO aIPRemoto;

     aPathInter  = eaPathLanza +  "AInternet/";
     aFichero    = aPathInter + "*.bue";
     |R_PDIR aFichero;
     |PARA; |SI; |HACIENDO;
            |SI FSalida ! 0; |SAL; |FINSI;

            aBue     = aFichero - aPathInter;
            aDestino = eaPathInternet + "190" + (aBue % 405) + ".txt";

            |RCOPIA_FICHERO aFichero, aDestino;

            |RFBORRA aFichero;

            |ABRE #dsmow014;
            aAlfa = aBue % 405;
            #dsmow014#0 = aAlfa;
            #dsmow014#1 = #dsmoy000#6;
            #dsmow014#2 = #dsmoy000#4;
            |LEE 000#dsmow014.=;
            |SI FSalida = 0;
                enInternet = 1;
                |HAZ GrabaImpreso;
            |FINSI;
            |CIERRA #dsmow014;

            |R_SDIR aFichero;
     |SIGUE;

     aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
     |MENAV aAlfa;
|FPRC;

|PROCESO Internet2004;
     eaFichError  = "rcc";
     eaFichDatos  = "rca";
     eaFichAuxil  = "rcb";
     enValidacion = 1;

     |HAZ BuscaErroresL;

     |SI enBuenos = 0;
         |MENAV "      Ha habido Errores, arreglelos y vuelva a emitir.";
         |ACABA;
     |FINSI;

     aAlfa = "EMPRESAS VALIDADAS  ...: " + enBuenos;
     |PINTA 0630, aAlfa;

     aAlfa = "EMPRESAS NO VALIDADAS .: " + enMalos;
     |PINTA 0730, aAlfa;

     |CONTROL_SIMPLE 0, " BOTON, CREAR UN UNICO FICHERO CON LAS EMPRESAS VALIDADAS ", 1120, 1265, Boton1901;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, " BOTON, FICHERO POR CADA UNA DE LAS EMPRESAS VALIDADAS", 1320, 1465, Boton1902;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, " BOTON,   CANCELAR    ", 1520, 1665, Boton1903;
     nBoton3 = FSalida;

     |PARA; |SI;  |HACIENDO;
            |LEETECLA aTecla;
            |SI aTecla = aF2;  nBoton = 1;  |SAL;  |FINSI;
            |SI aTecla = aF3;  nBoton = 2;  |SAL;  |FINSI;
            |SI aTecla = aF4;  |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;

     |PULSATECLA;

     |SI aTecla = aF4;  |ACABA;  |FINSI;

     |SI nBoton = 1;  |HAZ CreaUnico;   |FINSI;
     |SI nBoton = 2;  |HAZ CreaVarios;  |FINSI;
|FPRC;

|PROCESO EmiteEsto190;
     aAlfa = "DEL *.DLL" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.TAB" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.WMF" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL ERROR190.TXT"     + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.EXE"         + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     |XCIERRA nHandle1;

     |DBASS aModelos;  |QBT aModelos;
     aModelos = aModelos + "basica/";

     |SI #dsmoy000#6 = 2001;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "patrones/zls01190.exe";
             eaFDestino = eaPathLanza + "zls01190.exe";
             |HAZ CopiaFichero;
         |SINO;
             eaFOrigen  = aModelos + "patrones/zpr01190.exe";
             eaFDestino = eaPathLanza + "zpr01190.exe";
             |HAZ CopiaFichero;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2002;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "patrones/zls02190.exe";
             eaFDestino = eaPathLanza + "zls02190.exe";
             |HAZ CopiaFichero;
         |SINO;
             eaFOrigen  = aModelos + "patrones/zpr02190.exe";
             eaFDestino = eaPathLanza + "zpr02190.exe";
             |HAZ CopiaFichero;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2003;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "patrones/zls03190.exe";
             eaFDestino = eaPathLanza + "zls03190.exe";
             |HAZ CopiaFichero;
         |SINO;
             eaFOrigen  = aModelos + "patrones/zpr03190.exe";
             eaFDestino = eaPathLanza + "zpr03190.exe";
             |HAZ CopiaFichero;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2004;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "patrones/zls04190.exe";
             eaFDestino = eaPathLanza + "zls04190.exe";
             |HAZ CopiaFichero;
         |SINO;
             eaFOrigen  = aModelos + "patrones/zpr04190.exe";
             eaFDestino = eaPathLanza + "zpr04190.exe";
             |HAZ CopiaFichero;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 = 2005;
         |SI nTecla = 1;
             eaFOrigen  = aModelos + "patrones/zls05190.exe";
             eaFDestino = eaPathLanza + "zls05190.exe";
             |HAZ CopiaFichero;
         |SINO;
             eaFOrigen  = aModelos + "patrones/zpr05190.exe";
             eaFDestino = eaPathLanza + "zpr05190.exe";
             |HAZ CopiaFichero;
         |FINSI;
     |FINSI;

     aAlfa = eaPathLanza + "IMPRIME";
     |RSYSTEM aAlfa;

     |SI nTecla = 1;
         eaFichError  = "rcc";
         eaFichDatos  = "rca";
         eaFichAuxil  = "rcb";
         enValidacion = 0;

         |HAZ BuscaErroresL;
     |SINO;
         |HAZ Internet2004;
     |FINSI;
|FPRC;

|PROCESO PapelContinuo190;
     nSwCara = 0;
     |SI nTeclaPapel = 0; |Y enEmpresa = 0;
         |SI eaParametro = "190"; |O eaParametro = "";
             |CONFI "    NImprimir SOLO los datos de la Caratula";
             |SI FSalida = 0;
                 nSwCara = 1;
             |FINSI;
         |FINSI;
     |FINSI;
     |SI eaParametro = "190P"; nSwCara = 1; |FINSI;

     |SI nSwCara = 0;
         Impresora = "CrystalReports";
         |IMPRE -1;
     |SINO;
         |IMPRE 0;
     |FINSI;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI nSwCara = 0;
         |SI #dsmoy000#6 [ 2002;  |INFOR "m190co01";  |FINSI;
         |SI #dsmoy000#6 ] 2003;  |Y #dsmoy000#6 [ 2008;  |INFOR "m190co02";  |FINSI;
         |SI #dsmoy000#6 ] 2009;  |Y #dsmoy000#6 [ 2015;  |INFOR "m190co03";  |FINSI;
         |SI #dsmoy000#6 ] 2016;  |INFOR "m190co04";  |FINSI;
     |SINO;
         |INFOR "m190co00";
     |FINSI;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C190;
     |SINO;
         |BUCLE dsmow014N190;
     |FINSI;

     |SI nSwCara = 1;
         |PIEINF;
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;

|PROCESO PapelOficial190;
     nTeclaPapel = 0;
     |HAZ PapelContinuo190;
|FPRC;

|PROCESO Botones190;
     |BLANCO 0501 2380;

     |CONTROL_SIMPLE 0, "LBOTON, <F2> Emision Papel Oficial Laser (Directo por impresora) ", 0513, 0754, Boton1901;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F3> Emision Papel Oficial Laser (Vista previa por el Acrobat) ", 0913, 1154, Boton1902;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F4> Presentacion Telematica ", 1313, 1554, Boton1903;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F5> Informe de Comprobacion              ", 1713, 1954, Boton1904;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON, <F6> Directorio Acrobat  ", 2113, 2354, Boton1905;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,ESC Cancelar", 2365, 2378, Boton1906;
     nBoton6 = FSalida;

     aF2 = &255 + "824";
     aF3 = &255 + "825";
     aF4 = &255 + "826";
     aF5 = &255 + "827";
     aF6 = &255 + "828";
     aF7 = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nTecla = 1; eaModoImpre = "I";    |SAL;  |FINSI;
         |SI aTecla = aF3;  nTecla = 1; eaModoImpre = "P";    |SAL;  |FINSI;
         |SI aTecla = aF4;  nTecla = 3;                       |SAL;  |FINSI;
         |SI aTecla = aF5;  nTecla = 5; |HAZ PapelOficial190;        |FINSI;
         |SI aTecla = aF6;  |HAZ Acrobat;                            |FINSI;
         |SI aTecla = aF7;  nTecla = 0;   |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;

     |PULSATECLA;
|FPRC;

|PROCESO Bloque2011;
     |SI nTecla = 5;
         |HAZ PapelOficial190;
         |ACABA;
     |FINSI;

     |HAZ Botones190;

     |SI nTecla = 0;  enInfComp = 1;  |ACABA;  |FINSI;
     |SI nTecla = 5;  enInfComp = 1;  |FINSI;

     |SI #dsmoy000#7 < "01.01.2005";  #dsmoy000#7 = "01.01.2005";  |FINSI;

     |SI nTecla = 1;
         |SI #dsmom107#6 = "S";
             aTercera = "N";
             aAlfa    = "0000" + #dsmom107#5 + "Desea la impresion de la tercera copia  ";
             |CONFI aAlfa;
             |SI FSalida = 0;  aTercera = "S";  |FINSI;
         |SINO;
             aTercera = #dsmom107#5;
         |FINSI;
     |FINSI;

     |SI #dsmoy000#6 [ 2005;
         |HAZ AbreImprime190;
     |FINSI;

     nSwLee = 0;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C190;
     |SINO;
         |BUCLE dsmow014N190;
     |FINSI;

     |SI aImprime ! "";  |ACABA;  |FINSI;

     |SI #dsmoy000#6 [ 2005;
         |HAZ EmiteEsto190;
     |SINO;
         |SI eaTipoV ! "S";
             eaFichError  = "rcc";
             eaFichDatos  = "rca";
             eaFichAuxil  = "rcb";
             enValidacion = 0;

             |HAZ BuscaErroresL;
         |SINO;
             |HAZ Internet2004;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Portal190_2012;
     #dsm190ca#0  = #dsmow014#0;
     #dsm190ca#1  = #dsmow014#1;
     #dsm190ca#2  = #dsmow014#2;
     #dsm190ca#3  = #dsmow014#5;
     #dsm190ca#4  = #dsmow014#7;
     #dsm190ca#5  = 0;
     |LEE 040#dsm190ca.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsmom002#0 = #dsm190ca#0;
     #dsmom002#1 = 1;
     #dsmom002#2 = 110;
     |LEE 040#dsmom002.];
     |SI FSalida ! 0;  |O  #dsmom002#0 ! #dsm190ca#0;  |O  #dsmom002#2 ! 110;
         |DDEFECTO #dsmom002;
     |FINSI;

     #dsmom004#0  = #dsmow014#0;
     #dsmom004#1  = #dsmow014#1;
     #dsmom004#2  = #dsmow014#2;
     #dsmom004#3  = #dsmow014#5;
     #dsmom004#4  = #dsmow014#7;
     |LEE 040#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     eaFicheroPlano = "190" + (("00000" + #dsmow014#0) % -105) + ".txt";
     eaFicheroImpre = "190" + (("00000" + #dsmow014#0) % -105) + ".imp";
     eaFicheroSalid = "190" + (("00000" + #dsmow014#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #dsmow014#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle2;

     |HAZ Registro190_1_2009;

     enSinActividad = 1;
     |BUCLE dsm190li;

     |XCIERRA nHandle2;

     enEmpresa      = #dsmow014#0;
     eaNomEmpresa   = #dsmow014#3;

     |HAZ PresentaPortal;
|FPRC;

|DEFBUCLE dsmow014C190_2012;
     #dsmow014#1;
     6;
     00000, 0000, 00, "S";
     99999, 9999, 99, "S";
     ;
     NULL, Portal190_2012;
|FIN;

|DEFBUCLE dsmow014N190_2012;
     #dsmow014#2;
     6;
     "                                        ", "S";
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", "S";
     ;
     NULL, Portal190_2012;
|FIN;

|PROCESO Bloque2012;
     |HAZ BtnAnuales2012;

     |SI eaOpcion = "0";  enInfComp = 1;  |ACABA;  |FINSI;

     nTecla = 1;

     |ABRE #dsm190ca;
     |ABRE #dsmom002;
     |ABRE #dsmom004;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C190_2012;
     |SINO;
         |BUCLE dsmow014N190_2012;
     |FINSI;
     |CIERRA #dsm190ca;
     |CIERRA #dsmom002;
     |CIERRA #dsmom004;

     |SI eaOpcion = "3";
         |HAZ SacaErrorPtl;

         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bloque2015;
     |HAZ BtnAnuales2015;

     |SI eaOpcion = "0";  enInfComp = 1;  |ACABA;  |FINSI;

     nTecla = 1;

     |ABRE #dsm190ca;
     |ABRE #dsmom002;
     |ABRE #dsmom004;
     |SI #dsmoy000#8 = "C";
         |BUCLE dsmow014C190_2012;
     |SINO;
         |BUCLE dsmow014N190_2012;
     |FINSI;
     |CIERRA #dsm190ca;
     |CIERRA #dsmom002;
     |CIERRA #dsmom004;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bloque;
     |SI #dsmoy000#6 [ 2011;  |HAZ Bloque2011;  |ACABA;  |FINSI;
     |SI #dsmoy000#6 [ 2014;  |HAZ Bloque2012;  |ACABA;  |FINSI;
     |SI #dsmoy000#6 = 2015;  |HAZ Bloque2015;  |ACABA;  |FINSI;
     |SI #dsmoy000#6 = 2016;  |HAZ Bloque2016;  |ACABA;  |FINSI;
     |SI #dsmoy000#6 ] 2017;  |HAZ Bloque2017;  |ACABA;  |FINSI;
|FPRC;

|PROGRAMA;
     aFichero = ("000" + Usuario) % 108;
     |NOME_DAT #dsmoy000#aFichero#;

     aFichero = ("imp" + Usuario) % 108;
     |NOME_DAT #dsmow014#aFichero#;

     |ABRE #dsmoy000;
     |LEE 000#dsmoy000.p;
     |CIERRA #dsmoy000;

     |ABRE #dsmom107;
     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;
         |CIERRA #dsmom107;
         |SUB_EJECUTA_NP "dsmom107";
         |ABRE #dsmom107;
     |FINSI;

     |LEE 040#dsmom107.p;
     |SI FSalida ! 0;  |DDEFECTO #dsmom107;  |FINSI;
     |CIERRA #dsmom107;

     enCambiaMoneda = 1;
     enSwTrata      = 0;

     |SI eaParametro = "190D";
          enTipoEntrada = 26;
          |SUB_EJECUTA "dsm190ca";
          |ACABA;
     |FINSI;

     |SI eaParametro = "190P";  |O eaParametro = "190C";
         enInfComp = 1;
         nTecla    = 5;
         |HAZ Bloque2011;
         |ACABA;
     |FINSI;

     |HAZ Bloque;
|FPRO;
