|FICHEROS;
     dsmom900 #900;
|FIN;

--------------------------------------> EDITA<-------------------------------------------------
|VARIABLES;
     aDirectorio    = "";
     aNFichero      = "";
     aVariableCarga = "";
     aFichero       = "";
     aAlfa          = "";

     nBaffer        = 0;
     nTotalLinea    = 0;
     nTope          = 0;
     nVari1         = 0;
     nVari2         = 0;
     nVariable      = 0;

     &enEmpresa     = 0;
     &enEjer        = 0;
     &enPeriodo     = 0;
     &enModelo      = 0;
     &enComplem     = 0;

     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;

{500}&epPuntEdita   = "";
|FIN;

|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 1;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          epPuntEdita  = "";
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     enModoEdita = 1100;
     |EDITA nBaffer, 1, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
|FPRC;

|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 1;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edita;
     |PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;
     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
     |POPV;
|FPRC;

|PROGRAMA;
     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 0902;
     enCuadroFin   = 2279;
     enCampoAncho  = 76;
     enModoEdita   = 1100;

     |ABRE #900;
     |PARA nVariable = 1;  |SI nVariable [ 99;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #900#0 = enEmpresa;
           #900#1 = enEjer;
           #900#2 = enPeriodo;
           #900#3 = enModelo;
           #900#4 = enComplem;
           #900#5 = nVariable;
           |LEE 101#900=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #900#6;
               |BORRA 020#900a;
           |FINSI;
           |LIBERA #900;
     |SIGUE;

     |HAZ Edita;

     |PARA nVariable = 1;  |SI nVariable [ 99;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #900;
           #900#0 = enEmpresa;
           #900#1 = enEjer;
           #900#2 = enPeriodo;
           #900#3 = enModelo;
           #900#4 = enComplem;
           #900#5 = nVariable;
           |LEE 1010#900=;
           |SI FSalida ! 0;  |GRABA 020#900b;  |FINSI;
           #900#6 = epPuntEdita;
           |GRABA 020#900a;
           |LIBERA #900;
     |SIGUE;

     |PARA nVariable = 99;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #900#0 = enEmpresa;
           #900#1 = enEjer;
           #900#2 = enPeriodo;
           #900#3 = enModelo;
           #900#4 = enComplem;
           #900#5 = nVariable;
           |LEE 101#900=;
           aAlfa = #900#6;  |QBF aAlfa;

           |SI aAlfa ! "";  |LIBERA #900;  |SAL;  |FINSI;

           |BORRA 020#900a;
           |LIBERA #900;
     |SIGUE;
     |CIERRA #900;
|FPRO;
