|VARIABLES;
   &BaseIva     = 0;
   &TipoIva     = 0;
   &CuotaIva    = 0;
   &BaseRec     = 0;
   &TipoRec     = 0;
   &CuotaRec    = 0;
   &TotBasesIva = 0;
   &TotCuotasIva = 0;
   &TotBasesRec  = 0;
   &TotCuotasRec = 0;
   &TotalBases  = 0;
   &TotalIvas   = 0;
   &TotalRecs   = 0;
   &TotalCuotas = 0;


   &SwCbIva = 0;
   &SwLnIva = 0;
   &SwToIva = 0;
   &SwCbRec = 0;
   &SwLnRec = 0;
   &SwToRec = 0;
   &swRecSi = 0;

 npara1        = 0;
 {99}BasesIva  = 0;
 {99}TiposIva  = -1;
 {99}CuotasIva = 0;
 {99}BasesRec  = 0;
 {99}TiposRec  = -1;
 {99}CuotasRec = 0;
|FIN;

|PROCESO sLiqIVA;
  |PARA npara1 = 0; |SI npara1 [ 99; |HACIENDO npara1 = npara1 + 1;
        ITiposIva  = TiposIva1<-;
        ITiposIva  = ITiposIva + npara1;

        |SI TiposIva = #caivalin#7;
            IBasesIva  = BasesIva1<-;  IBasesIva  = IBasesIva  + npara1;
            ICuotasIva = CuotasIva1<-; ICuotasIva = ICuotasIva + npara1;
            BasesIva  = BasesIva  + #caivalin#6;
            CuotasIva = CuotasIva + #caivalin#8;
            |SAL;
        |SINO;
            |SI TiposIva < 0;
                TiposIva = #caivalin#7;
                IBasesIva  = BasesIva1 <-;  IBasesIva  = IBasesIva  + npara1;
                ICuotasIva = CuotasIva1 <-; ICuotasIva = ICuotasIva + npara1;
                BasesIva  = BasesIva  + #caivalin#6;
                CuotasIva = CuotasIva + #caivalin#8;
                |SAL;
            |FINSI;
        |FINSI;
   |SIGUE;

   |PARA npara1 = 0; |SI npara1 [ 99; |HACIENDO npara1 = npara1 + 1;
         ITiposRec  = TiposRec1<-;
         ITiposRec  = ITiposRec + npara1;
         |SI TiposRec = #caivalin#9;
             IBasesRec  = BasesRec1<-;  IBasesRec  = IBasesRec + npara1;
             ICuotasRec = CuotasRec1<-; ICuotasRec = ICuotasRec + npara1;
             BasesRec  = BasesRec  + #caivalin#6;
             CuotasRec = CuotasRec + #caivalin#10;
             |SAL;
         |SINO;
             |SI TiposRec < 0;
                 TiposRec = #caivalin#9;
                 IBasesRec  = BasesRec1 <-;  IBasesRec  = IBasesRec + npara1;
                 ICuotasRec = CuotasRec1 <-; ICuotasRec = ICuotasRec + npara1;
                 BasesRec  = BasesRec  + #caivalin#6;
                 CuotasRec = CuotasRec + #caivalin#10;
                 |SAL;
             |FINSI;
         |FINSI;
   |SIGUE;

   TotalBases  = TotalBases + #caivalin#6;
   TotalIvas   = TotalIvas  + #caivalin#8;
   TotalRecs   = TotalRecs  + #caivalin#10;
   TotalCuotas = TotalIvas + TotalRecs;

   |SI #caivalin#9 ! 0; swRecSi = 1; |FINSI;
|FPRC;

|| *********************************************************************
|PROCESO iLiqIVA;
   |SI enResumen = 0;
      |INFOR "dsmoyr09";
      |SI FSalida < 0; |ACABA; |FINSI;
   |FINSI;

   TotBasesIva = 0;
   TotCuotasIva = 0;
   TotBasesRec  = 0;
   TotCuotasRec = 0;

   SwCbIva = 1;
   SwLnIva = 0;
   SwToIva = 0;
   SwCbRec = 0;
   SwLnRec = 0;
   SwToRec = 0;
   |PRINT;
   SwCbIva = 0;
   SwLnIva = 1;
   SwToIva = 0;
   SwCbRec = 0;
   SwLnRec = 0;
   SwToRec = 0;
   |PARA npara1 = 0; |SI npara1 [ 99; |HACIENDO npara1 = npara1 + 1;
         IBasesIva  = BasesIva1<-;  IBasesIva  = IBasesIva + npara1;
         ITiposIva  = TiposIva1<-;  ITiposIva  = ITiposIva + npara1;
         ICuotasIva = CuotasIva1<-; ICuotasIva = ICuotasIva + npara1;
         BaseIva = BasesIva;
         TipoIva = TiposIva;
         CuotaIva = CuotasIva;

         TotBasesIva = TotBasesIva + BaseIva;
         TotCuotasIva = TotCuotasIva + CuotaIva;

         |SI TiposIva ] 0; |PRINT; |SINO; |SAL; |FINSI;
   |SIGUE;

   SwCbIva = 0;
   SwLnIva = 0;
   SwToIva = 1;
|SI swRecSi = 1;    SwCbRec = 1;   |FINSI;
   SwLnRec = 0;
   SwToRec = 0;
   |PRINT;

|SI swRecSi = 1;
   SwCbIva = 0;
   SwLnIva = 0;
   SwToIva = 0;
   SwCbRec = 0;
   SwLnRec = 1;
   SwToRec = 0;

   |PARA npara1 = 0; |SI npara1 [ 99; |HACIENDO npara1 = npara1 + 1;
      IBasesRec  = BasesRec1<-;  IBasesRec  = IBasesRec + npara1;
      ITiposRec  = TiposRec1<-;  ITiposRec  = ITiposRec + npara1;
      ICuotasRec = CuotasRec1<-; ICuotasRec = ICuotasRec + npara1;

      BaseRec = BasesRec;
      TipoRec = TiposRec;
      CuotaRec = CuotasRec;

      TotBasesRec  = TotBasesRec + BaseRec;
      TotCuotasRec = TotCuotasRec + CuotaRec;
      |SI TiposRec ] 0; |PRINT; |SINO; |SAL; |FINSI;
   |SIGUE;
   SwCbIva = 0;
   SwLnIva = 0;
   SwToIva = 0;
   SwCbRec = 0;
   SwLnRec = 0;
   SwToRec = 1;
   |PRINT;
|FINSI;
   |SI enResumen = 0;
      |PIEINF;
      |FININF;
   |FINSI;
|FPRC;


|PROCESO BAcum;
 |PARA npara1 = 0; |SI npara1 [ 99; |HACIENDO npara1 = npara1 + 1;
       IBasesIva  = BasesIva1<-;  IBasesIva  = IBasesIva + npara1;
       ITiposIva  = TiposIva1<-;  ITiposIva  = ITiposIva + npara1;
       ICuotasIva = CuotasIva1<-; ICuotasIva = ICuotasIva + npara1;
       IBasesRec  = BasesRec1<-;  IBasesRec  = IBasesRec + npara1;
       ITiposRec  = TiposRec1<-;  ITiposRec  = ITiposRec + npara1;
       ICuotasRec = CuotasRec1<-; ICuotasRec = ICuotasRec + npara1;
       BasesIva  = 0;
       TiposIva  = -1;
       CuotasIva = 0;
       BasesRec  = 0;
       TiposRec  = -1;
       CuotasRec = 0;
 |SIGUE;
 swRecSi = 0;
 TotalBases  = 0;
 TotalIvas   = 0;
 TotalRecs   = 0;
 TotalCuotas = 0;
|FPRC;
