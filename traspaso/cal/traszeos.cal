|FICHEROS;
     trasz001 #0;
     trasm001 #1;
     trasm002 #2;
|FIN;

|VARIABLES;
     aBase       = "";
     aAbre       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aAlfa4      = "";
     aAlfa5      = "";
     aCaracter13 = "";
     aFichero    = "";

     nHandle    = 0;
     nNume      = 0;

     &enCasilla      = 0;
     &enError        = 0;
     &eaContenido    = "";
     &enComprobacion = 0;
|FIN;

|PROCESO CargaArrlocal;
     eaContenido = aAlfa2 % 4101;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero ARRLOCAL.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 0947, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "ARRLOCAL";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   140;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4102;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4302;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4540;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8507;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9202;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9402;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9602;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9802;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10003;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10309;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11225;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13740;  enCasilla = 701; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 17730;  enCasilla = 702; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 20740;  enCasilla = 703;  |HAZ GrabaCasilla;

     eaContenido = aAlfa2 %  0140;  enCasilla = 704; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Arrlocal;
     |SI enComprobacion = 0;
         aFichero = "arrlocal";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "arrlocal.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 246, aAlfa1;
          |XLEE nHandle,  42, aAlfa2;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaArrlocal;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaCcbanco;
     eaContenido = aAlfa1 % 9901;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero CCBANCO.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1047, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "CCBANCO";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   130;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  3120;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5101;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5220;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7201;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7320;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9301;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9401;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9501;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9601;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9701;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9801;  enCasilla = 12;  |HAZ GrabaCasilla;
|FPRC;

|PROCESO Ccbanco;
     |SI enComprobacion = 0;
         aFichero = "ccbanco";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "ccbanco.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 100, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaCcbanco;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaDatarren;
     eaContenido = aAlfa2 % 4501;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero DATARREN.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1147, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "DATARREN";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   111;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1240;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5202;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5440;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9407;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10102;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10302;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10502;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10702;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10903;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11209;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12103;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12430;  enCasilla = 13;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15414;  enCasilla = 14;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 16801;  enCasilla = 15;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 16913;  enCasilla = 16;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18225;  enCasilla = 701; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 20737;  enCasilla = 702; |HAZ GrabaCasilla;

     eaContenido = aAlfa2 %  0122;  enCasilla = 703; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 %  2322;  enCasilla = 704; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Datarren;
     |SI enComprobacion = 0;
         aFichero = "datarren";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "datarren.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 243, aAlfa1;
          |XLEE nHandle,  46, aAlfa2;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaDatarren;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaDatdecla;
     eaContenido = aAlfa1 % 22001;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero DATDECLA.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1247, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "DATDECLA";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   140;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4104;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4501;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4601;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4701;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4801;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4901;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5001;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5101;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5202;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5410;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6410;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7410;  enCasilla = 13;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8410;  enCasilla = 14;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9410;  enCasilla = 15;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10415;  enCasilla = 16;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11904;  enCasilla = 17;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12333;  enCasilla = 18;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15612;  enCasilla = 19;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 16812;  enCasilla = 20;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18040;  enCasilla = 701; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Datdecla;
     |SI enComprobacion = 0;
         aFichero = "datdecla";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "datdecla.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 221, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaDatdecla;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaDesact;
     eaContenido = aAlfa1 % 8501;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero DESACT.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1347, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "DESACT";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0104;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0511;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1601;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1702;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1901;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2013;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  3350;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8302;  enCasilla = 8;   |HAZ GrabaCasilla;
|FPRC;

|PROCESO Desact;
     |SI enComprobacion = 0;
         aFichero = "desact";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "desact.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 86, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaDesact;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaRelactep;
     eaContenido = aAlfa1 % 9501;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero RELACTEP.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1447, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "RELACTEP";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0111;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1202;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1401;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1502;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1736;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5302;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5540;  enCasilla = 701; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Relactep;
     |SI enComprobacion = 0;
         aFichero = "relactep";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "relactep.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 96, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaRelactep;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO PasoEos;
     aCaracter13 = &13;

     aBase = #0#1;  |QBF aBase;
     aBase = aBase + "eos/";

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Arrlocal";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Arrlocal";
     |FINSI;
     |HAZ Arrlocal;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Ccbanco";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Ccbanco";
     |FINSI;
     |HAZ Ccbanco;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Datarren";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Datarren";
     |FINSI;
     |HAZ Datarren;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Datdecla";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Datdecla";
     |FINSI;
     |HAZ Datdecla;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Desact";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Desact";
     |FINSI;
     |HAZ Desact;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Relactep";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Relactep";
     |FINSI;
     |HAZ Relactep;
|FPRC;
