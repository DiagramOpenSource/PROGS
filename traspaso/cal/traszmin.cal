|FICHEROS;
     trasz001 #0;
     trasm001 #1;
     trasm002 #2;
|FIN;

|VARIABLES;
     aBase       = "";
     aAbre       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aAlfa4      = "";
     aAlfa5      = "";
     aCaracter13 = "";
     aFichero    = "";

     nHandle    = 0;
     nNume      = 0;

     &enCasilla      = 0;
     &enError        = 0;
     &eaContenido    = "";
     &enComprobacion = 0;
|FIN;

|PROCESO CargaConceptos;
     eaContenido = aAlfa1 % 15201;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero CONCEPTOS.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 0971, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "CONCEPTOS";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0103;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0404;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0802;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1009;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1911;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  3011;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4111;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5211;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6301;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6401;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6511;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7611;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8720;  enCasilla = 701; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10745;  enCasilla = 702; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Conceptos;
     |SI enComprobacion = 0;
         aFichero = "concepto";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "conceptos.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 153, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaConceptos;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaCuotas;
     eaContenido = aAlfa1 % 19201;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero CUOTAS.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1071, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "CUOTAS";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0140;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4104;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4503;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4803;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5102;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5303;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5602;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5809;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6701;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6804;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7201;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7304;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7704;  enCasilla = 13;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8110;  enCasilla = 14;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9112;  enCasilla = 15;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10305;  enCasilla = 16;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10810;  enCasilla = 17;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11803;  enCasilla = 18;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12103;  enCasilla = 19;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12401;  enCasilla = 20;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12501;  enCasilla = 21;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12610;  enCasilla = 22;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13610;  enCasilla = 23;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14606;  enCasilla = 24;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15240;  enCasilla = 701; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Cuotas;
     |SI enComprobacion = 0;
         aFichero = "cuotas";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "cuotas.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 193, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaCuotas;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaDatemp;
     eaContenido = aAlfa1 % 6701;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero DATEMP.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1171, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "DATEMP";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0103;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0420;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2440;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6401;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6502;  enCasilla = 5;   |HAZ GrabaCasilla;
|FPRC;

|PROCESO Datemp;
     |SI enComprobacion = 0;
         aFichero = "datemp";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "datemp.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle,  68, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaDatemp;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaPerceptor;
     eaContenido = aAlfa1 % 13501;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero PERCEPTOR.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1271, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "PERCEPTOR";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0140;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4104;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4503;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4803;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5103;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5409;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6320;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8301;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8401;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8502;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8703;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9005;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9540;  enCasilla = 701; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Perceptor;
     |SI enComprobacion = 0;
         aFichero = "percepto";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "perceptor.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 136, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaPerceptor;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaResclien;
     eaContenido = aAlfa1 % 21301;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero RESCLIEN.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1371, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "RESCLIEN";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %  0103;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0404;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0802;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1011;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2111;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  3211;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  4311;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5411;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6511;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7611;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8711;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9811;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10911;  enCasilla = 13;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12011;  enCasilla = 14;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13111;  enCasilla = 15;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14211;  enCasilla = 16;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15320;  enCasilla = 701; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 17340;  enCasilla = 702; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Resclien;
     |SI enComprobacion = 0;
         aFichero = "resclien";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "resclien.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 214, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaResclien;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO PasoMinutacion;
     aCaracter13 = &13;

     aBase = #0#1;  |QBF aBase;
     aBase = aBase + "minutacion/";

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Conceptos";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Conceptos";
     |FINSI;
     |HAZ Conceptos;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Cuotas";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Cuotas";
     |FINSI;
     |HAZ Cuotas;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Datemp";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Datemp";
     |FINSI;
     |HAZ Datemp;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Perceptor";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Perceptor";
     |FINSI;
     |HAZ Perceptor;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Resclien";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Resclien";
     |FINSI;
     |HAZ Resclien;
|FPRC;
