|FICHEROS;
     trasz001 #0;
     trasm001 #1;
     trasm002 #2;
|FIN;

|VARIABLES;
     aBase       = "";
     aAbre       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aAlfa4      = "";
     aAlfa5      = "";
     aCaracter13 = "";
     aFichero    = "";

     nHandle      = 0;
     nNume        = 0;

     &enCasilla       = 0;
     &enError         = 0;
     &eaContenido     = "";
     &enComprobacion  = 0;
|FIN;

|PROCESO CargaDatgener;
     eaContenido = aAlfa2 % 15501;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero DATGENER.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1747, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "DATGENER";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   104;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  0511;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1601;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1740;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  5708;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6508;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7301;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7401;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7501;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7601;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7701;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7801;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7901;  enCasilla = 13;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8001;  enCasilla = 14;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8101;  enCasilla = 15;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8201;  enCasilla = 16;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8301;  enCasilla = 17;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8410;  enCasilla = 18;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9405;  enCasilla = 19;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9906;  enCasilla = 20;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10505;  enCasilla = 21;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11005;  enCasilla = 22;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11505;  enCasilla = 23;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12005;  enCasilla = 24;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12508;  enCasilla = 25;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13301;  enCasilla = 26;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13401;  enCasilla = 27;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13501;  enCasilla = 28;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13601;  enCasilla = 29;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13701;  enCasilla = 30;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13801;  enCasilla = 31;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13901;  enCasilla = 32;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14001;  enCasilla = 33;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14101;  enCasilla = 34;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14201;  enCasilla = 35;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14301;  enCasilla = 36;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14401;  enCasilla = 37;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14501;  enCasilla = 38;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14601;  enCasilla = 39;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14701;  enCasilla = 40;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14801;  enCasilla = 41;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14901;  enCasilla = 42;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15001;  enCasilla = 43;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15108;  enCasilla = 44;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 15908;  enCasilla = 45;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 16701;  enCasilla = 46;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 16801;  enCasilla = 47;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 16913;  enCasilla = 48;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18201;  enCasilla = 49;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18301;  enCasilla = 50;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18401;  enCasilla = 51;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18501;  enCasilla = 52;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18601;  enCasilla = 53;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 18705;  enCasilla = 601; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 19230;  enCasilla = 602; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 22201;  enCasilla = 603; |HAZ GrabaCasilla;

     eaContenido = aAlfa2 %  0140;  enCasilla = 801; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 %  4160;  enCasilla = 802; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 10102;  enCasilla = 803; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 10303;  enCasilla = 804; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 10640;  enCasilla = 805; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 14609;  enCasilla = 806; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Datgener;
     |SI enComprobacion = 0;
         aFichero = "datgener";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "datgener.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 222, aAlfa1;
          |XLEE nHandle, 156, aAlfa2;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaDatgener;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaImpsoc;
     eaContenido = aAlfa4 % 18401;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero IMPSOC.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1847, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "IMPSOC";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   112;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1301;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1402;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1606;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2202;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2402;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2640;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  6607;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7302;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7502;  enCasilla = 10;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7702;  enCasilla = 11;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  7902;  enCasilla = 12;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8103;  enCasilla = 13;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  8409;  enCasilla = 14;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  9312;  enCasilla = 15;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 10512;  enCasilla = 16;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 11710;  enCasilla = 17;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 12710;  enCasilla = 18;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13702;  enCasilla = 19;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 13905;  enCasilla = 20;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14402;  enCasilla = 50;  |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14601;  enCasilla = 600; |HAZ GrabaCasilla;
     eaContenido = aAlfa1 % 14760;  enCasilla = 601; |HAZ GrabaCasilla;

     eaContenido = aAlfa2 %  0160;  enCasilla = 602; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 %  6160;  enCasilla = 603; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 12160;  enCasilla = 604; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 18101;  enCasilla = 605; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 18201;  enCasilla = 606; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 18340;  enCasilla = 607; |HAZ GrabaCasilla;
     eaContenido = aAlfa2 % 22301;  enCasilla = 608; |HAZ GrabaCasilla;

     eaContenido = aAlfa3 %  0160;  enCasilla = 609; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 %  6105;  enCasilla = 610; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 %  6605;  enCasilla = 611; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 %  7105;  enCasilla = 612; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 %  7605;  enCasilla = 613; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 %  8149;  enCasilla = 614; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 % 13005;  enCasilla = 615; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 % 13503;  enCasilla = 616; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 % 13804;  enCasilla = 617; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 % 14240;  enCasilla = 701; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 % 18222;  enCasilla = 702; |HAZ GrabaCasilla;
     eaContenido = aAlfa3 % 20437;  enCasilla = 703; |HAZ GrabaCasilla;

     eaContenido = aAlfa4 %  0103;  enCasilla = 704; |HAZ GrabaCasilla;
     eaContenido = aAlfa4 %  0460;  enCasilla = 705; |HAZ GrabaCasilla;
     eaContenido = aAlfa4 %  6460;  enCasilla = 706; |HAZ GrabaCasilla;
     eaContenido = aAlfa4 % 12460;  enCasilla = 707; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Impsoc;
     |SI enComprobacion = 0;
         aFichero = "impsoc";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "impsoc.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 206, aAlfa1;
          |XLEE nHandle, 223, aAlfa2;
          |XLEE nHandle, 240, aAlfa3;
          |XLEE nHandle, 185, aAlfa4;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaImpsoc;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaImpsoc2;
     eaContenido = aAlfa1 % 7701;
     |SI eaContenido ! aCaracter13;
         |MENAV "       Fichero IMPSOC2.DAT sin longitud fija.";
         enError = 1;
         |ACABA;
     |FINSI;

     #0#0 = #0#0 + 1;  |PINTA 1947, #0#0;

     |SI enComprobacion = 1;  |ACABA;  |FINSI;

     #1#0 = "IMPSOC2";
     #1#1 = #0#0;
     |GRABA 020#1n;
     |LIBERA #1;

     eaContenido = aAlfa1 %   112;  enCasilla = 1;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1301;  enCasilla = 2;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1402;  enCasilla = 3;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  1606;  enCasilla = 4;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2202;  enCasilla = 5;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2401;  enCasilla = 6;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2504;  enCasilla = 7;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  2904;  enCasilla = 8;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  3304;  enCasilla = 9;   |HAZ GrabaCasilla;
     eaContenido = aAlfa1 %  3740;  enCasilla = 701; |HAZ GrabaCasilla;
|FPRC;

|PROCESO Impsoc2;
     |SI enComprobacion = 0;
         aFichero = "impsoc2";
         |NOME_DAT #2 aFichero;
         |ABRE #2;  |CIERRA #2;  |DELINDEX #2;

         |ABRE #2;
     |FINSI;

     #0#0 = 0;
     aAbre = aBase + "impsoc2.dat";
     |XABRE "BU", aAbre, nHandle;
     |PARA;  |SI;  |HACIENDO;
          |SI enError = 1;  |SAL;  |FINSI;

          |XLEE nHandle, 78, aAlfa1;

          |SI FSalida [ 0;  |SAL;  |FINSI;

          |HAZ CargaImpsoc2;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enComprobacion = 0;
         |CIERRA #2;

         |SI enError = 1;  |DELINDEX #2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO PasoSociedades;
     aCaracter13 = &13;

     aBase = #0#1;  |QBF aBase;
     aBase = aBase + "sociedades/";

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Datgener";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Datgener";
     |FINSI;
     |HAZ Datgener;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Impsoc";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Impsoc";
     |FINSI;
     |HAZ Impsoc;

     |SI enComprobacion = 0;
         |MENSA "0000 Grabando Fichero Puente Impsoc2";
     |SINO;
         |MENSA "0000 Comprobando Fichero Puente Impsoc2";
     |FINSI;
     |HAZ Impsoc2;
|FPRC;
