|FICHEROS;
    preinme1 #0;
|FIN;

|VARIABLES;
    &enAnyo = 0;
    &enMes  = 0;

    &enDTarj = 0; &enHTarj = 0;
    &enDEmpr = 0; &enHEmpr = 0;
    &enDTrab = 0; &enHTrab = 0;
    &enDTerm = 0; &enHTerm = 0;

    aAnyo = "";
    alfa1 = "";
    fech1 = @;
    p_mes = "";
|FIN;

|PROCESO defecto; |TIPO 7; ||calcula el a¤o por defecto segun fecha sistema
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO mirames; |TIPO 7; ||CALCULA EL MES POR DEFECTO SEGUN FECHA SISTEMA
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO pintames; |TIPO 0;      || PINTA EL MES LITERAL
|SI #0Campo =  1;  p_mes = "ENERO     ";  |FINSI;
|SI #0Campo =  2;  p_mes = "FEBRERO   ";  |FINSI;
|SI #0Campo =  3;  p_mes = "MARZO     ";  |FINSI;
|SI #0Campo =  4;  p_mes = "ABRIL     ";  |FINSI;
|SI #0Campo =  5;  p_mes = "MAYO      ";  |FINSI;
|SI #0Campo =  6;  p_mes = "JUNIO     ";  |FINSI;
|SI #0Campo =  7;  p_mes = "JULIO     ";  |FINSI;
|SI #0Campo =  8;  p_mes = "AGOSTO    ";  |FINSI;
|SI #0Campo =  9;  p_mes = "SEPTIEMBRE";  |FINSI;
|SI #0Campo = 10;  p_mes = "OCTUBRE   ";  |FINSI;
|SI #0Campo = 11;  p_mes = "NOVIEMBRE ";  |FINSI;
|SI #0Campo = 12;  p_mes = "DICIEMBRE ";  |FINSI;
|PINTA 1147, p_mes;
aAnyo = #0#0;
|FPRC;

|PROGRAMA;
   |CLS;
   |CABEZA " Informe de comprobacion de movimientos mensual ";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      enAnyo  = #preinme1#0;  enMes   = #preinme1#1;
      enDTarj = #preinme1#4;  enHTarj = #preinme1#5;
      enDEmpr = #preinme1#8;  enHEmpr = #preinme1#9;
      enDTrab = #preinme1#10; enHTrab = #preinme1#11;
      enDTerm = #preinme1#13; enHTerm = #preinme1#14;
      |SUB_EJECUTA "preinfor.tab;MES";
   |FINSI;
|FPRO;
