|FICHEROS;
    preinse1 #0;
    pretermi #1;

    premvtol #11;   || movtos. lins.
    preinter #12;   || Historico intervenciones

    prequiva #20;   || tarjetas
    labempre #23;   || empresas
    labtraba #24;   || trabajadores

    pretmp06 #60;   || Temporal impresion
    precmail #100;  || Conf. Correo
|FIN;

|VARIABLES;
     nInfor = -1;
     nImpre = -1;
     nPrime = 0;
     nTer = 0;
   {1}aBaseLocal = "";
  {1}aContiene = "";
    aOrg = "";
    aMd5Org = "";
    aDes = "";
    aMd5Des = "";
    aExe = "";
    aBase = "";
    aIP = "";
    aDjunto = "";
    aTxt = "";
    aCuerpo = "";
    aTipo = "";
    nHandle = 0;
    aDirDes = "";
    aImp = "";
    aNom = "";
    aLon = "";
    aCar = "";
    nPos = 0;
    nRedo = 0;
    nDeci = 0;
    i = 0;
    num1  = 0;
    num2  = 0;
    aDefe = "";
    aHafe = "";
    aAlfa = "";
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    p_mes = "";
    dia_ant = 0;
    bar_ant = 0;
    hor_ant = 0;
    min_ant = 0;
    lin_ant = 0;
    nhor = 0;
    nmin = 0;
    &shor = 0;
    &sext = 0;
    &dhor = 0;
    &dext = 0;
    &ghor = 0;
    &gext = 0;
    &error = "";
    &swlin = 0;
    swentra = 0;
    dhora = 0;
    hhora = 0;
    chora = 0;
    dminu = 0;
    hminu = 0;
    cminu = 0;
    desde = 0;
    hasta = 0;
    rajus = 0;
    hajus = 0;
    majus = 0;
    lectu = 0;
    rhora = 0;
    dlect = 0;
    hlect = 0;
    aju_cod = 0;
    aju_dia = @;
    elmes = 0;
    eldia = 0;
    fehas = @;
    emp_ant = 0;
    tra_ant = 0;
    sdia = 0;
    smas = 0;
    sdife = 0;
    srest = 0;
    nAnde = 0;
    nMede = 0;
    nDide = 0;
    nAnha = 0;
    nMeha = 0;
    nDiha = 0;

     nCodAjus = 0;
     swAjuste = 0;
     swentra2 = 0;


     nCalc = 0;
     nCalc1 = 0;
     nCalc2 = 0;

     nHora  = 0;
     nMinu  = 0;

     nSwHay = 0;

     &fFechaMov = @;
|FIN;
____________________________________/
|PROCESO defecto; |TIPO 7; ||calcula el a¤o por defecto segun fecha sistema
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO dias; |TIPO 7;
|SI #0#2 = #0#3;
        #0#12 = "N";
    |PINTA #0#12;
    |C_M #0#12, 1, "N";
|SINO;
    |C_M #0#12, 1, "S";
|FINSI;
|FPRC;
____________________________________/
|PROCESO h_extras;
    sext = sext + dext;       || total tarjeta extras
    gext = gext + dext;       || total general extras
|FPRC;

|PROCESO rup_bar;
|DDEFECTO #20;   #20#0 = bar_ant;              |LEE 000#20=;     || tarjeta
|DDEFECTO #23;   #23#0 = #20#1;                |LEE 000#23=;     || empresa
|DDEFECTO #24;   #24#0 = #20#1; #24#1 = #20#2; |LEE 000#24=;     || trabajador

||    swlin = 1;
||    |PRINT;
||    swlin = 4;
||    |PRINT;
      nDeci = ((shor * 100) $ 100);
      nRedo = nDeci / 100;
      nRedo = shor - nRedo;
      nDeci = ((nDeci * 60) / 100 ) ! 0;
      nDeci = nDeci / 100;
      shor  = nDeci + nRedo
    swlin = 5;
    |PRINT;

    |DDEFECTO #60;
    num1 = 0;
    num2 = 0;
    shor = 0;
    sext = 0;
    bar_ant = #11#7;
    swentra = 0;
|FPRC;

|PROCESO rup_dia;
|| |SI swentra = 1;
||        error = "Tarjeta [" + bar_ant + "." + lin_ant + "] sin registro de salida. [" + hor_ant + ":" + min_ant + "]";
||        swlin = 4;
||        |PRINT;
|| |FINSI;

|HAZ h_extras;

|| |SI #0#12 = "S";
      nDeci = ((dhor * 100) $ 100);
      nRedo = nDeci / 100;
      nRedo = dhor - nRedo;
      nDeci = ((nDeci * 60) / 100 ) ! 0;
      nDeci = nDeci / 100;
      dhor  = nDeci + nRedo
      swlin = 4;
      |PRINT;
|| |FINSI;
    |DDEFECTO #60;
    num1 = 0;
    num2 = 0;
    dhor = 0;
    dia_ant = #11#3;
    swentra = 0;
|FPRC;

|PROCESO movimientos;
     alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
     fFechaMov = alfa1;
     |SI fFechaMov < #0#6; |O fFechaMov > #0#7; |ACABA; |FINSI;

     #prequiva#0 = #premvtol#7;
     |LEE 000#prequiva.=;
     |SI FSalida ! 0; |DDEFECTO #prequiva; |FINSI;

     #labtraba#0 = #prequiva#1;
     #labtraba#1 = #prequiva#2;
     |LEE 000#labtraba.=;
     |SI FSalida ! 0; |DDEFECTO #labtraba; |FINSI;

     alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
     #pretmp06#0 = alfa1; alfa1 = #pretmp06#0;
     #pretmp06#1 = #premvtol#7;
     #pretmp06#5 = ""; alfa2 = "";
     |LEE 000#pretmp06.];
     |SI FSalida = 0; |Y #pretmp06#1 = #premvtol#7; |Y #pretmp06#0 = alfa1;
        |PARA; |SI FSalida = 0; |Y #pretmp06#1 = #premvtol#7; |Y #pretmp06#0 = alfa1; |HACIENDO;
           alfa2 = #pretmp06#5;
           |LEE 000#pretmp06.s;
        |SIGUE;
        alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
        #pretmp06#0 = alfa1; alfa1 = #pretmp06#0;
        #pretmp06#1 = #premvtol#7;
        #pretmp06#5 = alfa2;
        |LEE 000#pretmp06.=;
        |SI FSalida = 0;
           |SI #pretmp06#6 = "        ";
              alfa1 = (("00" + #premvtol#4) % -102) + ":" + (("00" + #premvtol#5) % -102) + ":" + (("00" + #premvtol#6) % -102);
              #pretmp06#6 = alfa1;

              alfa1 = #pretmp06#5; |QBF alfa1;
              alfa2 = alfa1 % 0102; nCalc1 = alfa2;
              alfa1 = #pretmp06#6; |QBF alfa1;
              alfa2 = alfa1 % 0102; nCalc2 = alfa2;
              nHora = nCalc2 - nCalc1;

              alfa1 = #pretmp06#5; |QBF alfa1;
              alfa2 = alfa1 % 0402; nCalc1 = alfa2;
              alfa1 = #pretmp06#6; |QBF alfa1;
              alfa2 = alfa1 % 0402; nCalc2 = alfa2;
              |SI nCalc2 < nCalc1;
                 nCalc2 = nCalc2 + 60;
                 nHora = nHora - 1;
              |FINSI;
              nMinu = nCalc2 - nCalc1;

              nCalc = nHora + (nMinu / 60);
              #pretmp06#7 = nCalc;
              |SI #labtraba#234 ! 0;
                 #pretmp06#8 = #labtraba#234 - #pretmp06#7;
              |SINO;
                 #pretmp06#8 = 8 - #pretmp06#7;
              |FINSI;
              #pretmp06#16 = #premvtol#9;
              |GRABA 020#pretmp06.a;
           |SINO;
              |DDEFECTO #pretmp06;
              alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
              #pretmp06#0 = alfa1;
              #pretmp06#1 = #premvtol#7;
              #pretmp06#2 = #prequiva#1;
              #pretmp06#3 = #prequiva#2;
              #pretmp06#4 = #labtraba#2;
              alfa1 = (("00" + #premvtol#4) % -102) + ":" + (("00" + #premvtol#5) % -102) + ":" + (("00" + #premvtol#6) % -102);
              #pretmp06#5 = alfa1;
              #pretmp06#9  = #labtraba#17;
              #pretmp06#10 = #labtraba#18;
              |SI #premvtol#4 < 14; #pretmp06#11 = 1; |SINO; #pretmp06#11 = 2; |FINSI;
              #pretmp06#16 = #premvtol#9;
              |GRABA 020#pretmp06.n;
           |FINSI;
        |SINO;
           |DDEFECTO #pretmp06;
           alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
           #pretmp06#0 = alfa1;
           #pretmp06#1 = #premvtol#7;
           #pretmp06#2 = #prequiva#1;
           #pretmp06#3 = #prequiva#2;
           #pretmp06#4 = #labtraba#2;
           alfa1 = (("00" + #premvtol#4) % -102) + ":" + (("00" + #premvtol#5) % -102) + ":" + (("00" + #premvtol#6) % -102);
           #pretmp06#5 = alfa1;
           #pretmp06#9  = #labtraba#17;
           #pretmp06#10 = #labtraba#18;
           |SI #premvtol#4 < 14; #pretmp06#11 = 1; |SINO; #pretmp06#11 = 2; |FINSI;
           #pretmp06#16 = #premvtol#9;
           |GRABA 020#pretmp06.n;
        |FINSI;
     |SINO;
        |DDEFECTO #pretmp06;
        alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
        #pretmp06#0 = alfa1;
        #pretmp06#1 = #premvtol#7;
        #pretmp06#2 = #prequiva#1;
        #pretmp06#3 = #prequiva#2;
        #pretmp06#4 = #labtraba#2;
        alfa1 = (("00" + #premvtol#4) % -102) + ":" + (("00" + #premvtol#5) % -102) + ":" + (("00" + #premvtol#6) % -102);
        #pretmp06#5 = alfa1;
        #pretmp06#9  = #labtraba#17;
        #pretmp06#10 = #labtraba#18;
        |SI #premvtol#4 < 14; #pretmp06#11 = 1; |SINO; #pretmp06#11 = 2; |FINSI;

        alfa1 = (("00" + #premvtol#3) % -102) + "." + (("00" + #premvtol#1) % -102) + "." + (("0000" + #premvtol#0) % -104);
        #preinter#0 = alfa1;
        |LEE 000#preinter.=;
        |SI FSalida ! 0; |DDEFECTO #preinter; |FINSI;
        #pretmp06#12 = #preinter#1;
        #pretmp06#15 = #preinter#2;
        #pretmp06#16 = #premvtol#9;
        |GRABA 020#pretmp06.n;
     |FINSI;

     nSwHay = 1;
|FPRC;

|DEFBUCLE movimientos;
 #premvtol#3;
 9;
 #0#4, nAnde, nMede, 1,  0,  0,  0, #0#13;
 #0#5, nAnha, nMeha, 31, 23, 59, 59, #0#14;
 ;
 NULL, movimientos;
|FIN;

|PROCESO Imprime;
   |SI #pretmp06#6 = "        ";
      |SI #pretmp06#5 = "        ";
         #pretmp06#13 = 2;
         #pretmp06#14 = "Sin fechas indicadas";
      |SINO;
         #pretmp06#13 = 1;
         #pretmp06#14 = "Sin fecha de salida";
      |FINSI;
      |GRABA 020#pretmp06.a;
   |FINSI;

   |PRINT;
|FPRC;

|DEFBUCLE Imprime;
#pretmp06#1;
;
INICIO;
FINAL;
;
NULL, Imprime;
|FIN;

|PROCESO Compro; |TIPO 0;
     |SI #0#15 = "C";
          |C_M #0#16, 1, "N";
          #0#16 = "I"; |PINTA #0#16;
     |SINO;
          |C_M #0#16, 1, "S";
     |FINSI;
|FPRC;

|PROCESO tipo3; |TIPO 3;
    |ABRE #premvtol; |ABRE #prequiva;
    |ABRE #labempre; |ABRE #labtraba;
    |ABRE #preinter;
    aAlfa = "06" + Usuario; |NOME_DAT #pretmp06#aAlfa#;
    |DELINDEX #pretmp06; |ABRE #pretmp06;

    |HAZ desglo;

    nSwHay = 0; |BUCLE movimientos;
    |SI nSwHay ! 0;
       |SI #0#15 = "I";
          |HAZ Incidencias0;
       |SINO;
            ||Impresora = "CrystalReport";
            |IMPRE 0;
            |SI FSalida = 0;
               |INFOR "preinse1";
               |SI FSalida = 0;
                  |BUCLE Imprime;
                  |PIEINF; |FININF;
               |FINSI;
               |FINIMP;
            |FINSI;
       |FINSI;
    |SINO;
       |MENAV "    Seleccion vacia ...";
    |FINSI;
    |CIERRA #premvtol; |CIERRA #prequiva; |CIERRA #labempre;
    |CIERRA #labtraba; |CIERRA #preinter;
    |CIERRA #pretmp06; |DELINDEX #pretmp06;
|FPRC;

|PROCESO mirasem; |TIPO 7;
    alfa1 = #0#0;
    alfa1 = "01.01." + alfa1;
    fech1 = alfa1;            || primero saca el dia de la semana
    fech2 = fech1 % 1;        ||/que fue el uno de enero
    alfa1 = fech2 % 11;

|SI alfa1 = "Lunes";     sdia=1; smas=0; |FINSI;
|SI alfa1 = "Martes";    sdia=7; smas=1; |FINSI;
|SI alfa1 = "Miercoles"; sdia=6; smas=1; |FINSI;
|SI alfa1 = "Jueves";    sdia=5; smas=1; |FINSI; ||saca el dia del mes que fue
|SI alfa1 = "Viernes";   sdia=4; smas=1; |FINSI; ||el primer lunes del a¤o
|SI alfa1 = "Sabado";    sdia=3; smas=1; |FINSI;
|SI alfa1 = "Domingo";   sdia=2; smas=1; |FINSI;

    alfa1 = ("00" + sdia) % -102;  || construye el primer lunes del a¤o
    fech1 = ~;                     ||/como fecha inicial de calculo
    alfa2 = fech1 % -104;
    alfa1 = alfa1 + ".01." + alfa2;
    fech1 = alfa1;
    nume1 = fech1;                 || calcula dias hasta primer lunes a¤o

    fech1 = ~;                     || calcula dias hasta fecha actual
    nume2 = fech1;

    sdife = nume2 - nume1;         || calcula la diferencia desde el primer
|SI sdife ] 0;
        srest = sdife $ 7;           || lunes hasta la fecha actual,la redondea,
        sdife = sdife + (7 - srest); || la divide por 7 y le suma 1 por la
        #0Campo = (sdife / 7) + smas;|| primera semana (en su caso !!!)
|SINO;
        #0Campo = 1;
|FINSI;

|PINTA #0Campo;
|HAZ deshas;
|FPRC;

|PROCESO deshas; |TIPO 0;   || calcula segun semana, desde dia hasta dia
    nume2 = #0#1 - smas;
    nume2 = (nume2 * 7) + (sdia - 1);   || dias hasta
    nume1 = nume2 - 6;                  || dias desde

    nume3 = #0#0;
    nume3 = nume3 - 1;
    alfa1 = "31.12." + nume3;    || saca los dias que hay hasta el 31.12
    fech1 = alfa1;
    nume3 = fech1;

    nume1 = nume1 + nume3;
    fech1 = nume1;         || fecha desde
    #0#6 = fech1;

    nume2 = nume2 + nume3;
    fech1 = nume2;         || fecha hasta
    #0#7 = fech1;

|PINTA #0#6;
|PINTA #0#7;
|FPRC;

|PROCESO desglo;
     || Proceso para desglosar las fechas desde hasta para la clave.

     alfa1 = #0#6 % -104;
     nAnde = alfa1;       ||A¤o Desde.
     alfa2 = #0#6 % 402;
     nMede = alfa2;       ||Mes Desde.
     alfa3 = #0#6 % 102;
     nDide = alfa3;       ||Dia Desde.

     aDefe = alfa2 + alfa3;

     alfa1 = #0#7 % -104;
     nAnha = alfa1;       ||A¤o Hasta.
     alfa2 = #0#7 % 402;
     nMeha = alfa2;       ||Mes Hasta.
     alfa3 = #0#7 % 102;
     nDiha = alfa3;       ||Dia Hasta.

     aHafe = alfa2 + alfa3;
|FPRC;

|PROCESO CambiaBarra;
     aNom = "";
     aLon = aAlfa % A0;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aCar = aAlfa % nPos;
          |SI aCar = "/"; aCar = "\"; |FINSI;
          aNom = aNom + aCar;
     |SIGUE;
     aAlfa = aNom;
|FPRC;

|PROCESO EnviaCorreo;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |XABRE aTipo, aCuerpo, nHandle;
     |SI FSalida = 0;
          aAlfa = "Incidencias Año/Semana:" + #0#0 + "/" + #0#1;
          |XGRABA nHandle, aAlfa;
          |XCIERRA nHandle;
     |FINSI;
     aAlfa = aCuerpo; |HAZ CambiaBarra; aCuerpo = aAlfa;
     aAlfa = aDjunto; |HAZ CambiaBarra; aDjunto = aAlfa;
     |XABRE aTipo, aTxt, nHandle;
     |SI FSalida = 0;
          aAlfa = #100#3; |XGRABA nHandle, aAlfa;
          aAlfa = #100#5; |XGRABA nHandle, aAlfa;
          aAlfa = #100#6; |XGRABA nHandle, aAlfa;
          aAlfa = #100#1; |XGRABA nHandle, aAlfa;
          |XGRABA nHandle, aDirDes;
          aAlfa = #100#1; |XGRABA nHandle, aAlfa;
          aAlfa = "Incidencias " + #0#0 + "/" + #0#1; |XGRABA nHandle, aAlfa;
          |XGRABA nHandle, aCuerpo;
          |XGRABA nHandle, "N";
          |XGRABA nHandle, "";
          |XGRABA nHandle, "";
          |XGRABA nHandle, "";
          |XGRABA nHandle, "";
          |XGRABA nHandle, "";
          |XGRABA nHandle, aDjunto;
          |XCIERRA nHandle;
     |FINSI;

     |SI aIP = "";
          |DBASS aBase;
          aOrg = aBase + "epresen/plugins/dsenviacorreo.exe";
          aDes = aBase + "bin/dsenviacorreo.exe";
          |HAZ EjecuataExe;
     |SINO;
          |DBASS aBase;
          aOrg = aBase + "epresen/plugins/dsenviacorreo.exe";
          aDes = aBaseLocal1 + "bin/dsenviacorreo.exe";
          |HAZ EjecuataExeRemoto;
     |FINSI;
|FPRC;

|PROCESO EjecuataExe;
     aContiene = aOrg;
     |ESPECIFICA "MD5", aContiene;
     aMd5Org = FSalida;
     aContiene = aDes;
     |ESPECIFICA "MD5", aContiene;
     aMd5Des = FSalida;
     |SI aMd5Org ! aMd5Des; |COPIA_FICHERO aOrg, aDes; |FINSI;
     aAlfa = aDes + " " + aTxt;
     |SYSTEM aAlfa;

     |FBORRA aTxt;
     |FBORRA aDjunto;
     |FBORRA aCuerpo;
|FPRC;

|PROCESO EjecuataExeRemoto;
     aContiene = aOrg;
     |ESPECIFICA "MD5", aContiene;
     aMd5Org = FSalida;
     aContiene = aDes;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aMd5Des = FSalida;
     |SI aMd5Org ! aMd5Des; |ENVIA_FICHERO aOrg, aDes; |FINSI;
     aAlfa = aDes + " " + aTxt;
     |RSYSTEM aAlfa;

     |RFBORRA aTxt;
     |RFBORRA aDjunto;
     |RFBORRA aCuerpo;
|FPRC;

|PROCESO IniImpre;
     aIP = ""; |IP_REMOTO aIP;
     |SI aIP = "";
          |DFICE aAlfa;
          aDjunto = aAlfa + Usuario + ".pdf";
          aTxt = aAlfa + Usuario + ".txt";
          aCuerpo = aAlfa + Usuario + "c.txt";
          Impresora = "CrystalReport;" + aDjunto;
          aTipo = "W";
     |SINO;
          |ESPECIFICA "RBASS", aBaseLocal;
          aDjunto = aBaseLocal1 + Usuario + ".pdf";
          aTxt = aBaseLocal1 + Usuario + ".txt";
          aCuerpo = aBaseLocal1 + Usuario + "c.txt";
          Impresora = "CrystalReport;" + aDjunto;
          aTipo = "CW";
     |FINSI;
     |IMPRE -1;
     nImpre = FSalida;
     |SI FSalida = 0;
          |INFOR "preincid";
          nInfor = FSalida;
     |FINSI;
|FPRC;

|PROCESO FinImpre;
     |SI nPrime = 0; |ACABA; |FINSI;
     |SI nInfor = 0; |PIEINF; |FININF; |FINSI;
     |SI nImpre = 0; |FINIMP; |HAZ EnviaCorreo; |FINSI;
     nInfor = -1; nImpre = -1;
|FPRC;

|PROCESO Incidencias2;
     |SI nPrime = 0; |O #1#0 ! #pretmp06#16;
          |HAZ FinImpre;
          aImp = "S";
          #1#0 = #pretmp06#16;
          |LEE 000#1=;
          |SI FSalida ! 0; |O #1#2 = "N"; aImp = "N"; |ACABA; |FINSI;

          nPrime = 1;
          |HAZ IniImpre;
     |FINSI;
     |SI aImp = "N"; |ACABA; |FINSI;

     |SI nImpre ! 0; |O nInfor ! 0; |ACABA; |FINSI;

     aDirDes = #1#3; |QBF aDirDes;

     |SI #pretmp06#6 = "        ";
          |SI #pretmp06#5 = "        ";
               #pretmp06#13 = 2;
               #pretmp06#14 = "Sin fechas indicadas";
          |SINO;
               #pretmp06#13 = 1;
               #pretmp06#14 = "Sin fecha de salida";
          |FINSI;
          |GRABA 020#pretmp06.a;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Incidencias2;
     #pretmp06#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Incidencias2;
|FIN;

|PROCESO Incidencias1;
   |SI #pretmp06#6 = "        ";
      |SI #pretmp06#5 = "        ";
         #pretmp06#13 = 2;
         #pretmp06#14 = "Sin fechas indicadas";
      |SINO;
         #pretmp06#13 = 1;
         #pretmp06#14 = "Sin fecha de salida";
      |FINSI;
      |GRABA 020#pretmp06.a;
      |PRINT;
   |FINSI;
|FPRC;

|DEFBUCLE Incidencias1;
     #pretmp06#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Incidencias1;
|FIN;

|PROCESO Incidencias0;
     |SI #0#16 = "I";
          Impresora = "Crystal Reports";
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR "preincid";
               |SI FSalida = 0;
                    |BUCLE Incidencias1;
                    |PIEINF;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
     |SINO;
          nTer = -1;
          |ABRE #1;
          |BUCLE Incidencias2;
          |CIERRA #1;
          |HAZ FinImpre;
     |FINSI;
|FPRC;
