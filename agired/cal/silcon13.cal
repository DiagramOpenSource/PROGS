|FICHEROS;
     silcon13 #0;
     labempre #1;         || empresas
     labtraba #2;         || trabajadores
     motibaja;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;
    inkey = 0;

    sw_trece = 0;
    sw_vuelve = 0;
    sw_alguno = 0;
    dlote = 0;
    hlote = 0;
    ultima = 0;

     aMarca = "";
     swTodos = 0;
     aAlfa = "";
|FIN;

/****************************************************************************/
/***** PROCESOS PARA MARCAR O DESMARCAR TRABAJADORES PARA BORRADO MASIVO ****/
/****************************************************************************/

|PROCESO BorraMov;
     |BORRA 020#0a;
|FPRC;

|DEFBUCLE BorraMov;
     #0#3;
     64;
     00000, 00001, "**";
     00000, 99999, "**";
     ;
     NULL, BorraMov;
|FIN;

|PROCESO alguno_marcado;
     sw_alguno = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE alguno_marcado;
     #0#3;
     64;
     00000, 00001, "**";
     00000, 99999, "**";
     ;
     NULL, alguno_marcado;
|FIN;

|PROCESO tipo7_13; |TIPO 7;
     ||               1        2         3         4         5         6         7
     ||      123456789023456789012345678901234567890123456789012345678901234567890123456

     |SI PARAMETRO = "p";
          |MENSA "    < F5 > Marcar/Desmarcar; < F6 > Marcar/desmarcar todos; < F10 > Borrar marcados";
     |SINO;
          |MENSA "    Número de movimiento";
     |FINSI;

     |PINTA 0501, "                                                                           ";
|FPRC;

|PROCESO MarcaTodosMov;
     #0#64 = aMarca;
     |PINTA #0#64;
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE MarcaTodosMov;
     #0#3;
     ;
     00000, 00001;
     00000, 99999;
     be;
     NULL, MarcaTodosMov;
|FIN;

|PROCESO Selecciona_13;
     |SI FSalida = 0; |O FSalida = 13;
          |SI #0#64 = "**";
               #0#64 = "  ";
          |SINO;
               #0#64 = "**";
          |FINSI;
          |PINTA #0#64;
          |GRABA 020#0a;
          |LIBERA #0;
          |ERROR;
     |FINSI;
     |SI FSalida = 14;
          |SI swTodos = 1;
               aMarca = "  ";
               swTodos = 0;
          |SINO;
               aMarca = "**";
               swTodos = 1;
          |FINSI;

          |BUCLE MarcaTodosMov;

          |LEE 000#0p;
          |PONCONTROL 23, "si";
          |PTEC 807;
     |FINSI;

     |SI FSalida = 18;
          sw_alguno = 0;
          nume1 = #0#0;
          |BUCLE alguno_marcado;
          |SI sw_alguno = 1;
               aAlfa = "    NSe eliminarán los movimientos seleccionados. ¿Desea continuar?";
               |CONFI aAlfa;
               |SI FSalida = 0;
                    nume1 = 0;
                    |BUCLE BorraMov;

                    |SELECT #1#0;
                    #0#0 = nume1;
                    |LEE 000#0];
                    |PONCONTROL 23, "si";
                    |PTEC 808;
               |FINSI;
          |SINO;
               #0#0 = nume1;
               |LEE 000#0=;
               |PONCONTROL 23, "si";
          |FINSI;
     |FINSI;
|FPRC;

____________________________________/
|PROCESO alta; |TIPO 7;
    modo = (FEntrada / 100) ! 0;
|SI modo = 1;|Y PARAMETRO = "p";
    |SELECT #1#0;
    |LEE 000#0u;
    |SI FSalida = 0;
            ultima = #0#0 + 1;
    |SINO;
            ultima = 1;
    |FINSI;
    |SELECT #3#0;
        #0#14 = 0;
        #0#0 = 99999;
    |LEE 000#0];
    |SI FSalida = 0;
        |LEE 000#0a;
    |SINO;
        |LEE 000#0u;
    |FINSI;
    |DDEFECTO #0;
        #0#0 = ultima;
|FINSI;
|FPRC;

|PROCESO tipo11; |TIPO 11;
     inkey = FSalida;
     |SI inkey = 9;|Y PARAMETRO = "e";
          sw_vuelve = #0#14;
          #0#14 = 0;
          |GRABA 020#0a;
          |PTEC 806;
     |FINSI;
     |SI PARAMETRO = "p";
          |HAZ Selecciona_13;
     |FINSI;
|FPRC;

|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO pin_empre; |TIPO 0;
|DDEFECTO #1;
|ABRE #1;
    #1#0 = #0#1;
|LEE 000#1=;
|SI FSalida ! 0;|Y sw_trece = 0;
    |MENAV "    Empresa inexistente ...";
    |ERROR;
|FINSI;
|CIERRA #1;

|ATRI I;   |PINTA 2015, #1#2;  |ATRI 0;
|FPRC;

|PROCESO pin_traba; |TIPO 0;
|DDEFECTO #2;
|ABRE #2;
    #2#0 = #0#1;
    #2#1 = #0#2;
|LEE 000#2=;
|SI FSalida ! 0;|Y sw_trece = 0;
    |MENAV "    Trabajador inexistente ...";
    |ERROR;
|FINSI;
|CIERRA #2;

|ATRI I;   |PINTA 2115, #2#2;  |ATRI 0;
|FPRC;

|PROCESO tipo13; |TIPO 13;
    sw_trece = 1;
|HAZ pin_empre;
|HAZ pin_traba;
    sw_trece = 0;
|FPRC;

|PROCESO ayuda3; |TIPO 0;
|SI FSalida = 9;
    |PUSHV 09352276;
    |CUADRO 09 35 22 76;
    |ATRI R;
    ||            1234567890123456789012345678901234567890
    |PINTA 1036, " ----------- TABLA DE ACCIONES -------- ";
    |PINTA 1136, " (TRA)Accion en trabajador, no empresa. ";
    |PINTA 1236, " (MA) Alta sucesiva.                    ";
    |PINTA 1336, " (MB) Baja.                             ";
    |PINTA 1436, " (MG) Cambio de grupo de cotizacion.    ";
    |PINTA 1536, " (MC) Modificacion codigo cta. cotiz.   ";
    |PINTA 1636, " (CV) Consulta de ultima situacion.     ";
    |PINTA 1736, " (CH) Consulta situacion afil. empresa. ";
    |PINTA 1836, " (CE) I.T. por enfermedad comun.        ";
    |PINTA 1936, " (CM) I.T. por maternidad.              ";
    |PINTA 2036, " (CS) Situacion de la empresa.          ";
    |PINTA 2136, " (CT) Relacion trabajadores en alta.    ";
    |ATRI 0;
    |PAUSA;
    |POPV;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO antes4; |TIPO 7;
     |SI #0#3 = "MB ";
          |MENSA "    Pulse F12 para ver los tipos de baja disponibles";
     |SINO;
          |MENSA "    Situacion";
     |FINSI;
|FPRC;

|PROCESO ayuda4; |TIPO 0;
/*
|SI FSalida = 9;
    |PUSHV 09352276;
    |CUADRO 09 35 22 76;
    |ATRI R;
    ||            1234567890123456789012345678901234567890
    |PINTA 1036, " --------- TABLA DE SITUACIONES ------- ";
    |PINTA 1136, " (01) Alta.                             ";
    |PINTA 1236, " (51) Baja Volut. Trabajad. Cta. Ajena. ";
    |PINTA 1336, " (54) Baja por despido.                 ";
    |PINTA 1436, " (56) Baja por fallecimiento.           ";
    |PINTA 1536, " (58) Baja por pase situa. pensionista. ";
    |PINTA 1636, " (61) Baja por servicio militar.        ";
    |PINTA 1736, " (63) Excedencia voluntaria.            ";
    |PINTA 1836, " (64) Excedencia por huelga o cierre.   ";
    |PINTA 1936, " (65) Baja por agotamiento I.T.         ";
    |PINTA 2036, "                                        ";
    |PINTA 2136, "                                        ";
    |ATRI 0;
    |PAUSA;
    |POPV;
    |ERROR;
|FINSI;
*/

     |SI #0#3 = "MB "; |Y FSalida = 9;
          |ABRE #motibaja;
          |CONSULTA_CLAVE #1#motibaja;
          |SI FSalida = 0;
               #0#4 = #motibaja#0;
               |PINTA #0#4;
          |FINSI;
          |CIERRA #motibaja;
     |FINSI;
|FPRC;

____________________________________/
|PROCESO min;
|SI FSalida = "POSICION";|Y PARAMETRO = "e";|Y sw_vuelve ! 0;
        #0#14 = sw_vuelve;
        sw_vuelve = 0;
|SINO;
        #0#14 = dlote;
|FINSI;
    #0#0 = 1;
|FPRC;

|PROCESO max;
    #0#14 = hlote;
    #0#0 = 99999;
|FPRC;

|PROCESO alguno1;
     sw_alguno = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE alguno;
     #0#3;
     ;
     dlote,     1;
     hlote, 99999;
     ;
     NULL, alguno1;
|FIN;

|PROGRAMA;
|CLS;
|CABEZA "Movimientos AFI";
|PINPA #0#0;
|SI PARAMETRO = "p";
        dlote = 0;
        hlote = 0;
    |ATRI R;
    |PINTA 0503, " Movimientos pendientes de incluir en Lotes AFI ";
    |ATRI 0;
        sw_alguno = 0;
    |BUCLE alguno;
    |SI sw_alguno ! 0;
        |ENTLINEAL #3#0, 2, 2, 18, 0, min, max;
            aMarca = "  ";
            |BUCLE MarcaTodosMov;
    |SINO;
        |MENAV "    No hay ningun movimiento pendiente de incluir en lotes ...";
        |AVISO;
        |CONFI "0000NEditar de todas formas";
        |SI FSalida = 0;
             |ENTLINEAL #3#0, 2, 2, 18, 0, min, max;
        |FINSI;
    |FINSI;
|FINSI;
|SI PARAMETRO = "e";
        dlote = 1;
        hlote = 99999;
    |ATRI R;
    |PINTA 0503, " Movimientos incluidos en Lotes AFI ";
    |ATRI 0;
    |PINTA 2327, "<Pulse F12 para dejar el movimiento como PENDIENTE>";
    |ATRI P;
    |PINTA 2334, "F12";
    |ATRI 0;
        sw_vuelve = 0;
    |PARA; |SI; |HACIENDO;
            sw_alguno = 0;
        |BUCLE alguno;
        |SI sw_alguno ! 0;
            |ENTLINEAL #3#0, 2, 4, 18, 0, min, max;
        |SINO;
            |MENAV "    No hay ningun movimiento incluido en lotes ...";
                sw_vuelve = 0;
        |FINSI;

        |SI sw_vuelve = 0;
            |SAL;
        |FINSI;
    |SIGUE;
|FINSI;
|FPRO;
